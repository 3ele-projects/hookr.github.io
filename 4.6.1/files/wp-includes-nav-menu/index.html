<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="wordpress" data-version="4.6.1" data-type="file" data-id="4674"><head xmlns="http://www.w3.org/1999/xhtml"><title> wp-includes-nav-menu | file | WordPress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, wordpress, 4.6.1" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.8"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=4e4a4962c35eaada59a382e204da6239' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.8' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/wp-includes-nav-menu/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-includes-nav-menu%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-includes-nav-menu%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"wordpress-4.6.1-file-wp-includes-nav-menu","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wp-includes-nav-menu" class="blog single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 4.6.1." href="http://hookr.io/4.6.1/" class="H_VERSION"><span property="name">4.6.1</span></a><meta property="position" content="2"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wp-includes-nav-menu</span><meta property="position" content="3"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="6118"><a href="http://hookr.io/4.6.1/all/" title="All">All <span class="count badge">6118</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/4.6.1/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="2420"><a href="http://hookr.io/4.6.1/hooks/" title="Hooks">Hooks <span class="count badge">2420</span></a></li><li class="" data-id="action" data-count="835"><a href="http://hookr.io/4.6.1/actions/" title="Actions">Actions <span class="count badge">835</span></a></li><li class="" data-id="filter" data-count="1585"><a href="http://hookr.io/4.6.1/filters/" title="Filters">Filters <span class="count badge">1585</span></a></li><li class="" data-id="class" data-count="329"><a href="http://hookr.io/4.6.1/classes/" title="Classes">Classes <span class="count badge">329</span></a></li><li class="" data-id="constant" data-count="566"><a href="http://hookr.io/4.6.1/constants/" title="Constants">Constants <span class="count badge">566</span></a></li><li class="" data-id="function" data-count="2795"><a href="http://hookr.io/4.6.1/functions/" title="Functions">Functions <span class="count badge">2795</span></a></li><li class="" data-id="shortcode" data-count="8"><a href="http://hookr.io/4.6.1/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">8</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class="active"><a href="http://hookr.io/all/" title="Core">Core</a></li><li class=""><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/wp-includes/nav-menu.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Navigation Menu functions</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package WordPress</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage Nav_Menus</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Returns a navigation menu object.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $menu Menu ID, slug, or name - or the menu object.</span>&nbsp;</div></li><li><div><span class="comment"> * @return object|false False if $menu param isn't supplied or term does not exist, menu object if successful.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_get_nav_menu_object( $menu ) {&nbsp;</div></li><li><div>  $menu_obj = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_object( $menu ) ) {&nbsp;</div></li><li><div>      $menu_obj = $menu;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $menu && ! $menu_obj ) {&nbsp;</div></li><li><div>      $menu_obj = get_term( $menu, 'nav_menu' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! $menu_obj ) {&nbsp;</div></li><li><div>          $menu_obj = get_term_by( 'slug', $menu, 'nav_menu' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! $menu_obj ) {&nbsp;</div></li><li><div>          $menu_obj = get_term_by( 'name', $menu, 'nav_menu' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $menu_obj || is_wp_error( $menu_obj ) ) {&nbsp;</div></li><li><div>      $menu_obj = false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the nav_menu term retrieved for wp_get_nav_menu_object().</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.3.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|false $menu_obj Term from nav_menu taxonomy, or false if nothing had been found.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string       $menu     The menu ID, slug, or name passed to wp_get_nav_menu_object().</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'wp_get_nav_menu_object', $menu_obj, $menu );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if the given ID is a navigation menu.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Returns true if it is; false otherwise.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|string $menu The menu to check (ID, slug, or name).</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool Whether the menu exists.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function is_nav_menu( $menu ) {&nbsp;</div></li><li><div>  if ( ! $menu )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $menu_obj = wp_get_nav_menu_object( $menu );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if (&nbsp;</div></li><li><div>      $menu_obj &&&nbsp;</div></li><li><div>      ! is_wp_error( $menu_obj ) &&&nbsp;</div></li><li><div>      ! empty( $menu_obj-&gt;taxonomy ) &&&nbsp;</div></li><li><div>      'nav_menu' == $menu_obj-&gt;taxonomy&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Registers navigation menu locations for a theme.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $_wp_registered_nav_menus</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $locations Associative array of menu location identifiers (like a slug) and descriptive text.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function register_nav_menus( $locations = array() ) {&nbsp;</div></li><li><div>  global $_wp_registered_nav_menus;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  add_theme_support( 'menus' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $_wp_registered_nav_menus = array_merge( (array) $_wp_registered_nav_menus, $locations );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Unregisters a navigation menu location for a theme.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $_wp_registered_nav_menus</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $location The menu location identifier.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True on success, false on failure.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function unregister_nav_menu( $location ) {&nbsp;</div></li><li><div>  global $_wp_registered_nav_menus;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_array( $_wp_registered_nav_menus ) && isset( $_wp_registered_nav_menus[$location] ) ) {&nbsp;</div></li><li><div>      unset( $_wp_registered_nav_menus[$location] );&nbsp;</div></li><li><div>      if ( empty( $_wp_registered_nav_menus ) ) {&nbsp;</div></li><li><div>          _remove_theme_support( 'menus' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Registers a navigation menu location for a theme.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $location    Menu location identifier, like a slug.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $description Menu location descriptive text.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function register_nav_menu( $location, $description ) {&nbsp;</div></li><li><div>  register_nav_menus( array( $location =&gt; $description ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves all registered navigation menu locations in a theme.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $_wp_registered_nav_menus</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return array Registered navigation menu locations. If none are registered, an empty array.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_registered_nav_menus() {&nbsp;</div></li><li><div>  global $_wp_registered_nav_menus;&nbsp;</div></li><li><div>  if ( isset( $_wp_registered_nav_menus ) )&nbsp;</div></li><li><div>      return $_wp_registered_nav_menus;&nbsp;</div></li><li><div>  return array();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves all registered navigation menu locations and the menus assigned to them.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return array Registered navigation menu locations and the menus assigned them.</span>&nbsp;</div></li><li><div><span class="comment"> *               If none are registered, an empty array.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function get_nav_menu_locations() {&nbsp;</div></li><li><div>  $locations = get_theme_mod( 'nav_menu_locations' );&nbsp;</div></li><li><div>  return ( is_array( $locations ) ) ? $locations : array();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determines whether a registered nav menu location has a menu assigned to it.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $location Menu location identifier.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool Whether location has a menu.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function has_nav_menu( $location ) {&nbsp;</div></li><li><div>  $has_nav_menu = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $registered_nav_menus = get_registered_nav_menus();&nbsp;</div></li><li><div>  if ( isset( $registered_nav_menus[ $location ] ) ) {&nbsp;</div></li><li><div>      $locations = get_nav_menu_locations();&nbsp;</div></li><li><div>      $has_nav_menu = ! empty( $locations[ $location ] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether a nav menu is assigned to the specified location.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.3.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool   $has_nav_menu Whether there is a menu assigned to a location.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $location     Menu location.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'has_nav_menu', $has_nav_menu, $location );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determines whether the given ID is a nav menu item.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $menu_item_id The ID of the potential nav menu item.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool Whether the given ID is that of a nav menu item.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function is_nav_menu_item( $menu_item_id = 0 ) {&nbsp;</div></li><li><div>  return ( ! is_wp_error( $menu_item_id ) && ( 'nav_menu_item' == get_post_type( $menu_item_id ) ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Creates a navigation menu.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Note that `$menu_name` is expected to be pre-slashed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $menu_name Menu name.</span>&nbsp;</div></li><li><div><span class="comment"> * @return int|WP_Error Menu ID on success, WP_Error object on failure.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_create_nav_menu( $menu_name ) {&nbsp;</div></li><li><div>  <span class="comment">// expected_slashed ($menu_name)</span>&nbsp;</div></li><li><div>  return wp_update_nav_menu_object( 0, array( 'menu-name' =&gt; $menu_name ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Delete a Navigation Menu.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $menu Menu ID, slug, or name.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool|WP_Error True on success, false or WP_Error object on failure.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_delete_nav_menu( $menu ) {&nbsp;</div></li><li><div>  $menu = wp_get_nav_menu_object( $menu );&nbsp;</div></li><li><div>  if ( ! $menu )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $menu_objects = get_objects_in_term( $menu-&gt;term_id, 'nav_menu' );&nbsp;</div></li><li><div>  if ( ! empty( $menu_objects ) ) {&nbsp;</div></li><li><div>      foreach ( $menu_objects as $item ) {&nbsp;</div></li><li><div>          wp_delete_post( $item );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $result = wp_delete_term( $menu-&gt;term_id, 'nav_menu' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Remove this menu from any locations.</span>&nbsp;</div></li><li><div>  $locations = get_nav_menu_locations();&nbsp;</div></li><li><div>  foreach ( $locations as $location =&gt; $menu_id ) {&nbsp;</div></li><li><div>      if ( $menu_id == $menu-&gt;term_id )&nbsp;</div></li><li><div>          $locations[ $location ] = 0;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  set_theme_mod( 'nav_menu_locations', $locations );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $result && !is_wp_error($result) )&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Fires after a navigation menu has been successfully deleted.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param int $term_id ID of the deleted menu.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      do_action( 'wp_delete_nav_menu', $menu-&gt;term_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $result;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Save the properties of a menu or create a new menu with those properties.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Note that `$menu_data` is expected to be pre-slashed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int   $menu_id   The ID of the menu or &quot;0&quot; to create a new menu.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $menu_data The array of menu data.</span>&nbsp;</div></li><li><div><span class="comment"> * @return int|WP_Error Menu ID on success, WP_Error object on failure.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_update_nav_menu_object( $menu_id = 0, $menu_data = array() ) {&nbsp;</div></li><li><div>  <span class="comment">// expected_slashed ($menu_data)</span>&nbsp;</div></li><li><div>  $menu_id = (int) $menu_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $_menu = wp_get_nav_menu_object( $menu_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $args = array(&nbsp;</div></li><li><div>      'description' =&gt; ( isset( $menu_data['description'] ) ? $menu_data['description']  : '' ), &nbsp;</div></li><li><div>      'name' =&gt; ( isset( $menu_data['menu-name'] ) ? $menu_data['menu-name']    : '' ), &nbsp;</div></li><li><div>      'parent' =&gt; ( isset( $menu_data['parent'] ) ? (int) $menu_data['parent'] : 0 ), &nbsp;</div></li><li><div>      'slug' =&gt; null, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// double-check that we're not going to have one menu take the name of another</span>&nbsp;</div></li><li><div>  $_possible_existing = get_term_by( 'name', $menu_data['menu-name'], 'nav_menu' );&nbsp;</div></li><li><div>  if (&nbsp;</div></li><li><div>      $_possible_existing &&&nbsp;</div></li><li><div>      ! is_wp_error( $_possible_existing ) &&&nbsp;</div></li><li><div>      isset( $_possible_existing-&gt;term_id ) &&&nbsp;</div></li><li><div>      $_possible_existing-&gt;term_id != $menu_id&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>      return new WP_Error( 'menu_exists', &nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** translators: %s: menu name */</span></span>&nbsp;</div></li><li><div>          sprintf( __( 'The menu name %s conflicts with another menu name. Please try another.' ), &nbsp;</div></li><li><div>              '&lt;strong&gt;' . esc_html( $menu_data['menu-name'] ) . '&lt;/strong&gt;'&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// menu doesn't already exist, so create a new menu</span>&nbsp;</div></li><li><div>  if ( ! $_menu || is_wp_error( $_menu ) ) {&nbsp;</div></li><li><div>      $menu_exists = get_term_by( 'name', $menu_data['menu-name'], 'nav_menu' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $menu_exists ) {&nbsp;</div></li><li><div>          return new WP_Error( 'menu_exists', &nbsp;</div></li><li><div>              <span class="comment"><span class="comment">/** translators: %s: menu name */</span></span>&nbsp;</div></li><li><div>              sprintf( __( 'The menu name %s conflicts with another menu name. Please try another.' ), &nbsp;</div></li><li><div>                  '&lt;strong&gt;' . esc_html( $menu_data['menu-name'] ) . '&lt;/strong&gt;'&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $_menu = wp_insert_term( $menu_data['menu-name'], 'nav_menu', $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_wp_error( $_menu ) )&nbsp;</div></li><li><div>          return $_menu;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Fires after a navigation menu is successfully created.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param int   $term_id   ID of the new menu.</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $menu_data An array of menu data.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      do_action( 'wp_create_nav_menu', $_menu['term_id'], $menu_data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return (int) $_menu['term_id'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $_menu || ! isset( $_menu-&gt;term_id ) )&nbsp;</div></li><li><div>      return 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $menu_id = (int) $_menu-&gt;term_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $update_response = wp_update_term( $menu_id, 'nav_menu', $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_wp_error( $update_response ) )&nbsp;</div></li><li><div>      return $update_response;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $menu_id = (int) $update_response['term_id'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Fires after a navigation menu has been successfully updated.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int   $menu_id   ID of the updated menu.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $menu_data An array of menu data.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  do_action( 'wp_update_nav_menu', $menu_id, $menu_data );&nbsp;</div></li><li><div>  return $menu_id;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Save the properties of a menu item or create a new one.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The menu-item-title, menu-item-description, and menu-item-attr-title are expected</span>&nbsp;</div></li><li><div><span class="comment"> * to be pre-slashed since they are passed directly into `wp_insert_post()`.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int   $menu_id         The ID of the menu. Required. If &quot;0&quot;, makes the menu item a draft orphan.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int   $menu_item_db_id The ID of the menu item. If &quot;0&quot;, creates a new menu item.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $menu_item_data  The menu item's data.</span>&nbsp;</div></li><li><div><span class="comment"> * @return int|WP_Error The menu item's database ID or WP_Error object on failure.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_update_nav_menu_item( $menu_id = 0, $menu_item_db_id = 0, $menu_item_data = array() ) {&nbsp;</div></li><li><div>  $menu_id = (int) $menu_id;&nbsp;</div></li><li><div>  $menu_item_db_id = (int) $menu_item_db_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// make sure that we don't convert non-nav_menu_item objects into nav_menu_item objects</span>&nbsp;</div></li><li><div>  if ( ! empty( $menu_item_db_id ) && ! is_nav_menu_item( $menu_item_db_id ) )&nbsp;</div></li><li><div>      return new WP_Error( 'update_nav_menu_item_failed', __( 'The given object ID is not that of a menu item.' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $menu = wp_get_nav_menu_object( $menu_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $menu && 0 !== $menu_id ) {&nbsp;</div></li><li><div>      return new WP_Error( 'invalid_menu_id', __( 'Invalid menu ID.' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_wp_error( $menu ) ) {&nbsp;</div></li><li><div>      return $menu;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $defaults = array(&nbsp;</div></li><li><div>      'menu-item-db-id' =&gt; $menu_item_db_id, &nbsp;</div></li><li><div>      'menu-item-object-id' =&gt; 0, &nbsp;</div></li><li><div>      'menu-item-object' =&gt; '', &nbsp;</div></li><li><div>      'menu-item-parent-id' =&gt; 0, &nbsp;</div></li><li><div>      'menu-item-position' =&gt; 0, &nbsp;</div></li><li><div>      'menu-item-type' =&gt; 'custom', &nbsp;</div></li><li><div>      'menu-item-title' =&gt; '', &nbsp;</div></li><li><div>      'menu-item-url' =&gt; '', &nbsp;</div></li><li><div>      'menu-item-description' =&gt; '', &nbsp;</div></li><li><div>      'menu-item-attr-title' =&gt; '', &nbsp;</div></li><li><div>      'menu-item-target' =&gt; '', &nbsp;</div></li><li><div>      'menu-item-classes' =&gt; '', &nbsp;</div></li><li><div>      'menu-item-xfn' =&gt; '', &nbsp;</div></li><li><div>      'menu-item-status' =&gt; '', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $args = wp_parse_args( $menu_item_data, $defaults );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 0 == $menu_id ) {&nbsp;</div></li><li><div>      $args['menu-item-position'] = 1;&nbsp;</div></li><li><div>  } elseif ( 0 == (int) $args['menu-item-position'] ) {&nbsp;</div></li><li><div>      $menu_items = 0 == $menu_id ? array() : (array) wp_get_nav_menu_items( $menu_id, array( 'post_status' =&gt; 'publish, draft' ) );&nbsp;</div></li><li><div>      $last_item = array_pop( $menu_items );&nbsp;</div></li><li><div>      $args['menu-item-position'] = ( $last_item && isset( $last_item-&gt;menu_order ) ) ? 1 + $last_item-&gt;menu_order : count( $menu_items );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $original_parent = 0 &lt; $menu_item_db_id ? get_post_field( 'post_parent', $menu_item_db_id ) : 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'custom' != $args['menu-item-type'] ) {&nbsp;</div></li><li><div>      <span class="comment">/** if non-custom menu item, then:</span>&nbsp;</div></li><li><div><span class="comment">          * use original object's URL</span>&nbsp;</div></li><li><div><span class="comment">          * blank default title to sync with original object's</span>&nbsp;</div></li><li><div><span class="comment">      */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $args['menu-item-url'] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $original_title = '';&nbsp;</div></li><li><div>      if ( 'taxonomy' == $args['menu-item-type'] ) {&nbsp;</div></li><li><div>          $original_parent = get_term_field( 'parent', $args['menu-item-object-id'], $args['menu-item-object'], 'raw' );&nbsp;</div></li><li><div>          $original_title = get_term_field( 'name', $args['menu-item-object-id'], $args['menu-item-object'], 'raw' );&nbsp;</div></li><li><div>      } elseif ( 'post_type' == $args['menu-item-type'] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $original_object = get_post( $args['menu-item-object-id'] );&nbsp;</div></li><li><div>          $original_parent = (int) $original_object-&gt;post_parent;&nbsp;</div></li><li><div>          $original_title = $original_object-&gt;post_title;&nbsp;</div></li><li><div>      } elseif ( 'post_type_archive' == $args['menu-item-type'] ) {&nbsp;</div></li><li><div>          $original_object = get_post_type_object( $args['menu-item-object'] );&nbsp;</div></li><li><div>          if ( $original_object ) {&nbsp;</div></li><li><div>              $original_title = $original_object-&gt;labels-&gt;archives;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $args['menu-item-title'] == $original_title )&nbsp;</div></li><li><div>          $args['menu-item-title'] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// hack to get wp to create a post object when too many properties are empty</span>&nbsp;</div></li><li><div>      if ( '' ==  $args['menu-item-title'] && '' == $args['menu-item-description'] )&nbsp;</div></li><li><div>          $args['menu-item-description'] = ' ';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Populate the menu item object</span>&nbsp;</div></li><li><div>  $post = array(&nbsp;</div></li><li><div>      'menu_order' =&gt; $args['menu-item-position'], &nbsp;</div></li><li><div>      'ping_status' =&gt; 0, &nbsp;</div></li><li><div>      'post_content' =&gt; $args['menu-item-description'], &nbsp;</div></li><li><div>      'post_excerpt' =&gt; $args['menu-item-attr-title'], &nbsp;</div></li><li><div>      'post_parent' =&gt; $original_parent, &nbsp;</div></li><li><div>      'post_title' =&gt; $args['menu-item-title'], &nbsp;</div></li><li><div>      'post_type' =&gt; 'nav_menu_item', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $update = 0 != $menu_item_db_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// New menu item. Default is draft status</span>&nbsp;</div></li><li><div>  if ( ! $update ) {&nbsp;</div></li><li><div>      $post['ID'] = 0;&nbsp;</div></li><li><div>      $post['post_status'] = 'publish' == $args['menu-item-status'] ? 'publish' : 'draft';&nbsp;</div></li><li><div>      $menu_item_db_id = wp_insert_post( $post );&nbsp;</div></li><li><div>      if ( ! $menu_item_db_id    || is_wp_error( $menu_item_db_id ) )&nbsp;</div></li><li><div>          return $menu_item_db_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Fires immediately after a new navigation menu item has been added.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @see wp_update_nav_menu_item()</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param int   $menu_id         ID of the updated menu.</span>&nbsp;</div></li><li><div><span class="comment">       * @param int   $menu_item_db_id ID of the new menu item.</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $args            An array of arguments used to update/add the menu item.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      do_action( 'wp_add_nav_menu_item', $menu_id, $menu_item_db_id, $args );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Associate the menu item with the menu term</span>&nbsp;</div></li><li><div>  <span class="comment">// Only set the menu term if it isn't set to avoid unnecessary wp_get_object_terms()</span>&nbsp;</div></li><li><div>   if ( $menu_id && ( ! $update || ! is_object_in_term( $menu_item_db_id, 'nav_menu', (int) $menu-&gt;term_id ) ) ) {&nbsp;</div></li><li><div>      wp_set_object_terms( $menu_item_db_id, array( $menu-&gt;term_id ), 'nav_menu' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'custom' == $args['menu-item-type'] ) {&nbsp;</div></li><li><div>      $args['menu-item-object-id'] = $menu_item_db_id;&nbsp;</div></li><li><div>      $args['menu-item-object'] = 'custom';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $menu_item_db_id = (int) $menu_item_db_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  update_post_meta( $menu_item_db_id, '_menu_item_type', sanitize_key($args['menu-item-type']) );&nbsp;</div></li><li><div>  update_post_meta( $menu_item_db_id, '_menu_item_menu_item_parent', strval( (int) $args['menu-item-parent-id'] ) );&nbsp;</div></li><li><div>  update_post_meta( $menu_item_db_id, '_menu_item_object_id', strval( (int) $args['menu-item-object-id'] ) );&nbsp;</div></li><li><div>  update_post_meta( $menu_item_db_id, '_menu_item_object', sanitize_key($args['menu-item-object']) );&nbsp;</div></li><li><div>  update_post_meta( $menu_item_db_id, '_menu_item_target', sanitize_key($args['menu-item-target']) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $args['menu-item-classes'] = array_map( 'sanitize_html_class', explode( ' ', $args['menu-item-classes'] ) );&nbsp;</div></li><li><div>  $args['menu-item-xfn'] = implode( ' ', array_map( 'sanitize_html_class', explode( ' ', $args['menu-item-xfn'] ) ) );&nbsp;</div></li><li><div>  update_post_meta( $menu_item_db_id, '_menu_item_classes', $args['menu-item-classes'] );&nbsp;</div></li><li><div>  update_post_meta( $menu_item_db_id, '_menu_item_xfn', $args['menu-item-xfn'] );&nbsp;</div></li><li><div>  update_post_meta( $menu_item_db_id, '_menu_item_url', esc_url_raw($args['menu-item-url']) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 0 == $menu_id )&nbsp;</div></li><li><div>      update_post_meta( $menu_item_db_id, '_menu_item_orphaned', (string) time() );&nbsp;</div></li><li><div>  elseif ( get_post_meta( $menu_item_db_id, '_menu_item_orphaned' ) )&nbsp;</div></li><li><div>      delete_post_meta( $menu_item_db_id, '_menu_item_orphaned' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Update existing menu item. Default is publish status</span>&nbsp;</div></li><li><div>  if ( $update ) {&nbsp;</div></li><li><div>      $post['ID'] = $menu_item_db_id;&nbsp;</div></li><li><div>      $post['post_status'] = 'draft' == $args['menu-item-status'] ? 'draft' : 'publish';&nbsp;</div></li><li><div>      wp_update_post( $post );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Fires after a navigation menu item has been updated.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @see wp_update_nav_menu_item()</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int   $menu_id         ID of the updated menu.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int   $menu_item_db_id ID of the updated menu item.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args            An array of arguments used to update a menu item.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  do_action( 'wp_update_nav_menu_item', $menu_id, $menu_item_db_id, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $menu_item_db_id;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Returns all navigation menu objects.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.1.0 Default value of the 'orderby' argument was changed from 'none'</span>&nbsp;</div></li><li><div><span class="comment"> *              to 'name'.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Optional. Array of arguments passed on to get_terms().</span>&nbsp;</div></li><li><div><span class="comment"> *                    Default empty array.</span>&nbsp;</div></li><li><div><span class="comment"> * @return array Menu objects.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_get_nav_menus( $args = array() ) {&nbsp;</div></li><li><div>  $defaults = array( 'hide_empty' =&gt; false, 'orderby' =&gt; 'name' );&nbsp;</div></li><li><div>  $args = wp_parse_args( $args, $defaults );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the navigation menu objects being returned.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @see get_terms()</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $menus An array of menu objects.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args  An array of arguments used to retrieve menu objects.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'wp_get_nav_menus', get_terms( 'nav_menu', $args), $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Sort menu items by the desired key.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global string $_menu_item_sort_prop</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object $a The first object to compare</span>&nbsp;</div></li><li><div><span class="comment"> * @param object $b The second object to compare</span>&nbsp;</div></li><li><div><span class="comment"> * @return int -1, 0, or 1 if $a is considered to be respectively less than, equal to, or greater than $b.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _sort_nav_menu_items( $a, $b ) {&nbsp;</div></li><li><div>  global $_menu_item_sort_prop;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $_menu_item_sort_prop ) )&nbsp;</div></li><li><div>      return 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! isset( $a-&gt;$_menu_item_sort_prop ) || ! isset( $b-&gt;$_menu_item_sort_prop ) )&nbsp;</div></li><li><div>      return 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $_a = (int) $a-&gt;$_menu_item_sort_prop;&nbsp;</div></li><li><div>  $_b = (int) $b-&gt;$_menu_item_sort_prop;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $a-&gt;$_menu_item_sort_prop == $b-&gt;$_menu_item_sort_prop )&nbsp;</div></li><li><div>      return 0;&nbsp;</div></li><li><div>  elseif ( $_a == $a-&gt;$_menu_item_sort_prop && $_b == $b-&gt;$_menu_item_sort_prop )&nbsp;</div></li><li><div>      return $_a &lt; $_b ? -1 : 1;&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      return strcmp( $a-&gt;$_menu_item_sort_prop, $b-&gt;$_menu_item_sort_prop );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return if a menu item is valid.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @link https://core.trac.wordpress.org/ticket/13958</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.2.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object $item The menu item to check.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool False if invalid, otherwise true.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _is_valid_nav_menu_item( $item ) {&nbsp;</div></li><li><div>  return empty( $item-&gt;_invalid );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return all menu items of a navigation menu.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global string $_menu_item_sort_prop</span>&nbsp;</div></li><li><div><span class="comment"> * @staticvar array $fetched</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $menu Menu name, ID, or slug.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $args Optional. Arguments to pass to get_posts().</span>&nbsp;</div></li><li><div><span class="comment"> * @return false|array $items Array of menu items, otherwise false.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_get_nav_menu_items( $menu, $args = array() ) {&nbsp;</div></li><li><div>  $menu = wp_get_nav_menu_object( $menu );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $menu ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  static $fetched = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $items = get_objects_in_term( $menu-&gt;term_id, 'nav_menu' );&nbsp;</div></li><li><div>  if ( is_wp_error( $items ) ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $defaults = array( 'order' =&gt; 'ASC', 'orderby' =&gt; 'menu_order', 'post_type' =&gt; 'nav_menu_item', &nbsp;</div></li><li><div>      'post_status' =&gt; 'publish', 'output' =&gt; ARRAY_A, 'output_key' =&gt; 'menu_order', 'nopaging' =&gt; true );&nbsp;</div></li><li><div>  $args = wp_parse_args( $args, $defaults );&nbsp;</div></li><li><div>  $args['include'] = $items;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $items ) ) {&nbsp;</div></li><li><div>      $items = get_posts( $args );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $items = array();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Get all posts and terms at once to prime the caches</span>&nbsp;</div></li><li><div>  if ( empty( $fetched[$menu-&gt;term_id] ) || wp_using_ext_object_cache() ) {&nbsp;</div></li><li><div>      $fetched[$menu-&gt;term_id] = true;&nbsp;</div></li><li><div>      $posts = array();&nbsp;</div></li><li><div>      $terms = array();&nbsp;</div></li><li><div>      foreach ( $items as $item ) {&nbsp;</div></li><li><div>          $object_id = get_post_meta( $item-&gt;ID, '_menu_item_object_id', true );&nbsp;</div></li><li><div>          $object = get_post_meta( $item-&gt;ID, '_menu_item_object', true );&nbsp;</div></li><li><div>          $type = get_post_meta( $item-&gt;ID, '_menu_item_type', true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( 'post_type' == $type )&nbsp;</div></li><li><div>              $posts[$object][] = $object_id;&nbsp;</div></li><li><div>          elseif ( 'taxonomy' == $type)&nbsp;</div></li><li><div>              $terms[$object][] = $object_id;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $posts ) ) {&nbsp;</div></li><li><div>          foreach ( array_keys($posts) as $post_type ) {&nbsp;</div></li><li><div>              get_posts( array('post__in' =&gt; $posts[$post_type], 'post_type' =&gt; $post_type, 'nopaging' =&gt; true, 'update_post_term_cache' =&gt; false) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      unset($posts);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $terms ) ) {&nbsp;</div></li><li><div>          foreach ( array_keys($terms) as $taxonomy ) {&nbsp;</div></li><li><div>              get_terms( $taxonomy, array(&nbsp;</div></li><li><div>                  'include' =&gt; $terms[ $taxonomy ], &nbsp;</div></li><li><div>                  'hierarchical' =&gt; false, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      unset($terms);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $items = array_map( 'wp_setup_nav_menu_item', $items );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! is_admin() ) { <span class="comment">// Remove invalid items only in front end</span>&nbsp;</div></li><li><div>      $items = array_filter( $items, '_is_valid_nav_menu_item' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ARRAY_A == $args['output'] ) {&nbsp;</div></li><li><div>      $GLOBALS['_menu_item_sort_prop'] = $args['output_key'];&nbsp;</div></li><li><div>      usort($items, '_sort_nav_menu_items');&nbsp;</div></li><li><div>      $i = 1;&nbsp;</div></li><li><div>      foreach ( $items as $k =&gt; $item ) {&nbsp;</div></li><li><div>          $items[$k]-&gt;{$args['output_key']} = $i++;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the navigation menu items being returned.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $items An array of menu item post objects.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object $menu  The menu object.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $args  An array of arguments used to retrieve menu item objects.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'wp_get_nav_menu_items', $items, $menu, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Decorates a menu item object with the shared navigation menu item properties.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Properties:</span>&nbsp;</div></li><li><div><span class="comment"> * - ID:               The term_id if the menu item represents a taxonomy term.</span>&nbsp;</div></li><li><div><span class="comment"> * - attr_title:       The title attribute of the link element for this menu item.</span>&nbsp;</div></li><li><div><span class="comment"> * - classes:          The array of class attribute values for the link element of this menu item.</span>&nbsp;</div></li><li><div><span class="comment"> * - db_id:            The DB ID of this item as a nav_menu_item object, if it exists (0 if it doesn't exist).</span>&nbsp;</div></li><li><div><span class="comment"> * - description:      The description of this menu item.</span>&nbsp;</div></li><li><div><span class="comment"> * - menu_item_parent: The DB ID of the nav_menu_item that is this item's menu parent, if any. 0 otherwise.</span>&nbsp;</div></li><li><div><span class="comment"> * - object:           The type of object originally represented, such as &quot;category, &quot; &quot;post&quot;, or &quot;attachment.&quot;</span>&nbsp;</div></li><li><div><span class="comment"> * - object_id:        The DB ID of the original object this menu item represents, e.g. ID for posts and term_id for categories.</span>&nbsp;</div></li><li><div><span class="comment"> * - post_parent:      The DB ID of the original object's parent object, if any (0 otherwise).</span>&nbsp;</div></li><li><div><span class="comment"> * - post_title:       A &quot;no title&quot; label if menu item represents a post that lacks a title.</span>&nbsp;</div></li><li><div><span class="comment"> * - target:           The target attribute of the link element for this menu item.</span>&nbsp;</div></li><li><div><span class="comment"> * - title:            The title of this menu item.</span>&nbsp;</div></li><li><div><span class="comment"> * - type:             The family of objects originally represented, such as &quot;post_type&quot; or &quot;taxonomy.&quot;</span>&nbsp;</div></li><li><div><span class="comment"> * - type_label:       The singular label used to describe this type of menu item.</span>&nbsp;</div></li><li><div><span class="comment"> * - url:              The URL to which this menu item points.</span>&nbsp;</div></li><li><div><span class="comment"> * - xfn:              The XFN relationship expressed in the link of this menu item.</span>&nbsp;</div></li><li><div><span class="comment"> * - _invalid:         Whether the menu item represents an object that no longer exists.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object $menu_item The menu item to modify.</span>&nbsp;</div></li><li><div><span class="comment"> * @return object $menu_item The menu item with standard menu item properties.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_setup_nav_menu_item( $menu_item ) {&nbsp;</div></li><li><div>  if ( isset( $menu_item-&gt;post_type ) ) {&nbsp;</div></li><li><div>      if ( 'nav_menu_item' == $menu_item-&gt;post_type ) {&nbsp;</div></li><li><div>          $menu_item-&gt;db_id = (int) $menu_item-&gt;ID;&nbsp;</div></li><li><div>          $menu_item-&gt;menu_item_parent = ! isset( $menu_item-&gt;menu_item_parent ) ? get_post_meta( $menu_item-&gt;ID, '_menu_item_menu_item_parent', true ) : $menu_item-&gt;menu_item_parent;&nbsp;</div></li><li><div>          $menu_item-&gt;object_id = ! isset( $menu_item-&gt;object_id ) ? get_post_meta( $menu_item-&gt;ID, '_menu_item_object_id', true ) : $menu_item-&gt;object_id;&nbsp;</div></li><li><div>          $menu_item-&gt;object = ! isset( $menu_item-&gt;object ) ? get_post_meta( $menu_item-&gt;ID, '_menu_item_object', true ) : $menu_item-&gt;object;&nbsp;</div></li><li><div>          $menu_item-&gt;type = ! isset( $menu_item-&gt;type ) ? get_post_meta( $menu_item-&gt;ID, '_menu_item_type', true ) : $menu_item-&gt;type;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( 'post_type' == $menu_item-&gt;type ) {&nbsp;</div></li><li><div>              $object = get_post_type_object( $menu_item-&gt;object );&nbsp;</div></li><li><div>              if ( $object ) {&nbsp;</div></li><li><div>                  $menu_item-&gt;type_label = $object-&gt;labels-&gt;singular_name;&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $menu_item-&gt;type_label = $menu_item-&gt;object;&nbsp;</div></li><li><div>                  $menu_item-&gt;_invalid = true;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $menu_item-&gt;url = get_permalink( $menu_item-&gt;object_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $original_object = get_post( $menu_item-&gt;object_id );&nbsp;</div></li><li><div>              <span class="comment">/** This filter is documented in wp-includes/post-template.php */</span>&nbsp;</div></li><li><div>              $original_title = apply_filters( 'the_title', $original_object-&gt;post_title, $original_object-&gt;ID );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( '' === $original_title ) {&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">/** translators: %d: ID of a post */</span></span>&nbsp;</div></li><li><div>                  $original_title = sprintf( __( '#%d (no title)' ), $original_object-&gt;ID );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $menu_item-&gt;title = '' == $menu_item-&gt;post_title ? $original_title : $menu_item-&gt;post_title;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          } elseif ( 'post_type_archive' == $menu_item-&gt;type ) {&nbsp;</div></li><li><div>              $object =  get_post_type_object( $menu_item-&gt;object );&nbsp;</div></li><li><div>              if ( $object ) {&nbsp;</div></li><li><div>                  $menu_item-&gt;title = '' == $menu_item-&gt;post_title ? $object-&gt;labels-&gt;archives : $menu_item-&gt;post_title;&nbsp;</div></li><li><div>                  $post_type_description = $object-&gt;description;&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $menu_item-&gt;_invalid = true;&nbsp;</div></li><li><div>                  $post_type_description = '';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $menu_item-&gt;type_label = __( 'Post Type Archive' );&nbsp;</div></li><li><div>              $post_content = wp_trim_words( $menu_item-&gt;post_content, 200 );&nbsp;</div></li><li><div>              $post_type_description = '' == $post_content ? $post_type_description : $post_content; &nbsp;</div></li><li><div>              $menu_item-&gt;url = get_post_type_archive_link( $menu_item-&gt;object );&nbsp;</div></li><li><div>          } elseif ( 'taxonomy' == $menu_item-&gt;type ) {&nbsp;</div></li><li><div>              $object = get_taxonomy( $menu_item-&gt;object );&nbsp;</div></li><li><div>              if ( $object ) {&nbsp;</div></li><li><div>                  $menu_item-&gt;type_label = $object-&gt;labels-&gt;singular_name;&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $menu_item-&gt;type_label = $menu_item-&gt;object;&nbsp;</div></li><li><div>                  $menu_item-&gt;_invalid = true;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $term_url = get_term_link( (int) $menu_item-&gt;object_id, $menu_item-&gt;object );&nbsp;</div></li><li><div>              $menu_item-&gt;url = !is_wp_error( $term_url ) ? $term_url : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $original_title = get_term_field( 'name', $menu_item-&gt;object_id, $menu_item-&gt;object, 'raw' );&nbsp;</div></li><li><div>              if ( is_wp_error( $original_title ) )&nbsp;</div></li><li><div>                  $original_title = false;&nbsp;</div></li><li><div>              $menu_item-&gt;title = '' == $menu_item-&gt;post_title ? $original_title : $menu_item-&gt;post_title;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $menu_item-&gt;type_label = __('Custom Link');&nbsp;</div></li><li><div>              $menu_item-&gt;title = $menu_item-&gt;post_title;&nbsp;</div></li><li><div>              $menu_item-&gt;url = ! isset( $menu_item-&gt;url ) ? get_post_meta( $menu_item-&gt;ID, '_menu_item_url', true ) : $menu_item-&gt;url;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $menu_item-&gt;target = ! isset( $menu_item-&gt;target ) ? get_post_meta( $menu_item-&gt;ID, '_menu_item_target', true ) : $menu_item-&gt;target;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Filters a navigation menu item's title attribute.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param string $item_title The menu item title attribute.</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          $menu_item-&gt;attr_title = ! isset( $menu_item-&gt;attr_title ) ? apply_filters( 'nav_menu_attr_title', $menu_item-&gt;post_excerpt ) : $menu_item-&gt;attr_title;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! isset( $menu_item-&gt;description ) ) {&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Filters a navigation menu item's description.</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param string $description The menu item description.</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $menu_item-&gt;description = apply_filters( 'nav_menu_description', wp_trim_words( $menu_item-&gt;post_content, 200 ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $menu_item-&gt;classes = ! isset( $menu_item-&gt;classes ) ? (array) get_post_meta( $menu_item-&gt;ID, '_menu_item_classes', true ) : $menu_item-&gt;classes;&nbsp;</div></li><li><div>          $menu_item-&gt;xfn = ! isset( $menu_item-&gt;xfn ) ? get_post_meta( $menu_item-&gt;ID, '_menu_item_xfn', true ) : $menu_item-&gt;xfn;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $menu_item-&gt;db_id = 0;&nbsp;</div></li><li><div>          $menu_item-&gt;menu_item_parent = 0;&nbsp;</div></li><li><div>          $menu_item-&gt;object_id = (int) $menu_item-&gt;ID;&nbsp;</div></li><li><div>          $menu_item-&gt;type = 'post_type';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $object = get_post_type_object( $menu_item-&gt;post_type );&nbsp;</div></li><li><div>          $menu_item-&gt;object = $object-&gt;name;&nbsp;</div></li><li><div>          $menu_item-&gt;type_label = $object-&gt;labels-&gt;singular_name;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( '' === $menu_item-&gt;post_title ) {&nbsp;</div></li><li><div>              <span class="comment"><span class="comment">/** translators: %d: ID of a post */</span></span>&nbsp;</div></li><li><div>              $menu_item-&gt;post_title = sprintf( __( '#%d (no title)' ), $menu_item-&gt;ID );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $menu_item-&gt;title = $menu_item-&gt;post_title;&nbsp;</div></li><li><div>          $menu_item-&gt;url = get_permalink( $menu_item-&gt;ID );&nbsp;</div></li><li><div>          $menu_item-&gt;target = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** This filter is documented in wp-includes/nav-menu.php */</span></span>&nbsp;</div></li><li><div>          $menu_item-&gt;attr_title = apply_filters( 'nav_menu_attr_title', '' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** This filter is documented in wp-includes/nav-menu.php */</span></span>&nbsp;</div></li><li><div>          $menu_item-&gt;description = apply_filters( 'nav_menu_description', '' );&nbsp;</div></li><li><div>          $menu_item-&gt;classes = array();&nbsp;</div></li><li><div>          $menu_item-&gt;xfn = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } elseif ( isset( $menu_item-&gt;taxonomy ) ) {&nbsp;</div></li><li><div>      $menu_item-&gt;ID = $menu_item-&gt;term_id;&nbsp;</div></li><li><div>      $menu_item-&gt;db_id = 0;&nbsp;</div></li><li><div>      $menu_item-&gt;menu_item_parent = 0;&nbsp;</div></li><li><div>      $menu_item-&gt;object_id = (int) $menu_item-&gt;term_id;&nbsp;</div></li><li><div>      $menu_item-&gt;post_parent = (int) $menu_item-&gt;parent;&nbsp;</div></li><li><div>      $menu_item-&gt;type = 'taxonomy';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $object = get_taxonomy( $menu_item-&gt;taxonomy );&nbsp;</div></li><li><div>      $menu_item-&gt;object = $object-&gt;name;&nbsp;</div></li><li><div>      $menu_item-&gt;type_label = $object-&gt;labels-&gt;singular_name;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $menu_item-&gt;title = $menu_item-&gt;name;&nbsp;</div></li><li><div>      $menu_item-&gt;url = get_term_link( $menu_item, $menu_item-&gt;taxonomy );&nbsp;</div></li><li><div>      $menu_item-&gt;target = '';&nbsp;</div></li><li><div>      $menu_item-&gt;attr_title = '';&nbsp;</div></li><li><div>      $menu_item-&gt;description = get_term_field( 'description', $menu_item-&gt;term_id, $menu_item-&gt;taxonomy );&nbsp;</div></li><li><div>      $menu_item-&gt;classes = array();&nbsp;</div></li><li><div>      $menu_item-&gt;xfn = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters a navigation menu item object.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object $menu_item The menu item object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'wp_setup_nav_menu_item', $menu_item );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Get the menu items associated with a particular object.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $object_id   The ID of the original object.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $object_type The type of object, such as &quot;taxonomy&quot; or &quot;post_type.&quot;</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $taxonomy    If $object_type is &quot;taxonomy&quot;, $taxonomy is the name of the tax that $object_id belongs to</span>&nbsp;</div></li><li><div><span class="comment"> * @return array The array of menu item IDs; empty array if none;</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_get_associated_nav_menu_items( $object_id = 0, $object_type = 'post_type', $taxonomy = '' ) {&nbsp;</div></li><li><div>  $object_id = (int) $object_id;&nbsp;</div></li><li><div>  $menu_item_ids = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $query = new WP_Query;&nbsp;</div></li><li><div>  $menu_items = $query-&gt;query(&nbsp;</div></li><li><div>      array(&nbsp;</div></li><li><div>          'meta_key' =&gt; '_menu_item_object_id', &nbsp;</div></li><li><div>          'meta_value' =&gt; $object_id, &nbsp;</div></li><li><div>          'post_status' =&gt; 'any', &nbsp;</div></li><li><div>          'post_type' =&gt; 'nav_menu_item', &nbsp;</div></li><li><div>          'posts_per_page' =&gt; -1, &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  foreach ( (array) $menu_items as $menu_item ) {&nbsp;</div></li><li><div>      if ( isset( $menu_item-&gt;ID ) && is_nav_menu_item( $menu_item-&gt;ID ) ) {&nbsp;</div></li><li><div>          $menu_item_type = get_post_meta( $menu_item-&gt;ID, '_menu_item_type', true );&nbsp;</div></li><li><div>          if (&nbsp;</div></li><li><div>              'post_type' == $object_type &&&nbsp;</div></li><li><div>              'post_type' == $menu_item_type&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>              $menu_item_ids[] = (int) $menu_item-&gt;ID;&nbsp;</div></li><li><div>          } elseif (&nbsp;</div></li><li><div>              'taxonomy' == $object_type &&&nbsp;</div></li><li><div>              'taxonomy' == $menu_item_type &&&nbsp;</div></li><li><div>              get_post_meta( $menu_item-&gt;ID, '_menu_item_object', true ) == $taxonomy&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>              $menu_item_ids[] = (int) $menu_item-&gt;ID;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return array_unique( $menu_item_ids );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Callback for handling a menu item when its original object is deleted.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $object_id The ID of the original object being trashed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _wp_delete_post_menu_item( $object_id = 0 ) {&nbsp;</div></li><li><div>  $object_id = (int) $object_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $menu_item_ids = wp_get_associated_nav_menu_items( $object_id, 'post_type' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( (array) $menu_item_ids as $menu_item_id ) {&nbsp;</div></li><li><div>      wp_delete_post( $menu_item_id, true );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Serves as a callback for handling a menu item when its original object is deleted.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $object_id Optional. The ID of the original object being trashed. Default 0.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $tt_id     Term taxonomy ID. Unused.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $taxonomy  Taxonomy slug.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _wp_delete_tax_menu_item( $object_id = 0, $tt_id, $taxonomy ) {&nbsp;</div></li><li><div>  $object_id = (int) $object_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $menu_item_ids = wp_get_associated_nav_menu_items( $object_id, 'taxonomy', $taxonomy );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( (array) $menu_item_ids as $menu_item_id ) {&nbsp;</div></li><li><div>      wp_delete_post( $menu_item_id, true );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Automatically add newly published page objects to menus with that as an option.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $new_status The new status of the post object.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $old_status The old status of the post object.</span>&nbsp;</div></li><li><div><span class="comment"> * @param object $post       The post object being transitioned from one status to another.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _wp_auto_add_pages_to_menu( $new_status, $old_status, $post ) {&nbsp;</div></li><li><div>  if ( 'publish' != $new_status || 'publish' == $old_status || 'page' != $post-&gt;post_type )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  if ( ! empty( $post-&gt;post_parent ) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  $auto_add = get_option( 'nav_menu_options' );&nbsp;</div></li><li><div>  if ( empty( $auto_add ) || ! is_array( $auto_add ) || ! isset( $auto_add['auto_add'] ) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  $auto_add = $auto_add['auto_add'];&nbsp;</div></li><li><div>  if ( empty( $auto_add ) || ! is_array( $auto_add ) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $args = array(&nbsp;</div></li><li><div>      'menu-item-object-id' =&gt; $post-&gt;ID, &nbsp;</div></li><li><div>      'menu-item-object' =&gt; $post-&gt;post_type, &nbsp;</div></li><li><div>      'menu-item-type' =&gt; 'post_type', &nbsp;</div></li><li><div>      'menu-item-status' =&gt; 'publish', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( $auto_add as $menu_id ) {&nbsp;</div></li><li><div>      $items = wp_get_nav_menu_items( $menu_id, array( 'post_status' =&gt; 'publish, draft' ) );&nbsp;</div></li><li><div>      if ( ! is_array( $items ) )&nbsp;</div></li><li><div>          continue;&nbsp;</div></li><li><div>      foreach ( $items as $item ) {&nbsp;</div></li><li><div>          if ( $post-&gt;ID == $item-&gt;object_id )&nbsp;</div></li><li><div>              continue 2;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      wp_update_nav_menu_item( $menu_id, 0, $args );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>wordpress</li><li><span></span>file</li><li><span></span></li><li><span></span>wp-include</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>