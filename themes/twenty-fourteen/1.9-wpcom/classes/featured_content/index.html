<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="theme" data-version="1.9-wpcom" data-slug="twenty-fourteen" data-type="class" data-id="11534"><head xmlns="http://www.w3.org/1999/xhtml"><title> featured_content | class | Twenty Fourteen | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="Featured_Content, class, theme, twenty-fourteen, 1.9-wpcom" /><meta name="description" content="Featured Content." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.10"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=d8ecff4dee6c5d56260e4bdb235902a1' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.10' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/featured_content/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Ffeatured_content%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Ffeatured_content%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"theme-twenty-fourteen-1.9-wpcom-class-featured_content","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="featured_content" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to themes." href="http://hookr.io/themes/" class=""><span property="name">themes</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to twenty-fourteen." href="http://hookr.io/themes/twenty-fourteen/" class="plugin"><span property="name">twenty-fourteen</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 1.9-wpcom." href="http://hookr.io/themes/twenty-fourteen/1.9-wpcom/" class="H_VERSION"><span property="name">1.9-wpcom</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/themes/twenty-fourteen/1.9-wpcom/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">featured_content</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="59"><a href="http://hookr.io/themes/twenty-fourteen/1.9-wpcom/all/" title="All">All <span class="count badge">59</span></a></li><li class="" data-id="new" data-count="3"><a href="http://hookr.io/themes/twenty-fourteen/1.9-wpcom/new/" title="New">New <span class="count badge">3</span></a></li><li class="" data-id="hooks" data-count="11"><a href="http://hookr.io/themes/twenty-fourteen/1.9-wpcom/hooks/" title="Hooks">Hooks <span class="count badge">11</span></a></li><li class="" data-id="action" data-count="4"><a href="http://hookr.io/themes/twenty-fourteen/1.9-wpcom/actions/" title="Actions">Actions <span class="count badge">4</span></a></li><li class="" data-id="filter" data-count="7"><a href="http://hookr.io/themes/twenty-fourteen/1.9-wpcom/filters/" title="Filters">Filters <span class="count badge">7</span></a></li><li class="active" data-id="class" data-count="2"><a href="http://hookr.io/themes/twenty-fourteen/1.9-wpcom/classes/" title="Classes">Classes <span class="count badge">2</span></a></li><li class="" data-id="constant" data-count="0"><a href="http://hookr.io/themes/twenty-fourteen/1.9-wpcom/constants/" title="Constants">Constants <span class="count badge">0</span></a></li><li class="" data-id="function" data-count="46"><a href="http://hookr.io/themes/twenty-fourteen/1.9-wpcom/functions/" title="Functions">Functions <span class="count badge">46</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/themes/twenty-fourteen/1.9-wpcom/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class=""><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class="active"><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>Featured_Content</strong></h1><p>Featured Content.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/themes/twenty-fourteen/1.9-wpcom/files/inc-featured-content/" class="file">/inc/featured-content.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="13" class="block" start="13"><li><div>class Featured_Content {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * The maximum number of posts a Featured Content area can contain.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * We define a default value here but themes can override&nbsp;</div></li><li><div>     * this by defining a &quot;max_posts&quot; entry in the second parameter&nbsp;</div></li><li><div>     * passed in the call to add_theme_support( 'featured-content' ).&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @see Featured_Content::init()&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @var int&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static $max_posts = 15;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Instantiate.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * All custom functionality will be hooked into the &quot;init&quot; action.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function setup() {&nbsp;</div></li><li><div>        add_action( 'init', array( __CLASS__, 'init' ), 30 );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Conditionally hook into WordPress.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Theme must declare that they support this module by adding&nbsp;</div></li><li><div>     * add_theme_support( 'featured-content' ); during after_setup_theme.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * If no theme support is found there is no need to hook into WordPress.&nbsp;</div></li><li><div>     * We'll just return early instead.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function init() {&nbsp;</div></li><li><div>        $theme_support = get_theme_support( 'featured-content' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Return early if theme does not support Featured Content.&nbsp;</div></li><li><div>        if ( ! $theme_support ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * An array of named arguments must be passed as the second parameter&nbsp;</div></li><li><div>         * of add_theme_support().&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        if ( ! isset( $theme_support[0] ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Return early if &quot;featured_content_filter&quot; has not been defined.&nbsp;</div></li><li><div>        if ( ! isset( $theme_support[0]['featured_content_filter'] ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $filter = $theme_support[0]['featured_content_filter'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Theme can override the number of max posts.&nbsp;</div></li><li><div>        if ( isset( $theme_support[0]['max_posts'] ) ) {&nbsp;</div></li><li><div>            self::$max_posts = absint( $theme_support[0]['max_posts'] );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_filter( $filter, array( __CLASS__, 'get_featured_posts' )    );&nbsp;</div></li><li><div>        add_action( 'customize_register', array( __CLASS__, 'customize_register' ), 9 );&nbsp;</div></li><li><div>        add_action( 'admin_init', array( __CLASS__, 'register_setting' )    );&nbsp;</div></li><li><div>        add_action( 'switch_theme', array( __CLASS__, 'delete_transient' )    );&nbsp;</div></li><li><div>        add_action( 'save_post', array( __CLASS__, 'delete_transient' )    );&nbsp;</div></li><li><div>        add_action( 'delete_post_tag', array( __CLASS__, 'delete_post_tag' )    );&nbsp;</div></li><li><div>        add_action( 'customize_controls_enqueue_scripts', array( __CLASS__, 'enqueue_scripts' )    );&nbsp;</div></li><li><div>        add_action( 'pre_get_posts', array( __CLASS__, 'pre_get_posts' )    );&nbsp;</div></li><li><div>        add_action( 'wp_loaded', array( __CLASS__, 'wp_loaded' )    );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Hide &quot;featured&quot; tag from the front end.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Has to run on wp_loaded so that the preview filters of the Customizer&nbsp;</div></li><li><div>     * have a chance to alter the value.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function wp_loaded() {&nbsp;</div></li><li><div>        if ( self::get_setting( 'hide-tag' ) ) {&nbsp;</div></li><li><div>            add_filter( 'get_terms', array( __CLASS__, 'hide_featured_term' ), 10, 3 );&nbsp;</div></li><li><div>            add_filter( 'get_the_terms', array( __CLASS__, 'hide_the_featured_term' ), 10, 3 );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Get featured posts.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array Array of featured posts.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function get_featured_posts() {&nbsp;</div></li><li><div>        $post_ids = self::get_featured_post_ids();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // No need to query if there is are no featured posts.&nbsp;</div></li><li><div>        if ( empty( $post_ids ) ) {&nbsp;</div></li><li><div>            return array();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $featured_posts = get_posts( array(&nbsp;</div></li><li><div>            'include' =&gt; $post_ids, &nbsp;</div></li><li><div>            'posts_per_page' =&gt; count( $post_ids ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $featured_posts;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Get featured post IDs&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * This function will return the an array containing the&nbsp;</div></li><li><div>     * post IDs of all featured posts.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Sets the &quot;featured_content_ids&quot; transient.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array Array of post IDs.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function get_featured_post_ids() {&nbsp;</div></li><li><div>        // Get array of cached results if they exist.&nbsp;</div></li><li><div>        $featured_ids = get_transient( 'featured_content_ids' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( false === $featured_ids ) {&nbsp;</div></li><li><div>            $settings = self::get_setting();&nbsp;</div></li><li><div>            $term = get_term_by( 'name', $settings['tag-name'], 'post_tag' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $term ) {&nbsp;</div></li><li><div>                // Query for featured posts.&nbsp;</div></li><li><div>                $featured_ids = get_posts( array(&nbsp;</div></li><li><div>                    'fields' =&gt; 'ids', &nbsp;</div></li><li><div>                    'numberposts' =&gt; self::$max_posts, &nbsp;</div></li><li><div>                    'suppress_filters' =&gt; false, &nbsp;</div></li><li><div>                    'tax_query' =&gt; array(&nbsp;</div></li><li><div>                        array(&nbsp;</div></li><li><div>                            'field' =&gt; 'term_id', &nbsp;</div></li><li><div>                            'taxonomy' =&gt; 'post_tag', &nbsp;</div></li><li><div>                            'terms' =&gt; $term-&gt;term_id, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Get sticky posts if no Featured Content exists.&nbsp;</div></li><li><div>            if ( ! $featured_ids ) {&nbsp;</div></li><li><div>                $featured_ids = self::get_sticky_posts();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            set_transient( 'featured_content_ids', $featured_ids );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Ensure correct format before return.&nbsp;</div></li><li><div>        return array_map( 'absint', $featured_ids );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Return an array with IDs of posts maked as sticky.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array Array of sticky posts.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function get_sticky_posts() {&nbsp;</div></li><li><div>        return array_slice( get_option( 'sticky_posts', array() ), 0, self::$max_posts );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Delete featured content ids transient.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Hooks in the &quot;save_post&quot; action.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @see Featured_Content::validate_settings().&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function delete_transient() {&nbsp;</div></li><li><div>        delete_transient( 'featured_content_ids' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Exclude featured posts from the home page blog query.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Filter the home page posts, and remove any featured post ID's from it.&nbsp;</div></li><li><div>     * Hooked onto the 'pre_get_posts' action, this changes the parameters of&nbsp;</div></li><li><div>     * the query before it gets any posts.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param WP_Query $query WP_Query object.&nbsp;</div></li><li><div>     * @return WP_Query Possibly-modified WP_Query.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function pre_get_posts( $query ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Bail if not home or not main query.&nbsp;</div></li><li><div>        if ( ! $query-&gt;is_home() || ! $query-&gt;is_main_query() ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Bail if the blog page is not the front page.&nbsp;</div></li><li><div>        if ( 'posts' !== get_option( 'show_on_front' ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $featured = self::get_featured_post_ids();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Bail if no featured posts.&nbsp;</div></li><li><div>        if ( ! $featured ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // We need to respect post ids already in the blacklist.&nbsp;</div></li><li><div>        $post__not_in = $query-&gt;get( 'post__not_in' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $post__not_in ) ) {&nbsp;</div></li><li><div>            $featured = array_merge( (array) $post__not_in, $featured );&nbsp;</div></li><li><div>            $featured = array_unique( $featured );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $query-&gt;set( 'post__not_in', $featured );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Reset tag option when the saved tag is deleted.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * It's important to mention that the transient needs to be deleted, &nbsp;</div></li><li><div>     * too. While it may not be obvious by looking at the function alone, &nbsp;</div></li><li><div>     * the transient is deleted by Featured_Content::validate_settings().&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Hooks in the &quot;delete_post_tag&quot; action.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @see Featured_Content::validate_settings().&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param int $tag_id The term_id of the tag that has been deleted.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function delete_post_tag( $tag_id ) {&nbsp;</div></li><li><div>        $settings = self::get_setting();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $settings['tag-id'] ) || $tag_id != $settings['tag-id'] ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $settings['tag-id'] = 0;&nbsp;</div></li><li><div>        $settings = self::validate_settings( $settings );&nbsp;</div></li><li><div>        update_option( 'featured-content', $settings );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Hide featured tag from displaying when global terms are queried from the front end.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Hooks into the &quot;get_terms&quot; filter.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param array $terms      List of term objects. This is the return value of get_terms().&nbsp;</div></li><li><div>     * @param array $taxonomies An array of taxonomy slugs.&nbsp;</div></li><li><div>     * @return array A filtered array of terms.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @uses Featured_Content::get_setting()&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function hide_featured_term( $terms, $taxonomies, $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // This filter is only appropriate on the front end.&nbsp;</div></li><li><div>        if ( is_admin() ) {&nbsp;</div></li><li><div>            return $terms;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // We only want to hide the featured tag.&nbsp;</div></li><li><div>        if ( ! in_array( 'post_tag', $taxonomies ) ) {&nbsp;</div></li><li><div>            return $terms;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Bail if no terms were returned.&nbsp;</div></li><li><div>        if ( empty( $terms ) ) {&nbsp;</div></li><li><div>            return $terms;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Bail if term objects are unavailable.&nbsp;</div></li><li><div>        if ( 'all' != $args['fields'] ) {&nbsp;</div></li><li><div>            return $terms;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $settings = self::get_setting();&nbsp;</div></li><li><div>        foreach ( $terms as $order =&gt; $term ) {&nbsp;</div></li><li><div>            if ( ( $settings['tag-id'] === $term-&gt;term_id || $settings['tag-name'] === $term-&gt;name ) && 'post_tag' === $term-&gt;taxonomy ) {&nbsp;</div></li><li><div>                unset( $terms[ $order ] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $terms;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Hide featured tag from display when terms associated with a post object&nbsp;</div></li><li><div>     * are queried from the front end.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Hooks into the &quot;get_the_terms&quot; filter.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param array $terms    A list of term objects. This is the return value of get_the_terms().&nbsp;</div></li><li><div>     * @param int   $id       The ID field for the post object that terms are associated with.&nbsp;</div></li><li><div>     * @param array $taxonomy An array of taxonomy slugs.&nbsp;</div></li><li><div>     * @return array Filtered array of terms.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @uses Featured_Content::get_setting()&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function hide_the_featured_term( $terms, $id, $taxonomy ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // This filter is only appropriate on the front end.&nbsp;</div></li><li><div>        if ( is_admin() ) {&nbsp;</div></li><li><div>            return $terms;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Make sure we are in the correct taxonomy.&nbsp;</div></li><li><div>        if ( 'post_tag' != $taxonomy ) {&nbsp;</div></li><li><div>            return $terms;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // No terms? Return early!&nbsp;</div></li><li><div>        if ( empty( $terms ) ) {&nbsp;</div></li><li><div>            return $terms;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $settings = self::get_setting();&nbsp;</div></li><li><div>        foreach ( $terms as $order =&gt; $term ) {&nbsp;</div></li><li><div>            if ( ( $settings['tag-id'] === $term-&gt;term_id || $settings['tag-name'] === $term-&gt;name ) && 'post_tag' === $term-&gt;taxonomy ) {&nbsp;</div></li><li><div>                unset( $terms[ $term-&gt;term_id ] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $terms;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Register custom setting on the Settings -&gt; Reading screen.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function register_setting() {&nbsp;</div></li><li><div>        register_setting( 'featured-content', 'featured-content', array( __CLASS__, 'validate_settings' ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Add settings to the Customizer.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param WP_Customize_Manager $wp_customize Customizer object.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function customize_register( $wp_customize ) {&nbsp;</div></li><li><div>        $wp_customize-&gt;add_section( 'featured_content', array(&nbsp;</div></li><li><div>            'title' =&gt; __( 'Featured Content', 'twentyfourteen' ), &nbsp;</div></li><li><div>            'description' =&gt; sprintf( __( 'Use a &lt;a href=&quot;%1$s&quot;&gt;tag&lt;/a&gt; to feature your posts. If no posts match the tag, &lt;a href=&quot;%2$s&quot;&gt;sticky posts&lt;/a&gt; will be displayed instead.', 'twentyfourteen' ), &nbsp;</div></li><li><div>                esc_url( add_query_arg( 'tag', _x( 'featured', 'featured content default tag slug', 'twentyfourteen' ), admin_url( 'edit.php' ) ) ), &nbsp;</div></li><li><div>                admin_url( 'edit.php?show_sticky=1' )&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'priority' =&gt; 130, &nbsp;</div></li><li><div>            'theme_supports' =&gt; 'featured-content', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add Featured Content settings.&nbsp;</div></li><li><div>        $wp_customize-&gt;add_setting( 'featured-content[tag-name]', array(&nbsp;</div></li><li><div>            'default' =&gt; _x( 'featured', 'featured content default tag slug', 'twentyfourteen' ), &nbsp;</div></li><li><div>            'type' =&gt; 'option', &nbsp;</div></li><li><div>            'sanitize_js_callback' =&gt; array( __CLASS__, 'delete_transient' ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>        $wp_customize-&gt;add_setting( 'featured-content[hide-tag]', array(&nbsp;</div></li><li><div>            'default' =&gt; true, &nbsp;</div></li><li><div>            'type' =&gt; 'option', &nbsp;</div></li><li><div>            'sanitize_js_callback' =&gt; array( __CLASS__, 'delete_transient' ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add Featured Content controls.&nbsp;</div></li><li><div>        $wp_customize-&gt;add_control( 'featured-content[tag-name]', array(&nbsp;</div></li><li><div>            'label' =&gt; __( 'Tag Name', 'twentyfourteen' ), &nbsp;</div></li><li><div>            'section' =&gt; 'featured_content', &nbsp;</div></li><li><div>            'priority' =&gt; 20, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>        $wp_customize-&gt;add_control( 'featured-content[hide-tag]', array(&nbsp;</div></li><li><div>            'label' =&gt; __( 'Don&rsquo;t display tag on front end.', 'twentyfourteen' ), &nbsp;</div></li><li><div>            'section' =&gt; 'featured_content', &nbsp;</div></li><li><div>            'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>            'priority' =&gt; 30, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Enqueue the tag suggestion script.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function enqueue_scripts() {&nbsp;</div></li><li><div>        wp_enqueue_script( 'featured-content-suggest', get_template_directory_uri() . '/js/featured-content-admin.js', array( 'jquery', 'suggest' ), '20131022', true );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Get featured content settings.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Get all settings recognized by this module. This function&nbsp;</div></li><li><div>     * will return all settings whether or not they have been stored&nbsp;</div></li><li><div>     * in the database yet. This ensures that all keys are available&nbsp;</div></li><li><div>     * at all times.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * In the event that you only require one setting, you may pass&nbsp;</div></li><li><div>     * its name as the first parameter to the function and only that&nbsp;</div></li><li><div>     * value will be returned.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param string $key The key of a recognized setting.&nbsp;</div></li><li><div>     * @return mixed Array of all settings by default. A single value if passed as first parameter.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function get_setting( $key = 'all' ) {&nbsp;</div></li><li><div>        $saved = (array) get_option( 'featured-content' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $defaults = array(&nbsp;</div></li><li><div>            'hide-tag' =&gt; 1, &nbsp;</div></li><li><div>            'tag-id' =&gt; 0, &nbsp;</div></li><li><div>            'tag-name' =&gt; _x( 'featured', 'featured content default tag slug', 'twentyfourteen' ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $options = wp_parse_args( $saved, $defaults );&nbsp;</div></li><li><div>        $options = array_intersect_key( $options, $defaults );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( 'all' != $key ) {&nbsp;</div></li><li><div>            return isset( $options[ $key ] ) ? $options[ $key ] : false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $options;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Validate featured content settings.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Make sure that all user supplied content is in an expected&nbsp;</div></li><li><div>     * format before saving to the database. This function will also&nbsp;</div></li><li><div>     * delete the transient set in Featured_Content::get_featured_content().&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @static&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @since Twenty Fourteen 1.0&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param array $input Array of settings input.&nbsp;</div></li><li><div>     * @return array Validated settings output.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function validate_settings( $input ) {&nbsp;</div></li><li><div>        $output = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $input['tag-name'] ) ) {&nbsp;</div></li><li><div>            $output['tag-id'] = 0;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $term = get_term_by( 'name', $input['tag-name'], 'post_tag' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $term ) {&nbsp;</div></li><li><div>                $output['tag-id'] = $term-&gt;term_id;&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $new_tag = wp_create_tag( $input['tag-name'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( ! is_wp_error( $new_tag ) && isset( $new_tag['term_id'] ) ) {&nbsp;</div></li><li><div>                    $output['tag-id'] = $new_tag['term_id'];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $output['tag-name'] = $input['tag-name'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output['hide-tag'] = isset( $input['hide-tag'] ) && $input['hide-tag'] ? 1 : 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Delete the featured post ids transient.&nbsp;</div></li><li><div>        self::delete_transient();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $output;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>} // Featured_Content&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 1.5</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/themes/twenty-fourteen/1.9-wpcom/classes/featured_content/" class="active">1.9-wpcom</a></li><li><a href="http://hookr.io/themes/twenty-fourteen/1.7/classes/featured_content/" class="">1.7</a></li><li><a href="http://hookr.io/themes/twenty-fourteen/1.5/classes/featured_content/" class="">1.5</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>theme</li><li><span></span>class</li><li><span></span>Featured_Content</li><li><span></span>Twenty Fourteen</li><li><span></span>1.9-wpcom</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>