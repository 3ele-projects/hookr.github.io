<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="theme" data-version="3.7.1" data-slug="evolve" data-type="file" data-id="98362"><head xmlns="http://www.w3.org/1999/xhtml"><title> library-admin-redux-framework-framework | file | Evolve | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, theme, evolve, 3.7.1" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=b02e578363d435a105958f99e4340adf' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/library-admin-redux-framework-framework/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Flibrary-admin-redux-framework-framework%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Flibrary-admin-redux-framework-framework%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"theme-evolve-3.7.1-file-library-admin-redux-framework-framework","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="library-admin-redux-framework-framework" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to themes." href="http://hookr.io/themes/" class=""><span property="name">themes</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to evolve." href="http://hookr.io/themes/evolve/" class="plugin"><span property="name">evolve</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 3.7.1." href="http://hookr.io/themes/evolve/3.7.1/" class="H_VERSION"><span property="name">3.7.1</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/themes/evolve/3.7.1/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">library-admin-redux-framework&hellip;</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="742"><a href="http://hookr.io/themes/evolve/3.7.1/all/" title="All">All <span class="count badge">742</span></a></li><li class="" data-id="new" data-count="44"><a href="http://hookr.io/themes/evolve/3.7.1/new/" title="New">New <span class="count badge">44</span></a></li><li class="" data-id="hooks" data-count="473"><a href="http://hookr.io/themes/evolve/3.7.1/hooks/" title="Hooks">Hooks <span class="count badge">473</span></a></li><li class="" data-id="action" data-count="274"><a href="http://hookr.io/themes/evolve/3.7.1/actions/" title="Actions">Actions <span class="count badge">274</span></a></li><li class="" data-id="filter" data-count="199"><a href="http://hookr.io/themes/evolve/3.7.1/filters/" title="Filters">Filters <span class="count badge">199</span></a></li><li class="" data-id="class" data-count="123"><a href="http://hookr.io/themes/evolve/3.7.1/classes/" title="Classes">Classes <span class="count badge">123</span></a></li><li class="" data-id="constant" data-count="17"><a href="http://hookr.io/themes/evolve/3.7.1/constants/" title="Constants">Constants <span class="count badge">17</span></a></li><li class="" data-id="function" data-count="129"><a href="http://hookr.io/themes/evolve/3.7.1/functions/" title="Functions">Functions <span class="count badge">129</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/themes/evolve/3.7.1/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class=""><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class="active"><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/library/admin/redux-framework/framework.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Redux Framework is free software: you can redistribute it and/or modify</span>&nbsp;</div></li><li><div><span class="comment">   * it under the terms of the GNU General Public License as published by</span>&nbsp;</div></li><li><div><span class="comment">   * the Free Software Foundation, either version 3 of the License, or</span>&nbsp;</div></li><li><div><span class="comment">   * any later version.</span>&nbsp;</div></li><li><div><span class="comment">   * Redux Framework is distributed in the hope that it will be useful, </span>&nbsp;</div></li><li><div><span class="comment">   * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>&nbsp;</div></li><li><div><span class="comment">   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>&nbsp;</div></li><li><div><span class="comment">   * GNU General Public License for more details.</span>&nbsp;</div></li><li><div><span class="comment">   * You should have received a copy of the GNU General Public License</span>&nbsp;</div></li><li><div><span class="comment">   * along with Redux Framework. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @package     Redux_Framework</span>&nbsp;</div></li><li><div><span class="comment">   * @subpackage  Core</span>&nbsp;</div></li><li><div><span class="comment">   * @author      Redux Framework Team</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  <span class="comment">// Exit if accessed directly</span>&nbsp;</div></li><li><div>  if ( ! defined( 'ABSPATH' ) ) {&nbsp;</div></li><li><div>      exit;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! class_exists( 'ReduxFrameworkInstances' ) ) {&nbsp;</div></li><li><div>      <span class="comment">// Instance Container</span>&nbsp;</div></li><li><div>      require_once dirname( __FILE__ ) . '/inc/class.redux_instances.php';&nbsp;</div></li><li><div>      require_once dirname( __FILE__ ) . '/inc/lib.redux_instances.php';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( class_exists( 'ReduxFrameworkInstances' ) ) {&nbsp;</div></li><li><div>      add_action( 'redux/init', 'ReduxFrameworkInstances::get_instance' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Don't duplicate me!</span>&nbsp;</div></li><li><div>  if ( ! class_exists( 'ReduxFramework' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Redux CDN class</span>&nbsp;</div></li><li><div>      require_once dirname( __FILE__ ) . '/inc/class.redux_cdn.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Redux API class  :)</span>&nbsp;</div></li><li><div>      require_once dirname( __FILE__ ) . '/inc/class.redux_api.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// General helper functions</span>&nbsp;</div></li><li><div>      require_once dirname( __FILE__ ) . '/inc/class.redux_helpers.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// General functions</span>&nbsp;</div></li><li><div>      require_once dirname( __FILE__ ) . '/inc/class.redux_functions.php';&nbsp;</div></li><li><div>      require_once dirname( __FILE__ ) . '/inc/class.p.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      require_once dirname( __FILE__ ) . '/inc/class.thirdparty.fixes.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      require_once dirname( __FILE__ ) . '/inc/class.redux_filesystem.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      require_once dirname( __FILE__ ) . '/inc/class.redux_admin_notices.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// ThemeCheck checks</span>&nbsp;</div></li><li><div>      require_once dirname( __FILE__ ) . '/inc/themecheck/class.redux_themecheck.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Main ReduxFramework class</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      class ReduxFramework {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// ATTENTION DEVS</span>&nbsp;</div></li><li><div>          <span class="comment">// Please update the build number with each push, no matter how small.</span>&nbsp;</div></li><li><div>          <span class="comment">// This will make for easier support when we ask users what version they are using.</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          public static $_version = '3.6.3';&nbsp;</div></li><li><div>          public static $_dir;&nbsp;</div></li><li><div>          public static $_url;&nbsp;</div></li><li><div>          public static $_upload_dir;&nbsp;</div></li><li><div>          public static $_upload_url;&nbsp;</div></li><li><div>          public static $wp_content_url;&nbsp;</div></li><li><div>          public static $base_wp_content_url;&nbsp;</div></li><li><div>          public static $_is_plugin = true;&nbsp;</div></li><li><div>          public static $_as_plugin = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          public static function init() {&nbsp;</div></li><li><div>              $dir = Redux_Helpers::cleanFilePath( dirname( __FILE__ ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Windows-proof constants: replace backward by forward slashes. Thanks to: @peterbouwmeester</span>&nbsp;</div></li><li><div>              self::$_dir = trailingslashit( $dir );&nbsp;</div></li><li><div>              self::$wp_content_url = trailingslashit( Redux_Helpers::cleanFilePath( ( is_ssl() ? str_replace( 'http:<span class="comment"><span class="comment"><span class="comment">//'</span>, </span>'https:<span class="comment"><span class="comment">//'</span>, </span>WP_CONTENT_URL ) : WP_CONTENT_URL ) ) );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// See if Redux is a plugin or not</span>&nbsp;</div></li><li><div>              if ( strpos( Redux_Helpers::cleanFilePath( __FILE__ ), Redux_Helpers::cleanFilePath( get_stylesheet_directory() ) ) !== false || strpos( Redux_Helpers::cleanFilePath( __FILE__ ), Redux_Helpers::cleanFilePath( get_template_directory_uri() ) ) !== false || strpos( Redux_Helpers::cleanFilePath( __FILE__ ), Redux_Helpers::cleanFilePath( WP_CONTENT_DIR . '/themes/' ) ) !== false ) {&nbsp;</div></li><li><div>                  self::$_is_plugin = false;&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  <span class="comment">// Check if plugin is a symbolic link, see if it's a plugin. If embedded, we can't do a thing.</span>&nbsp;</div></li><li><div>                  if ( strpos( self::$_dir, ABSPATH ) === false ) {&nbsp;</div></li><li><div>                      if ( ! function_exists( 'get_plugins' ) ) {&nbsp;</div></li><li><div>                          require_once ABSPATH . 'wp-admin/includes/plugin.php';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $is_plugin = false;&nbsp;</div></li><li><div>                      foreach ( get_plugins() as $key =&gt; $value ) {&nbsp;</div></li><li><div>                          if ( is_plugin_active( $key ) && strpos( $key, 'redux-framework.php' ) !== false ) {&nbsp;</div></li><li><div>                              self::$_dir = trailingslashit( Redux_Helpers::cleanFilePath( WP_CONTENT_DIR . '/plugins/' . plugin_dir_path( $key ) . 'ReduxCore/' ) );&nbsp;</div></li><li><div>                              $is_plugin = true;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      if ( ! $is_plugin ) {&nbsp;</div></li><li><div>                          self::$_is_plugin = false;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( self::$_is_plugin == true || self::$_as_plugin == true ) {&nbsp;</div></li><li><div>                  self::$_url = plugin_dir_url( __FILE__ );&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  if ( strpos( Redux_Helpers::cleanFilePath( __FILE__ ), Redux_Helpers::cleanFilePath( get_template_directory() ) ) !== false ) {&nbsp;</div></li><li><div>                      $relative_url = str_replace( Redux_Helpers::cleanFilePath( get_template_directory() ), '', self::$_dir );&nbsp;</div></li><li><div>                      self::$_url = trailingslashit( get_template_directory_uri() . $relative_url );&nbsp;</div></li><li><div>                  } else if ( strpos( Redux_Helpers::cleanFilePath( __FILE__ ), Redux_Helpers::cleanFilePath( get_stylesheet_directory() ) ) !== false ) {&nbsp;</div></li><li><div>                      $relative_url = str_replace( Redux_Helpers::cleanFilePath( get_stylesheet_directory() ), '', self::$_dir );&nbsp;</div></li><li><div>                      self::$_url = trailingslashit( get_stylesheet_directory_uri() . $relative_url );&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $wp_content_dir = trailingslashit( Redux_Helpers::cleanFilePath( WP_CONTENT_DIR ) );&nbsp;</div></li><li><div>                      $wp_content_dir = trailingslashit( str_replace( '<span class="comment"><span class="comment"><span class="comment">//'</span>, </span>'/', $wp_content_dir ) );</span>&nbsp;</div></li><li><div>                      $relative_url = str_replace( $wp_content_dir, '', self::$_dir );&nbsp;</div></li><li><div>                      self::$_url = trailingslashit( self::$wp_content_url . $relative_url );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              self::$_url = apply_filters( &quot;redux/_url&quot;, self::$_url );&nbsp;</div></li><li><div>              self::$_dir = apply_filters( &quot;redux/_dir&quot;, self::$_dir );&nbsp;</div></li><li><div>              self::$_is_plugin = apply_filters( &quot;redux/_is_plugin&quot;, self::$_is_plugin );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// ::init()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          public $framework_url = 'http:<span class="comment">//www.reduxframework.com/';</span>&nbsp;</div></li><li><div>          public static $instance = null;&nbsp;</div></li><li><div>          public $admin_notices = array();&nbsp;</div></li><li><div>          public $page = '';&nbsp;</div></li><li><div>          public $saved = false;&nbsp;</div></li><li><div>          public $fields = array(); <span class="comment">// Fields by type used in the panel</span>&nbsp;</div></li><li><div>          public $field_sections = array(); <span class="comment">// Section id's by field type, then field ID</span>&nbsp;</div></li><li><div>          public $current_tab = ''; <span class="comment">// Current section to display, cookies</span>&nbsp;</div></li><li><div>          public $extensions = array(); <span class="comment">// Extensions by type used in the panel</span>&nbsp;</div></li><li><div>          public $sections = array(); <span class="comment">// Sections and fields</span>&nbsp;</div></li><li><div>          public $errors = array(); <span class="comment">// Errors</span>&nbsp;</div></li><li><div>          public $warnings = array(); <span class="comment">// Warnings</span>&nbsp;</div></li><li><div>          public $options = array(); <span class="comment">// Option values</span>&nbsp;</div></li><li><div>          public $options_defaults = null; <span class="comment"><span class="comment">// Option defaults</span></span>&nbsp;</div></li><li><div>          public $notices = array(); <span class="comment"><span class="comment">// Option defaults</span></span>&nbsp;</div></li><li><div>          public $compiler_fields = array(); <span class="comment">// Fields that trigger the compiler hook</span>&nbsp;</div></li><li><div>          public $required = array(); <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Information that needs to be localized</span></span></span></span>&nbsp;</div></li><li><div>          public $required_child = array(); <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Information that needs to be localized</span></span></span></span>&nbsp;</div></li><li><div>          public $localize_data = array(); <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Information that needs to be localized</span></span></span></span>&nbsp;</div></li><li><div>          public $fonts = array(); <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Information that needs to be localized</span></span></span></span>&nbsp;</div></li><li><div>          public $folds = array(); <span class="comment">// The itms that need to fold.</span>&nbsp;</div></li><li><div>          public $path = '';&nbsp;</div></li><li><div>          public $changed_values = array(); <span class="comment">// Values that have been changed on save. Orig values.</span>&nbsp;</div></li><li><div>          public $output = array(); <span class="comment">// Fields with CSS output selectors</span>&nbsp;</div></li><li><div>          public $outputCSS = null; <span class="comment">// CSS that get auto-appended to the header</span>&nbsp;</div></li><li><div>          public $compilerCSS = null; <span class="comment">// CSS that get sent to the compiler hook</span>&nbsp;</div></li><li><div>          public $customizerCSS = null; <span class="comment">// CSS that goes to the customizer</span>&nbsp;</div></li><li><div>          public $fieldsValues = array(); <span class="comment">//all fields values in an id=&gt;value array so we can check dependencies</span>&nbsp;</div></li><li><div>          public $fieldsHidden = array(); <span class="comment">//all fields that didn't pass the dependency test and are hidden</span>&nbsp;</div></li><li><div>          public $toHide = array(); <span class="comment">// Values to hide on page load</span>&nbsp;</div></li><li><div>          public $typography = null; <span class="comment">//values to generate google font CSS</span>&nbsp;</div></li><li><div>          public $import_export = null;&nbsp;</div></li><li><div>          public $no_panel = array(); <span class="comment">// Fields that are not visible in the panel</span>&nbsp;</div></li><li><div>          private $show_hints = false;&nbsp;</div></li><li><div>          public $hidden_perm_fields = array(); <span class="comment">//  Hidden fields specified by 'permissions' arg.</span>&nbsp;</div></li><li><div>          public $hidden_perm_sections = array(); <span class="comment">//  Hidden sections specified by 'permissions' arg.</span>&nbsp;</div></li><li><div>          public $typography_preview = array();&nbsp;</div></li><li><div>          public $args = array();&nbsp;</div></li><li><div>          public $filesystem = null;&nbsp;</div></li><li><div>          public $font_groups = array();&nbsp;</div></li><li><div>          public $lang = &quot;&quot;;&nbsp;</div></li><li><div>          public $dev_mode_forced = false;&nbsp;</div></li><li><div>          public $reload_fields = array();&nbsp;</div></li><li><div>          public $omit_share_icons = false;&nbsp;</div></li><li><div>          public $omit_admin_items = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Class Constructor. Defines the args for the theme options class</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param       array $sections   Panel sections.</span>&nbsp;</div></li><li><div><span class="comment">           * @param       array $args       Class constructor arguments.</span>&nbsp;</div></li><li><div><span class="comment">           * @param       array $extra_tabs Extra panel tabs. <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return \ReduxFramework</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function __construct( $sections = array(), $args = array(), $extra_tabs = array() ) {&nbsp;</div></li><li><div>              <span class="comment">// Disregard WP AJAX 'heartbeat'call.  Why waste resources?</span>&nbsp;</div></li><li><div>              if ( isset ( $_POST ) && isset ( $_POST['action'] ) && $_POST['action'] == 'heartbeat' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Hook, for purists.</span>&nbsp;</div></li><li><div>                  if ( ! has_action( 'redux/ajax/heartbeat' ) ) {&nbsp;</div></li><li><div>                      do_action( 'redux/ajax/heartbeat', $this );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Buh bye!</span>&nbsp;</div></li><li><div>                  return;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Pass parent pointer to function helper.</span>&nbsp;</div></li><li><div>              Redux_Functions::$_parent = $this;&nbsp;</div></li><li><div>              Redux_CDN::$_parent = $this;&nbsp;</div></li><li><div>              Redux_Admin_Notices::$_parent = $this;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Set values</span>&nbsp;</div></li><li><div>              $this-&gt;set_default_args();&nbsp;</div></li><li><div>              $this-&gt;args = wp_parse_args( $args, $this-&gt;args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( empty ( $this-&gt;args['transient_time'] ) ) {&nbsp;</div></li><li><div>                  $this-&gt;args['transient_time'] = 60 * MINUTE_IN_SECONDS;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( empty ( $this-&gt;args['footer_credit'] ) ) {&nbsp;</div></li><li><div>                  $this-&gt;args['footer_credit'] = '&lt;span id=&quot;footer-thankyou&quot;&gt;' . sprintf( __( 'Options panel created using %1$s', 'evolve' ), '&lt;a href=&quot;' . esc_url( $this-&gt;framework_url ) . '&quot; target=&quot;_blank&quot;&gt;' . __( 'Redux Framework', 'evolve' ) . '&lt;/a&gt; v' . self::$_version ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( empty ( $this-&gt;args['menu_title'] ) ) {&nbsp;</div></li><li><div>                  $this-&gt;args['menu_title'] = __( 'Options', 'evolve' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( empty ( $this-&gt;args['page_title'] ) ) {&nbsp;</div></li><li><div>                  $this-&gt;args['page_title'] = __( 'Options', 'evolve' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;old_opt_name = $this-&gt;args['opt_name'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * filter 'redux/args/{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param  array $args ReduxFramework configuration</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $this-&gt;args = apply_filters( &quot;redux/args/{$this-&gt;args['opt_name']}&quot;, $this-&gt;args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * filter 'redux/options/{opt_name}/args'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param  array $args ReduxFramework configuration</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $this-&gt;args = apply_filters( &quot;redux/options/{$this-&gt;args['opt_name']}/args&quot;, $this-&gt;args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $this-&gt;args['opt_name'] == $this-&gt;old_opt_name ) {&nbsp;</div></li><li><div>                  unset( $this-&gt;old_opt_name );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Do not save the defaults if we're on a live preview!</span>&nbsp;</div></li><li><div>              if ( $GLOBALS['pagenow'] == &quot;customize&quot; && isset( $_GET['theme'] ) && ! empty( $_GET['theme'] ) ) {&nbsp;</div></li><li><div>                  $this-&gt;args['save_defaults'] = false;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;change_demo_defaults();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $this-&gt;args['opt_name'] ) ) {&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * SHIM SECTION</span>&nbsp;</div></li><li><div><span class="comment">                   * Old variables and ways of doing things that need correcting.  ;)</span>&nbsp;</div></li><li><div><span class="comment">                   * */</span>&nbsp;</div></li><li><div>                  <span class="comment">// Variable name change</span>&nbsp;</div></li><li><div>                  if ( ! empty ( $this-&gt;args['page_cap'] ) ) {&nbsp;</div></li><li><div>                      $this-&gt;args['page_permissions'] = $this-&gt;args['page_cap'];&nbsp;</div></li><li><div>                      unset ( $this-&gt;args['page_cap'] );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! empty ( $this-&gt;args['page_position'] ) ) {&nbsp;</div></li><li><div>                      $this-&gt;args['page_priority'] = $this-&gt;args['page_position'];&nbsp;</div></li><li><div>                      unset ( $this-&gt;args['page_position'] );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! empty ( $this-&gt;args['page_type'] ) ) {&nbsp;</div></li><li><div>                      $this-&gt;args['menu_type'] = $this-&gt;args['page_type'];&nbsp;</div></li><li><div>                      unset ( $this-&gt;args['page_type'] );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Get rid of extra_tabs! Not needed.</span>&nbsp;</div></li><li><div>                  if ( is_array( $extra_tabs ) && ! empty ( $extra_tabs ) ) {&nbsp;</div></li><li><div>                      foreach ( $extra_tabs as $tab ) {&nbsp;</div></li><li><div>                          array_push( $this-&gt;sections, $tab );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Move to the first loop area!</span>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * filter 'redux-sections'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param  array $sections field option sections</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  $this-&gt;sections = apply_filters( 'redux-sections', $sections ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span> LATER</span></span></span></span>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * filter 'redux-sections-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param  array $sections field option sections</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  $this-&gt;sections = apply_filters( &quot;redux-sections-{$this-&gt;args['opt_name']}&quot;, $this-&gt;sections ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span> LATER</span></span></span></span>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * filter 'redux/options/{opt_name}/sections'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param  array $sections field option sections</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  $this-&gt;sections = apply_filters( &quot;redux/options/{$this-&gt;args['opt_name']}/sections&quot;, $this-&gt;sections );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * Construct hook</span>&nbsp;</div></li><li><div><span class="comment">                   * action 'redux/construct'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param object $this ReduxFramework</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  do_action( 'redux/construct', $this );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Set the default values</span>&nbsp;</div></li><li><div>                  $this-&gt;_default_cleanup();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Internataionalization</span>&nbsp;</div></li><li><div>                  $this-&gt;_internationalization();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;filesystem = Redux_Filesystem::get_instance( $this );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">//set redux upload folder</span>&nbsp;</div></li><li><div>                  $this-&gt;set_redux_content();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Register extra extensions</span>&nbsp;</div></li><li><div>                  $this-&gt;_register_extensions();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Grab database values</span>&nbsp;</div></li><li><div>                  $this-&gt;get_options();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Tracking</span>&nbsp;</div></li><li><div>                  if ( isset( $this-&gt;args['allow_tracking'] ) && $this-&gt;args['allow_tracking'] && Redux_Helpers::isTheme( __FILE__ ) ) {&nbsp;</div></li><li><div>                      $this-&gt;_tracking();&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Options page</span>&nbsp;</div></li><li><div>                  add_action( 'admin_menu', array( $this, '_options_page' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Add a network menu</span>&nbsp;</div></li><li><div>                  if ( $this-&gt;args['database'] == &quot;network&quot; && $this-&gt;args['network_admin'] ) {&nbsp;</div></li><li><div>                      add_action( 'network_admin_menu', array( $this, '_options_page' ) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Admin Bar menu</span>&nbsp;</div></li><li><div>                  add_action( 'admin_bar_menu', array(&nbsp;</div></li><li><div>                      $this, &nbsp;</div></li><li><div>                      '_admin_bar_menu'&nbsp;</div></li><li><div> ), $this-&gt;args['admin_bar_priority'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Register setting</span>&nbsp;</div></li><li><div>                  add_action( 'admin_init', array( $this, '_register_settings' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// Display admin notices</span> in dev_mode</span>&nbsp;</div></li><li><div>                  if ( true == $this-&gt;args['dev_mode'] ) {&nbsp;</div></li><li><div>                      if ( true == $this-&gt;args['update_notice'] ) {&nbsp;</div></li><li><div>                          add_action( 'admin_init', array( $this, '_update_check' ) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Display admin notices</span>&nbsp;</div></li><li><div>                  add_action( 'admin_notices', array( $this, '_admin_notices' ), 99 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Check for dismissed admin notices.</span>&nbsp;</div></li><li><div>                  add_action( 'admin_init', array( $this, '_dismiss_admin_notice' ), 9 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Enqueue the admin page CSS and JS</span>&nbsp;</div></li><li><div>                  if ( isset ( $_GET['page'] ) && $_GET['page'] == $this-&gt;args['page_slug'] ) {&nbsp;</div></li><li><div>                      add_action( 'admin_enqueue_scripts', array( $this, '_enqueue' ), 1 );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Output dynamic CSS</span>&nbsp;</div></li><li><div>                  <span class="comment">// Frontend: Maybe enqueue dynamic CSS and Google fonts</span>&nbsp;</div></li><li><div>                  if ( empty ( $this-&gt;args['output_location'] ) || in_array( 'frontend', $this-&gt;args['output_location'] ) ) {&nbsp;</div></li><li><div>                      add_action( 'wp_head', array( &$this, '_output_css' ), 150 );&nbsp;</div></li><li><div>                      add_action( 'wp_enqueue_scripts', array( &$this, '_enqueue_output' ), 150 );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Login page: Maybe enqueue dynamic CSS and Google fonts</span>&nbsp;</div></li><li><div>                  if ( in_array( 'login', $this-&gt;args['output_location'] ) ) {&nbsp;</div></li><li><div>                      add_action( 'login_head', array( &$this, '_output_css' ), 150 );&nbsp;</div></li><li><div>                      add_action( 'login_enqueue_scripts', array( &$this, '_enqueue_output' ), 150 );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Admin area: Maybe enqueue dynamic CSS and Google fonts</span>&nbsp;</div></li><li><div>                  if ( in_array( 'admin', $this-&gt;args['output_location'] ) ) {&nbsp;</div></li><li><div>                      add_action( 'admin_head', array( &$this, '_output_css' ), 150 );&nbsp;</div></li><li><div>                      add_action( 'admin_enqueue_scripts', array( &$this, '_enqueue_output' ), 150 );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $this-&gt;args['database'] == &quot;network&quot; && $this-&gt;args['network_admin'] ) {&nbsp;</div></li><li><div>                      add_action( 'network_admin_edit_redux_' . $this-&gt;args['opt_name'], array(&nbsp;</div></li><li><div>                          $this, &nbsp;</div></li><li><div>                          'save_network_page'&nbsp;</div></li><li><div> ), 10, 0 );&nbsp;</div></li><li><div>                      add_action( 'admin_bar_menu', array( $this, 'network_admin_bar' ), 999 );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  <span class="comment">// Ajax saving!!!</span>&nbsp;</div></li><li><div>                  add_action( &quot;wp_ajax_&quot; . $this-&gt;args['opt_name'] . '_ajax_save', array( $this, &quot;ajax_save&quot; ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $this-&gt;args['dev_mode'] == true || Redux_Helpers::isLocalHost() == true ) {&nbsp;</div></li><li><div>                      require_once 'core/dashboard.php';&nbsp;</div></li><li><div>                      new reduxDashboardWidget( $this );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( ! isset ( $GLOBALS['redux_notice_check'] ) ) {&nbsp;</div></li><li><div>                          require_once 'core/newsflash.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $params = array(&nbsp;</div></li><li><div>                              'dir_name' =&gt; 'notice', &nbsp;</div></li><li><div>                              'server_file' =&gt; 'http:<span class="comment">//reduxframework.com/wp-content/uploads/redux/redux_notice.json', </span>&nbsp;</div></li><li><div>                              'interval' =&gt; 3, &nbsp;</div></li><li><div>                              'cookie_id' =&gt; 'redux_blast', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          new reduxNewsflash( $this, $params );&nbsp;</div></li><li><div>                          $GLOBALS['redux_notice_check'] = 1;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Loaded hook</span>&nbsp;</div></li><li><div><span class="comment">               * action 'redux/loaded'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param  object $this ReduxFramework</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              do_action( 'redux/loaded', $this );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// __construct()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          private function set_redux_content() {&nbsp;</div></li><li><div>              $upload_dir = wp_upload_dir();&nbsp;</div></li><li><div>              self::$_upload_dir = $upload_dir['basedir'] . '/redux/';&nbsp;</div></li><li><div>              self::$_upload_url = str_replace( array(&nbsp;</div></li><li><div>                  'https:<span class="comment"><span class="comment">//'</span>, </span>&nbsp;</div></li><li><div>                  'http:<span class="comment">//'</span>&nbsp;</div></li><li><div> ), '<span class="comment"><span class="comment">//'</span>, </span>$upload_dir['baseurl'] . '/redux/' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          private function set_default_args() {&nbsp;</div></li><li><div>              $this-&gt;args = array(&nbsp;</div></li><li><div>                  'opt_name' =&gt; '', &nbsp;</div></li><li><div>                  <span class="comment">// Must be defined by theme/plugin</span>&nbsp;</div></li><li><div>                  'google_api_key' =&gt; '', &nbsp;</div></li><li><div>                  <span class="comment">// Must be defined to update the google fonts cache for the typography module</span>&nbsp;</div></li><li><div>                  'google_update_weekly' =&gt; false, &nbsp;</div></li><li><div>                  <span class="comment">// Set to keep your google fonts updated weekly</span>&nbsp;</div></li><li><div>                  'last_tab' =&gt; '', &nbsp;</div></li><li><div>                  <span class="comment">// force a specific tab to always show on reload</span>&nbsp;</div></li><li><div>                  'menu_icon' =&gt; '', &nbsp;</div></li><li><div>                  <span class="comment">// menu icon</span>&nbsp;</div></li><li><div>                  'menu_title' =&gt; '', &nbsp;</div></li><li><div>                  <span class="comment">// menu title/text</span>&nbsp;</div></li><li><div>                  'page_title' =&gt; '', &nbsp;</div></li><li><div>                  <span class="comment">// option page title</span>&nbsp;</div></li><li><div>                  'page_slug' =&gt; '', &nbsp;</div></li><li><div>                  'page_permissions' =&gt; 'manage_options', &nbsp;</div></li><li><div>                  'menu_type' =&gt; 'menu', &nbsp;</div></li><li><div>                  <span class="comment">// ('menu'|'submenu')</span>&nbsp;</div></li><li><div>                  'page_parent' =&gt; 'themes.php', &nbsp;</div></li><li><div>                  <span class="comment">// requires menu_type = 'submenu</span>&nbsp;</div></li><li><div>                  'page_priority' =&gt; null, &nbsp;</div></li><li><div>                  'allow_sub_menu' =&gt; true, &nbsp;</div></li><li><div>                  <span class="comment">// allow submenus to be added if menu_type == menu</span>&nbsp;</div></li><li><div>                  'save_defaults' =&gt; false, &nbsp;</div></li><li><div>                  <span class="comment">// Save defaults to the DB on it if empty</span>&nbsp;</div></li><li><div>                  'footer_credit' =&gt; '', &nbsp;</div></li><li><div>                  'async_typography' =&gt; false, &nbsp;</div></li><li><div>                  'disable_google_fonts_link' =&gt; false, &nbsp;</div></li><li><div>                  'class' =&gt; '', &nbsp;</div></li><li><div>                  <span class="comment">// Class that gets appended to all redux-containers</span>&nbsp;</div></li><li><div>                  'admin_bar' =&gt; true, &nbsp;</div></li><li><div>                  'admin_bar_priority' =&gt; 999, &nbsp;</div></li><li><div>                  <span class="comment">// Show the panel pages on the admin bar</span>&nbsp;</div></li><li><div>                  'admin_bar_icon' =&gt; '', &nbsp;</div></li><li><div>                  <span class="comment">// admin bar icon</span>&nbsp;</div></li><li><div>                  'help_tabs' =&gt; array(), &nbsp;</div></li><li><div>                  'help_sidebar' =&gt; '', &nbsp;</div></li><li><div>                  'database' =&gt; '', &nbsp;</div></li><li><div>                  <span class="comment">// possible: options, theme_mods, theme_mods_expanded, transient, network</span>&nbsp;</div></li><li><div>                  'customizer' =&gt; false, &nbsp;</div></li><li><div>                  <span class="comment">// setting to true forces get_theme_mod_expanded</span>&nbsp;</div></li><li><div>                  'global_variable' =&gt; '', &nbsp;</div></li><li><div>                  <span class="comment">// Changes global variable from $GLOBALS['YOUR_OPT_NAME'] to whatever you set here. false disables the global variable</span>&nbsp;</div></li><li><div>                  'output' =&gt; true, &nbsp;</div></li><li><div>                  <span class="comment">// Dynamically generate CSS</span>&nbsp;</div></li><li><div>                  'compiler' =&gt; true, &nbsp;</div></li><li><div>                  <span class="comment">// Initiate the compiler hook</span>&nbsp;</div></li><li><div>                  'output_tag' =&gt; true, &nbsp;</div></li><li><div>                  <span class="comment">// Print Output Tag</span>&nbsp;</div></li><li><div>                  'output_location' =&gt; array( 'frontend' ), &nbsp;</div></li><li><div>                  <span class="comment">// Where  the dynamic CSS will be added. Can be any combination from: 'frontend', 'login', 'admin'</span>&nbsp;</div></li><li><div>                  'transient_time' =&gt; '', &nbsp;</div></li><li><div>                  'default_show' =&gt; false, &nbsp;</div></li><li><div>                  <span class="comment"><span class="comment"><span class="comment"><span class="comment">// If</span></span></span> true, it shows the default value</span>&nbsp;</div></li><li><div>                  'default_mark' =&gt; '', &nbsp;</div></li><li><div>                  <span class="comment">// What to print by the field's title if the value shown is default</span>&nbsp;</div></li><li><div>                  'update_notice' =&gt; true, &nbsp;</div></li><li><div>                  <span class="comment">// Recieve an update notice of new commits when in dev mode</span>&nbsp;</div></li><li><div>                  'disable_save_warn' =&gt; false, &nbsp;</div></li><li><div>                  <span class="comment">// Disable the save warn</span>&nbsp;</div></li><li><div>                  'open_expanded' =&gt; false, &nbsp;</div></li><li><div>                  'hide_expand' =&gt; false, &nbsp;</div></li><li><div>                  <span class="comment">// Start the panel fully expanded to start with</span>&nbsp;</div></li><li><div>                  'network_admin' =&gt; false, &nbsp;</div></li><li><div>                  <span class="comment">// Enable network admin when using network database mode</span>&nbsp;</div></li><li><div>                  'network_sites' =&gt; true, &nbsp;</div></li><li><div>                  <span class="comment">// Enable sites as well as admin when using network database mode</span>&nbsp;</div></li><li><div>                  'hide_reset' =&gt; false, &nbsp;</div></li><li><div>                  'hide_save' =&gt; false, &nbsp;</div></li><li><div>                  'hints' =&gt; array(&nbsp;</div></li><li><div>                      'icon' =&gt; 'el el-question-sign', &nbsp;</div></li><li><div>                      'icon_position' =&gt; 'right', &nbsp;</div></li><li><div>                      'icon_color' =&gt; 'lightgray', &nbsp;</div></li><li><div>                      'icon_size' =&gt; 'normal', &nbsp;</div></li><li><div>                      'tip_style' =&gt; array(&nbsp;</div></li><li><div>                          'color' =&gt; 'light', &nbsp;</div></li><li><div>                          'shadow' =&gt; true, &nbsp;</div></li><li><div>                          'rounded' =&gt; false, &nbsp;</div></li><li><div>                          'style' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                      'tip_position' =&gt; array(&nbsp;</div></li><li><div>                          'my' =&gt; 'top_left', &nbsp;</div></li><li><div>                          'at' =&gt; 'bottom_right', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                      'tip_effect' =&gt; array(&nbsp;</div></li><li><div>                          'show' =&gt; array(&nbsp;</div></li><li><div>                              'effect' =&gt; 'slide', &nbsp;</div></li><li><div>                              'duration' =&gt; '500', &nbsp;</div></li><li><div>                              'event' =&gt; 'mouseover', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                          'hide' =&gt; array(&nbsp;</div></li><li><div>                              'effect' =&gt; 'fade', &nbsp;</div></li><li><div>                              'duration' =&gt; '500', &nbsp;</div></li><li><div>                              'event' =&gt; 'click mouseleave', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'show_import_export' =&gt; true, &nbsp;</div></li><li><div>                  'show_options_object' =&gt; true, &nbsp;</div></li><li><div>                  'dev_mode' =&gt; true, &nbsp;</div></li><li><div>                  'templates_path' =&gt; '', &nbsp;</div></li><li><div>                  <span class="comment">// Path to the templates file for various Redux elements</span>&nbsp;</div></li><li><div>                  'ajax_save' =&gt; true, &nbsp;</div></li><li><div>                  <span class="comment">// Disable the use of ajax saving for the panel</span>&nbsp;</div></li><li><div>                  'use_cdn' =&gt; false, &nbsp;</div></li><li><div>                  'cdn_check_time' =&gt; 1440, &nbsp;</div></li><li><div>                  'options_api' =&gt; true, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          public function network_admin_bar( $wp_admin_bar ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $args = array(&nbsp;</div></li><li><div>                  'id' =&gt; $this-&gt;args['opt_name'] . '_network_admin', &nbsp;</div></li><li><div>                  'title' =&gt; $this-&gt;args['menu_title'], &nbsp;</div></li><li><div>                  'parent' =&gt; 'network-admin', &nbsp;</div></li><li><div>                  'href' =&gt; network_admin_url( 'settings.php' ) . '?page=' . $this-&gt;args['page_slug'], &nbsp;</div></li><li><div>                  'meta' =&gt; array( 'class' =&gt; 'redux-network-admin' )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              $wp_admin_bar-&gt;add_node( $args );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          public function save_network_page() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $data = $this-&gt;_validate_options( $_POST[ $this-&gt;args['opt_name'] ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $data ) ) {&nbsp;</div></li><li><div>                  $this-&gt;set_options( $data );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              wp_redirect( add_query_arg( array(&nbsp;</div></li><li><div>                  'page' =&gt; $this-&gt;args['page_slug'], &nbsp;</div></li><li><div>                  'updated' =&gt; 'true'&nbsp;</div></li><li><div> ), network_admin_url( 'settings.php' ) ) );&nbsp;</div></li><li><div>              exit ();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          public function _update_check() {&nbsp;</div></li><li><div>              <span class="comment">// Only one notice per instance please</span>&nbsp;</div></li><li><div>              if ( ! isset ( $GLOBALS['redux_update_check'] ) ) {&nbsp;</div></li><li><div>                  Redux_Functions::updateCheck( self::$_version );&nbsp;</div></li><li><div>                  $GLOBALS['redux_update_check'] = 1;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          public function _admin_notices() {&nbsp;</div></li><li><div>              Redux_Admin_Notices::adminNotices( $this-&gt;admin_notices );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          public function _dismiss_admin_notice() {&nbsp;</div></li><li><div>              Redux_Admin_Notices::dismissAdminNotice();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Load the plugin text domain for translation.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since    3.0.5</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          private function _internationalization() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Locale for text domain</span>&nbsp;</div></li><li><div><span class="comment">               * filter 'redux/textdomain/{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param string     The locale of the blog or from the 'locale' hook</span>&nbsp;</div></li><li><div><span class="comment">               * @param string     'evolve'  text domain</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              <span class="comment">//                $locale = apply_filters( &quot;redux/textdomain/{$this-&gt;args['opt_name']}&quot;, get_locale(), 'evolve' );</span>&nbsp;</div></li><li><div>              <span class="comment">//</span>&nbsp;</div></li><li><div><span class="comment">              //                if ( strpos( $locale, '_' ) === false ) {</span>&nbsp;</div></li><li><div>              <span class="comment">//                    if ( file_exists( self::$_dir . 'languages/' . strtolower( $locale ) . '_' . strtoupper( $locale ) . '.mo' ) ) {</span>&nbsp;</div></li><li><div>              <span class="comment">//                        $locale = strtolower( $locale ) . '_' . strtoupper( $locale );</span>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment">//                    }</span></span>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment">//                }</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $basename = basename( __FILE__ );&nbsp;</div></li><li><div>              $basepath = plugin_basename( __FILE__ );&nbsp;</div></li><li><div>              $basepath = str_replace( $basename, '', $basepath );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $basepath = apply_filters( &quot;redux/textdomain/basepath/{$this-&gt;args['opt_name']}&quot;, $basepath );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              load_plugin_textdomain( 'evolve', false, $basepath . 'languages' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// _internationalization()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * @return ReduxFramework</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function get_instance() {&nbsp;</div></li><li><div>              <span class="comment">//self::$_instance = $this;</span>&nbsp;</div></li><li><div>              return self::$instance;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// get_instance()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          private function _tracking() {&nbsp;</div></li><li><div>              if ( file_exists( dirname( __FILE__ ) . '/inc/tracking.php' ) ) {&nbsp;</div></li><li><div>                  require_once dirname( __FILE__ ) . '/inc/tracking.php';&nbsp;</div></li><li><div>                  $tracking = Redux_Tracking::get_instance();&nbsp;</div></li><li><div>                  $tracking-&gt;load( $this );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// _tracking()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * -&gt;_get_default(); This is used to return the default value if default_show is set</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.1</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param       string $opt_name The option name to return</span>&nbsp;</div></li><li><div><span class="comment">           * @param       mixed  $default  (null)  The value to return if default not set</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return      mixed $default</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function _get_default( $opt_name, $default = null ) {&nbsp;</div></li><li><div>              if ( $this-&gt;args['default_show'] == true ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( empty ( $this-&gt;options_defaults ) ) {&nbsp;</div></li><li><div>                      $this-&gt;_default_values(); <span class="comment">// fill cache</span>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $default = array_key_exists( $opt_name, $this-&gt;options_defaults ) ? $this-&gt;options_defaults[ $opt_name ] : $default;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $default;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// _get_default()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * -&gt;get(); This is used to return and option value from the options array</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param       string $opt_name The option name to return</span>&nbsp;</div></li><li><div><span class="comment">           * @param       mixed  $default  (null) The value to return if option not set</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return      mixed</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function get( $opt_name, $default = null ) {&nbsp;</div></li><li><div>              return ( ! empty ( $this-&gt;options[ $opt_name ] ) ) ? $this-&gt;options[ $opt_name ] : $this-&gt;_get_default( $opt_name, $default );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// get()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * -&gt;set(); This is used to set an arbitrary option in the options array</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param       string $opt_name The name of the option being added</span>&nbsp;</div></li><li><div><span class="comment">           * @param       mixed  $value    The value of the option being added</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function set( $opt_name = '', $value = '' ) {&nbsp;</div></li><li><div>              if ( $opt_name != '' ) {&nbsp;</div></li><li><div>                  $this-&gt;options[ $opt_name ] = $value;&nbsp;</div></li><li><div>                  $this-&gt;set_options( $this-&gt;options );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// set()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Set a global variable by the global_variable argument</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since   3.1.5</span>&nbsp;</div></li><li><div><span class="comment">           * @return  bool          (global was set)</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          private function set_global_variable() {&nbsp;</div></li><li><div>              if ( $this-&gt;args['global_variable'] ) {&nbsp;</div></li><li><div>                  $option_global = $this-&gt;args['global_variable'];&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * filter 'redux/options/{opt_name}/global_variable'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array $value option value to set global_variable with</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  $GLOBALS[ $this-&gt;args['global_variable'] ] = apply_filters( &quot;redux/options/{$this-&gt;args['opt_name']}/global_variable&quot;, $this-&gt;options );&nbsp;</div></li><li><div>                  if ( isset ( $this-&gt;transients['last_save'] ) ) {&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">// Deprecated</span></span>&nbsp;</div></li><li><div>                      $GLOBALS[ $this-&gt;args['global_variable'] ]['REDUX_last_saved'] = $this-&gt;transients['last_save'];&nbsp;</div></li><li><div>                      <span class="comment">// Last save key</span>&nbsp;</div></li><li><div>                      $GLOBALS[ $this-&gt;args['global_variable'] ]['REDUX_LAST_SAVE'] = $this-&gt;transients['last_save'];&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  if ( isset ( $this-&gt;transients['last_compiler'] ) ) {&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">// Deprecated</span></span>&nbsp;</div></li><li><div>                      $GLOBALS[ $this-&gt;args['global_variable'] ]['REDUX_COMPILER'] = $this-&gt;transients['last_compiler'];&nbsp;</div></li><li><div>                      <span class="comment">// Last compiler hook key</span>&nbsp;</div></li><li><div>                      $GLOBALS[ $this-&gt;args['global_variable'] ]['REDUX_LAST_COMPILER'] = $this-&gt;transients['last_compiler'];&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  return true;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return false;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// set_global_variable()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * -&gt;set_options(); This is used to set an arbitrary option in the options array</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since ReduxFramework 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param mixed $value the value of the option being added</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function set_options( $value = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;transients['last_save'] = time();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $value ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;options = $value;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $this-&gt;args['database'] === 'transient' ) {&nbsp;</div></li><li><div>                      set_transient( $this-&gt;args['opt_name'] . '-transient', $value, $this-&gt;args['transient_time'] );&nbsp;</div></li><li><div>                  } else if ( $this-&gt;args['database'] === 'theme_mods' ) {&nbsp;</div></li><li><div>                      set_theme_mod( $this-&gt;args['opt_name'] . '-mods', $value );&nbsp;</div></li><li><div>                  } else if ( $this-&gt;args['database'] === 'theme_mods_expanded' ) {&nbsp;</div></li><li><div>                      foreach ( $value as $k =&gt; $v ) {&nbsp;</div></li><li><div>                          set_theme_mod( $k, $v );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  } else if ( $this-&gt;args['database'] === 'network' ) {&nbsp;</div></li><li><div>                      <span class="comment">// Strip those slashes!</span>&nbsp;</div></li><li><div>                      $value = json_decode( stripslashes( json_encode( $value ) ), true );&nbsp;</div></li><li><div>                      update_site_option( $this-&gt;args['opt_name'], $value );&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      update_option( $this-&gt;args['opt_name'], $value );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Store the changed values in the transient</span>&nbsp;</div></li><li><div>                  if ( $value != $this-&gt;options ) {&nbsp;</div></li><li><div>                      foreach ( $value as $k =&gt; $v ) {&nbsp;</div></li><li><div>                          if ( ! isset ( $this-&gt;options[ $k ] ) ) {&nbsp;</div></li><li><div>                              $this-&gt;options[ $k ] = &quot;&quot;;&nbsp;</div></li><li><div>                          } else if ( $v == $this-&gt;options[ $k ] ) {&nbsp;</div></li><li><div>                              unset ( $this-&gt;options[ $k ] );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      $this-&gt;transients['changed_values'] = $this-&gt;options;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;options = $value;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// Set a global variable by the global_variable argument.</span></span>&nbsp;</div></li><li><div>                  $this-&gt;set_global_variable();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Saving the transient values</span>&nbsp;</div></li><li><div>                  $this-&gt;set_transients();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">//do_action( &quot;redux-saved-{$this-&gt;args['opt_name']}&quot;, $value ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                  <span class="comment">//do_action( &quot;redux/options/{$this-&gt;args['opt_name']}/saved&quot;, $value, $this-&gt;transients['changed_values'] );</span>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// set_options()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * -&gt;get_options(); This is used to get options from the database</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since ReduxFramework 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function get_options() {&nbsp;</div></li><li><div>              $defaults = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $this-&gt;defaults ) ) {&nbsp;</div></li><li><div>                  $defaults = $this-&gt;defaults;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $this-&gt;args['database'] === &quot;transient&quot; ) {&nbsp;</div></li><li><div>                  $result = get_transient( $this-&gt;args['opt_name'] . '-transient' );&nbsp;</div></li><li><div>              } else if ( $this-&gt;args['database'] === &quot;theme_mods&quot; ) {&nbsp;</div></li><li><div>                  $result = get_theme_mod( $this-&gt;args['opt_name'] . '-mods' );&nbsp;</div></li><li><div>              } else if ( $this-&gt;args['database'] === 'theme_mods_expanded' ) {&nbsp;</div></li><li><div>                  $result = get_theme_mods();&nbsp;</div></li><li><div>              } else if ( $this-&gt;args['database'] === 'network' ) {&nbsp;</div></li><li><div>                  $result = get_site_option( $this-&gt;args['opt_name'], array() );&nbsp;</div></li><li><div>                  $result = json_decode( stripslashes( json_encode( $result ) ), true );&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $result = get_option( $this-&gt;args['opt_name'], array() );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( empty ( $result ) && ! empty ( $defaults ) ) {&nbsp;</div></li><li><div>                  $results = $defaults;&nbsp;</div></li><li><div>                  $this-&gt;set_options( $results );&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $this-&gt;options = $result;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * action 'redux/options/{opt_name}/options'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param mixed $value option values</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $this-&gt;options = apply_filters( &quot;redux/options/{$this-&gt;args['opt_name']}/options&quot;, $this-&gt;options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Get transient values</span>&nbsp;</div></li><li><div>              $this-&gt;get_transients();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment">// Set a global variable by the global_variable argument.</span></span>&nbsp;</div></li><li><div>              $this-&gt;set_global_variable();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// get_options()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * -&gt;get_wordpress_date() - Get WordPress specific data from the DB and return in a usable array</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since ReduxFramework 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function get_wordpress_data( $type = false, $args = array() ) {&nbsp;</div></li><li><div>              $data = &quot;&quot;;&nbsp;</div></li><li><div>              <span class="comment">//return $data;</span>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * filter 'redux/options/{opt_name}/wordpress_data/{type}/'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param string $data</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $data = apply_filters( &quot;redux/options/{$this-&gt;args['opt_name']}/wordpress_data/$type/&quot;, $data ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span> LATER</span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * filter 'redux/options/{opt_name}/data/{type}'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param string $data</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $data = apply_filters( &quot;redux/options/{$this-&gt;args['opt_name']}/data/$type&quot;, $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $argsKey = &quot;&quot;;&nbsp;</div></li><li><div>              foreach ( $args as $key =&gt; $value ) {&nbsp;</div></li><li><div>                  if ( ! is_array( $value ) ) {&nbsp;</div></li><li><div>                      $argsKey .= $value . &quot;-&quot;;&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $argsKey .= implode( &quot;-&quot;, $value );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( empty ( $data ) && isset ( $this-&gt;wp_data[ $type . $argsKey ] ) ) {&nbsp;</div></li><li><div>                  $data = $this-&gt;wp_data[ $type . $argsKey ];&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( empty ( $data ) && ! empty ( $type ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * Use data from WordPress to populate options array</span>&nbsp;</div></li><li><div><span class="comment">                   * */</span>&nbsp;</div></li><li><div>                  if ( ! empty ( $type ) && empty ( $data ) ) {&nbsp;</div></li><li><div>                      if ( empty ( $args ) ) {&nbsp;</div></li><li><div>                          $args = array();&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $data = array();&nbsp;</div></li><li><div>                      $args = wp_parse_args( $args, array() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $type == &quot;categories&quot; || $type == &quot;category&quot; ) {&nbsp;</div></li><li><div>                          $cats = get_categories( $args );&nbsp;</div></li><li><div>                          if ( ! empty ( $cats ) ) {&nbsp;</div></li><li><div>                              foreach ( $cats as $cat ) {&nbsp;</div></li><li><div>                                  $data[ $cat-&gt;term_id ] = $cat-&gt;name;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//foreach</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                          } <span class="comment"><span class="comment"><span class="comment">// If</span></span></span>&nbsp;</div></li><li><div>                      } else if ( $type == &quot;menus&quot; || $type == &quot;menu&quot; ) {&nbsp;</div></li><li><div>                          $menus = wp_get_nav_menus( $args );&nbsp;</div></li><li><div>                          if ( ! empty ( $menus ) ) {&nbsp;</div></li><li><div>                              foreach ( $menus as $item ) {&nbsp;</div></li><li><div>                                  $data[ $item-&gt;term_id ] = $item-&gt;name;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//foreach</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//if</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                      } else if ( $type == &quot;pages&quot; || $type == &quot;page&quot; ) {&nbsp;</div></li><li><div>                          if ( ! isset ( $args['posts_per_page'] ) ) {&nbsp;</div></li><li><div>                              $args['posts_per_page'] = 20;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $pages = get_pages( $args );&nbsp;</div></li><li><div>                          if ( ! empty ( $pages ) ) {&nbsp;</div></li><li><div>                              foreach ( $pages as $page ) {&nbsp;</div></li><li><div>                                  $data[ $page-&gt;ID ] = $page-&gt;post_title;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//foreach</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//if</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                      } else if ( $type == &quot;terms&quot; || $type == &quot;term&quot; ) {&nbsp;</div></li><li><div>                          $taxonomies = $args['taxonomies'];&nbsp;</div></li><li><div>                          unset ( $args['taxonomies'] );&nbsp;</div></li><li><div>                          $terms = get_terms( $taxonomies, $args ); <span class="comment">// this will get nothing</span>&nbsp;</div></li><li><div>                          if ( ! empty ( $terms ) && ! is_a( $terms, 'WP_Error' ) ) {&nbsp;</div></li><li><div>                              foreach ( $terms as $term ) {&nbsp;</div></li><li><div>                                  $data[ $term-&gt;term_id ] = $term-&gt;name;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//foreach</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                          } <span class="comment"><span class="comment"><span class="comment">// If</span></span></span>&nbsp;</div></li><li><div>                      } else if ( $type == &quot;taxonomy&quot; || $type == &quot;taxonomies&quot; ) {&nbsp;</div></li><li><div>                          $taxonomies = get_taxonomies( $args );&nbsp;</div></li><li><div>                          if ( ! empty ( $taxonomies ) ) {&nbsp;</div></li><li><div>                              foreach ( $taxonomies as $key =&gt; $taxonomy ) {&nbsp;</div></li><li><div>                                  $data[ $key ] = $taxonomy;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//foreach</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                          } <span class="comment"><span class="comment"><span class="comment">// If</span></span></span>&nbsp;</div></li><li><div>                      } else if ( $type == &quot;posts&quot; || $type == &quot;post&quot; ) {&nbsp;</div></li><li><div>                          $posts = get_posts( $args );&nbsp;</div></li><li><div>                          if ( ! empty ( $posts ) ) {&nbsp;</div></li><li><div>                              foreach ( $posts as $post ) {&nbsp;</div></li><li><div>                                  $data[ $post-&gt;ID ] = $post-&gt;post_title;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//foreach</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//if</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                      } else if ( $type == &quot;post_type&quot; || $type == &quot;post_types&quot; ) {&nbsp;</div></li><li><div>                          global $wp_post_types;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $defaults = array(&nbsp;</div></li><li><div>                              'public' =&gt; true, &nbsp;</div></li><li><div>                              'exclude_from_search' =&gt; false, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                          $args = wp_parse_args( $args, $defaults );&nbsp;</div></li><li><div>                          $output = 'names';&nbsp;</div></li><li><div>                          $operator = 'and';&nbsp;</div></li><li><div>                          $post_types = get_post_types( $args, $output, $operator );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          ksort( $post_types );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          foreach ( $post_types as $name =&gt; $title ) {&nbsp;</div></li><li><div>                              if ( isset ( $wp_post_types[ $name ]-&gt;labels-&gt;menu_name ) ) {&nbsp;</div></li><li><div>                                  $data[ $name ] = $wp_post_types[ $name ]-&gt;labels-&gt;menu_name;&nbsp;</div></li><li><div>                              } else {&nbsp;</div></li><li><div>                                  $data[ $name ] = ucfirst( $name );&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      } else if ( $type == &quot;tags&quot; || $type == &quot;tag&quot; ) { <span class="comment">// NOT WORKING!</span>&nbsp;</div></li><li><div>                          $tags = get_tags( $args );&nbsp;</div></li><li><div>                          if ( ! empty ( $tags ) ) {&nbsp;</div></li><li><div>                              foreach ( $tags as $tag ) {&nbsp;</div></li><li><div>                                  $data[ $tag-&gt;term_id ] = $tag-&gt;name;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//foreach</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//if</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                      } else if ( $type == &quot;menu_location&quot; || $type == &quot;menu_locations&quot; ) {&nbsp;</div></li><li><div>                          global $_wp_registered_nav_menus;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          foreach ( $_wp_registered_nav_menus as $k =&gt; $v ) {&nbsp;</div></li><li><div>                              $data[ $k ] = $v;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      } else if ( $type == &quot;image_size&quot; || $type == &quot;image_sizes&quot; ) {&nbsp;</div></li><li><div>                          global $_wp_additional_image_sizes;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          foreach ( $_wp_additional_image_sizes as $size_name =&gt; $size_attrs ) {&nbsp;</div></li><li><div>                              $data[ $size_name ] = $size_name . ' - ' . $size_attrs['width'] . ' x ' . $size_attrs['height'];&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      } else if ( $type == &quot;elusive-icons&quot; || $type == &quot;elusive-icon&quot; || $type == &quot;elusive&quot; ||&nbsp;</div></li><li><div>                                  $type == &quot;font-icon&quot; || $type == &quot;font-icons&quot; || $type == &quot;icons&quot;&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                           * filter 'redux-font-icons'</span>&nbsp;</div></li><li><div><span class="comment">                           *</span>&nbsp;</div></li><li><div><span class="comment">                           * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                           *</span>&nbsp;</div></li><li><div><span class="comment">                           * @param array $font_icons array of elusive icon classes</span>&nbsp;</div></li><li><div><span class="comment">                           */</span>&nbsp;</div></li><li><div>                          $font_icons = apply_filters( 'redux-font-icons', array() ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span> LATER</span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                           * filter 'redux/font-icons'</span>&nbsp;</div></li><li><div><span class="comment">                           *</span>&nbsp;</div></li><li><div><span class="comment">                           * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                           *</span>&nbsp;</div></li><li><div><span class="comment">                           * @param array $font_icons array of elusive icon classes</span>&nbsp;</div></li><li><div><span class="comment">                           */</span>&nbsp;</div></li><li><div>                          $font_icons = apply_filters( 'redux/font-icons', $font_icons );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                           * filter 'redux/{opt_name}/field/font/icons'</span>&nbsp;</div></li><li><div><span class="comment">                           *</span>&nbsp;</div></li><li><div><span class="comment">                           * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                           *</span>&nbsp;</div></li><li><div><span class="comment">                           * @param array $font_icons array of elusive icon classes</span>&nbsp;</div></li><li><div><span class="comment">                           */</span>&nbsp;</div></li><li><div>                          $font_icons = apply_filters( &quot;redux/{$this-&gt;args['opt_name']}/field/font/icons&quot;, $font_icons );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          foreach ( $font_icons as $k ) {&nbsp;</div></li><li><div>                              $data[ $k ] = $k;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      } else if ( $type == &quot;roles&quot; ) {&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">/** @global WP_Roles $wp_roles */</span></span>&nbsp;</div></li><li><div>                          global $wp_roles;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $data = $wp_roles-&gt;get_names();&nbsp;</div></li><li><div>                      } else if ( $type == &quot;sidebars&quot; || $type == &quot;sidebar&quot; ) {&nbsp;</div></li><li><div>                          <span class="comment">/** @global array $wp_registered_sidebars */</span>&nbsp;</div></li><li><div>                          global $wp_registered_sidebars;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          foreach ( $wp_registered_sidebars as $key =&gt; $value ) {&nbsp;</div></li><li><div>                              $data[ $key ] = $value['name'];&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      } else if ( $type == &quot;capabilities&quot; ) {&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">/** @global WP_Roles $wp_roles */</span></span>&nbsp;</div></li><li><div>                          global $wp_roles;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          foreach ( $wp_roles-&gt;roles as $role ) {&nbsp;</div></li><li><div>                              foreach ( $role['capabilities'] as $key =&gt; $cap ) {&nbsp;</div></li><li><div>                                  $data[ $key ] = ucwords( str_replace( '_', ' ', $key ) );&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      } else if ( $type == &quot;callback&quot; ) {&nbsp;</div></li><li><div>                          if ( ! is_array( $args ) ) {&nbsp;</div></li><li><div>                              $args = array( $args );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $data = call_user_func( $args[0] );&nbsp;</div></li><li><div>                      } else if ( $type == &quot;users&quot; || $type == &quot;users&quot; ) {&nbsp;</div></li><li><div>                          $users = get_users( $args );&nbsp;</div></li><li><div>                          if ( ! empty ( $users ) ) {&nbsp;</div></li><li><div>                              foreach ( $users as $user ) {&nbsp;</div></li><li><div>                                  $data[ $user-&gt;ID ] = $user-&gt;display_name;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//foreach</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//if</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//if</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//if</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;wp_data[ $type . $argsKey ] = $data;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//if</span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $data;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// get_wordpress_data()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * -&gt;show(); This is used to echo and option value from the options array</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param       string $opt_name The name of the option being shown</span>&nbsp;</div></li><li><div><span class="comment">           * @param       mixed  $default  The value to show if $opt_name isn't set</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function show( $opt_name, $default = '' ) {&nbsp;</div></li><li><div>              $option = $this-&gt;get( $opt_name );&nbsp;</div></li><li><div>              if ( ! is_array( $option ) && $option != '' ) {&nbsp;</div></li><li><div>                  echo $option;&nbsp;</div></li><li><div>              } elseif ( $default != '' ) {&nbsp;</div></li><li><div>                  echo $this-&gt;_get_default( $opt_name, $default );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// show()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Get the default value for an option</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since  3.3.6</span>&nbsp;</div></li><li><div><span class="comment">           * @access public</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param string $key       The option's ID</span>&nbsp;</div></li><li><div><span class="comment">           * @param string $array_key The key of the default's array</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return mixed</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function get_default_value( $key, $array_key = false ) {&nbsp;</div></li><li><div>              if ( empty ( $this-&gt;options_defaults ) ) {&nbsp;</div></li><li><div>                  $this-&gt;options_defaults = $this-&gt;_default_values();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $defaults = $this-&gt;options_defaults;&nbsp;</div></li><li><div>              $value = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset ( $defaults[ $key ] ) ) {&nbsp;</div></li><li><div>                  if ( $array_key !== false && isset ( $defaults[ $key ][ $array_key ] ) ) {&nbsp;</div></li><li><div>                      $value = $defaults[ $key ][ $array_key ];&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $value = $defaults[ $key ];&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $value;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          public function field_default_values( $field ) {&nbsp;</div></li><li><div>              <span class="comment">// Detect what field types are being used</span>&nbsp;</div></li><li><div>              if ( ! isset ( $this-&gt;fields[ $field['type'] ][ $field['id'] ] ) ) {&nbsp;</div></li><li><div>                  $this-&gt;fields[ $field['type'] ][ $field['id'] ] = 1;&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $this-&gt;fields[ $field['type'] ] = array( $field['id'] =&gt; 1 );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( isset ( $field['default'] ) ) {&nbsp;</div></li><li><div>                  $this-&gt;options_defaults[ $field['id'] ] = apply_filters( &quot;redux/{$this-&gt;args['opt_name']}/field/{$field['type']}/defaults&quot;, $field['default'], $field );&nbsp;</div></li><li><div>              } elseif ( ( $field['type'] != &quot;ace_editor&quot; ) ) {&nbsp;</div></li><li><div>                  <span class="comment">// Sorter data filter</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset( $field['data'] ) && ! empty( $field['data'] ) ) {&nbsp;</div></li><li><div>                      if ( ! isset( $field['args'] ) ) {&nbsp;</div></li><li><div>                          $field['args'] = array();&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      if ( is_array( $field['data'] ) && ! empty( $field['data'] ) ) {&nbsp;</div></li><li><div>                          foreach ( $field['data'] as $key =&gt; $data ) {&nbsp;</div></li><li><div>                              if ( ! empty( $data ) ) {&nbsp;</div></li><li><div>                                  if ( ! isset ( $field['args'][ $key ] ) ) {&nbsp;</div></li><li><div>                                      $field['args'][ $key ] = array();&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                                  $field['options'][ $key ] = $this-&gt;get_wordpress_data( $data, $field['args'][ $key ] );&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          $field['options'] = $this-&gt;get_wordpress_data( $field['data'], $field['args'] );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $field['type'] == &quot;sorter&quot; && isset ( $field['data'] ) && ! empty ( $field['data'] ) && is_array( $field['data'] ) ) {&nbsp;</div></li><li><div>                      if ( ! isset ( $field['args'] ) ) {&nbsp;</div></li><li><div>                          $field['args'] = array();&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      foreach ( $field['data'] as $key =&gt; $data ) {&nbsp;</div></li><li><div>                          if ( ! isset ( $field['args'][ $key ] ) ) {&nbsp;</div></li><li><div>                              $field['args'][ $key ] = array();&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $field['options'][ $key ] = $this-&gt;get_wordpress_data( $data, $field['args'][ $key ] );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset ( $field['options'] ) ) {&nbsp;</div></li><li><div>                      if ( $field['type'] == &quot;sortable&quot; ) {&nbsp;</div></li><li><div>                          $this-&gt;options_defaults[ $field['id'] ] = array();&nbsp;</div></li><li><div>                      } elseif ( $field['type'] == &quot;image_select&quot; ) {&nbsp;</div></li><li><div>                          $this-&gt;options_defaults[ $field['id'] ] = '';&nbsp;</div></li><li><div>                      } elseif ( $field['type'] == &quot;select&quot; ) {&nbsp;</div></li><li><div>                          $this-&gt;options_defaults[ $field['id'] ] = '';&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          $this-&gt;options_defaults[ $field['id'] ] = $field['options'];&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Get default options into an array suitable for the settings API</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @return      array $this-&gt;options_defaults</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function _default_values() {&nbsp;</div></li><li><div>              if ( ! is_null( $this-&gt;sections ) && is_null( $this-&gt;options_defaults ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// fill the cache</span>&nbsp;</div></li><li><div>                  foreach ( $this-&gt;sections as $sk =&gt; $section ) {&nbsp;</div></li><li><div>                      if ( ! isset ( $section['id'] ) ) {&nbsp;</div></li><li><div>                          if ( ! is_numeric( $sk ) || ! isset ( $section['title'] ) ) {&nbsp;</div></li><li><div>                              $section['id'] = $sk;&nbsp;</div></li><li><div>                          } else {&nbsp;</div></li><li><div>                              $section['id'] = sanitize_title( $section['title'], $sk );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $this-&gt;sections[ $sk ] = $section;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      if ( isset ( $section['fields'] ) ) {&nbsp;</div></li><li><div>                          foreach ( $section['fields'] as $k =&gt; $field ) {&nbsp;</div></li><li><div>                              if ( empty ( $field['id'] ) && empty ( $field['type'] ) ) {&nbsp;</div></li><li><div>                                  continue;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( in_array( $field['type'], array( 'ace_editor' ) ) && isset ( $field['options'] ) ) {&nbsp;</div></li><li><div>                                  $this-&gt;sections[ $sk ]['fields'][ $k ]['args'] = $field['options'];&nbsp;</div></li><li><div>                                  unset ( $this-&gt;sections[ $sk ]['fields'][ $k ]['options'] );&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( $field['type'] == &quot;section&quot; && isset ( $field['indent'] ) && $field['indent'] == &quot;true&quot; ) {&nbsp;</div></li><li><div>                                  $field['class'] = isset ( $field['class'] ) ? $field['class'] : '';&nbsp;</div></li><li><div>                                  $field['class'] .= &quot; redux-section-indent-start&quot;;&nbsp;</div></li><li><div>                                  $this-&gt;sections[ $sk ]['fields'][ $k ] = $field;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              $this-&gt;field_default_values( $field );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * filter 'redux/options/{opt_name}/defaults'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param array $defaults option default values</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $this-&gt;transients['changed_values'] = isset ( $this-&gt;transients['changed_values'] ) ? $this-&gt;transients['changed_values'] : array();&nbsp;</div></li><li><div>              $this-&gt;options_defaults = apply_filters( &quot;redux/options/{$this-&gt;args['opt_name']}/defaults&quot;, $this-&gt;options_defaults, $this-&gt;transients['changed_values'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $this-&gt;options_defaults;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Set default options on admin_init if option doesn't exist</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          private function _default_cleanup() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Fix the global variable name</span>&nbsp;</div></li><li><div>              if ( $this-&gt;args['global_variable'] == &quot;&quot; && $this-&gt;args['global_variable'] !== false ) {&nbsp;</div></li><li><div>                  $this-&gt;args['global_variable'] = str_replace( '-', '_', $this-&gt;args['opt_name'] );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Force dev_mode on WP_DEBUG = true and if it's a local server</span>&nbsp;</div></li><li><div>              if ( Redux_Helpers::isLocalHost() || ( Redux_Helpers::isWpDebug() ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;args['dev_mode'] != true ) {&nbsp;</div></li><li><div>                      $this-&gt;args['update_notice'] = false;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  $this-&gt;dev_mode_forced = true;&nbsp;</div></li><li><div>                  $this-&gt;args['dev_mode'] = true;&nbsp;</div></li><li><div><span class="comment">//                    if ( isset( $this-&gt;args['forced_dev_mode_off'] ) && $this-&gt;args['forced_dev_mode_off'] == true ) {</span>&nbsp;</div></li><li><div><span class="comment">//                        $this-&gt;dev_mode_forced = false;</span>&nbsp;</div></li><li><div><span class="comment">//                        $this-&gt;args['dev_mode'] = false;</span>&nbsp;</div></li><li><div><span class="comment"><span class="comment">//                    }</span></span>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Auto create the page_slug appropriately</span>&nbsp;</div></li><li><div>              if ( empty( $this-&gt;args['page_slug'] ) ) {&nbsp;</div></li><li><div>                  if ( ! empty( $this-&gt;args['display_name'] ) ) {&nbsp;</div></li><li><div>                      $this-&gt;args['page_slug'] = sanitize_html_class( $this-&gt;args['display_name'] );&nbsp;</div></li><li><div>                  } else if ( ! empty( $this-&gt;args['page_title'] ) ) {&nbsp;</div></li><li><div>                      $this-&gt;args['page_slug'] = sanitize_html_class( $this-&gt;args['page_title'] );&nbsp;</div></li><li><div>                  } else if ( ! empty( $this-&gt;args['menu_title'] ) ) {&nbsp;</div></li><li><div>                      $this-&gt;args['page_slug'] = sanitize_html_class( $this-&gt;args['menu_title'] );&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $this-&gt;args['page_slug'] = str_replace( '-', '_', $this-&gt;args['opt_name'] );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset( $this-&gt;args['customizer_only'] ) && $this-&gt;args['customizer_only'] == true ) {&nbsp;</div></li><li><div>                  $this-&gt;args['menu_type'] = 'hidden';&nbsp;</div></li><li><div>                  $this-&gt;args['customizer'] = true;&nbsp;</div></li><li><div>                  $this-&gt;args['admin_bar'] = false;&nbsp;</div></li><li><div>                  $this-&gt;args['allow_sub_menu'] = false;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Check if the Airplane Mode plugin is installed</span>&nbsp;</div></li><li><div>              if ( class_exists( 'Airplane_Mode_Core' ) ) {&nbsp;</div></li><li><div>                  $airplane = Airplane_Mode_Core::getInstance();&nbsp;</div></li><li><div>                  if ( method_exists( $airplane, 'enabled' ) ) {&nbsp;</div></li><li><div>                      if ( $airplane-&gt;enabled() ) {&nbsp;</div></li><li><div>                          $this-&gt;args['use_cdn'] = false;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  } else if ( $airplane-&gt;check_status() == 'on' ) {&nbsp;</div></li><li><div>                      $this-&gt;args['use_cdn'] = false;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Class Add Sub Menu Function, creates options submenu in WordPress admin area.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       3.1.9</span>&nbsp;</div></li><li><div><span class="comment">           * @access      private</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          private function add_submenu( $page_parent, $page_title, $menu_title, $page_permissions, $page_slug ) {&nbsp;</div></li><li><div>              global $submenu;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Just in case. One never knows.</span>&nbsp;</div></li><li><div>              $page_parent = strtolower( $page_parent );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $test = array(&nbsp;</div></li><li><div>                  'index.php' =&gt; 'dashboard', &nbsp;</div></li><li><div>                  'edit.php' =&gt; 'posts', &nbsp;</div></li><li><div>                  'upload.php' =&gt; 'media', &nbsp;</div></li><li><div>                  'link-manager.php' =&gt; 'links', &nbsp;</div></li><li><div>                  'edit.php?post_type=page' =&gt; 'pages', &nbsp;</div></li><li><div>                  'edit-comments.php' =&gt; 'comments', &nbsp;</div></li><li><div>                  'themes.php' =&gt; 'theme', &nbsp;</div></li><li><div>                  'plugins.php' =&gt; 'plugins', &nbsp;</div></li><li><div>                  'users.php' =&gt; 'users', &nbsp;</div></li><li><div>                  'tools.php' =&gt; 'management', &nbsp;</div></li><li><div>                  'options-general.php' =&gt; 'options', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset ( $test[ $page_parent ] ) ) {&nbsp;</div></li><li><div>                  $function = 'add_' . $test[ $page_parent ] . '_page';&nbsp;</div></li><li><div>                  $this-&gt;page = $function (&nbsp;</div></li><li><div>                      $page_title, $menu_title, $page_permissions, $page_slug, array( $this, 'generate_panel' )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  <span class="comment">// Network settings and Post type menus. These do not have</span>&nbsp;</div></li><li><div>                  <span class="comment">// wrappers and need to be appened to using add_submenu_page.</span>&nbsp;</div></li><li><div>                  <span class="comment">// Okay, since we've left the post type menu appending</span>&nbsp;</div></li><li><div>                  <span class="comment">// as default, we need to validate it, so anything that</span>&nbsp;</div></li><li><div>                  <span class="comment">// isn't post_type=&lt;post_type&gt; doesn't get through and mess</span>&nbsp;</div></li><li><div>                  <span class="comment">// things up.</span>&nbsp;</div></li><li><div>                  $addMenu = false;&nbsp;</div></li><li><div>                  if ( 'settings.php' != $page_parent ) {&nbsp;</div></li><li><div>                      <span class="comment">// Establish the needle</span>&nbsp;</div></li><li><div>                      $needle = '?post_type=';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">// Check if it exists in the page_parent (how I miss instr)</span>&nbsp;</div></li><li><div>                      $needlePos = strrpos( $page_parent, $needle );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">// It's there, so...</span>&nbsp;</div></li><li><div>                      if ( $needlePos &gt; 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// Get the post type.</span>&nbsp;</div></li><li><div>                          $postType = substr( $page_parent, $needlePos + strlen( $needle ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// Ensure it exists.</span>&nbsp;</div></li><li><div>                          if ( post_type_exists( $postType ) ) {&nbsp;</div></li><li><div>                              <span class="comment">// Set flag to add the menu page</span>&nbsp;</div></li><li><div>                              $addMenu = true;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          <span class="comment">// custom menu</span>&nbsp;</div></li><li><div>                      } elseif ( isset ( $submenu[ $this-&gt;args['page_parent'] ] ) ) {&nbsp;</div></li><li><div>                          $addMenu = true;&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          global $menu;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          foreach ( $menu as $menupriority =&gt; $menuitem ) {&nbsp;</div></li><li><div>                              $needle_menu_slug = isset ( $menuitem ) ? $menuitem[2] : false;&nbsp;</div></li><li><div>                              if ( $needle_menu_slug != false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  <span class="comment">// check if the current needle menu equals page_parent</span>&nbsp;</div></li><li><div>                                  if ( strcasecmp( $needle_menu_slug, $page_parent ) == 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                      <span class="comment">// found an empty parent menu</span>&nbsp;</div></li><li><div>                                      $addMenu = true;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      <span class="comment">// The page_parent was settings.php, so set menu add</span>&nbsp;</div></li><li><div>                      <span class="comment">// flag to true.</span>&nbsp;</div></li><li><div>                      $addMenu = true;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Class Options Page Function, creates main options page.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @return void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function _options_page() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// _options_page()</span>&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Add admin bar menu</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       3.1.5.16</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @global      $menu , $submenu, $wp_admin_bar</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function _admin_bar_menu() {&nbsp;</div></li><li><div>              global $menu, $submenu, $wp_admin_bar;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $ct = wp_get_theme();&nbsp;</div></li><li><div>              $theme_data = $ct;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! is_super_admin() || ! is_admin_bar_showing() || ! $this-&gt;args['admin_bar'] || $this-&gt;args['menu_type'] == 'hidden' ) {&nbsp;</div></li><li><div>                  return;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $menu ) {&nbsp;</div></li><li><div>                  foreach ( $menu as $menu_item ) {&nbsp;</div></li><li><div>                      if ( isset ( $menu_item[2] ) && $menu_item[2] === $this-&gt;args[&quot;page_slug&quot;] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">// Fetch the title</span></span>&nbsp;</div></li><li><div>                          $title = empty ( $this-&gt;args['admin_bar_icon'] ) ? $menu_item[0] : '&lt;span class=&quot;ab-icon ' . $this-&gt;args['admin_bar_icon'] . '&quot;&gt;&lt;/span&gt;' . $menu_item[0];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $nodeargs = array(&nbsp;</div></li><li><div>                              'id' =&gt; $menu_item[2], &nbsp;</div></li><li><div>                              'title' =&gt; $title, &nbsp;</div></li><li><div>                              'href' =&gt; admin_url( 'admin.php?page=' . $menu_item[2] ), &nbsp;</div></li><li><div>                              'meta' =&gt; array()&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                          $wp_admin_bar-&gt;add_node( $nodeargs );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          break;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset ( $submenu[ $this-&gt;args[&quot;page_slug&quot;] ] ) && is_array( $submenu[ $this-&gt;args[&quot;page_slug&quot;] ] ) ) {&nbsp;</div></li><li><div>                      foreach ( $submenu[ $this-&gt;args[&quot;page_slug&quot;] ] as $index =&gt; $redux_options_submenu ) {&nbsp;</div></li><li><div>                          $subnodeargs = array(&nbsp;</div></li><li><div>                              'id' =&gt; $this-&gt;args[&quot;page_slug&quot;] . '_' . $index, &nbsp;</div></li><li><div>                              'title' =&gt; $redux_options_submenu[0], &nbsp;</div></li><li><div>                              'parent' =&gt; $this-&gt;args[&quot;page_slug&quot;], &nbsp;</div></li><li><div>                              'href' =&gt; admin_url( 'admin.php?page=' . $redux_options_submenu[2] ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $wp_admin_bar-&gt;add_node( $subnodeargs );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Let's deal with external links</span>&nbsp;</div></li><li><div>                  if ( isset ( $this-&gt;args['admin_bar_links'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( ! $this-&gt;args['dev_mode'] && $this-&gt;omit_admin_items ) {&nbsp;</div></li><li><div>                          return;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">// Group for Main Root Menu (External Group)</span>&nbsp;</div></li><li><div>                      $wp_admin_bar-&gt;add_node( array(&nbsp;</div></li><li><div>                          'id' =&gt; $this-&gt;args[&quot;page_slug&quot;] . '-external', &nbsp;</div></li><li><div>                          'parent' =&gt; $this-&gt;args[&quot;page_slug&quot;], &nbsp;</div></li><li><div>                          'group' =&gt; true, &nbsp;</div></li><li><div>                          'meta' =&gt; array( 'class' =&gt; 'ab-sub-secondary' )&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">// Add Child Menus to External Group Menu</span>&nbsp;</div></li><li><div>                      foreach ( $this-&gt;args['admin_bar_links'] as $link ) {&nbsp;</div></li><li><div>                          if ( ! isset ( $link['id'] ) ) {&nbsp;</div></li><li><div>                              $link['id'] = $this-&gt;args[&quot;page_slug&quot;] . '-sub-' . sanitize_html_class( $link['title'] );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $externalnodeargs = array(&nbsp;</div></li><li><div>                              'id' =&gt; $link['id'], &nbsp;</div></li><li><div>                              'title' =&gt; $link['title'], &nbsp;</div></li><li><div>                              'parent' =&gt; $this-&gt;args[&quot;page_slug&quot;] . '-external', &nbsp;</div></li><li><div>                              'href' =&gt; $link['href'], &nbsp;</div></li><li><div>                              'meta' =&gt; array( 'target' =&gt; '_blank' )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $wp_admin_bar-&gt;add_node( $externalnodeargs );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// Fetch the title</span></span>&nbsp;</div></li><li><div>                  $title = empty ( $this-&gt;args['admin_bar_icon'] ) ? $this-&gt;args['menu_title'] : '&lt;span class=&quot;ab-icon ' . $this-&gt;args['admin_bar_icon'] . '&quot;&gt;&lt;/span&gt;' . $this-&gt;args['menu_title'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $nodeargs = array(&nbsp;</div></li><li><div>                      'id' =&gt; $this-&gt;args[&quot;page_slug&quot;], &nbsp;</div></li><li><div>                      'title' =&gt; $title, &nbsp;</div></li><li><div>                      <span class="comment">// $theme_data-&gt;get( 'Name' ) . &quot; &quot; . __( 'Options', 'redux-framework-demo' ), </span>&nbsp;</div></li><li><div>                      'href' =&gt; admin_url( 'admin.php?page=' . $this-&gt;args[&quot;page_slug&quot;] ), &nbsp;</div></li><li><div>                      'meta' =&gt; array()&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $wp_admin_bar-&gt;add_node( $nodeargs );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// _admin_bar_menu()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Output dynamic CSS at bottom of HEAD</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       3.2.8</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function _output_css() {&nbsp;</div></li><li><div>              if ( $this-&gt;args['output'] == false && $this-&gt;args['compiler'] == false ) {&nbsp;</div></li><li><div>                  return;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset ( $this-&gt;no_output ) ) {&nbsp;</div></li><li><div>                  return;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $this-&gt;outputCSS ) && ( $this-&gt;args['output_tag'] == true || ( isset ( $_POST['customized'] ) ) ) ) {&nbsp;</div></li><li><div>                  echo '&lt;style type=&quot;text/css&quot; title=&quot;dynamic-css&quot; class=&quot;options-output&quot;&gt;' . $this-&gt;outputCSS . '&lt;/style&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Enqueue CSS and Google fonts for front end</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function _enqueue_output() {&nbsp;</div></li><li><div>              if ( $this-&gt;args['output'] == false && $this-&gt;args['compiler'] == false ) {&nbsp;</div></li><li><div>                  return;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment">/** @noinspection PhpUnusedLocalVariableInspection */</span></span>&nbsp;</div></li><li><div>              foreach ( $this-&gt;sections as $k =&gt; $section ) {&nbsp;</div></li><li><div>                  if ( isset ( $section['type'] ) && ( $section['type'] == 'divide' ) ) {&nbsp;</div></li><li><div>                      continue;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset ( $section['fields'] ) ) {&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">/** @noinspection PhpUnusedLocalVariableInspection */</span></span>&nbsp;</div></li><li><div>                      foreach ( $section['fields'] as $fieldk =&gt; $field ) {&nbsp;</div></li><li><div>                          if ( isset ( $field['type'] ) && $field['type'] != &quot;callback&quot; ) {&nbsp;</div></li><li><div>                              $field_class = &quot;ReduxFramework_{$field['type']}&quot;;&nbsp;</div></li><li><div>                              if ( ! class_exists( $field_class ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  if ( ! isset ( $field['compiler'] ) ) {&nbsp;</div></li><li><div>                                      $field['compiler'] = &quot;&quot;;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                                   * Field class file</span>&nbsp;</div></li><li><div><span class="comment">                                   * filter 'redux/{opt_name}/field/class/{field.type}</span>&nbsp;</div></li><li><div><span class="comment">                                   *</span>&nbsp;</div></li><li><div><span class="comment">                                   * @param       string        field class file</span>&nbsp;</div></li><li><div><span class="comment">                                   * @param array $field        field config data</span>&nbsp;</div></li><li><div><span class="comment">                                   */</span>&nbsp;</div></li><li><div>                                  $class_file = apply_filters( &quot;redux/{$this-&gt;args['opt_name']}/field/class/{$field['type']}&quot;, self::$_dir . &quot;inc/fields/{$field['type']}/field_{$field['type']}.php&quot;, $field );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  if ( $class_file && file_exists( $class_file ) && ! class_exists( $field_class ) ) {&nbsp;</div></li><li><div>                                      <span class="comment">/** @noinspection PhpIncludeInspection */</span>&nbsp;</div></li><li><div>                                      require_once $class_file;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( ! empty ( $this-&gt;options[ $field['id'] ] ) && class_exists( $field_class ) && method_exists( $field_class, 'output' ) && $this-&gt;_can_output_css( $field ) ) {&nbsp;</div></li><li><div>                                  $field = apply_filters( &quot;redux/field/{$this-&gt;args['opt_name']}/output_css&quot;, $field );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  if ( ! empty ( $field['output'] ) && ! is_array( $field['output'] ) ) {&nbsp;</div></li><li><div>                                      $field['output'] = array( $field['output'] );&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $value = isset ( $this-&gt;options[ $field['id'] ] ) ? $this-&gt;options[ $field['id'] ] : '';&nbsp;</div></li><li><div>                                  $enqueue = new $field_class ( $field, $value, $this );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  if ( ( ( isset ( $field['output'] ) && ! empty ( $field['output'] ) ) || ( isset ( $field['compiler'] ) && ! empty ( $field['compiler'] ) ) || $field['type'] == &quot;typography&quot; || $field['type'] == &quot;icon_select&quot; ) ) {&nbsp;</div></li><li><div>                                      $enqueue-&gt;output();&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// For use like in the customizer. Stops the output, but passes the CSS in the variable for the compiler</span>&nbsp;</div></li><li><div>              if ( isset ( $this-&gt;no_output ) ) {&nbsp;</div></li><li><div>                  return;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $this-&gt;typography ) && ! empty ( $this-&gt;typography ) && filter_var( $this-&gt;args['output'], FILTER_VALIDATE_BOOLEAN ) ) {&nbsp;</div></li><li><div>                  $version = ! empty ( $this-&gt;transients['last_save'] ) ? $this-&gt;transients['last_save'] : '';&nbsp;</div></li><li><div>                  $typography = new ReduxFramework_typography ( null, null, $this );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $this-&gt;args['async_typography'] && ! empty ( $this-&gt;typography ) ) {&nbsp;</div></li><li><div>                      $families = array();&nbsp;</div></li><li><div>                      foreach ( $this-&gt;typography as $key =&gt; $value ) {&nbsp;</div></li><li><div>                          $families[] = $key;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      ?&gt;&nbsp;</div></li><li><div>                      &lt;script&gt;&nbsp;</div></li><li><div>                          <span class="comment">/* You can add more configuration options to webfontloader by previously defining the WebFontConfig with your options */</span>&nbsp;</div></li><li><div>                          if ( typeof WebFontConfig === &quot;undefined&quot; ) {&nbsp;</div></li><li><div>                              WebFontConfig = new Object();&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          WebFontConfig['google'] = {families: [&lt;?php echo $typography-&gt;makeGoogleWebfontString ( $this-&gt;typography ) ?&gt;]};&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          (function() {&nbsp;</div></li><li><div>                              var wf = document.createElement( 'script' );&nbsp;</div></li><li><div>                              wf.src = 'https:<span class="comment">//ajax.googleapis.com/ajax/libs/webfont/1.5.3/webfont.js';</span>&nbsp;</div></li><li><div>                              wf.type = 'text/javascript';&nbsp;</div></li><li><div>                              wf.async = 'true';&nbsp;</div></li><li><div>                              var s = document.getElementsByTagName( 'script' )[0];&nbsp;</div></li><li><div>                              s.parentNode.insertBefore( wf, s );&nbsp;</div></li><li><div>                          })();&nbsp;</div></li><li><div>                      &lt;/script&gt;&nbsp;</div></li><li><div>                      &lt;?php&nbsp;</div></li><li><div>                  } elseif ( ! $this-&gt;args['disable_google_fonts_link'] ) {&nbsp;</div></li><li><div>                      $protocol = ( ! empty ( $_SERVER['HTTPS'] ) && $_SERVER['HTTPS'] !== 'off' || $_SERVER['SERVER_PORT'] == 443 ) ? &quot;https:&quot; : &quot;http:&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">//echo '&lt;link rel=&quot;stylesheet&quot; id=&quot;options-google-fonts&quot; title=&quot;&quot; href=&quot;'.$protocol.$typography-&gt;makeGoogleWebfontLink( $this-&gt;typography ).'&amp;v='.$version.'&quot; type=&quot;text/css&quot; media=&quot;all&quot; /&gt;';</span>&nbsp;</div></li><li><div>                      wp_register_style( 'redux-google-fonts-' . $this-&gt;args['opt_name'], $protocol . $typography-&gt;makeGoogleWebfontLink( $this-&gt;typography ), '', $version );&nbsp;</div></li><li><div>                      wp_enqueue_style( 'redux-google-fonts-' . $this-&gt;args['opt_name'] );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// _enqueue_output()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Enqueue CSS/JS for options page</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @global      $wp_styles</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function _enqueue() {&nbsp;</div></li><li><div>              require_once 'core/enqueue.php';&nbsp;</div></li><li><div>              $enqueue = new reduxCoreEnqueue ( $this );&nbsp;</div></li><li><div>              $enqueue-&gt;init();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// _enqueue()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Show page help</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function _load_page() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Do admin head action for this page</span>&nbsp;</div></li><li><div>              add_action( 'admin_head', array( &$this, 'admin_head' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Do admin footer text hook</span>&nbsp;</div></li><li><div>              add_filter( 'admin_footer_text', array( &$this, 'admin_footer_text' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $screen = get_current_screen();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( is_array( $this-&gt;args['help_tabs'] ) ) {&nbsp;</div></li><li><div>                  foreach ( $this-&gt;args['help_tabs'] as $tab ) {&nbsp;</div></li><li><div>                      $screen-&gt;add_help_tab( $tab );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment">// If</span></span></span> hint argument is set, display hint tab&nbsp;</div></li><li><div>              if ( true == $this-&gt;show_hints ) {&nbsp;</div></li><li><div>                  global $current_user;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Users enable/disable hint choice</span>&nbsp;</div></li><li><div>                  $hint_status = get_user_meta( $current_user-&gt;ID, 'ignore_hints' ) ? get_user_meta( $current_user-&gt;ID, 'ignore_hints', true ) : 'true';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// current page parameters</span>&nbsp;</div></li><li><div>                  $curPage = $_GET['page'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $curTab = '0';&nbsp;</div></li><li><div>                  if ( isset ( $_GET['tab'] ) ) {&nbsp;</div></li><li><div>                      $curTab = esc_attr( $_GET['tab'] );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Default url values for enabling hints.</span>&nbsp;</div></li><li><div>                  $dismiss = 'true';&nbsp;</div></li><li><div>                  $s = __( 'Enable', 'evolve' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Values for disabling hints.</span>&nbsp;</div></li><li><div>                  if ( 'true' == $hint_status ) {&nbsp;</div></li><li><div>                      $dismiss = 'false';&nbsp;</div></li><li><div>                      $s = __( 'Disable', 'evolve' );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Make URL</span>&nbsp;</div></li><li><div>                  $url = '&lt;a class=&quot;redux_hint_status&quot; href=&quot;?dismiss=' . $dismiss . '&amp;id=hints&amp;page=' . $curPage . '&amp;tab=' . $curTab . '&quot;&gt;' . $s . ' hints&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $event = __( 'moving the mouse over', 'evolve' );&nbsp;</div></li><li><div>                  if ( 'click' == $this-&gt;args['hints']['tip_effect']['show']['event'] ) {&nbsp;</div></li><li><div>                      $event = __( 'clicking', 'evolve' );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Construct message</span>&nbsp;</div></li><li><div>                  $msg = sprintf( __( 'Hints are tooltips that popup when %d the hint icon, offering addition information about the field in which they appear.  They can be %d d by using the link below.', 'evolve' ), $event, strtolower( $s ) ) . '&lt;br/&gt;&lt;br/&gt;' . $url;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Construct hint tab</span>&nbsp;</div></li><li><div>                  $tab = array(&nbsp;</div></li><li><div>                      'id' =&gt; 'redux-hint-tab', &nbsp;</div></li><li><div>                      'title' =&gt; __( 'Hints', 'evolve' ), &nbsp;</div></li><li><div>                      'content' =&gt; '&lt;p&gt;' . $msg . '&lt;/p&gt;'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $screen-&gt;add_help_tab( $tab );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Sidebar text</span>&nbsp;</div></li><li><div>              if ( $this-&gt;args['help_sidebar'] != '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Specify users text from arguments</span>&nbsp;</div></li><li><div>                  $screen-&gt;set_help_sidebar( $this-&gt;args['help_sidebar'] );&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment"><span class="comment">// If</span></span></span> sidebar text is empty and hints are active, display text&nbsp;</div></li><li><div>                  <span class="comment">// about hints.</span>&nbsp;</div></li><li><div>                  if ( true == $this-&gt;show_hints ) {&nbsp;</div></li><li><div>                      $screen-&gt;set_help_sidebar( '&lt;p&gt;&lt;strong&gt;Redux Framework&lt;/strong&gt;&lt;br/&gt;&lt;br/&gt;Hint Tooltip Preferences&lt;/p&gt;' );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * action 'redux-load-page-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param object $screen WP_Screen</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              do_action( &quot;redux-load-page-{$this-&gt;args['opt_name']}&quot;, $screen ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * action 'redux/page/{opt_name}/load'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param object $screen WP_Screen</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              do_action( &quot;redux/page/{$this-&gt;args['opt_name']}/load&quot;, $screen );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// _load_page()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Do action redux-admin-head for options page</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function admin_head() {&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * action 'redux-admin-head-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param  object $this ReduxFramework</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              do_action( &quot;redux-admin-head-{$this-&gt;args['opt_name']}&quot;, $this ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * action 'redux/page/{opt_name}/header'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param  object $this ReduxFramework</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              do_action( &quot;redux/page/{$this-&gt;args['opt_name']}/header&quot;, $this );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// admin_head()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Return footer text</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       2.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @return      string $this-&gt;args['footer_credit']</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function admin_footer_text() {&nbsp;</div></li><li><div>              return $this-&gt;args['footer_credit'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// admin_footer_text()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Return default output string for use in panel</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       3.1.5</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @return      string default_output</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          private function get_default_output_string( $field ) {&nbsp;</div></li><li><div>              $default_output = &quot;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! isset ( $field['default'] ) ) {&nbsp;</div></li><li><div>                  $field['default'] = &quot;&quot;;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! is_array( $field['default'] ) ) {&nbsp;</div></li><li><div>                  if ( ! empty ( $field['options'][ $field['default'] ] ) ) {&nbsp;</div></li><li><div>                      if ( ! empty ( $field['options'][ $field['default'] ]['alt'] ) ) {&nbsp;</div></li><li><div>                          $default_output .= $field['options'][ $field['default'] ]['alt'] . ', ';&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          <span class="comment">// TODO: This serialize fix may not be the best solution. Look into it. PHP 5.4 error without serialize</span>&nbsp;</div></li><li><div>                          if ( ! is_array( $field['options'][ $field['default'] ] ) ) {&nbsp;</div></li><li><div>                              $default_output .= $field['options'][ $field['default'] ] . &quot;, &quot;;&nbsp;</div></li><li><div>                          } else {&nbsp;</div></li><li><div>                              $default_output .= serialize( $field['options'][ $field['default'] ] ) . &quot;, &quot;;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  } else if ( ! empty ( $field['options'][ $field['default'] ] ) ) {&nbsp;</div></li><li><div>                      $default_output .= $field['options'][ $field['default'] ] . &quot;, &quot;;&nbsp;</div></li><li><div>                  } else if ( ! empty ( $field['default'] ) ) {&nbsp;</div></li><li><div>                      if ( $field['type'] == 'switch' && isset ( $field['on'] ) && isset ( $field['off'] ) ) {&nbsp;</div></li><li><div>                          $default_output .= ( $field['default'] == 1 ? $field['on'] : $field['off'] ) . ', ';&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          $default_output .= $field['default'] . ', ';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  foreach ( $field['default'] as $defaultk =&gt; $defaultv ) {&nbsp;</div></li><li><div>                      if ( ! empty ( $field['options'][ $defaultv ]['alt'] ) ) {&nbsp;</div></li><li><div>                          $default_output .= $field['options'][ $defaultv ]['alt'] . ', ';&nbsp;</div></li><li><div>                      } else if ( ! empty ( $field['options'][ $defaultv ] ) ) {&nbsp;</div></li><li><div>                          $default_output .= $field['options'][ $defaultv ] . &quot;, &quot;;&nbsp;</div></li><li><div>                      } else if ( ! empty ( $field['options'][ $defaultk ] ) ) {&nbsp;</div></li><li><div>                          $default_output .= $field['options'][ $defaultk ] . &quot;, &quot;;&nbsp;</div></li><li><div>                      } else if ( ! empty ( $defaultv ) ) {&nbsp;</div></li><li><div>                          $default_output .= $defaultv . ', ';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $default_output ) ) {&nbsp;</div></li><li><div>                  $default_output = __( 'Default', 'evolve' ) . &quot;: &quot; . substr( $default_output, 0, - 2 );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $default_output ) ) {&nbsp;</div></li><li><div>                  $default_output = '&lt;span class=&quot;showDefaults&quot;&gt;' . $default_output . '&lt;/span&gt;&lt;br class=&quot;default_br&quot; /&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $default_output;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// get_default_output_string()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          public function get_header_html( $field ) {&nbsp;</div></li><li><div>              global $current_user;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Set to empty string to avoid wanrings.</span>&nbsp;</div></li><li><div>              $hint = '';&nbsp;</div></li><li><div>              $th = &quot;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset ( $field['title'] ) && isset ( $field['type'] ) && $field['type'] !== &quot;info&quot; && $field['type'] !== &quot;section&quot; ) {&nbsp;</div></li><li><div>                  $default_mark = ( ! empty ( $field['default'] ) && isset ( $this-&gt;options[ $field['id'] ] ) && $this-&gt;options[ $field['id'] ] == $field['default'] && ! empty ( $this-&gt;args['default_mark'] ) && isset ( $field['default'] ) ) ? $this-&gt;args['default_mark'] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment"><span class="comment">// If</span></span></span> a hint is specified in the field, process it.&nbsp;</div></li><li><div>                  if ( isset ( $field['hint'] ) && ! '' == $field['hint'] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">// Set show_hints flag to true, so helptab will be displayed.</span>&nbsp;</div></li><li><div>                      $this-&gt;show_hints = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $hint = apply_filters( 'redux/hints/html', $hint, $field, $this-&gt;args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">// Get user pref for displaying hints.</span>&nbsp;</div></li><li><div>                      $metaVal = get_user_meta( $current_user-&gt;ID, 'ignore_hints', true );&nbsp;</div></li><li><div>                      if ( 'true' == $metaVal || empty ( $metaVal ) && empty( $hint ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// Set hand cursor for clickable hints</span>&nbsp;</div></li><li><div>                          $pointer = '';&nbsp;</div></li><li><div>                          if ( isset ( $this-&gt;args['hints']['tip_effect']['show']['event'] ) && 'click' == $this-&gt;args['hints']['tip_effect']['show']['event'] ) {&nbsp;</div></li><li><div>                              $pointer = 'pointer';&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $size = '16px';&nbsp;</div></li><li><div>                          if ( 'large' == $this-&gt;args['hints']['icon_size'] ) {&nbsp;</div></li><li><div>                              $size = '18px';&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// In case docs are ignored.</span>&nbsp;</div></li><li><div>                          $titleParam = isset ( $field['hint']['title'] ) ? $field['hint']['title'] : '';&nbsp;</div></li><li><div>                          $contentParam = isset ( $field['hint']['content'] ) ? $field['hint']['content'] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $hint_color = isset ( $this-&gt;args['hints']['icon_color'] ) ? $this-&gt;args['hints']['icon_color'] : '#d3d3d3';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// Set hint html with appropriate position css</span>&nbsp;</div></li><li><div>                          $hint = '&lt;div class=&quot;redux-hint-qtip&quot; style=&quot;float:' . $this-&gt;args['hints']['icon_position'] . '; font-size: ' . $size . '; color:' . $hint_color . '; cursor: ' . $pointer . ';&quot; qtip-title=&quot;' . $titleParam . '&quot; qtip-content=&quot;' . $contentParam . '&quot;&gt;&nbsp;&lt;i class=&quot;' . ( isset( $this-&gt;args['hints']['icon'] ) ? $this-&gt;args['hints']['icon'] : '' ) . '&quot;&gt;&lt;/i&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! empty ( $field['title'] ) ) {&nbsp;</div></li><li><div>                      if ( 'left' == $this-&gt;args['hints']['icon_position'] ) {&nbsp;</div></li><li><div>                          $th = $hint . $field['title'] . $default_mark . &quot;&quot;;&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          $th = $field['title'] . $default_mark . &quot;&quot; . $hint;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset ( $field['subtitle'] ) ) {&nbsp;</div></li><li><div>                      $th .= '&lt;span class=&quot;description&quot;&gt;' . $field['subtitle'] . '&lt;/span&gt;';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $th ) ) {&nbsp;</div></li><li><div>                  $th = '&lt;div class=&quot;redux_field_th&quot;&gt;' . $th . '&lt;/div&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $filter_arr = array(&nbsp;</div></li><li><div>                  'editor', &nbsp;</div></li><li><div>                  'ace_editor', &nbsp;</div></li><li><div>                  'info', &nbsp;</div></li><li><div>                  'section', &nbsp;</div></li><li><div>                  'repeater', &nbsp;</div></li><li><div>                  'color_scheme', &nbsp;</div></li><li><div>                  'social_profiles', &nbsp;</div></li><li><div>                  'css_layout'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $this-&gt;args['default_show'] == true && isset ( $field['default'] ) && isset ( $this-&gt;options[ $field['id'] ] ) && $this-&gt;options[ $field['id'] ] != $field['default'] && ! in_array( $field['type'], $filter_arr ) ) {&nbsp;</div></li><li><div>                  $th .= $this-&gt;get_default_output_string( $field );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $th;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Register Option for use</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function _register_settings() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// TODO - REMOVE</span>&nbsp;</div></li><li><div>              <span class="comment">// Not used by new sample-config, but in here for legacy builds</span>&nbsp;</div></li><li><div>              <span class="comment">// This is bad and can break things. Hehe.</span>&nbsp;</div></li><li><div>              if ( ! function_exists( 'wp_get_current_user' ) ) {&nbsp;</div></li><li><div>                  require_once ABSPATH . &quot;wp-includes/pluggable.php&quot;;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $this-&gt;args['options_api'] == true ) {&nbsp;</div></li><li><div>                  register_setting( $this-&gt;args['opt_name'] . '_group', $this-&gt;args['opt_name'], array(&nbsp;</div></li><li><div>                      $this, &nbsp;</div></li><li><div>                      '_validate_options'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( is_null( $this-&gt;sections ) ) {&nbsp;</div></li><li><div>                  return;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( empty( $this-&gt;options_defaults ) ) {&nbsp;</div></li><li><div>                  $this-&gt;options_defaults = $this-&gt;_default_values();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $runUpdate = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( $this-&gt;sections as $k =&gt; $section ) {&nbsp;</div></li><li><div>                  if ( isset ( $section['type'] ) && $section['type'] == 'divide' ) {&nbsp;</div></li><li><div>                      continue;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $display = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset ( $_GET['page'] ) && $_GET['page'] == $this-&gt;args['page_slug'] ) {&nbsp;</div></li><li><div>                      if ( isset ( $section['panel'] ) && $section['panel'] == false ) {&nbsp;</div></li><li><div>                          $display = false;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// DOVY! Replace $k with $section['id'] when ready</span>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * filter 'redux-section-{index}-modifier-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array $section section configuration</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  $section = apply_filters( &quot;redux-section-{$k}-modifier-{$this-&gt;args['opt_name']}&quot;, $section );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * filter 'redux/options/{opt_name}/section/{section.id}'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array $section section configuration</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  if ( isset ( $section['id'] ) ) {&nbsp;</div></li><li><div>                      $section = apply_filters( &quot;redux/options/{$this-&gt;args['opt_name']}/section/{$section['id']}&quot;, $section );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( empty ( $section ) ) {&nbsp;</div></li><li><div>                      unset ( $this-&gt;sections[ $k ] );&nbsp;</div></li><li><div>                      continue;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! isset ( $section['title'] ) ) {&nbsp;</div></li><li><div>                      $section['title'] = &quot;&quot;;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset ( $section['customizer_only'] ) && $section['customizer_only'] == true ) {&nbsp;</div></li><li><div>                      $section['panel'] = false;&nbsp;</div></li><li><div>                      $this-&gt;sections[ $k ] = $section;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $heading = isset ( $section['heading'] ) ? $section['heading'] : $section['title'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset ( $section['permissions'] ) ) {&nbsp;</div></li><li><div>                      if ( ! current_user_can( $section['permissions'] ) ) {&nbsp;</div></li><li><div>                          $this-&gt;hidden_perm_sections[] = $section['title'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          foreach ( $section['fields'] as $num =&gt; $field_data ) {&nbsp;</div></li><li><div>                              $field_type = $field_data['type'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( $field_type != 'section' || $field_type != 'divide' || $field_type != 'info' || $field_type != 'raw' ) {&nbsp;</div></li><li><div>                                  $field_id = $field_data['id'];&nbsp;</div></li><li><div>                                  $default = isset ( $this-&gt;options_defaults[ $field_id ] ) ? $this-&gt;options_defaults[ $field_id ] : '';&nbsp;</div></li><li><div>                                  $data = isset ( $this-&gt;options[ $field_id ] ) ? $this-&gt;options[ $field_id ] : $default;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $this-&gt;hidden_perm_fields[ $field_id ] = $data;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          continue;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! $display || ! function_exists( 'add_settings_section' ) ) {&nbsp;</div></li><li><div>                      $this-&gt;no_panel_section[ $k ] = $section;&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      add_settings_section( $this-&gt;args['opt_name'] . $k . '_section', $heading, array(&nbsp;</div></li><li><div>                          &$this, &nbsp;</div></li><li><div>                          '_section_desc'&nbsp;</div></li><li><div> ), $this-&gt;args['opt_name'] . $k . '_section_group' );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $sectionIndent = false;&nbsp;</div></li><li><div>                  if ( isset ( $section['fields'] ) ) {&nbsp;</div></li><li><div>                      foreach ( $section['fields'] as $fieldk =&gt; $field ) {&nbsp;</div></li><li><div>                          if ( ! isset ( $field['type'] ) ) {&nbsp;</div></li><li><div>                              continue; <span class="comment">// You need a type!</span>&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( $field['type'] == &quot;info&quot; && isset( $field['raw_html'] ) && $field['raw_html'] == true ) {&nbsp;</div></li><li><div>                              $field['type'] = &quot;raw&quot;;&nbsp;</div></li><li><div>                              $field['content'] = $field['desc'];&nbsp;</div></li><li><div>                              $field['desc'] = &quot;&quot;;&nbsp;</div></li><li><div>                              $this-&gt;sections[ $k ]['fields'][ $fieldk ] = $field;&nbsp;</div></li><li><div>                          } else if ( $field['type'] == &quot;info&quot; ) {&nbsp;</div></li><li><div>                              if ( ! isset( $field['full_width'] ) ) {&nbsp;</div></li><li><div>                                  $field['full_width'] = true;&nbsp;</div></li><li><div>                                  $this-&gt;sections[ $k ]['fields'][ $fieldk ] = $field;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( $field['type'] == &quot;raw&quot; ) {&nbsp;</div></li><li><div>                              if ( isset( $field['align'] ) ) {&nbsp;</div></li><li><div>                                  $field['full_width'] = $field['align'] ? false : true;&nbsp;</div></li><li><div>                                  unset( $field['align'] );&nbsp;</div></li><li><div>                              } else if ( ! isset( $field['full_width'] ) ) {&nbsp;</div></li><li><div>                                  $field['full_width'] = true;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              $this-&gt;sections[ $k ]['fields'][ $fieldk ] = $field;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                           * filter 'redux/options/{opt_name}/field/{field.id}'</span>&nbsp;</div></li><li><div><span class="comment">                           *</span>&nbsp;</div></li><li><div><span class="comment">                           * @param array $field field config</span>&nbsp;</div></li><li><div><span class="comment">                           */</span>&nbsp;</div></li><li><div>                          $field = apply_filters( &quot;redux/options/{$this-&gt;args['opt_name']}/field/{$field['id']}/register&quot;, $field );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $this-&gt;field_types[ $field['type'] ] = isset ( $this-&gt;field_types[ $field['type'] ] ) ? $this-&gt;field_types[ $field['type'] ] : array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $this-&gt;field_sections[ $field['type'] ][ $field['id'] ] = $k;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $display = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset ( $_GET['page'] ) && $_GET['page'] == $this-&gt;args['page_slug'] ) {&nbsp;</div></li><li><div>                              if ( isset ( $field['panel'] ) && $field['panel'] == false ) {&nbsp;</div></li><li><div>                                  $display = false;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          if ( isset ( $field['customizer_only'] ) && $field['customizer_only'] == true ) {&nbsp;</div></li><li><div>                              $display = false;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset ( $section['customizer'] ) ) {&nbsp;</div></li><li><div>                              $field['customizer'] = $section['customizer'];&nbsp;</div></li><li><div>                              $this-&gt;sections[ $k ]['fields'][ $fieldk ] = $field;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset ( $field['permissions'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( ! current_user_can( $field['permissions'] ) ) {&nbsp;</div></li><li><div>                                  $data = isset ( $this-&gt;options[ $field['id'] ] ) ? $this-&gt;options[ $field['id'] ] : $this-&gt;options_defaults[ $field['id'] ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $this-&gt;hidden_perm_fields[ $field['id'] ] = $data;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  continue;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( ! isset ( $field['id'] ) ) {&nbsp;</div></li><li><div>                              echo '&lt;br /&gt;&lt;h3&gt;No field ID is set.&lt;/h3&gt;&lt;pre&gt;';&nbsp;</div></li><li><div>                              print_r( $field );&nbsp;</div></li><li><div>                              echo &quot;&lt;/pre&gt;&lt;br /&gt;&quot;;&nbsp;</div></li><li><div>                              continue;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset ( $field['type'] ) && $field['type'] == &quot;section&quot; ) {&nbsp;</div></li><li><div>                              if ( isset ( $field['indent'] ) && $field['indent'] == true ) {&nbsp;</div></li><li><div>                                  $sectionIndent = true;&nbsp;</div></li><li><div>                              } else {&nbsp;</div></li><li><div>                                  $sectionIndent = false;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset ( $field['type'] ) && $field['type'] == &quot;info&quot; && $sectionIndent ) {&nbsp;</div></li><li><div>                              $field['indent'] = $sectionIndent;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $th = $this-&gt;get_header_html( $field );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $field['name'] = $this-&gt;args['opt_name'] . '[' . $field['id'] . ']';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// Set the default value if present</span>&nbsp;</div></li><li><div>                          $this-&gt;options_defaults[ $field['id'] ] = isset ( $this-&gt;options_defaults[ $field['id'] ] ) ? $this-&gt;options_defaults[ $field['id'] ] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// Set the defaults to the value if not present</span>&nbsp;</div></li><li><div>                          $doUpdate = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// Check fields for values in the default parameter</span>&nbsp;</div></li><li><div>                          if ( ! isset ( $this-&gt;options[ $field['id'] ] ) && isset ( $field['default'] ) ) {&nbsp;</div></li><li><div>                              $this-&gt;options_defaults[ $field['id'] ] = $this-&gt;options[ $field['id'] ] = $field['default'];&nbsp;</div></li><li><div>                              $doUpdate = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              <span class="comment">// Check fields that hae no default value, but an options value with settings to</span>&nbsp;</div></li><li><div>                              <span class="comment">// be saved by default</span>&nbsp;</div></li><li><div>                          } elseif ( ! isset ( $this-&gt;options[ $field['id'] ] ) && isset ( $field['options'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              <span class="comment"><span class="comment"><span class="comment">// If</span></span></span> sorter field, check for options as save them as defaults&nbsp;</div></li><li><div>                              if ( $field['type'] == 'sorter' || $field['type'] == 'sortable' ) {&nbsp;</div></li><li><div>                                  $this-&gt;options_defaults[ $field['id'] ] = $this-&gt;options[ $field['id'] ] = $field['options'];&nbsp;</div></li><li><div>                                  $doUpdate = true;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// CORRECT URLS if media URLs are wrong, but attachment IDs are present.</span>&nbsp;</div></li><li><div>                          if ( $field['type'] == &quot;media&quot; ) {&nbsp;</div></li><li><div>                              if ( isset ( $this-&gt;options[ $field['id'] ]['id'] ) && isset ( $this-&gt;options[ $field['id'] ]['url'] ) && ! empty ( $this-&gt;options[ $field['id'] ]['url'] ) && strpos( $this-&gt;options[ $field['id'] ]['url'], str_replace( 'http:<span class="comment"><span class="comment">//'</span>, </span>'', WP_CONTENT_URL ) ) === false ) {&nbsp;</div></li><li><div>                                  $data = wp_get_attachment_url( $this-&gt;options[ $field['id'] ]['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  if ( isset ( $data ) && ! empty ( $data ) ) {&nbsp;</div></li><li><div>                                      $this-&gt;options[ $field['id'] ]['url'] = $data;&nbsp;</div></li><li><div>                                      $data = wp_get_attachment_image_src( $this-&gt;options[ $field['id'] ]['id'], array(&nbsp;</div></li><li><div>                                          150, &nbsp;</div></li><li><div>                                          150&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>                                      $this-&gt;options[ $field['id'] ]['thumbnail'] = $data[0];&nbsp;</div></li><li><div>                                      $doUpdate = true;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( $field['type'] == &quot;background&quot; ) {&nbsp;</div></li><li><div>                              if ( isset ( $this-&gt;options[ $field['id'] ]['media']['id'] ) && isset ( $this-&gt;options[ $field['id'] ]['background-image'] ) && ! empty ( $this-&gt;options[ $field['id'] ]['background-image'] ) && strpos( $this-&gt;options[ $field['id'] ]['background-image'], str_replace( 'http:<span class="comment"><span class="comment">//'</span>, </span>'', WP_CONTENT_URL ) ) === false ) {&nbsp;</div></li><li><div>                                  $data = wp_get_attachment_url( $this-&gt;options[ $field['id'] ]['media']['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  if ( isset ( $data ) && ! empty ( $data ) ) {&nbsp;</div></li><li><div>                                      $this-&gt;options[ $field['id'] ]['background-image'] = $data;&nbsp;</div></li><li><div>                                      $data = wp_get_attachment_image_src( $this-&gt;options[ $field['id'] ]['media']['id'], array(&nbsp;</div></li><li><div>                                          150, &nbsp;</div></li><li><div>                                          150&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>                                      $this-&gt;options[ $field['id'] ]['media']['thumbnail'] = $data[0];&nbsp;</div></li><li><div>                                      $doUpdate = true;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( $field['type'] == &quot;slides&quot; ) {&nbsp;</div></li><li><div>                              if ( isset ( $this-&gt;options[ $field['id'] ] ) && is_array( $this-&gt;options[ $field['id'] ] ) && isset ( $this-&gt;options[ $field['id'] ][0]['attachment_id'] ) && isset ( $this-&gt;options[ $field['id'] ][0]['image'] ) && ! empty ( $this-&gt;options[ $field['id'] ][0]['image'] ) && strpos( $this-&gt;options[ $field['id'] ][0]['image'], str_replace( 'http:<span class="comment"><span class="comment">//'</span>, </span>'', WP_CONTENT_URL ) ) === false ) {&nbsp;</div></li><li><div>                                  foreach ( $this-&gt;options[ $field['id'] ] as $key =&gt; $val ) {&nbsp;</div></li><li><div>                                      $data = wp_get_attachment_url( $val['attachment_id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                      if ( isset ( $data ) && ! empty ( $data ) ) {&nbsp;</div></li><li><div>                                          $this-&gt;options[ $field['id'] ][ $key ]['image'] = $data;&nbsp;</div></li><li><div>                                          $data = wp_get_attachment_image_src( $val['attachment_id'], array(&nbsp;</div></li><li><div>                                              150, &nbsp;</div></li><li><div>                                              150&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>                                          $this-&gt;options[ $field['id'] ][ $key ]['thumb'] = $data[0];&nbsp;</div></li><li><div>                                          $doUpdate = true;&nbsp;</div></li><li><div>                                      }&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          <span class="comment">// END -&gt; CORRECT URLS if media URLs are wrong, but attachment IDs are present.</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( true == $doUpdate && ! isset ( $this-&gt;never_save_to_db ) ) {&nbsp;</div></li><li><div>                              if ( $this-&gt;args['save_defaults'] ) { <span class="comment">// Only save that to the DB if allowed to</span>&nbsp;</div></li><li><div>                                  $runUpdate = true;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              <span class="comment">// elseif($this-&gt;saved != '' && $this-&gt;saved != false) {</span>&nbsp;</div></li><li><div>                              <span class="comment">// $runUpdate = true;</span>&nbsp;</div></li><li><div>                              <span class="comment"><span class="comment"><span class="comment"><span class="comment">//}</span></span></span></span>&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( ! isset ( $field['class'] ) ) { <span class="comment">// No errors please</span>&nbsp;</div></li><li><div>                              $field['class'] = &quot;&quot;;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $id = $field['id'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                           * filter 'redux-field-{field.id}modifier-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">                           *</span>&nbsp;</div></li><li><div><span class="comment">                           * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                           *</span>&nbsp;</div></li><li><div><span class="comment">                           * @param array $field field config</span>&nbsp;</div></li><li><div><span class="comment">                           */</span>&nbsp;</div></li><li><div>                          $field = apply_filters( &quot;redux-field-{$field['id']}modifier-{$this-&gt;args['opt_name']}&quot;, $field ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span> LATER</span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                           * filter 'redux/options/{opt_name}/field/{field.id}'</span>&nbsp;</div></li><li><div><span class="comment">                           *</span>&nbsp;</div></li><li><div><span class="comment">                           * @param array $field field config</span>&nbsp;</div></li><li><div><span class="comment">                           */</span>&nbsp;</div></li><li><div>                          $field = apply_filters( &quot;redux/options/{$this-&gt;args['opt_name']}/field/{$field['id']}&quot;, $field );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( empty ( $field ) || ! $field || $field == false ) {&nbsp;</div></li><li><div>                              unset ( $this-&gt;sections[ $k ]['fields'][ $fieldk ] );&nbsp;</div></li><li><div>                              continue;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( ! empty ( $this-&gt;folds[ $field['id'] ]['parent'] ) ) { <span class="comment">// This has some fold items, hide it by default</span>&nbsp;</div></li><li><div>                              $field['class'] .= &quot; fold&quot;;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( ! empty ( $this-&gt;folds[ $field['id'] ]['children'] ) ) { <span class="comment">// Sets the values you shoe fold children on</span>&nbsp;</div></li><li><div>                              $field['class'] .= &quot; foldParent&quot;;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( ! empty ( $field['compiler'] ) ) {&nbsp;</div></li><li><div>                              $field['class'] .= &quot; compiler&quot;;&nbsp;</div></li><li><div>                              $this-&gt;compiler_fields[ $field['id'] ] = 1;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset ( $field['unit'] ) && ! isset ( $field['units'] ) ) {&nbsp;</div></li><li><div>                              $field['units'] = $field['unit'];&nbsp;</div></li><li><div>                              unset ( $field['unit'] );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $this-&gt;sections[ $k ]['fields'][ $fieldk ] = $field;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset ( $this-&gt;args['display_source'] ) ) {&nbsp;</div></li><li><div>                              $th .= '&lt;div id=&quot;' . $field['id'] . '-settings&quot; style=&quot;display:none;&quot;&gt;&lt;pre&gt;' . var_export( $this-&gt;sections[ $k ]['fields'][ $fieldk ], true ) . '&lt;/pre&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>                              $th .= '&lt;br /&gt;&lt;a href=&quot;#TB_inline?width=600&height=800&inlineId=' . $field['id'] . '-settings&quot; class=&quot;thickbox&quot;&gt;&lt;small&gt;View Source&lt;/small&gt;&lt;/a&gt;';&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                           * action 'redux/options/{opt_name}/field/field.type}/register'</span>&nbsp;</div></li><li><div><span class="comment">                           */</span>&nbsp;</div></li><li><div>                          do_action( &quot;redux/options/{$this-&gt;args['opt_name']}/field/{$field['type']}/register&quot;, $field );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $this-&gt;check_dependencies( $field );&nbsp;</div></li><li><div>                          $this-&gt;field_head[ $field['id'] ] = $th;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( ! $display || isset ( $this-&gt;no_panel_section[ $k ] ) ) {&nbsp;</div></li><li><div>                              $this-&gt;no_panel[] = $field['id'];&nbsp;</div></li><li><div>                          } else {&nbsp;</div></li><li><div>                              if ( isset ( $field['hidden'] ) && $field['hidden'] ) {&nbsp;</div></li><li><div>                                  $field['label_for'] = 'redux_hide_field';&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              if ( $this-&gt;args['options_api'] == true ) {&nbsp;</div></li><li><div>                                  add_settings_field(&nbsp;</div></li><li><div>                                      &quot;{$fieldk}_field&quot;, $th, array(&nbsp;</div></li><li><div>                                      &$this, &nbsp;</div></li><li><div>                                      '_field_input'&nbsp;</div></li><li><div> ), &quot;{$this-&gt;args['opt_name']}{$k}_section_group&quot;, &quot;{$this-&gt;args['opt_name']}{$k}_section&quot;, $field&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * action 'redux-register-settings-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              do_action( &quot;redux-register-settings-{$this-&gt;args['opt_name']}&quot; ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * action 'redux/options/{opt_name}/register'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param array option sections</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              do_action( &quot;redux/options/{$this-&gt;args['opt_name']}/register&quot;, $this-&gt;sections );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $runUpdate && ! isset ( $this-&gt;never_save_to_db ) ) { <span class="comment">// Always update the DB with new fields</span>&nbsp;</div></li><li><div>                  $this-&gt;set_options( $this-&gt;options );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset ( $this-&gt;transients['run_compiler'] ) && $this-&gt;transients['run_compiler'] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;no_output = true;&nbsp;</div></li><li><div>                  $this-&gt;_enqueue_output();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * action 'redux-compiler-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array  options</span>&nbsp;</div></li><li><div><span class="comment">                   * @param string CSS that get sent to the compiler hook</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  do_action( &quot;redux-compiler-{$this-&gt;args['opt_name']}&quot;, $this-&gt;options, $this-&gt;compilerCSS, $this-&gt;transients['changed_values'] ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * action 'redux/options/{opt_name}a'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array  options</span>&nbsp;</div></li><li><div><span class="comment">                   * @param string CSS that get sent to the compiler hook</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  do_action( &quot;redux/options/{$this-&gt;args['opt_name']}/compiler&quot;, $this-&gt;options, $this-&gt;compilerCSS, $this-&gt;transients['changed_values'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * action 'redux/options/{opt_name}/compiler/advanced'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array  options</span>&nbsp;</div></li><li><div><span class="comment">                   * @param string CSS that get sent to the compiler hook, which sends the full Redux object</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  do_action( &quot;redux/options/{$this-&gt;args['opt_name']}/compiler/advanced&quot;, $this );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  unset ( $this-&gt;transients['run_compiler'] );&nbsp;</div></li><li><div>                  $this-&gt;set_transients();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// _register_settings()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Register Extensions for use</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       3.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          private function _register_extensions() {&nbsp;</div></li><li><div>              $path = dirname( __FILE__ ) . '/inc/extensions/';&nbsp;</div></li><li><div>              $folders = scandir( $path, 1 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * action 'redux/extensions/before'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param object $this ReduxFramework</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              do_action( &quot;redux/extensions/before&quot;, $this );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * action 'redux/extensions/{opt_name}/before'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param object $this ReduxFramework</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              do_action( &quot;redux/extensions/{$this-&gt;args['opt_name']}/before&quot;, $this );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset( $this-&gt;old_opt_name ) ) {&nbsp;</div></li><li><div>                  do_action( &quot;redux/extensions/{$this-&gt;old_opt_name}/before&quot;, $this );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( $folders as $folder ) {&nbsp;</div></li><li><div>                  if ( $folder === '.' || $folder === '..' || ! is_dir( $path . $folder ) || substr( $folder, 0, 1 ) === '.' || substr( $folder, 0, 1 ) === '@' || substr( $folder, 0, 4 ) === '_vti' ) {&nbsp;</div></li><li><div>                      continue;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $extension_class = 'ReduxFramework_Extension_' . $folder;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * filter 'redux-extensionclass-load'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param        string                    extension class file path</span>&nbsp;</div></li><li><div><span class="comment">                   * @param string $extension_class          extension class name</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  $class_file = apply_filters( &quot;redux-extensionclass-load&quot;, &quot;$path/$folder/extension_{$folder}.php&quot;, $extension_class ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span> LATER</span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * filter 'redux/extension/{opt_name}/{folder}'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param        string                    extension class file path</span>&nbsp;</div></li><li><div><span class="comment">                   * @param string $extension_class          extension class name</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  $class_file = apply_filters( &quot;redux/extension/{$this-&gt;args['opt_name']}/$folder&quot;, &quot;$path/$folder/extension_{$folder}.php&quot;, $class_file );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $class_file ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( file_exists( $class_file ) ) {&nbsp;</div></li><li><div>                          require_once $class_file;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $this-&gt;extensions[ $folder ] = new $extension_class ( $this );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * action 'redux-register-extensions-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param object $this ReduxFramework</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              do_action( &quot;redux-register-extensions-{$this-&gt;args['opt_name']}&quot;, $this ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * action 'redux/extensions/{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param object $this ReduxFramework</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              do_action( &quot;redux/extensions/{$this-&gt;args['opt_name']}&quot;, $this );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset( $this-&gt;old_opt_name ) && ! empty( $this-&gt;old_opt_name ) ) {&nbsp;</div></li><li><div>                  do_action( &quot;redux/extensions/{$this-&gt;old_opt_name}&quot;, $this );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          private function get_transients() {&nbsp;</div></li><li><div>              if ( ! isset ( $this-&gt;transients ) ) {&nbsp;</div></li><li><div>                  $this-&gt;transients = get_option( $this-&gt;args['opt_name'] . '-transients', array() );&nbsp;</div></li><li><div>                  $this-&gt;transients_check = $this-&gt;transients;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          public function set_transients() {&nbsp;</div></li><li><div>              if ( ! isset ( $this-&gt;transients ) || ! isset ( $this-&gt;transients_check ) || $this-&gt;transients != $this-&gt;transients_check ) {&nbsp;</div></li><li><div>                  update_option( $this-&gt;args['opt_name'] . '-transients', $this-&gt;transients );&nbsp;</div></li><li><div>                  $this-&gt;transients_check = $this-&gt;transients;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Validate the Options options before insertion</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       3.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param       array $plugin_options The options array</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return array|mixed|string|void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function _validate_options( $plugin_options ) {&nbsp;</div></li><li><div>              <span class="comment">//print_r($plugin_options);</span>&nbsp;</div></li><li><div>              <span class="comment">//              exit();</span>&nbsp;</div></li><li><div>              if ( isset ( $this-&gt;validation_ran ) ) {&nbsp;</div></li><li><div>                  return $plugin_options;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $this-&gt;validation_ran = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Save the values not in the panel</span>&nbsp;</div></li><li><div>              if ( isset ( $plugin_options['redux-no_panel'] ) ) {&nbsp;</div></li><li><div>                  $keys = explode( '|', $plugin_options['redux-no_panel'] );&nbsp;</div></li><li><div>                  foreach ( $keys as $key ) {&nbsp;</div></li><li><div>                      $plugin_options[ $key ] = $this-&gt;options[ $key ];&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  if ( isset ( $plugin_options['redux-no_panel'] ) ) {&nbsp;</div></li><li><div>                      unset ( $plugin_options['redux-no_panel'] );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $this-&gt;hidden_perm_fields ) && is_array( $this-&gt;hidden_perm_fields ) ) {&nbsp;</div></li><li><div>                  foreach ( $this-&gt;hidden_perm_fields as $id =&gt; $data ) {&nbsp;</div></li><li><div>                      $plugin_options[ $id ] = $data;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $plugin_options == $this-&gt;options ) {&nbsp;</div></li><li><div>                  return $plugin_options;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $time = time();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Sets last saved time</span>&nbsp;</div></li><li><div>              $this-&gt;transients['last_save'] = $time;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Import</span>&nbsp;</div></li><li><div>              if ( ( isset( $plugin_options['import_code'] ) && ! empty( $plugin_options['import_code'] ) ) || ( isset( $plugin_options['import_link'] ) && ! empty( $plugin_options['import_link'] ) ) ) {&nbsp;</div></li><li><div>                  $this-&gt;transients['last_save_mode'] = &quot;import&quot;; <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Last save mode</span></span></span></span>&nbsp;</div></li><li><div>                  $this-&gt;transients['last_compiler'] = $time;&nbsp;</div></li><li><div>                  $this-&gt;transients['last_import'] = $time;&nbsp;</div></li><li><div>                  $this-&gt;transients['run_compiler'] = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $plugin_options['import_code'] != '' ) {&nbsp;</div></li><li><div>                      $import = $plugin_options['import_code'];&nbsp;</div></li><li><div>                  } elseif ( $plugin_options['import_link'] != '' ) {&nbsp;</div></li><li><div>                      $import = wp_remote_retrieve_body( wp_remote_get( $plugin_options['import_link'] ) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! empty ( $import ) ) {&nbsp;</div></li><li><div>                      $imported_options = json_decode( $import, true );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! empty ( $imported_options ) && is_array( $imported_options ) && isset ( $imported_options['redux-backup'] ) && $imported_options['redux-backup'] == '1' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $this-&gt;transients['changed_values'] = array();&nbsp;</div></li><li><div>                      foreach ( $plugin_options as $key =&gt; $value ) {&nbsp;</div></li><li><div>                          if ( isset ( $imported_options[ $key ] ) && $imported_options[ $key ] != $value ) {&nbsp;</div></li><li><div>                              $this-&gt;transients['changed_values'][ $key ] = $value;&nbsp;</div></li><li><div>                              $plugin_options[ $key ]                     = $value;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * action 'redux/options/{opt_name}/import'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param  &array [&$plugin_options, redux_options]</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      do_action_ref_array( &quot;redux/options/{$this-&gt;args['opt_name']}/import&quot;, array(&nbsp;</div></li><li><div>                          &$plugin_options, &nbsp;</div></li><li><div>                          $imported_options, &nbsp;</div></li><li><div>                          $this-&gt;transients['changed_values']&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      setcookie( 'redux_current_tab', '', 1, '/', $time + 1000, &quot;/&quot; );&nbsp;</div></li><li><div>                      $_COOKIE['redux_current_tab'] = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      unset ( $plugin_options['defaults'], $plugin_options['compiler'], $plugin_options['import'], $plugin_options['import_code'] );&nbsp;</div></li><li><div>                      if ( $this-&gt;args['database'] == 'transient' || $this-&gt;args['database'] == 'theme_mods' || $this-&gt;args['database'] == 'theme_mods_expanded' || $this-&gt;args['database'] == 'network' ) {&nbsp;</div></li><li><div>                          $this-&gt;set_options( $plugin_options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          return;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $plugin_options = wp_parse_args( $imported_options, $plugin_options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $this-&gt;set_transients(); <span class="comment"><span class="comment">// Update the transients</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      return $plugin_options;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Reset all to defaults</span>&nbsp;</div></li><li><div>              if ( ! empty ( $plugin_options['defaults'] ) ) {&nbsp;</div></li><li><div>                  if ( empty ( $this-&gt;options_defaults ) ) {&nbsp;</div></li><li><div>                      $this-&gt;options_defaults = $this-&gt;_default_values();&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * apply_filters 'redux/validate/{opt_name}/defaults'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param  &array [ $this-&gt;options_defaults, $plugin_options]</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  $plugin_options = apply_filters( &quot;redux/validate/{$this-&gt;args['opt_name']}/defaults&quot;, $this-&gt;options_defaults );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;transients['changed_values'] = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( empty ( $this-&gt;options ) ) {&nbsp;</div></li><li><div>                      $this-&gt;options = $this-&gt;options_defaults;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  foreach ( $this-&gt;options as $key =&gt; $value ) {&nbsp;</div></li><li><div>                      if ( isset ( $plugin_options[ $key ] ) && $value != $plugin_options[ $key ] ) {&nbsp;</div></li><li><div>                          $this-&gt;transients['changed_values'][ $key ] = $value;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;transients['run_compiler'] = 1;&nbsp;</div></li><li><div>                  $this-&gt;transients['last_save_mode'] = &quot;defaults&quot;; <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Last save mode</span></span></span></span>&nbsp;</div></li><li><div>                  <span class="comment">//setcookie('redux-compiler-' . $this-&gt;args['opt_name'], 1, time() + 1000, &quot;/&quot;);</span>&nbsp;</div></li><li><div>                  <span class="comment">//setcookie(&quot;redux-saved-{$this-&gt;args['opt_name']}&quot;, 'defaults', time() + 1000, &quot;/&quot;);</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;set_transients(); <span class="comment"><span class="comment">// Update the transients</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  return $plugin_options;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Section reset to defaults</span>&nbsp;</div></li><li><div>              if ( ! empty ( $plugin_options['defaults-section'] ) ) {&nbsp;</div></li><li><div>                  if ( isset ( $plugin_options['redux-section'] ) && isset ( $this-&gt;sections[ $plugin_options['redux-section'] ]['fields'] ) ) {&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * apply_filters 'redux/validate/{opt_name}/defaults_section'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param  &array [ $this-&gt;options_defaults, $plugin_options]</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      foreach ( $this-&gt;sections[ $plugin_options['redux-section'] ]['fields'] as $field ) {&nbsp;</div></li><li><div>                          if ( isset ( $this-&gt;options_defaults[ $field['id'] ] ) ) {&nbsp;</div></li><li><div>                              $plugin_options[ $field['id'] ] = $this-&gt;options_defaults[ $field['id'] ];&nbsp;</div></li><li><div>                          } else {&nbsp;</div></li><li><div>                              $plugin_options[ $field['id'] ] = &quot;&quot;;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset ( $field['compiler'] ) ) {&nbsp;</div></li><li><div>                              $compiler = true;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $plugin_options = apply_filters( &quot;redux/validate/{$this-&gt;args['opt_name']}/defaults_section&quot;, $plugin_options );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;transients['changed_values'] = array();&nbsp;</div></li><li><div>                  foreach ( $this-&gt;options as $key =&gt; $value ) {&nbsp;</div></li><li><div>                      if ( isset ( $plugin_options[ $key ] ) && $value != $plugin_options[ $key ] ) {&nbsp;</div></li><li><div>                          $this-&gt;transients['changed_values'][ $key ] = $value;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset ( $compiler ) ) {&nbsp;</div></li><li><div>                      <span class="comment">//$this-&gt;run_compiler = true;</span>&nbsp;</div></li><li><div>                      <span class="comment">//setcookie('redux-compiler-' . $this-&gt;args['opt_name'], 1, time()+1000, '/');</span>&nbsp;</div></li><li><div>                      <span class="comment">//$plugin_options['REDUX_COMPILER'] = time();</span>&nbsp;</div></li><li><div>                      $this-&gt;transients['last_compiler'] = $time;&nbsp;</div></li><li><div>                      $this-&gt;transients['run_compiler'] = 1;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;transients['last_save_mode'] = &quot;defaults_section&quot;; <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Last save mode</span></span></span></span>&nbsp;</div></li><li><div>                  <span class="comment">//setcookie(&quot;redux-saved-{$this-&gt;args['opt_name']}&quot;, 'defaults_section', time() + 1000, &quot;/&quot;);</span>&nbsp;</div></li><li><div>                  unset ( $plugin_options['defaults'], $plugin_options['defaults_section'], $plugin_options['import'], $plugin_options['import_code'], $plugin_options['import_link'], $plugin_options['compiler'], $plugin_options['redux-section'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;set_transients();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  return $plugin_options;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">//                if ($this-&gt;transients['last_save_mode'] != 'remove') {</span>&nbsp;</div></li><li><div>              $this-&gt;transients['last_save_mode'] = &quot;normal&quot;; <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Last save mode</span></span></span></span>&nbsp;</div></li><li><div>              <span class="comment">//               } else {</span>&nbsp;</div></li><li><div>              <span class="comment">//                    $this-&gt;transients['last_save_mode'] = '';</span>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment">//                }</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * apply_filters 'redux/validate/{opt_name}/before_validation'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param  &array [&$plugin_options, redux_options]</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $plugin_options = apply_filters( &quot;redux/validate/{$this-&gt;args['opt_name']}/before_validation&quot;, $plugin_options, $this-&gt;options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Validate fields (if needed)</span>&nbsp;</div></li><li><div>              $plugin_options = $this-&gt;_validate_values( $plugin_options, $this-&gt;options, $this-&gt;sections );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $this-&gt;errors ) || ! empty ( $this-&gt;warnings ) ) {&nbsp;</div></li><li><div>                  $this-&gt;transients['notices'] = array( 'errors' =&gt; $this-&gt;errors, 'warnings' =&gt; $this-&gt;warnings );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * action 'redux-validate-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param  &array [&$plugin_options, redux_options]</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              do_action_ref_array( &quot;redux-validate-{$this-&gt;args['opt_name']}&quot;, array(&nbsp;</div></li><li><div>                  &$plugin_options, &nbsp;</div></li><li><div>                  $this-&gt;options&nbsp;</div></li><li><div> ) ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! isset ( $this-&gt;transients['changed_values'] ) ) {&nbsp;</div></li><li><div>                  $this-&gt;transients['changed_values'] = array();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * action 'redux/options/{opt_name}/validate'</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param  &array [&$plugin_options, redux_options]</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              do_action_ref_array( &quot;redux/options/{$this-&gt;args['opt_name']}/validate&quot;, array(&nbsp;</div></li><li><div>                  &$plugin_options, &nbsp;</div></li><li><div>                  $this-&gt;options, &nbsp;</div></li><li><div>                  $this-&gt;transients['changed_values']&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $plugin_options['compiler'] ) ) {&nbsp;</div></li><li><div>                  unset ( $plugin_options['compiler'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;transients['last_compiler'] = $time;&nbsp;</div></li><li><div>                  $this-&gt;transients['run_compiler'] = 1;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;transients['changed_values'] = array(); <span class="comment">// Changed values since last save</span>&nbsp;</div></li><li><div>              foreach ( $this-&gt;options as $key =&gt; $value ) {&nbsp;</div></li><li><div>                  if ( isset ( $plugin_options[ $key ] ) && $value != $plugin_options[ $key ] ) {&nbsp;</div></li><li><div>                      $this-&gt;transients['changed_values'][ $key ] = $value;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              unset ( $plugin_options['defaults'], $plugin_options['defaults_section'], $plugin_options['import'], $plugin_options['import_code'], $plugin_options['import_link'], $plugin_options['compiler'], $plugin_options['redux-section'] );&nbsp;</div></li><li><div>              if ( $this-&gt;args['database'] == 'transient' || $this-&gt;args['database'] == 'theme_mods' || $this-&gt;args['database'] == 'theme_mods_expanded' ) {&nbsp;</div></li><li><div>                  $this-&gt;set_options( $plugin_options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  return;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( defined( 'WP_CACHE' ) && WP_CACHE && class_exists( 'W3_ObjectCache' ) && function_exists( 'w3_instance' ) ) {&nbsp;</div></li><li><div>                  <span class="comment">//echo &quot;here&quot;;</span>&nbsp;</div></li><li><div>                  $w3_inst = w3_instance( 'W3_ObjectCache' );&nbsp;</div></li><li><div>                  $w3 = $w3_inst-&gt;instance();&nbsp;</div></li><li><div>                  $key = $w3-&gt;_get_cache_key( $this-&gt;args['opt_name'] . '-transients', 'transient' );&nbsp;</div></li><li><div>                  <span class="comment">//echo $key;</span>&nbsp;</div></li><li><div>                  $w3-&gt;delete( $key, 'transient', true );&nbsp;</div></li><li><div>                  <span class="comment">//set_transient($this-&gt;args['opt_name'].'-transients', $this-&gt;transients);</span>&nbsp;</div></li><li><div>                  <span class="comment">//exit();</span>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;set_transients( $this-&gt;transients );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $plugin_options;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          public function ajax_save() {&nbsp;</div></li><li><div>              if ( ! wp_verify_nonce( $_REQUEST['nonce'], &quot;redux_ajax_nonce&quot; . $this-&gt;args['opt_name'] ) ) {&nbsp;</div></li><li><div>                  echo json_encode( array(&nbsp;</div></li><li><div>                      'status' =&gt; __( 'Invalid security credential.  Please reload the page and try again.', 'evolve' ), &nbsp;</div></li><li><div>                      'action' =&gt; ''&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  die();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! current_user_can( $this-&gt;args['page_permissions'] ) ) {&nbsp;</div></li><li><div>                  echo json_encode( array(&nbsp;</div></li><li><div>                      'status' =&gt; __( 'Invalid user capability.  Please reload the page and try again.', 'evolve' ), &nbsp;</div></li><li><div>                      'action' =&gt; ''&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  die();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $redux = ReduxFrameworkInstances::get_instance( $_POST['opt_name'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $_POST['data'] ) && ! empty ( $redux-&gt;args['opt_name'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $values = array();&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//if</span></span></span></span></span></span></span></span> (function_exists('get_magic_quotes_gpc') && get_magic_quotes_gpc()) {&nbsp;</div></li><li><div>                  <span class="comment">//    $process = array(&$_GET, &$_POST, &$_COOKIE, &$_REQUEST);</span>&nbsp;</div></li><li><div>                  <span class="comment">//    while (list($key, $val) = each($process)) {</span>&nbsp;</div></li><li><div>                  <span class="comment">//        foreach ($val as $k =&gt; $v) {</span>&nbsp;</div></li><li><div>                  <span class="comment">//            unset($process[$key][$k]);</span>&nbsp;</div></li><li><div>                  <span class="comment">//            if (is_array($v)) {</span>&nbsp;</div></li><li><div>                  <span class="comment">//                $process[$key][stripslashes($k)] = $v;</span>&nbsp;</div></li><li><div>                  <span class="comment">//                $process[] = &$process[$key][stripslashes($k)];</span>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">//            }</span> else {</span>&nbsp;</div></li><li><div>                  <span class="comment">//                $process[$key][stripslashes($k)] = stripslashes($v);</span>&nbsp;</div></li><li><div>                  <span class="comment">//            }</span>&nbsp;</div></li><li><div>                  <span class="comment">//        }</span>&nbsp;</div></li><li><div>                  <span class="comment">//    }</span>&nbsp;</div></li><li><div>                  <span class="comment">//    unset($process);</span>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment"><span class="comment"><span class="comment">//}</span></span></span></span>&nbsp;</div></li><li><div>                  $_POST['data'] = stripslashes( $_POST['data'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Old method of saving, in case we need to go back! - kp</span>&nbsp;</div></li><li><div>                  <span class="comment">//parse_str( $_POST['data'], $values );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// New method to avoid input_var nonesense.  Thanks @harunbasic</span>&nbsp;</div></li><li><div>                  $values = $this-&gt;redux_parse_str( $_POST['data'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $values = $values[ $redux-&gt;args['opt_name'] ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( function_exists( 'get_magic_quotes_gpc' ) && get_magic_quotes_gpc() ) {&nbsp;</div></li><li><div>                      $values = array_map( 'stripslashes_deep', $values );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! empty ( $values ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      try {&nbsp;</div></li><li><div>                          if ( isset ( $redux-&gt;validation_ran ) ) {&nbsp;</div></li><li><div>                              unset ( $redux-&gt;validation_ran );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $redux-&gt;set_options( $redux-&gt;_validate_options( $values ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $do_reload = false;&nbsp;</div></li><li><div>                          if ( isset( $this-&gt;reload_fields ) && ! empty( $this-&gt;reload_fields ) ) {&nbsp;</div></li><li><div>                              if ( ! empty( $this-&gt;transients['changed_values'] ) ) {&nbsp;</div></li><li><div>                                  foreach ( $this-&gt;reload_fields as $idx =&gt; $val ) {&nbsp;</div></li><li><div>                                      if ( array_key_exists( $val, $this-&gt;transients['changed_values'] ) ) {&nbsp;</div></li><li><div>                                          $do_reload = true;&nbsp;</div></li><li><div>                                      }&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( $do_reload || ( isset ( $values['defaults'] ) && ! empty ( $values['defaults'] ) ) || ( isset ( $values['defaults-section'] ) && ! empty ( $values['defaults-section'] ) ) ) {&nbsp;</div></li><li><div>                              echo json_encode( array( 'status' =&gt; 'success', 'action' =&gt; 'reload' ) );&nbsp;</div></li><li><div>                              die ();&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          require_once 'core/enqueue.php';&nbsp;</div></li><li><div>                          $enqueue = new reduxCoreEnqueue ( $redux );&nbsp;</div></li><li><div>                          $enqueue-&gt;get_warnings_and_errors_array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $return_array = array(&nbsp;</div></li><li><div>                              'status' =&gt; 'success', &nbsp;</div></li><li><div>                              'options' =&gt; $redux-&gt;options, &nbsp;</div></li><li><div>                              'errors' =&gt; isset ( $redux-&gt;localize_data['errors'] ) ? $redux-&gt;localize_data['errors'] : null, &nbsp;</div></li><li><div>                              'warnings' =&gt; isset ( $redux-&gt;localize_data['warnings'] ) ? $redux-&gt;localize_data['warnings'] : null, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      } catch ( Exception $e ) {&nbsp;</div></li><li><div>                          $return_array = array( 'status' =&gt; $e-&gt;getMessage() );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      echo json_encode( array( 'status' =&gt; __( 'Your panel has no fields. Nothing to save.', 'evolve' ) ) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( isset ( $this-&gt;transients['run_compiler'] ) && $this-&gt;transients['run_compiler'] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;no_output = true;&nbsp;</div></li><li><div>                  $this-&gt;_enqueue_output();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  try {&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * action 'redux-compiler-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array  options</span>&nbsp;</div></li><li><div><span class="comment">                       * @param string CSS that get sent to the compiler hook</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      do_action( &quot;redux-compiler-{$this-&gt;args['opt_name']}&quot;, $this-&gt;options, $this-&gt;compilerCSS, $this-&gt;transients['changed_values'] ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * action 'redux/options/{opt_name}/compiler'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array  options</span>&nbsp;</div></li><li><div><span class="comment">                       * @param string CSS that get sent to the compiler hook</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      do_action( &quot;redux/options/{$this-&gt;args['opt_name']}/compiler&quot;, $this-&gt;options, $this-&gt;compilerCSS, $this-&gt;transients['changed_values'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * action 'redux/options/{opt_name}/compiler/advanced'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array  options</span>&nbsp;</div></li><li><div><span class="comment">                       * @param string CSS that get sent to the compiler hook, which sends the full Redux object</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      do_action( &quot;redux/options/{$this-&gt;args['opt_name']}/compiler/advanced&quot;, $this );&nbsp;</div></li><li><div>                  } catch ( Exception $e ) {&nbsp;</div></li><li><div>                      $return_array = array( 'status' =&gt; $e-&gt;getMessage() );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  unset ( $this-&gt;transients['run_compiler'] );&nbsp;</div></li><li><div>                  $this-&gt;set_transients();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( isset( $return_array ) ) {&nbsp;</div></li><li><div>                  if ( $return_array['status'] == &quot;success&quot; ) {&nbsp;</div></li><li><div>                      require_once 'core/panel.php';&nbsp;</div></li><li><div>                      $panel = new reduxCorePanel ( $redux );&nbsp;</div></li><li><div>                      ob_start();&nbsp;</div></li><li><div>                      $panel-&gt;notification_bar();&nbsp;</div></li><li><div>                      $notification_bar = ob_get_contents();&nbsp;</div></li><li><div>                      ob_end_clean();&nbsp;</div></li><li><div>                      $return_array['notification_bar'] = $notification_bar;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  echo json_encode( apply_filters( &quot;redux/options/{$this-&gt;args['opt_name']}/ajax_save/response&quot;, $return_array ) );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              die ();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Validate values from options form (used in settings api validate function)</span>&nbsp;</div></li><li><div><span class="comment">           * calls the custom validation class for the field so authors can override with custom classes</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param       array $plugin_options</span>&nbsp;</div></li><li><div><span class="comment">           * @param       array $options</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return      array $plugin_options</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function _validate_values( $plugin_options, $options, $sections ) {&nbsp;</div></li><li><div>              foreach ( $sections as $k =&gt; $section ) {&nbsp;</div></li><li><div>                  if ( isset ( $section['fields'] ) ) {&nbsp;</div></li><li><div>                      foreach ( $section['fields'] as $fkey =&gt; $field ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( is_array( $field ) ) {&nbsp;</div></li><li><div>                              $field['section_id'] = $k;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset ( $field['type'] ) && ( $field['type'] == 'checkbox' || $field['type'] == 'checkbox_hide_below' || $field['type'] == 'checkbox_hide_all' ) ) {&nbsp;</div></li><li><div>                              if ( ! isset ( $plugin_options[ $field['id'] ] ) ) {&nbsp;</div></li><li><div>                                  $plugin_options[ $field['id'] ] = 0;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//                            if ( isset ( $field['type'] ) && $field['type'] == 'typography' ) {</span>&nbsp;</div></li><li><div><span class="comment">//                                if ( ! is_array( $plugin_options[ $field['id'] ] ) && ! empty( $plugin_options[ $field['id'] ] ) ) {</span>&nbsp;</div></li><li><div><span class="comment">//                                    $plugin_options[ $field['id'] ] = json_decode( $plugin_options[ $field['id'] ], true );</span>&nbsp;</div></li><li><div><span class="comment"><span class="comment">//                                }</span></span>&nbsp;</div></li><li><div><span class="comment"><span class="comment"><span class="comment">//                            }</span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset( $this-&gt;extensions[ $field['type'] ] ) && method_exists( $this-&gt;extensions[ $field['type'] ], '_validate_values' ) ) {&nbsp;</div></li><li><div>                              $plugin_options = $this-&gt;extensions[ $field['type'] ]-&gt;_validate_values( $plugin_options, $field, $sections );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// Default 'not_empty 'flag to false.</span>&nbsp;</div></li><li><div>                          $isNotEmpty = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// Make sure 'validate' field is set.</span>&nbsp;</div></li><li><div>                          if ( isset ( $field['validate'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              <span class="comment">// Make sure 'validate field' is set to 'not_empty' or 'email_not_empty'</span>&nbsp;</div></li><li><div>                              <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//if</span></span></span></span></span></span></span></span> ( $field['validate'] == 'not_empty' || $field['validate'] == 'email_not_empty' || $field['validate'] == 'numeric_not_empty' ) {&nbsp;</div></li><li><div>                              if ( strtolower( substr( $field['validate'], - 9 ) ) == 'not_empty' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  <span class="comment">// Set the flag.</span>&nbsp;</div></li><li><div>                                  $isNotEmpty = true;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// Check for empty id value</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( ! isset ( $field['id'] ) || ! isset ( $plugin_options[ $field['id'] ] ) || ( isset ( $plugin_options[ $field['id'] ] ) && $plugin_options[ $field['id'] ] == '' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              <span class="comment"><span class="comment"><span class="comment">// If</span></span></span> we are looking for an empty value, in the case of 'not_empty'&nbsp;</div></li><li><div>                              <span class="comment">// then we need to keep processing.</span>&nbsp;</div></li><li><div>                              if ( ! $isNotEmpty ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  <span class="comment">// Empty id and not checking for 'not_empty.  Bail out...</span>&nbsp;</div></li><li><div>                                  if (!isset($field['validate_callback'])) {&nbsp;</div></li><li><div>                                      continue;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                                  <span class="comment">//continue;</span>&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// Force validate of custom field types</span>&nbsp;</div></li><li><div>                          if ( isset ( $field['type'] ) && ! isset ( $field['validate'] ) && ! isset( $field['validate_callback'] ) ) {&nbsp;</div></li><li><div>                              if ( $field['type'] == 'color' || $field['type'] == 'color_gradient' ) {&nbsp;</div></li><li><div>                                  $field['validate'] = 'color';&nbsp;</div></li><li><div>                              } elseif ( $field['type'] == 'date' ) {&nbsp;</div></li><li><div>                                  $field['validate'] = 'date';&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset ( $field['validate'] ) ) {&nbsp;</div></li><li><div>                              $validate = 'Redux_Validation_' . $field['validate'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( ! class_exists( $validate ) ) {&nbsp;</div></li><li><div>                                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                                   * filter 'redux-validateclass-load'</span>&nbsp;</div></li><li><div><span class="comment">                                   *</span>&nbsp;</div></li><li><div><span class="comment">                                   * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                                   *</span>&nbsp;</div></li><li><div><span class="comment">                                   * @param        string             validation class file path</span>&nbsp;</div></li><li><div><span class="comment">                                   * @param string $validate          validation class name</span>&nbsp;</div></li><li><div><span class="comment">                                   */</span>&nbsp;</div></li><li><div>                                  $class_file = apply_filters( &quot;redux-validateclass-load&quot;, self::$_dir . &quot;inc/validation/{$field['validate']}/validation_{$field['validate']}.php&quot;, $validate ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span> LATER</span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                                   * filter 'redux/validate/{opt_name}/class/{field.validate}'</span>&nbsp;</div></li><li><div><span class="comment">                                   *</span>&nbsp;</div></li><li><div><span class="comment">                                   * @param        string                validation class file path</span>&nbsp;</div></li><li><div><span class="comment">                                   * @param string $class_file           validation class file path</span>&nbsp;</div></li><li><div><span class="comment">                                   */</span>&nbsp;</div></li><li><div>                                  $class_file = apply_filters( &quot;redux/validate/{$this-&gt;args['opt_name']}/class/{$field['validate']}&quot;, self::$_dir . &quot;inc/validation/{$field['validate']}/validation_{$field['validate']}.php&quot;, $class_file );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  if ( $class_file ) {&nbsp;</div></li><li><div>                                      if ( file_exists( $class_file ) ) {&nbsp;</div></li><li><div>                                          require_once $class_file;&nbsp;</div></li><li><div>                                      }&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( class_exists( $validate ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  <span class="comment">//!DOVY - DB saving stuff. Is this right?</span>&nbsp;</div></li><li><div>                                  if ( empty ( $options[ $field['id'] ] ) ) {&nbsp;</div></li><li><div>                                      $options[ $field['id'] ] = '';&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  if ( isset ( $plugin_options[ $field['id'] ] ) && is_array( $plugin_options[ $field['id'] ] ) && ! empty ( $plugin_options[ $field['id'] ] ) ) {&nbsp;</div></li><li><div>                                      foreach ( $plugin_options[ $field['id'] ] as $key =&gt; $value ) {&nbsp;</div></li><li><div>                                          $before = $after = null;&nbsp;</div></li><li><div>                                          if ( isset ( $plugin_options[ $field['id'] ][ $key ] ) && ( ! empty ( $plugin_options[ $field['id'] ][ $key ] ) || $plugin_options[ $field['id'] ][ $key ] == '0' ) ) {&nbsp;</div></li><li><div>                                              if ( is_array( $plugin_options[ $field['id'] ][ $key ] ) ) {&nbsp;</div></li><li><div>                                                  $before = $plugin_options[ $field['id'] ][ $key ];&nbsp;</div></li><li><div>                                              } else {&nbsp;</div></li><li><div>                                                  $before = trim( $plugin_options[ $field['id'] ][ $key ] );&nbsp;</div></li><li><div>                                              }&nbsp;</div></li><li><div>                                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                          if ( isset ( $options[ $field['id'] ][ $key ] ) && ( ! empty ( $plugin_options[ $field['id'] ][ $key ] ) || $plugin_options[ $field['id'] ][ $key ] == '0' ) ) {&nbsp;</div></li><li><div>                                              $after = $options[ $field['id'] ][ $key ];&nbsp;</div></li><li><div>                                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                          $validation = new $validate ( $this, $field, $before, $after );&nbsp;</div></li><li><div>                                          if ( ! empty ( $validation-&gt;value ) || $validation-&gt;value == '0' ) {&nbsp;</div></li><li><div>                                              $plugin_options[ $field['id'] ][ $key ] = $validation-&gt;value;&nbsp;</div></li><li><div>                                          } else {&nbsp;</div></li><li><div>                                              unset ( $plugin_options[ $field['id'] ][ $key ] );&nbsp;</div></li><li><div>                                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                          if ( isset ( $validation-&gt;error ) ) {&nbsp;</div></li><li><div>                                              $this-&gt;errors[] = $validation-&gt;error;&nbsp;</div></li><li><div>                                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                          if ( isset ( $validation-&gt;warning ) ) {&nbsp;</div></li><li><div>                                              $this-&gt;warnings[] = $validation-&gt;warning;&nbsp;</div></li><li><div>                                          }&nbsp;</div></li><li><div>                                      }&nbsp;</div></li><li><div>                                  } else {&nbsp;</div></li><li><div>                                      if ( isset( $plugin_options[ $field['id'] ] ) ) {&nbsp;</div></li><li><div>                                          if ( is_array( $plugin_options[ $field['id'] ] ) ) {&nbsp;</div></li><li><div>                                              $pofi = $plugin_options[ $field['id'] ];&nbsp;</div></li><li><div>                                          } else {&nbsp;</div></li><li><div>                                              $pofi = trim( $plugin_options[ $field['id'] ] );&nbsp;</div></li><li><div>                                          }&nbsp;</div></li><li><div>                                      } else {&nbsp;</div></li><li><div>                                          $pofi = null;&nbsp;</div></li><li><div>                                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                      $validation = new $validate ( $this, $field, $pofi, $options[ $field['id'] ] );&nbsp;</div></li><li><div>                                      $plugin_options[ $field['id'] ] = $validation-&gt;value;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                      if ( isset ( $validation-&gt;error ) ) {&nbsp;</div></li><li><div>                                          $this-&gt;errors[] = $validation-&gt;error;&nbsp;</div></li><li><div>                                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                      if ( isset ( $validation-&gt;warning ) ) {&nbsp;</div></li><li><div>                                          $this-&gt;warnings[] = $validation-&gt;warning;&nbsp;</div></li><li><div>                                      }&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  continue;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          if ( isset ( $field['validate_callback'] ) && ( is_callable( $field['validate_callback'] ) || ( is_string( $field['validate_callback'] ) && function_exists( $field['validate_callback'] ) ) ) ) {&nbsp;</div></li><li><div>                              $callback = $field['validate_callback'];&nbsp;</div></li><li><div>                              unset ( $field['validate_callback'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              $plugin_option = isset( $plugin_options[ $field['id'] ] ) ? $plugin_options[ $field['id'] ] : null;&nbsp;</div></li><li><div>                              $option = isset( $options[ $field['id'] ] )        ? $options[ $field['id'] ]        : null;&nbsp;</div></li><li><div>                              $callbackvalues = call_user_func( $callback, $field, $plugin_option, $option );&nbsp;</div></li><li><div>                              $plugin_options[ $field['id'] ] = $callbackvalues['value'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( isset ( $callbackvalues['error'] ) ) {&nbsp;</div></li><li><div>                                  $this-&gt;errors[] = $callbackvalues['error'];&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              <span class="comment">// TODO - This warning message is failing. Hmm.</span>&nbsp;</div></li><li><div>                              <span class="comment">// No it isn't.  Problem was in the sample-config - kp</span>&nbsp;</div></li><li><div>                              if ( isset ( $callbackvalues['warning'] ) ) {&nbsp;</div></li><li><div>                                  $this-&gt;warnings[] = $callbackvalues['warning'];&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $plugin_options;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Return Section Menu HTML</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       3.1.5</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function section_menu( $k, $section, $suffix = &quot;&quot;, $sections = array() ) {&nbsp;</div></li><li><div>              $display = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $section['class'] = isset ( $section['class'] ) ? ' ' . $section['class'] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset ( $_GET['page'] ) && $_GET['page'] == $this-&gt;args['page_slug'] ) {&nbsp;</div></li><li><div>                  if ( isset ( $section['panel'] ) && $section['panel'] == false ) {&nbsp;</div></li><li><div>                      $display = false;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! $display ) {&nbsp;</div></li><li><div>                  return &quot;&quot;;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( empty ( $sections ) ) {&nbsp;</div></li><li><div>                  $sections = $this-&gt;sections;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $string = &quot;&quot;;&nbsp;</div></li><li><div>              if ( ( ( isset ( $this-&gt;args['icon_type'] ) && $this-&gt;args['icon_type'] == 'image' ) || ( isset ( $section['icon_type'] ) && $section['icon_type'] == 'image' ) ) || ( isset( $section['icon'] ) && strpos( $section['icon'], '/' ) !== false ) ) {&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//if</span></span></span></span></span></span></span></span>( !empty( $this-&gt;args['icon_type'] ) && $this-&gt;args['icon_type'] == 'image' ) {&nbsp;</div></li><li><div>                  $icon = ( ! isset ( $section['icon'] ) ) ? '' : '&lt;img class=&quot;image_icon_type&quot; src=&quot;' . esc_url( $section['icon'] ) . '&quot; /&gt; ';&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  if ( ! empty ( $section['icon_class'] ) ) {&nbsp;</div></li><li><div>                      $icon_class = ' ' . $section['icon_class'];&nbsp;</div></li><li><div>                  } elseif ( ! empty ( $this-&gt;args['default_icon_class'] ) ) {&nbsp;</div></li><li><div>                      $icon_class = ' ' . $this-&gt;args['default_icon_class'];&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $icon_class = '';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  $icon = ( ! isset ( $section['icon'] ) ) ? '&lt;i class=&quot;el el-cog' . esc_attr( $icon_class ) . '&quot;&gt;&lt;/i&gt; ' : '&lt;i class=&quot;' . esc_attr( $section['icon'] ) . esc_attr( $icon_class ) . '&quot;&gt;&lt;/i&gt; ';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( strpos( $icon, 'el-icon-' ) !== false ) {&nbsp;</div></li><li><div>                  $icon = str_replace( 'el-icon-', 'el el-', $icon );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $hide_section = '';&nbsp;</div></li><li><div>              if ( isset ( $section['hidden'] ) ) {&nbsp;</div></li><li><div>                  $hide_section = ( $section['hidden'] == true ) ? ' hidden ' : '';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $canBeSubSection = ( $k &gt; 0 && ( ! isset ( $sections[ ( $k ) ]['type'] ) || $sections[ ( $k ) ]['type'] != &quot;divide&quot; ) ) ? true : false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! $canBeSubSection && isset ( $section['subsection'] ) && $section['subsection'] == true ) {&nbsp;</div></li><li><div>                  unset ( $section['subsection'] );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset ( $section['type'] ) && $section['type'] == &quot;divide&quot; ) {&nbsp;</div></li><li><div>                  $string .= '&lt;li class=&quot;divide' . esc_attr( $section['class'] ) . '&quot;&gt;&nbsp;&lt;/li&gt;';&nbsp;</div></li><li><div>              } else if ( ! isset ( $section['subsection'] ) || $section['subsection'] != true ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// DOVY! REPLACE $k with $section['ID'] when used properly.</span>&nbsp;</div></li><li><div>                  <span class="comment">//$active = ( ( is_numeric($this-&gt;current_tab) && $this-&gt;current_tab == $k ) || ( !is_numeric($this-&gt;current_tab) && $this-&gt;current_tab === $k ) ) ? ' active' : '';</span>&nbsp;</div></li><li><div>                  $subsections = ( isset ( $sections[ ( $k + 1 ) ] ) && isset ( $sections[ ( $k + 1 ) ]['subsection'] ) && $sections[ ( $k + 1 ) ]['subsection'] == true ) ? true : false;&nbsp;</div></li><li><div>                  $subsectionsClass = $subsections ? ' hasSubSections' : '';&nbsp;</div></li><li><div>                  $subsectionsClass .= ( ! isset ( $section['fields'] ) || empty ( $section['fields'] ) ) ? ' empty_section' : '';&nbsp;</div></li><li><div>                  $extra_icon = $subsections ? '&lt;span class=&quot;extraIconSubsections&quot;&gt;&lt;i class=&quot;el el-chevron-down&quot;&gt;&nbsp;&lt;/i&gt;&lt;/span&gt;' : '';&nbsp;</div></li><li><div>                  $string .= '&lt;li id=&quot;' . esc_attr( $k . $suffix ) . '_section_group_li&quot; class=&quot;redux-group-tab-link-li' . esc_attr( $hide_section ) . esc_attr( $section['class'] ) . esc_attr( $subsectionsClass ) . '&quot;&gt;';&nbsp;</div></li><li><div>                  $string .= '&lt;a href=&quot;javascript:void(0);&quot; id=&quot;' . esc_attr( $k . $suffix ) . '_section_group_li_a&quot; class=&quot;redux-group-tab-link-a&quot; data-key=&quot;' . esc_attr( $k ) . '&quot; data-rel=&quot;' . esc_attr( $k . $suffix ) . '&quot;&gt;' . $extra_icon . $icon . '&lt;span class=&quot;group_title&quot;&gt;' . wp_kses_post( $section['title'] ) . '&lt;/span&gt;&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $nextK = $k;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Make sure you can make this a subsection</span>&nbsp;</div></li><li><div>                  if ( $subsections ) {&nbsp;</div></li><li><div>                      $string .= '&lt;ul id=&quot;' . esc_attr( $nextK . $suffix ) . '_section_group_li_subsections&quot; class=&quot;subsection&quot;&gt;';&nbsp;</div></li><li><div>                      $doLoop = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      while ( $doLoop ) {&nbsp;</div></li><li><div>                          $nextK += 1;&nbsp;</div></li><li><div>                          $display = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset ( $_GET['page'] ) && $_GET['page'] == $this-&gt;args['page_slug'] ) {&nbsp;</div></li><li><div>                              if ( isset ( $sections[ $nextK ]['panel'] ) && $sections[ $nextK ]['panel'] == false ) {&nbsp;</div></li><li><div>                                  $display = false;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( count( $sections ) &lt; $nextK || ! isset ( $sections[ $nextK ] ) || ! isset ( $sections[ $nextK ]['subsection'] ) || $sections[ $nextK ]['subsection'] != true ) {&nbsp;</div></li><li><div>                              $doLoop = false;&nbsp;</div></li><li><div>                          } else {&nbsp;</div></li><li><div>                              if ( ! $display ) {&nbsp;</div></li><li><div>                                  continue;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              $hide_sub = '';&nbsp;</div></li><li><div>                              if ( isset ( $sections[ $nextK ]['hidden'] ) ) {&nbsp;</div></li><li><div>                                  $hide_sub = ( $sections[ $nextK ]['hidden'] == true ) ? ' hidden ' : '';&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( ( isset ( $this-&gt;args['icon_type'] ) && $this-&gt;args['icon_type'] == 'image' ) || ( isset ( $sections[ $nextK ]['icon_type'] ) && $sections[ $nextK ]['icon_type'] == 'image' ) ) {&nbsp;</div></li><li><div>                                  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//if</span></span></span></span></span></span></span></span>( !empty( $this-&gt;args['icon_type'] ) && $this-&gt;args['icon_type'] == 'image' ) {&nbsp;</div></li><li><div>                                  $icon = ( ! isset ( $sections[ $nextK ]['icon'] ) ) ? '' : '&lt;img class=&quot;image_icon_type&quot; src=&quot;' . esc_url( $sections[ $nextK ]['icon'] ) . '&quot; /&gt; ';&nbsp;</div></li><li><div>                              } else {&nbsp;</div></li><li><div>                                  if ( ! empty ( $sections[ $nextK ]['icon_class'] ) ) {&nbsp;</div></li><li><div>                                      $icon_class = ' ' . $sections[ $nextK ]['icon_class'];&nbsp;</div></li><li><div>                                  } elseif ( ! empty ( $this-&gt;args['default_icon_class'] ) ) {&nbsp;</div></li><li><div>                                      $icon_class = ' ' . $this-&gt;args['default_icon_class'];&nbsp;</div></li><li><div>                                  } else {&nbsp;</div></li><li><div>                                      $icon_class = '';&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                                  $icon = ( ! isset ( $sections[ $nextK ]['icon'] ) ) ? '' : '&lt;i class=&quot;' . esc_attr( $sections[ $nextK ]['icon'] ) . esc_attr( $icon_class ) . '&quot;&gt;&lt;/i&gt; ';&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              if ( strpos( $icon, 'el-icon-' ) !== false ) {&nbsp;</div></li><li><div>                                  $icon = str_replace( 'el-icon-', 'el el-', $icon );&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              $sections[ $nextK ]['class'] = isset($sections[ $nextK ]['class']) ? $sections[ $nextK ]['class'] : '';&nbsp;</div></li><li><div>                              $section[ $nextK ]['class'] = isset ( $section[ $nextK ]['class'] ) ? $section[ $nextK ]['class'] : $sections[ $nextK ]['class'];&nbsp;</div></li><li><div>                              $string .= '&lt;li id=&quot;' . esc_attr( $nextK . $suffix ) . '_section_group_li&quot; class=&quot;redux-group-tab-link-li ' . esc_attr( $hide_sub ) . esc_attr( $section[ $nextK ]['class'] ) . ( $icon ? ' hasIcon' : '' ) . '&quot;&gt;';&nbsp;</div></li><li><div>                              $string .= '&lt;a href=&quot;javascript:void(0);&quot; id=&quot;' . esc_attr( $nextK . $suffix ) . '_section_group_li_a&quot; class=&quot;redux-group-tab-link-a&quot; data-key=&quot;' . esc_attr( $nextK ) . '&quot; data-rel=&quot;' . esc_attr( $nextK . $suffix ) . '&quot;&gt;' . $icon . '&lt;span class=&quot;group_title&quot;&gt;' . wp_kses_post( $sections[ $nextK ]['title'] ) . '&lt;/span&gt;&lt;/a&gt;';&nbsp;</div></li><li><div>                              $string .= '&lt;/li&gt;';&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $string .= '&lt;/ul&gt;';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $string .= '&lt;/li&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $string;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// section_menu()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * HTML OUTPUT.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function generate_panel() {&nbsp;</div></li><li><div>              require_once 'core/panel.php';&nbsp;</div></li><li><div>              $panel = new reduxCorePanel ( $this );&nbsp;</div></li><li><div>              $panel-&gt;init();&nbsp;</div></li><li><div>              $this-&gt;set_transients();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Section HTML OUTPUT.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @access      public</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param       array $section</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function _section_desc( $section ) {&nbsp;</div></li><li><div>              $id = rtrim( $section['id'], '_section' );&nbsp;</div></li><li><div>              $id = str_replace($this-&gt;args['opt_name'], '', $id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset ( $this-&gt;sections[ $id ]['desc'] ) && ! empty ( $this-&gt;sections[ $id ]['desc'] ) ) {&nbsp;</div></li><li><div>                  echo '&lt;div class=&quot;redux-section-desc&quot;&gt;' . $this-&gt;sections[ $id ]['desc'] . '&lt;/div&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Field HTML OUTPUT.</span>&nbsp;</div></li><li><div><span class="comment">           * Gets option from options array, then calls the specific field type class - allows extending by other devs</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since       1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param array  $field</span>&nbsp;</div></li><li><div><span class="comment">           * @param string $v</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return      void</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function _field_input( $field, $v = null ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset ( $field['callback'] ) && ( is_callable( $field['callback'] ) || ( is_string( $field['callback'] ) && function_exists( $field['callback'] ) ) ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $value = ( isset ( $this-&gt;options[ $field['id'] ] ) ) ? $this-&gt;options[ $field['id'] ] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * action 'redux-before-field-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array  $field field data</span>&nbsp;</div></li><li><div><span class="comment">                   * @param string $value field.id</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  do_action( &quot;redux-before-field-{$this-&gt;args['opt_name']}&quot;, $field, $value ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * action 'redux/field/{opt_name}/{field.type}/callback/before'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array  $field field data</span>&nbsp;</div></li><li><div><span class="comment">                   * @param string $value field.id</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  do_action_ref_array( &quot;redux/field/{$this-&gt;args['opt_name']}/{$field['type']}/callback/before&quot;, array(&nbsp;</div></li><li><div>                      &$field, &nbsp;</div></li><li><div>                      &$value&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * action 'redux/field/{opt_name}/callback/before'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array  $field field data</span>&nbsp;</div></li><li><div><span class="comment">                   * @param string $value field.id</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  do_action_ref_array( &quot;redux/field/{$this-&gt;args['opt_name']}/callback/before&quot;, array(&nbsp;</div></li><li><div>                      &$field, &nbsp;</div></li><li><div>                      &$value&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  call_user_func( $field['callback'], $field, $value );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * action 'redux-after-field-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array  $field field data</span>&nbsp;</div></li><li><div><span class="comment">                   * @param string $value field.id</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  do_action( &quot;redux-after-field-{$this-&gt;args['opt_name']}&quot;, $field, $value ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * action 'redux/field/{opt_name}/{field.type}/callback/after'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array  $field field data</span>&nbsp;</div></li><li><div><span class="comment">                   * @param string $value field.id</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  do_action_ref_array( &quot;redux/field/{$this-&gt;args['opt_name']}/{$field['type']}/callback/after&quot;, array(&nbsp;</div></li><li><div>                      &$field, &nbsp;</div></li><li><div>                      &$value&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * action 'redux/field/{opt_name}/callback/after'</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array  $field field data</span>&nbsp;</div></li><li><div><span class="comment">                   * @param string $value field.id</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  do_action_ref_array( &quot;redux/field/{$this-&gt;args['opt_name']}/callback/after&quot;, array(&nbsp;</div></li><li><div>                      &$field, &nbsp;</div></li><li><div>                      &$value&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  return;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset ( $field['type'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment"><span class="comment">// If</span></span></span> the field is set not to display in the panel&nbsp;</div></li><li><div>                  $display = true;&nbsp;</div></li><li><div>                  if ( isset ( $_GET['page'] ) && $_GET['page'] == $this-&gt;args['page_slug'] ) {&nbsp;</div></li><li><div>                      if ( isset ( $field['panel'] ) && $field['panel'] == false ) {&nbsp;</div></li><li><div>                          $display = false;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! $display ) {&nbsp;</div></li><li><div>                      return;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $field_class = &quot;ReduxFramework_{$field['type']}&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! class_exists( $field_class ) ) {&nbsp;</div></li><li><div>                      //                    $class_file = apply_filters( 'redux/field/class/'.$field['type'], self::$_dir . 'inc/fields/' . $field['type'] . '/field_' . $field['type'] . '.php', $field ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * filter 'redux/{opt_name}/field/class/{field.type}'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param       string        field class file path</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array $field        field data</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      $class_file = apply_filters( &quot;redux/{$this-&gt;args['opt_name']}/field/class/{$field['type']}&quot;, self::$_dir . &quot;inc/fields/{$field['type']}/field_{$field['type']}.php&quot;, $field );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $class_file ) {&nbsp;</div></li><li><div>                          if ( file_exists( $class_file ) ) {&nbsp;</div></li><li><div>                              require_once $class_file;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( class_exists( $field_class ) ) {&nbsp;</div></li><li><div>                      $value = isset ( $this-&gt;options[ $field['id'] ] ) ? $this-&gt;options[ $field['id'] ] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $v !== null ) {&nbsp;</div></li><li><div>                          $value = $v;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * action 'redux-before-field-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array  $field field data</span>&nbsp;</div></li><li><div><span class="comment">                       * @param string $value field id</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      do_action( &quot;redux-before-field-{$this-&gt;args['opt_name']}&quot;, $field, $value ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * action 'redux/field/{opt_name}/{field.type}/render/before'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array  $field field data</span>&nbsp;</div></li><li><div><span class="comment">                       * @param string $value field id</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      do_action_ref_array( &quot;redux/field/{$this-&gt;args['opt_name']}/{$field['type']}/render/before&quot;, array(&nbsp;</div></li><li><div>                          &$field, &nbsp;</div></li><li><div>                          &$value&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * action 'redux/field/{$this-&gt;args['opt_name']}/render/before'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array  $field field data</span>&nbsp;</div></li><li><div><span class="comment">                       * @param string $value field id</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      do_action_ref_array( &quot;redux/field/{$this-&gt;args['opt_name']}/render/before&quot;, array(&nbsp;</div></li><li><div>                          &$field, &nbsp;</div></li><li><div>                          &$value&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( ! isset ( $field['name_suffix'] ) ) {&nbsp;</div></li><li><div>                          $field['name_suffix'] = &quot;&quot;;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $render = new $field_class ( $field, $value, $this );&nbsp;</div></li><li><div>                      ob_start();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $render-&gt;render();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">                    echo &quot;&lt;pre&gt;&quot;;</span>&nbsp;</div></li><li><div><span class="comment">                    print_r($value);</span>&nbsp;</div></li><li><div><span class="comment">                    echo &quot;&lt;/pre&gt;&quot;;</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * filter 'redux-field-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param       string        rendered field markup</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array $field        field data</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      $_render = apply_filters( &quot;redux-field-{$this-&gt;args['opt_name']}&quot;, ob_get_contents(), $field ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * filter 'redux/field/{opt_name}/{field.type}/render/after'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param       string        rendered field markup</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array $field        field data</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      $_render = apply_filters( &quot;redux/field/{$this-&gt;args['opt_name']}/{$field['type']}/render/after&quot;, $_render, $field );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * filter 'redux/field/{opt_name}/render/after'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param       string        rendered field markup</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array $field        field data</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      $_render = apply_filters( &quot;redux/field/{$this-&gt;args['opt_name']}/render/after&quot;, $_render, $field );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      ob_end_clean();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">//save the values into a unique array in case we need it for dependencies</span>&nbsp;</div></li><li><div>                      $this-&gt;fieldsValues[ $field['id'] ] = ( isset ( $value['url'] ) && is_array( $value ) ) ? $value['url'] : $value;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">//create default data und class string and checks the dependencies of an object</span>&nbsp;</div></li><li><div>                      $class_string = '';&nbsp;</div></li><li><div>                      $data_string = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $this-&gt;check_dependencies( $field );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * action 'redux/field/{opt_name}/{field.type}/fieldset/before/{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array  $field field data</span>&nbsp;</div></li><li><div><span class="comment">                       * @param string $value field id</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      do_action_ref_array( &quot;redux/field/{$this-&gt;args['opt_name']}/{$field['type']}/fieldset/before/{$this-&gt;args['opt_name']}&quot;, array(&nbsp;</div></li><li><div>                          &$field, &nbsp;</div></li><li><div>                          &$value&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * action 'redux/field/{opt_name}/fieldset/before/{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array  $field field data</span>&nbsp;</div></li><li><div><span class="comment">                       * @param string $value field id</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      do_action_ref_array( &quot;redux/field/{$this-&gt;args['opt_name']}/fieldset/before/{$this-&gt;args['opt_name']}&quot;, array(&nbsp;</div></li><li><div>                          &$field, &nbsp;</div></li><li><div>                          &$value&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//if</span></span></span></span></span></span></span></span> ( ! isset( $field['fields'] ) || empty( $field['fields'] ) ) {&nbsp;</div></li><li><div>                      $hidden = '';&nbsp;</div></li><li><div>                      if ( isset ( $field['hidden'] ) && $field['hidden'] ) {&nbsp;</div></li><li><div>                          $hidden = 'hidden ';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $field['full_width'] ) && $field['full_width'] == true ) {&nbsp;</div></li><li><div>                          $class_string .= &quot;redux_remove_th&quot;;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset ( $field['fieldset_class'] ) && ! empty( $field['fieldset_class'] ) ) {&nbsp;</div></li><li><div>                          $class_string .= ' ' . $field['fieldset_class'];&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      echo '&lt;fieldset id=&quot;' . $this-&gt;args['opt_name'] . '-' . $field['id'] . '&quot; class=&quot;' . $hidden . 'redux-field-container redux-field redux-field-init redux-container-' . $field['type'] . ' ' . $class_string . '&quot; data-id=&quot;' . $field['id'] . '&quot; ' . $data_string . ' data-type=&quot;' . $field['type'] . '&quot;&gt;';&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment"><span class="comment">//}</span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      echo $_render;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( ! empty ( $field['desc'] ) ) {&nbsp;</div></li><li><div>                          $field['description'] = $field['desc'];&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      echo ( isset ( $field['description'] ) && $field['type'] != &quot;info&quot; && $field['type'] !== &quot;section&quot; && ! empty ( $field['description'] ) ) ? '&lt;div class=&quot;description field-desc&quot;&gt;' . $field['description'] . '&lt;/div&gt;' : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">//if</span></span></span></span></span></span></span></span> ( ! isset( $field['fields'] ) || empty( $field['fields'] ) ) {&nbsp;</div></li><li><div>                      echo '&lt;/fieldset&gt;';&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment"><span class="comment">//}</span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * action 'redux-after-field-{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @deprecated</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array  $field field data</span>&nbsp;</div></li><li><div><span class="comment">                       * @param string $value field id</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      do_action( &quot;redux-after-field-{$this-&gt;args['opt_name']}&quot;, $field, $value ); <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// REMOVE</span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * action 'redux/field/{opt_name}/{field.type}/fieldset/after/{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array  $field field data</span>&nbsp;</div></li><li><div><span class="comment">                       * @param string $value field id</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      do_action_ref_array( &quot;redux/field/{$this-&gt;args['opt_name']}/{$field['type']}/fieldset/after/{$this-&gt;args['opt_name']}&quot;, array(&nbsp;</div></li><li><div>                          &$field, &nbsp;</div></li><li><div>                          &$value&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * action 'redux/field/{opt_name}/fieldset/after/{opt_name}'</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array  $field field data</span>&nbsp;</div></li><li><div><span class="comment">                       * @param string $value field id</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      do_action_ref_array( &quot;redux/field/{$this-&gt;args['opt_name']}/fieldset/after/{$this-&gt;args['opt_name']}&quot;, array(&nbsp;</div></li><li><div>                          &$field, &nbsp;</div></li><li><div>                          &$value&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// _field_input()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Can Output CSS</span>&nbsp;</div></li><li><div><span class="comment">           * Check if a field meets its requirements before outputting to CSS</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param $field</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return bool</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function _can_output_css( $field ) {&nbsp;</div></li><li><div>              $return = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $field = apply_filters( &quot;redux/field/{$this-&gt;args['opt_name']}/_can_output_css&quot;, $field );&nbsp;</div></li><li><div>              if ( isset ( $field['force_output'] ) && $field['force_output'] == true ) {&nbsp;</div></li><li><div>                  return $return;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $field['required'] ) ) {&nbsp;</div></li><li><div>                  if ( isset ( $field['required'][0] ) ) {&nbsp;</div></li><li><div>                      if ( ! is_array( $field['required'][0] ) && count( $field['required'] ) == 3 ) {&nbsp;</div></li><li><div>                          $parentValue = $GLOBALS[ $this-&gt;args['global_variable'] ][ $field['required'][0] ];&nbsp;</div></li><li><div>                          $checkValue = $field['required'][2];&nbsp;</div></li><li><div>                          $operation = $field['required'][1];&nbsp;</div></li><li><div>                          $return = $this-&gt;compareValueDependencies( $parentValue, $checkValue, $operation );&nbsp;</div></li><li><div>                      } else if ( is_array( $field['required'][0] ) ) {&nbsp;</div></li><li><div>                          foreach ( $field['required'] as $required ) {&nbsp;</div></li><li><div>                              if ( ! is_array( $required[0] ) && count( $required ) == 3 ) {&nbsp;</div></li><li><div>                                  $parentValue = $GLOBALS[ $this-&gt;args['global_variable'] ][ $required[0] ];&nbsp;</div></li><li><div>                                  $checkValue = $required[2];&nbsp;</div></li><li><div>                                  $operation = $required[1];&nbsp;</div></li><li><div>                                  $return = $this-&gt;compareValueDependencies( $parentValue, $checkValue, $operation );&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              if ( ! $return ) {&nbsp;</div></li><li><div>                                  return $return;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// _can_output_css</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Checks dependencies between objects based on the $field['required'] array</span>&nbsp;</div></li><li><div><span class="comment">           * If the array is set it needs to have exactly 3 entries.</span>&nbsp;</div></li><li><div><span class="comment">           * The first entry describes which field should be monitored by the current field. eg: &quot;content&quot;</span>&nbsp;</div></li><li><div><span class="comment">           * The second entry describes the comparison parameter. eg: &quot;equals, not, is_larger, is_smaller , contains&quot;</span>&nbsp;</div></li><li><div><span class="comment">           * The third entry describes the value that we are comparing against.</span>&nbsp;</div></li><li><div><span class="comment">           * Example: if the required array is set to array('content', 'equals', 'Hello World'); then the current</span>&nbsp;</div></li><li><div><span class="comment">           * field will only be displayed if the field with id &quot;content&quot; has exactly the value &quot;Hello World&quot;</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param array $field</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return array $params</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function check_dependencies( $field ) {&nbsp;</div></li><li><div>              <span class="comment">//$params = array('data_string' =&gt; &quot;&quot;, 'class_string' =&gt; &quot;&quot;);</span>&nbsp;</div></li><li><div>              if ( isset( $field['ajax_save'] ) && $field['ajax_save'] == false ) {&nbsp;</div></li><li><div>                  $this-&gt;reload_fields[] = $field['id'];&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty ( $field['required'] ) ) {&nbsp;</div></li><li><div>                  if ( ! isset ( $this-&gt;required_child[ $field['id'] ] ) ) {&nbsp;</div></li><li><div>                      $this-&gt;required_child[ $field['id'] ] = array();&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! isset ( $this-&gt;required[ $field['id'] ] ) ) {&nbsp;</div></li><li><div>                      $this-&gt;required[ $field['id'] ] = array();&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( is_array( $field['required'][0] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      foreach ( $field['required'] as $value ) {&nbsp;</div></li><li><div>                          if ( is_array( $value ) && count( $value ) == 3 ) {&nbsp;</div></li><li><div>                              $data = array();&nbsp;</div></li><li><div>                              $data['parent'] = $value[0];&nbsp;</div></li><li><div>                              $data['operation'] = $value[1];&nbsp;</div></li><li><div>                              $data['checkValue'] = $value[2];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              $this-&gt;required[ $data['parent'] ][ $field['id'] ][] = $data;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( ! in_array( $data['parent'], $this-&gt;required_child[ $field['id'] ] ) ) {&nbsp;</div></li><li><div>                                  $this-&gt;required_child[ $field['id'] ][] = $data;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              $this-&gt;checkRequiredDependencies( $field, $data );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $data = array();&nbsp;</div></li><li><div>                      $data['parent'] = $field['required'][0];&nbsp;</div></li><li><div>                      $data['operation'] = $field['required'][1];&nbsp;</div></li><li><div>                      $data['checkValue'] = $field['required'][2];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $this-&gt;required[ $data['parent'] ][ $field['id'] ][] = $data;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( ! in_array( $data['parent'], $this-&gt;required_child[ $field['id'] ] ) ) {&nbsp;</div></li><li><div>                          $this-&gt;required_child[ $field['id'] ][] = $data;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $this-&gt;checkRequiredDependencies( $field, $data );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              <span class="comment">//return $params;</span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Compare data for required field</span>&nbsp;</div></li><li><div>          private function compareValueDependencies( $parentValue, $checkValue, $operation ) {&nbsp;</div></li><li><div>              $return = false;&nbsp;</div></li><li><div>              switch ( $operation ) {&nbsp;</div></li><li><div>                  case '=':&nbsp;</div></li><li><div>                  case 'equals':&nbsp;</div></li><li><div>                      $data['operation'] = &quot;=&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( is_array( $parentValue ) ) {&nbsp;</div></li><li><div>                          foreach ( $parentValue as $idx =&gt; $val ) {&nbsp;</div></li><li><div>                              if ( is_array( $checkValue ) ) {&nbsp;</div></li><li><div>                                  foreach ( $checkValue as $i =&gt; $v ) {&nbsp;</div></li><li><div>                                      if ( $val == $v ) {&nbsp;</div></li><li><div>                                          $return = true;&nbsp;</div></li><li><div>                                      }&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              } else {&nbsp;</div></li><li><div>                                  if ( $val == $checkValue ) {&nbsp;</div></li><li><div>                                      $return = true;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          if ( is_array( $checkValue ) ) {&nbsp;</div></li><li><div>                              foreach ( $checkValue as $i =&gt; $v ) {&nbsp;</div></li><li><div>                                  if ( $parentValue == $v ) {&nbsp;</div></li><li><div>                                      $return = true;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          } else {&nbsp;</div></li><li><div>                              if ( $parentValue == $checkValue ) {&nbsp;</div></li><li><div>                                  $return = true;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  case '!=':&nbsp;</div></li><li><div>                  case 'not':&nbsp;</div></li><li><div>                      $data['operation'] = &quot;!==&quot;;&nbsp;</div></li><li><div>                      if ( is_array( $parentValue ) ) {&nbsp;</div></li><li><div>                          foreach ( $parentValue as $idx =&gt; $val ) {&nbsp;</div></li><li><div>                              if ( is_array( $checkValue ) ) {&nbsp;</div></li><li><div>                                  foreach ( $checkValue as $i =&gt; $v ) {&nbsp;</div></li><li><div>                                      if ( $val != $v ) {&nbsp;</div></li><li><div>                                          $return = true;&nbsp;</div></li><li><div>                                      }&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              } else {&nbsp;</div></li><li><div>                                  if ( $val != $checkValue ) {&nbsp;</div></li><li><div>                                      $return = true;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          if ( is_array( $checkValue ) ) {&nbsp;</div></li><li><div>                              foreach ( $checkValue as $i =&gt; $v ) {&nbsp;</div></li><li><div>                                  if ( $parentValue != $v ) {&nbsp;</div></li><li><div>                                      $return = true;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          } else {&nbsp;</div></li><li><div>                              if ( $parentValue != $checkValue ) {&nbsp;</div></li><li><div>                                  $return = true;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">//                        if ( is_array( $checkValue ) ) {</span>&nbsp;</div></li><li><div>                      <span class="comment">//                            if ( ! in_array( $parentValue, $checkValue ) ) {</span>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">//                                $return = true;</span></span>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment">//                            }</span></span></span>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">//                        }</span> else {</span>&nbsp;</div></li><li><div>                      <span class="comment">//                            if ( $parentValue != $checkValue ) {</span>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">//                                $return = true;</span></span>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment">//                            }</span></span></span> else if ( is_array( $parentValue ) ) {&nbsp;</div></li><li><div>                      <span class="comment">//                                if ( ! in_array( $checkValue, $parentValue ) ) {</span>&nbsp;</div></li><li><div>                      <span class="comment">//                                    $return = true;</span>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">//                                }</span></span>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment">//                            }</span></span></span>&nbsp;</div></li><li><div>                      <span class="comment">//                        }</span>&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case '&gt;':&nbsp;</div></li><li><div>                  case 'greater':&nbsp;</div></li><li><div>                  case 'is_larger':&nbsp;</div></li><li><div>                      $data['operation'] = &quot;&gt;&quot;;&nbsp;</div></li><li><div>                      if ( $parentValue &gt; $checkValue ) {&nbsp;</div></li><li><div>                          $return = true;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case '&gt;=':&nbsp;</div></li><li><div>                  case 'greater_equal':&nbsp;</div></li><li><div>                  case 'is_larger_equal':&nbsp;</div></li><li><div>                      $data['operation'] = &quot;&gt;=&quot;;&nbsp;</div></li><li><div>                      if ( $parentValue &gt;= $checkValue ) {&nbsp;</div></li><li><div>                          $return = true;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case '&lt;':&nbsp;</div></li><li><div>                  case 'less':&nbsp;</div></li><li><div>                  case 'is_smaller':&nbsp;</div></li><li><div>                      $data['operation'] = &quot;&lt;&quot;;&nbsp;</div></li><li><div>                      if ( $parentValue &lt; $checkValue ) {&nbsp;</div></li><li><div>                          $return = true;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case '&lt;=':&nbsp;</div></li><li><div>                  case 'less_equal':&nbsp;</div></li><li><div>                  case 'is_smaller_equal':&nbsp;</div></li><li><div>                      $data['operation'] = &quot;&lt;=&quot;;&nbsp;</div></li><li><div>                      if ( $parentValue &lt;= $checkValue ) {&nbsp;</div></li><li><div>                          $return = true;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case 'contains':&nbsp;</div></li><li><div>                      if ( is_array( $parentValue ) ) {&nbsp;</div></li><li><div>                          $parentValue = implode( ', ', $parentValue );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( is_array( $checkValue ) ) {&nbsp;</div></li><li><div>                          foreach ( $checkValue as $idx =&gt; $opt ) {&nbsp;</div></li><li><div>                              if ( strpos( $parentValue, (string) $opt ) !== false ) {&nbsp;</div></li><li><div>                                  $return = true;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          if ( strpos( $parentValue, (string) $checkValue ) !== false ) {&nbsp;</div></li><li><div>                              $return = true;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case 'doesnt_contain':&nbsp;</div></li><li><div>                  case 'not_contain':&nbsp;</div></li><li><div>                      if ( is_array( $parentValue ) ) {&nbsp;</div></li><li><div>                          $parentValue = implode( ', ', $parentValue );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( is_array( $checkValue ) ) {&nbsp;</div></li><li><div>                          foreach ( $checkValue as $idx =&gt; $opt ) {&nbsp;</div></li><li><div>                              if ( strpos( $parentValue, (string) $opt ) === false ) {&nbsp;</div></li><li><div>                                  $return = true;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          if ( strpos( $parentValue, (string) $checkValue ) === false ) {&nbsp;</div></li><li><div>                              $return = true;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case 'is_empty_or':&nbsp;</div></li><li><div>                      if ( empty ( $parentValue ) || $parentValue == $checkValue ) {&nbsp;</div></li><li><div>                          $return = true;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case 'not_empty_and':&nbsp;</div></li><li><div>                      if ( ! empty ( $parentValue ) && $parentValue != $checkValue ) {&nbsp;</div></li><li><div>                          $return = true;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case 'is_empty':&nbsp;</div></li><li><div>                  case 'empty':&nbsp;</div></li><li><div>                  case '!isset':&nbsp;</div></li><li><div>                      if ( empty ( $parentValue ) || $parentValue == &quot;&quot; || $parentValue == null ) {&nbsp;</div></li><li><div>                          $return = true;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case 'not_empty':&nbsp;</div></li><li><div>                  case '!empty':&nbsp;</div></li><li><div>                  case 'isset':&nbsp;</div></li><li><div>                      if ( ! empty ( $parentValue ) && $parentValue != &quot;&quot; && $parentValue != null ) {&nbsp;</div></li><li><div>                          $return = true;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          private function checkRequiredDependencies( $field, $data ) {&nbsp;</div></li><li><div>              <span class="comment">//required field must not be hidden. otherwise hide this one by default</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! in_array( $data['parent'], $this-&gt;fieldsHidden ) && ( ! isset ( $this-&gt;folds[ $field['id'] ] ) || $this-&gt;folds[ $field['id'] ] != &quot;hide&quot; ) ) {&nbsp;</div></li><li><div>                  if ( isset ( $this-&gt;options[ $data['parent'] ] ) ) {&nbsp;</div></li><li><div>                      $return = $this-&gt;compareValueDependencies( $this-&gt;options[ $data['parent'] ], $data['checkValue'], $data['operation'] );&nbsp;</div></li><li><div>                      <span class="comment">//$return = $this-&gt;compareValueDependencies( $data['parent'], $data['checkValue'], $data['operation'] );</span>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ( isset ( $return ) && $return ) && ( ! isset ( $this-&gt;folds[ $field['id'] ] ) || $this-&gt;folds[ $field['id'] ] != &quot;hide&quot; ) ) {&nbsp;</div></li><li><div>                  $this-&gt;folds[ $field['id'] ] = &quot;show&quot;;&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $this-&gt;folds[ $field['id'] ] = &quot;hide&quot;;&nbsp;</div></li><li><div>                  if ( ! in_array( $field['id'], $this-&gt;fieldsHidden ) ) {&nbsp;</div></li><li><div>                      $this-&gt;fieldsHidden[] = $field['id'];&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * converts an array into a html data string</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param array $data example input: array('id'=&gt;'true')</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return string $data_string example output: data-id='true'</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          public function create_data_string( $data = array() ) {&nbsp;</div></li><li><div>              $data_string = &quot;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( $data as $key =&gt; $value ) {&nbsp;</div></li><li><div>                  if ( is_array( $value ) ) {&nbsp;</div></li><li><div>                      $value = implode( &quot;|&quot;, $value );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  $data_string .= &quot; data-$key='$value' &quot;;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $data_string;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Parses the string into variables without the max_input_vars limitation.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since   3.5.7.11</span>&nbsp;</div></li><li><div><span class="comment">           * @author  harunbasic</span>&nbsp;</div></li><li><div><span class="comment">           * @access  public</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param   string $string</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return  array $result</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          function redux_parse_str( $string ) {&nbsp;</div></li><li><div>              if ( '' == $string ) {&nbsp;</div></li><li><div>                  return false;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $result = array();&nbsp;</div></li><li><div>              $pairs = explode( '&', $string );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( $pairs as $key =&gt; $pair ) {&nbsp;</div></li><li><div>                  <span class="comment">// use the original parse_str() on each element</span>&nbsp;</div></li><li><div>                  parse_str( $pair, $params );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $k = key( $params );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! isset( $result[ $k ] ) ) {&nbsp;</div></li><li><div>                      $result += $params;&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $result[ $k ] = $this-&gt;redux_array_merge_recursive_distinct( $result[ $k ], $params[ $k ] );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $result;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Merge arrays without converting values with duplicate keys to arrays as array_merge_recursive does.</span>&nbsp;</div></li><li><div><span class="comment">           * As seen here http://php.net/manual/en/function.array-merge-recursive.php#92195</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since   3.5.7.11</span>&nbsp;</div></li><li><div><span class="comment">           * @author  harunbasic</span>&nbsp;</div></li><li><div><span class="comment">           * @access  public</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param   array $array1</span>&nbsp;</div></li><li><div><span class="comment">           * @param   array $array2</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @return  array $merged</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          function redux_array_merge_recursive_distinct( array $array1, array $array2 ) {&nbsp;</div></li><li><div>              $merged = $array1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( $array2 as $key =&gt; $value ) {&nbsp;</div></li><li><div>                  if ( is_array( $value ) && isset( $merged[ $key ] ) && is_array( $merged[ $key ] ) ) {&nbsp;</div></li><li><div>                      $merged[ $key ] = $this-&gt;redux_array_merge_recursive_distinct( $merged[ $key ], $value );&nbsp;</div></li><li><div>                  } else if ( is_numeric( $key ) && isset( $merged[ $key ] ) ) {&nbsp;</div></li><li><div>                      $merged[] = $value;&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $merged[ $key ] = $value;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $merged;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          private function change_demo_defaults() {&nbsp;</div></li><li><div>              if ( $this-&gt;args['dev_mode'] == true || Redux_Helpers::isLocalHost() == true ) {&nbsp;</div></li><li><div>                  if ( ! empty( $this-&gt;args['admin_bar_links'] ) ) {&nbsp;</div></li><li><div>                      foreach ( $this-&gt;args['admin_bar_links'] as $idx =&gt; $arr ) {&nbsp;</div></li><li><div>                          if ( is_array( $arr ) && ! empty( $arr ) ) {&nbsp;</div></li><li><div>                              foreach ( $arr as $x =&gt; $y ) {&nbsp;</div></li><li><div>                                  if ( strpos( strtolower( $y ), 'redux' ) !== false ) {&nbsp;</div></li><li><div>                                      $msg = __( '&lt;strong&gt;Redux Framework Notice: &lt;/strong&gt;There are references to the Redux Framework support site in your config\'s &lt;code&gt;admin_bar_links&lt;/code&gt; argument.  This is sample data.  Please change or remove this data before shipping your product.', 'evolve' );&nbsp;</div></li><li><div>                                      $this-&gt;display_arg_change_notice( 'admin', $msg );&nbsp;</div></li><li><div>                                      $this-&gt;omit_admin_items = true;&nbsp;</div></li><li><div>                                      continue;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! empty( $this-&gt;args['share_icons'] ) ) {&nbsp;</div></li><li><div>                      foreach ( $this-&gt;args['share_icons'] as $idx =&gt; $arr ) {&nbsp;</div></li><li><div>                          if ( is_array( $arr ) && ! empty( $arr ) ) {&nbsp;</div></li><li><div>                              foreach ( $arr as $x =&gt; $y ) {&nbsp;</div></li><li><div>                                  if ( strpos( strtolower( $y ), 'redux' ) !== false ) {&nbsp;</div></li><li><div>                                      $msg = __( '&lt;strong&gt;Redux Framework Notice: &lt;/strong&gt;There are references to the Redux Framework support site in your config\'s &lt;code&gt;share_icons&lt;/code&gt; argument.  This is sample data.  Please change or remove this data before shipping your product.', 'evolve' );&nbsp;</div></li><li><div>                                      $this-&gt;display_arg_change_notice( 'share', $msg );&nbsp;</div></li><li><div>                                      $this-&gt;omit_share_icons = true;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          private function display_arg_change_notice( $mode, $msg = '' ) {&nbsp;</div></li><li><div>              if ( $mode == 'admin' ) {&nbsp;</div></li><li><div>                  if ( ! $this-&gt;omit_admin_items ) {&nbsp;</div></li><li><div>                      $this-&gt;admin_notices[] = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'error', &nbsp;</div></li><li><div>                          'msg' =&gt; $msg, &nbsp;</div></li><li><div>                          'id' =&gt; 'admin_config', &nbsp;</div></li><li><div>                          'dismiss' =&gt; true, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $mode == 'share' ) {&nbsp;</div></li><li><div>                  if ( ! $this-&gt;omit_share_icons ) {&nbsp;</div></li><li><div>                      $this-&gt;admin_notices[] = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'error', &nbsp;</div></li><li><div>                          'msg' =&gt; $msg, &nbsp;</div></li><li><div>                          'id' =&gt; 'share_config', &nbsp;</div></li><li><div>                          'dismiss' =&gt; true, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// ReduxFramework</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * action 'redux/init'</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param null</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      do_action( 'redux/init', ReduxFramework::init() );&nbsp;</div></li><li><div>  } <span class="comment">// class_exists('ReduxFramework')</span>&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>theme</li><li><span></span>file</li><li><span></span></li><li><span></span>evolve</li><li><span></span>3.7.2</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>