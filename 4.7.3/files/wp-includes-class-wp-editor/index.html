<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="wordpress" data-version="4.7.3" data-type="file" data-id="4664"><head xmlns="http://www.w3.org/1999/xhtml"><title> wp-includes-class-wp-editor | file | WordPress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, wordpress, 4.7.3" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.10"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=e35fcc564e8551f470f3fdd079d8da58' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.10' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/wp-includes-class-wp-editor/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-includes-class-wp-editor%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-includes-class-wp-editor%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"wordpress-4.7.3-file-wp-includes-class-wp-editor","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wp-includes-class-wp-editor" class="blog single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 4.7.3." href="http://hookr.io/4.7.3/" class="H_VERSION"><span property="name">4.7.3</span></a><meta property="position" content="2"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wp-includes-class-wp-editor</span><meta property="position" content="3"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="6309"><a href="http://hookr.io/4.7.3/all/" title="All">All <span class="count badge">6309</span></a></li><li class="" data-id="new" data-count="1"><a href="http://hookr.io/4.7.3/new/" title="New">New <span class="count badge">1</span></a></li><li class="" data-id="hooks" data-count="2532"><a href="http://hookr.io/4.7.3/hooks/" title="Hooks">Hooks <span class="count badge">2532</span></a></li><li class="" data-id="action" data-count="864"><a href="http://hookr.io/4.7.3/actions/" title="Actions">Actions <span class="count badge">864</span></a></li><li class="" data-id="filter" data-count="1668"><a href="http://hookr.io/4.7.3/filters/" title="Filters">Filters <span class="count badge">1668</span></a></li><li class="" data-id="class" data-count="351"><a href="http://hookr.io/4.7.3/classes/" title="Classes">Classes <span class="count badge">351</span></a></li><li class="" data-id="constant" data-count="566"><a href="http://hookr.io/4.7.3/constants/" title="Constants">Constants <span class="count badge">566</span></a></li><li class="" data-id="function" data-count="2852"><a href="http://hookr.io/4.7.3/functions/" title="Functions">Functions <span class="count badge">2852</span></a></li><li class="" data-id="shortcode" data-count="8"><a href="http://hookr.io/4.7.3/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">8</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class="active"><a href="http://hookr.io/all/" title="Core">Core</a></li><li class=""><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/wp-includes/class-wp-editor.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Facilitates adding of the WordPress editor as used on the Write and Edit screens.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package WordPress</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.3.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Private, not included by default. See wp_editor() in wp-includes/general-template.php.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>final class _WP_Editors {&nbsp;</div></li><li><div>  public static $mce_locale;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  private static $mce_settings = array();&nbsp;</div></li><li><div>  private static $qt_settings = array();&nbsp;</div></li><li><div>  private static $plugins = array();&nbsp;</div></li><li><div>  private static $qt_buttons = array();&nbsp;</div></li><li><div>  private static $ext_plugins;&nbsp;</div></li><li><div>  private static $baseurl;&nbsp;</div></li><li><div>  private static $first_init;&nbsp;</div></li><li><div>  private static $this_tinymce = false;&nbsp;</div></li><li><div>  private static $this_quicktags = false;&nbsp;</div></li><li><div>  private static $has_tinymce = false;&nbsp;</div></li><li><div>  private static $has_quicktags = false;&nbsp;</div></li><li><div>  private static $has_medialib = false;&nbsp;</div></li><li><div>  private static $editor_buttons_css = true;&nbsp;</div></li><li><div>  private static $drag_drop_upload = false;&nbsp;</div></li><li><div>  private static $old_dfw_compat = false;&nbsp;</div></li><li><div>  private static $translation;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  private function __construct() {}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Parse default arguments for the editor instance.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @static</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $editor_id ID for the current editor instance.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $settings {</span>&nbsp;</div></li><li><div><span class="comment">   *     Array of editor arguments.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   *     @type bool       $wpautop           Whether to use wpautop(). Default true.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type bool       $media_buttons     Whether to show the Add Media/other media buttons.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string     $default_editor    When both TinyMCE and Quicktags are used, set which</span>&nbsp;</div></li><li><div><span class="comment">   *                                         editor is shown on page load. Default empty.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type bool       $drag_drop_upload  Whether to enable drag & drop on the editor uploading. Default false.</span>&nbsp;</div></li><li><div><span class="comment">   *                                         Requires the media modal.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string     $textarea_name     Give the textarea a unique name here. Square brackets</span>&nbsp;</div></li><li><div><span class="comment">   *                                         can be used here. Default $editor_id.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type int        $textarea_rows     Number rows in the editor textarea. Default 20.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string|int $tabindex          Tabindex value to use. Default empty.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string     $tabfocus_elements The previous and next element ID to move the focus to</span>&nbsp;</div></li><li><div><span class="comment">   *                                         when pressing the Tab key in TinyMCE. Default ':prev, :next'.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string     $editor_css        Intended for extra styles for both Visual and Text editors.</span>&nbsp;</div></li><li><div><span class="comment">   *                                         Should include `&lt;style&gt;` tags, and can use &quot;scoped&quot;. Default empty.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string     $editor_class      Extra classes to add to the editor textarea element. Default empty.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type bool       $teeny             Whether to output the minimal editor config. Examples include</span>&nbsp;</div></li><li><div><span class="comment">   *                                         Press This and the Comment editor. Default false.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type bool       $dfw               Deprecated in 4.1. Since 4.3 used only to enqueue wp-fullscreen-stub.js</span>&nbsp;</div></li><li><div><span class="comment">   *                                         for backward compatibility.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type bool|array $tinymce           Whether to load TinyMCE. Can be used to pass settings directly to</span>&nbsp;</div></li><li><div><span class="comment">   *                                         TinyMCE using an array. Default true.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type bool|array $quicktags         Whether to load Quicktags. Can be used to pass settings directly to</span>&nbsp;</div></li><li><div><span class="comment">   *                                         Quicktags using an array. Default true.</span>&nbsp;</div></li><li><div><span class="comment">   * }</span>&nbsp;</div></li><li><div><span class="comment">   * @return array Parsed arguments array.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public static function parse_settings( $editor_id, $settings ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the wp_editor() settings.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 4.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @see _WP_Editors()::parse_settings()</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array  $settings  Array of editor arguments.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $editor_id ID for the current editor instance.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $settings = apply_filters( 'wp_editor_settings', $settings, $editor_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $set = wp_parse_args( $settings, array(&nbsp;</div></li><li><div>          'wpautop' =&gt; true, &nbsp;</div></li><li><div>          'media_buttons' =&gt; true, &nbsp;</div></li><li><div>          'default_editor' =&gt; '', &nbsp;</div></li><li><div>          'drag_drop_upload' =&gt; false, &nbsp;</div></li><li><div>          'textarea_name' =&gt; $editor_id, &nbsp;</div></li><li><div>          'textarea_rows' =&gt; 20, &nbsp;</div></li><li><div>          'tabindex' =&gt; '', &nbsp;</div></li><li><div>          'tabfocus_elements' =&gt; ':prev, :next', &nbsp;</div></li><li><div>          'editor_css' =&gt; '', &nbsp;</div></li><li><div>          'editor_class' =&gt; '', &nbsp;</div></li><li><div>          'teeny' =&gt; false, &nbsp;</div></li><li><div>          'dfw' =&gt; false, &nbsp;</div></li><li><div>          '_content_editor_dfw' =&gt; false, &nbsp;</div></li><li><div>          'tinymce' =&gt; true, &nbsp;</div></li><li><div>          'quicktags' =&gt; true&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      self::$this_tinymce = ( $set['tinymce'] && user_can_richedit() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( self::$this_tinymce ) {&nbsp;</div></li><li><div>          if ( false !== strpos( $editor_id, '[' ) ) {&nbsp;</div></li><li><div>              self::$this_tinymce = false;&nbsp;</div></li><li><div>              _deprecated_argument( 'wp_editor()', '3.9.0', 'TinyMCE editor IDs cannot have brackets.' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      self::$this_quicktags = (bool) $set['quicktags'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( self::$this_tinymce )&nbsp;</div></li><li><div>          self::$has_tinymce = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( self::$this_quicktags )&nbsp;</div></li><li><div>          self::$has_quicktags = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $set['dfw'] ) {&nbsp;</div></li><li><div>          self::$old_dfw_compat = true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $set['editor_height'] ) )&nbsp;</div></li><li><div>          return $set;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 'content' === $editor_id && empty( $set['tinymce']['wp_autoresize_on'] ) ) {&nbsp;</div></li><li><div>          <span class="comment">// A cookie (set when a user resizes the editor) overrides the height.</span>&nbsp;</div></li><li><div>          $cookie = (int) get_user_setting( 'ed_size' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $cookie )&nbsp;</div></li><li><div>              $set['editor_height'] = $cookie;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $set['editor_height'] &lt; 50 )&nbsp;</div></li><li><div>          $set['editor_height'] = 50;&nbsp;</div></li><li><div>      elseif ( $set['editor_height'] &gt; 5000 )&nbsp;</div></li><li><div>          $set['editor_height'] = 5000;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $set;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Outputs the HTML for a single instance of the editor.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @static</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $content The initial content of the editor.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $editor_id ID for the textarea and TinyMCE and Quicktags instances (can contain only ASCII letters and numbers).</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $settings See the _parse_settings() method for description.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public static function editor( $content, $editor_id, $settings = array() ) {&nbsp;</div></li><li><div>      $set = self::parse_settings( $editor_id, $settings );&nbsp;</div></li><li><div>      $editor_class = ' class=&quot;' . trim( esc_attr( $set['editor_class'] ) . ' wp-editor-area' ) . '&quot;';&nbsp;</div></li><li><div>      $tabindex = $set['tabindex'] ? ' tabindex=&quot;' . (int) $set['tabindex'] . '&quot;' : '';&nbsp;</div></li><li><div>      $default_editor = 'html';&nbsp;</div></li><li><div>      $buttons = $autocomplete = '';&nbsp;</div></li><li><div>      $editor_id_attr = esc_attr( $editor_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $set['drag_drop_upload'] ) {&nbsp;</div></li><li><div>          self::$drag_drop_upload = true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $set['editor_height'] ) ) {&nbsp;</div></li><li><div>          $height = ' style=&quot;height: ' . (int) $set['editor_height'] . 'px&quot;';&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $height = ' rows=&quot;' . (int) $set['textarea_rows'] . '&quot;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! current_user_can( 'upload_files' ) ) {&nbsp;</div></li><li><div>          $set['media_buttons'] = false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( self::$this_tinymce ) {&nbsp;</div></li><li><div>          $autocomplete = ' autocomplete=&quot;off&quot;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( self::$this_quicktags ) {&nbsp;</div></li><li><div>              $default_editor = $set['default_editor'] ? $set['default_editor'] : wp_default_editor();&nbsp;</div></li><li><div>              <span class="comment">// 'html' is used for the &quot;Text&quot; editor tab.</span>&nbsp;</div></li><li><div>              if ( 'html' !== $default_editor ) {&nbsp;</div></li><li><div>                  $default_editor = 'tinymce';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $buttons .= '&lt;button type=&quot;button&quot; id=&quot;' . $editor_id_attr . '-tmce&quot; class=&quot;wp-switch-editor switch-tmce&quot;' .&nbsp;</div></li><li><div>                  ' data-wp-editor-id=&quot;' . $editor_id_attr . '&quot;&gt;' . __('Visual') . &quot;&lt;/button&gt;\n&quot;;&nbsp;</div></li><li><div>              $buttons .= '&lt;button type=&quot;button&quot; id=&quot;' . $editor_id_attr . '-html&quot; class=&quot;wp-switch-editor switch-html&quot;' .&nbsp;</div></li><li><div>                  ' data-wp-editor-id=&quot;' . $editor_id_attr . '&quot;&gt;' . _x( 'Text', 'Name for the Text editor tab (formerly HTML)' ) . &quot;&lt;/button&gt;\n&quot;;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $default_editor = 'tinymce';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $switch_class = 'html' === $default_editor ? 'html-active' : 'tmce-active';&nbsp;</div></li><li><div>      $wrap_class = 'wp-core-ui wp-editor-wrap ' . $switch_class;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $set['_content_editor_dfw'] ) {&nbsp;</div></li><li><div>          $wrap_class .= ' has-dfw';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo '&lt;div id=&quot;wp-' . $editor_id_attr . '-wrap&quot; class=&quot;' . $wrap_class . '&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( self::$editor_buttons_css ) {&nbsp;</div></li><li><div>          wp_print_styles( 'editor-buttons' );&nbsp;</div></li><li><div>          self::$editor_buttons_css = false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $set['editor_css'] ) ) {&nbsp;</div></li><li><div>          echo $set['editor_css'] . &quot;\n&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $buttons ) || $set['media_buttons'] ) {&nbsp;</div></li><li><div>          echo '&lt;div id=&quot;wp-' . $editor_id_attr . '-editor-tools&quot; class=&quot;wp-editor-tools hide-if-no-js&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $set['media_buttons'] ) {&nbsp;</div></li><li><div>              self::$has_medialib = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! function_exists( 'media_buttons' ) )&nbsp;</div></li><li><div>                  include( ABSPATH . 'wp-admin/includes/media.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              echo '&lt;div id=&quot;wp-' . $editor_id_attr . '-media-buttons&quot; class=&quot;wp-media-buttons&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Fires after the default media button(s) are displayed.</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param string $editor_id Unique editor identifier, e.g. 'content'.</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              do_action( 'media_buttons', $editor_id );&nbsp;</div></li><li><div>              echo &quot;&lt;/div&gt;\n&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo '&lt;div class=&quot;wp-editor-tabs&quot;&gt;' . $buttons . &quot;&lt;/div&gt;\n&quot;;&nbsp;</div></li><li><div>          echo &quot;&lt;/div&gt;\n&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $quicktags_toolbar = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( self::$this_quicktags ) {&nbsp;</div></li><li><div>          if ( 'content' === $editor_id && ! empty( $GLOBALS['current_screen'] ) && $GLOBALS['current_screen']-&gt;base === 'post' ) {&nbsp;</div></li><li><div>              $toolbar_id = 'ed_toolbar';&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $toolbar_id = 'qt_' . $editor_id_attr . '_toolbar';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $quicktags_toolbar = '&lt;div id=&quot;' . $toolbar_id . '&quot; class=&quot;quicktags-toolbar&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the HTML markup output that displays the editor.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $output Editor's HTML markup.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $the_editor = apply_filters( 'the_editor', '&lt;div id=&quot;wp-' . $editor_id_attr . '-editor-container&quot; class=&quot;wp-editor-container&quot;&gt;' .&nbsp;</div></li><li><div>          $quicktags_toolbar .&nbsp;</div></li><li><div>          '&lt;textarea' . $editor_class . $height . $tabindex . $autocomplete . ' cols=&quot;40&quot; name=&quot;' . esc_attr( $set['textarea_name'] ) . '&quot; ' .&nbsp;</div></li><li><div>          'id=&quot;' . $editor_id_attr . '&quot;&gt;%s&lt;/textarea&gt;&lt;/div&gt;' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Prepare the content for the Visual or Text editor, only when TinyMCE is used (back-compat).</span>&nbsp;</div></li><li><div>      if ( self::$this_tinymce ) {&nbsp;</div></li><li><div>          add_filter( 'the_editor_content', 'format_for_editor', 10, 2 );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the default editor content.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $content        Default editor content.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $default_editor The default editor for the current user.</span>&nbsp;</div></li><li><div><span class="comment">       *                               Either 'html' or 'tinymce'.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $content = apply_filters( 'the_editor_content', $content, $default_editor );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Remove the filter as the next editor on the same page may not need it.</span>&nbsp;</div></li><li><div>      if ( self::$this_tinymce ) {&nbsp;</div></li><li><div>          remove_filter( 'the_editor_content', 'format_for_editor' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Back-compat for the `htmledit_pre` and `richedit_pre` filters</span>&nbsp;</div></li><li><div>      if ( 'html' === $default_editor && has_filter( 'htmledit_pre' ) ) {&nbsp;</div></li><li><div>          <span class="comment">// TODO: needs _deprecated_filter(), use _deprecated_function() as substitute for now</span>&nbsp;</div></li><li><div>          _deprecated_function( 'add_filter( htmledit_pre )', '4.3.0', 'add_filter( format_for_editor )' );&nbsp;</div></li><li><div>          $content = apply_filters( 'htmledit_pre', $content );&nbsp;</div></li><li><div>      } elseif ( 'tinymce' === $default_editor && has_filter( 'richedit_pre' ) ) {&nbsp;</div></li><li><div>          _deprecated_function( 'add_filter( richedit_pre )', '4.3.0', 'add_filter( format_for_editor )' );&nbsp;</div></li><li><div>          $content = apply_filters( 'richedit_pre', $content );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( false !== stripos( $content, 'textarea' ) ) {&nbsp;</div></li><li><div>          $content = preg_replace( '%&lt;/textarea%i', '&lt;/textarea', $content );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      printf( $the_editor, $content );&nbsp;</div></li><li><div>      echo &quot;\n&lt;/div&gt;\n\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      self::editor_settings( $editor_id, $set );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @static</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @global string $tinymce_version</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $editor_id</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $set</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public static function editor_settings($editor_id, $set) {&nbsp;</div></li><li><div>      global $tinymce_version;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty(self::$first_init) ) {&nbsp;</div></li><li><div>          if ( is_admin() ) {&nbsp;</div></li><li><div>              add_action( 'admin_print_footer_scripts', array( __CLASS__, 'editor_js' ), 50 );&nbsp;</div></li><li><div>              add_action( 'admin_print_footer_scripts', array( __CLASS__, 'enqueue_scripts' ), 1 );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              add_action( 'wp_print_footer_scripts', array( __CLASS__, 'editor_js' ), 50 );&nbsp;</div></li><li><div>              add_action( 'wp_print_footer_scripts', array( __CLASS__, 'enqueue_scripts' ), 1 );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( self::$this_quicktags ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $qtInit = array(&nbsp;</div></li><li><div>              'id' =&gt; $editor_id, &nbsp;</div></li><li><div>              'buttons' =&gt; ''&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( is_array($set['quicktags']) )&nbsp;</div></li><li><div>              $qtInit = array_merge($qtInit, $set['quicktags']);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty($qtInit['buttons']) )&nbsp;</div></li><li><div>              $qtInit['buttons'] = 'strong, em, link, block, del, ins, img, ul, ol, li, code, more, close';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $set['_content_editor_dfw'] ) {&nbsp;</div></li><li><div>              $qtInit['buttons'] .= ', dfw';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Filters the Quicktags settings.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since 3.3.0</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param array  $qtInit    Quicktags settings.</span>&nbsp;</div></li><li><div><span class="comment">           * @param string $editor_id The unique editor ID, e.g. 'content'.</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          $qtInit = apply_filters( 'quicktags_settings', $qtInit, $editor_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          self::$qt_settings[$editor_id] = $qtInit;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          self::$qt_buttons = array_merge( self::$qt_buttons, explode(', ', $qtInit['buttons']) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( self::$this_tinymce ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( self::$first_init ) ) {&nbsp;</div></li><li><div>              self::$baseurl = includes_url( 'js/tinymce' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $mce_locale = get_user_locale();&nbsp;</div></li><li><div>              self::$mce_locale = $mce_locale = empty( $mce_locale ) ? 'en' : strtolower( substr( $mce_locale, 0, 2 ) ); <span class="comment">// ISO 639-1</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/** This filter is documented in wp-admin/includes/media.php */</span>&nbsp;</div></li><li><div>              $no_captions = (bool) apply_filters( 'disable_captions', '' );&nbsp;</div></li><li><div>              $ext_plugins = '';&nbsp;</div></li><li><div>              $shortcut_labels = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( self::get_translation() as $name =&gt; $value ) {&nbsp;</div></li><li><div>                  if ( is_array( $value ) ) {&nbsp;</div></li><li><div>                      $shortcut_labels[$name] = $value[1];&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $set['teeny'] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * Filters the list of teenyMCE plugins.</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array  $plugins   An array of teenyMCE plugins.</span>&nbsp;</div></li><li><div><span class="comment">                   * @param string $editor_id Unique editor identifier, e.g. 'content'.</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  self::$plugins = $plugins = apply_filters( 'teeny_mce_plugins', array( 'colorpicker', 'lists', 'fullscreen', 'image', 'wordpress', 'wpeditimage', 'wplink' ), $editor_id );&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * Filters the list of TinyMCE external plugins.</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * The filter takes an associative array of external plugins for</span>&nbsp;</div></li><li><div><span class="comment">                   * TinyMCE in the form 'plugin_name' =&gt; 'url'.</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * The url should be absolute, and should include the js filename</span>&nbsp;</div></li><li><div><span class="comment">                   * to be loaded. For example:</span>&nbsp;</div></li><li><div><span class="comment">                   * 'myplugin' =&gt; 'http://mysite.com/wp-content/plugins/myfolder/mce_plugin.js'.</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * If the external plugin adds a button, it should be added with</span>&nbsp;</div></li><li><div><span class="comment">                   * one of the 'mce_buttons' filters.</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array $external_plugins An array of external TinyMCE plugins.</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  $mce_external_plugins = apply_filters( 'mce_external_plugins', array() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $plugins = array(&nbsp;</div></li><li><div>                      'charmap', &nbsp;</div></li><li><div>                      'colorpicker', &nbsp;</div></li><li><div>                      'hr', &nbsp;</div></li><li><div>                      'lists', &nbsp;</div></li><li><div>                      'media', &nbsp;</div></li><li><div>                      'paste', &nbsp;</div></li><li><div>                      'tabfocus', &nbsp;</div></li><li><div>                      'textcolor', &nbsp;</div></li><li><div>                      'fullscreen', &nbsp;</div></li><li><div>                      'wordpress', &nbsp;</div></li><li><div>                      'wpautoresize', &nbsp;</div></li><li><div>                      'wpeditimage', &nbsp;</div></li><li><div>                      'wpemoji', &nbsp;</div></li><li><div>                      'wpgallery', &nbsp;</div></li><li><div>                      'wplink', &nbsp;</div></li><li><div>                      'wpdialogs', &nbsp;</div></li><li><div>                      'wptextpattern', &nbsp;</div></li><li><div>                      'wpview', &nbsp;</div></li><li><div>                      'wpembed', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! self::$has_medialib ) {&nbsp;</div></li><li><div>                      $plugins[] = 'image';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * Filters the list of default TinyMCE plugins.</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * The filter specifies which of the default plugins included</span>&nbsp;</div></li><li><div><span class="comment">                   * in WordPress should be added to the TinyMCE instance.</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @since 3.3.0</span>&nbsp;</div></li><li><div><span class="comment">                   *</span>&nbsp;</div></li><li><div><span class="comment">                   * @param array $plugins An array of default TinyMCE plugins.</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  $plugins = array_unique( apply_filters( 'tiny_mce_plugins', $plugins ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ( $key = array_search( 'spellchecker', $plugins ) ) !== false ) {&nbsp;</div></li><li><div>                      <span class="comment">// Remove 'spellchecker' from the internal plugins if added with 'tiny_mce_plugins' filter to prevent errors.</span>&nbsp;</div></li><li><div>                      <span class="comment">// It can be added with 'mce_external_plugins'.</span>&nbsp;</div></li><li><div>                      unset( $plugins[$key] );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! empty( $mce_external_plugins ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                       * Filters the translations loaded for external TinyMCE 3.x plugins.</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * The filter takes an associative array ('plugin_name' =&gt; 'path')</span>&nbsp;</div></li><li><div><span class="comment">                       * where 'path' is the include path to the file.</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * The language file should follow the same format as wp_mce_translation(), </span>&nbsp;</div></li><li><div><span class="comment">                       * and should define a variable ($strings) that holds all translated strings.</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment">                       *</span>&nbsp;</div></li><li><div><span class="comment">                       * @param array $translations Translations for external TinyMCE plugins.</span>&nbsp;</div></li><li><div><span class="comment">                       */</span>&nbsp;</div></li><li><div>                      $mce_external_languages = apply_filters( 'mce_external_languages', array() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $loaded_langs = array();&nbsp;</div></li><li><div>                      $strings = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( ! empty( $mce_external_languages ) ) {&nbsp;</div></li><li><div>                          foreach ( $mce_external_languages as $name =&gt; $path ) {&nbsp;</div></li><li><div>                              if ( @is_file( $path ) && @is_readable( $path ) ) {&nbsp;</div></li><li><div>                                  include_once( $path );&nbsp;</div></li><li><div>                                  $ext_plugins .= $strings . &quot;\n&quot;;&nbsp;</div></li><li><div>                                  $loaded_langs[] = $name;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      foreach ( $mce_external_plugins as $name =&gt; $url ) {&nbsp;</div></li><li><div>                          if ( in_array( $name, $plugins, true ) ) {&nbsp;</div></li><li><div>                              unset( $mce_external_plugins[ $name ] );&nbsp;</div></li><li><div>                              continue;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $url = set_url_scheme( $url );&nbsp;</div></li><li><div>                          $mce_external_plugins[ $name ] = $url;&nbsp;</div></li><li><div>                          $plugurl = dirname( $url );&nbsp;</div></li><li><div>                          $strings = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// Try to load langs/[locale].js and langs/[locale]_dlg.js</span>&nbsp;</div></li><li><div>                          if ( ! in_array( $name, $loaded_langs, true ) ) {&nbsp;</div></li><li><div>                              $path = str_replace( content_url(), '', $plugurl );&nbsp;</div></li><li><div>                              $path = WP_CONTENT_DIR . $path . '/langs/';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( function_exists('realpath') )&nbsp;</div></li><li><div>                                  $path = trailingslashit( realpath($path) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( @is_file( $path . $mce_locale . '.js' ) )&nbsp;</div></li><li><div>                                  $strings .= @file_get_contents( $path . $mce_locale . '.js' ) . &quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( @is_file( $path . $mce_locale . '_dlg.js' ) )&nbsp;</div></li><li><div>                                  $strings .= @file_get_contents( $path . $mce_locale . '_dlg.js' ) . &quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( 'en' != $mce_locale && empty( $strings ) ) {&nbsp;</div></li><li><div>                                  if ( @is_file( $path . 'en.js' ) ) {&nbsp;</div></li><li><div>                                      $str1 = @file_get_contents( $path . 'en.js' );&nbsp;</div></li><li><div>                                      $strings .= preg_replace( '/([\'&quot;])en\./', '$1' . $mce_locale . '.', $str1, 1 ) . &quot;\n&quot;;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  if ( @is_file( $path . 'en_dlg.js' ) ) {&nbsp;</div></li><li><div>                                      $str2 = @file_get_contents( $path . 'en_dlg.js' );&nbsp;</div></li><li><div>                                      $strings .= preg_replace( '/([\'&quot;])en\./', '$1' . $mce_locale . '.', $str2, 1 ) . &quot;\n&quot;;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( ! empty( $strings ) )&nbsp;</div></li><li><div>                                  $ext_plugins .= &quot;\n&quot; . $strings . &quot;\n&quot;;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $ext_plugins .= 'tinyMCEPreInit.load_ext(&quot;' . $plugurl . '&quot;, &quot;' . $mce_locale . '&quot;);' . &quot;\n&quot;;&nbsp;</div></li><li><div>                          $ext_plugins .= 'tinymce.PluginManager.load(&quot;' . $name . '&quot;, &quot;' . $url . '&quot;);' . &quot;\n&quot;;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              self::$plugins = $plugins;&nbsp;</div></li><li><div>              self::$ext_plugins = $ext_plugins;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              self::$first_init = array(&nbsp;</div></li><li><div>                  'theme' =&gt; 'modern', &nbsp;</div></li><li><div>                  'skin' =&gt; 'lightgray', &nbsp;</div></li><li><div>                  'language' =&gt; self::$mce_locale, &nbsp;</div></li><li><div>                  'formats' =&gt; '{' .&nbsp;</div></li><li><div>                      'alignleft: [' .&nbsp;</div></li><li><div>                          '{selector: &quot;p, h1, h2, h3, h4, h5, h6, td, th, div, ul, ol, li&quot;, styles: {textAlign:&quot;left&quot;}}, ' .&nbsp;</div></li><li><div>                          '{selector: &quot;img, table, dl.wp-caption&quot;, classes: &quot;alignleft&quot;}' .&nbsp;</div></li><li><div>                      '], ' .&nbsp;</div></li><li><div>                      'aligncenter: [' .&nbsp;</div></li><li><div>                          '{selector: &quot;p, h1, h2, h3, h4, h5, h6, td, th, div, ul, ol, li&quot;, styles: {textAlign:&quot;center&quot;}}, ' .&nbsp;</div></li><li><div>                          '{selector: &quot;img, table, dl.wp-caption&quot;, classes: &quot;aligncenter&quot;}' .&nbsp;</div></li><li><div>                      '], ' .&nbsp;</div></li><li><div>                      'alignright: [' .&nbsp;</div></li><li><div>                          '{selector: &quot;p, h1, h2, h3, h4, h5, h6, td, th, div, ul, ol, li&quot;, styles: {textAlign:&quot;right&quot;}}, ' .&nbsp;</div></li><li><div>                          '{selector: &quot;img, table, dl.wp-caption&quot;, classes: &quot;alignright&quot;}' .&nbsp;</div></li><li><div>                      '], ' .&nbsp;</div></li><li><div>                      'strikethrough: {inline: &quot;del&quot;}' .&nbsp;</div></li><li><div>                  '}', &nbsp;</div></li><li><div>                  'relative_urls' =&gt; false, &nbsp;</div></li><li><div>                  'remove_script_host' =&gt; false, &nbsp;</div></li><li><div>                  'convert_urls' =&gt; false, &nbsp;</div></li><li><div>                  'browser_spellcheck' =&gt; true, &nbsp;</div></li><li><div>                  'fix_list_elements' =&gt; true, &nbsp;</div></li><li><div>                  'entities' =&gt; '38, amp, 60, lt, 62, gt', &nbsp;</div></li><li><div>                  'entity_encoding' =&gt; 'raw', &nbsp;</div></li><li><div>                  'keep_styles' =&gt; false, &nbsp;</div></li><li><div>                  'cache_suffix' =&gt; 'wp-mce-' . $tinymce_version, &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Limit the preview styles in the menu/toolbar</span>&nbsp;</div></li><li><div>                  'preview_styles' =&gt; 'font-family font-size font-weight font-style text-decoration text-transform', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  'end_container_on_empty_block' =&gt; true, &nbsp;</div></li><li><div>                  'wpeditimage_disable_captions' =&gt; $no_captions, &nbsp;</div></li><li><div>                  'wpeditimage_html5_captions' =&gt; current_theme_supports( 'html5', 'caption' ), &nbsp;</div></li><li><div>                  'plugins' =&gt; implode( ', ', $plugins ), &nbsp;</div></li><li><div>                  'wp_lang_attr' =&gt; get_bloginfo( 'language' ), &nbsp;</div></li><li><div>                  'wp_shortcut_labels' =&gt; wp_json_encode( $shortcut_labels ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $mce_external_plugins ) ) {&nbsp;</div></li><li><div>                  self::$first_init['external_plugins'] = wp_json_encode( $mce_external_plugins );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $suffix = SCRIPT_DEBUG ? '' : '.min';&nbsp;</div></li><li><div>              $version = 'ver=' . get_bloginfo( 'version' );&nbsp;</div></li><li><div>              $dashicons = includes_url( &quot;css/dashicons$suffix.css?$version&quot; );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// WordPress default stylesheet and dashicons</span>&nbsp;</div></li><li><div>              $mce_css = array(&nbsp;</div></li><li><div>                  $dashicons, &nbsp;</div></li><li><div>                  self::$baseurl . '/skins/wordpress/wp-content.css?' . $version&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $editor_styles = get_editor_stylesheets();&nbsp;</div></li><li><div>              if ( ! empty( $editor_styles ) ) {&nbsp;</div></li><li><div>                  foreach ( $editor_styles as $style ) {&nbsp;</div></li><li><div>                      $mce_css[] = $style;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Filters the comma-delimited list of stylesheets to load in TinyMCE.</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param string $stylesheets Comma-delimited list of stylesheets.</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $mce_css = trim( apply_filters( 'mce_css', implode( ', ', $mce_css ) ), ' , ' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty($mce_css) )&nbsp;</div></li><li><div>                  self::$first_init['content_css'] = $mce_css;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $set['teeny'] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Filters the list of teenyMCE buttons (Text tab).</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param array  $buttons   An array of teenyMCE buttons.</span>&nbsp;</div></li><li><div><span class="comment">               * @param string $editor_id Unique editor identifier, e.g. 'content'.</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $mce_buttons = apply_filters( 'teeny_mce_buttons', array('bold', 'italic', 'underline', 'blockquote', 'strikethrough', 'bullist', 'numlist', 'alignleft', 'aligncenter', 'alignright', 'undo', 'redo', 'link', 'unlink', 'fullscreen'), $editor_id );&nbsp;</div></li><li><div>              $mce_buttons_2 = $mce_buttons_3 = $mce_buttons_4 = array();&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $mce_buttons = array( 'formatselect', 'bold', 'italic', 'bullist', 'numlist', 'blockquote', 'alignleft', 'aligncenter', 'alignright', 'link', 'unlink', 'wp_more', 'spellchecker' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! wp_is_mobile() ) {&nbsp;</div></li><li><div>                  if ( $set['_content_editor_dfw'] ) {&nbsp;</div></li><li><div>                      $mce_buttons[] = 'dfw';&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $mce_buttons[] = 'fullscreen';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $mce_buttons[] = 'wp_adv';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Filters the first-row list of TinyMCE buttons (Visual tab).</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param array  $buttons   First-row list of buttons.</span>&nbsp;</div></li><li><div><span class="comment">               * @param string $editor_id Unique editor identifier, e.g. 'content'.</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $mce_buttons = apply_filters( 'mce_buttons', $mce_buttons, $editor_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $mce_buttons_2 = array( 'strikethrough', 'hr', 'forecolor', 'pastetext', 'removeformat', 'charmap', 'outdent', 'indent', 'undo', 'redo' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! wp_is_mobile() ) {&nbsp;</div></li><li><div>                  $mce_buttons_2[] = 'wp_help';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Filters the second-row list of TinyMCE buttons (Visual tab).</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param array  $buttons   Second-row list of buttons.</span>&nbsp;</div></li><li><div><span class="comment">               * @param string $editor_id Unique editor identifier, e.g. 'content'.</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $mce_buttons_2 = apply_filters( 'mce_buttons_2', $mce_buttons_2, $editor_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Filters the third-row list of TinyMCE buttons (Visual tab).</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param array  $buttons   Third-row list of buttons.</span>&nbsp;</div></li><li><div><span class="comment">               * @param string $editor_id Unique editor identifier, e.g. 'content'.</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $mce_buttons_3 = apply_filters( 'mce_buttons_3', array(), $editor_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Filters the fourth-row list of TinyMCE buttons (Visual tab).</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param array  $buttons   Fourth-row list of buttons.</span>&nbsp;</div></li><li><div><span class="comment">               * @param string $editor_id Unique editor identifier, e.g. 'content'.</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $mce_buttons_4 = apply_filters( 'mce_buttons_4', array(), $editor_id );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $body_class = $editor_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $post = get_post() ) {&nbsp;</div></li><li><div>              $body_class .= ' post-type-' . sanitize_html_class( $post-&gt;post_type ) . ' post-status-' . sanitize_html_class( $post-&gt;post_status );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( post_type_supports( $post-&gt;post_type, 'post-formats' ) ) {&nbsp;</div></li><li><div>                  $post_format = get_post_format( $post );&nbsp;</div></li><li><div>                  if ( $post_format && ! is_wp_error( $post_format ) )&nbsp;</div></li><li><div>                      $body_class .= ' post-format-' . sanitize_html_class( $post_format );&nbsp;</div></li><li><div>                  else&nbsp;</div></li><li><div>                      $body_class .= ' post-format-standard';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $page_template = get_page_template_slug( $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $page_template !== false ) {&nbsp;</div></li><li><div>                  $page_template = empty( $page_template ) ? 'default' : str_replace( '.', '-', basename( $page_template, '.php' ) );&nbsp;</div></li><li><div>                  $body_class .= ' page-template-' . sanitize_html_class( $page_template );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $body_class .= ' locale-' . sanitize_html_class( strtolower( str_replace( '_', '-', get_user_locale() ) ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( !empty($set['tinymce']['body_class']) ) {&nbsp;</div></li><li><div>              $body_class .= ' ' . $set['tinymce']['body_class'];&nbsp;</div></li><li><div>              unset($set['tinymce']['body_class']);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $mceInit = array (&nbsp;</div></li><li><div>              'selector' =&gt; &quot;#$editor_id&quot;, &nbsp;</div></li><li><div>              'resize' =&gt; 'vertical', &nbsp;</div></li><li><div>              'menubar' =&gt; false, &nbsp;</div></li><li><div>              'wpautop' =&gt; (bool) $set['wpautop'], &nbsp;</div></li><li><div>              'indent' =&gt; ! $set['wpautop'], &nbsp;</div></li><li><div>              'toolbar1' =&gt; implode($mce_buttons, ', '), &nbsp;</div></li><li><div>              'toolbar2' =&gt; implode($mce_buttons_2, ', '), &nbsp;</div></li><li><div>              'toolbar3' =&gt; implode($mce_buttons_3, ', '), &nbsp;</div></li><li><div>              'toolbar4' =&gt; implode($mce_buttons_4, ', '), &nbsp;</div></li><li><div>              'tabfocus_elements' =&gt; $set['tabfocus_elements'], &nbsp;</div></li><li><div>              'body_class' =&gt; $body_class&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Merge with the first part of the init array</span>&nbsp;</div></li><li><div>          $mceInit = array_merge( self::$first_init, $mceInit );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( is_array( $set['tinymce'] ) )&nbsp;</div></li><li><div>              $mceInit = array_merge( $mceInit, $set['tinymce'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * For people who really REALLY know what they're doing with TinyMCE</span>&nbsp;</div></li><li><div><span class="comment">           * You can modify $mceInit to add, remove, change elements of the config</span>&nbsp;</div></li><li><div><span class="comment">           * before tinyMCE.init. Setting &quot;valid_elements&quot;, &quot;invalid_elements&quot;</span>&nbsp;</div></li><li><div><span class="comment">           * and &quot;extended_valid_elements&quot; can be done through this filter. Best</span>&nbsp;</div></li><li><div><span class="comment">           * is to use the default cleanup by not specifying valid_elements, </span>&nbsp;</div></li><li><div><span class="comment">           * as TinyMCE checks against the full set of HTML 5.0 elements and attributes.</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          if ( $set['teeny'] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Filters the teenyMCE config before init.</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param array  $mceInit   An array with teenyMCE config.</span>&nbsp;</div></li><li><div><span class="comment">               * @param string $editor_id Unique editor identifier, e.g. 'content'.</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $mceInit = apply_filters( 'teeny_mce_before_init', $mceInit, $editor_id );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Filters the TinyMCE config before init.</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param array  $mceInit   An array with TinyMCE config.</span>&nbsp;</div></li><li><div><span class="comment">               * @param string $editor_id Unique editor identifier, e.g. 'content'.</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $mceInit = apply_filters( 'tiny_mce_before_init', $mceInit, $editor_id );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( $mceInit['toolbar3'] ) && ! empty( $mceInit['toolbar4'] ) ) {&nbsp;</div></li><li><div>              $mceInit['toolbar3'] = $mceInit['toolbar4'];&nbsp;</div></li><li><div>              $mceInit['toolbar4'] = '';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          self::$mce_settings[$editor_id] = $mceInit;&nbsp;</div></li><li><div>      } <span class="comment">// end if self::$this_tinymce</span>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @static</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $init</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private static function _parse_init($init) {&nbsp;</div></li><li><div>      $options = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $init as $k =&gt; $v ) {&nbsp;</div></li><li><div>          if ( is_bool($v) ) {&nbsp;</div></li><li><div>              $val = $v ? 'true' : 'false';&nbsp;</div></li><li><div>              $options .= $k . ':' . $val . ', ';&nbsp;</div></li><li><div>              continue;&nbsp;</div></li><li><div>          } elseif ( !empty($v) && is_string($v) && ( ('{' == $v{0} && '}' == $v{strlen($v) - 1}) || ('[' == $v{0} && ']' == $v{strlen($v) - 1}) || preg_match('/^\(?function ?\(/', $v) ) ) {&nbsp;</div></li><li><div>              $options .= $k . ':' . $v . ', ';&nbsp;</div></li><li><div>              continue;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $options .= $k . ':&quot;' . $v . '&quot;, ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return '{' . trim( $options, ' , ' ) . '}';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @static</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public static function enqueue_scripts() {&nbsp;</div></li><li><div>      if ( self::$has_tinymce )&nbsp;</div></li><li><div>          wp_enqueue_script('editor');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( self::$has_quicktags ) {&nbsp;</div></li><li><div>          wp_enqueue_script( 'quicktags' );&nbsp;</div></li><li><div>          wp_enqueue_style( 'buttons' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( in_array('wplink', self::$plugins, true) || in_array('link', self::$qt_buttons, true) ) {&nbsp;</div></li><li><div>          wp_enqueue_script('wplink');&nbsp;</div></li><li><div>          wp_enqueue_script( 'jquery-ui-autocomplete' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( self::$old_dfw_compat ) {&nbsp;</div></li><li><div>          wp_enqueue_script('wp-fullscreen-stub');&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( self::$has_medialib ) {&nbsp;</div></li><li><div>          add_thickbox();&nbsp;</div></li><li><div>          wp_enqueue_script( 'media-upload' );&nbsp;</div></li><li><div>          wp_enqueue_script( 'wp-embed' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Fires when scripts and styles are enqueued for the editor.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.9.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $to_load An array containing boolean values whether TinyMCE</span>&nbsp;</div></li><li><div><span class="comment">       *                       and Quicktags are being loaded.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      do_action( 'wp_enqueue_editor', array(&nbsp;</div></li><li><div>          'tinymce' =&gt; self::$has_tinymce, &nbsp;</div></li><li><div>          'quicktags' =&gt; self::$has_quicktags, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  private static function get_translation() {&nbsp;</div></li><li><div>      if ( empty( self::$translation ) ) {&nbsp;</div></li><li><div>          self::$translation = array(&nbsp;</div></li><li><div>          <span class="comment">// Default TinyMCE strings</span>&nbsp;</div></li><li><div>          'New document' =&gt; __( 'New document' ), &nbsp;</div></li><li><div>          'Formats' =&gt; _x( 'Formats', 'TinyMCE' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          'Headings' =&gt; _x( 'Headings', 'TinyMCE' ), &nbsp;</div></li><li><div>          'Heading 1' =&gt; array( __( 'Heading 1' ), 'access1' ), &nbsp;</div></li><li><div>          'Heading 2' =&gt; array( __( 'Heading 2' ), 'access2' ), &nbsp;</div></li><li><div>          'Heading 3' =&gt; array( __( 'Heading 3' ), 'access3' ), &nbsp;</div></li><li><div>          'Heading 4' =&gt; array( __( 'Heading 4' ), 'access4' ), &nbsp;</div></li><li><div>          'Heading 5' =&gt; array( __( 'Heading 5' ), 'access5' ), &nbsp;</div></li><li><div>          'Heading 6' =&gt; array( __( 'Heading 6' ), 'access6' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** translators: block tags */</span>&nbsp;</div></li><li><div>          'Blocks' =&gt; _x( 'Blocks', 'TinyMCE' ), &nbsp;</div></li><li><div>          'Paragraph' =&gt; array( __( 'Paragraph' ), 'access7' ), &nbsp;</div></li><li><div>          'Blockquote' =&gt; array( __( 'Blockquote' ), 'accessQ' ), &nbsp;</div></li><li><div>          'Div' =&gt; _x( 'Div', 'HTML tag' ), &nbsp;</div></li><li><div>          'Pre' =&gt; _x( 'Pre', 'HTML tag' ), &nbsp;</div></li><li><div>          'Preformatted' =&gt; _x( 'Preformatted', 'HTML tag' ), &nbsp;</div></li><li><div>          'Address' =&gt; _x( 'Address', 'HTML tag' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          'Inline' =&gt; _x( 'Inline', 'HTML elements' ), &nbsp;</div></li><li><div>          'Underline' =&gt; array( __( 'Underline' ), 'metaU' ), &nbsp;</div></li><li><div>          'Strikethrough' =&gt; array( __( 'Strikethrough' ), 'accessD' ), &nbsp;</div></li><li><div>          'Subscript' =&gt; __( 'Subscript' ), &nbsp;</div></li><li><div>          'Superscript' =&gt; __( 'Superscript' ), &nbsp;</div></li><li><div>          'Clear formatting' =&gt; __( 'Clear formatting' ), &nbsp;</div></li><li><div>          'Bold' =&gt; array( __( 'Bold' ), 'metaB' ), &nbsp;</div></li><li><div>          'Italic' =&gt; array( __( 'Italic' ), 'metaI' ), &nbsp;</div></li><li><div>          'Code' =&gt; array( __( 'Code' ), 'accessX' ), &nbsp;</div></li><li><div>          'Source code' =&gt; __( 'Source code' ), &nbsp;</div></li><li><div>          'Font Family' =&gt; __( 'Font Family' ), &nbsp;</div></li><li><div>          'Font Sizes' =&gt; __( 'Font Sizes' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          'Align center' =&gt; array( __( 'Align center' ), 'accessC' ), &nbsp;</div></li><li><div>          'Align right' =&gt; array( __( 'Align right' ), 'accessR' ), &nbsp;</div></li><li><div>          'Align left' =&gt; array( __( 'Align left' ), 'accessL' ), &nbsp;</div></li><li><div>          'Justify' =&gt; array( __( 'Justify' ), 'accessJ' ), &nbsp;</div></li><li><div>          'Increase indent' =&gt; __( 'Increase indent' ), &nbsp;</div></li><li><div>          'Decrease indent' =&gt; __( 'Decrease indent' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          'Cut' =&gt; array( __( 'Cut' ), 'metaX' ), &nbsp;</div></li><li><div>          'Copy' =&gt; array( __( 'Copy' ), 'metaC' ), &nbsp;</div></li><li><div>          'Paste' =&gt; array( __( 'Paste' ), 'metaV' ), &nbsp;</div></li><li><div>          'Select all' =&gt; array( __( 'Select all' ), 'metaA' ), &nbsp;</div></li><li><div>          'Undo' =&gt; array( __( 'Undo' ), 'metaZ' ), &nbsp;</div></li><li><div>          'Redo' =&gt; array( __( 'Redo' ), 'metaY' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          'Ok' =&gt; __( 'OK' ), &nbsp;</div></li><li><div>          'Cancel' =&gt; __( 'Cancel' ), &nbsp;</div></li><li><div>          'Close' =&gt; __( 'Close' ), &nbsp;</div></li><li><div>          'Visual aids' =&gt; __( 'Visual aids' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          'Bullet list' =&gt; array( __( 'Bulleted list' ), 'accessU' ), &nbsp;</div></li><li><div>          'Numbered list' =&gt; array( __( 'Numbered list' ), 'accessO' ), &nbsp;</div></li><li><div>          'Square' =&gt; _x( 'Square', 'list style' ), &nbsp;</div></li><li><div>          'Default' =&gt; _x( 'Default', 'list style' ), &nbsp;</div></li><li><div>          'Circle' =&gt; _x( 'Circle', 'list style' ), &nbsp;</div></li><li><div>          'Disc' =&gt; _x('Disc', 'list style' ), &nbsp;</div></li><li><div>          'Lower Greek' =&gt; _x( 'Lower Greek', 'list style' ), &nbsp;</div></li><li><div>          'Lower Alpha' =&gt; _x( 'Lower Alpha', 'list style' ), &nbsp;</div></li><li><div>          'Upper Alpha' =&gt; _x( 'Upper Alpha', 'list style' ), &nbsp;</div></li><li><div>          'Upper Roman' =&gt; _x( 'Upper Roman', 'list style' ), &nbsp;</div></li><li><div>          'Lower Roman' =&gt; _x( 'Lower Roman', 'list style' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Anchor plugin</span>&nbsp;</div></li><li><div>          'Name' =&gt; _x( 'Name', 'Name of link anchor (TinyMCE)' ), &nbsp;</div></li><li><div>          'Anchor' =&gt; _x( 'Anchor', 'Link anchor (TinyMCE)' ), &nbsp;</div></li><li><div>          'Anchors' =&gt; _x( 'Anchors', 'Link anchors (TinyMCE)' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Fullpage plugin</span>&nbsp;</div></li><li><div>          'Document properties' =&gt; __( 'Document properties' ), &nbsp;</div></li><li><div>          'Robots' =&gt; __( 'Robots' ), &nbsp;</div></li><li><div>          'Title' =&gt; __( 'Title' ), &nbsp;</div></li><li><div>          'Keywords' =&gt; __( 'Keywords' ), &nbsp;</div></li><li><div>          'Encoding' =&gt; __( 'Encoding' ), &nbsp;</div></li><li><div>          'Description' =&gt; __( 'Description' ), &nbsp;</div></li><li><div>          'Author' =&gt; __( 'Author' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Media, image plugins</span>&nbsp;</div></li><li><div>          'Insert/edit image' =&gt; array( __( 'Insert/edit image' ), 'accessM' ), &nbsp;</div></li><li><div>          'General' =&gt; __( 'General' ), &nbsp;</div></li><li><div>          'Advanced' =&gt; __( 'Advanced' ), &nbsp;</div></li><li><div>          'Source' =&gt; __( 'Source' ), &nbsp;</div></li><li><div>          'Border' =&gt; __( 'Border' ), &nbsp;</div></li><li><div>          'Constrain proportions' =&gt; __( 'Constrain proportions' ), &nbsp;</div></li><li><div>          'Vertical space' =&gt; __( 'Vertical space' ), &nbsp;</div></li><li><div>          'Image description' =&gt; __( 'Image description' ), &nbsp;</div></li><li><div>          'Style' =&gt; __( 'Style' ), &nbsp;</div></li><li><div>          'Dimensions' =&gt; __( 'Dimensions' ), &nbsp;</div></li><li><div>          'Insert image' =&gt; __( 'Insert image' ), &nbsp;</div></li><li><div>          'Insert date/time' =&gt; __( 'Insert date/time' ), &nbsp;</div></li><li><div>          'Insert/edit video' =&gt; __( 'Insert/edit video' ), &nbsp;</div></li><li><div>          'Poster' =&gt; __( 'Poster' ), &nbsp;</div></li><li><div>          'Alternative source' =&gt; __( 'Alternative source' ), &nbsp;</div></li><li><div>          'Paste your embed code below:' =&gt; __( 'Paste your embed code below:' ), &nbsp;</div></li><li><div>          'Insert video' =&gt; __( 'Insert video' ), &nbsp;</div></li><li><div>          'Embed' =&gt; __( 'Embed' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Each of these have a corresponding plugin</span>&nbsp;</div></li><li><div>          'Special character' =&gt; __( 'Special character' ), &nbsp;</div></li><li><div>          'Right to left' =&gt; _x( 'Right to left', 'editor button' ), &nbsp;</div></li><li><div>          'Left to right' =&gt; _x( 'Left to right', 'editor button' ), &nbsp;</div></li><li><div>          'Emoticons' =&gt; __( 'Emoticons' ), &nbsp;</div></li><li><div>          'Nonbreaking space' =&gt; __( 'Nonbreaking space' ), &nbsp;</div></li><li><div>          'Page break' =&gt; __( 'Page break' ), &nbsp;</div></li><li><div>          'Paste as text' =&gt; __( 'Paste as text' ), &nbsp;</div></li><li><div>          'Preview' =&gt; __( 'Preview' ), &nbsp;</div></li><li><div>          'Print' =&gt; __( 'Print' ), &nbsp;</div></li><li><div>          'Save' =&gt; __( 'Save' ), &nbsp;</div></li><li><div>          'Fullscreen' =&gt; __( 'Fullscreen' ), &nbsp;</div></li><li><div>          'Horizontal line' =&gt; __( 'Horizontal line' ), &nbsp;</div></li><li><div>          'Horizontal space' =&gt; __( 'Horizontal space' ), &nbsp;</div></li><li><div>          'Restore last draft' =&gt; __( 'Restore last draft' ), &nbsp;</div></li><li><div>          'Insert/edit link' =&gt; array( __( 'Insert/edit link' ), 'metaK' ), &nbsp;</div></li><li><div>          'Remove link' =&gt; array( __( 'Remove link' ), 'accessS' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          'Color' =&gt; __( 'Color' ), &nbsp;</div></li><li><div>          'Custom color' =&gt; __( 'Custom color' ), &nbsp;</div></li><li><div>          'Custom...' =&gt; _x( 'Custom...', 'label for custom color' ), <span class="comment">// no ellipsis</span>&nbsp;</div></li><li><div>          'No color' =&gt; __( 'No color' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Spelling, search/replace plugins</span>&nbsp;</div></li><li><div>          'Could not find the specified string.' =&gt; __( 'Could not find the specified string.' ), &nbsp;</div></li><li><div>          'Replace' =&gt; _x( 'Replace', 'find/replace' ), &nbsp;</div></li><li><div>          'Next' =&gt; _x( 'Next', 'find/replace' ), &nbsp;</div></li><li><div>          <span class="comment">/** translators: previous */</span>&nbsp;</div></li><li><div>          'Prev' =&gt; _x( 'Prev', 'find/replace' ), &nbsp;</div></li><li><div>          'Whole words' =&gt; _x( 'Whole words', 'find/replace' ), &nbsp;</div></li><li><div>          'Find and replace' =&gt; __( 'Find and replace' ), &nbsp;</div></li><li><div>          'Replace with' =&gt; _x('Replace with', 'find/replace' ), &nbsp;</div></li><li><div>          'Find' =&gt; _x( 'Find', 'find/replace' ), &nbsp;</div></li><li><div>          'Replace all' =&gt; _x( 'Replace all', 'find/replace' ), &nbsp;</div></li><li><div>          'Match case' =&gt; __( 'Match case' ), &nbsp;</div></li><li><div>          'Spellcheck' =&gt; __( 'Check Spelling' ), &nbsp;</div></li><li><div>          'Finish' =&gt; _x( 'Finish', 'spellcheck' ), &nbsp;</div></li><li><div>          'Ignore all' =&gt; _x( 'Ignore all', 'spellcheck' ), &nbsp;</div></li><li><div>          'Ignore' =&gt; _x( 'Ignore', 'spellcheck' ), &nbsp;</div></li><li><div>          'Add to Dictionary' =&gt; __( 'Add to Dictionary' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// TinyMCE tables</span>&nbsp;</div></li><li><div>          'Insert table' =&gt; __( 'Insert table' ), &nbsp;</div></li><li><div>          'Delete table' =&gt; __( 'Delete table' ), &nbsp;</div></li><li><div>          'Table properties' =&gt; __( 'Table properties' ), &nbsp;</div></li><li><div>          'Row properties' =&gt; __( 'Table row properties' ), &nbsp;</div></li><li><div>          'Cell properties' =&gt; __( 'Table cell properties' ), &nbsp;</div></li><li><div>          'Border color' =&gt; __( 'Border color' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          'Row' =&gt; __( 'Row' ), &nbsp;</div></li><li><div>          'Rows' =&gt; __( 'Rows' ), &nbsp;</div></li><li><div>          'Column' =&gt; _x( 'Column', 'table column' ), &nbsp;</div></li><li><div>          'Cols' =&gt; _x( 'Cols', 'table columns' ), &nbsp;</div></li><li><div>          'Cell' =&gt; _x( 'Cell', 'table cell' ), &nbsp;</div></li><li><div>          'Header cell' =&gt; __( 'Header cell' ), &nbsp;</div></li><li><div>          'Header' =&gt; _x( 'Header', 'table header' ), &nbsp;</div></li><li><div>          'Body' =&gt; _x( 'Body', 'table body' ), &nbsp;</div></li><li><div>          'Footer' =&gt; _x( 'Footer', 'table footer' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          'Insert row before' =&gt; __( 'Insert row before' ), &nbsp;</div></li><li><div>          'Insert row after' =&gt; __( 'Insert row after' ), &nbsp;</div></li><li><div>          'Insert column before' =&gt; __( 'Insert column before' ), &nbsp;</div></li><li><div>          'Insert column after' =&gt; __( 'Insert column after' ), &nbsp;</div></li><li><div>          'Paste row before' =&gt; __( 'Paste table row before' ), &nbsp;</div></li><li><div>          'Paste row after' =&gt; __( 'Paste table row after' ), &nbsp;</div></li><li><div>          'Delete row' =&gt; __( 'Delete row' ), &nbsp;</div></li><li><div>          'Delete column' =&gt; __( 'Delete column' ), &nbsp;</div></li><li><div>          'Cut row' =&gt; __( 'Cut table row' ), &nbsp;</div></li><li><div>          'Copy row' =&gt; __( 'Copy table row' ), &nbsp;</div></li><li><div>          'Merge cells' =&gt; __( 'Merge table cells' ), &nbsp;</div></li><li><div>          'Split cell' =&gt; __( 'Split table cell' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          'Height' =&gt; __( 'Height' ), &nbsp;</div></li><li><div>          'Width' =&gt; __( 'Width' ), &nbsp;</div></li><li><div>          'Caption' =&gt; __( 'Caption' ), &nbsp;</div></li><li><div>          'Alignment' =&gt; __( 'Alignment' ), &nbsp;</div></li><li><div>          'H Align' =&gt; _x( 'H Align', 'horizontal table cell alignment' ), &nbsp;</div></li><li><div>          'Left' =&gt; __( 'Left' ), &nbsp;</div></li><li><div>          'Center' =&gt; __( 'Center' ), &nbsp;</div></li><li><div>          'Right' =&gt; __( 'Right' ), &nbsp;</div></li><li><div>          'None' =&gt; _x( 'None', 'table cell alignment attribute' ), &nbsp;</div></li><li><div>          'V Align' =&gt; _x( 'V Align', 'vertical table cell alignment' ), &nbsp;</div></li><li><div>          'Top' =&gt; __( 'Top' ), &nbsp;</div></li><li><div>          'Middle' =&gt; __( 'Middle' ), &nbsp;</div></li><li><div>          'Bottom' =&gt; __( 'Bottom' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          'Row group' =&gt; __( 'Row group' ), &nbsp;</div></li><li><div>          'Column group' =&gt; __( 'Column group' ), &nbsp;</div></li><li><div>          'Row type' =&gt; __( 'Row type' ), &nbsp;</div></li><li><div>          'Cell type' =&gt; __( 'Cell type' ), &nbsp;</div></li><li><div>          'Cell padding' =&gt; __( 'Cell padding' ), &nbsp;</div></li><li><div>          'Cell spacing' =&gt; __( 'Cell spacing' ), &nbsp;</div></li><li><div>          'Scope' =&gt; _x( 'Scope', 'table cell scope attribute' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          'Insert template' =&gt; _x( 'Insert template', 'TinyMCE' ), &nbsp;</div></li><li><div>          'Templates' =&gt; _x( 'Templates', 'TinyMCE' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          'Background color' =&gt; __( 'Background color' ), &nbsp;</div></li><li><div>          'Text color' =&gt; __( 'Text color' ), &nbsp;</div></li><li><div>          'Show blocks' =&gt; _x( 'Show blocks', 'editor button' ), &nbsp;</div></li><li><div>          'Show invisible characters' =&gt; __( 'Show invisible characters' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** translators: word count */</span>&nbsp;</div></li><li><div>          'Words: {0}' =&gt; sprintf( __( 'Words: %s' ), '{0}' ), &nbsp;</div></li><li><div>          'Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.' =&gt; __( 'Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.' ) . &quot;\n\n&quot; . __( 'If you&#8217;re looking to paste rich content from Microsoft Word, try turning this option off. The editor will clean up text pasted from Word automatically.' ), &nbsp;</div></li><li><div>          'Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help' =&gt; __( 'Rich Text Area. Press Alt-Shift-H for help.' ), &nbsp;</div></li><li><div>          'Rich Text Area. Press Control-Option-H for help.' =&gt; __( 'Rich Text Area. Press Control-Option-H for help.' ), &nbsp;</div></li><li><div>          'You have unsaved changes are you sure you want to navigate away?' =&gt; __( 'The changes you made will be lost if you navigate away from this page.' ), &nbsp;</div></li><li><div>          'Your browser doesn\'t support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.' =&gt; __( 'Your browser does not support direct access to the clipboard. Please use keyboard shortcuts or your browser&#8217;s edit menu instead.' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// TinyMCE menus</span>&nbsp;</div></li><li><div>          'Insert' =&gt; _x( 'Insert', 'TinyMCE menu' ), &nbsp;</div></li><li><div>          'File' =&gt; _x( 'File', 'TinyMCE menu' ), &nbsp;</div></li><li><div>          'Edit' =&gt; _x( 'Edit', 'TinyMCE menu' ), &nbsp;</div></li><li><div>          'Tools' =&gt; _x( 'Tools', 'TinyMCE menu' ), &nbsp;</div></li><li><div>          'View' =&gt; _x( 'View', 'TinyMCE menu' ), &nbsp;</div></li><li><div>          'Table' =&gt; _x( 'Table', 'TinyMCE menu' ), &nbsp;</div></li><li><div>          'Format' =&gt; _x( 'Format', 'TinyMCE menu' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// WordPress strings</span>&nbsp;</div></li><li><div>          'Toolbar Toggle' =&gt; array( __( 'Toolbar Toggle' ), 'accessZ' ), &nbsp;</div></li><li><div>          'Insert Read More tag' =&gt; array( __( 'Insert Read More tag' ), 'accessT' ), &nbsp;</div></li><li><div>          'Insert Page Break tag' =&gt; array( __( 'Insert Page Break tag' ), 'accessP' ), &nbsp;</div></li><li><div>          'Read more...' =&gt; __( 'Read more...' ), <span class="comment">// Title on the placeholder inside the editor (no ellipsis)</span>&nbsp;</div></li><li><div>          'Distraction-free writing mode' =&gt; array( __( 'Distraction-free writing mode' ), 'accessW' ), &nbsp;</div></li><li><div>          'No alignment' =&gt; __( 'No alignment' ), <span class="comment">// Tooltip for the 'alignnone' button in the image toolbar</span>&nbsp;</div></li><li><div>          'Remove' =&gt; __( 'Remove' ), <span class="comment">// Tooltip for the 'remove' button in the image toolbar</span>&nbsp;</div></li><li><div>          'Edit ' =&gt; __( 'Edit' ), <span class="comment">// Tooltip for the 'edit' button in the image toolbar</span>&nbsp;</div></li><li><div>          'Paste URL or type to search' =&gt; __( 'Paste URL or type to search' ), <span class="comment">// Placeholder for the inline link dialog</span>&nbsp;</div></li><li><div>          'Apply' =&gt; __( 'Apply' ), <span class="comment">// Tooltip for the 'apply' button in the inline link dialog</span>&nbsp;</div></li><li><div>          'Link options' =&gt; __( 'Link options' ), <span class="comment">// Tooltip for the 'link options' button in the inline link dialog</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Shortcuts help modal</span>&nbsp;</div></li><li><div>          'Keyboard Shortcuts' =&gt; array( __( 'Keyboard Shortcuts' ), 'accessH' ), &nbsp;</div></li><li><div>          'Default shortcuts, ' =&gt; __( 'Default shortcuts, ' ), &nbsp;</div></li><li><div>          'Additional shortcuts, ' =&gt; __( 'Additional shortcuts, ' ), &nbsp;</div></li><li><div>          'Focus shortcuts:' =&gt; __( 'Focus shortcuts:' ), &nbsp;</div></li><li><div>          'Inline toolbar (when an image, link or preview is selected)' =&gt; __( 'Inline toolbar (when an image, link or preview is selected)' ), &nbsp;</div></li><li><div>          'Editor menu (when enabled)' =&gt; __( 'Editor menu (when enabled)' ), &nbsp;</div></li><li><div>          'Editor toolbar' =&gt; __( 'Editor toolbar' ), &nbsp;</div></li><li><div>          'Elements path' =&gt; __( 'Elements path' ), &nbsp;</div></li><li><div>          'Ctrl + Alt + letter:' =&gt; __( 'Ctrl + Alt + letter:' ), &nbsp;</div></li><li><div>          'Shift + Alt + letter:' =&gt; __( 'Shift + Alt + letter:' ), &nbsp;</div></li><li><div>          'Cmd + letter:' =&gt; __( 'Cmd + letter:' ), &nbsp;</div></li><li><div>          'Ctrl + letter:' =&gt; __( 'Ctrl + letter:' ), &nbsp;</div></li><li><div>          'Letter' =&gt; __( 'Letter' ), &nbsp;</div></li><li><div>          'Action' =&gt; __( 'Action' ), &nbsp;</div></li><li><div>          'Warning: the link has been inserted but may have errors. Please test it.' =&gt; __( 'Warning: the link has been inserted but may have errors. Please test it.' ), &nbsp;</div></li><li><div>          'To move focus to other buttons use Tab or the arrow keys. To return focus to the editor press Escape or use one of the buttons.' =&gt;&nbsp;</div></li><li><div>              __( 'To move focus to other buttons use Tab or the arrow keys. To return focus to the editor press Escape or use one of the buttons.' ), &nbsp;</div></li><li><div>          'When starting a new paragraph with one of these formatting shortcuts followed by a space, the formatting will be applied automatically. Press Backspace or Escape to undo.' =&gt;&nbsp;</div></li><li><div>              __( 'When starting a new paragraph with one of these formatting shortcuts followed by a space, the formatting will be applied automatically. Press Backspace or Escape to undo.' ), &nbsp;</div></li><li><div>          'The following formatting shortcuts are replaced when pressing Enter. Press Escape or the Undo button to undo.' =&gt;&nbsp;</div></li><li><div>              __( 'The following formatting shortcuts are replaced when pressing Enter. Press Escape or the Undo button to undo.' ), &nbsp;</div></li><li><div>          'The next group of formatting shortcuts are applied as you type or when you insert them around plain text in the same paragraph. Press Escape or the Undo button to undo.' =&gt;&nbsp;</div></li><li><div>              __( 'The next group of formatting shortcuts are applied as you type or when you insert them around plain text in the same paragraph. Press Escape or the Undo button to undo.' ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Link plugin (not included):</span>&nbsp;</div></li><li><div><span class="comment">       *    Insert link</span>&nbsp;</div></li><li><div><span class="comment">       *    Target</span>&nbsp;</div></li><li><div><span class="comment">       *    New window</span>&nbsp;</div></li><li><div><span class="comment">       *    Text to display</span>&nbsp;</div></li><li><div><span class="comment">       *    The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?</span>&nbsp;</div></li><li><div><span class="comment">       *    The URL you entered seems to be an external link. Do you want to add the required http:\/\/ prefix?</span>&nbsp;</div></li><li><div><span class="comment">       *    Url</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return self::$translation;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Translates the default TinyMCE strings and returns them as JSON encoded object ready to be loaded with tinymce.addI18n().</span>&nbsp;</div></li><li><div><span class="comment">   * Can be used directly (_WP_Editors::wp_mce_translation()) by passing the same locale as set in the TinyMCE init object.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @static</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $mce_locale The locale used for the editor.</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $json_only optional Whether to include the JavaScript calls to tinymce.addI18n() and tinymce.ScriptLoader.markDone().</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Translation object, JSON encoded.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public static function wp_mce_translation( $mce_locale = '', $json_only = false ) {&nbsp;</div></li><li><div>      if ( ! $mce_locale ) {&nbsp;</div></li><li><div>          $mce_locale = self::$mce_locale;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $mce_translation = self::get_translation();&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      foreach ( $mce_translation as $name =&gt; $value ) {&nbsp;</div></li><li><div>          if ( is_array( $value ) ) {&nbsp;</div></li><li><div>              $mce_translation[$name] = $value[0];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters translated strings prepared for TinyMCE.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.9.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array  $mce_translation Key/value pairs of strings.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $mce_locale      Locale.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $mce_translation = apply_filters( 'wp_mce_translation', $mce_translation, $mce_locale );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $mce_translation as $key =&gt; $value ) {&nbsp;</div></li><li><div>          <span class="comment">// Remove strings that are not translated.</span>&nbsp;</div></li><li><div>          if ( $key === $value ) {&nbsp;</div></li><li><div>              unset( $mce_translation[$key] );&nbsp;</div></li><li><div>              continue;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( false !== strpos( $value, '&' ) ) {&nbsp;</div></li><li><div>              $mce_translation[$key] = html_entity_decode( $value, ENT_QUOTES, 'UTF-8' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set direction</span>&nbsp;</div></li><li><div>      if ( is_rtl() ) {&nbsp;</div></li><li><div>          $mce_translation['_dir'] = 'rtl';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $json_only ) {&nbsp;</div></li><li><div>          return wp_json_encode( $mce_translation );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $baseurl = self::$baseurl ? self::$baseurl : includes_url( 'js/tinymce' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return &quot;tinymce.addI18n( '$mce_locale', &quot; . wp_json_encode( $mce_translation ) . &quot;);\n&quot; .&nbsp;</div></li><li><div>          &quot;tinymce.ScriptLoader.markDone( '$baseurl/langs/$mce_locale.js' );\n&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @static</span>&nbsp;</div></li><li><div><span class="comment">   * @global string $tinymce_version</span>&nbsp;</div></li><li><div><span class="comment">   * @global bool   $concatenate_scripts</span>&nbsp;</div></li><li><div><span class="comment">   * @global bool   $compress_scripts</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public static function editor_js() {&nbsp;</div></li><li><div>      global $tinymce_version, $concatenate_scripts, $compress_scripts;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters &quot;tiny_mce_version&quot; is deprecated</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * The tiny_mce_version filter is not needed since external plugins are loaded directly by TinyMCE.</span>&nbsp;</div></li><li><div><span class="comment">       * These plugins can be refreshed by appending query string to the URL passed to &quot;mce_external_plugins&quot; filter.</span>&nbsp;</div></li><li><div><span class="comment">       * If the plugin has a popup dialog, a query string can be added to the button action that opens it (in the plugin's code).</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $version = 'ver=' . $tinymce_version;&nbsp;</div></li><li><div>      $tmce_on = !empty(self::$mce_settings);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! isset($concatenate_scripts) )&nbsp;</div></li><li><div>          script_concat_settings();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $compressed = $compress_scripts && $concatenate_scripts && isset($_SERVER['HTTP_ACCEPT_ENCODING'])&nbsp;</div></li><li><div>          && false !== stripos($_SERVER['HTTP_ACCEPT_ENCODING'], 'gzip');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $mceInit = $qtInit = '';&nbsp;</div></li><li><div>      if ( $tmce_on ) {&nbsp;</div></li><li><div>          foreach ( self::$mce_settings as $editor_id =&gt; $init ) {&nbsp;</div></li><li><div>              $options = self::_parse_init( $init );&nbsp;</div></li><li><div>              $mceInit .= &quot;'$editor_id':{$options}, &quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $mceInit = '{' . trim($mceInit, ', ') . '}';&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $mceInit = '{}';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !empty(self::$qt_settings) ) {&nbsp;</div></li><li><div>          foreach ( self::$qt_settings as $editor_id =&gt; $init ) {&nbsp;</div></li><li><div>              $options = self::_parse_init( $init );&nbsp;</div></li><li><div>              $qtInit .= &quot;'$editor_id':{$options}, &quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $qtInit = '{' . trim($qtInit, ', ') . '}';&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $qtInit = '{}';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $ref = array(&nbsp;</div></li><li><div>          'plugins' =&gt; implode( ', ', self::$plugins ), &nbsp;</div></li><li><div>          'theme' =&gt; 'modern', &nbsp;</div></li><li><div>          'language' =&gt; self::$mce_locale&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $suffix = SCRIPT_DEBUG ? '' : '.min';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Fires immediately before the TinyMCE settings are printed.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.2.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $mce_settings TinyMCE settings array.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      do_action( 'before_wp_tiny_mce', self::$mce_settings );&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>      tinyMCEPreInit = {&nbsp;</div></li><li><div>          baseURL: &quot;&lt;?php echo self::$baseurl; ?&gt;&quot;, &nbsp;</div></li><li><div>          suffix: &quot;&lt;?php echo $suffix; ?&gt;&quot;, &nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( self::$drag_drop_upload ) {&nbsp;</div></li><li><div>              echo 'dragDropUpload: true, ';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>          mceInit: &lt;?php echo $mceInit; ?&gt;, &nbsp;</div></li><li><div>          qtInit: &lt;?php echo $qtInit; ?&gt;, &nbsp;</div></li><li><div>          ref: &lt;?php echo self::_parse_init( $ref ); ?&gt;, &nbsp;</div></li><li><div>          load_ext: function(url, lang) {var sl=tinymce.ScriptLoader;sl.markDone(url+'/langs/'+lang+'.js');sl.markDone(url+'/langs/'+lang+'_dlg.js');}&nbsp;</div></li><li><div>      };&nbsp;</div></li><li><div>      &lt;/script&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $baseurl = self::$baseurl;&nbsp;</div></li><li><div>      <span class="comment">// Load tinymce.js when running from /src, else load wp-tinymce.js.gz (production) or tinymce.min.js (SCRIPT_DEBUG)</span>&nbsp;</div></li><li><div>      $mce_suffix = false !== strpos( get_bloginfo( 'version' ), '-src' ) ? '' : '.min';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $tmce_on ) {&nbsp;</div></li><li><div>          if ( $compressed ) {&nbsp;</div></li><li><div>              echo &quot;&lt;script type='text/javascript' src='{$baseurl}/wp-tinymce.php?c=1&amp;$version'&gt;&lt;/script&gt;\n&quot;;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              echo &quot;&lt;script type='text/javascript' src='{$baseurl}/tinymce{$mce_suffix}.js?$version'&gt;&lt;/script&gt;\n&quot;;&nbsp;</div></li><li><div>              echo &quot;&lt;script type='text/javascript' src='{$baseurl}/plugins/compat3x/plugin{$suffix}.js?$version'&gt;&lt;/script&gt;\n&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo &quot;&lt;script type='text/javascript'&gt;\n&quot; . self::wp_mce_translation() . &quot;&lt;/script&gt;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( self::$ext_plugins ) {&nbsp;</div></li><li><div>              <span class="comment">// Load the old-format English strings to prevent unsightly labels in old style popups</span>&nbsp;</div></li><li><div>              echo &quot;&lt;script type='text/javascript' src='{$baseurl}/langs/wp-langs-en.js?$version'&gt;&lt;/script&gt;\n&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Fires after tinymce.js is loaded, but before any TinyMCE editor</span>&nbsp;</div></li><li><div><span class="comment">       * instances are created.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.9.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $mce_settings TinyMCE settings array.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      do_action( 'wp_tiny_mce_init', self::$mce_settings );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( self::$ext_plugins )&nbsp;</div></li><li><div>          echo self::$ext_plugins . &quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! is_admin() )&nbsp;</div></li><li><div>          echo 'var ajaxurl = &quot;' . admin_url( 'admin-ajax.php', 'relative' ) . '&quot;;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      ( function() {&nbsp;</div></li><li><div>          var init, id, $wrap;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( typeof tinymce !== 'undefined' ) {&nbsp;</div></li><li><div>              for ( id in tinyMCEPreInit.mceInit ) {&nbsp;</div></li><li><div>                  init = tinyMCEPreInit.mceInit[id];&nbsp;</div></li><li><div>                  $wrap = tinymce.$( '#wp-' + id + '-wrap' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ( $wrap.hasClass( 'tmce-active' ) || ! tinyMCEPreInit.qtInit.hasOwnProperty( id ) ) && ! init.wp_skip_init ) {&nbsp;</div></li><li><div>                      tinymce.init( init );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( ! window.wpActiveEditor ) {&nbsp;</div></li><li><div>                          window.wpActiveEditor = id;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( typeof quicktags !== 'undefined' ) {&nbsp;</div></li><li><div>              for ( id in tinyMCEPreInit.qtInit ) {&nbsp;</div></li><li><div>                  quicktags( tinyMCEPreInit.qtInit[id] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! window.wpActiveEditor ) {&nbsp;</div></li><li><div>                      window.wpActiveEditor = id;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }());&nbsp;</div></li><li><div>      &lt;/script&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( in_array( 'wplink', self::$plugins, true ) || in_array( 'link', self::$qt_buttons, true ) ) {&nbsp;</div></li><li><div>          self::wp_link_dialog();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Fires after any core TinyMCE editor instances are created.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.2.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $mce_settings TinyMCE settings array.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      do_action( 'after_wp_tiny_mce', self::$mce_settings );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @static</span>&nbsp;</div></li><li><div><span class="comment">   * @global int $content_width</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public static function wp_fullscreen_html() {&nbsp;</div></li><li><div>      _deprecated_function( __FUNCTION__, '4.3.0' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Performs post queries for internal linking.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @static</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Optional. Accepts 'pagenum' and 's' (search) arguments.</span>&nbsp;</div></li><li><div><span class="comment">   * @return false|array Results.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public static function wp_link_query( $args = array() ) {&nbsp;</div></li><li><div>      $pts = get_post_types( array( 'public' =&gt; true ), 'objects' );&nbsp;</div></li><li><div>      $pt_names = array_keys( $pts );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $query = array(&nbsp;</div></li><li><div>          'post_type' =&gt; $pt_names, &nbsp;</div></li><li><div>          'suppress_filters' =&gt; true, &nbsp;</div></li><li><div>          'update_post_term_cache' =&gt; false, &nbsp;</div></li><li><div>          'update_post_meta_cache' =&gt; false, &nbsp;</div></li><li><div>          'post_status' =&gt; 'publish', &nbsp;</div></li><li><div>          'posts_per_page' =&gt; 20, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $args['pagenum'] = isset( $args['pagenum'] ) ? absint( $args['pagenum'] ) : 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $args['s'] ) )&nbsp;</div></li><li><div>          $query['s'] = $args['s'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $query['offset'] = $args['pagenum'] &gt; 1 ? $query['posts_per_page'] * ( $args['pagenum'] - 1 ) : 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the link query arguments.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * Allows modification of the link query arguments before querying.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @see WP_Query for a full list of arguments</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.7.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $query An array of WP_Query arguments.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $query = apply_filters( 'wp_link_query_args', $query );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Do main query.</span>&nbsp;</div></li><li><div>      $get_posts = new WP_Query;&nbsp;</div></li><li><div>      $posts = $get_posts-&gt;query( $query );&nbsp;</div></li><li><div>      <span class="comment">// Check if any posts were found.</span>&nbsp;</div></li><li><div>      if ( ! $get_posts-&gt;post_count )&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Build results.</span>&nbsp;</div></li><li><div>      $results = array();&nbsp;</div></li><li><div>      foreach ( $posts as $post ) {&nbsp;</div></li><li><div>          if ( 'post' == $post-&gt;post_type )&nbsp;</div></li><li><div>              $info = mysql2date( __( 'Y/m/d' ), $post-&gt;post_date );&nbsp;</div></li><li><div>          else&nbsp;</div></li><li><div>              $info = $pts[ $post-&gt;post_type ]-&gt;labels-&gt;singular_name;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $results[] = array(&nbsp;</div></li><li><div>              'ID' =&gt; $post-&gt;ID, &nbsp;</div></li><li><div>              'title' =&gt; trim( esc_html( strip_tags( get_the_title( $post ) ) ) ), &nbsp;</div></li><li><div>              'permalink' =&gt; get_permalink( $post-&gt;ID ), &nbsp;</div></li><li><div>              'info' =&gt; $info, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the link query results.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * Allows modification of the returned link query results.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.7.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @see 'wp_link_query_args' filter</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $results {</span>&nbsp;</div></li><li><div><span class="comment">       *     An associative array of query results.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       *     @type array {</span>&nbsp;</div></li><li><div><span class="comment">       *         @type int    $ID        Post ID.</span>&nbsp;</div></li><li><div><span class="comment">       *         @type string $title     The trimmed, escaped post title.</span>&nbsp;</div></li><li><div><span class="comment">       *         @type string $permalink Post permalink.</span>&nbsp;</div></li><li><div><span class="comment">       *         @type string $info      A 'Y/m/d'-formatted date for 'post' post type, </span>&nbsp;</div></li><li><div><span class="comment">       *                                 the 'singular_name' post type label otherwise.</span>&nbsp;</div></li><li><div><span class="comment">       *     }</span>&nbsp;</div></li><li><div><span class="comment">       * }</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $query  An array of WP_Query arguments.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'wp_link_query', $results, $query );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Dialog for internal linking.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @static</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public static function wp_link_dialog() {&nbsp;</div></li><li><div>      <span class="comment">// display: none is required here, see #WP27605</span>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;div id=&quot;wp-link-backdrop&quot; style=&quot;display: none&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>      &lt;div id=&quot;wp-link-wrap&quot; class=&quot;wp-core-ui&quot; style=&quot;display: none&quot; role=&quot;dialog&quot; aria-labelledby=&quot;link-modal-title&quot;&gt;&nbsp;</div></li><li><div>      &lt;form id=&quot;wp-link&quot; tabindex=&quot;-1&quot;&gt;&nbsp;</div></li><li><div>      &lt;?php wp_nonce_field( 'internal-linking', '_ajax_linking_nonce', false ); ?&gt;&nbsp;</div></li><li><div>      &lt;h1 id=&quot;link-modal-title&quot;&gt;&lt;?php _e( 'Insert/edit link' ) ?&gt;&lt;/h1&gt;&nbsp;</div></li><li><div>      &lt;button type=&quot;button&quot; id=&quot;wp-link-close&quot;&gt;&lt;span class=&quot;screen-reader-text&quot;&gt;&lt;?php _e( 'Close' ); ?&gt;&lt;/span&gt;&lt;/button&gt;&nbsp;</div></li><li><div>      &lt;div id=&quot;link-selector&quot;&gt;&nbsp;</div></li><li><div>          &lt;div id=&quot;link-options&quot;&gt;&nbsp;</div></li><li><div>              &lt;p class=&quot;howto&quot; id=&quot;wplink-enter-url&quot;&gt;&lt;?php _e( 'Enter the destination URL' ); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>              &lt;div&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;span&gt;&lt;?php _e( 'URL' ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;input id=&quot;wp-link-url&quot; type=&quot;text&quot; aria-describedby=&quot;wplink-enter-url&quot; /&gt;&lt;/label&gt;&nbsp;</div></li><li><div>              &lt;/div&gt;&nbsp;</div></li><li><div>              &lt;div class=&quot;wp-link-text-field&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;span&gt;&lt;?php _e( 'Link Text' ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;input id=&quot;wp-link-text&quot; type=&quot;text&quot; /&gt;&lt;/label&gt;&nbsp;</div></li><li><div>              &lt;/div&gt;&nbsp;</div></li><li><div>              &lt;div class=&quot;link-target&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;span&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;checkbox&quot; id=&quot;wp-link-target&quot; /&gt; &lt;?php _e( 'Open link in a new tab' ); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>              &lt;/div&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>          &lt;p class=&quot;howto&quot; id=&quot;wplink-link-existing-content&quot;&gt;&lt;?php _e( 'Or link to existing content' ); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>          &lt;div id=&quot;search-panel&quot;&gt;&nbsp;</div></li><li><div>              &lt;div class=&quot;link-search-wrapper&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&nbsp;</div></li><li><div>                      &lt;span class=&quot;search-label&quot;&gt;&lt;?php _e( 'Search' ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;input type=&quot;search&quot; id=&quot;wp-link-search&quot; class=&quot;link-search-field&quot; autocomplete=&quot;off&quot; aria-describedby=&quot;wplink-link-existing-content&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;span class=&quot;spinner&quot;&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;/label&gt;&nbsp;</div></li><li><div>              &lt;/div&gt;&nbsp;</div></li><li><div>              &lt;div id=&quot;search-results&quot; class=&quot;query-results&quot; tabindex=&quot;0&quot;&gt;&nbsp;</div></li><li><div>                  &lt;ul&gt;&lt;/ul&gt;&nbsp;</div></li><li><div>                  &lt;div class=&quot;river-waiting&quot;&gt;&nbsp;</div></li><li><div>                      &lt;span class=&quot;spinner&quot;&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;/div&gt;&nbsp;</div></li><li><div>              &lt;/div&gt;&nbsp;</div></li><li><div>              &lt;div id=&quot;most-recent-results&quot; class=&quot;query-results&quot; tabindex=&quot;0&quot;&gt;&nbsp;</div></li><li><div>                  &lt;div class=&quot;query-notice&quot; id=&quot;query-notice-message&quot;&gt;&nbsp;</div></li><li><div>                      &lt;em class=&quot;query-notice-default&quot;&gt;&lt;?php _e( 'No search term specified. Showing recent items.' ); ?&gt;&lt;/em&gt;&nbsp;</div></li><li><div>                      &lt;em class=&quot;query-notice-hint screen-reader-text&quot;&gt;&lt;?php _e( 'Search or use up and down arrow keys to select an item.' ); ?&gt;&lt;/em&gt;&nbsp;</div></li><li><div>                  &lt;/div&gt;&nbsp;</div></li><li><div>                  &lt;ul&gt;&lt;/ul&gt;&nbsp;</div></li><li><div>                  &lt;div class=&quot;river-waiting&quot;&gt;&nbsp;</div></li><li><div>                      &lt;span class=&quot;spinner&quot;&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;/div&gt;&nbsp;</div></li><li><div>               &lt;/div&gt;&nbsp;</div></li><li><div>           &lt;/div&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>      &lt;div class=&quot;submitbox&quot;&gt;&nbsp;</div></li><li><div>          &lt;div id=&quot;wp-link-cancel&quot;&gt;&nbsp;</div></li><li><div>              &lt;button type=&quot;button&quot; class=&quot;button&quot;&gt;&lt;?php _e( 'Cancel' ); ?&gt;&lt;/button&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>          &lt;div id=&quot;wp-link-update&quot;&gt;&nbsp;</div></li><li><div>              &lt;input type=&quot;submit&quot; value=&quot;&lt;?php esc_attr_e( 'Add Link' ); ?&gt;&quot; class=&quot;button button-primary&quot; id=&quot;wp-link-submit&quot; name=&quot;wp-link-submit&quot;&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>      &lt;/form&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>wordpress</li><li><span></span>file</li><li><span></span></li><li><span></span>wp-include</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>