<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="wordpress" data-version="4.7.3" data-type="file" data-id="4800"><head xmlns="http://www.w3.org/1999/xhtml"><title> wp-includes-kses | file | WordPress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, wordpress, 4.7.3" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.24"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=f444608ae5cc1fba0e355d631f04c54c' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.24' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/wp-includes-kses/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-includes-kses%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-includes-kses%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"wordpress-4.7.3-file-wp-includes-kses","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wp-includes-kses" class="blog single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 4.7.3." href="http://hookr.io/4.7.3/" class="H_VERSION"><span property="name">4.7.3</span></a><meta property="position" content="2"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wp-includes-kses</span><meta property="position" content="3"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="6309"><a href="http://hookr.io/4.7.3/all/" title="All">All <span class="count badge">6309</span></a></li><li class="" data-id="new" data-count="1"><a href="http://hookr.io/4.7.3/new/" title="New">New <span class="count badge">1</span></a></li><li class="" data-id="hooks" data-count="2532"><a href="http://hookr.io/4.7.3/hooks/" title="Hooks">Hooks <span class="count badge">2532</span></a></li><li class="" data-id="action" data-count="864"><a href="http://hookr.io/4.7.3/actions/" title="Actions">Actions <span class="count badge">864</span></a></li><li class="" data-id="filter" data-count="1668"><a href="http://hookr.io/4.7.3/filters/" title="Filters">Filters <span class="count badge">1668</span></a></li><li class="" data-id="class" data-count="351"><a href="http://hookr.io/4.7.3/classes/" title="Classes">Classes <span class="count badge">351</span></a></li><li class="" data-id="constant" data-count="566"><a href="http://hookr.io/4.7.3/constants/" title="Constants">Constants <span class="count badge">566</span></a></li><li class="" data-id="function" data-count="2852"><a href="http://hookr.io/4.7.3/functions/" title="Functions">Functions <span class="count badge">2852</span></a></li><li class="" data-id="shortcode" data-count="8"><a href="http://hookr.io/4.7.3/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">8</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class="active"><a href="http://hookr.io/all/" title="Core">Core</a></li><li class=""><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/wp-includes/kses.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * kses 0.2.2 - HTML/XHTML filter that only allows some elements and attributes</span>&nbsp;</div></li><li><div><span class="comment"> * Copyright (C) 2002, 2003, 2005  Ulf Harnhammar</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This program is free software and open source software; you can redistribute</span>&nbsp;</div></li><li><div><span class="comment"> * it and/or modify it under the terms of the GNU General Public License as</span>&nbsp;</div></li><li><div><span class="comment"> * published by the Free Software Foundation; either version 2 of the License, </span>&nbsp;</div></li><li><div><span class="comment"> * or (at your option) any later version.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This program is distributed in the hope that it will be useful, but WITHOUT</span>&nbsp;</div></li><li><div><span class="comment"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>&nbsp;</div></li><li><div><span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for</span>&nbsp;</div></li><li><div><span class="comment"> * more details.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * You should have received a copy of the GNU General Public License along</span>&nbsp;</div></li><li><div><span class="comment"> * with this program; if not, write to the Free Software Foundation, Inc., </span>&nbsp;</div></li><li><div><span class="comment"> * 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA</span>&nbsp;</div></li><li><div><span class="comment"> * http://www.gnu.org/licenses/gpl.html</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * [kses strips evil scripts!]</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Added wp_ prefix to avoid conflicts with existing kses users</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @version 0.2.2</span>&nbsp;</div></li><li><div><span class="comment"> * @copyright (C) 2002, 2003, 2005</span>&nbsp;</div></li><li><div><span class="comment"> * @author Ulf Harnhammar &lt;http://advogato.org/person/metaur/&gt;</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package External</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage KSES</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * You can override this in a plugin.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The {@see 'wp_kses_allowed_html'} filter is more powerful and supplies context.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * `CUSTOM_TAGS` is not recommended and should be considered deprecated.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see wp_kses_allowed_html()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! defined( 'CUSTOM_TAGS' ) )&nbsp;</div></li><li><div>  define( 'CUSTOM_TAGS', false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Ensure that these variables are added to the global namespace</span>&nbsp;</div></li><li><div><span class="comment">// (e.g. if using namespaces / autoload in the current PHP environment).</span>&nbsp;</div></li><li><div>global $allowedposttags, $allowedtags, $allowedentitynames;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( ! CUSTOM_TAGS ) {&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Kses global for default allowable HTML tags.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Can be override by using CUSTOM_TAGS constant.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @global array $allowedposttags</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $allowedposttags = array(&nbsp;</div></li><li><div>      'address' =&gt; array(), &nbsp;</div></li><li><div>      'a' =&gt; array(&nbsp;</div></li><li><div>          'href' =&gt; true, &nbsp;</div></li><li><div>          'rel' =&gt; true, &nbsp;</div></li><li><div>          'rev' =&gt; true, &nbsp;</div></li><li><div>          'name' =&gt; true, &nbsp;</div></li><li><div>          'target' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'abbr' =&gt; array(), &nbsp;</div></li><li><div>      'acronym' =&gt; array(), &nbsp;</div></li><li><div>      'area' =&gt; array(&nbsp;</div></li><li><div>          'alt' =&gt; true, &nbsp;</div></li><li><div>          'coords' =&gt; true, &nbsp;</div></li><li><div>          'href' =&gt; true, &nbsp;</div></li><li><div>          'nohref' =&gt; true, &nbsp;</div></li><li><div>          'shape' =&gt; true, &nbsp;</div></li><li><div>          'target' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'article' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'aside' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'audio' =&gt; array(&nbsp;</div></li><li><div>          'autoplay' =&gt; true, &nbsp;</div></li><li><div>          'controls' =&gt; true, &nbsp;</div></li><li><div>          'loop' =&gt; true, &nbsp;</div></li><li><div>          'muted' =&gt; true, &nbsp;</div></li><li><div>          'preload' =&gt; true, &nbsp;</div></li><li><div>          'src' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'b' =&gt; array(), &nbsp;</div></li><li><div>      'bdo' =&gt; array(&nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'big' =&gt; array(), &nbsp;</div></li><li><div>      'blockquote' =&gt; array(&nbsp;</div></li><li><div>          'cite' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'br' =&gt; array(), &nbsp;</div></li><li><div>      'button' =&gt; array(&nbsp;</div></li><li><div>          'disabled' =&gt; true, &nbsp;</div></li><li><div>          'name' =&gt; true, &nbsp;</div></li><li><div>          'type' =&gt; true, &nbsp;</div></li><li><div>          'value' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'caption' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'cite' =&gt; array(&nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'code' =&gt; array(), &nbsp;</div></li><li><div>      'col' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'char' =&gt; true, &nbsp;</div></li><li><div>          'charoff' =&gt; true, &nbsp;</div></li><li><div>          'span' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'valign' =&gt; true, &nbsp;</div></li><li><div>          'width' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'colgroup' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'char' =&gt; true, &nbsp;</div></li><li><div>          'charoff' =&gt; true, &nbsp;</div></li><li><div>          'span' =&gt; true, &nbsp;</div></li><li><div>          'valign' =&gt; true, &nbsp;</div></li><li><div>          'width' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'del' =&gt; array(&nbsp;</div></li><li><div>          'datetime' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'dd' =&gt; array(), &nbsp;</div></li><li><div>      'dfn' =&gt; array(), &nbsp;</div></li><li><div>      'details' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'open' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'div' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'dl' =&gt; array(), &nbsp;</div></li><li><div>      'dt' =&gt; array(), &nbsp;</div></li><li><div>      'em' =&gt; array(), &nbsp;</div></li><li><div>      'fieldset' =&gt; array(), &nbsp;</div></li><li><div>      'figure' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'figcaption' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'font' =&gt; array(&nbsp;</div></li><li><div>          'color' =&gt; true, &nbsp;</div></li><li><div>          'face' =&gt; true, &nbsp;</div></li><li><div>          'size' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'footer' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'form' =&gt; array(&nbsp;</div></li><li><div>          'action' =&gt; true, &nbsp;</div></li><li><div>          'accept' =&gt; true, &nbsp;</div></li><li><div>          'accept-charset' =&gt; true, &nbsp;</div></li><li><div>          'enctype' =&gt; true, &nbsp;</div></li><li><div>          'method' =&gt; true, &nbsp;</div></li><li><div>          'name' =&gt; true, &nbsp;</div></li><li><div>          'target' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'h1' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'h2' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'h3' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'h4' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'h5' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'h6' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'header' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'hgroup' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'hr' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'noshade' =&gt; true, &nbsp;</div></li><li><div>          'size' =&gt; true, &nbsp;</div></li><li><div>          'width' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'i' =&gt; array(), &nbsp;</div></li><li><div>      'img' =&gt; array(&nbsp;</div></li><li><div>          'alt' =&gt; true, &nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'border' =&gt; true, &nbsp;</div></li><li><div>          'height' =&gt; true, &nbsp;</div></li><li><div>          'hspace' =&gt; true, &nbsp;</div></li><li><div>          'longdesc' =&gt; true, &nbsp;</div></li><li><div>          'vspace' =&gt; true, &nbsp;</div></li><li><div>          'src' =&gt; true, &nbsp;</div></li><li><div>          'usemap' =&gt; true, &nbsp;</div></li><li><div>          'width' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'ins' =&gt; array(&nbsp;</div></li><li><div>          'datetime' =&gt; true, &nbsp;</div></li><li><div>          'cite' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'kbd' =&gt; array(), &nbsp;</div></li><li><div>      'label' =&gt; array(&nbsp;</div></li><li><div>          'for' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'legend' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'li' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'value' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'map' =&gt; array(&nbsp;</div></li><li><div>          'name' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'mark' =&gt; array(), &nbsp;</div></li><li><div>      'menu' =&gt; array(&nbsp;</div></li><li><div>          'type' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'nav' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'p' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'pre' =&gt; array(&nbsp;</div></li><li><div>          'width' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'q' =&gt; array(&nbsp;</div></li><li><div>          'cite' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      's' =&gt; array(), &nbsp;</div></li><li><div>      'samp' =&gt; array(), &nbsp;</div></li><li><div>      'span' =&gt; array(&nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'section' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'small' =&gt; array(), &nbsp;</div></li><li><div>      'strike' =&gt; array(), &nbsp;</div></li><li><div>      'strong' =&gt; array(), &nbsp;</div></li><li><div>      'sub' =&gt; array(), &nbsp;</div></li><li><div>      'summary' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'lang' =&gt; true, &nbsp;</div></li><li><div>          'xml:lang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'sup' =&gt; array(), &nbsp;</div></li><li><div>      'table' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'bgcolor' =&gt; true, &nbsp;</div></li><li><div>          'border' =&gt; true, &nbsp;</div></li><li><div>          'cellpadding' =&gt; true, &nbsp;</div></li><li><div>          'cellspacing' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'rules' =&gt; true, &nbsp;</div></li><li><div>          'summary' =&gt; true, &nbsp;</div></li><li><div>          'width' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'tbody' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'char' =&gt; true, &nbsp;</div></li><li><div>          'charoff' =&gt; true, &nbsp;</div></li><li><div>          'valign' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'td' =&gt; array(&nbsp;</div></li><li><div>          'abbr' =&gt; true, &nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'axis' =&gt; true, &nbsp;</div></li><li><div>          'bgcolor' =&gt; true, &nbsp;</div></li><li><div>          'char' =&gt; true, &nbsp;</div></li><li><div>          'charoff' =&gt; true, &nbsp;</div></li><li><div>          'colspan' =&gt; true, &nbsp;</div></li><li><div>          'dir' =&gt; true, &nbsp;</div></li><li><div>          'headers' =&gt; true, &nbsp;</div></li><li><div>          'height' =&gt; true, &nbsp;</div></li><li><div>          'nowrap' =&gt; true, &nbsp;</div></li><li><div>          'rowspan' =&gt; true, &nbsp;</div></li><li><div>          'scope' =&gt; true, &nbsp;</div></li><li><div>          'valign' =&gt; true, &nbsp;</div></li><li><div>          'width' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'textarea' =&gt; array(&nbsp;</div></li><li><div>          'cols' =&gt; true, &nbsp;</div></li><li><div>          'rows' =&gt; true, &nbsp;</div></li><li><div>          'disabled' =&gt; true, &nbsp;</div></li><li><div>          'name' =&gt; true, &nbsp;</div></li><li><div>          'readonly' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'tfoot' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'char' =&gt; true, &nbsp;</div></li><li><div>          'charoff' =&gt; true, &nbsp;</div></li><li><div>          'valign' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'th' =&gt; array(&nbsp;</div></li><li><div>          'abbr' =&gt; true, &nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'axis' =&gt; true, &nbsp;</div></li><li><div>          'bgcolor' =&gt; true, &nbsp;</div></li><li><div>          'char' =&gt; true, &nbsp;</div></li><li><div>          'charoff' =&gt; true, &nbsp;</div></li><li><div>          'colspan' =&gt; true, &nbsp;</div></li><li><div>          'headers' =&gt; true, &nbsp;</div></li><li><div>          'height' =&gt; true, &nbsp;</div></li><li><div>          'nowrap' =&gt; true, &nbsp;</div></li><li><div>          'rowspan' =&gt; true, &nbsp;</div></li><li><div>          'scope' =&gt; true, &nbsp;</div></li><li><div>          'valign' =&gt; true, &nbsp;</div></li><li><div>          'width' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'thead' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'char' =&gt; true, &nbsp;</div></li><li><div>          'charoff' =&gt; true, &nbsp;</div></li><li><div>          'valign' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'title' =&gt; array(), &nbsp;</div></li><li><div>      'tr' =&gt; array(&nbsp;</div></li><li><div>          'align' =&gt; true, &nbsp;</div></li><li><div>          'bgcolor' =&gt; true, &nbsp;</div></li><li><div>          'char' =&gt; true, &nbsp;</div></li><li><div>          'charoff' =&gt; true, &nbsp;</div></li><li><div>          'valign' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'track' =&gt; array(&nbsp;</div></li><li><div>          'default' =&gt; true, &nbsp;</div></li><li><div>          'kind' =&gt; true, &nbsp;</div></li><li><div>          'label' =&gt; true, &nbsp;</div></li><li><div>          'src' =&gt; true, &nbsp;</div></li><li><div>          'srclang' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'tt' =&gt; array(), &nbsp;</div></li><li><div>      'u' =&gt; array(), &nbsp;</div></li><li><div>      'ul' =&gt; array(&nbsp;</div></li><li><div>          'type' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'ol' =&gt; array(&nbsp;</div></li><li><div>          'start' =&gt; true, &nbsp;</div></li><li><div>          'type' =&gt; true, &nbsp;</div></li><li><div>          'reversed' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'var' =&gt; array(), &nbsp;</div></li><li><div>      'video' =&gt; array(&nbsp;</div></li><li><div>          'autoplay' =&gt; true, &nbsp;</div></li><li><div>          'controls' =&gt; true, &nbsp;</div></li><li><div>          'height' =&gt; true, &nbsp;</div></li><li><div>          'loop' =&gt; true, &nbsp;</div></li><li><div>          'muted' =&gt; true, &nbsp;</div></li><li><div>          'poster' =&gt; true, &nbsp;</div></li><li><div>          'preload' =&gt; true, &nbsp;</div></li><li><div>          'src' =&gt; true, &nbsp;</div></li><li><div>          'width' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Kses allowed HTML elements.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @global array $allowedtags</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $allowedtags = array(&nbsp;</div></li><li><div>      'a' =&gt; array(&nbsp;</div></li><li><div>          'href' =&gt; true, &nbsp;</div></li><li><div>          'title' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'abbr' =&gt; array(&nbsp;</div></li><li><div>          'title' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'acronym' =&gt; array(&nbsp;</div></li><li><div>          'title' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'b' =&gt; array(), &nbsp;</div></li><li><div>      'blockquote' =&gt; array(&nbsp;</div></li><li><div>          'cite' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'cite' =&gt; array(), &nbsp;</div></li><li><div>      'code' =&gt; array(), &nbsp;</div></li><li><div>      'del' =&gt; array(&nbsp;</div></li><li><div>          'datetime' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'em' =&gt; array(), &nbsp;</div></li><li><div>      'i' =&gt; array(), &nbsp;</div></li><li><div>      'q' =&gt; array(&nbsp;</div></li><li><div>          'cite' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      's' =&gt; array(), &nbsp;</div></li><li><div>      'strike' =&gt; array(), &nbsp;</div></li><li><div>      'strong' =&gt; array(), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $allowedentitynames = array(&nbsp;</div></li><li><div>      'nbsp', 'iexcl', 'cent', 'pound', 'curren', 'yen', &nbsp;</div></li><li><div>      'brvbar', 'sect', 'uml', 'copy', 'ordf', 'laquo', &nbsp;</div></li><li><div>      'not', 'shy', 'reg', 'macr', 'deg', 'plusmn', &nbsp;</div></li><li><div>      'acute', 'micro', 'para', 'middot', 'cedil', 'ordm', &nbsp;</div></li><li><div>      'raquo', 'iquest', 'Agrave', 'Aacute', 'Acirc', 'Atilde', &nbsp;</div></li><li><div>      'Auml', 'Aring', 'AElig', 'Ccedil', 'Egrave', 'Eacute', &nbsp;</div></li><li><div>      'Ecirc', 'Euml', 'Igrave', 'Iacute', 'Icirc', 'Iuml', &nbsp;</div></li><li><div>      'ETH', 'Ntilde', 'Ograve', 'Oacute', 'Ocirc', 'Otilde', &nbsp;</div></li><li><div>      'Ouml', 'times', 'Oslash', 'Ugrave', 'Uacute', 'Ucirc', &nbsp;</div></li><li><div>      'Uuml', 'Yacute', 'THORN', 'szlig', 'agrave', 'aacute', &nbsp;</div></li><li><div>      'acirc', 'atilde', 'auml', 'aring', 'aelig', 'ccedil', &nbsp;</div></li><li><div>      'egrave', 'eacute', 'ecirc', 'euml', 'igrave', 'iacute', &nbsp;</div></li><li><div>      'icirc', 'iuml', 'eth', 'ntilde', 'ograve', 'oacute', &nbsp;</div></li><li><div>      'ocirc', 'otilde', 'ouml', 'divide', 'oslash', 'ugrave', &nbsp;</div></li><li><div>      'uacute', 'ucirc', 'uuml', 'yacute', 'thorn', 'yuml', &nbsp;</div></li><li><div>      'quot', 'amp', 'lt', 'gt', 'apos', 'OElig', &nbsp;</div></li><li><div>      'oelig', 'Scaron', 'scaron', 'Yuml', 'circ', 'tilde', &nbsp;</div></li><li><div>      'ensp', 'emsp', 'thinsp', 'zwnj', 'zwj', 'lrm', &nbsp;</div></li><li><div>      'rlm', 'ndash', 'mdash', 'lsquo', 'rsquo', 'sbquo', &nbsp;</div></li><li><div>      'ldquo', 'rdquo', 'bdquo', 'dagger', 'Dagger', 'permil', &nbsp;</div></li><li><div>      'lsaquo', 'rsaquo', 'euro', 'fnof', 'Alpha', 'Beta', &nbsp;</div></li><li><div>      'Gamma', 'Delta', 'Epsilon', 'Zeta', 'Eta', 'Theta', &nbsp;</div></li><li><div>      'Iota', 'Kappa', 'Lambda', 'Mu', 'Nu', 'Xi', &nbsp;</div></li><li><div>      'Omicron', 'Pi', 'Rho', 'Sigma', 'Tau', 'Upsilon', &nbsp;</div></li><li><div>      'Phi', 'Chi', 'Psi', 'Omega', 'alpha', 'beta', &nbsp;</div></li><li><div>      'gamma', 'delta', 'epsilon', 'zeta', 'eta', 'theta', &nbsp;</div></li><li><div>      'iota', 'kappa', 'lambda', 'mu', 'nu', 'xi', &nbsp;</div></li><li><div>      'omicron', 'pi', 'rho', 'sigmaf', 'sigma', 'tau', &nbsp;</div></li><li><div>      'upsilon', 'phi', 'chi', 'psi', 'omega', 'thetasym', &nbsp;</div></li><li><div>      'upsih', 'piv', 'bull', 'hellip', 'prime', 'Prime', &nbsp;</div></li><li><div>      'oline', 'frasl', 'weierp', 'image', 'real', 'trade', &nbsp;</div></li><li><div>      'alefsym', 'larr', 'uarr', 'rarr', 'darr', 'harr', &nbsp;</div></li><li><div>      'crarr', 'lArr', 'uArr', 'rArr', 'dArr', 'hArr', &nbsp;</div></li><li><div>      'forall', 'part', 'exist', 'empty', 'nabla', 'isin', &nbsp;</div></li><li><div>      'notin', 'ni', 'prod', 'sum', 'minus', 'lowast', &nbsp;</div></li><li><div>      'radic', 'prop', 'infin', 'ang', 'and', 'or', &nbsp;</div></li><li><div>      'cap', 'cup', 'int', 'sim', 'cong', 'asymp', &nbsp;</div></li><li><div>      'ne', 'equiv', 'le', 'ge', 'sub', 'sup', &nbsp;</div></li><li><div>      'nsub', 'sube', 'supe', 'oplus', 'otimes', 'perp', &nbsp;</div></li><li><div>      'sdot', 'lceil', 'rceil', 'lfloor', 'rfloor', 'lang', &nbsp;</div></li><li><div>      'rang', 'loz', 'spades', 'clubs', 'hearts', 'diams', &nbsp;</div></li><li><div>      'sup1', 'sup2', 'sup3', 'frac14', 'frac12', 'frac34', &nbsp;</div></li><li><div>      'there4', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $allowedposttags = array_map( '_wp_add_global_attributes', $allowedposttags );&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  $allowedtags = wp_kses_array_lc( $allowedtags );&nbsp;</div></li><li><div>  $allowedposttags = wp_kses_array_lc( $allowedposttags );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Filters content and keeps only allowable HTML elements.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function makes sure that only the allowed HTML element names, attribute</span>&nbsp;</div></li><li><div><span class="comment"> * names and attribute values plus only sane HTML entities will occur in</span>&nbsp;</div></li><li><div><span class="comment"> * $string. You have to remove any slashes from PHP's magic quotes before you</span>&nbsp;</div></li><li><div><span class="comment"> * call this function.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The default allowed protocols are 'http', 'https', 'ftp', 'mailto', 'news', </span>&nbsp;</div></li><li><div><span class="comment"> * 'irc', 'gopher', 'nntp', 'feed', 'telnet, 'mms', 'rtsp' and 'svn'. This</span>&nbsp;</div></li><li><div><span class="comment"> * covers all common link protocols, except for 'javascript' which should not</span>&nbsp;</div></li><li><div><span class="comment"> * be allowed for untrusted users.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string            Content to filter through kses</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $allowed_html      List of allowed HTML elements</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $allowed_protocols Optional. Allowed protocol in links.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Filtered content with only allowed HTML elements</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses( $string, $allowed_html, $allowed_protocols = array() ) {&nbsp;</div></li><li><div>  if ( empty( $allowed_protocols ) )&nbsp;</div></li><li><div>      $allowed_protocols = wp_allowed_protocols();&nbsp;</div></li><li><div>  $string = wp_kses_no_null( $string, array( 'slash_zero' =&gt; 'keep' ) );&nbsp;</div></li><li><div>  $string = wp_kses_normalize_entities($string);&nbsp;</div></li><li><div>  $string = wp_kses_hook($string, $allowed_html, $allowed_protocols); <span class="comment">// WP changed the order of these funcs and added args to wp_kses_hook</span>&nbsp;</div></li><li><div>  return wp_kses_split($string, $allowed_html, $allowed_protocols);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Filters one attribute only and ensures its value is allowed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function has the advantage of being more secure than esc_attr() and can</span>&nbsp;</div></li><li><div><span class="comment"> * escape data in some situations where wp_kses() must strip the whole attribute.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.2.3</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string The 'whole' attribute, including name and value.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $element The element name to which the attribute belongs.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Filtered attribute.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_one_attr( $string, $element ) {&nbsp;</div></li><li><div>  $uris = array('xmlns', 'profile', 'href', 'src', 'cite', 'classid', 'codebase', 'data', 'usemap', 'longdesc', 'action');&nbsp;</div></li><li><div>  $allowed_html = wp_kses_allowed_html( 'post' );&nbsp;</div></li><li><div>  $allowed_protocols = wp_allowed_protocols();&nbsp;</div></li><li><div>  $string = wp_kses_no_null( $string, array( 'slash_zero' =&gt; 'keep' ) );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">// Preserve leading and trailing whitespace.</span>&nbsp;</div></li><li><div>  $matches = array();&nbsp;</div></li><li><div>  preg_match('/^\s*/', $string, $matches);&nbsp;</div></li><li><div>  $lead = $matches[0];&nbsp;</div></li><li><div>  preg_match('/\s*$/', $string, $matches);&nbsp;</div></li><li><div>  $trail = $matches[0];&nbsp;</div></li><li><div>  if ( empty( $trail ) ) {&nbsp;</div></li><li><div>      $string = substr( $string, strlen( $lead ) );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $string = substr( $string, strlen( $lead ), -strlen( $trail ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">// Parse attribute name and value from input.</span>&nbsp;</div></li><li><div>  $split = preg_split( '/\s*=\s*/', $string, 2 );&nbsp;</div></li><li><div>  $name = $split[0];&nbsp;</div></li><li><div>  if ( count( $split ) == 2 ) {&nbsp;</div></li><li><div>      $value = $split[1];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Remove quotes surrounding $value.</span>&nbsp;</div></li><li><div>      <span class="comment">// Also guarantee correct quoting in $string for this one attribute.</span>&nbsp;</div></li><li><div>      if ( '' == $value ) {&nbsp;</div></li><li><div>          $quote = '';&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $quote = $value[0];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if ( '&quot;' == $quote || &quot;'&quot; == $quote ) {&nbsp;</div></li><li><div>          if ( substr( $value, -1 ) != $quote ) {&nbsp;</div></li><li><div>              return '';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $value = substr( $value, 1, -1 );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $quote = '&quot;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Sanitize quotes, angle braces, and entities.</span>&nbsp;</div></li><li><div>      $value = esc_attr( $value );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Sanitize URI values.</span>&nbsp;</div></li><li><div>      if ( in_array( strtolower( $name ), $uris ) ) {&nbsp;</div></li><li><div>          $value = wp_kses_bad_protocol( $value, $allowed_protocols );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $string = &quot;$name=$quote$value$quote&quot;;&nbsp;</div></li><li><div>      $vless = 'n';&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $value = '';&nbsp;</div></li><li><div>      $vless = 'y';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">// Sanitize attribute by name.</span>&nbsp;</div></li><li><div>  wp_kses_attr_check( $name, $value, $string, $vless, $element, $allowed_html );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Restore whitespace.</span>&nbsp;</div></li><li><div>  return $lead . $string . $trail;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return a list of allowed tags and attributes for a given context.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $allowedposttags</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $allowedtags</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $allowedentitynames</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $context The context for which to retrieve tags.</span>&nbsp;</div></li><li><div><span class="comment"> *                        Allowed values are post, strip, data, entities, or</span>&nbsp;</div></li><li><div><span class="comment"> *                        the name of a field filter such as pre_user_description.</span>&nbsp;</div></li><li><div><span class="comment"> * @return array List of allowed tags and their allowed attributes.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_allowed_html( $context = '' ) {&nbsp;</div></li><li><div>  global $allowedposttags, $allowedtags, $allowedentitynames;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_array( $context ) ) {&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters HTML elements allowed for a given context.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.5.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $tags    Allowed tags, attributes, and/or entities.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $context Context to judge allowed tags by. Allowed values are 'post', </span>&nbsp;</div></li><li><div><span class="comment">       *                        'data', 'strip', 'entities', 'explicit', or the name of a filter.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'wp_kses_allowed_html', $context, 'explicit' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  switch ( $context ) {&nbsp;</div></li><li><div>      case 'post':&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** This filter is documented in wp-includes/kses.php */</span></span></span></span></span>&nbsp;</div></li><li><div>          return apply_filters( 'wp_kses_allowed_html', $allowedposttags, $context );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'user_description':&nbsp;</div></li><li><div>      case 'pre_user_description':&nbsp;</div></li><li><div>          $tags = $allowedtags;&nbsp;</div></li><li><div>          $tags['a']['rel'] = true;&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** This filter is documented in wp-includes/kses.php */</span></span></span></span></span>&nbsp;</div></li><li><div>          return apply_filters( 'wp_kses_allowed_html', $tags, $context );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'strip':&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** This filter is documented in wp-includes/kses.php */</span></span></span></span></span>&nbsp;</div></li><li><div>          return apply_filters( 'wp_kses_allowed_html', array(), $context );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'entities':&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** This filter is documented in wp-includes/kses.php */</span></span></span></span></span>&nbsp;</div></li><li><div>          return apply_filters( 'wp_kses_allowed_html', $allowedentitynames, $context);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'data':&nbsp;</div></li><li><div>      default:&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** This filter is documented in wp-includes/kses.php */</span></span></span></span></span>&nbsp;</div></li><li><div>          return apply_filters( 'wp_kses_allowed_html', $allowedtags, $context );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * You add any kses hooks here.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * There is currently only one kses WordPress hook, {@see 'pre_kses'}, and it is called here.</span>&nbsp;</div></li><li><div><span class="comment"> * All parameters are passed to the hooks and expected to receive a string.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string            Content to filter through kses</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $allowed_html      List of allowed HTML elements</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $allowed_protocols Allowed protocol in links</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Filtered content through {@see 'pre_kses'} hook.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_hook( $string, $allowed_html, $allowed_protocols ) {&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters content to be run through kses.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.3.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $string            Content to run through kses.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $allowed_html      Allowed HTML elements.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $allowed_protocols Allowed protocol in links.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'pre_kses', $string, $allowed_html, $allowed_protocols );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * This function returns kses' version number.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return string KSES Version Number</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_version() {&nbsp;</div></li><li><div>  return '0.2.2';&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Searches for HTML tags, no matter how malformed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * It also matches stray &quot;&gt;&quot; characters.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $pass_allowed_html</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $pass_allowed_protocols</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string            Content to filter</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $allowed_html      Allowed HTML elements</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $allowed_protocols Allowed protocols to keep</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Content with fixed HTML tags</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_split( $string, $allowed_html, $allowed_protocols ) {&nbsp;</div></li><li><div>  global $pass_allowed_html, $pass_allowed_protocols;&nbsp;</div></li><li><div>  $pass_allowed_html = $allowed_html;&nbsp;</div></li><li><div>  $pass_allowed_protocols = $allowed_protocols;&nbsp;</div></li><li><div>  return preg_replace_callback( '%(&lt;!--.*?(--&gt;|$))|(&lt;[^&gt;]*(&gt;|$)|&gt;)%', '_wp_kses_split_callback', $string );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Callback for wp_kses_split.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $pass_allowed_html</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $pass_allowed_protocols</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _wp_kses_split_callback( $match ) {&nbsp;</div></li><li><div>  global $pass_allowed_html, $pass_allowed_protocols;&nbsp;</div></li><li><div>  return wp_kses_split2( $match[0], $pass_allowed_html, $pass_allowed_protocols );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Callback for wp_kses_split for fixing malformed HTML tags.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function does a lot of work. It rejects some very malformed things like</span>&nbsp;</div></li><li><div><span class="comment"> * &lt;:::&gt;. It returns an empty string, if the element isn't allowed (look ma, no</span>&nbsp;</div></li><li><div><span class="comment"> * strip_tags()!). Otherwise it splits the tag into an element and an attribute</span>&nbsp;</div></li><li><div><span class="comment"> * list.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * After the tag is split into an element and an attribute list, it is run</span>&nbsp;</div></li><li><div><span class="comment"> * through another filter which will remove illegal attributes and once that is</span>&nbsp;</div></li><li><div><span class="comment"> * completed, will be returned.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string            Content to filter</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $allowed_html      Allowed HTML elements</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $allowed_protocols Allowed protocols to keep</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Fixed HTML element</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_split2($string, $allowed_html, $allowed_protocols) {&nbsp;</div></li><li><div>  $string = wp_kses_stripslashes($string);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if (substr($string, 0, 1) != '&lt;')&nbsp;</div></li><li><div>      return '&gt;';&nbsp;</div></li><li><div>  <span class="comment">// It matched a &quot;&gt;&quot; character</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( '&lt;!--' == substr( $string, 0, 4 ) ) {&nbsp;</div></li><li><div>      $string = str_replace( array('&lt;!--', '--&gt;'), '', $string );&nbsp;</div></li><li><div>      while ( $string != ($newstring = wp_kses($string, $allowed_html, $allowed_protocols)) )&nbsp;</div></li><li><div>          $string = $newstring;&nbsp;</div></li><li><div>      if ( $string == '' )&nbsp;</div></li><li><div>          return '';&nbsp;</div></li><li><div>      <span class="comment">// prevent multiple dashes in comments</span>&nbsp;</div></li><li><div>      $string = preg_replace('/--+/', '-', $string);&nbsp;</div></li><li><div>      <span class="comment">// prevent three dashes closing a comment</span>&nbsp;</div></li><li><div>      $string = preg_replace('/-$/', '', $string);&nbsp;</div></li><li><div>      return &quot;&lt;!--{$string}--&gt;&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  <span class="comment">// Allow HTML comments</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if (!preg_match('%^&lt;\s*(/\s*)?([a-zA-Z0-9-]+)([^&gt;]*)&gt;?$%', $string, $matches))&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>  <span class="comment">// It's seriously malformed</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $slash = trim($matches[1]);&nbsp;</div></li><li><div>  $elem = $matches[2];&nbsp;</div></li><li><div>  $attrlist = $matches[3];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! is_array( $allowed_html ) )&nbsp;</div></li><li><div>      $allowed_html = wp_kses_allowed_html( $allowed_html );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! isset($allowed_html[strtolower($elem)]) )&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>  <span class="comment">// They are using a not allowed HTML element</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ($slash != '')&nbsp;</div></li><li><div>      return &quot;&lt;/$elem&gt;&quot;;&nbsp;</div></li><li><div>  <span class="comment">// No attributes are allowed for closing elements</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return wp_kses_attr( $elem, $attrlist, $allowed_html, $allowed_protocols );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Removes all attributes, if none are allowed for this element.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * If some are allowed it calls wp_kses_hair() to split them further, and then</span>&nbsp;</div></li><li><div><span class="comment"> * it builds up new HTML code from the data that kses_hair() returns. It also</span>&nbsp;</div></li><li><div><span class="comment"> * removes &quot;&lt;&quot; and &quot;&gt;&quot; characters, if there are any left. One more thing it does</span>&nbsp;</div></li><li><div><span class="comment"> * is to check if the tag has a closing XHTML slash, and if it does, it puts one</span>&nbsp;</div></li><li><div><span class="comment"> * in the returned code as well.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $element           HTML element/tag</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $attr              HTML attributes from HTML element to closing HTML element tag</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $allowed_html      Allowed HTML elements</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $allowed_protocols Allowed protocols to keep</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Sanitized HTML element</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_attr($element, $attr, $allowed_html, $allowed_protocols) {&nbsp;</div></li><li><div>  if ( ! is_array( $allowed_html ) )&nbsp;</div></li><li><div>      $allowed_html = wp_kses_allowed_html( $allowed_html );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Is there a closing XHTML slash at the end of the attributes?</span></span>&nbsp;</div></li><li><div>  $xhtml_slash = '';&nbsp;</div></li><li><div>  if (preg_match('%\s*/\s*$%', $attr))&nbsp;</div></li><li><div>      $xhtml_slash = ' /';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Are any attributes allowed at all for this element?</span>&nbsp;</div></li><li><div>  if ( ! isset($allowed_html[strtolower($element)]) || count($allowed_html[strtolower($element)]) == 0 )&nbsp;</div></li><li><div>      return &quot;&lt;$element$xhtml_slash&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Split it</span></span>&nbsp;</div></li><li><div>  $attrarr = wp_kses_hair($attr, $allowed_protocols);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Go through $attrarr, and save the allowed attributes for this element</span>&nbsp;</div></li><li><div>  <span class="comment">// in $attr2</span>&nbsp;</div></li><li><div>  $attr2 = '';&nbsp;</div></li><li><div>  foreach ( $attrarr as $arreach ) {&nbsp;</div></li><li><div>      if ( wp_kses_attr_check( $arreach['name'], $arreach['value'], $arreach['whole'], $arreach['vless'], $element, $allowed_html ) ) {&nbsp;</div></li><li><div>          $attr2 .= ' '.$arreach['whole'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Remove any &quot;&lt;&quot; or &quot;&gt;&quot; characters</span>&nbsp;</div></li><li><div>  $attr2 = preg_replace('/[&lt;&gt;]/', '', $attr2);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return &quot;&lt;$element$attr2$xhtml_slash&gt;&quot;;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determine whether an attribute is allowed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.2.3</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $name The attribute name. Returns empty string when not allowed.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $value The attribute value. Returns a filtered value.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $whole The name=value input. Returns filtered input.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $vless 'y' when attribute like &quot;enabled&quot;, otherwise 'n'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $element The name of the element to which this attribute belongs.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $allowed_html The full list of allowed elements and attributes.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool Is the attribute allowed?</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_attr_check( &$name, &$value, &$whole, $vless, $element, $allowed_html ) {&nbsp;</div></li><li><div>  $allowed_attr = $allowed_html[strtolower( $element )];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $name_low = strtolower( $name );&nbsp;</div></li><li><div>  if ( ! isset( $allowed_attr[$name_low] ) || '' == $allowed_attr[$name_low] ) {&nbsp;</div></li><li><div>      $name = $value = $whole = '';&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'style' == $name_low ) {&nbsp;</div></li><li><div>      $new_value = safecss_filter_attr( $value );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $new_value ) ) {&nbsp;</div></li><li><div>          $name = $value = $whole = '';&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $whole = str_replace( $value, $new_value, $whole );&nbsp;</div></li><li><div>      $value = $new_value;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_array( $allowed_attr[$name_low] ) ) {&nbsp;</div></li><li><div>      <span class="comment">// there are some checks</span>&nbsp;</div></li><li><div>      foreach ( $allowed_attr[$name_low] as $currkey =&gt; $currval ) {&nbsp;</div></li><li><div>          if ( ! wp_kses_check_attr_val( $value, $vless, $currkey, $currval ) ) {&nbsp;</div></li><li><div>              $name = $value = $whole = '';&nbsp;</div></li><li><div>              return false;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return true;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Builds an attribute list from string containing attributes.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function does a lot of work. It parses an attribute list into an array</span>&nbsp;</div></li><li><div><span class="comment"> * with attribute data, and tries to do the right thing even if it gets weird</span>&nbsp;</div></li><li><div><span class="comment"> * input. It will add quotes around attribute values that don't have any quotes</span>&nbsp;</div></li><li><div><span class="comment"> * or apostrophes around them, to make it easier to produce HTML code that will</span>&nbsp;</div></li><li><div><span class="comment"> * conform to W3C's HTML specification. It will also remove bad URL protocols</span>&nbsp;</div></li><li><div><span class="comment"> * from attribute values. It also reduces duplicate attributes by using the</span>&nbsp;</div></li><li><div><span class="comment"> * attribute defined first (foo='bar' foo='baz' will result in foo='bar').</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $attr              Attribute list from HTML element to closing HTML element tag</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $allowed_protocols Allowed protocols to keep</span>&nbsp;</div></li><li><div><span class="comment"> * @return array List of attributes after parsing</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_hair($attr, $allowed_protocols) {&nbsp;</div></li><li><div>  $attrarr = array();&nbsp;</div></li><li><div>  $mode = 0;&nbsp;</div></li><li><div>  $attrname = '';&nbsp;</div></li><li><div>  $uris = array('xmlns', 'profile', 'href', 'src', 'cite', 'classid', 'codebase', 'data', 'usemap', 'longdesc', 'action');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Loop through the whole attribute list</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  while (strlen($attr) != 0) {&nbsp;</div></li><li><div>      $working = 0; <span class="comment">// Was the last operation successful?</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      switch ($mode) {&nbsp;</div></li><li><div>          case 0 : <span class="comment">// attribute name, href for instance</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( preg_match('/^([-a-zA-Z:]+)/', $attr, $match ) ) {&nbsp;</div></li><li><div>                  $attrname = $match[1];&nbsp;</div></li><li><div>                  $working = $mode = 1;&nbsp;</div></li><li><div>                  $attr = preg_replace( '/^[-a-zA-Z:]+/', '', $attr );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 1 : <span class="comment"><span class="comment">// equals sign</span> or valueless (&quot;selected&quot;)</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if (preg_match('/^\s*=\s*/', $attr)) <span class="comment">// equals sign</span>&nbsp;</div></li><li><div>                  {&nbsp;</div></li><li><div>                  $working = 1;&nbsp;</div></li><li><div>                  $mode = 2;&nbsp;</div></li><li><div>                  $attr = preg_replace('/^\s*=\s*/', '', $attr);&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if (preg_match('/^\s+/', $attr)) <span class="comment"><span class="comment">// value</span>less</span>&nbsp;</div></li><li><div>                  {&nbsp;</div></li><li><div>                  $working = 1;&nbsp;</div></li><li><div>                  $mode = 0;&nbsp;</div></li><li><div>                  if(false === array_key_exists($attrname, $attrarr)) {&nbsp;</div></li><li><div>                      $attrarr[$attrname] = array ('name' =&gt; $attrname, 'value' =&gt; '', 'whole' =&gt; $attrname, 'vless' =&gt; 'y');&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  $attr = preg_replace('/^\s+/', '', $attr);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 2 : <span class="comment">// attribute value, a URL after href= for instance</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if (preg_match('%^&quot;([^&quot;]*)&quot;(\s+|/?$)%', $attr, $match))&nbsp;</div></li><li><div>                  <span class="comment">// &quot;value&quot;</span>&nbsp;</div></li><li><div>                  {&nbsp;</div></li><li><div>                  $thisval = $match[1];&nbsp;</div></li><li><div>                  if ( in_array(strtolower($attrname), $uris) )&nbsp;</div></li><li><div>                      $thisval = wp_kses_bad_protocol($thisval, $allowed_protocols);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if(false === array_key_exists($attrname, $attrarr)) {&nbsp;</div></li><li><div>                      $attrarr[$attrname] = array ('name' =&gt; $attrname, 'value' =&gt; $thisval, 'whole' =&gt; &quot;$attrname=\&quot;$thisval\&quot;&quot;, 'vless' =&gt; 'n');&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  $working = 1;&nbsp;</div></li><li><div>                  $mode = 0;&nbsp;</div></li><li><div>                  $attr = preg_replace('/^&quot;[^&quot;]*&quot;(\s+|$)/', '', $attr);&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if (preg_match(&quot;%^'([^']*)'(\s+|/?$)%&quot;, $attr, $match))&nbsp;</div></li><li><div>                  <span class="comment">// 'value'</span>&nbsp;</div></li><li><div>                  {&nbsp;</div></li><li><div>                  $thisval = $match[1];&nbsp;</div></li><li><div>                  if ( in_array(strtolower($attrname), $uris) )&nbsp;</div></li><li><div>                      $thisval = wp_kses_bad_protocol($thisval, $allowed_protocols);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if(false === array_key_exists($attrname, $attrarr)) {&nbsp;</div></li><li><div>                      $attrarr[$attrname] = array ('name' =&gt; $attrname, 'value' =&gt; $thisval, 'whole' =&gt; &quot;$attrname='$thisval'&quot;, 'vless' =&gt; 'n');&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  $working = 1;&nbsp;</div></li><li><div>                  $mode = 0;&nbsp;</div></li><li><div>                  $attr = preg_replace(&quot;/^'[^']*'(\s+|$)/&quot;, '', $attr);&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if (preg_match(&quot;%^([^\s\&quot;']+)(\s+|/?$)%&quot;, $attr, $match))&nbsp;</div></li><li><div>                  <span class="comment">// value</span>&nbsp;</div></li><li><div>                  {&nbsp;</div></li><li><div>                  $thisval = $match[1];&nbsp;</div></li><li><div>                  if ( in_array(strtolower($attrname), $uris) )&nbsp;</div></li><li><div>                      $thisval = wp_kses_bad_protocol($thisval, $allowed_protocols);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if(false === array_key_exists($attrname, $attrarr)) {&nbsp;</div></li><li><div>                      $attrarr[$attrname] = array ('name' =&gt; $attrname, 'value' =&gt; $thisval, 'whole' =&gt; &quot;$attrname=\&quot;$thisval\&quot;&quot;, 'vless' =&gt; 'n');&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  <span class="comment">// We add quotes to conform to W3C's HTML spec.</span>&nbsp;</div></li><li><div>                  $working = 1;&nbsp;</div></li><li><div>                  $mode = 0;&nbsp;</div></li><li><div>                  $attr = preg_replace(&quot;%^[^\s\&quot;']+(\s+|$)%&quot;, '', $attr);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>      } <span class="comment"><span class="comment">// switch</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ($working == 0) <span class="comment">// not well formed, remove and try again</span>&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          $attr = wp_kses_html_error($attr);&nbsp;</div></li><li><div>          $mode = 0;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } <span class="comment">// while</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ($mode == 1 && false === array_key_exists($attrname, $attrarr))&nbsp;</div></li><li><div>      <span class="comment">// special case, for when the attribute list ends with a valueless</span>&nbsp;</div></li><li><div>      <span class="comment">// attribute like &quot;selected&quot;</span>&nbsp;</div></li><li><div>      $attrarr[$attrname] = array ('name' =&gt; $attrname, 'value' =&gt; '', 'whole' =&gt; $attrname, 'vless' =&gt; 'y');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $attrarr;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Finds all attributes of an HTML element.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Does not modify input.  May return &quot;evil&quot; output.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Based on wp_kses_split2() and wp_kses_attr()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.2.3</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $element HTML element/tag</span>&nbsp;</div></li><li><div><span class="comment"> * @return array|bool List of attributes found in $element. Returns false on failure.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_attr_parse( $element ) {&nbsp;</div></li><li><div>  $valid = preg_match('%^(&lt;\s*)(/\s*)?([a-zA-Z0-9]+\s*)([^&gt;]*)(&gt;?)$%', $element, $matches);&nbsp;</div></li><li><div>  if ( 1 !== $valid ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $begin =  $matches[1];&nbsp;</div></li><li><div>  $slash =  $matches[2];&nbsp;</div></li><li><div>  $elname = $matches[3];&nbsp;</div></li><li><div>  $attr =   $matches[4];&nbsp;</div></li><li><div>  $end =    $matches[5];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( '' !== $slash ) {&nbsp;</div></li><li><div>      <span class="comment">// Closing elements do not get parsed.</span>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Is there a closing XHTML slash at the end of the attributes?</span></span>&nbsp;</div></li><li><div>  if ( 1 === preg_match( '%\s*/\s*$%', $attr, $matches ) ) {&nbsp;</div></li><li><div>      $xhtml_slash = $matches[0];&nbsp;</div></li><li><div>      $attr = substr( $attr, 0, -strlen( $xhtml_slash ) );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $xhtml_slash = '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Split it</span></span>&nbsp;</div></li><li><div>  $attrarr = wp_kses_hair_parse( $attr );&nbsp;</div></li><li><div>  if ( false === $attrarr ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Make sure all input is returned by adding front and back matter.</span>&nbsp;</div></li><li><div>  array_unshift( $attrarr, $begin . $slash . $elname );&nbsp;</div></li><li><div>  array_push( $attrarr, $xhtml_slash . $end );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  return $attrarr;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Builds an attribute list from string containing attributes.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Does not modify input.  May return &quot;evil&quot; output.</span>&nbsp;</div></li><li><div><span class="comment"> * In case of unexpected input, returns false instead of stripping things.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Based on wp_kses_hair() but does not return a multi-dimensional array.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.2.3</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $attr Attribute list from HTML element to closing HTML element tag</span>&nbsp;</div></li><li><div><span class="comment"> * @return array|bool List of attributes found in $attr. Returns false on failure.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_hair_parse( $attr ) {&nbsp;</div></li><li><div>  if ( '' === $attr ) {&nbsp;</div></li><li><div>      return array();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $regex =&nbsp;</div></li><li><div>    '(?:'&nbsp;</div></li><li><div>  .     '[-a-zA-Z:]+'   <span class="comment">// Attribute name.</span>&nbsp;</div></li><li><div>  . '|'&nbsp;</div></li><li><div>  .     '\[\[?[^\[\]]+\]\]?' <span class="comment">// Shortcode in the name position implies unfiltered_html.</span>&nbsp;</div></li><li><div>  . ')'&nbsp;</div></li><li><div>  . '(?:'               <span class="comment">// Attribute value.</span>&nbsp;</div></li><li><div>  .     '\s*=\s*'       <span class="comment">// All values begin with '='</span>&nbsp;</div></li><li><div>  .     '(?:'&nbsp;</div></li><li><div>  .         '&quot;[^&quot;]*&quot;'   <span class="comment">// Double-quoted</span>&nbsp;</div></li><li><div>  .     '|'&nbsp;</div></li><li><div>  .         &quot;'[^']*'&quot;   <span class="comment">// Single-quoted</span>&nbsp;</div></li><li><div>  .     '|'&nbsp;</div></li><li><div>  .         '[^\s&quot;\']+' <span class="comment">// Non-quoted</span>&nbsp;</div></li><li><div>  .         '(?:\s|$)'  <span class="comment">// Must have a space</span>&nbsp;</div></li><li><div>  .     ')'&nbsp;</div></li><li><div>  . '|'&nbsp;</div></li><li><div>  .     '(?:\s|$)'      <span class="comment">// If attribute has no value, space is required.</span>&nbsp;</div></li><li><div>  . ')'&nbsp;</div></li><li><div>  . '\s*';              <span class="comment">// Trailing space is optional except as mentioned above.</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Although it is possible to reduce this procedure to a single regexp, </span>&nbsp;</div></li><li><div>  <span class="comment">// we must run that regexp twice to get exactly the expected result.</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $validation = &quot;%^($regex)+$%&quot;;&nbsp;</div></li><li><div>  $extraction = &quot;%$regex%&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 1 === preg_match( $validation, $attr ) ) {&nbsp;</div></li><li><div>      preg_match_all( $extraction, $attr, $attrarr );&nbsp;</div></li><li><div>      return $attrarr[0];&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Performs different checks for attribute values.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The currently implemented checks are &quot;maxlen&quot;, &quot;minlen&quot;, &quot;maxval&quot;, &quot;minval&quot;</span>&nbsp;</div></li><li><div><span class="comment"> * and &quot;valueless&quot;.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $value      Attribute value</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $vless      Whether the value is valueless. Use 'y' or 'n'</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $checkname  What $checkvalue is checking for.</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed  $checkvalue What constraint the value should pass</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool Whether check passes</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_check_attr_val($value, $vless, $checkname, $checkvalue) {&nbsp;</div></li><li><div>  $ok = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  switch (strtolower($checkname)) {&nbsp;</div></li><li><div>      case 'maxlen' :&nbsp;</div></li><li><div>          <span class="comment">// The maxlen check makes sure that the attribute value has a length not</span>&nbsp;</div></li><li><div>          <span class="comment">// greater than the given value. This can be used to avoid Buffer Overflows</span>&nbsp;</div></li><li><div>          <span class="comment">// in WWW clients and various Internet servers.</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if (strlen($value) &gt; $checkvalue)&nbsp;</div></li><li><div>              $ok = false;&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'minlen' :&nbsp;</div></li><li><div>          <span class="comment">// The minlen check makes sure that the attribute value has a length not</span>&nbsp;</div></li><li><div>          <span class="comment">// smaller than the given value.</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if (strlen($value) &lt; $checkvalue)&nbsp;</div></li><li><div>              $ok = false;&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'maxval' :&nbsp;</div></li><li><div>          <span class="comment">// The maxval check does two things: it checks that the attribute value is</span>&nbsp;</div></li><li><div>          <span class="comment">// an integer from 0 and up, without an excessive amount of zeroes or</span>&nbsp;</div></li><li><div>          <span class="comment">// whitespace (to avoid Buffer Overflows). It also checks that the attribute</span>&nbsp;</div></li><li><div>          <span class="comment">// value</span> is not greater than the given value.&nbsp;</div></li><li><div>          <span class="comment">// This check can be used to avoid Denial of Service attacks.</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if (!preg_match('/^\s{0, 6}[0-9]{1, 6}\s{0, 6}$/', $value))&nbsp;</div></li><li><div>              $ok = false;&nbsp;</div></li><li><div>          if ($value &gt; $checkvalue)&nbsp;</div></li><li><div>              $ok = false;&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'minval' :&nbsp;</div></li><li><div>          <span class="comment">// The minval check makes sure that the attribute value is a positive integer, </span>&nbsp;</div></li><li><div>          <span class="comment">// and that it is not smaller than the given value.</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if (!preg_match('/^\s{0, 6}[0-9]{1, 6}\s{0, 6}$/', $value))&nbsp;</div></li><li><div>              $ok = false;&nbsp;</div></li><li><div>          if ($value &lt; $checkvalue)&nbsp;</div></li><li><div>              $ok = false;&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'valueless' :&nbsp;</div></li><li><div>          <span class="comment">// The valueless check makes sure if the attribute has a value</span>&nbsp;</div></li><li><div>          <span class="comment">// (like &lt;a href=&quot;blah&quot;&gt;) or not (&lt;option selected&gt;). If the given value</span>&nbsp;</div></li><li><div>          <span class="comment">// is a &quot;y&quot; or a &quot;Y&quot;, the attribute must not have a value.</span>&nbsp;</div></li><li><div>          <span class="comment">// If the given value is an &quot;n&quot; or an &quot;N&quot;, the attribute must have one.</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if (strtolower($checkvalue) != $vless)&nbsp;</div></li><li><div>              $ok = false;&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>  } <span class="comment"><span class="comment">// switch</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $ok;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Sanitize string from bad protocols.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function removes all non-allowed protocols from the beginning of</span>&nbsp;</div></li><li><div><span class="comment"> * $string. It ignores whitespace and the case of the letters, and it does</span>&nbsp;</div></li><li><div><span class="comment"> * understand HTML entities. It does its work in a while loop, so it won't be</span>&nbsp;</div></li><li><div><span class="comment"> * fooled by a string like &quot;javascript:javascript:alert(57)&quot;.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string            Content to filter bad protocols from</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $allowed_protocols Allowed protocols to keep</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Filtered content</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_bad_protocol($string, $allowed_protocols) {&nbsp;</div></li><li><div>  $string = wp_kses_no_null($string);&nbsp;</div></li><li><div>  $iterations = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  do {&nbsp;</div></li><li><div>      $original_string = $string;&nbsp;</div></li><li><div>      $string = wp_kses_bad_protocol_once($string, $allowed_protocols);&nbsp;</div></li><li><div>  } while ( $original_string != $string && ++$iterations &lt; 6 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $original_string != $string )&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $string;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Removes any invalid control characters in $string.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Also removes any instance of the '\0' string.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $options Set 'slash_zero' =&gt; 'keep' when '\0' is allowed. Default is 'remove'.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_no_null( $string, $options = null ) {&nbsp;</div></li><li><div>  if ( ! isset( $options['slash_zero'] ) ) {&nbsp;</div></li><li><div>      $options = array( 'slash_zero' =&gt; 'remove' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $string = preg_replace( '/[\x00-\x08\x0B\x0C\x0E-\x1F]/', '', $string );&nbsp;</div></li><li><div>  if ( 'remove' == $options['slash_zero'] ) {&nbsp;</div></li><li><div>      $string = preg_replace( '/\\\\+0+/', '', $string );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $string;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Strips slashes from in front of quotes.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function changes the character sequence \&quot; to just &quot;. It leaves all</span>&nbsp;</div></li><li><div><span class="comment"> * other slashes alone. It's really weird, but the quoting from</span>&nbsp;</div></li><li><div><span class="comment"> * preg_replace(//e) seems to require this.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string String to strip slashes</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Fixed string with quoted slashes</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_stripslashes($string) {&nbsp;</div></li><li><div>  return preg_replace('%\\\\&quot;%', '&quot;', $string);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Goes through an array and changes the keys to all lower case.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $inarray Unfiltered array</span>&nbsp;</div></li><li><div><span class="comment"> * @return array Fixed array with all lowercase keys</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_array_lc($inarray) {&nbsp;</div></li><li><div>  $outarray = array ();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( (array) $inarray as $inkey =&gt; $inval) {&nbsp;</div></li><li><div>      $outkey = strtolower($inkey);&nbsp;</div></li><li><div>      $outarray[$outkey] = array ();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( (array) $inval as $inkey2 =&gt; $inval2) {&nbsp;</div></li><li><div>          $outkey2 = strtolower($inkey2);&nbsp;</div></li><li><div>          $outarray[$outkey][$outkey2] = $inval2;&nbsp;</div></li><li><div>      } <span class="comment">// foreach $inval</span>&nbsp;</div></li><li><div>  } <span class="comment">// foreach $inarray</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $outarray;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Handles parsing errors in wp_kses_hair().</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The general plan is to remove everything to and including some whitespace, </span>&nbsp;</div></li><li><div><span class="comment"> * but it deals with quotes and apostrophes as well.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string</span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_html_error($string) {&nbsp;</div></li><li><div>  return preg_replace('/^(&quot;[^&quot;]*(&quot;|$)|\'[^\']*(\'|$)|\S)*\s*/', '', $string);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Sanitizes content from bad protocols and other characters.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function searches for URL protocols at the beginning of $string, while</span>&nbsp;</div></li><li><div><span class="comment"> * handling whitespace and HTML entities.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string            Content to check for bad protocols</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $allowed_protocols Allowed protocols</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Sanitized content</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_bad_protocol_once($string, $allowed_protocols, $count = 1 ) {&nbsp;</div></li><li><div>  $string2 = preg_split( '/:|&#0*58;|&#x0*3a;/i', $string, 2 );&nbsp;</div></li><li><div>  if ( isset($string2[1]) && ! preg_match('%/\?%', $string2[0]) ) {&nbsp;</div></li><li><div>      $string = trim( $string2[1] );&nbsp;</div></li><li><div>      $protocol = wp_kses_bad_protocol_once2( $string2[0], $allowed_protocols );&nbsp;</div></li><li><div>      if ( 'feed:' == $protocol ) {&nbsp;</div></li><li><div>          if ( $count &gt; 2 )&nbsp;</div></li><li><div>              return '';&nbsp;</div></li><li><div>          $string = wp_kses_bad_protocol_once( $string, $allowed_protocols, ++$count );&nbsp;</div></li><li><div>          if ( empty( $string ) )&nbsp;</div></li><li><div>              return $string;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $string = $protocol . $string;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $string;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Callback for wp_kses_bad_protocol_once() regular expression.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function processes URL protocols, checks to see if they're in the</span>&nbsp;</div></li><li><div><span class="comment"> * whitelist or not, and returns different data depending on the answer.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string            URI scheme to check against the whitelist</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $allowed_protocols Allowed protocols</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Sanitized content</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_bad_protocol_once2( $string, $allowed_protocols ) {&nbsp;</div></li><li><div>  $string2 = wp_kses_decode_entities($string);&nbsp;</div></li><li><div>  $string2 = preg_replace('/\s/', '', $string2);&nbsp;</div></li><li><div>  $string2 = wp_kses_no_null($string2);&nbsp;</div></li><li><div>  $string2 = strtolower($string2);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $allowed = false;&nbsp;</div></li><li><div>  foreach ( (array) $allowed_protocols as $one_protocol )&nbsp;</div></li><li><div>      if ( strtolower($one_protocol) == $string2 ) {&nbsp;</div></li><li><div>          $allowed = true;&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ($allowed)&nbsp;</div></li><li><div>      return &quot;$string2:&quot;;&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Converts and fixes HTML entities.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function normalizes HTML entities. It will convert `AT&T` to the correct</span>&nbsp;</div></li><li><div><span class="comment"> * `AT&amp;T`, `&#00058;` to `&#58;`, `&#XYZZY;` to `&amp;#XYZZY;` and so on.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string Content to normalize entities</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Content with normalized entities</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_normalize_entities($string) {&nbsp;</div></li><li><div>  <span class="comment">// Disarm all entities by converting & to &amp;</span>&nbsp;</div></li><li><div>  $string = str_replace('&', '&amp;', $string);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Change back the allowed entities in our entity whitelist</span>&nbsp;</div></li><li><div>  $string = preg_replace_callback('/&amp;([A-Za-z]{2, 8}[0-9]{0, 2});/', 'wp_kses_named_entities', $string);&nbsp;</div></li><li><div>  $string = preg_replace_callback('/&amp;#(0*[0-9]{1, 7});/', 'wp_kses_normalize_entities2', $string);&nbsp;</div></li><li><div>  $string = preg_replace_callback('/&amp;#[Xx](0*[0-9A-Fa-f]{1, 6});/', 'wp_kses_normalize_entities3', $string);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $string;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Callback for wp_kses_normalize_entities() regular expression.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function only accepts valid named entity references, which are finite, </span>&nbsp;</div></li><li><div><span class="comment"> * case-sensitive, and highly scrutinized by HTML and XML validators.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $allowedentitynames</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $matches preg_replace_callback() matches array</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Correctly encoded entity</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_named_entities($matches) {&nbsp;</div></li><li><div>  global $allowedentitynames;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($matches[1]) )&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $i = $matches[1];&nbsp;</div></li><li><div>  return ( ! in_array( $i, $allowedentitynames ) ) ? &quot;&amp;$i;&quot; : &quot;&$i;&quot;;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Callback for wp_kses_normalize_entities() regular expression.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function helps wp_kses_normalize_entities() to only accept 16-bit</span>&nbsp;</div></li><li><div><span class="comment"> * values and nothing more for `&#number;` entities.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $matches preg_replace_callback() matches array</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Correctly encoded entity</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_normalize_entities2($matches) {&nbsp;</div></li><li><div>  if ( empty($matches[1]) )&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $i = $matches[1];&nbsp;</div></li><li><div>  if (valid_unicode($i)) {&nbsp;</div></li><li><div>      $i = str_pad(ltrim($i, '0'), 3, '0', STR_PAD_LEFT);&nbsp;</div></li><li><div>      $i = &quot;&#$i;&quot;;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $i = &quot;&amp;#$i;&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $i;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Callback for wp_kses_normalize_entities() for regular expression.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function helps wp_kses_normalize_entities() to only accept valid Unicode</span>&nbsp;</div></li><li><div><span class="comment"> * numeric entities in hex form.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $matches preg_replace_callback() matches array</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Correctly encoded entity</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_normalize_entities3($matches) {&nbsp;</div></li><li><div>  if ( empty($matches[1]) )&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $hexchars = $matches[1];&nbsp;</div></li><li><div>  return ( ! valid_unicode( hexdec( $hexchars ) ) ) ? &quot;&amp;#x$hexchars;&quot; : '&#x'.ltrim($hexchars, '0').';';&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Helper function to determine if a Unicode value is valid.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $i Unicode value</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if the value was a valid Unicode number</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function valid_unicode($i) {&nbsp;</div></li><li><div>  return ( $i == 0x9 || $i == 0xa || $i == 0xd ||&nbsp;</div></li><li><div>          ($i &gt;= 0x20 && $i &lt;= 0xd7ff) ||&nbsp;</div></li><li><div>          ($i &gt;= 0xe000 && $i &lt;= 0xfffd) ||&nbsp;</div></li><li><div>          ($i &gt;= 0x10000 && $i &lt;= 0x10ffff) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Convert all entities to their character counterparts.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function decodes numeric HTML entities (`&#65;` and `&#x41;`).</span>&nbsp;</div></li><li><div><span class="comment"> * It doesn't do anything with other entities like &auml;, but we don't</span>&nbsp;</div></li><li><div><span class="comment"> * need them in the URL protocol whitelisting system anyway.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string Content to change entities</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Content after decoded entities</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_decode_entities($string) {&nbsp;</div></li><li><div>  $string = preg_replace_callback('/&#([0-9]+);/', '_wp_kses_decode_entities_chr', $string);&nbsp;</div></li><li><div>  $string = preg_replace_callback('/&#[Xx]([0-9A-Fa-f]+);/', '_wp_kses_decode_entities_chr_hexdec', $string);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $string;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Regex callback for wp_kses_decode_entities()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $match preg match</span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _wp_kses_decode_entities_chr( $match ) {&nbsp;</div></li><li><div>  return chr( $match[1] );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Regex callback for wp_kses_decode_entities()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $match preg match</span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _wp_kses_decode_entities_chr_hexdec( $match ) {&nbsp;</div></li><li><div>  return chr( hexdec( $match[1] ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Sanitize content with allowed HTML Kses rules.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $data Content to filter, expected to be escaped with slashes</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Filtered content</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_filter_kses( $data ) {&nbsp;</div></li><li><div>  return addslashes( wp_kses( stripslashes( $data ), current_filter() ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Sanitize content with allowed HTML Kses rules.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $data Content to filter, expected to not be escaped</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Filtered content</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_data( $data ) {&nbsp;</div></li><li><div>  return wp_kses( $data, current_filter() );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Sanitize content for allowed HTML tags for post content.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Post content refers to the page contents of the 'post' type and not $_POST</span>&nbsp;</div></li><li><div><span class="comment"> * data from forms.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $data Post content to filter, expected to be escaped with slashes</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Filtered post content with allowed HTML tags and attributes intact.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_filter_post_kses( $data ) {&nbsp;</div></li><li><div>  return addslashes( wp_kses( stripslashes( $data ), 'post' ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Sanitize content for allowed HTML tags for post content.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Post content refers to the page contents of the 'post' type and not $_POST</span>&nbsp;</div></li><li><div><span class="comment"> * data from forms.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $data Post content to filter</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Filtered post content with allowed HTML tags and attributes intact.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_post( $data ) {&nbsp;</div></li><li><div>  return wp_kses( $data, 'post' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Navigates through an array, object, or scalar, and sanitizes content for</span>&nbsp;</div></li><li><div><span class="comment"> * allowed HTML tags for post content.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.2</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see map_deep()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $data The array, object, or scalar value to inspect.</span>&nbsp;</div></li><li><div><span class="comment"> * @return mixed The filtered content.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_kses_post_deep( $data ) {&nbsp;</div></li><li><div>  return map_deep( $data, 'wp_kses_post' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Strips all of the HTML in the content.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $data Content to strip all HTML from</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Filtered content without any HTML</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_filter_nohtml_kses( $data ) {&nbsp;</div></li><li><div>  return addslashes( wp_kses( stripslashes( $data ), 'strip' ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Adds all Kses input form content filters.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * All hooks have default priority. The wp_filter_kses() function is added to</span>&nbsp;</div></li><li><div><span class="comment"> * the 'pre_comment_content' and 'title_save_pre' hooks.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The wp_filter_post_kses() function is added to the 'content_save_pre', </span>&nbsp;</div></li><li><div><span class="comment"> * 'excerpt_save_pre', and 'content_filtered_save_pre' hooks.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function kses_init_filters() {&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Normal filtering</span></span>&nbsp;</div></li><li><div>  add_filter('title_save_pre', 'wp_filter_kses');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Comment filtering</span></span>&nbsp;</div></li><li><div>  if ( current_user_can( 'unfiltered_html' ) )&nbsp;</div></li><li><div>      add_filter( 'pre_comment_content', 'wp_filter_post_kses' );&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      add_filter( 'pre_comment_content', 'wp_filter_kses' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Post filtering</span></span>&nbsp;</div></li><li><div>  add_filter('content_save_pre', 'wp_filter_post_kses');&nbsp;</div></li><li><div>  add_filter('excerpt_save_pre', 'wp_filter_post_kses');&nbsp;</div></li><li><div>  add_filter('content_filtered_save_pre', 'wp_filter_post_kses');&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Removes all Kses input form content filters.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * A quick procedural method to removing all of the filters that kses uses for</span>&nbsp;</div></li><li><div><span class="comment"> * content in WordPress Loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Does not remove the kses_init() function from {@see 'init'} hook (priority is</span>&nbsp;</div></li><li><div><span class="comment"> * default). Also does not remove kses_init() function from {@see 'set_current_user'}</span>&nbsp;</div></li><li><div><span class="comment"> * hook (priority is also default).</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.6</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function kses_remove_filters() {&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Normal filtering</span></span>&nbsp;</div></li><li><div>  remove_filter('title_save_pre', 'wp_filter_kses');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Comment filtering</span></span>&nbsp;</div></li><li><div>  remove_filter( 'pre_comment_content', 'wp_filter_post_kses' );&nbsp;</div></li><li><div>  remove_filter( 'pre_comment_content', 'wp_filter_kses' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Post filtering</span></span>&nbsp;</div></li><li><div>  remove_filter('content_save_pre', 'wp_filter_post_kses');&nbsp;</div></li><li><div>  remove_filter('excerpt_save_pre', 'wp_filter_post_kses');&nbsp;</div></li><li><div>  remove_filter('content_filtered_save_pre', 'wp_filter_post_kses');&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Sets up most of the Kses filters for input form content.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * If you remove the kses_init() function from {@see 'init'} hook and</span>&nbsp;</div></li><li><div><span class="comment"> * {@see 'set_current_user'} (priority is default), then none of the Kses filter hooks</span>&nbsp;</div></li><li><div><span class="comment"> * will be added.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * First removes all of the Kses filters in case the current user does not need</span>&nbsp;</div></li><li><div><span class="comment"> * to have Kses filter the content. If the user does not have unfiltered_html</span>&nbsp;</div></li><li><div><span class="comment"> * capability, then Kses filters are added.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function kses_init() {&nbsp;</div></li><li><div>  kses_remove_filters();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! current_user_can( 'unfiltered_html' ) ) {&nbsp;</div></li><li><div>      kses_init_filters();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Inline CSS filter</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.1</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $css        A string of CSS rules.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $deprecated Not used.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string            Filtered string of CSS rules.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function safecss_filter_attr( $css, $deprecated = '' ) {&nbsp;</div></li><li><div>  if ( !empty( $deprecated ) )&nbsp;</div></li><li><div>      _deprecated_argument( __FUNCTION__, '2.8.1' ); <span class="comment">// Never implemented</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $css = wp_kses_no_null($css);&nbsp;</div></li><li><div>  $css = str_replace(array(&quot;\n&quot;, &quot;\r&quot;, &quot;\t&quot;), '', $css);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( preg_match( '%[\\\\(&=}]|/\*%', $css ) ) <span class="comment">// remove any inline css containing \ ( & } = or comments</span>&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $css_array = explode( ';', trim( $css ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters list of allowed CSS attributes.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.8.1</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0 Added support for `min-height`, `max-height`, `min-width`, and `max-width`.</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.6.0 Added support for `list-style-type`.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $attr List of allowed CSS attributes.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $allowed_attr = apply_filters( 'safe_style_css', array(&nbsp;</div></li><li><div>      'background', &nbsp;</div></li><li><div>      'background-color', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      'border', &nbsp;</div></li><li><div>      'border-width', &nbsp;</div></li><li><div>      'border-color', &nbsp;</div></li><li><div>      'border-style', &nbsp;</div></li><li><div>      'border-right', &nbsp;</div></li><li><div>      'border-right-color', &nbsp;</div></li><li><div>      'border-right-style', &nbsp;</div></li><li><div>      'border-right-width', &nbsp;</div></li><li><div>      'border-bottom', &nbsp;</div></li><li><div>      'border-bottom-color', &nbsp;</div></li><li><div>      'border-bottom-style', &nbsp;</div></li><li><div>      'border-bottom-width', &nbsp;</div></li><li><div>      'border-left', &nbsp;</div></li><li><div>      'border-left-color', &nbsp;</div></li><li><div>      'border-left-style', &nbsp;</div></li><li><div>      'border-left-width', &nbsp;</div></li><li><div>      'border-top', &nbsp;</div></li><li><div>      'border-top-color', &nbsp;</div></li><li><div>      'border-top-style', &nbsp;</div></li><li><div>      'border-top-width', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      'border-spacing', &nbsp;</div></li><li><div>      'border-collapse', &nbsp;</div></li><li><div>      'caption-side', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      'color', &nbsp;</div></li><li><div>      'font', &nbsp;</div></li><li><div>      'font-family', &nbsp;</div></li><li><div>      'font-size', &nbsp;</div></li><li><div>      'font-style', &nbsp;</div></li><li><div>      'font-variant', &nbsp;</div></li><li><div>      'font-weight', &nbsp;</div></li><li><div>      'letter-spacing', &nbsp;</div></li><li><div>      'line-height', &nbsp;</div></li><li><div>      'text-decoration', &nbsp;</div></li><li><div>      'text-indent', &nbsp;</div></li><li><div>      'text-align', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      'height', &nbsp;</div></li><li><div>      'min-height', &nbsp;</div></li><li><div>      'max-height', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      'width', &nbsp;</div></li><li><div>      'min-width', &nbsp;</div></li><li><div>      'max-width', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      'margin', &nbsp;</div></li><li><div>      'margin-right', &nbsp;</div></li><li><div>      'margin-bottom', &nbsp;</div></li><li><div>      'margin-left', &nbsp;</div></li><li><div>      'margin-top', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      'padding', &nbsp;</div></li><li><div>      'padding-right', &nbsp;</div></li><li><div>      'padding-bottom', &nbsp;</div></li><li><div>      'padding-left', &nbsp;</div></li><li><div>      'padding-top', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      'clear', &nbsp;</div></li><li><div>      'cursor', &nbsp;</div></li><li><div>      'direction', &nbsp;</div></li><li><div>      'float', &nbsp;</div></li><li><div>      'overflow', &nbsp;</div></li><li><div>      'vertical-align', &nbsp;</div></li><li><div>      'list-style-type', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($allowed_attr) )&nbsp;</div></li><li><div>      return $css;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $css = '';&nbsp;</div></li><li><div>  foreach ( $css_array as $css_item ) {&nbsp;</div></li><li><div>      if ( $css_item == '' )&nbsp;</div></li><li><div>          continue;&nbsp;</div></li><li><div>      $css_item = trim( $css_item );&nbsp;</div></li><li><div>      $found = false;&nbsp;</div></li><li><div>      if ( strpos( $css_item, ':' ) === false ) {&nbsp;</div></li><li><div>          $found = true;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $parts = explode( ':', $css_item );&nbsp;</div></li><li><div>          if ( in_array( trim( $parts[0] ), $allowed_attr ) )&nbsp;</div></li><li><div>              $found = true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if ( $found ) {&nbsp;</div></li><li><div>          if( $css != '' )&nbsp;</div></li><li><div>              $css .= ';';&nbsp;</div></li><li><div>          $css .= $css_item;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $css;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Helper function to add global attributes to a tag in the allowed html list.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.5.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $value An array of attributes.</span>&nbsp;</div></li><li><div><span class="comment"> * @return array The array of attributes with global attributes added.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _wp_add_global_attributes( $value ) {&nbsp;</div></li><li><div>  $global_attributes = array(&nbsp;</div></li><li><div>      'class' =&gt; true, &nbsp;</div></li><li><div>      'id' =&gt; true, &nbsp;</div></li><li><div>      'style' =&gt; true, &nbsp;</div></li><li><div>      'title' =&gt; true, &nbsp;</div></li><li><div>      'role' =&gt; true, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( true === $value )&nbsp;</div></li><li><div>      $value = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_array( $value ) )&nbsp;</div></li><li><div>      return array_merge( $value, $global_attributes );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $value;&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>wordpress</li><li><span></span>file</li><li><span></span></li><li><span></span>wp-include</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2021 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>