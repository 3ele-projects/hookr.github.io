<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="wordpress" data-version="4.7.3" data-type="file" data-id="4758"><head xmlns="http://www.w3.org/1999/xhtml"><title> wp-includes-embed | file | WordPress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, wordpress, 4.7.3" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.17"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=de05b78ecbe327de40245a28760f7ead' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.17' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/wp-includes-embed/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-includes-embed%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-includes-embed%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"wordpress-4.7.3-file-wp-includes-embed","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wp-includes-embed" class="blog single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 4.7.3." href="http://hookr.io/4.7.3/" class="H_VERSION"><span property="name">4.7.3</span></a><meta property="position" content="2"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wp-includes-embed</span><meta property="position" content="3"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="6309"><a href="http://hookr.io/4.7.3/all/" title="All">All <span class="count badge">6309</span></a></li><li class="" data-id="new" data-count="1"><a href="http://hookr.io/4.7.3/new/" title="New">New <span class="count badge">1</span></a></li><li class="" data-id="hooks" data-count="2532"><a href="http://hookr.io/4.7.3/hooks/" title="Hooks">Hooks <span class="count badge">2532</span></a></li><li class="" data-id="action" data-count="864"><a href="http://hookr.io/4.7.3/actions/" title="Actions">Actions <span class="count badge">864</span></a></li><li class="" data-id="filter" data-count="1668"><a href="http://hookr.io/4.7.3/filters/" title="Filters">Filters <span class="count badge">1668</span></a></li><li class="" data-id="class" data-count="351"><a href="http://hookr.io/4.7.3/classes/" title="Classes">Classes <span class="count badge">351</span></a></li><li class="" data-id="constant" data-count="566"><a href="http://hookr.io/4.7.3/constants/" title="Constants">Constants <span class="count badge">566</span></a></li><li class="" data-id="function" data-count="2852"><a href="http://hookr.io/4.7.3/functions/" title="Functions">Functions <span class="count badge">2852</span></a></li><li class="" data-id="shortcode" data-count="8"><a href="http://hookr.io/4.7.3/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">8</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class="active"><a href="http://hookr.io/all/" title="Core">Core</a></li><li class=""><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/wp-includes/embed.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * oEmbed API: Top-level oEmbed functionality</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package WordPress</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage oEmbed</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Registers an embed handler.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Should probably only be used for sites that do not support oEmbed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Embed $wp_embed</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string   $id       An internal ID/name for the handler. Needs to be unique.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string   $regex    The regex that will be used to see if this handler should be used for a URL.</span>&nbsp;</div></li><li><div><span class="comment"> * @param callable $callback The callback function that will be called if the regex is matched.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int      $priority Optional. Used to specify the order in which the registered handlers will</span>&nbsp;</div></li><li><div><span class="comment"> *                           be tested. Default 10.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_embed_register_handler( $id, $regex, $callback, $priority = 10 ) {&nbsp;</div></li><li><div>  global $wp_embed;&nbsp;</div></li><li><div>  $wp_embed-&gt;register_handler( $id, $regex, $callback, $priority );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Unregisters a previously-registered embed handler.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Embed $wp_embed</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $id       The handler ID that should be removed.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $priority Optional. The priority of the handler to be removed. Default 10.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_embed_unregister_handler( $id, $priority = 10 ) {&nbsp;</div></li><li><div>  global $wp_embed;&nbsp;</div></li><li><div>  $wp_embed-&gt;unregister_handler( $id, $priority );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Creates default array of embed parameters.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The width defaults to the content width as specified by the theme. If the</span>&nbsp;</div></li><li><div><span class="comment"> * theme does not specify a content width, then 500px is used.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The default height is 1.5 times the width, or 1000px, whichever is smaller.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The {@see 'embed_defaults'} filter can be used to adjust either of these values.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global int $content_width</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $url Optional. The URL that should be embedded. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return array Default embed parameters.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_embed_defaults( $url = '' ) {&nbsp;</div></li><li><div>  if ( ! empty( $GLOBALS['content_width'] ) )&nbsp;</div></li><li><div>      $width = (int) $GLOBALS['content_width'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $width ) )&nbsp;</div></li><li><div>      $width = 500;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $height = min( ceil( $width * 1.5 ), 1000 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the default array of embed dimensions.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $size An array of embed width and height values</span>&nbsp;</div></li><li><div><span class="comment">   *                     in pixels (in that order).</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url  The URL that should be embedded.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'embed_defaults', compact( 'width', 'height' ), $url );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Attempts to fetch the embed HTML for a provided URL using oEmbed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see WP_oEmbed</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $url  The URL that should be embedded.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $args Optional. Additional arguments and parameters for retrieving embed HTML.</span>&nbsp;</div></li><li><div><span class="comment"> *                     Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @return false|string False on failure or the embed HTML on success.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_oembed_get( $url, $args = '' ) {&nbsp;</div></li><li><div>  $oembed = _wp_oembed_get_object();&nbsp;</div></li><li><div>  return $oembed-&gt;get_html( $url, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Returns the initialized WP_oEmbed object.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @staticvar WP_oEmbed $wp_oembed</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return WP_oEmbed object.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _wp_oembed_get_object() {&nbsp;</div></li><li><div>  static $wp_oembed = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_null( $wp_oembed ) ) {&nbsp;</div></li><li><div>      $wp_oembed = new WP_oEmbed();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return $wp_oembed;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Adds a URL format and oEmbed provider URL pair.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see WP_oEmbed</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string  $format   The format of URL that this provider can handle. You can use asterisks</span>&nbsp;</div></li><li><div><span class="comment"> *                          as wildcards.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string  $provider The URL to the oEmbed provider.</span>&nbsp;</div></li><li><div><span class="comment"> * @param boolean $regex    Optional. Whether the `$format` parameter is in a RegEx format. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_oembed_add_provider( $format, $provider, $regex = false ) {&nbsp;</div></li><li><div>  if ( did_action( 'plugins_loaded' ) ) {&nbsp;</div></li><li><div>      $oembed = _wp_oembed_get_object();&nbsp;</div></li><li><div>      $oembed-&gt;providers[$format] = array( $provider, $regex );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      WP_oEmbed::_add_provider_early( $format, $provider, $regex );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Removes an oEmbed provider.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see WP_oEmbed</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $format The URL format for the oEmbed provider to remove.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool Was the provider removed successfully?</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_oembed_remove_provider( $format ) {&nbsp;</div></li><li><div>  if ( did_action( 'plugins_loaded' ) ) {&nbsp;</div></li><li><div>      $oembed = _wp_oembed_get_object();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $oembed-&gt;providers[ $format ] ) ) {&nbsp;</div></li><li><div>          unset( $oembed-&gt;providers[ $format ] );&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      WP_oEmbed::_remove_provider_early( $format );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determines if default embed handlers should be loaded.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Checks to make sure that the embeds library hasn't already been loaded. If</span>&nbsp;</div></li><li><div><span class="comment"> * it hasn't, then it will load the embeds library.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see wp_embed_register_handler()</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_maybe_load_embeds() {&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether to load the default embed handlers.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Returning a falsey value will prevent loading the default embed handlers.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $maybe_load_embeds Whether to load the embeds library. Default true.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  if ( ! apply_filters( 'load_default_embeds', true ) ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  wp_embed_register_handler( 'youtube_embed_url', '#https?:<span class="comment">//(www.)?youtube\.com/(?:v|embed)/([^/]+)#i', 'wp_embed_handler_youtube' );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the audio embed handler callback.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.6.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param callable $handler Audio embed handler callback function.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  wp_embed_register_handler( 'audio', '#^https?:<span class="comment">//.+?\.(' . join( '|', wp_get_audio_extensions() ) . ')$#i', apply_filters( 'wp_audio_embed_handler', 'wp_embed_handler_audio' ), 9999 );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the video embed handler callback.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.6.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param callable $handler Video embed handler callback function.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  wp_embed_register_handler( 'video', '#^https?:<span class="comment">//.+?\.(' . join( '|', wp_get_video_extensions() ) . ')$#i', apply_filters( 'wp_video_embed_handler', 'wp_embed_handler_video' ), 9999 );</span>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * YouTube iframe embed handler callback.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Catches YouTube iframe embed URLs that are not parsable by oEmbed but can be translated into a URL that is.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Embed $wp_embed</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $matches The RegEx matches from the provided regex when calling</span>&nbsp;</div></li><li><div><span class="comment"> *                        wp_embed_register_handler().</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $attr    Embed attributes.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $url     The original URL that was matched by the regex.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $rawattr The original unmodified attributes.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The embed HTML.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_embed_handler_youtube( $matches, $attr, $url, $rawattr ) {&nbsp;</div></li><li><div>  global $wp_embed;&nbsp;</div></li><li><div>  $embed = $wp_embed-&gt;autoembed( sprintf( &quot;https:<span class="comment">//youtube.com/watch?v=%s&quot;, urlencode( $matches[2] ) ) );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the YoutTube embed output.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @see wp_embed_handler_youtube()</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $embed   YouTube embed output.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $attr    An array of embed attributes.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url     The original URL that was matched by the regex.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $rawattr The original unmodified attributes.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'wp_embed_handler_youtube', $embed, $attr, $url, $rawattr );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Audio embed handler callback.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.6.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $matches The RegEx matches from the provided regex when calling wp_embed_register_handler().</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $attr Embed attributes.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $url The original URL that was matched by the regex.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $rawattr The original unmodified attributes.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The embed HTML.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_embed_handler_audio( $matches, $attr, $url, $rawattr ) {&nbsp;</div></li><li><div>  $audio = sprintf( '<a class="wp-embedded-audio" href="http://&quot;%s&quot;">&quot;%s&quot;</a>', esc_url( $url ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the audio embed output.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.6.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $audio   Audio embed output.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $attr    An array of embed attributes.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url     The original URL that was matched by the regex.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $rawattr The original unmodified attributes.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'wp_embed_handler_audio', $audio, $attr, $url, $rawattr );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Video embed handler callback.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.6.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $matches The RegEx matches from the provided regex when calling wp_embed_register_handler().</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $attr    Embed attributes.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $url     The original URL that was matched by the regex.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $rawattr The original unmodified attributes.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The embed HTML.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_embed_handler_video( $matches, $attr, $url, $rawattr ) {&nbsp;</div></li><li><div>  $dimensions = '';&nbsp;</div></li><li><div>  if ( ! empty( $rawattr['width'] ) && ! empty( $rawattr['height'] ) ) {&nbsp;</div></li><li><div>      $dimensions .= sprintf( 'width=&quot;%d&quot; ', (int) $rawattr['width'] );&nbsp;</div></li><li><div>      $dimensions .= sprintf( 'height=&quot;%d&quot; ', (int) $rawattr['height'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  $video = sprintf( '<a class="wp-embedded-video" href="http://&quot;%s&quot;">&quot;%s&quot;</a>', $dimensions, esc_url( $url ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the video embed output.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.6.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $video   Video embed output.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $attr    An array of embed attributes.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url     The original URL that was matched by the regex.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $rawattr The original unmodified attributes.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'wp_embed_handler_video', $video, $attr, $url, $rawattr );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Registers the oEmbed REST API route.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_oembed_register_route() {&nbsp;</div></li><li><div>  $controller = new WP_oEmbed_Controller();&nbsp;</div></li><li><div>  $controller-&gt;register_routes();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Adds oEmbed discovery links in the website &lt;head&gt;.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_oembed_add_discovery_links() {&nbsp;</div></li><li><div>  $output = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_singular() ) {&nbsp;</div></li><li><div>      $output .= '&lt;link rel=&quot;alternate&quot; type=&quot;application/json+oembed&quot; href=&quot;' . esc_url( get_oembed_endpoint_url( get_permalink() ) ) . '&quot; /&gt;' . &quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( class_exists( 'SimpleXMLElement' ) ) {&nbsp;</div></li><li><div>          $output .= '&lt;link rel=&quot;alternate&quot; type=&quot;text/xml+oembed&quot; href=&quot;' . esc_url( get_oembed_endpoint_url( get_permalink(), 'xml' ) ) . '&quot; /&gt;' . &quot;\n&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the oEmbed discovery links HTML.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $output HTML of the discovery links.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo apply_filters( 'oembed_discovery_links', $output );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Adds the necessary JavaScript to communicate with the embedded iframes.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_oembed_add_host_js() {&nbsp;</div></li><li><div>  wp_enqueue_script( 'wp-embed' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL to embed a specific post in an iframe.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|WP_Post $post Optional. Post ID or object. Defaults to the current post.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|false The post embed URL on success, false if the post doesn't exist.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_post_embed_url( $post = null ) {&nbsp;</div></li><li><div>  $post = get_post( $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $post ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $embed_url = trailingslashit( get_permalink( $post ) ) . user_trailingslashit( 'embed' );&nbsp;</div></li><li><div>  $path_conflict = get_page_by_path( str_replace( home_url(), '', $embed_url ), OBJECT, get_post_types( array( 'public' =&gt; true ) ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! get_option( 'permalink_structure' ) || $path_conflict ) {&nbsp;</div></li><li><div>      $embed_url = add_query_arg( array( 'embed' =&gt; 'true' ), get_permalink( $post ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the URL to embed a specific post.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $embed_url The post embed URL.</span>&nbsp;</div></li><li><div><span class="comment">   * @param WP_Post $post      The corresponding post object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return esc_url_raw( apply_filters( 'post_embed_url', $embed_url, $post ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the oEmbed endpoint URL for a given permalink.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Pass an empty string as the first argument to get the endpoint base URL.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $permalink Optional. The permalink used for the `url` query arg. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $format    Optional. The requested response format. Default 'json'.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The oEmbed endpoint URL.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_oembed_endpoint_url( $permalink = '', $format = 'json' ) {&nbsp;</div></li><li><div>  $url = rest_url( 'oembed/1.0/embed' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( '' !== $permalink ) {&nbsp;</div></li><li><div>      $url = add_query_arg( array(&nbsp;</div></li><li><div>          'url' =&gt; urlencode( $permalink ), &nbsp;</div></li><li><div>          'format' =&gt; ( 'json' !== $format ) ? $format : false, &nbsp;</div></li><li><div> ), $url );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the oEmbed endpoint URL.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url       The URL to the oEmbed endpoint.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $permalink The permalink used for the `url` query arg.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $format    The requested response format.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'oembed_endpoint_url', $url, $permalink, $format );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the embed code for a specific post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int         $width  The width for the response.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int         $height The height for the response.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|WP_Post $post   Optional. Post ID or object. Default is global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|false Embed code on success, false if post doesn't exist.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_post_embed_html( $width, $height, $post = null ) {&nbsp;</div></li><li><div>  $post = get_post( $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $post ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $embed_url = get_post_embed_url( $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $output = '&lt;blockquote class=&quot;wp-embedded-content&quot;&gt;&lt;a href=&quot;' . esc_url( get_permalink( $post ) ) . '&quot;&gt;' . get_the_title( $post ) . &quot;&lt;/a&gt;&lt;/blockquote&gt;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $output .= &quot;&lt;script type='text/javascript'&gt;\n&quot;;&nbsp;</div></li><li><div>  $output .= &quot;&lt;!--<span class="comment">//--&gt;&lt;![CDATA[//&gt;&lt;!--\n&quot;;</span>&nbsp;</div></li><li><div>  if ( SCRIPT_DEBUG ) {&nbsp;</div></li><li><div>      $output .= file_get_contents( ABSPATH . WPINC . '/js/wp-embed.js' );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * If you're looking at a src version of this file, you'll see an &quot;include&quot;</span>&nbsp;</div></li><li><div><span class="comment">       * statement below. This is used by the `grunt build` process to directly</span>&nbsp;</div></li><li><div><span class="comment">       * include a minified version of wp-embed.js, instead of using the</span>&nbsp;</div></li><li><div><span class="comment">       * file_get_contents() method from above.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * If you're looking at a build version of this file, you'll see a string of</span>&nbsp;</div></li><li><div><span class="comment">       * minified JavaScript. If you need to debug it, please turn on SCRIPT_DEBUG</span>&nbsp;</div></li><li><div><span class="comment">       * and edit wp-embed.js directly.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $output .=&lt;&lt;&lt;JS&nbsp;</div></li><li><div>      !function(a, b) {&quot;use strict&quot;;function c() {if(!e) {e=!0;var a, c, d, f, g=-1!==navigator.appVersion.indexOf(&quot;MSIE 10&quot;), h=!!navigator.userAgent.match(/Trident.*rv:11\./), i=b.querySelectorAll(&quot;iframe.wp-embedded-content&quot;);for(c=0;c&lt;i.length;c++) {if(d=i[c], !d.getAttribute(&quot;data-secret&quot;))f=Math.random().toString(36).substr(2, 10), d.src+=&quot;#?secret=&quot;+f, d.setAttribute(&quot;data-secret&quot;, f);if(g||h)a=d.cloneNode(!0), a.removeAttribute(&quot;security&quot;), d.parentNode.replaceChild(a, d)}}}var d=!1, e=!1;if(b.querySelector)if(a.addEventListener)d=!0;if(a.wp=a.wp||{}, !a.wp.receiveEmbedMessage)if(a.wp.receiveEmbedMessage=function(c) {var d=c.data;if(d.secret||d.message||d.value)if(!/[^a-zA-Z0-9]/.test(d.secret)) {var e, f, g, h, i, j=b.querySelectorAll('iframe[data-secret=&quot;'+d.secret+'&quot;]'), k=b.querySelectorAll('blockquote[data-secret=&quot;'+d.secret+'&quot;]');for(e=0;e&lt;k.length;e++)k[e].style.display=&quot;none&quot;;for(e=0;e&lt;j.length;e++)if(f=j[e], c.source===f.contentWindow) {if(f.removeAttribute(&quot;style&quot;), &quot;height&quot;===d.message) {if(g=parseInt(d.value, 10), g&gt;1e3)g=1e3;else if(~~g&lt;200)g=200;f.height=g}if(&quot;link&quot;===d.message)if(h=b.createElement(&quot;a&quot;), i=b.createElement(&quot;a&quot;), h.href=f.getAttribute(&quot;src&quot;), i.href=d.value, i.host===h.host)if(b.activeElement===f)a.top.location.href=d.value}else;}}, d)a.addEventListener(&quot;message&quot;, a.wp.receiveEmbedMessage, !1), b.addEventListener(&quot;DOMContentLoaded&quot;, c, !1), a.addEventListener(&quot;load&quot;, c, !1)}(window, document);&nbsp;</div></li><li><div>JS;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  $output .= &quot;\n<span class="comment">//--&gt;&lt;!]]&gt;&quot;;</span>&nbsp;</div></li><li><div>  $output .= &quot;\n&lt;/script&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $output .= sprintf(&nbsp;</div></li><li><div>      '&lt;iframe sandbox=&quot;allow-scripts&quot; security=&quot;restricted&quot; src=&quot;%1$s&quot; width=&quot;%2$d&quot; height=&quot;%3$d&quot; title=&quot;%4$s&quot; frameborder=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; scrolling=&quot;no&quot; class=&quot;wp-embedded-content&quot;&gt;&lt;/iframe&gt;', &nbsp;</div></li><li><div>      esc_url( $embed_url ), &nbsp;</div></li><li><div>      absint( $width ), &nbsp;</div></li><li><div>      absint( $height ), &nbsp;</div></li><li><div>      esc_attr(&nbsp;</div></li><li><div>          sprintf(&nbsp;</div></li><li><div>              <span class="comment">/** translators: 1: post title, 2: site name */</span>&nbsp;</div></li><li><div>              __( '&#8220;%1$s&#8221; &#8212; %2$s' ), &nbsp;</div></li><li><div>              get_the_title( $post ), &nbsp;</div></li><li><div>              get_bloginfo( 'name' )&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the embed HTML output for a given post.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $output The default HTML.</span>&nbsp;</div></li><li><div><span class="comment">   * @param WP_Post $post   Current post object.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int     $width  Width of the response.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int     $height Height of the response.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'embed_html', $output, $post, $width, $height );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the oEmbed response data for a given post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param WP_Post|int $post  Post object or ID.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int         $width The requested width.</span>&nbsp;</div></li><li><div><span class="comment"> * @return array|false Response data on success, false if post doesn't exist.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_oembed_response_data( $post, $width ) {&nbsp;</div></li><li><div>  $post = get_post( $post );&nbsp;</div></li><li><div>  $width = absint( $width );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $post ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'publish' !== get_post_status( $post ) ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the allowed minimum and maximum widths for the oEmbed response.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $min_max_width {</span>&nbsp;</div></li><li><div><span class="comment">   *     Minimum and maximum widths for the oEmbed response.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   *     @type int $min Minimum width. Default 200.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type int $max Maximum width. Default 600.</span>&nbsp;</div></li><li><div><span class="comment">   * }</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $min_max_width = apply_filters( 'oembed_min_max_width', array(&nbsp;</div></li><li><div>      'min' =&gt; 200, &nbsp;</div></li><li><div>      'max' =&gt; 600&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $width = min( max( $min_max_width['min'], $width ), $min_max_width['max'] );&nbsp;</div></li><li><div>  $height = max( ceil( $width / 16 * 9 ), 200 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $data = array(&nbsp;</div></li><li><div>      'version' =&gt; '1.0', &nbsp;</div></li><li><div>      'provider_name' =&gt; get_bloginfo( 'name' ), &nbsp;</div></li><li><div>      'provider_url' =&gt; get_home_url(), &nbsp;</div></li><li><div>      'author_name' =&gt; get_bloginfo( 'name' ), &nbsp;</div></li><li><div>      'author_url' =&gt; get_home_url(), &nbsp;</div></li><li><div>      'title' =&gt; $post-&gt;post_title, &nbsp;</div></li><li><div>      'type' =&gt; 'link', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $author = get_userdata( $post-&gt;post_author );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $author ) {&nbsp;</div></li><li><div>      $data['author_name'] = $author-&gt;display_name;&nbsp;</div></li><li><div>      $data['author_url'] = get_author_posts_url( $author-&gt;ID );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the oEmbed response data.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array   $data   The response data.</span>&nbsp;</div></li><li><div><span class="comment">   * @param WP_Post $post   The post object.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int     $width  The requested width.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int     $height The calculated height.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'oembed_response_data', $data, $post, $width, $height );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Filters the oEmbed response data to return an iframe embed code.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array   $data   The response data.</span>&nbsp;</div></li><li><div><span class="comment"> * @param WP_Post $post   The post object.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int     $width  The requested width.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int     $height The calculated height.</span>&nbsp;</div></li><li><div><span class="comment"> * @return array The modified response data.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_oembed_response_data_rich( $data, $post, $width, $height ) {&nbsp;</div></li><li><div>  $data['width'] = absint( $width );&nbsp;</div></li><li><div>  $data['height'] = absint( $height );&nbsp;</div></li><li><div>  $data['type'] = 'rich';&nbsp;</div></li><li><div>  $data['html'] = get_post_embed_html( $width, $height, $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Add post thumbnail to response if available.</span>&nbsp;</div></li><li><div>  $thumbnail_id = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( has_post_thumbnail( $post-&gt;ID ) ) {&nbsp;</div></li><li><div>      $thumbnail_id = get_post_thumbnail_id( $post-&gt;ID );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'attachment' === get_post_type( $post ) ) {&nbsp;</div></li><li><div>      if ( wp_attachment_is_image( $post ) ) {&nbsp;</div></li><li><div>          $thumbnail_id = $post-&gt;ID;&nbsp;</div></li><li><div>      } else if ( wp_attachment_is( 'video', $post ) ) {&nbsp;</div></li><li><div>          $thumbnail_id = get_post_thumbnail_id( $post );&nbsp;</div></li><li><div>          $data['type'] = 'video';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $thumbnail_id ) {&nbsp;</div></li><li><div>      list( $thumbnail_url, $thumbnail_width, $thumbnail_height ) = wp_get_attachment_image_src( $thumbnail_id, array( $width, 99999 ) );&nbsp;</div></li><li><div>      $data['thumbnail_url'] = $thumbnail_url;&nbsp;</div></li><li><div>      $data['thumbnail_width'] = $thumbnail_width;&nbsp;</div></li><li><div>      $data['thumbnail_height'] = $thumbnail_height;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $data;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Ensures that the specified format is either 'json' or 'xml'.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $format The oEmbed response format. Accepts 'json' or 'xml'.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The format, either 'xml' or 'json'. Default 'json'.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_oembed_ensure_format( $format ) {&nbsp;</div></li><li><div>  if ( ! in_array( $format, array( 'json', 'xml' ), true ) ) {&nbsp;</div></li><li><div>      return 'json';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $format;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Hooks into the REST API output to print XML instead of JSON.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This is only done for the oEmbed API endpoint, </span>&nbsp;</div></li><li><div><span class="comment"> * which supports both formats.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool                      $served  Whether the request has already been served.</span>&nbsp;</div></li><li><div><span class="comment"> * @param WP_HTTP_ResponseInterface $result  Result to send to the client. Usually a WP_REST_Response.</span>&nbsp;</div></li><li><div><span class="comment"> * @param WP_REST_Request           $request Request used to generate the response.</span>&nbsp;</div></li><li><div><span class="comment"> * @param WP_REST_Server            $server  Server instance.</span>&nbsp;</div></li><li><div><span class="comment"> * @return true</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _oembed_rest_pre_serve_request( $served, $result, $request, $server ) {&nbsp;</div></li><li><div>  $params = $request-&gt;get_params();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( '/oembed/1.0/embed' !== $request-&gt;get_route() || 'GET' !== $request-&gt;get_method() ) {&nbsp;</div></li><li><div>      return $served;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! isset( $params['format'] ) || 'xml' !== $params['format'] ) {&nbsp;</div></li><li><div>      return $served;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Embed links inside the request.</span>&nbsp;</div></li><li><div>  $data = $server-&gt;response_to_data( $result, false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! class_exists( 'SimpleXMLElement' ) ) {&nbsp;</div></li><li><div>      status_header( 501 );&nbsp;</div></li><li><div>      die( get_status_header_desc( 501 ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $result = _oembed_create_xml( $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Bail if there's no XML.</span>&nbsp;</div></li><li><div>  if ( ! $result ) {&nbsp;</div></li><li><div>      status_header( 501 );&nbsp;</div></li><li><div>      return get_status_header_desc( 501 );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! headers_sent() ) {&nbsp;</div></li><li><div>      $server-&gt;send_header( 'Content-Type', 'text/xml; charset=' . get_option( 'blog_charset' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo $result;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return true;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Creates an XML string from a given array.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array            $data The original oEmbed response data.</span>&nbsp;</div></li><li><div><span class="comment"> * @param SimpleXMLElement $node Optional. XML node to append the result to recursively.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|false XML string on success, false on error.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _oembed_create_xml( $data, $node = null ) {&nbsp;</div></li><li><div>  if ( ! is_array( $data ) || empty( $data ) ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( null === $node ) {&nbsp;</div></li><li><div>      $node = new SimpleXMLElement( '&lt;oembed&gt;&lt;/oembed&gt;' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( $data as $key =&gt; $value ) {&nbsp;</div></li><li><div>      if ( is_numeric( $key ) ) {&nbsp;</div></li><li><div>          $key = 'oembed';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_array( $value ) ) {&nbsp;</div></li><li><div>          $item = $node-&gt;addChild( $key );&nbsp;</div></li><li><div>          _oembed_create_xml( $value, $item );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $node-&gt;addChild( $key, esc_html( $value ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $node-&gt;asXML();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Filters the given oEmbed HTML.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * If the `$url` isn't on the trusted providers list, </span>&nbsp;</div></li><li><div><span class="comment"> * we need to filter the HTML heavily for security.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Only filters 'rich' and 'html' response types.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $result The oEmbed HTML result.</span>&nbsp;</div></li><li><div><span class="comment"> * @param object $data   A data object result from an oEmbed provider.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $url    The URL of the content to be embedded.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The filtered and sanitized oEmbed result.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_filter_oembed_result( $result, $data, $url ) {&nbsp;</div></li><li><div>  if ( false === $result || ! in_array( $data-&gt;type, array( 'rich', 'video' ) ) ) {&nbsp;</div></li><li><div>      return $result;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $wp_oembed = _wp_oembed_get_object();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Don't modify the HTML for trusted providers.</span>&nbsp;</div></li><li><div>  if ( false !== $wp_oembed-&gt;get_provider( $url, array( 'discover' =&gt; false ) ) ) {&nbsp;</div></li><li><div>      return $result;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $allowed_html = array(&nbsp;</div></li><li><div>      'a' =&gt; array(&nbsp;</div></li><li><div>          'href' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'blockquote' =&gt; array(), &nbsp;</div></li><li><div>      'iframe' =&gt; array(&nbsp;</div></li><li><div>          'src' =&gt; true, &nbsp;</div></li><li><div>          'width' =&gt; true, &nbsp;</div></li><li><div>          'height' =&gt; true, &nbsp;</div></li><li><div>          'frameborder' =&gt; true, &nbsp;</div></li><li><div>          'marginwidth' =&gt; true, &nbsp;</div></li><li><div>          'marginheight' =&gt; true, &nbsp;</div></li><li><div>          'scrolling' =&gt; true, &nbsp;</div></li><li><div>          'title' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html = wp_kses( $result, $allowed_html );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  preg_match( '|(&lt;blockquote&gt;.*?&lt;/blockquote&gt;)?.*(&lt;iframe.*?&gt;&lt;/iframe&gt;)|ms', $html, $content );&nbsp;</div></li><li><div>  <span class="comment">// We require at least the iframe to exist.</span>&nbsp;</div></li><li><div>  if ( empty( $content[2] ) ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  $html = $content[1] . $content[2];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $content[1] ) ) {&nbsp;</div></li><li><div>      <span class="comment">// We have a blockquote to fall back on. Hide the iframe by default.</span>&nbsp;</div></li><li><div>      $html = str_replace( '&lt;iframe', '&lt;iframe style=&quot;position: absolute; clip: rect(1px, 1px, 1px, 1px);&quot;', $html );&nbsp;</div></li><li><div>      $html = str_replace( '&lt;blockquote', '&lt;blockquote class=&quot;wp-embedded-content&quot;', $html );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html = str_replace( '&lt;iframe', '&lt;iframe class=&quot;wp-embedded-content&quot; sandbox=&quot;allow-scripts&quot; security=&quot;restricted&quot;', $html );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  preg_match( '/ src=[\'&quot;]([^\'&quot;]*)[\'&quot;]/', $html, $results );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $results ) ) {&nbsp;</div></li><li><div>      $secret = wp_generate_password( 10, false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $url = esc_url( &quot;{$results[1]}#?secret=$secret&quot; );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html = str_replace( $results[0], &quot; src=\&quot;$url\&quot; data-secret=\&quot;$secret\&quot;&quot;, $html );&nbsp;</div></li><li><div>      $html = str_replace( '&lt;blockquote', &quot;&lt;blockquote data-secret=\&quot;$secret\&quot;&quot;, $html );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $html;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Filters the string in the 'more' link displayed after a trimmed excerpt.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Replaces '[...]' (appended to automatically generated excerpts) with an</span>&nbsp;</div></li><li><div><span class="comment"> * ellipsis and a &quot;Continue reading&quot; link in the embed template.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $more_string Default 'more' string.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string 'Continue reading' link prepended with an ellipsis.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_embed_excerpt_more( $more_string ) {&nbsp;</div></li><li><div>  if ( ! is_embed() ) {&nbsp;</div></li><li><div>      return $more_string;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $link = sprintf( '&lt;a href=&quot;%1$s&quot; class=&quot;wp-embed-more&quot; target=&quot;_top&quot;&gt;%2$s&lt;/a&gt;', &nbsp;</div></li><li><div>      esc_url( get_permalink() ), &nbsp;</div></li><li><div>      <span class="comment">/** translators: %s: Name of current post */</span>&nbsp;</div></li><li><div>      sprintf( __( 'Continue reading %s' ), '&lt;span class=&quot;screen-reader-text&quot;&gt;' . get_the_title() . '&lt;/span&gt;' )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  return ' &hellip; ' . $link;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the post excerpt for the embed template.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Intended to be used in 'The Loop'.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function the_excerpt_embed() {&nbsp;</div></li><li><div>  $output = get_the_excerpt();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the post excerpt for the embed template.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $output The current post excerpt.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo apply_filters( 'the_excerpt_embed', $output );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Filters the post excerpt for the embed template.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Shows players for video and audio attachments.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $content The current post excerpt.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The modified post excerpt.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_embed_excerpt_attachment( $content ) {&nbsp;</div></li><li><div>  if ( is_attachment() ) {&nbsp;</div></li><li><div>      return prepend_attachment( '' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $content;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Enqueue embed iframe default CSS and JS & fire do_action('enqueue_embed_scripts')</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Enqueue PNG fallback CSS for embed iframe for legacy versions of IE.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Allows plugins to queue scripts for the embed iframe end using wp_enqueue_script().</span>&nbsp;</div></li><li><div><span class="comment"> * Runs first in oembed_head().</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function enqueue_embed_scripts() {&nbsp;</div></li><li><div>  wp_enqueue_style( 'wp-embed-template-ie' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Fires when scripts and styles are enqueued for the embed iframe.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  do_action( 'enqueue_embed_scripts' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Prints the CSS in the embed iframe header.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function print_embed_styles() {&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;style type=&quot;text/css&quot;&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>      if ( SCRIPT_DEBUG ) {&nbsp;</div></li><li><div>          readfile( ABSPATH . WPINC . &quot;/css/wp-embed-template.css&quot; );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * If you're looking at a src version of this file, you'll see an &quot;include&quot;</span>&nbsp;</div></li><li><div><span class="comment">           * statement below. This is used by the `grunt build` process to directly</span>&nbsp;</div></li><li><div><span class="comment">           * include a minified version of wp-oembed-embed.css, instead of using the</span>&nbsp;</div></li><li><div><span class="comment">           * readfile() method from above.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * If you're looking at a build version of this file, you'll see a string of</span>&nbsp;</div></li><li><div><span class="comment">           * minified CSS. If you need to debug it, please turn on SCRIPT_DEBUG</span>&nbsp;</div></li><li><div><span class="comment">           * and edit wp-embed-template.css directly.</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>          body, html{padding:0;margin:0}body{font-family:sans-serif}.wp-embed, .wp-embed-share-input{font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen-Sans, Ubuntu, Cantarell, &quot;Helvetica Neue&quot;, sans-serif}.screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute!important;width:1px}.dashicons{display:inline-block;width:20px;height:20px;background-color:transparent;background-repeat:no-repeat;-webkit-background-size:20px 20px;background-size:20px;background-position:center;-webkit-transition:background .1s ease-in;transition:background .1s ease-in;position:relative;top:5px}.dashicons-no{background-image:url(&quot;data:image/svg+xml;charset=utf8, %3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20viewBox%3D%270%200%2020%2020%27%3E%3Cpath%20d%3D%27M15.55%2013.7l-2.19%202.06-3.42-3.65-3.64%203.43-2.06-2.18%203.64-3.43-3.42-3.64%202.18-2.06%203.43%203.64%203.64-3.42%202.05%202.18-3.64%203.43z%27%20fill%3D%27%23fff%27%2F%3E%3C%2Fsvg%3E&quot;)}.dashicons-admin-comments{background-image:url(&quot;data:image/svg+xml;charset=utf8, %3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20viewBox%3D%270%200%2020%2020%27%3E%3Cpath%20d%3D%27M5%202h9q.82%200%201.41.59T16%204v7q0%20.82-.59%201.41T14%2013h-2l-5%205v-5H5q-.82%200-1.41-.59T3%2011V4q0-.82.59-1.41T5%202z%27%20fill%3D%27%2382878c%27%2F%3E%3C%2Fsvg%3E&quot;)}.wp-embed-comments a:hover .dashicons-admin-comments{background-image:url(&quot;data:image/svg+xml;charset=utf8, %3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20viewBox%3D%270%200%2020%2020%27%3E%3Cpath%20d%3D%27M5%202h9q.82%200%201.41.59T16%204v7q0%20.82-.59%201.41T14%2013h-2l-5%205v-5H5q-.82%200-1.41-.59T3%2011V4q0-.82.59-1.41T5%202z%27%20fill%3D%27%230073aa%27%2F%3E%3C%2Fsvg%3E&quot;)}.dashicons-share{background-image:url(&quot;data:image/svg+xml;charset=utf8, %3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20viewBox%3D%270%200%2020%2020%27%3E%3Cpath%20d%3D%27M14.5%2012q1.24%200%202.12.88T17.5%2015t-.88%202.12-2.12.88-2.12-.88T11.5%2015q0-.34.09-.69l-4.38-2.3Q6.32%2013%205%2013q-1.24%200-2.12-.88T2%2010t.88-2.12T5%207q1.3%200%202.21.99l4.38-2.3q-.09-.35-.09-.69%200-1.24.88-2.12T14.5%202t2.12.88T17.5%205t-.88%202.12T14.5%208q-1.3%200-2.21-.99l-4.38%202.3Q8%209.66%208%2010t-.09.69l4.38%202.3q.89-.99%202.21-.99z%27%20fill%3D%27%2382878c%27%2F%3E%3C%2Fsvg%3E&quot;);display:none}.js .dashicons-share{display:inline-block}.wp-embed-share-dialog-open:hover .dashicons-share{background-image:url(&quot;data:image/svg+xml;charset=utf8, %3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20viewBox%3D%270%200%2020%2020%27%3E%3Cpath%20d%3D%27M14.5%2012q1.24%200%202.12.88T17.5%2015t-.88%202.12-2.12.88-2.12-.88T11.5%2015q0-.34.09-.69l-4.38-2.3Q6.32%2013%205%2013q-1.24%200-2.12-.88T2%2010t.88-2.12T5%207q1.3%200%202.21.99l4.38-2.3q-.09-.35-.09-.69%200-1.24.88-2.12T14.5%202t2.12.88T17.5%205t-.88%202.12T14.5%208q-1.3%200-2.21-.99l-4.38%202.3Q8%209.66%208%2010t-.09.69l4.38%202.3q.89-.99%202.21-.99z%27%20fill%3D%27%230073aa%27%2F%3E%3C%2Fsvg%3E&quot;)}.wp-embed{padding:25px;font-size:14px;font-weight:400;line-height:1.5;color:#82878c;background:#fff;border:1px solid #e5e5e5;-webkit-box-shadow:0 1px 1px rgba(0, 0, 0, .05);box-shadow:0 1px 1px rgba(0, 0, 0, .05);overflow:auto;zoom:1}.wp-embed a{color:#82878c;text-decoration:none}.wp-embed a:hover{text-decoration:underline}.wp-embed-featured-image{margin-bottom:20px}.wp-embed-featured-image img{width:100%;height:auto;border:none}.wp-embed-featured-image.square{float:left;max-width:160px;margin-right:20px}.wp-embed p{margin:0}p.wp-embed-heading{margin:0 0 15px;font-weight:600;font-size:22px;line-height:1.3}.wp-embed-heading a{color:#32373c}.wp-embed .wp-embed-more{color:#b4b9be}.wp-embed-footer{display:table;width:100%;margin-top:30px}.wp-embed-site-icon{position:absolute;top:50%;left:0;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);height:25px;width:25px;border:0}.wp-embed-site-title{font-weight:600;line-height:25px}.wp-embed-site-title a{position:relative;display:inline-block;padding-left:35px}.wp-embed-meta, .wp-embed-site-title{display:table-cell}.wp-embed-meta{text-align:right;white-space:nowrap;vertical-align:middle}.wp-embed-comments, .wp-embed-share{display:inline}.wp-embed-comments a, .wp-embed-share-tab-button{display:inline-block}.wp-embed-meta a:hover{text-decoration:none;color:#0073aa}.wp-embed-comments a{line-height:25px}.wp-embed-comments+.wp-embed-share{margin-left:10px}.wp-embed-share-dialog{position:absolute;top:0;left:0;right:0;bottom:0;background-color:#222;background-color:rgba(10, 10, 10, .9);color:#fff;opacity:1;-webkit-transition:opacity .25s ease-in-out;transition:opacity .25s ease-in-out}.wp-embed-share-dialog.hidden{opacity:0;visibility:hidden}.wp-embed-share-dialog-close, .wp-embed-share-dialog-open{margin:-8px 0 0;padding:0;background:0 0;border:none;cursor:pointer;outline:0}.wp-embed-share-dialog-close .dashicons, .wp-embed-share-dialog-open .dashicons{padding:4px}.wp-embed-share-dialog-open .dashicons{top:8px}.wp-embed-share-dialog-close:focus .dashicons, .wp-embed-share-dialog-open:focus .dashicons{-webkit-box-shadow:0 0 0 1px #5b9dd9, 0 0 2px 1px rgba(30, 140, 190, .8);box-shadow:0 0 0 1px #5b9dd9, 0 0 2px 1px rgba(30, 140, 190, .8);-webkit-border-radius:100%;border-radius:100%}.wp-embed-share-dialog-close{position:absolute;top:20px;right:20px;font-size:22px}.wp-embed-share-dialog-close:hover{text-decoration:none}.wp-embed-share-dialog-close .dashicons{height:24px;width:24px;-webkit-background-size:24px 24px;background-size:24px}.wp-embed-share-dialog-content{height:100%;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;overflow:hidden}.wp-embed-share-dialog-text{margin-top:25px;padding:20px}.wp-embed-share-tabs{margin:0 0 20px;padding:0;list-style:none}.wp-embed-share-tab-button button{margin:0;padding:0;border:none;background:0 0;font-size:16px;line-height:1.3;color:#aaa;cursor:pointer;-webkit-transition:color .1s ease-in;transition:color .1s ease-in}.wp-embed-share-tab-button [aria-selected=true], .wp-embed-share-tab-button button:hover{color:#fff}.wp-embed-share-tab-button+.wp-embed-share-tab-button{margin:0 0 0 10px;padding:0 0 0 11px;border-left:1px solid #aaa}.wp-embed-share-tab[aria-hidden=true]{display:none}p.wp-embed-share-description{margin:0;font-size:14px;line-height:1;font-style:italic;color:#aaa}.wp-embed-share-input{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:100%;border:none;height:28px;margin:0 0 10px;padding:0 5px;font-size:14px;font-weight:400;line-height:1.5;resize:none;cursor:text}textarea.wp-embed-share-input{height:72px}html[dir=rtl] .wp-embed-featured-image.square{float:right;margin-right:0;margin-left:20px}html[dir=rtl] .wp-embed-site-title a{padding-left:0;padding-right:35px}html[dir=rtl] .wp-embed-site-icon{margin-right:0;margin-left:10px;left:auto;right:0}html[dir=rtl] .wp-embed-meta{text-align:left}html[dir=rtl] .wp-embed-share{margin-left:0;margin-right:10px}html[dir=rtl] .wp-embed-share-dialog-close{right:auto;left:20px}html[dir=rtl] .wp-embed-share-tab-button+.wp-embed-share-tab-button{margin:0 10px 0 0;padding:0 11px 0 0;border-left:none;border-right:1px solid #aaa}&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;/style&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Prints the JavaScript in the embed iframe header.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function print_embed_scripts() {&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>      if ( SCRIPT_DEBUG ) {&nbsp;</div></li><li><div>          readfile( ABSPATH . WPINC . &quot;/js/wp-embed-template.js&quot; );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * If you're looking at a src version of this file, you'll see an &quot;include&quot;</span>&nbsp;</div></li><li><div><span class="comment">           * statement below. This is used by the `grunt build` process to directly</span>&nbsp;</div></li><li><div><span class="comment">           * include a minified version of wp-embed-template.js, instead of using the</span>&nbsp;</div></li><li><div><span class="comment">           * readfile() method from above.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * If you're looking at a build version of this file, you'll see a string of</span>&nbsp;</div></li><li><div><span class="comment">           * minified JavaScript. If you need to debug it, please turn on SCRIPT_DEBUG</span>&nbsp;</div></li><li><div><span class="comment">           * and edit wp-embed-template.js directly.</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>          !function(a, b) {&quot;use strict&quot;;function c(b, c) {a.parent.postMessage({message:b, value:c, secret:g}, &quot;*&quot;)}function d() {function d() {l.className=l.className.replace(&quot;hidden&quot;, &quot;&quot;), b.querySelector('.wp-embed-share-tab-button [aria-selected=&quot;true&quot;]').focus()}function e() {l.className+=&quot; hidden&quot;, b.querySelector(&quot;.wp-embed-share-dialog-open&quot;).focus()}function f(a) {var c=b.querySelector('.wp-embed-share-tab-button [aria-selected=&quot;true&quot;]');c.setAttribute(&quot;aria-selected&quot;, &quot;false&quot;), b.querySelector(&quot;#&quot;+c.getAttribute(&quot;aria-controls&quot;)).setAttribute(&quot;aria-hidden&quot;, &quot;true&quot;), a.target.setAttribute(&quot;aria-selected&quot;, &quot;true&quot;), b.querySelector(&quot;#&quot;+a.target.getAttribute(&quot;aria-controls&quot;)).setAttribute(&quot;aria-hidden&quot;, &quot;false&quot;)}function g(a) {var c, d, e=a.target, f=e.parentElement.previousElementSibling, g=e.parentElement.nextElementSibling;if(37===a.keyCode)c=f;else{if(39!==a.keyCode)return!1;c=g}&quot;rtl&quot;===b.documentElement.getAttribute(&quot;dir&quot;)&&(c=c===f?g:f), c&&(d=c.firstElementChild, e.setAttribute(&quot;tabindex&quot;, &quot;-1&quot;), e.setAttribute(&quot;aria-selected&quot;, !1), b.querySelector(&quot;#&quot;+e.getAttribute(&quot;aria-controls&quot;)).setAttribute(&quot;aria-hidden&quot;, &quot;true&quot;), d.setAttribute(&quot;tabindex&quot;, &quot;0&quot;), d.setAttribute(&quot;aria-selected&quot;, &quot;true&quot;), d.focus(), b.querySelector(&quot;#&quot;+d.getAttribute(&quot;aria-controls&quot;)).setAttribute(&quot;aria-hidden&quot;, &quot;false&quot;))}function h(a) {var c=b.querySelector('.wp-embed-share-tab-button [aria-selected=&quot;true&quot;]');n!==a.target||a.shiftKey?c===a.target&&a.shiftKey&&(n.focus(), a.preventDefault()):(c.focus(), a.preventDefault())}function i(a) {var b, d=a.target;b=d.hasAttribute(&quot;href&quot;)?d.getAttribute(&quot;href&quot;):d.parentElement.getAttribute(&quot;href&quot;), b&&(c(&quot;link&quot;, b), a.preventDefault())}if(!k) {k=!0;var j, l=b.querySelector(&quot;.wp-embed-share-dialog&quot;), m=b.querySelector(&quot;.wp-embed-share-dialog-open&quot;), n=b.querySelector(&quot;.wp-embed-share-dialog-close&quot;), o=b.querySelectorAll(&quot;.wp-embed-share-input&quot;), p=b.querySelectorAll(&quot;.wp-embed-share-tab-button button&quot;), q=b.querySelector(&quot;.wp-embed-featured-image img&quot;);if(o)for(j=0;j&lt;o.length;j++)o[j].addEventListener(&quot;click&quot;, function(a) {a.target.select()});if(m&&m.addEventListener(&quot;click&quot;, function() {d()}), n&&n.addEventListener(&quot;click&quot;, function() {e()}), p)for(j=0;j&lt;p.length;j++)p[j].addEventListener(&quot;click&quot;, f), p[j].addEventListener(&quot;keydown&quot;, g);b.addEventListener(&quot;keydown&quot;, function(a) {27===a.keyCode&&-1===l.className.indexOf(&quot;hidden&quot;)?e():9===a.keyCode&&h(a)}, !1), a.self!==a.top&&(c(&quot;height&quot;, Math.ceil(b.body.getBoundingClientRect().height)), q&&q.addEventListener(&quot;load&quot;, function() {c(&quot;height&quot;, Math.ceil(b.body.getBoundingClientRect().height))}), b.addEventListener(&quot;click&quot;, i))}}function e() {a.self!==a.top&&(clearTimeout(i), i=setTimeout(function() {c(&quot;height&quot;, Math.ceil(b.body.getBoundingClientRect().height))}, 100))}function f() {a.self===a.top||g||(g=a.location.hash.replace(/.*secret=([\d\w]{10}).*/, &quot;$1&quot;), clearTimeout(h), h=setTimeout(function() {f()}, 100))}var g, h, i, j=b.querySelector&&a.addEventListener, k=!1;j&&(f(), b.documentElement.className=b.documentElement.className.replace(/\bno-js\b/, &quot;&quot;)+&quot; js&quot;, b.addEventListener(&quot;DOMContentLoaded&quot;, d, !1), a.addEventListener(&quot;load&quot;, d, !1), a.addEventListener(&quot;resize&quot;, e, !1))}(window, document);&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;/script&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Prepare the oembed HTML to be displayed in an RSS feed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $content The content to filter.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The filtered content.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _oembed_filter_feed_content( $content ) {&nbsp;</div></li><li><div>  return str_replace( '&lt;iframe class=&quot;wp-embedded-content&quot; sandbox=&quot;allow-scripts&quot; security=&quot;restricted&quot; style=&quot;position: absolute; clip: rect(1px, 1px, 1px, 1px);&quot;', '&lt;iframe class=&quot;wp-embedded-content&quot; sandbox=&quot;allow-scripts&quot; security=&quot;restricted&quot;', $content );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Prints the necessary markup for the embed comments button.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function print_embed_comments_button() {&nbsp;</div></li><li><div>  if ( is_404() || ! ( get_comments_number() || comments_open() ) ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;div class=&quot;wp-embed-comments&quot;&gt;&nbsp;</div></li><li><div>      &lt;a href=&quot;&lt;?php comments_link(); ?&gt;&quot; target=&quot;_top&quot;&gt;&nbsp;</div></li><li><div>          &lt;span class=&quot;dashicons dashicons-admin-comments&quot;&gt;&lt;/span&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>          printf(&nbsp;</div></li><li><div>              _n(&nbsp;</div></li><li><div>                  '%s &lt;span class=&quot;screen-reader-text&quot;&gt;Comment&lt;/span&gt;', &nbsp;</div></li><li><div>                  '%s &lt;span class=&quot;screen-reader-text&quot;&gt;Comments&lt;/span&gt;', &nbsp;</div></li><li><div>                  get_comments_number()&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>              number_format_i18n( get_comments_number() )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>      &lt;/a&gt;&nbsp;</div></li><li><div>  &lt;/div&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Prints the necessary markup for the embed sharing button.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function print_embed_sharing_button() {&nbsp;</div></li><li><div>  if ( is_404() ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;div class=&quot;wp-embed-share&quot;&gt;&nbsp;</div></li><li><div>      &lt;button type=&quot;button&quot; class=&quot;wp-embed-share-dialog-open&quot; aria-label=&quot;&lt;?php esc_attr_e( 'Open sharing dialog' ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>          &lt;span class=&quot;dashicons dashicons-share&quot;&gt;&lt;/span&gt;&nbsp;</div></li><li><div>      &lt;/button&gt;&nbsp;</div></li><li><div>  &lt;/div&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Prints the necessary markup for the embed sharing dialog.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function print_embed_sharing_dialog() {&nbsp;</div></li><li><div>  if ( is_404() ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;div class=&quot;wp-embed-share-dialog hidden&quot; role=&quot;dialog&quot; aria-label=&quot;&lt;?php esc_attr_e( 'Sharing options' ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>      &lt;div class=&quot;wp-embed-share-dialog-content&quot;&gt;&nbsp;</div></li><li><div>          &lt;div class=&quot;wp-embed-share-dialog-text&quot;&gt;&nbsp;</div></li><li><div>              &lt;ul class=&quot;wp-embed-share-tabs&quot; role=&quot;tablist&quot;&gt;&nbsp;</div></li><li><div>                  &lt;li class=&quot;wp-embed-share-tab-button wp-embed-share-tab-button-wordpress&quot; role=&quot;presentation&quot;&gt;&nbsp;</div></li><li><div>                      &lt;button type=&quot;button&quot; role=&quot;tab&quot; aria-controls=&quot;wp-embed-share-tab-wordpress&quot; aria-selected=&quot;true&quot; tabindex=&quot;0&quot;&gt;&lt;?php esc_html_e( 'WordPress Embed' ); ?&gt;&lt;/button&gt;&nbsp;</div></li><li><div>                  &lt;/li&gt;&nbsp;</div></li><li><div>                  &lt;li class=&quot;wp-embed-share-tab-button wp-embed-share-tab-button-html&quot; role=&quot;presentation&quot;&gt;&nbsp;</div></li><li><div>                      &lt;button type=&quot;button&quot; role=&quot;tab&quot; aria-controls=&quot;wp-embed-share-tab-html&quot; aria-selected=&quot;false&quot; tabindex=&quot;-1&quot;&gt;&lt;?php esc_html_e( 'HTML Embed' ); ?&gt;&lt;/button&gt;&nbsp;</div></li><li><div>                  &lt;/li&gt;&nbsp;</div></li><li><div>              &lt;/ul&gt;&nbsp;</div></li><li><div>              &lt;div id=&quot;wp-embed-share-tab-wordpress&quot; class=&quot;wp-embed-share-tab&quot; role=&quot;tabpanel&quot; aria-hidden=&quot;false&quot;&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; value=&quot;&lt;?php the_permalink(); ?&gt;&quot; class=&quot;wp-embed-share-input&quot; aria-describedby=&quot;wp-embed-share-description-wordpress&quot; tabindex=&quot;0&quot; readonly/&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;p class=&quot;wp-embed-share-description&quot; id=&quot;wp-embed-share-description-wordpress&quot;&gt;&nbsp;</div></li><li><div>                      &lt;?php _e( 'Copy and paste this URL into your WordPress site to embed' ); ?&gt;&nbsp;</div></li><li><div>                  &lt;/p&gt;&nbsp;</div></li><li><div>              &lt;/div&gt;&nbsp;</div></li><li><div>              &lt;div id=&quot;wp-embed-share-tab-html&quot; class=&quot;wp-embed-share-tab&quot; role=&quot;tabpanel&quot; aria-hidden=&quot;true&quot;&gt;&nbsp;</div></li><li><div>                  &lt;textarea class=&quot;wp-embed-share-input&quot; aria-describedby=&quot;wp-embed-share-description-html&quot; tabindex=&quot;0&quot; readonly&gt;&lt;?php echo esc_textarea( get_post_embed_html( 600, 400 ) ); ?&gt;&lt;/textarea&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;p class=&quot;wp-embed-share-description&quot; id=&quot;wp-embed-share-description-html&quot;&gt;&nbsp;</div></li><li><div>                      &lt;?php _e( 'Copy and paste this code into your site to embed' ); ?&gt;&nbsp;</div></li><li><div>                  &lt;/p&gt;&nbsp;</div></li><li><div>              &lt;/div&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;button type=&quot;button&quot; class=&quot;wp-embed-share-dialog-close&quot; aria-label=&quot;&lt;?php esc_attr_e( 'Close sharing dialog' ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>              &lt;span class=&quot;dashicons dashicons-no&quot;&gt;&lt;/span&gt;&nbsp;</div></li><li><div>          &lt;/button&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>  &lt;/div&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Prints the necessary markup for the site title in an embed template.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.5.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function the_embed_site_title() {&nbsp;</div></li><li><div>  $site_title = sprintf(&nbsp;</div></li><li><div>      '&lt;a href=&quot;%s&quot; target=&quot;_top&quot;&gt;&lt;img src=&quot;%s&quot; srcset=&quot;%s 2x&quot; width=&quot;32&quot; height=&quot;32&quot; alt=&quot;&quot; class=&quot;wp-embed-site-icon&quot;/&gt;&lt;span&gt;%s&lt;/span&gt;&lt;/a&gt;', &nbsp;</div></li><li><div>      esc_url( home_url() ), &nbsp;</div></li><li><div>      esc_url( get_site_icon_url( 32, admin_url( 'images/w-logo-blue.png' ) ) ), &nbsp;</div></li><li><div>      esc_url( get_site_icon_url( 64, admin_url( 'images/w-logo-blue.png' ) ) ), &nbsp;</div></li><li><div>      esc_html( get_bloginfo( 'name' ) )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $site_title = '&lt;div class=&quot;wp-embed-site-title&quot;&gt;' . $site_title . '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the site title HTML in the embed footer.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $site_title The site title HTML.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo apply_filters( 'embed_site_title_html', $site_title );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Filters the oEmbed result before any HTTP requests are made.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * If the URL belongs to the current site, the result is fetched directly instead of</span>&nbsp;</div></li><li><div><span class="comment"> * going through the oEmbed discovery process.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.5.3</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param null|string $result The UNSANITIZED (and potentially unsafe) HTML that should be used to embed. Default null.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string      $url    The URL that should be inspected for discovery `&lt;link&gt;` tags.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array       $args   oEmbed remote get arguments.</span>&nbsp;</div></li><li><div><span class="comment"> * @return null|string The UNSANITIZED (and potentially unsafe) HTML that should be used to embed.</span>&nbsp;</div></li><li><div><span class="comment"> *                     Null if the URL does not belong to the current site.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_filter_pre_oembed_result( $result, $url, $args ) {&nbsp;</div></li><li><div>  $post_id = url_to_postid( $url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/** This filter is documented in wp-includes/class-wp-oembed-controller.php */</span>&nbsp;</div></li><li><div>  $post_id = apply_filters( 'oembed_request_post_id', $post_id, $url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $post_id ) {&nbsp;</div></li><li><div>      return $result;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $width = isset( $args['width'] ) ? $args['width'] : 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $data = get_oembed_response_data( $post_id, $width );&nbsp;</div></li><li><div>  $data = _wp_oembed_get_object()-&gt;data2html( (object) $data, $url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $data ) {&nbsp;</div></li><li><div>      return $result;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $data;&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>wordpress</li><li><span></span>file</li><li><span></span></li><li><span></span>wp-include</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2019 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>