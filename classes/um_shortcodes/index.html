<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="wordpress" data-id="84601"><head xmlns="http://www.w3.org/1999/xhtml"><title> um_shortcodes | class | WordPress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="UM_Shortcodes, class, plugin, ultimate-member, 1.3.82" /><meta name="description" content="The WordPress Core UM Shortcodes class." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=b856600735fe00a4d27e77ac44f479d2' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/um_shortcodes/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fum_shortcodes%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fum_shortcodes%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"wordpress-1.3.82-class-um_shortcodes","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="um_shortcodes" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to ultimate-member." href="http://hookr.io/plugins/ultimate-member/" class="plugin"><span property="name">ultimate-member</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 1.3.82." href="http://hookr.io/plugins/ultimate-member/1.3.82/" class="H_VERSION"><span property="name">1.3.82</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/ultimate-member/1.3.82/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">um_shortcodes</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="0"><a href="http://hookr.io/1.3.82/all/" title="All">All <span class="count badge">0</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/1.3.82/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="0"><a href="http://hookr.io/1.3.82/hooks/" title="Hooks">Hooks <span class="count badge">0</span></a></li><li class="" data-id="action" data-count="0"><a href="http://hookr.io/1.3.82/actions/" title="Actions">Actions <span class="count badge">0</span></a></li><li class="" data-id="filter" data-count="0"><a href="http://hookr.io/1.3.82/filters/" title="Filters">Filters <span class="count badge">0</span></a></li><li class="active" data-id="class" data-count="0"><a href="http://hookr.io/1.3.82/classes/" title="Classes">Classes <span class="count badge">0</span></a></li><li class="" data-id="constant" data-count="0"><a href="http://hookr.io/1.3.82/constants/" title="Constants">Constants <span class="count badge">0</span></a></li><li class="" data-id="function" data-count="0"><a href="http://hookr.io/1.3.82/functions/" title="Functions">Functions <span class="count badge">0</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/1.3.82/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>UM_Shortcodes</strong></h1><p>The WordPress Core <strong>UM Shortcodes</strong> class.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/ultimate-member/1.3.82/files/core-um-shortcodes/" class="file">/core/um-shortcodes.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="3" class="block" start="3"><li><div>class UM_Shortcodes {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function __construct() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;message_mode = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;loop = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_shortcode('ultimatemember', array(&$this, 'ultimatemember'), 1);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_shortcode('um_loggedin', array(&$this, 'um_loggedin'));&nbsp;</div></li><li><div>        add_shortcode('um_loggedout', array(&$this, 'um_loggedout'));&nbsp;</div></li><li><div>        add_shortcode('um_show_content', array(&$this, 'um_shortcode_show_content_for_role') );&nbsp;</div></li><li><div>        add_shortcode('ultimatemember_searchform', array(&$this, 'ultimatemember_searchform') );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_filter('body_class', array(&$this, 'body_class'), 0);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $base_uri = apply_filters('um_emoji_base_uri', 'https://s.w.org/images/core/emoji/');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;emoji[':)'] = $base_uri . '72x72/1f604.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':smiley:'] = $base_uri . '72x72/1f603.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':D'] = $base_uri . '72x72/1f600.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':$'] = $base_uri . '72x72/1f60a.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':relaxed:'] = $base_uri . '72x72/263a.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[';)'] = $base_uri . '72x72/1f609.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':heart_eyes:'] = $base_uri . '72x72/1f60d.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':kissing_heart:'] = $base_uri . '72x72/1f618.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':kissing_closed_eyes:'] = $base_uri . '72x72/1f61a.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':kissing:'] = $base_uri . '72x72/1f617.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':kissing_smiling_eyes:'] = $base_uri . '72x72/1f619.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[';P'] = $base_uri . '72x72/1f61c.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':P'] = $base_uri . '72x72/1f61b.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':stuck_out_tongue_closed_eyes:'] = $base_uri . '72x72/1f61d.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':flushed:'] = $base_uri . '72x72/1f633.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':grin:'] = $base_uri . '72x72/1f601.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':pensive:'] = $base_uri . '72x72/1f614.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':relieved:'] = $base_uri . '72x72/1f60c.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':unamused'] = $base_uri . '72x72/1f612.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':('] = $base_uri . '72x72/1f61e.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':persevere:'] = $base_uri . '72x72/1f623.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[&quot;:'(&quot;] = $base_uri . '72x72/1f622.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':joy:'] = $base_uri . '72x72/1f602.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':sob:'] = $base_uri . '72x72/1f62d.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':sleepy:'] = $base_uri . '72x72/1f62a.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':disappointed_relieved:'] = $base_uri . '72x72/1f625.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':cold_sweat:'] = $base_uri . '72x72/1f630.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':sweat_smile:'] = $base_uri . '72x72/1f605.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':sweat:'] = $base_uri . '72x72/1f613.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':weary:'] = $base_uri . '72x72/1f629.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':tired_face:'] = $base_uri . '72x72/1f62b.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':fearful:'] = $base_uri . '72x72/1f628.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':scream:'] = $base_uri . '72x72/1f631.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':angry:'] = $base_uri . '72x72/1f620.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':rage:'] = $base_uri . '72x72/1f621.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':triumph'] = $base_uri . '72x72/1f624.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':confounded:'] = $base_uri . '72x72/1f616.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':laughing:'] = $base_uri . '72x72/1f606.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':yum:'] = $base_uri . '72x72/1f60b.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':mask:'] = $base_uri . '72x72/1f637.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':cool:'] = $base_uri . '72x72/1f60e.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':sleeping:'] = $base_uri . '72x72/1f634.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':dizzy_face:'] = $base_uri . '72x72/1f635.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':astonished:'] = $base_uri . '72x72/1f632.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':worried:'] = $base_uri . '72x72/1f61f.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':frowning:'] = $base_uri . '72x72/1f626.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':anguished:'] = $base_uri . '72x72/1f627.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':smiling_imp:'] = $base_uri . '72x72/1f608.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':imp:'] = $base_uri . '72x72/1f47f.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':open_mouth:'] = $base_uri . '72x72/1f62e.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':grimacing:'] = $base_uri . '72x72/1f62c.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':neutral_face:'] = $base_uri . '72x72/1f610.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':confused:'] = $base_uri . '72x72/1f615.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':hushed:'] = $base_uri . '72x72/1f62f.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':no_mouth:'] = $base_uri . '72x72/1f636.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':innocent:'] = $base_uri . '72x72/1f607.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':smirk:'] = $base_uri . '72x72/1f60f.png';&nbsp;</div></li><li><div>        $this-&gt;emoji[':expressionless:'] = $base_uri . '72x72/1f611.png';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @emoji support&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function emotize($content) {&nbsp;</div></li><li><div>        $content = stripslashes($content);&nbsp;</div></li><li><div>        foreach ($this-&gt;emoji as $code =&gt; $val) {&nbsp;</div></li><li><div>            $regex = str_replace(array('(', ')'), array(&quot;\\&quot; . '(', &quot;\\&quot; . ')'), $code);&nbsp;</div></li><li><div>            $content = preg_replace('/(' . $regex . ')(\s|$)/', '&lt;img src=&quot;' . $val . '&quot; alt=&quot;' . $code . '&quot; title=&quot;' . $code . '&quot; class=&quot;emoji&quot; /&gt;$2', $content);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $content;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @extend body classes&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function body_class($classes) {&nbsp;</div></li><li><div>        global $ultimatemember;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $array = $ultimatemember-&gt;permalinks-&gt;core;&nbsp;</div></li><li><div>        if (!$array) {&nbsp;</div></li><li><div>            return $classes;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ($array as $slug =&gt; $info) {&nbsp;</div></li><li><div>            if (um_is_core_page($slug)) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $classes[] = 'um-page-' . $slug;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if (is_user_logged_in()) {&nbsp;</div></li><li><div>                    $classes[] = 'um-page-loggedin';&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $classes[] = 'um-page-loggedout';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( um_is_core_page('user') && um_is_user_himself() ) {&nbsp;</div></li><li><div>            $classes[] = 'um-own-profile';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $classes;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @Retrieve core login form&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function core_login_form() {&nbsp;</div></li><li><div>        $forms = get_posts(array('post_type' =&gt; 'um_form', 'posts_per_page' =&gt; 1, 'meta_key' =&gt; '_um_core', 'meta_value' =&gt; 'login'));&nbsp;</div></li><li><div>        $form_id = isset( $forms[0]-&gt;ID ) ? $forms[0]-&gt;ID: 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $form_id;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @load a compatible template&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function load_template($tpl) {&nbsp;</div></li><li><div>        global $ultimatemember;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $loop = ($this-&gt;loop) ? $this-&gt;loop : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset($this-&gt;set_args) && is_array($this-&gt;set_args)) {&nbsp;</div></li><li><div>            $args = $this-&gt;set_args;&nbsp;</div></li><li><div>            extract($args);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $file = um_path . 'templates/' . $tpl . '.php';&nbsp;</div></li><li><div>        $theme_file = get_stylesheet_directory() . '/ultimate-member/templates/' . $tpl . '.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (file_exists($theme_file)) {&nbsp;</div></li><li><div>            $file = $theme_file;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (file_exists($file)) {&nbsp;</div></li><li><div>            include $file;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @Add class based on shortcode&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function get_class($mode, $args = array()) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        global $ultimatemember;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $classes = 'um-' . $mode;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (is_admin()) {&nbsp;</div></li><li><div>            $classes .= ' um-in-admin';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset($ultimatemember-&gt;form-&gt;errors) && $ultimatemember-&gt;form-&gt;errors) {&nbsp;</div></li><li><div>            $classes .= ' um-err';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ($ultimatemember-&gt;fields-&gt;editing == true) {&nbsp;</div></li><li><div>            $classes .= ' um-editing';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ($ultimatemember-&gt;fields-&gt;viewing == true) {&nbsp;</div></li><li><div>            $classes .= ' um-viewing';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset($args['template']) && $args['template'] != $args['mode']) {&nbsp;</div></li><li><div>            $classes .= ' um-' . $args['template'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $classes = apply_filters('um_form_official_classes__hook', $classes);&nbsp;</div></li><li><div>        return $classes;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @Logged-in only content&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function um_loggedin($args = array(), $content = &quot;&quot;) {&nbsp;</div></li><li><div>        global $ultimatemember;&nbsp;</div></li><li><div>        ob_start();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $defaults = array(&nbsp;</div></li><li><div>            'lock_text' =&gt; __('This content has been restricted to logged in users only. Please &lt;a href=&quot;{login_referrer}&quot;&gt;login&lt;/a&gt; to view this content.', 'ultimatemember'), &nbsp;</div></li><li><div>            'show_lock' =&gt; 'yes', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $args = wp_parse_args($args, $defaults);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $args['lock_text'] = $this-&gt;convert_locker_tags($args['lock_text']);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (!is_user_logged_in()) {&nbsp;</div></li><li><div>            if ($args['show_lock'] == 'no') {&nbsp;</div></li><li><div>                echo '';&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $ultimatemember-&gt;shortcodes-&gt;set_args = $args;&nbsp;</div></li><li><div>                $ultimatemember-&gt;shortcodes-&gt;load_template('login-to-view');&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            echo do_shortcode($this-&gt;convert_locker_tags(wpautop($content)));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output = ob_get_contents();&nbsp;</div></li><li><div>        ob_end_clean();&nbsp;</div></li><li><div>        return $output;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @Logged-out only content&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function um_loggedout($args = array(), $content = &quot;&quot;) {&nbsp;</div></li><li><div>        global $ultimatemember;&nbsp;</div></li><li><div>        ob_start();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Hide for logged in users&nbsp;</div></li><li><div>        if (is_user_logged_in()) {&nbsp;</div></li><li><div>            echo '';&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            echo do_shortcode(wpautop($content));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output = ob_get_contents();&nbsp;</div></li><li><div>        ob_end_clean();&nbsp;</div></li><li><div>        return $output;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @Shortcode&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function ultimatemember($args = array()) {&nbsp;</div></li><li><div>        return $this-&gt;load($args);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @Load a module with global function&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function load($args) {&nbsp;</div></li><li><div>        global $ultimatemember;&nbsp;</div></li><li><div>        ob_start();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $defaults = array();&nbsp;</div></li><li><div>        $args = wp_parse_args($args, $defaults);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // when to not continue&nbsp;</div></li><li><div>        $this-&gt;form_id = (isset($args['form_id'])) ? $args['form_id'] : null;&nbsp;</div></li><li><div>        if (!$this-&gt;form_id) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;form_status = get_post_status($this-&gt;form_id);&nbsp;</div></li><li><div>        if ($this-&gt;form_status != 'publish') {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // get data into one global array&nbsp;</div></li><li><div>        $post_data = $ultimatemember-&gt;query-&gt;post_data($this-&gt;form_id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $args = apply_filters('um_pre_args_setup', $post_data);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (!isset($args['template'])) {&nbsp;</div></li><li><div>            $args['template'] = '';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset($post_data['template']) && $post_data['template'] != $args['template']) {&nbsp;</div></li><li><div>            $args['template'] = $post_data['template'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (!$this-&gt;template_exists($args['template'])) {&nbsp;</div></li><li><div>            $args['template'] = $post_data['mode'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (!isset($post_data['template'])) {&nbsp;</div></li><li><div>            $post_data['template'] = $post_data['mode'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $args = array_merge($post_data, $args);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset($args['use_globals']) && $args['use_globals'] == 1) {&nbsp;</div></li><li><div>            $args = array_merge($args, $this-&gt;get_css_args($args));&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $args = array_merge($this-&gt;get_css_args($args), $args);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // filter for arguments&nbsp;</div></li><li><div>        $args = apply_filters('um_shortcode_args_filter', $args);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        extract($args, EXTR_SKIP);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // for profiles only&nbsp;</div></li><li><div>        if ($mode == 'profile' && um_profile_id() && isset($args['role']) && $args['role'] &&&nbsp;</div></li><li><div>            $args['role'] != $ultimatemember-&gt;query-&gt;get_role_by_userid(um_profile_id())) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // start loading the template here&nbsp;</div></li><li><div>        do_action(&quot;um_pre_{$mode}_shortcode&quot;, $args);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action(&quot;um_before_form_is_loaded&quot;, $args);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action(&quot;um_before_{$mode}_form_is_loaded&quot;, $args);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;template_load($template, $args);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;dynamic_css($args);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (um_get_requested_user() || $mode == 'logout') {&nbsp;</div></li><li><div>            um_reset_user();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action('um_after_everything_output');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output = ob_get_contents();&nbsp;</div></li><li><div>        ob_end_clean();&nbsp;</div></li><li><div>        return $output;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @Get dynamic css args&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function get_css_args($args) {&nbsp;</div></li><li><div>        $arr = um_styling_defaults($args['mode']);&nbsp;</div></li><li><div>        $arr = array_merge($arr, array('form_id' =&gt; $args['form_id'], 'mode' =&gt; $args['mode']));&nbsp;</div></li><li><div>        return $arr;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @Load dynamic css&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function dynamic_css($args = array()) {&nbsp;</div></li><li><div>        global $ultimatemember;&nbsp;</div></li><li><div>        extract($args);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $global = um_path . 'assets/dynamic_css/dynamic_global.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset($mode)) {&nbsp;</div></li><li><div>            $file = um_path . 'assets/dynamic_css/dynamic_' . $mode . '.php';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        include $global;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset($file) && file_exists($file)) {&nbsp;</div></li><li><div>            include $file;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset($args['custom_css'])) {&nbsp;</div></li><li><div>            $css = $args['custom_css'];&nbsp;</div></li><li><div>            ?&gt;&lt;!-- ULTIMATE MEMBER FORM INLINE CSS BEGIN --&gt;&lt;style type=&quot;text/css&quot;&gt;&lt;?php print $ultimatemember-&gt;styles-&gt;minify($css);?&gt;&lt;/style&gt;&lt;!-- ULTIMATE MEMBER FORM INLINE CSS END --&gt;&lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @Loads a template file&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function template_load($template, $args = array()) {&nbsp;</div></li><li><div>        global $ultimatemember;&nbsp;</div></li><li><div>        if (is_array($args)) {&nbsp;</div></li><li><div>            $ultimatemember-&gt;shortcodes-&gt;set_args = $args;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $ultimatemember-&gt;shortcodes-&gt;load_template($template);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @Checks if a template file exists&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function template_exists($template) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $file = um_path . 'templates/' . $template . '.php';&nbsp;</div></li><li><div>        $theme_file = get_stylesheet_directory() . '/ultimate-member/templates/' . $template . '.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (file_exists($theme_file) || file_exists($file)) {&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @Get File Name without path and extension&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function get_template_name($file) {&nbsp;</div></li><li><div>        $file = basename($file);&nbsp;</div></li><li><div>        $file = preg_replace('/\\.[^.\\s]{3, 4}$/', '', $file);&nbsp;</div></li><li><div>        return $file;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @Get Templates&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function get_templates($excluded = null) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ($excluded) {&nbsp;</div></li><li><div>            $array[$excluded] = __('Default Template', 'ultimatemember');&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $paths[] = glob(um_path . 'templates/' . '*.php');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (file_exists(get_stylesheet_directory() . '/ultimate-member/templates/')) {&nbsp;</div></li><li><div>            $paths[] = glob(get_stylesheet_directory() . '/ultimate-member/templates/' . '*.php');&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( isset( $paths ) && ! empty( $paths ) ) {&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            foreach ($paths as $k =&gt; $files) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if( isset( $files ) && ! empty( $files ) ) {&nbsp;</div></li><li><div>                    &nbsp;</div></li><li><div>                    foreach ($files as $file) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        $clean_filename = $this-&gt;get_template_name( $file );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        if ( 0 === strpos( $clean_filename, $excluded ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            $source = file_get_contents( $file );&nbsp;</div></li><li><div>                            $tokens = token_get_all( $source );&nbsp;</div></li><li><div>                            $comment = array(&nbsp;</div></li><li><div>                                T_COMMENT, // All comments since PHP5&nbsp;</div></li><li><div>                                T_DOC_COMMENT, // PHPDoc comments&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                                foreach ( $tokens as $token ) {&nbsp;</div></li><li><div>                                    if ( in_array( $token[0], $comment ) && strstr( $token[1], '/* Template:' ) && $clean_filename != $excluded ) {&nbsp;</div></li><li><div>                                        $txt = $token[1];&nbsp;</div></li><li><div>                                        $txt = str_replace('/* Template: ', '', $txt );&nbsp;</div></li><li><div>                                        $txt = str_replace(' */', '', $txt );&nbsp;</div></li><li><div>                                        $array[ $clean_filename ] = $txt;&nbsp;</div></li><li><div>                                    }&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $array;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @Get Shortcode for given form ID&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function get_shortcode($post_id) {&nbsp;</div></li><li><div>        $shortcode = '[ultimatemember form_id=' . $post_id . ']';&nbsp;</div></li><li><div>        return $shortcode;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @convert access lock tags&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function convert_locker_tags($str) {&nbsp;</div></li><li><div>        $str = um_convert_tags($str);&nbsp;</div></li><li><div>        return $str;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /***&nbsp;</div></li><li><div>        ***    @convert user tags in a string&nbsp;</div></li><li><div>    */&nbsp;</div></li><li><div>    function convert_user_tags($str) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $value = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pattern_array = array(&nbsp;</div></li><li><div>            '{first_name}', &nbsp;</div></li><li><div>            '{last_name}', &nbsp;</div></li><li><div>            '{display_name}', &nbsp;</div></li><li><div>            '{user_avatar_small}', &nbsp;</div></li><li><div>            '{username}', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pattern_array = apply_filters('um_allowed_user_tags_patterns', $pattern_array);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $matches = false;&nbsp;</div></li><li><div>        foreach ($pattern_array as $pattern) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if (preg_match($pattern, $str)) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $usermeta = str_replace('{', '', $pattern);&nbsp;</div></li><li><div>                $usermeta = str_replace('}', '', $usermeta);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ($usermeta == 'user_avatar_small') {&nbsp;</div></li><li><div>                    $value = get_avatar(um_user('ID'), 40);&nbsp;</div></li><li><div>                } elseif (um_user($usermeta)) {&nbsp;</div></li><li><div>                    $value = um_user($usermeta);&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ($usermeta == 'username') {&nbsp;</div></li><li><div>                    $value = um_user('user_login');&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $value = apply_filters(&quot;um_profile_tag_hook__{$usermeta}&quot;, $value, um_user('ID'));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ($value) {&nbsp;</div></li><li><div>                    $str = preg_replace('/' . $pattern . '/', $value, $str);&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $str;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Shortcode: Show custom content to specific role&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Show content to specific roles&nbsp;</div></li><li><div>     * [um_show_content roles='member'] &lt;!-- insert content here --&gt;  [/um_show_content]&nbsp;</div></li><li><div>     * You can add multiple target roles, just use ', ' e.g.  [um_show_content roles='member, candidates, pets']&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Hide content from specific roles&nbsp;</div></li><li><div>     * [um_show_content not='contributors'] &lt;!-- insert content here --&gt;  [/um_show_content]&nbsp;</div></li><li><div>     * You can add multiple target roles, just use ', ' e.g.  [um_show_content roles='member, candidates, pets']&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param  array $atts&nbsp;</div></li><li><div>     * @param  string $content&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function um_shortcode_show_content_for_role( $atts = array() , $content = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        global $user_ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( ! is_user_logged_in() ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $a = shortcode_atts( array(&nbsp;</div></li><li><div>            'roles' =&gt; '', &nbsp;</div></li><li><div>            'not' =&gt; '', &nbsp;</div></li><li><div>            'is_profile' =&gt; false, &nbsp;</div></li><li><div> ), $atts );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( $a['is_profile'] ) {&nbsp;</div></li><li><div>            um_fetch_user( um_profile_id() );&nbsp;</div></li><li><div>        }else{&nbsp;</div></li><li><div>            um_fetch_user( $user_ID );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $current_user_role = um_user('role');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( isset( $a['not'] ) && ! empty( $a['not'] ) && isset( $a['roles'] ) && ! empty( $a['roles'] ) ) {&nbsp;</div></li><li><div>            return do_shortcode( $content );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( isset( $a['not'] ) && ! empty( $a['not'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $not_in_roles = explode(&quot;, &quot;, $a['not'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if( is_array( $not_in_roles ) &&  ! in_array( $current_user_role, $not_in_roles ) ) {&nbsp;</div></li><li><div>                    return do_shortcode( $content );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }else{&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $roles = explode(&quot;, &quot;, $a['roles'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if(is_array( $roles ) && in_array( $current_user_role, $roles ) ) {&nbsp;</div></li><li><div>                    return do_shortcode( $content );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return '';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function ultimatemember_searchform($args = array(), $content = &quot;&quot;) {&nbsp;</div></li><li><div>        // turn off buffer&nbsp;</div></li><li><div>        ob_start();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // load template&nbsp;</div></li><li><div>        $this-&gt;load_template( 'searchform' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // get the buffer&nbsp;</div></li><li><div>        $template = ob_get_contents();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // clear the buffer&nbsp;</div></li><li><div>        ob_end_clean();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $template;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 1.3.78</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/ultimate-member/1.3.82/classes/um_shortcodes/" class="active">1.3.82</a></li><li><a href="http://hookr.io/plugins/ultimate-member/1.3.81/classes/um_shortcodes/" class="">1.3.81</a></li><li><a href="http://hookr.io/plugins/ultimate-member/1.3.80/classes/um_shortcodes/" class="">1.3.80</a></li><li><a href="http://hookr.io/plugins/ultimate-member/1.3.79/classes/um_shortcodes/" class="">1.3.79</a></li><li><a href="http://hookr.io/plugins/ultimate-member/1.3.78/classes/um_shortcodes/" class="">1.3.78</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>UM_Shortcodes</li><li><span></span>wp-plugin</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>