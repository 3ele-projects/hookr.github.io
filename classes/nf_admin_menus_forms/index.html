<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="wordpress" data-id="38473"><head xmlns="http://www.w3.org/1999/xhtml"><title> nf_admin_menus_forms | class | WordPress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="NF_Admin_Menus_Forms, class, plugin, ninja-forms, 3.1.1" /><meta name="description" content="The WordPress Core NF Admin Menus Forms class." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.10"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=86e24e229fd5a304f25eee5d14f9eb6f' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.10' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/nf_admin_menus_forms/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fnf_admin_menus_forms%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fnf_admin_menus_forms%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"wordpress-3.1.1-class-nf_admin_menus_forms","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="nf_admin_menus_forms" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to ninja-forms." href="http://hookr.io/plugins/ninja-forms/" class="plugin"><span property="name">ninja-forms</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 3.1.1." href="http://hookr.io/plugins/ninja-forms/3.1.1/" class="H_VERSION"><span property="name">3.1.1</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/ninja-forms/3.1.1/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">nf_admin_menus_forms</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="0"><a href="http://hookr.io/3.1.1/all/" title="All">All <span class="count badge">0</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/3.1.1/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="0"><a href="http://hookr.io/3.1.1/hooks/" title="Hooks">Hooks <span class="count badge">0</span></a></li><li class="" data-id="action" data-count="0"><a href="http://hookr.io/3.1.1/actions/" title="Actions">Actions <span class="count badge">0</span></a></li><li class="" data-id="filter" data-count="0"><a href="http://hookr.io/3.1.1/filters/" title="Filters">Filters <span class="count badge">0</span></a></li><li class="active" data-id="class" data-count="0"><a href="http://hookr.io/3.1.1/classes/" title="Classes">Classes <span class="count badge">0</span></a></li><li class="" data-id="constant" data-count="0"><a href="http://hookr.io/3.1.1/constants/" title="Constants">Constants <span class="count badge">0</span></a></li><li class="" data-id="function" data-count="0"><a href="http://hookr.io/3.1.1/functions/" title="Functions">Functions <span class="count badge">0</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/3.1.1/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>NF_Admin_Menus_Forms</strong></h1><p>The WordPress Core <strong>NF Admin Menus Forms</strong> class.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/ninja-forms/3.1.1/files/includes-admin-menus-forms/" class="file">/includes/Admin/Menus/Forms.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="3" class="block" start="3"><li><div>final class NF_Admin_Menus_Forms extends NF_Abstracts_Menu&nbsp;</div></li><li><div>{&nbsp;</div></li><li><div>    public $page_title = 'Ninja Forms';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public $menu_slug = 'ninja-forms';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public $icon_url = 'dashicons-feedback';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public $position = '35.1337';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function __construct()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        parent::__construct();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( ! defined( 'DOING_AJAX' ) ) {&nbsp;</div></li><li><div>            add_action('current_screen', array($this, 'admin_init'));&nbsp;</div></li><li><div>            add_action( 'current_screen', array( 'NF_Admin_AllFormsTable', 'process_bulk_action' ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_action( 'admin_body_class', array( $this, 'body_class' ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function body_class( $classes )&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        // Add class for the builder.&nbsp;</div></li><li><div>        if( isset( $_GET['page'] ) && isset( $_GET[ 'form_id' ] ) && $_GET['page'] == $this-&gt;menu_slug ) {&nbsp;</div></li><li><div>            $classes = &quot;$classes ninja-forms-app&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $classes;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function get_page_title()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return __( 'Ninja Forms', 'ninja-forms' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function admin_init()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * If we aren't on the Ninja Forms menu page, don't admin_init.&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        if ( empty( $_GET[ 'page' ] ) || 'ninja-forms' !== $_GET[ 'page' ] ) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * Database Table Check&nbsp;</div></li><li><div>         * If the nf3_ database tables do not exist, then re-run activation.&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        if ( ! ninja_forms_three_table_exists() ) {&nbsp;</div></li><li><div>            Ninja_Forms()-&gt;activation();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( isset( $_GET[ 'form_id' ] ) && ! is_numeric( $_GET[ 'form_id' ] ) && 'new' != $_GET[ 'form_id' ] ) {&nbsp;</div></li><li><div>            if( current_user_can( apply_filters( 'ninja_forms_admin_import_template_capabilities', 'manage_options' ) ) ) {&nbsp;</div></li><li><div>                $this-&gt;import_from_template();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /** DISABLE OLD FORMS TABLE IN FAVOR OF NEW DASHBOARD */&nbsp;</div></li><li><div>//        $this-&gt;table = new NF_Admin_AllFormsTable();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function display()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if( isset( $_GET[ 'form_id' ] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if( 'new' == $_GET[ 'form_id' ] ) {&nbsp;</div></li><li><div>                $form_id = 'tmp-' . time();&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $form_id = (is_numeric($_GET['form_id'])) ? absint($_GET['form_id']) : '';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            /**&nbsp;</div></li><li><div>             * FORM BUILDER&nbsp;</div></li><li><div>             */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            Ninja_Forms::template( 'admin-menu-new-form.html.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $this-&gt;_enqueue_the_things( $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            delete_user_option( get_current_user_id(), 'nf_form_preview_' . $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if( ! isset( $_GET[ 'ajax' ] ) ) {&nbsp;</div></li><li><div>                $this-&gt;_localize_form_data( $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $this-&gt;_localize_field_type_data();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $this-&gt;_localize_action_type_data();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $this-&gt;_localize_form_settings();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $this-&gt;_localize_merge_tags();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            /**&nbsp;</div></li><li><div>             * ALL FORMS TABLE&nbsp;</div></li><li><div>             * - DISABLE IN FAVOR OF NEW DASHBOARD.&nbsp;</div></li><li><div>             */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>//            $this-&gt;table-&gt;prepare_items();&nbsp;</div></li><li><div>//&nbsp;</div></li><li><div>//            Ninja_Forms::template( 'admin-menu-all-forms.html.php', array(&nbsp;</div></li><li><div>//                'table' =&gt; $this-&gt;table, &nbsp;</div></li><li><div>//                'add_new_url' =&gt; admin_url( 'admin.php?page=ninja-forms&form_id=new' ), &nbsp;</div></li><li><div>//                'add_new_text' =&gt; __( 'Add New Form', 'ninja-forms' )&nbsp;</div></li><li><div>// ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            /**&nbsp;</div></li><li><div>             * DASHBOARD&nbsp;</div></li><li><div>             */&nbsp;</div></li><li><div>            $dash_items = Ninja_Forms()-&gt;config('DashboardMenuItems');&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>            &lt;script&gt;&nbsp;</div></li><li><div>                var nfDashItems = &lt;?php echo( json_encode( array_values( $dash_items ) ) ); ?&gt;;&nbsp;</div></li><li><div>            &lt;/script&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            wp_enqueue_script( 'backbone-radio', Ninja_Forms::$url . 'assets/js/lib/backbone.radio.min.js', array( 'jquery', 'backbone' ) );&nbsp;</div></li><li><div>            wp_enqueue_script( 'backbone-marionette-3', Ninja_Forms::$url . 'assets/js/lib/backbone.marionette3.min.js', array( 'jquery', 'backbone' ) );&nbsp;</div></li><li><div>            wp_enqueue_script( 'nf-jbox', Ninja_Forms::$url . 'assets/js/lib/jBox.min.js', array( 'jquery' ) );&nbsp;</div></li><li><div>            wp_enqueue_script( 'nf-moment', Ninja_Forms::$url . 'assets/js/lib/moment-with-locales.min.js', array( 'jquery' ) );&nbsp;</div></li><li><div>            wp_enqueue_script( 'nf-dashboard', Ninja_Forms::$url . 'assets/js/min/dashboard.min.js', array( 'backbone-radio', 'backbone-marionette-3' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            wp_enqueue_style( 'nf-builder', Ninja_Forms::$url . 'assets/css/builder.css' );&nbsp;</div></li><li><div>            wp_enqueue_style( 'nf-dashboard', Ninja_Forms::$url . 'assets/css/dashboard.min.css' );&nbsp;</div></li><li><div>            wp_enqueue_style( 'nf-jbox', Ninja_Forms::$url . 'assets/css/jBox.css' );&nbsp;</div></li><li><div>            wp_enqueue_style( 'nf-font-awesome', Ninja_Forms::$url . 'assets/css/font-awesome.min.css' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            Ninja_Forms::template( 'admin-menu-dashboard.html.php' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function submenu_separators()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        add_submenu_page( 'ninja-forms', '', '', 'read', '', '' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private function import_from_template()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $template = sanitize_title( $_GET['form_id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $templates = Ninja_Forms::config( 'NewFormTemplates' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( isset( $templates[ $template ] ) && ! empty( $templates[ $template ][ 'form' ] ) ) {&nbsp;</div></li><li><div>            $form = $templates[ $template ][ 'form' ];&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $form = Ninja_Forms::template( $template . '.nff', array(), TRUE );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( ! $form ) die( 'Template not found' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $form = json_decode( html_entity_decode( $form ), true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $form_id = Ninja_Forms()-&gt;form()-&gt;import_form( $form );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( ! $form_id ) {&nbsp;</div></li><li><div>            $error_message = ( function_exists( 'json_last_error_msg' ) && json_last_error_msg() ) ? json_last_error_msg() : __( 'Form Template Import Error.', 'ninja-forms' );&nbsp;</div></li><li><div>            wp_die( $error_message );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        header( &quot;Location: &quot; . admin_url( &quot;admin.php?page=ninja-forms&form_id=$form_id&quot; ) );&nbsp;</div></li><li><div>        exit();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private function _enqueue_the_things( $form_id )&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        global $wp_locale;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        wp_enqueue_media();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        wp_enqueue_style( 'nf-builder', Ninja_Forms::$url . 'assets/css/builder.css' );&nbsp;</div></li><li><div>        wp_enqueue_style( 'nf-font-awesome', Ninja_Forms::$url . 'assets/css/font-awesome.min.css' );&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * CSS Libraries&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        wp_enqueue_style( 'wp-color-picker' );&nbsp;</div></li><li><div>        wp_enqueue_style( 'jBox', Ninja_Forms::$url . 'assets/css/jBox.css' );&nbsp;</div></li><li><div>        wp_enqueue_style( 'summernote', Ninja_Forms::$url . 'assets/css/summernote.css' );&nbsp;</div></li><li><div>        wp_enqueue_style( 'codemirror', Ninja_Forms::$url . 'assets/css/codemirror.css' );&nbsp;</div></li><li><div>        wp_enqueue_style( 'codemirror-monokai', Ninja_Forms::$url . 'assets/css/monokai-theme.css' );&nbsp;</div></li><li><div>        wp_enqueue_style( 'pikaday-responsive', Ninja_Forms::$url . 'assets/css/pikaday-package.css' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * JS Libraries&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        wp_enqueue_script( 'wp-util' );&nbsp;</div></li><li><div>        wp_enqueue_script( 'jquery-autoNumeric', Ninja_Forms::$url . 'assets/js/lib/jquery.autoNumeric.min.js', array( 'jquery', 'backbone' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'jquery-maskedinput', Ninja_Forms::$url . 'assets/js/lib/jquery.maskedinput.min.js', array( 'jquery', 'backbone' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'backbone-marionette', Ninja_Forms::$url . 'assets/js/lib/backbone.marionette.min.js', array( 'jquery', 'backbone' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'backbone-radio', Ninja_Forms::$url . 'assets/js/lib/backbone.radio.min.js', array( 'jquery', 'backbone' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'jquery-perfect-scrollbar', Ninja_Forms::$url . 'assets/js/lib/perfect-scrollbar.jquery.min.js', array( 'jquery' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'jquery-hotkeys-new', Ninja_Forms::$url . 'assets/js/lib/jquery.hotkeys.min.js' );&nbsp;</div></li><li><div>        wp_enqueue_script( 'jBox', Ninja_Forms::$url . 'assets/js/lib/jBox.min.js' );&nbsp;</div></li><li><div>        wp_enqueue_script( 'jquery-caret', Ninja_Forms::$url . 'assets/js/lib/jquery.caret.min.js' );&nbsp;</div></li><li><div>        wp_enqueue_script( 'speakingurl', Ninja_Forms::$url . 'assets/js/lib/speakingurl.js' );&nbsp;</div></li><li><div>        wp_enqueue_script( 'jquery-slugify', Ninja_Forms::$url . 'assets/js/lib/slugify.min.js', array( 'jquery', 'speakingurl' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'jquery-mobile-events', Ninja_Forms::$url . 'assets/js/lib/jquery.mobile-events.min.js', array( 'jquery' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'jquery-ui-touch-punch', Ninja_Forms::$url . 'assets/js/lib/jquery.ui.touch-punch.min.js', array( 'jquery' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'jquery-classy-wiggle', Ninja_Forms::$url . 'assets/js/lib/jquery.classywiggle.min.js', array( 'jquery' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'moment-with-locale', Ninja_Forms::$url . 'assets/js/lib/moment-with-locales.min.js', array( 'jquery' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'pikaday', Ninja_Forms::$url . 'assets/js/lib/pikaday.min.js', array( 'moment-with-locale' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'pikaday-responsive', Ninja_Forms::$url . 'assets/js/lib/pikaday-responsive.min.js', array( 'pikaday', 'modernizr' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        wp_enqueue_script( 'bootstrap', Ninja_Forms::$url . 'assets/js/lib/bootstrap.min.js', array( 'jquery' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'codemirror', Ninja_Forms::$url . 'assets/js/lib/codemirror.min.js', array( 'jquery' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'codemirror-xml', Ninja_Forms::$url . 'assets/js/lib/codemirror-xml.min.js', array( 'jquery' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'codemirror-formatting', Ninja_Forms::$url . 'assets/js/lib/codemirror-formatting.min.js', array( 'jquery' ) );&nbsp;</div></li><li><div>        wp_enqueue_script( 'summernote', Ninja_Forms::$url . 'assets/js/lib/summernote.min.js', array( 'jquery', 'speakingurl' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        wp_enqueue_script( 'nf-builder', Ninja_Forms::$url . 'assets/js/min/builder.js', array( 'jquery', 'jquery-ui-core', 'jquery-ui-draggable', 'jquery-ui-droppable', 'jquery-ui-sortable', 'jquery-effects-bounce', 'wp-color-picker' ) );&nbsp;</div></li><li><div>        wp_localize_script( 'nf-builder', 'nfi18n', Ninja_Forms::config( 'i18nBuilder' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        wp_localize_script( 'nf-builder', 'nfAdmin', array(&nbsp;</div></li><li><div>            'ajaxNonce' =&gt; wp_create_nonce( 'ninja_forms_builder_nonce' ), &nbsp;</div></li><li><div>            'requireBaseUrl' =&gt; Ninja_Forms::$url . 'assets/js/', &nbsp;</div></li><li><div>            'previewurl' =&gt; home_url() . '/?nf_preview_form=', &nbsp;</div></li><li><div>            'wp_locale' =&gt; $wp_locale-&gt;number_format, &nbsp;</div></li><li><div>            'editFormText' =&gt; __( 'Edit Form', 'ninja-forms' ), &nbsp;</div></li><li><div>            'mobile' =&gt; ( wp_is_mobile() ) ? 1: 0, &nbsp;</div></li><li><div>            'currencySymbols' =&gt; array_merge( array( '' =&gt; Ninja_Forms()-&gt;get_setting( 'currency_symbol' ) ), Ninja_Forms::config( 'CurrencySymbol' ) ), &nbsp;</div></li><li><div>            'dateFormat' =&gt; Ninja_Forms()-&gt;get_setting( 'date_format' ), &nbsp;</div></li><li><div>            'formID' =&gt; isset( $_GET[ 'form_id' ] ) ? absint( $_GET[ 'form_id' ] ) : 0&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'nf_admin_enqueue_scripts' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private function _localize_form_data( $form_id )&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $form = Ninja_Forms()-&gt;form( $form_id )-&gt;get();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( ! $form-&gt;get_tmp_id() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if( $form_cache = get_option( 'nf_form_' . $form_id, false ) ) {&nbsp;</div></li><li><div>                $fields = $form_cache[ 'fields' ];&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $fields = ($form_id) ? Ninja_Forms()-&gt;form($form_id)-&gt;get_fields() : array();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $actions = ($form_id) ? Ninja_Forms()-&gt;form($form_id)-&gt;get_actions() : array();&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $fields = array();&nbsp;</div></li><li><div>            $actions = array();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $fields_settings = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // echo &quot;&lt;pre&gt;&quot;;&nbsp;</div></li><li><div>        // print_r( $fields );&nbsp;</div></li><li><div>        // echo &quot;&lt;/pre&gt;&quot;;&nbsp;</div></li><li><div>        // die();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( ! empty( $fields ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // TODO: Replace unique field key checks with a refactored model/factory.&nbsp;</div></li><li><div>//            $unique_field_keys = array();&nbsp;</div></li><li><div>//            $form_cache = get_option( 'nf_form_' . $form_id, false );&nbsp;</div></li><li><div>//            $cache_updated = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ($fields as $field) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $field_id = ( is_object( $field ) ) ? $field-&gt;get_id() : $field[ 'id' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                /**&nbsp;</div></li><li><div>                 * Duplicate field check.&nbsp;</div></li><li><div>                 * TODO: Replace unique field key checks with a refactored model/factory.&nbsp;</div></li><li><div>                 */&nbsp;</div></li><li><div>//                $field_key = $field-&gt;get_setting( 'key' );&nbsp;</div></li><li><div>//                if( in_array( $field_key, $unique_field_keys ) || '' == $field_key ) {&nbsp;</div></li><li><div>//&nbsp;</div></li><li><div>//                    // Delete the field.&nbsp;</div></li><li><div>//                    Ninja_Forms()-&gt;request( 'delete-field' )-&gt;data( array( 'field_id' =&gt; $field_id ) )-&gt;dispatch();&nbsp;</div></li><li><div>//&nbsp;</div></li><li><div>//                    // Remove the field from cache.&nbsp;</div></li><li><div>//                    if( $form_cache ) {&nbsp;</div></li><li><div>//                        if( isset( $form_cache[ 'fields' ] ) ) {&nbsp;</div></li><li><div>//                            foreach( $form_cache[ 'fields' ] as $cached_field_key =&gt; $cached_field ) {&nbsp;</div></li><li><div>//                                if( ! isset( $cached_field[ 'id' ] ) ) continue;&nbsp;</div></li><li><div>//                                if( $field_id != $cached_field[ 'id' ] ) continue;&nbsp;</div></li><li><div>//&nbsp;</div></li><li><div>//                                // Flag cache to update.&nbsp;</div></li><li><div>//                                $cache_updated = true;&nbsp;</div></li><li><div>//&nbsp;</div></li><li><div>//                                unset( $form_cache[ 'fields' ][ $cached_field_key ] ); // Remove the field.&nbsp;</div></li><li><div>//                            }&nbsp;</div></li><li><div>//                        }&nbsp;</div></li><li><div>//                    }&nbsp;</div></li><li><div>//&nbsp;</div></li><li><div>//                    continue; // Skip the duplicate field.&nbsp;</div></li><li><div>//                }&nbsp;</div></li><li><div>//                array_push( $unique_field_keys, $field_key ); // Log unique key.&nbsp;</div></li><li><div>                /** END Duplicate field check. */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $type = ( is_object( $field ) ) ? $field-&gt;get_setting( 'type' ) : $field[ 'settings' ][ 'type' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if( ! isset( Ninja_Forms()-&gt;fields[ $type ] ) ) {&nbsp;</div></li><li><div>                    $field = NF_Fields_Unknown::create( $field );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $settings = ( is_object( $field ) ) ? $field-&gt;get_settings() : $field[ 'settings' ];&nbsp;</div></li><li><div>                $settings[ 'id' ] =  $field_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>//                foreach ($settings as $key =&gt; $setting) {&nbsp;</div></li><li><div>//                    if (is_numeric($setting)) $settings[$key] = floatval($setting);&nbsp;</div></li><li><div>//                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $fields_settings[] = $settings;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>//            if( $cache_updated ) {&nbsp;</div></li><li><div>//                update_option('nf_form_' . $form_id, $form_cache); // Update form cache without duplicate fields.&nbsp;</div></li><li><div>//            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $actions_settings = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( ! empty( $actions ) ) {&nbsp;</div></li><li><div>            foreach ($actions as $action) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $type = $action-&gt;get_setting( 'type' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if( ! isset( Ninja_Forms()-&gt;actions[ $type ] ) ) continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $settings = $action-&gt;get_settings();&nbsp;</div></li><li><div>                $settings['id'] = $action-&gt;get_id();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $actions_settings[] = $settings;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( $form-&gt;get_tmp_id() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $actions_settings = Ninja_Forms()-&gt;config( 'FormActionDefaults' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $form_data = array();&nbsp;</div></li><li><div>        $form_data['id'] = $form_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Use form cache for form settings.&nbsp;</div></li><li><div>        // TODO: Defer to refactor of factory/model.&nbsp;</div></li><li><div>        if( isset( $form_cache[ 'settings' ] ) ) {&nbsp;</div></li><li><div>            $form_data['settings'] = $form_cache[ 'settings' ];&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $form_data['settings'] = $form-&gt;get_settings();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $form_data['fields'] = $fields_settings;&nbsp;</div></li><li><div>        $form_data['actions'] = $actions_settings;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;script&gt;&nbsp;</div></li><li><div>            var preloadedFormData = &lt;?php echo wp_json_encode( $form_data ); ?&gt;;&nbsp;</div></li><li><div>            // console.log( preloadedFormData );&nbsp;</div></li><li><div>        &lt;/script&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private function _localize_field_type_data()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $field_type_sections = array_values( Ninja_Forms()-&gt;config( 'FieldTypeSections' ) );&nbsp;</div></li><li><div>        $field_type_settings = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $master_settings = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $setting_defaults = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach( Ninja_Forms()-&gt;fields as $field ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $name = $field-&gt;get_name();&nbsp;</div></li><li><div>            $settings = $field-&gt;get_settings();&nbsp;</div></li><li><div>            $groups = Ninja_Forms::config( 'SettingsGroups' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $unique_settings = $this-&gt;_unique_settings( $settings );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $master_settings = array_merge( $master_settings, $unique_settings );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $settings_groups = $this-&gt;_group_settings( $settings, $groups );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $settings_defaults = $this-&gt;_setting_defaults( $unique_settings );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $field_type_settings[ $name ] = array(&nbsp;</div></li><li><div>                'id' =&gt;  $name, &nbsp;</div></li><li><div>                'nicename' =&gt; $field-&gt;get_nicename(), &nbsp;</div></li><li><div>                'alias' =&gt; $field-&gt;get_aliases(), &nbsp;</div></li><li><div>                'parentType' =&gt; $field-&gt;get_parent_type(), &nbsp;</div></li><li><div>                'section' =&gt; $field-&gt;get_section(), &nbsp;</div></li><li><div>                'icon' =&gt; $field-&gt;get_icon(), &nbsp;</div></li><li><div>                'type' =&gt; $field-&gt;get_type(), &nbsp;</div></li><li><div>                'settingGroups' =&gt; $settings_groups, &nbsp;</div></li><li><div>                'settingDefaults' =&gt; $settings_defaults&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $saved_fields = Ninja_Forms()-&gt;form()-&gt;get_fields( array( 'saved' =&gt; 1) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach( $saved_fields as $saved_field ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $settings = $saved_field-&gt;get_settings();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $id = $saved_field-&gt;get_id();&nbsp;</div></li><li><div>            $type = $settings[ 'type' ];&nbsp;</div></li><li><div>            $label = $settings[ 'label' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $field_type_settings[ $id ] = $field_type_settings[ $type ];&nbsp;</div></li><li><div>            $field_type_settings[ $id ][ 'id' ] = $id;&nbsp;</div></li><li><div>            $field_type_settings[ $id ][ 'type' ] = $type;&nbsp;</div></li><li><div>            $field_type_settings[ $id ][ 'nicename' ] = $label;&nbsp;</div></li><li><div>            $field_type_settings[ $id ][ 'section' ] = 'saved';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $defaults = $field_type_settings[ $id ][ 'settingDefaults' ];&nbsp;</div></li><li><div>            $defaults = array_merge( $defaults, $settings );&nbsp;</div></li><li><div>            $defaults[ 'saved' ] = TRUE;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $field_type_settings[ $id ][ 'settingDefaults' ] = $defaults;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;script&gt;&nbsp;</div></li><li><div>            var fieldTypeData = &lt;?php echo wp_json_encode( array_values( $field_type_settings ) ); ?&gt;;&nbsp;</div></li><li><div>            var fieldSettings = &lt;?php echo wp_json_encode( array_values( $master_settings ) ); ?&gt;;&nbsp;</div></li><li><div>            var fieldTypeSections = &lt;?php echo wp_json_encode( $field_type_sections ); ?&gt;;&nbsp;</div></li><li><div>            // console.log( fieldTypeData );&nbsp;</div></li><li><div>        &lt;/script&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private function _localize_action_type_data()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $action_type_settings = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $master_settings_list = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach( Ninja_Forms()-&gt;actions as $action ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $name = $action-&gt;get_name();&nbsp;</div></li><li><div>            $settings = $action-&gt;get_settings();&nbsp;</div></li><li><div>            $groups = Ninja_Forms::config( 'SettingsGroups' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $settings_groups = $this-&gt;_group_settings( $settings, $groups );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $master_settings_list = array_merge( $master_settings_list, $settings );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $action_type_settings[ $name ] = array(&nbsp;</div></li><li><div>                'id' =&gt; $name, &nbsp;</div></li><li><div>                'section' =&gt; $action-&gt;get_section(), &nbsp;</div></li><li><div>                'nicename' =&gt; $action-&gt;get_nicename(), &nbsp;</div></li><li><div>                'image' =&gt; $action-&gt;get_image(), &nbsp;</div></li><li><div>                'settingGroups' =&gt; $settings_groups, &nbsp;</div></li><li><div>                'settingDefaults' =&gt; $this-&gt;_setting_defaults( $master_settings_list )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $external_actions = $this-&gt;_fetch_action_feed();&nbsp;</div></li><li><div>        $u_id = get_option( 'nf_aff', false );&nbsp;</div></li><li><div>        if ( !$u_id ) $u_id = apply_filters( 'ninja_forms_affiliate_id', false );&nbsp;</div></li><li><div>        foreach( $external_actions as $action) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if( ! isset( $action[ 'name' ] ) || ! $action[ 'name' ] ) continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $name = $action[ 'name' ];&nbsp;</div></li><li><div>            $nicename = ( isset( $action[ 'nicename' ] ) ) ? $action[ 'nicename' ] : '';&nbsp;</div></li><li><div>            $image = ( isset( $action[ 'image' ] ) ) ? $action[ 'image' ] : '';&nbsp;</div></li><li><div>            $link = ( isset( $action[ 'link' ] ) ) ? $action[ 'link' ] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $u_id ) {&nbsp;</div></li><li><div>                $last_slash = strripos( $link, '/' );&nbsp;</div></li><li><div>                $link = substr( $link, 0, $last_slash );&nbsp;</div></li><li><div>                $link =  urlencode( $link );&nbsp;</div></li><li><div>                $link = 'http://www.shareasale.com/r.cfm?u=' . $u_id . '&b=812237&m=63061&afftrack=&urllink=' . $link;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if( isset( $action_type_settings[ $name ] ) ) continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $action_type_settings[ $name ] = array(&nbsp;</div></li><li><div>                'id' =&gt; $name, &nbsp;</div></li><li><div>                'section' =&gt; 'available', &nbsp;</div></li><li><div>                'nicename' =&gt; $nicename, &nbsp;</div></li><li><div>                'image' =&gt; $image, &nbsp;</div></li><li><div>                'link' =&gt; $link, &nbsp;</div></li><li><div>                'settingGroups' =&gt; array(), &nbsp;</div></li><li><div>                'settingDefaults' =&gt; array()&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $action_type_settings = apply_filters( 'ninja_forms_action_type_settings', $action_type_settings );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;script&gt;&nbsp;</div></li><li><div>            var actionTypeData = &lt;?php echo wp_json_encode( array_values( $action_type_settings ) ); ?&gt;;&nbsp;</div></li><li><div>            var actionSettings = &lt;?php echo wp_json_encode( array_values( $master_settings_list ) ); ?&gt;;&nbsp;</div></li><li><div>            // console.log( actionTypeData );&nbsp;</div></li><li><div>        &lt;/script&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    protected function _localize_form_settings()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $form_settings_types = Ninja_Forms::config( 'FormSettingsTypes' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $form_settings[ 'display' ] = Ninja_Forms::config( 'FormDisplaySettings' );&nbsp;</div></li><li><div>        $form_settings[ 'restrictions' ] = Ninja_Forms::config( 'FormRestrictionSettings' );&nbsp;</div></li><li><div>        $form_settings[ 'calculations' ] = Ninja_Forms::config( 'FormCalculationSettings' );&nbsp;</div></li><li><div>        $form_settings = apply_filters( 'ninja_forms_localize_forms_settings', $form_settings );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach( $form_settings_types as $group_name =&gt; $form_setting_group ) {&nbsp;</div></li><li><div>            if( ! isset( $form_settings[ $group_name ] ) ) $form_settings[ $group_name ] = array();&nbsp;</div></li><li><div>            $form_settings[ $group_name ] = apply_filters( 'ninja_forms_localize_form_' . $group_name . '_settings', $form_settings[ $group_name ] );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $groups = Ninja_Forms::config( 'SettingsGroups' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $master_settings = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach( $form_settings_types as $id =&gt; $type ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if( ! isset( $form_settings[ $id ] ) ) $form_settings[ $id ] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $unique_settings = $this-&gt;_unique_settings( $form_settings[ $id ] );&nbsp;</div></li><li><div>            $master_settings = array_merge( $master_settings, $unique_settings );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $form_settings_types[ $id ]['settingGroups'] = $this-&gt;_group_settings($form_settings[ $id ], $groups);&nbsp;</div></li><li><div>            $form_settings_types[ $id ]['settingDefaults'] = $this-&gt;_setting_defaults($unique_settings);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;script&gt;&nbsp;</div></li><li><div>        var formSettingTypeData = &lt;?php echo wp_json_encode( array_values( $form_settings_types ) )?&gt;;&nbsp;</div></li><li><div>        var formSettings = &lt;?php echo wp_json_encode( array_values( $master_settings ) )?&gt;;&nbsp;</div></li><li><div>        &lt;/script&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    protected function _localize_merge_tags()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $merge_tags = array(&nbsp;</div></li><li><div>            'fields' =&gt; array(&nbsp;</div></li><li><div>                'id' =&gt; 'fields', &nbsp;</div></li><li><div>                'label' =&gt; __( 'Fields', 'ninja-forms' )&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach( Ninja_Forms()-&gt;merge_tags as $key =&gt; $group ) {&nbsp;</div></li><li><div>            /**&nbsp;</div></li><li><div>             * If the merge tag group doesn't have a title, don't localise it.&nbsp;</div></li><li><div>             * &nbsp;</div></li><li><div>             * This convention is used to allow merge tags to continue to function, &nbsp;</div></li><li><div>             * even though they can't be added to new forms.&nbsp;</div></li><li><div>             */&nbsp;</div></li><li><div>            $title = $group-&gt;get_title();&nbsp;</div></li><li><div>            if ( empty( $title ) ) continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $merge_tags[ $key ] = array(&nbsp;</div></li><li><div>                'id' =&gt; $group-&gt;get_id(), &nbsp;</div></li><li><div>                'label' =&gt; $group-&gt;get_title(), &nbsp;</div></li><li><div>                'tags' =&gt; array_values( $group-&gt;get_merge_tags() ), &nbsp;</div></li><li><div>                'default_group' =&gt; $group-&gt;is_default_group()&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;script&gt;&nbsp;</div></li><li><div>            var mergeTags = &lt;?php echo wp_json_encode( array_values( $merge_tags ) ); ?&gt;;&nbsp;</div></li><li><div>        &lt;/script&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    protected function _group_settings( $settings, $groups )&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if( ! is_array( $settings ) ) return $groups;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach( $settings as $setting ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $group = ( isset( $setting[ 'group' ] ) ) ? $setting[ 'group' ] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if( isset( $setting[ 'type'] ) && 'fieldset' == $setting[ 'type' ] ) {&nbsp;</div></li><li><div>                $setting[ 'settings' ] = array_values( $setting[ 'settings' ] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $groups[ $group ][ 'settings'][] = $setting;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach( $groups as $id =&gt; $group ) {&nbsp;</div></li><li><div>            if ( empty( $group[ 'settings' ] ) ) {&nbsp;</div></li><li><div>                unset( $groups[ $id ] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        unset( $groups[ &quot;&quot; ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        usort($groups, array( $this, 'setting_group_priority' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $groups;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    protected function _unique_settings( $settings )&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $unique_settings = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( ! is_array( $settings ) ) return $unique_settings;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach( $settings as $setting ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if( 'fieldset' == $setting[ 'type' ] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $unique_settings = array_merge( $unique_settings, $this-&gt;_unique_settings( $setting[ 'settings' ] ) );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $name = $setting[ 'name' ];&nbsp;</div></li><li><div>                $unique_settings[ $name ] = $setting;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $unique_settings;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    protected function _setting_defaults( $settings )&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $setting_defaults = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach( $settings as $setting ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $name = ( isset( $setting[ 'name' ] ) ) ? $setting[ 'name' ] : '';&nbsp;</div></li><li><div>            $default = ( isset( $setting[ 'value' ] ) ) ? $setting[ 'value' ] : '';&nbsp;</div></li><li><div>            $setting_defaults[ $name ] = $default;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $setting_defaults;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    protected function _fetch_action_feed()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return Ninja_Forms::config( 'AvailableActions' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    protected function setting_group_priority( $a, $b )&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $priority[ 0 ] = ( isset( $a[ 'priority' ] ) ) ? $a[ 'priority' ] : 500;&nbsp;</div></li><li><div>        $priority[ 1 ] = ( isset( $b[ 'priority' ] ) ) ? $b[ 'priority' ] : 500;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $priority[ 0 ] - $priority[ 1 ];&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function get_capability()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return apply_filters( 'ninja_forms_admin_parent_menu_capabilities', $this-&gt;capability );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 3.0.5</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/ninja-forms/3.1.1/classes/nf_admin_menus_forms/" class="active">3.1.1</a></li><li><a href="http://hookr.io/plugins/ninja-forms/3.1/classes/nf_admin_menus_forms/" class="">3.1</a></li><li><a href="http://hookr.io/plugins/ninja-forms/3.0.7/classes/nf_admin_menus_forms/" class="">3.0.7</a></li><li><a href="http://hookr.io/plugins/ninja-forms/3.0.6/classes/nf_admin_menus_forms/" class="">3.0.6</a></li><li><a href="http://hookr.io/plugins/ninja-forms/3.0.5/classes/nf_admin_menus_forms/" class="">3.0.5</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>NF_Admin_Menus_Forms</li><li><span></span>wp-plugin</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>