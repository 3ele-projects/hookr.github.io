<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="wordpress" data-version="4.7" data-type="file" data-id="4802"><head xmlns="http://www.w3.org/1999/xhtml"><title> wp-includes-link-template | file | WordPress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, wordpress, 4.7" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.24"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=c5f0bfc70ddaa7fbc2a5055411c0c07f' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.24' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/wp-includes-link-template/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-includes-link-template%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-includes-link-template%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"wordpress-4.7-file-wp-includes-link-template","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wp-includes-link-template" class="blog single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 4.7." href="http://hookr.io/4.7/" class="H_VERSION"><span property="name">4.7</span></a><meta property="position" content="2"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wp-includes-link-template</span><meta property="position" content="3"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="6307"><a href="http://hookr.io/4.7/all/" title="All">All <span class="count badge">6307</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/4.7/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="2531"><a href="http://hookr.io/4.7/hooks/" title="Hooks">Hooks <span class="count badge">2531</span></a></li><li class="" data-id="action" data-count="864"><a href="http://hookr.io/4.7/actions/" title="Actions">Actions <span class="count badge">864</span></a></li><li class="" data-id="filter" data-count="1667"><a href="http://hookr.io/4.7/filters/" title="Filters">Filters <span class="count badge">1667</span></a></li><li class="" data-id="class" data-count="351"><a href="http://hookr.io/4.7/classes/" title="Classes">Classes <span class="count badge">351</span></a></li><li class="" data-id="constant" data-count="566"><a href="http://hookr.io/4.7/constants/" title="Constants">Constants <span class="count badge">566</span></a></li><li class="" data-id="function" data-count="2851"><a href="http://hookr.io/4.7/functions/" title="Functions">Functions <span class="count badge">2851</span></a></li><li class="" data-id="shortcode" data-count="8"><a href="http://hookr.io/4.7/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">8</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class="active"><a href="http://hookr.io/all/" title="Core">Core</a></li><li class=""><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/wp-includes/link-template.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * WordPress Link Template Functions</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package WordPress</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage Template</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the permalink for the current post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0 Added the `$post` parameter.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|WP_Post $post Optional. Post ID or post object. Default is the global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function the_permalink( $post = 0 ) {&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the display of the permalink for the current post.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0 Added the `$post` parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string      $permalink The permalink for the current post.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int|WP_Post $post      Post ID, WP_Post object, or 0. Default 0.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo esc_url( apply_filters( 'the_permalink', get_permalink( $post ), $post ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves a trailing-slashed string if the site is set for adding trailing slashes.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Conditionally adds a trailing slash if the permalink structure has a trailing</span>&nbsp;</div></li><li><div><span class="comment"> * slash, strips the trailing slash if not. The string is passed through the</span>&nbsp;</div></li><li><div><span class="comment"> * {@see 'user_trailingslashit'} filter. Will remove trailing slash from string, if</span>&nbsp;</div></li><li><div><span class="comment"> * site is not set to have them.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string      URL with or without a trailing slash.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $type_of_url Optional. The type of URL being considered (e.g. single, category, etc)</span>&nbsp;</div></li><li><div><span class="comment"> *                            for use in the filter. Default empty string.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The URL with the trailing slash appended or stripped.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function user_trailingslashit($string, $type_of_url = '') {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>  if ( $wp_rewrite-&gt;use_trailing_slashes )&nbsp;</div></li><li><div>      $string = trailingslashit($string);&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      $string = untrailingslashit($string);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the trailing-slashed string, depending on whether the site is set to use trailing slashes.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $string      URL with or without a trailing slash.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $type_of_url The type of URL being considered. Accepts 'single', 'single_trackback', </span>&nbsp;</div></li><li><div><span class="comment">   *                            'single_feed', 'single_paged', 'commentpaged', 'paged', 'home', 'feed', </span>&nbsp;</div></li><li><div><span class="comment">   *                            'category', 'page', 'year', 'month', 'day', 'post_type_archive'.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'user_trailingslashit', $string, $type_of_url );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the permalink anchor for the current post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The permalink mode title will use the post title for the 'a' element 'id'</span>&nbsp;</div></li><li><div><span class="comment"> * attribute. The id mode uses 'post-' with the post ID for the 'id' attribute.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 0.71</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $mode Optional. Permalink mode. Accepts 'title' or 'id'. Default 'id'.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function permalink_anchor( $mode = 'id' ) {&nbsp;</div></li><li><div>  $post = get_post();&nbsp;</div></li><li><div>  switch ( strtolower( $mode ) ) {&nbsp;</div></li><li><div>      case 'title':&nbsp;</div></li><li><div>          $title = sanitize_title( $post-&gt;post_title ) . '-' . $post-&gt;ID;&nbsp;</div></li><li><div>          echo '&lt;a id=&quot;'.$title.'&quot;&gt;&lt;/a&gt;';&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      case 'id':&nbsp;</div></li><li><div>      default:&nbsp;</div></li><li><div>          echo '&lt;a id=&quot;post-' . $post-&gt;ID . '&quot;&gt;&lt;/a&gt;';&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the full permalink for the current post or post ID.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function is an alias for get_permalink().</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.9.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see get_permalink()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|WP_Post $post      Optional. Post ID or post object. Default is the global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool        $leavename Optional. Whether to keep post name or page name. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|false The permalink URL or false if post does not exist.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_the_permalink( $post = 0, $leavename = false ) {&nbsp;</div></li><li><div>  return get_permalink( $post, $leavename );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the full permalink for the current post or post ID.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|WP_Post $post      Optional. Post ID or post object. Default is the global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool        $leavename Optional. Whether to keep post name or page name. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|false The permalink URL or false if post does not exist.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_permalink( $post = 0, $leavename = false ) {&nbsp;</div></li><li><div>  $rewritecode = array(&nbsp;</div></li><li><div>      '%year%', &nbsp;</div></li><li><div>      '%monthnum%', &nbsp;</div></li><li><div>      '%day%', &nbsp;</div></li><li><div>      '%hour%', &nbsp;</div></li><li><div>      '%minute%', &nbsp;</div></li><li><div>      '%second%', &nbsp;</div></li><li><div>      $leavename? '' : '%postname%', &nbsp;</div></li><li><div>      '%post_id%', &nbsp;</div></li><li><div>      '%category%', &nbsp;</div></li><li><div>      '%author%', &nbsp;</div></li><li><div>      $leavename? '' : '%pagename%', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_object( $post ) && isset( $post-&gt;filter ) && 'sample' == $post-&gt;filter ) {&nbsp;</div></li><li><div>      $sample = true;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $post = get_post( $post );&nbsp;</div></li><li><div>      $sample = false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($post-&gt;ID) )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $post-&gt;post_type == 'page' )&nbsp;</div></li><li><div>      return get_page_link($post, $leavename, $sample);&nbsp;</div></li><li><div>  elseif ( $post-&gt;post_type == 'attachment' )&nbsp;</div></li><li><div>      return get_attachment_link( $post, $leavename );&nbsp;</div></li><li><div>  elseif ( in_array($post-&gt;post_type, get_post_types( array('_builtin' =&gt; false) ) ) )&nbsp;</div></li><li><div>      return get_post_permalink($post, $leavename, $sample);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $permalink = get_option('permalink_structure');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the permalink structure for a post before token replacement occurs.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Only applies to posts with post_type of 'post'.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $permalink The site's permalink structure.</span>&nbsp;</div></li><li><div><span class="comment">   * @param WP_Post $post      The post in question.</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool    $leavename Whether to keep the post name.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $permalink = apply_filters( 'pre_post_link', $permalink, $post, $leavename );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( '' != $permalink && !in_array( $post-&gt;post_status, array( 'draft', 'pending', 'auto-draft', 'future' ) ) ) {&nbsp;</div></li><li><div>      $unixtime = strtotime($post-&gt;post_date);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $category = '';&nbsp;</div></li><li><div>      if ( strpos($permalink, '%category%') !== false ) {&nbsp;</div></li><li><div>          $cats = get_the_category($post-&gt;ID);&nbsp;</div></li><li><div>          if ( $cats ) {&nbsp;</div></li><li><div>              $cats = wp_list_sort( $cats, array(&nbsp;</div></li><li><div>                  'term_id' =&gt; 'ASC', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Filters the category that gets used in the %category% permalink token.</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @since 3.5.0</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param WP_Term  $cat  The category to use in the permalink.</span>&nbsp;</div></li><li><div><span class="comment">               * @param array    $cats Array of all categories (WP_Term objects) associated with the post.</span>&nbsp;</div></li><li><div><span class="comment">               * @param WP_Post  $post The post in question.</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $category_object = apply_filters( 'post_link_category', $cats[0], $cats, $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $category_object = get_term( $category_object, 'category' );&nbsp;</div></li><li><div>              $category = $category_object-&gt;slug;&nbsp;</div></li><li><div>              if ( $parent = $category_object-&gt;parent )&nbsp;</div></li><li><div>                  $category = get_category_parents($parent, false, '/', true) . $category;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// show default category in permalinks, without</span>&nbsp;</div></li><li><div>          <span class="comment">// having to assign it explicitly</span>&nbsp;</div></li><li><div>          if ( empty($category) ) {&nbsp;</div></li><li><div>              $default_category = get_term( get_option( 'default_category' ), 'category' );&nbsp;</div></li><li><div>              if ( $default_category && ! is_wp_error( $default_category ) ) {&nbsp;</div></li><li><div>                  $category = $default_category-&gt;slug;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $author = '';&nbsp;</div></li><li><div>      if ( strpos($permalink, '%author%') !== false ) {&nbsp;</div></li><li><div>          $authordata = get_userdata($post-&gt;post_author);&nbsp;</div></li><li><div>          $author = $authordata-&gt;user_nicename;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $date = explode(&quot; &quot;, date('Y m d H i s', $unixtime));&nbsp;</div></li><li><div>      $rewritereplace =&nbsp;</div></li><li><div>      array(&nbsp;</div></li><li><div>          $date[0], &nbsp;</div></li><li><div>          $date[1], &nbsp;</div></li><li><div>          $date[2], &nbsp;</div></li><li><div>          $date[3], &nbsp;</div></li><li><div>          $date[4], &nbsp;</div></li><li><div>          $date[5], &nbsp;</div></li><li><div>          $post-&gt;post_name, &nbsp;</div></li><li><div>          $post-&gt;ID, &nbsp;</div></li><li><div>          $category, &nbsp;</div></li><li><div>          $author, &nbsp;</div></li><li><div>          $post-&gt;post_name, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      $permalink = home_url( str_replace($rewritecode, $rewritereplace, $permalink) );&nbsp;</div></li><li><div>      $permalink = user_trailingslashit($permalink, 'single');&nbsp;</div></li><li><div>  } else { <span class="comment">// if they're not using the fancy permalink option</span>&nbsp;</div></li><li><div>      $permalink = home_url('?p=' . $post-&gt;ID);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the permalink for a post.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Only applies to posts with post_type of 'post'.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $permalink The post's permalink.</span>&nbsp;</div></li><li><div><span class="comment">   * @param WP_Post $post      The post in question.</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool    $leavename Whether to keep the post name.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'post_link', $permalink, $post, $leavename );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the permalink for a post of a custom post type.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $id         Optional. Post ID. Default uses the global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $leavename Optional, defaults to false. Whether to keep post name. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $sample    Optional, defaults to false. Is it a sample permalink. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|WP_Error The post permalink.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_post_permalink( $id = 0, $leavename = false, $sample = false ) {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $post = get_post($id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_wp_error( $post ) )&nbsp;</div></li><li><div>      return $post;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $post_link = $wp_rewrite-&gt;get_extra_permastruct($post-&gt;post_type);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $slug = $post-&gt;post_name;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $draft_or_pending = get_post_status( $id ) && in_array( get_post_status( $id ), array( 'draft', 'pending', 'auto-draft', 'future' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $post_type = get_post_type_object($post-&gt;post_type);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $post_type-&gt;hierarchical ) {&nbsp;</div></li><li><div>      $slug = get_page_uri( $id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !empty($post_link) && ( !$draft_or_pending || $sample ) ) {&nbsp;</div></li><li><div>      if ( ! $leavename ) {&nbsp;</div></li><li><div>          $post_link = str_replace(&quot;%$post-&gt;post_type%&quot;, $slug, $post_link);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $post_link = home_url( user_trailingslashit($post_link) );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      if ( $post_type-&gt;query_var && ( isset($post-&gt;post_status) && !$draft_or_pending ) )&nbsp;</div></li><li><div>          $post_link = add_query_arg($post_type-&gt;query_var, $slug, '');&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          $post_link = add_query_arg(array('post_type' =&gt; $post-&gt;post_type, 'p' =&gt; $post-&gt;ID), '');&nbsp;</div></li><li><div>      $post_link = home_url($post_link);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the permalink for a post of a custom post type.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $post_link The post's permalink.</span>&nbsp;</div></li><li><div><span class="comment">   * @param WP_Post $post      The post in question.</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool    $leavename Whether to keep the post name.</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool    $sample    Is it a sample permalink.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'post_type_link', $post_link, $post, $leavename, $sample );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the permalink for the current page or page ID.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Respects page_on_front. Use this one.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|WP_Post $post      Optional. Post ID or object. Default uses the global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool        $leavename Optional. Whether to keep the page name. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool        $sample    Optional. Whether it should be treated as a sample permalink.</span>&nbsp;</div></li><li><div><span class="comment"> *                               Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The page permalink.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_page_link( $post = false, $leavename = false, $sample = false ) {&nbsp;</div></li><li><div>  $post = get_post( $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'page' == get_option( 'show_on_front' ) && $post-&gt;ID == get_option( 'page_on_front' ) )&nbsp;</div></li><li><div>      $link = home_url('/');&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      $link = _get_page_link( $post, $leavename, $sample );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the permalink for a page.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link    The page's permalink.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $post_id The ID of the page.</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool   $sample  Is it a sample permalink.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'page_link', $link, $post-&gt;ID, $sample );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the page permalink.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Ignores page_on_front. Internal use only.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|WP_Post $post      Optional. Post ID or object. Default uses the global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool        $leavename Optional. Whether to keep the page name. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool        $sample    Optional. Whether it should be treated as a sample permalink.</span>&nbsp;</div></li><li><div><span class="comment"> *                               Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The page permalink.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _get_page_link( $post = false, $leavename = false, $sample = false ) {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $post = get_post( $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $draft_or_pending = in_array( $post-&gt;post_status, array( 'draft', 'pending', 'auto-draft' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $link = $wp_rewrite-&gt;get_page_permastruct();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !empty($link) && ( ( isset($post-&gt;post_status) && !$draft_or_pending ) || $sample ) ) {&nbsp;</div></li><li><div>      if ( ! $leavename ) {&nbsp;</div></li><li><div>          $link = str_replace('%pagename%', get_page_uri( $post ), $link);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $link = home_url($link);&nbsp;</div></li><li><div>      $link = user_trailingslashit($link, 'page');&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $link = home_url( '?page_id=' . $post-&gt;ID );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the permalink for a non-page_on_front page.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link    The page's permalink.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $post_id The ID of the page.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( '_get_page_link', $link, $post-&gt;ID );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the permalink for an attachment.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This can be used in the WordPress Loop or outside of it.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|object $post      Optional. Post ID or object. Default uses the global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool       $leavename Optional. Whether to keep the page name. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The attachment permalink.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_attachment_link( $post = null, $leavename = false ) {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $link = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $post = get_post( $post );&nbsp;</div></li><li><div>  $parent = ( $post-&gt;post_parent &gt; 0 && $post-&gt;post_parent != $post-&gt;ID ) ? get_post( $post-&gt;post_parent ) : false;&nbsp;</div></li><li><div>  if ( $parent && ! in_array( $parent-&gt;post_type, get_post_types() ) ) {&nbsp;</div></li><li><div>      $parent = false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $wp_rewrite-&gt;using_permalinks() && $parent ) {&nbsp;</div></li><li><div>      if ( 'page' == $parent-&gt;post_type )&nbsp;</div></li><li><div>          $parentlink = _get_page_link( $post-&gt;post_parent ); <span class="comment">// Ignores page_on_front</span>&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          $parentlink = get_permalink( $post-&gt;post_parent );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_numeric($post-&gt;post_name) || false !== strpos(get_option('permalink_structure'), '%category%') )&nbsp;</div></li><li><div>          $name = 'attachment/' . $post-&gt;post_name; <span class="comment">// &lt;permalink&gt;/&lt;int&gt;/ is paged so we use the explicit attachment marker</span>&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          $name = $post-&gt;post_name;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( strpos($parentlink, '?') === false )&nbsp;</div></li><li><div>          $link = user_trailingslashit( trailingslashit($parentlink) . '%postname%' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! $leavename )&nbsp;</div></li><li><div>          $link = str_replace( '%postname%', $name, $link );&nbsp;</div></li><li><div>  } elseif ( $wp_rewrite-&gt;using_permalinks() && ! $leavename ) {&nbsp;</div></li><li><div>      $link = home_url( user_trailingslashit( $post-&gt;post_name ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $link )&nbsp;</div></li><li><div>      $link = home_url( '/?attachment_id=' . $post-&gt;ID );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the permalink for an attachment.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link    The attachment's permalink.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $post_id Attachment ID.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'attachment_link', $link, $post-&gt;ID );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the permalink for the year archives.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|bool $year False for current year or year for permalink.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The permalink for the specified year archive.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_year_link( $year ) {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>  if ( !$year )&nbsp;</div></li><li><div>      $year = gmdate('Y', current_time('timestamp'));&nbsp;</div></li><li><div>  $yearlink = $wp_rewrite-&gt;get_year_permastruct();&nbsp;</div></li><li><div>  if ( !empty($yearlink) ) {&nbsp;</div></li><li><div>      $yearlink = str_replace('%year%', $year, $yearlink);&nbsp;</div></li><li><div>      $yearlink = home_url( user_trailingslashit( $yearlink, 'year' ) );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $yearlink = home_url( '?m=' . $year );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the year archive permalink.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $yearlink Permalink for the year archive.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $year     Year for the archive.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'year_link', $yearlink, $year );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the permalink for the month archives with year.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool|int $year  False for current year. Integer of year.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool|int $month False for current month. Integer of month.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The permalink for the specified month and year archive.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_month_link($year, $month) {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>  if ( !$year )&nbsp;</div></li><li><div>      $year = gmdate('Y', current_time('timestamp'));&nbsp;</div></li><li><div>  if ( !$month )&nbsp;</div></li><li><div>      $month = gmdate('m', current_time('timestamp'));&nbsp;</div></li><li><div>  $monthlink = $wp_rewrite-&gt;get_month_permastruct();&nbsp;</div></li><li><div>  if ( !empty($monthlink) ) {&nbsp;</div></li><li><div>      $monthlink = str_replace('%year%', $year, $monthlink);&nbsp;</div></li><li><div>      $monthlink = str_replace('%monthnum%', zeroise(intval($month), 2), $monthlink);&nbsp;</div></li><li><div>      $monthlink = home_url( user_trailingslashit( $monthlink, 'month' ) );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $monthlink = home_url( '?m=' . $year . zeroise( $month, 2 ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the month archive permalink.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $monthlink Permalink for the month archive.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $year      Year for the archive.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $month     The month for the archive.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'month_link', $monthlink, $year, $month );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the permalink for the day archives with year and month.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool|int $year  False for current year. Integer of year.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool|int $month False for current month. Integer of month.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool|int $day   False for current day. Integer of day.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The permalink for the specified day, month, and year archive.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_day_link($year, $month, $day) {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>  if ( !$year )&nbsp;</div></li><li><div>      $year = gmdate('Y', current_time('timestamp'));&nbsp;</div></li><li><div>  if ( !$month )&nbsp;</div></li><li><div>      $month = gmdate('m', current_time('timestamp'));&nbsp;</div></li><li><div>  if ( !$day )&nbsp;</div></li><li><div>      $day = gmdate('j', current_time('timestamp'));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $daylink = $wp_rewrite-&gt;get_day_permastruct();&nbsp;</div></li><li><div>  if ( !empty($daylink) ) {&nbsp;</div></li><li><div>      $daylink = str_replace('%year%', $year, $daylink);&nbsp;</div></li><li><div>      $daylink = str_replace('%monthnum%', zeroise(intval($month), 2), $daylink);&nbsp;</div></li><li><div>      $daylink = str_replace('%day%', zeroise(intval($day), 2), $daylink);&nbsp;</div></li><li><div>      $daylink = home_url( user_trailingslashit( $daylink, 'day' ) );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $daylink = home_url( '?m=' . $year . zeroise( $month, 2 ) . zeroise( $day, 2 ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the day archive permalink.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $daylink Permalink for the day archive.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $year    Year for the archive.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $month   Month for the archive.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $day     The day for the archive.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'day_link', $daylink, $year, $month, $day );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the permalink for the feed type.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $anchor The link's anchor text.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $feed   Optional. Feed type. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function the_feed_link( $anchor, $feed = '' ) {&nbsp;</div></li><li><div>  $link = '&lt;a href=&quot;' . esc_url( get_feed_link( $feed ) ) . '&quot;&gt;' . $anchor . '&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the feed link anchor tag.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link The complete anchor tag for a feed link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $feed The feed type, or an empty string for the</span>&nbsp;</div></li><li><div><span class="comment">   *                     default feed type.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo apply_filters( 'the_feed_link', $link, $feed );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the permalink for the feed type.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $feed Optional. Feed type. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The feed permalink.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_feed_link( $feed = '' ) {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $permalink = $wp_rewrite-&gt;get_feed_permastruct();&nbsp;</div></li><li><div>  if ( '' != $permalink ) {&nbsp;</div></li><li><div>      if ( false !== strpos($feed, 'comments_') ) {&nbsp;</div></li><li><div>          $feed = str_replace('comments_', '', $feed);&nbsp;</div></li><li><div>          $permalink = $wp_rewrite-&gt;get_comment_feed_permastruct();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( get_default_feed() == $feed )&nbsp;</div></li><li><div>          $feed = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $permalink = str_replace('%feed%', $feed, $permalink);&nbsp;</div></li><li><div>      $permalink = preg_replace('#/+#', '/', &quot;/$permalink&quot;);&nbsp;</div></li><li><div>      $output =  home_url( user_trailingslashit($permalink, 'feed') );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      if ( empty($feed) )&nbsp;</div></li><li><div>          $feed = get_default_feed();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( false !== strpos($feed, 'comments_') )&nbsp;</div></li><li><div>          $feed = str_replace('comments_', 'comments-', $feed);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $output = home_url(&quot;?feed={$feed}&quot;);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the feed type permalink.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $output The feed permalink.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $feed   Feed type.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'feed_link', $output, $feed );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the permalink for the post comments feed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $post_id Optional. Post ID. Default is the ID of the global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $feed    Optional. Feed type. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The permalink for the comments feed for the given post.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_post_comments_feed_link( $post_id = 0, $feed = '' ) {&nbsp;</div></li><li><div>  $post_id = absint( $post_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $post_id )&nbsp;</div></li><li><div>      $post_id = get_the_ID();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $feed ) )&nbsp;</div></li><li><div>      $feed = get_default_feed();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $post = get_post( $post_id );&nbsp;</div></li><li><div>  $unattached = 'attachment' === $post-&gt;post_type && 0 === (int) $post-&gt;post_parent;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( '' != get_option('permalink_structure') ) {&nbsp;</div></li><li><div>      if ( 'page' == get_option('show_on_front') && $post_id == get_option('page_on_front') )&nbsp;</div></li><li><div>          $url = _get_page_link( $post_id );&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          $url = get_permalink($post_id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $unattached ) {&nbsp;</div></li><li><div>          $url =  home_url( '/feed/' );&nbsp;</div></li><li><div>          if ( $feed !== get_default_feed() ) {&nbsp;</div></li><li><div>              $url .= &quot;$feed/&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $url = add_query_arg( 'attachment_id', $post_id, $url );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $url = trailingslashit($url) . 'feed';&nbsp;</div></li><li><div>          if ( $feed != get_default_feed() )&nbsp;</div></li><li><div>              $url .= &quot;/$feed&quot;;&nbsp;</div></li><li><div>          $url = user_trailingslashit($url, 'single_feed');&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      if ( $unattached ) {&nbsp;</div></li><li><div>          $url = add_query_arg( array( 'feed' =&gt; $feed, 'attachment_id' =&gt; $post_id ), home_url( '/' ) );&nbsp;</div></li><li><div>      } elseif ( 'page' == $post-&gt;post_type ) {&nbsp;</div></li><li><div>          $url = add_query_arg( array( 'feed' =&gt; $feed, 'page_id' =&gt; $post_id ), home_url( '/' ) );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $url = add_query_arg( array( 'feed' =&gt; $feed, 'p' =&gt; $post_id ), home_url( '/' ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the post comments feed permalink.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.1</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url Post comments feed permalink.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'post_comments_feed_link', $url );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the comment feed link for a post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Prints out the comment feed link for a post. Link text is placed in the</span>&nbsp;</div></li><li><div><span class="comment"> * anchor. If no link text is specified, default text is used. If no post ID is</span>&nbsp;</div></li><li><div><span class="comment"> * specified, the current post is used.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $link_text Optional. Descriptive link text. Default 'Comments Feed'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $post_id   Optional. Post ID. Default is the ID of the global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $feed      Optional. Feed format. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function post_comments_feed_link( $link_text = '', $post_id = '', $feed = '' ) {&nbsp;</div></li><li><div>  $url = get_post_comments_feed_link( $post_id, $feed );&nbsp;</div></li><li><div>  if ( empty( $link_text ) ) {&nbsp;</div></li><li><div>      $link_text = __('Comments Feed');&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $link = '&lt;a href=&quot;' . esc_url( $url ) . '&quot;&gt;' . $link_text . '&lt;/a&gt;';&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the post comment feed link anchor tag.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link    The complete anchor tag for the comment feed link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $post_id Post ID.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $feed    The feed type, or an empty string for the default feed type.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo apply_filters( 'post_comments_feed_link_html', $link, $post_id, $feed );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the feed link for a given author.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Returns a link to the feed for all posts by a given author. A specific feed</span>&nbsp;</div></li><li><div><span class="comment"> * can be requested or left blank to get the default feed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $author_id Author ID.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $feed      Optional. Feed type. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Link to the feed for the author specified by $author_id.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_author_feed_link( $author_id, $feed = '' ) {&nbsp;</div></li><li><div>  $author_id = (int) $author_id;&nbsp;</div></li><li><div>  $permalink_structure = get_option('permalink_structure');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($feed) )&nbsp;</div></li><li><div>      $feed = get_default_feed();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( '' == $permalink_structure ) {&nbsp;</div></li><li><div>      $link = home_url(&quot;?feed=$feed&amp;author=&quot; . $author_id);&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $link = get_author_posts_url($author_id);&nbsp;</div></li><li><div>      if ( $feed == get_default_feed() )&nbsp;</div></li><li><div>          $feed_link = 'feed';&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          $feed_link = &quot;feed/$feed&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $link = trailingslashit($link) . user_trailingslashit($feed_link, 'feed');&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the feed link for a given author.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.1</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link The author feed link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $feed Feed type.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $link = apply_filters( 'author_feed_link', $link, $feed );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $link;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the feed link for a category.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Returns a link to the feed for all posts in a given category. A specific feed</span>&nbsp;</div></li><li><div><span class="comment"> * can be requested or left blank to get the default feed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $cat_id Category ID.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $feed   Optional. Feed type. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Link to the feed for the category specified by $cat_id.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_category_feed_link( $cat_id, $feed = '' ) {&nbsp;</div></li><li><div>  return get_term_feed_link( $cat_id, 'category', $feed );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the feed link for a term.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Returns a link to the feed for all posts in a given term. A specific feed</span>&nbsp;</div></li><li><div><span class="comment"> * can be requested or left blank to get the default feed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $term_id  Term ID.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $taxonomy Optional. Taxonomy of `$term_id`. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $feed     Optional. Feed type. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|false Link to the feed for the term specified by $term_id and $taxonomy.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_term_feed_link( $term_id, $taxonomy = 'category', $feed = '' ) {&nbsp;</div></li><li><div>  $term_id = (int) $term_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $term = get_term( $term_id, $taxonomy );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $term ) || is_wp_error( $term ) )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $feed ) )&nbsp;</div></li><li><div>      $feed = get_default_feed();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $permalink_structure = get_option( 'permalink_structure' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( '' == $permalink_structure ) {&nbsp;</div></li><li><div>      if ( 'category' == $taxonomy ) {&nbsp;</div></li><li><div>          $link = home_url(&quot;?feed=$feed&amp;cat=$term_id&quot;);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      elseif ( 'post_tag' == $taxonomy ) {&nbsp;</div></li><li><div>          $link = home_url(&quot;?feed=$feed&amp;tag=$term-&gt;slug&quot;);&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $t = get_taxonomy( $taxonomy );&nbsp;</div></li><li><div>          $link = home_url(&quot;?feed=$feed&amp;$t-&gt;query_var=$term-&gt;slug&quot;);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $link = get_term_link( $term_id, $term-&gt;taxonomy );&nbsp;</div></li><li><div>      if ( $feed == get_default_feed() )&nbsp;</div></li><li><div>          $feed_link = 'feed';&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          $feed_link = &quot;feed/$feed&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $link = trailingslashit( $link ) . user_trailingslashit( $feed_link, 'feed' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'category' == $taxonomy ) {&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the category feed link.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.1</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $link The category feed link.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $feed Feed type.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $link = apply_filters( 'category_feed_link', $link, $feed );&nbsp;</div></li><li><div>  } elseif ( 'post_tag' == $taxonomy ) {&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the post tag feed link.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.3.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $link The tag feed link.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $feed Feed type.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $link = apply_filters( 'tag_feed_link', $link, $feed );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the feed link for a taxonomy other than 'category' or 'post_tag'.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $link The taxonomy feed link.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $feed Feed type.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $feed The taxonomy name.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $link = apply_filters( 'taxonomy_feed_link', $link, $feed, $taxonomy );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $link;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the permalink for a tag feed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.3.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $tag_id Tag ID.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $feed   Optional. Feed type. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The feed permalink for the given tag.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_tag_feed_link( $tag_id, $feed = '' ) {&nbsp;</div></li><li><div>  return get_term_feed_link( $tag_id, 'post_tag', $feed );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the edit link for a tag.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $tag_id   Tag ID.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $taxonomy Optional. Taxonomy slug. Default 'post_tag'.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The edit tag link URL for the given tag.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_edit_tag_link( $tag_id, $taxonomy = 'post_tag' ) {&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the edit link for a tag (or term in another taxonomy).</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link The term edit link.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'get_edit_tag_link', get_edit_term_link( $tag_id, $taxonomy ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays or retrieves the edit link for a tag with formatting.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string  $link   Optional. Anchor text. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string  $before Optional. Display before edit link. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string  $after  Optional. Display after edit link. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param WP_Term $tag    Optional. Term object. If null, the queried object will be inspected.</span>&nbsp;</div></li><li><div><span class="comment"> *                        Default null.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edit_tag_link( $link = '', $before = '', $after = '', $tag = null ) {&nbsp;</div></li><li><div>  $link = edit_term_link( $link, '', '', $tag, false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the anchor tag for the edit link for a tag (or term in another taxonomy).</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link The anchor tag for the edit link.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo $before . apply_filters( 'edit_tag_link', $link ) . $after;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL for editing a given term.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.5.0 The `$taxonomy` argument was made optional.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $term_id     Term ID.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $taxonomy    Optional. Taxonomy. Defaults to the taxonomy of the term identified</span>&nbsp;</div></li><li><div><span class="comment"> *                            by `$term_id`.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $object_type Optional. The object type. Used to highlight the proper post type</span>&nbsp;</div></li><li><div><span class="comment"> *                            menu on the linked page. Defaults to the first object_type associated</span>&nbsp;</div></li><li><div><span class="comment"> *                            with the taxonomy.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|null The edit term link URL for the given term, or null on failure.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_edit_term_link( $term_id, $taxonomy = '', $object_type = '' ) {&nbsp;</div></li><li><div>  $term = get_term( $term_id, $taxonomy );&nbsp;</div></li><li><div>  if ( ! $term || is_wp_error( $term ) ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $tax = get_taxonomy( $term-&gt;taxonomy );&nbsp;</div></li><li><div>  if ( ! $tax || ! current_user_can( 'edit_term', $term-&gt;term_id ) ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $args = array(&nbsp;</div></li><li><div>      'taxonomy' =&gt; $taxonomy, &nbsp;</div></li><li><div>      'tag_ID' =&gt; $term-&gt;term_id, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $object_type ) {&nbsp;</div></li><li><div>      $args['post_type'] = $object_type;&nbsp;</div></li><li><div>  } elseif ( ! empty( $tax-&gt;object_type ) ) {&nbsp;</div></li><li><div>      $args['post_type'] = reset( $tax-&gt;object_type );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $tax-&gt;show_ui ) {&nbsp;</div></li><li><div>      $location = add_query_arg( $args, admin_url( 'term.php' ) );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $location = '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the edit link for a term.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $location    The edit link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $term_id     Term ID.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $taxonomy    Taxonomy name.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $object_type The object type (eg. the post type).</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'get_edit_term_link', $location, $term_id, $taxonomy, $object_type );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays or retrieves the edit term link with formatting.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $link   Optional. Anchor text. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $before Optional. Display before edit link. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $after  Optional. Display after edit link. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param object $term   Optional. Term object. If null, the queried object will be inspected. Default null.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool   $echo   Optional. Whether or not to echo the return. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void HTML content.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edit_term_link( $link = '', $before = '', $after = '', $term = null, $echo = true ) {&nbsp;</div></li><li><div>  if ( is_null( $term ) )&nbsp;</div></li><li><div>      $term = get_queried_object();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $term )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $tax = get_taxonomy( $term-&gt;taxonomy );&nbsp;</div></li><li><div>  if ( ! current_user_can( 'edit_term', $term-&gt;term_id ) ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $link ) )&nbsp;</div></li><li><div>      $link = __('Edit This');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $link = '&lt;a href=&quot;' . get_edit_term_link( $term-&gt;term_id, $term-&gt;taxonomy ) . '&quot;&gt;' . $link . '&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the anchor tag for the edit link of a term.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link    The anchor tag for the edit link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $term_id Term ID.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $link = $before . apply_filters( 'edit_term_link', $link, $term-&gt;term_id ) . $after;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $echo )&nbsp;</div></li><li><div>      echo $link;&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      return $link;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the permalink for a search.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since  3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $query Optional. The query string to use. If empty the current query is used. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The search permalink.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_search_link( $query = '' ) {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($query) )&nbsp;</div></li><li><div>      $search = get_search_query( false );&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      $search = stripslashes($query);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $permastruct = $wp_rewrite-&gt;get_search_permastruct();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $permastruct ) ) {&nbsp;</div></li><li><div>      $link = home_url('?s=' . urlencode($search) );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $search = urlencode($search);&nbsp;</div></li><li><div>      $search = str_replace('%2F', '/', $search); <span class="comment">// %2F(/) is not valid within a URL, send it un-encoded.</span>&nbsp;</div></li><li><div>      $link = str_replace( '%search%', $search, $permastruct );&nbsp;</div></li><li><div>      $link = home_url( user_trailingslashit( $link, 'search' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the search permalink.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link   Search permalink.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $search The URL-encoded search term.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'search_link', $link, $search );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the permalink for the search results feed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $search_query Optional. Search query. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $feed         Optional. Feed type. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The search results feed permalink.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_search_feed_link($search_query = '', $feed = '') {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>  $link = get_search_link($search_query);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($feed) )&nbsp;</div></li><li><div>      $feed = get_default_feed();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $permastruct = $wp_rewrite-&gt;get_search_permastruct();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($permastruct) ) {&nbsp;</div></li><li><div>      $link = add_query_arg('feed', $feed, $link);&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $link = trailingslashit($link);&nbsp;</div></li><li><div>      $link .= &quot;feed/$feed/&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the search feed link.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link Search feed link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $feed Feed type.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $type The search type. One of 'posts' or 'comments'.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'search_feed_link', $link, $feed, 'posts' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the permalink for the search results comments feed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $search_query Optional. Search query. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $feed         Optional. Feed type. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The comments feed search results permalink.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_search_comments_feed_link($search_query = '', $feed = '') {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($feed) )&nbsp;</div></li><li><div>      $feed = get_default_feed();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $link = get_search_feed_link($search_query, $feed);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $permastruct = $wp_rewrite-&gt;get_search_permastruct();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($permastruct) )&nbsp;</div></li><li><div>      $link = add_query_arg('feed', 'comments-' . $feed, $link);&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      $link = add_query_arg('withcomments', 1, $link);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment">/** This filter is documented in wp-includes/link-template.php */</span></span></span></span>&nbsp;</div></li><li><div>  return apply_filters( 'search_feed_link', $link, $feed, 'comments' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the permalink for a post type archive.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.5.0 Support for posts was added.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $post_type Post type.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|false The post type archive permalink.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_post_type_archive_link( $post_type ) {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>  if ( ! $post_type_obj = get_post_type_object( $post_type ) )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'post' === $post_type ) {&nbsp;</div></li><li><div>      $show_on_front = get_option( 'show_on_front' );&nbsp;</div></li><li><div>      $page_for_posts = get_option( 'page_for_posts' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 'page' == $show_on_front && $page_for_posts ) {&nbsp;</div></li><li><div>          $link = get_permalink( $page_for_posts );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $link = get_home_url();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment">/** This filter is documented in wp-includes/link-template.php */</span></span></span></span>&nbsp;</div></li><li><div>      return apply_filters( 'post_type_archive_link', $link, $post_type );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $post_type_obj-&gt;has_archive )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( get_option( 'permalink_structure' ) && is_array( $post_type_obj-&gt;rewrite ) ) {&nbsp;</div></li><li><div>      $struct = ( true === $post_type_obj-&gt;has_archive ) ? $post_type_obj-&gt;rewrite['slug'] : $post_type_obj-&gt;has_archive;&nbsp;</div></li><li><div>      if ( $post_type_obj-&gt;rewrite['with_front'] )&nbsp;</div></li><li><div>          $struct = $wp_rewrite-&gt;front . $struct;&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          $struct = $wp_rewrite-&gt;root . $struct;&nbsp;</div></li><li><div>      $link = home_url( user_trailingslashit( $struct, 'post_type_archive' ) );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $link = home_url( '?post_type=' . $post_type );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the post type archive permalink.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link      The post type archive permalink.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $post_type Post type name.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'post_type_archive_link', $link, $post_type );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the permalink for a post type archive feed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $post_type Post type</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $feed      Optional. Feed type. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|false The post type feed permalink.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_post_type_archive_feed_link( $post_type, $feed = '' ) {&nbsp;</div></li><li><div>  $default_feed = get_default_feed();&nbsp;</div></li><li><div>  if ( empty( $feed ) )&nbsp;</div></li><li><div>      $feed = $default_feed;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $link = get_post_type_archive_link( $post_type ) )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $post_type_obj = get_post_type_object( $post_type );&nbsp;</div></li><li><div>  if ( get_option( 'permalink_structure' ) && is_array( $post_type_obj-&gt;rewrite ) && $post_type_obj-&gt;rewrite['feeds'] ) {&nbsp;</div></li><li><div>      $link = trailingslashit( $link );&nbsp;</div></li><li><div>      $link .= 'feed/';&nbsp;</div></li><li><div>      if ( $feed != $default_feed )&nbsp;</div></li><li><div>          $link .= &quot;$feed/&quot;;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $link = add_query_arg( 'feed', $feed, $link );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the post type archive feed link.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link The post type archive feed link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $feed Feed type.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'post_type_archive_feed_link', $link, $feed );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL used for the post preview.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Allows additional query args to be appended.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|WP_Post $post         Optional. Post ID or `WP_Post` object. Defaults to global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array       $query_args   Optional. Array of additional query args to be appended to the link.</span>&nbsp;</div></li><li><div><span class="comment"> *                                  Default empty array.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string      $preview_link Optional. Base preview link to be used if it should differ from the</span>&nbsp;</div></li><li><div><span class="comment"> *                                  post permalink. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|null URL used for the post preview, or null if the post does not exist.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_preview_post_link( $post = null, $query_args = array(), $preview_link = '' ) {&nbsp;</div></li><li><div>  $post = get_post( $post );&nbsp;</div></li><li><div>  if ( ! $post ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $post_type_object = get_post_type_object( $post-&gt;post_type );&nbsp;</div></li><li><div>  if ( is_post_type_viewable( $post_type_object ) ) {&nbsp;</div></li><li><div>      if ( ! $preview_link ) {&nbsp;</div></li><li><div>          $preview_link = set_url_scheme( get_permalink( $post ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $query_args['preview'] = 'true';&nbsp;</div></li><li><div>      $preview_link = add_query_arg( $query_args, $preview_link );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the URL used for a post preview.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.0.5</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0.0 Added the `$post` parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $preview_link URL used for the post preview.</span>&nbsp;</div></li><li><div><span class="comment">   * @param WP_Post $post         Post object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'preview_post_link', $preview_link, $post );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the edit post link for post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Can be used within the WordPress loop or outside of it. Can be used with</span>&nbsp;</div></li><li><div><span class="comment"> * pages, posts, attachments, and revisions.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.3.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $id      Optional. Post ID. Default is the ID of the global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $context Optional. How to output the '&' character. Default '&amp;'.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|null The edit post link for the given post. null if the post type is invalid or does</span>&nbsp;</div></li><li><div><span class="comment"> *                     not allow an editing UI.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_edit_post_link( $id = 0, $context = 'display' ) {&nbsp;</div></li><li><div>  if ( ! $post = get_post( $id ) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'revision' === $post-&gt;post_type )&nbsp;</div></li><li><div>      $action = '';&nbsp;</div></li><li><div>  elseif ( 'display' == $context )&nbsp;</div></li><li><div>      $action = '&amp;action=edit';&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      $action = '&action=edit';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $post_type_object = get_post_type_object( $post-&gt;post_type );&nbsp;</div></li><li><div>  if ( !$post_type_object )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !current_user_can( 'edit_post', $post-&gt;ID ) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $post_type_object-&gt;_edit_link ) {&nbsp;</div></li><li><div>      $link = admin_url( sprintf( $post_type_object-&gt;_edit_link . $action, $post-&gt;ID ) );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $link = '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the post edit link.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.3.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link    The edit link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $post_id Post ID.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $context The link context. If set to 'display' then ampersands</span>&nbsp;</div></li><li><div><span class="comment">   *                        are encoded.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'get_edit_post_link', $link, $post-&gt;ID, $context );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the edit post link for post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0 The `$class` argument was added.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $text   Optional. Anchor text. If null, default is 'Edit This'. Default null.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $before Optional. Display before edit link. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $after  Optional. Display after edit link. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $id     Optional. Post ID. Default is the ID of the global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $class  Optional. Add custom class to link. Default 'post-edit-link'.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edit_post_link( $text = null, $before = '', $after = '', $id = 0, $class = 'post-edit-link' ) {&nbsp;</div></li><li><div>  if ( ! $post = get_post( $id ) ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $url = get_edit_post_link( $post-&gt;ID ) ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( null === $text ) {&nbsp;</div></li><li><div>      $text = __( 'Edit This' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $link = '&lt;a class=&quot;' . esc_attr( $class ) . '&quot; href=&quot;' . esc_url( $url ) . '&quot;&gt;' . $text . '&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the post edit link anchor tag.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.3.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link    Anchor tag for the edit link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $post_id Post ID.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $text    Anchor text.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo $before . apply_filters( 'edit_post_link', $link, $post-&gt;ID, $text ) . $after;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the delete posts link for post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Can be used within the WordPress loop or outside of it, with any post type.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $id           Optional. Post ID. Default is the ID of the global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $deprecated   Not used.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool   $force_delete Optional. Whether to bypass trash and force deletion. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void The delete post link URL for the given post.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_delete_post_link( $id = 0, $deprecated = '', $force_delete = false ) {&nbsp;</div></li><li><div>  if ( ! empty( $deprecated ) )&nbsp;</div></li><li><div>      _deprecated_argument( __FUNCTION__, '3.0.0' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !$post = get_post( $id ) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $post_type_object = get_post_type_object( $post-&gt;post_type );&nbsp;</div></li><li><div>  if ( !$post_type_object )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !current_user_can( 'delete_post', $post-&gt;ID ) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $action = ( $force_delete || !EMPTY_TRASH_DAYS ) ? 'delete' : 'trash';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $delete_link = add_query_arg( 'action', $action, admin_url( sprintf( $post_type_object-&gt;_edit_link, $post-&gt;ID ) ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the post delete link.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link         The delete link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $post_id      Post ID.</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool   $force_delete Whether to bypass the trash and force deletion. Default false.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'get_delete_post_link', wp_nonce_url( $delete_link, &quot;$action-post_{$post-&gt;ID}&quot; ), $post-&gt;ID, $force_delete );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the edit comment link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.3.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|WP_Comment $comment_id Optional. Comment ID or WP_Comment object.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void The edit comment link URL for the given comment.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_edit_comment_link( $comment_id = 0 ) {&nbsp;</div></li><li><div>  $comment = get_comment( $comment_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !current_user_can( 'edit_comment', $comment-&gt;comment_ID ) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $location = admin_url('comment.php?action=editcomment&amp;c=') . $comment-&gt;comment_ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the comment edit link.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.3.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $location The edit link.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'get_edit_comment_link', $location );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the edit comment link with formatting.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $text   Optional. Anchor text. If null, default is 'Edit This'. Default null.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $before Optional. Display before edit link. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $after  Optional. Display after edit link. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edit_comment_link( $text = null, $before = '', $after = '' ) {&nbsp;</div></li><li><div>  $comment = get_comment();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! current_user_can( 'edit_comment', $comment-&gt;comment_ID ) ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( null === $text ) {&nbsp;</div></li><li><div>      $text = __( 'Edit This' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $link = '&lt;a class=&quot;comment-edit-link&quot; href=&quot;' . esc_url( get_edit_comment_link( $comment ) ) . '&quot;&gt;' . $text . '&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the comment edit link anchor tag.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.3.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link       Anchor tag for the edit link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $comment_id Comment ID.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $text       Anchor text.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo $before . apply_filters( 'edit_comment_link', $link, $comment-&gt;comment_ID, $text ) . $after;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the edit bookmark link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|stdClass $link Optional. Bookmark ID. Default is the id of the current bookmark.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void The edit bookmark link URL.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_edit_bookmark_link( $link = 0 ) {&nbsp;</div></li><li><div>  $link = get_bookmark( $link );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !current_user_can('manage_links') )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $location = admin_url('link.php?action=edit&amp;link_id=') . $link-&gt;link_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the bookmark edit link.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $location The edit link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $link_id  Bookmark ID.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'get_edit_bookmark_link', $location, $link-&gt;link_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the edit bookmark link anchor content.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $link     Optional. Anchor text. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $before   Optional. Display before edit link. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $after    Optional. Display after edit link. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $bookmark Optional. Bookmark ID. Default is the current bookmark.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edit_bookmark_link( $link = '', $before = '', $after = '', $bookmark = null ) {&nbsp;</div></li><li><div>  $bookmark = get_bookmark($bookmark);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !current_user_can('manage_links') )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($link) )&nbsp;</div></li><li><div>      $link = __('Edit This');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $link = '&lt;a href=&quot;' . esc_url( get_edit_bookmark_link( $bookmark ) ) . '&quot;&gt;' . $link . '&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the bookmark edit link anchor tag.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link    Anchor tag for the edit link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $link_id Bookmark ID.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo $before . apply_filters( 'edit_bookmark_link', $link, $bookmark-&gt;link_id ) . $after;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the edit user link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $user_id Optional. User ID. Defaults to the current user.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string URL to edit user page or empty string.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_edit_user_link( $user_id = null ) {&nbsp;</div></li><li><div>  if ( ! $user_id )&nbsp;</div></li><li><div>      $user_id = get_current_user_id();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $user_id ) || ! current_user_can( 'edit_user', $user_id ) )&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $user = get_userdata( $user_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $user )&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( get_current_user_id() == $user-&gt;ID )&nbsp;</div></li><li><div>      $link = get_edit_profile_url( $user-&gt;ID );&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      $link = add_query_arg( 'user_id', $user-&gt;ID, self_admin_url( 'user-edit.php' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the user edit link.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link    The edit link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $user_id User ID.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'get_edit_user_link', $link, $user-&gt;ID );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Navigation links</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the previous post that is adjacent to the current post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $in_same_term   Optional. Whether post should be in a same taxonomy term. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $excluded_terms Optional. Array or comma-separated list of excluded term IDs. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> * @return null|string|WP_Post Post object if successful. Null if global $post is not set. Empty string if no</span>&nbsp;</div></li><li><div><span class="comment"> *                             corresponding post exists.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_previous_post( $in_same_term = false, $excluded_terms = '', $taxonomy = 'category' ) {&nbsp;</div></li><li><div>  return get_adjacent_post( $in_same_term, $excluded_terms, true, $taxonomy );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the next post that is adjacent to the current post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $in_same_term   Optional. Whether post should be in a same taxonomy term. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $excluded_terms Optional. Array or comma-separated list of excluded term IDs. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> * @return null|string|WP_Post Post object if successful. Null if global $post is not set. Empty string if no</span>&nbsp;</div></li><li><div><span class="comment"> *                             corresponding post exists.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_next_post( $in_same_term = false, $excluded_terms = '', $taxonomy = 'category' ) {&nbsp;</div></li><li><div>  return get_adjacent_post( $in_same_term, $excluded_terms, false, $taxonomy );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the adjacent post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Can either be next or previous post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global wpdb $wpdb WordPress database abstraction object.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $in_same_term   Optional. Whether post should be in a same taxonomy term. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $excluded_terms Optional. Array or comma-separated list of excluded term IDs. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $previous       Optional. Whether to retrieve previous post. Default true</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> * @return null|string|WP_Post Post object if successful. Null if global $post is not set. Empty string if no</span>&nbsp;</div></li><li><div><span class="comment"> *                             corresponding post exists.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_adjacent_post( $in_same_term = false, $excluded_terms = '', $previous = true, $taxonomy = 'category' ) {&nbsp;</div></li><li><div>  global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ( ! $post = get_post() ) || ! taxonomy_exists( $taxonomy ) )&nbsp;</div></li><li><div>      return null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $current_post_date = $post-&gt;post_date;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $join = '';&nbsp;</div></li><li><div>  $where = '';&nbsp;</div></li><li><div>  $adjacent = $previous ? 'previous' : 'next';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $in_same_term || ! empty( $excluded_terms ) ) {&nbsp;</div></li><li><div>      if ( ! empty( $excluded_terms ) && ! is_array( $excluded_terms ) ) {&nbsp;</div></li><li><div>          <span class="comment">// back-compat, $excluded_terms used to be $excluded_terms with IDs separated by &quot; and &quot;</span>&nbsp;</div></li><li><div>          if ( false !== strpos( $excluded_terms, ' and ' ) ) {&nbsp;</div></li><li><div>              _deprecated_argument( __FUNCTION__, '3.3.0', sprintf( __( 'Use commas instead of %s to separate excluded terms.' ), &quot;'and'&quot; ) );&nbsp;</div></li><li><div>              $excluded_terms = explode( ' and ', $excluded_terms );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $excluded_terms = explode( ', ', $excluded_terms );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $excluded_terms = array_map( 'intval', $excluded_terms );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $in_same_term ) {&nbsp;</div></li><li><div>          $join .= &quot; INNER JOIN $wpdb-&gt;term_relationships AS tr ON p.ID = tr.object_id INNER JOIN $wpdb-&gt;term_taxonomy tt ON tr.term_taxonomy_id = tt.term_taxonomy_id&quot;;&nbsp;</div></li><li><div>          $where .= $wpdb-&gt;prepare( &quot;AND tt.taxonomy = %s&quot;, $taxonomy );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! is_object_in_taxonomy( $post-&gt;post_type, $taxonomy ) )&nbsp;</div></li><li><div>              return '';&nbsp;</div></li><li><div>          $term_array = wp_get_object_terms( $post-&gt;ID, $taxonomy, array( 'fields' =&gt; 'ids' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Remove any exclusions from the term array to include.</span>&nbsp;</div></li><li><div>          $term_array = array_diff( $term_array, (array) $excluded_terms );&nbsp;</div></li><li><div>          $term_array = array_map( 'intval', $term_array );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! $term_array || is_wp_error( $term_array ) )&nbsp;</div></li><li><div>              return '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $where .= &quot; AND tt.term_id IN (&quot; . implode( ', ', $term_array ) . &quot;)&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the IDs of terms excluded from adjacent post queries.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * The dynamic portion of the hook name, `$adjacent`, refers to the type</span>&nbsp;</div></li><li><div><span class="comment">       * of adjacency, 'next' or 'previous'.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $excluded_terms Array of excluded term IDs.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $excluded_terms = apply_filters( &quot;get_{$adjacent}_post_excluded_terms&quot;, $excluded_terms );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $excluded_terms ) ) {&nbsp;</div></li><li><div>          $where .= &quot; AND p.ID NOT IN ( SELECT tr.object_id FROM $wpdb-&gt;term_relationships tr LEFT JOIN $wpdb-&gt;term_taxonomy tt ON (tr.term_taxonomy_id = tt.term_taxonomy_id) WHERE tt.term_id IN (&quot; . implode( ', ', array_map( 'intval', $excluded_terms ) ) . ') )';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// 'post_status' clause depends on the current user.</span>&nbsp;</div></li><li><div>  if ( is_user_logged_in() ) {&nbsp;</div></li><li><div>      $user_id = get_current_user_id();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $post_type_object = get_post_type_object( $post-&gt;post_type );&nbsp;</div></li><li><div>      if ( empty( $post_type_object ) ) {&nbsp;</div></li><li><div>          $post_type_cap = $post-&gt;post_type;&nbsp;</div></li><li><div>          $read_private_cap = 'read_private_' . $post_type_cap . 's';&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $read_private_cap = $post_type_object-&gt;cap-&gt;read_private_posts;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Results should include private posts belonging to the current user, or private posts where the</span>&nbsp;</div></li><li><div><span class="comment">       * current user has the 'read_private_posts' cap.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $private_states = get_post_stati( array( 'private' =&gt; true ) );&nbsp;</div></li><li><div>      $where .= &quot; AND ( p.post_status = 'publish'&quot;;&nbsp;</div></li><li><div>      foreach ( (array) $private_states as $state ) {&nbsp;</div></li><li><div>          if ( current_user_can( $read_private_cap ) ) {&nbsp;</div></li><li><div>              $where .= $wpdb-&gt;prepare( &quot; OR p.post_status = %s&quot;, $state );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $where .= $wpdb-&gt;prepare( &quot; OR (p.post_author = %d AND p.post_status = %s)&quot;, $user_id, $state );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $where .= &quot; )&quot;;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $where .= &quot; AND p.post_status = 'publish'&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $op = $previous ? '&lt;' : '&gt;';&nbsp;</div></li><li><div>  $order = $previous ? 'DESC' : 'ASC';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the JOIN clause in the SQL for an adjacent post query.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * The dynamic portion of the hook name, `$adjacent`, refers to the type</span>&nbsp;</div></li><li><div><span class="comment">   * of adjacency, 'next' or 'previous'.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0 Added the `$taxonomy` and `$post` parameters.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $join           The JOIN clause in the SQL.</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool    $in_same_term   Whether post should be in a same taxonomy term.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array   $excluded_terms Array of excluded term IDs.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $taxonomy       Taxonomy. Used to identify the term used when `$in_same_term` is true.</span>&nbsp;</div></li><li><div><span class="comment">   * @param WP_Post $post           WP_Post object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $join = apply_filters( &quot;get_{$adjacent}_post_join&quot;, $join, $in_same_term, $excluded_terms, $taxonomy, $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the WHERE clause in the SQL for an adjacent post query.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * The dynamic portion of the hook name, `$adjacent`, refers to the type</span>&nbsp;</div></li><li><div><span class="comment">   * of adjacency, 'next' or 'previous'.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0 Added the `$taxonomy` and `$post` parameters.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $where          The `WHERE` clause in the SQL.</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool   $in_same_term   Whether post should be in a same taxonomy term.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $excluded_terms Array of excluded term IDs.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $taxonomy       Taxonomy. Used to identify the term used when `$in_same_term` is true.</span>&nbsp;</div></li><li><div><span class="comment">   * @param WP_Post $post           WP_Post object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $where = apply_filters( &quot;get_{$adjacent}_post_where&quot;, $wpdb-&gt;prepare( &quot;WHERE p.post_date $op %s AND p.post_type = %s $where&quot;, $current_post_date, $post-&gt;post_type ), $in_same_term, $excluded_terms, $taxonomy, $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the ORDER BY clause in the SQL for an adjacent post query.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * The dynamic portion of the hook name, `$adjacent`, refers to the type</span>&nbsp;</div></li><li><div><span class="comment">   * of adjacency, 'next' or 'previous'.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0 Added the `$post` parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $order_by The `ORDER BY` clause in the SQL.</span>&nbsp;</div></li><li><div><span class="comment">   * @param WP_Post $post    WP_Post object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $sort = apply_filters( &quot;get_{$adjacent}_post_sort&quot;, &quot;ORDER BY p.post_date $order LIMIT 1&quot;, $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $query = &quot;SELECT p.ID FROM $wpdb-&gt;posts AS p $join $where $sort&quot;;&nbsp;</div></li><li><div>  $query_key = 'adjacent_post_' . md5( $query );&nbsp;</div></li><li><div>  $result = wp_cache_get( $query_key, 'counts' );&nbsp;</div></li><li><div>  if ( false !== $result ) {&nbsp;</div></li><li><div>      if ( $result )&nbsp;</div></li><li><div>          $result = get_post( $result );&nbsp;</div></li><li><div>      return $result;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $result = $wpdb-&gt;get_var( $query );&nbsp;</div></li><li><div>  if ( null === $result )&nbsp;</div></li><li><div>      $result = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  wp_cache_set( $query_key, $result, 'counts' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $result )&nbsp;</div></li><li><div>      $result = get_post( $result );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $result;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the adjacent post relational link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Can either be next or previous post relational link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $title          Optional. Link title format. Default '%title'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $in_same_term   Optional. Whether link should be in a same taxonomy term. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $excluded_terms Optional. Array or comma-separated list of excluded term IDs. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $previous       Optional. Whether to display link to previous or next post. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void The adjacent post relational link URL.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_adjacent_post_rel_link( $title = '%title', $in_same_term = false, $excluded_terms = '', $previous = true, $taxonomy = 'category' ) {&nbsp;</div></li><li><div>  if ( $previous && is_attachment() && $post = get_post() )&nbsp;</div></li><li><div>      $post = get_post( $post-&gt;post_parent );&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      $post = get_adjacent_post( $in_same_term, $excluded_terms, $previous, $taxonomy );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $post ) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $post_title = the_title_attribute( array( 'echo' =&gt; false, 'post' =&gt; $post ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $post_title ) )&nbsp;</div></li><li><div>      $post_title = $previous ? __( 'Previous Post' ) : __( 'Next Post' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $date = mysql2date( get_option( 'date_format' ), $post-&gt;post_date );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $title = str_replace( '%title', $post_title, $title );&nbsp;</div></li><li><div>  $title = str_replace( '%date', $date, $title );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $link = $previous ? &quot;&lt;link rel='prev' title='&quot; : &quot;&lt;link rel='next' title='&quot;;&nbsp;</div></li><li><div>  $link .= esc_attr( $title );&nbsp;</div></li><li><div>  $link .= &quot;' href='&quot; . get_permalink( $post ) . &quot;' /&gt;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $adjacent = $previous ? 'previous' : 'next';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the adjacent post relational link.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * The dynamic portion of the hook name, `$adjacent`, refers to the type</span>&nbsp;</div></li><li><div><span class="comment">   * of adjacency, 'next' or 'previous'.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link The relational link.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( &quot;{$adjacent}_post_rel_link&quot;, $link );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the relational links for the posts adjacent to the current post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $title          Optional. Link title format. Default '%title'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $in_same_term   Optional. Whether link should be in a same taxonomy term. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $excluded_terms Optional. Array or comma-separated list of excluded term IDs. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function adjacent_posts_rel_link( $title = '%title', $in_same_term = false, $excluded_terms = '', $taxonomy = 'category' ) {&nbsp;</div></li><li><div>  echo get_adjacent_post_rel_link( $title, $in_same_term, $excluded_terms, true, $taxonomy );&nbsp;</div></li><li><div>  echo get_adjacent_post_rel_link( $title, $in_same_term, $excluded_terms, false, $taxonomy );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays relational links for the posts adjacent to the current post for single post pages.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This is meant to be attached to actions like 'wp_head'. Do not call this directly in plugins</span>&nbsp;</div></li><li><div><span class="comment"> * or theme templates.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see adjacent_posts_rel_link()</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function adjacent_posts_rel_link_wp_head() {&nbsp;</div></li><li><div>  if ( ! is_single() || is_attachment() ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  adjacent_posts_rel_link();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the relational link for the next post adjacent to the current post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see get_adjacent_post_rel_link()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $title          Optional. Link title format. Default '%title'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $in_same_term   Optional. Whether link should be in a same taxonomy term. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $excluded_terms Optional. Array or comma-separated list of excluded term IDs. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function next_post_rel_link( $title = '%title', $in_same_term = false, $excluded_terms = '', $taxonomy = 'category' ) {&nbsp;</div></li><li><div>  echo get_adjacent_post_rel_link( $title, $in_same_term, $excluded_terms, false, $taxonomy );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the relational link for the previous post adjacent to the current post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see get_adjacent_post_rel_link()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $title          Optional. Link title format. Default '%title'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $in_same_term   Optional. Whether link should be in a same taxonomy term. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $excluded_terms Optional. Array or comma-separated list of excluded term IDs. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function prev_post_rel_link( $title = '%title', $in_same_term = false, $excluded_terms = '', $taxonomy = 'category' ) {&nbsp;</div></li><li><div>  echo get_adjacent_post_rel_link( $title, $in_same_term, $excluded_terms, true, $taxonomy );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the boundary post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Boundary being either the first or last post by publish date within the constraints specified</span>&nbsp;</div></li><li><div><span class="comment"> * by $in_same_term or $excluded_terms.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $in_same_term   Optional. Whether returned post should be in a same taxonomy term.</span>&nbsp;</div></li><li><div><span class="comment"> *                                     Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $excluded_terms Optional. Array or comma-separated list of excluded term IDs.</span>&nbsp;</div></li><li><div><span class="comment"> *                                     Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $start          Optional. Whether to retrieve first or last post. Default true</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> * @return null|array Array containing the boundary post object if successful, null otherwise.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_boundary_post( $in_same_term = false, $excluded_terms = '', $start = true, $taxonomy = 'category' ) {&nbsp;</div></li><li><div>  $post = get_post();&nbsp;</div></li><li><div>  if ( ! $post || ! is_single() || is_attachment() || ! taxonomy_exists( $taxonomy ) )&nbsp;</div></li><li><div>      return null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $query_args = array(&nbsp;</div></li><li><div>      'posts_per_page' =&gt; 1, &nbsp;</div></li><li><div>      'order' =&gt; $start ? 'ASC' : 'DESC', &nbsp;</div></li><li><div>      'update_post_term_cache' =&gt; false, &nbsp;</div></li><li><div>      'update_post_meta_cache' =&gt; false&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $term_array = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! is_array( $excluded_terms ) ) {&nbsp;</div></li><li><div>      if ( ! empty( $excluded_terms ) )&nbsp;</div></li><li><div>          $excluded_terms = explode( ', ', $excluded_terms );&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          $excluded_terms = array();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $in_same_term || ! empty( $excluded_terms ) ) {&nbsp;</div></li><li><div>      if ( $in_same_term )&nbsp;</div></li><li><div>          $term_array = wp_get_object_terms( $post-&gt;ID, $taxonomy, array( 'fields' =&gt; 'ids' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $excluded_terms ) ) {&nbsp;</div></li><li><div>          $excluded_terms = array_map( 'intval', $excluded_terms );&nbsp;</div></li><li><div>          $excluded_terms = array_diff( $excluded_terms, $term_array );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $inverse_terms = array();&nbsp;</div></li><li><div>          foreach ( $excluded_terms as $excluded_term )&nbsp;</div></li><li><div>              $inverse_terms[] = $excluded_term * -1;&nbsp;</div></li><li><div>          $excluded_terms = $inverse_terms;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $query_args[ 'tax_query' ] = array( array(&nbsp;</div></li><li><div>          'taxonomy' =&gt; $taxonomy, &nbsp;</div></li><li><div>          'terms' =&gt; array_merge( $term_array, $excluded_terms )&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return get_posts( $query_args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the previous post link that is adjacent to the current post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $format         Optional. Link anchor format. Default '&laquo; %link'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $link           Optional. Link permalink format. Default '%title%'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $in_same_term   Optional. Whether link should be in a same taxonomy term. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $excluded_terms Optional. Array or comma-separated list of excluded term IDs. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The link URL of the previous post in relation to the current post.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_previous_post_link( $format = '&laquo; %link', $link = '%title', $in_same_term = false, $excluded_terms = '', $taxonomy = 'category' ) {&nbsp;</div></li><li><div>  return get_adjacent_post_link( $format, $link, $in_same_term, $excluded_terms, true, $taxonomy );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the previous post link that is adjacent to the current post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see get_previous_post_link()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $format         Optional. Link anchor format. Default '&laquo; %link'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $link           Optional. Link permalink format. Default '%title'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $in_same_term   Optional. Whether link should be in a same taxonomy term. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $excluded_terms Optional. Array or comma-separated list of excluded term IDs. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function previous_post_link( $format = '&laquo; %link', $link = '%title', $in_same_term = false, $excluded_terms = '', $taxonomy = 'category' ) {&nbsp;</div></li><li><div>  echo get_previous_post_link( $format, $link, $in_same_term, $excluded_terms, $taxonomy );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the next post link that is adjacent to the current post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $format         Optional. Link anchor format. Default '&laquo; %link'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $link           Optional. Link permalink format. Default '%title'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $in_same_term   Optional. Whether link should be in a same taxonomy term. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $excluded_terms Optional. Array or comma-separated list of excluded term IDs. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The link URL of the next post in relation to the current post.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_next_post_link( $format = '%link &raquo;', $link = '%title', $in_same_term = false, $excluded_terms = '', $taxonomy = 'category' ) {&nbsp;</div></li><li><div>  return get_adjacent_post_link( $format, $link, $in_same_term, $excluded_terms, false, $taxonomy );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the next post link that is adjacent to the current post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> * @see get_next_post_link()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $format         Optional. Link anchor format. Default '&laquo; %link'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $link           Optional. Link permalink format. Default '%title'</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $in_same_term   Optional. Whether link should be in a same taxonomy term. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $excluded_terms Optional. Array or comma-separated list of excluded term IDs. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function next_post_link( $format = '%link &raquo;', $link = '%title', $in_same_term = false, $excluded_terms = '', $taxonomy = 'category' ) {&nbsp;</div></li><li><div>   echo get_next_post_link( $format, $link, $in_same_term, $excluded_terms, $taxonomy );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the adjacent post link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Can be either next post link or previous.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $format         Link anchor format.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $link           Link permalink format.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $in_same_term   Optional. Whether link should be in a same taxonomy term. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $excluded_terms Optional. Array or comma-separated list of excluded terms IDs. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $previous       Optional. Whether to display link to previous or next post. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The link URL of the previous or next post in relation to the current post.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_adjacent_post_link( $format, $link, $in_same_term = false, $excluded_terms = '', $previous = true, $taxonomy = 'category' ) {&nbsp;</div></li><li><div>  if ( $previous && is_attachment() )&nbsp;</div></li><li><div>      $post = get_post( get_post()-&gt;post_parent );&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      $post = get_adjacent_post( $in_same_term, $excluded_terms, $previous, $taxonomy );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $post ) {&nbsp;</div></li><li><div>      $output = '';&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $title = $post-&gt;post_title;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $post-&gt;post_title ) )&nbsp;</div></li><li><div>          $title = $previous ? __( 'Previous Post' ) : __( 'Next Post' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** This filter is documented in wp-includes/post-template.php */</span>&nbsp;</div></li><li><div>      $title = apply_filters( 'the_title', $title, $post-&gt;ID );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $date = mysql2date( get_option( 'date_format' ), $post-&gt;post_date );&nbsp;</div></li><li><div>      $rel = $previous ? 'prev' : 'next';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $string = '&lt;a href=&quot;' . get_permalink( $post ) . '&quot; rel=&quot;'.$rel.'&quot;&gt;';&nbsp;</div></li><li><div>      $inlink = str_replace( '%title', $title, $link );&nbsp;</div></li><li><div>      $inlink = str_replace( '%date', $date, $inlink );&nbsp;</div></li><li><div>      $inlink = $string . $inlink . '&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $output = str_replace( '%link', $inlink, $format );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $adjacent = $previous ? 'previous' : 'next';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the adjacent post link.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * The dynamic portion of the hook name, `$adjacent`, refers to the type</span>&nbsp;</div></li><li><div><span class="comment">   * of adjacency, 'next' or 'previous'.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.6.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.2.0 Added the `$adjacent` parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $output   The adjacent post link.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $format   Link anchor format.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $link     Link permalink format.</span>&nbsp;</div></li><li><div><span class="comment">   * @param WP_Post $post     The adjacent post.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $adjacent Whether the post is previous or next.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( &quot;{$adjacent}_post_link&quot;, $output, $format, $link, $post, $adjacent );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the adjacent post link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Can be either next post link or previous.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $format         Link anchor format.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $link           Link permalink format.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $in_same_term   Optional. Whether link should be in a same taxonomy term. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $excluded_terms Optional. Array or comma-separated list of excluded category IDs. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $previous       Optional. Whether to display link to previous or next post. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function adjacent_post_link( $format, $link, $in_same_term = false, $excluded_terms = '', $previous = true, $taxonomy = 'category' ) {&nbsp;</div></li><li><div>  echo get_adjacent_post_link( $format, $link, $in_same_term, $excluded_terms, $previous, $taxonomy );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the link for a page number.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int  $pagenum Optional. Page ID. Default 1.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $escape  Optional. Whether to escape the URL for display, with esc_url(). Defaults to true.</span>&nbsp;</div></li><li><div><span class="comment"> *                         Otherwise, prepares the URL with esc_url_raw().</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The link URL for the given page number.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_pagenum_link($pagenum = 1, $escape = true ) {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $pagenum = (int) $pagenum;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $request = remove_query_arg( 'paged' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $home_root = parse_url(home_url());&nbsp;</div></li><li><div>  $home_root = ( isset($home_root['path']) ) ? $home_root['path'] : '';&nbsp;</div></li><li><div>  $home_root = preg_quote( $home_root, '|' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $request = preg_replace('|^'. $home_root . '|i', '', $request);&nbsp;</div></li><li><div>  $request = preg_replace('|^/+|', '', $request);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !$wp_rewrite-&gt;using_permalinks() || is_admin() ) {&nbsp;</div></li><li><div>      $base = trailingslashit( get_bloginfo( 'url' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $pagenum &gt; 1 ) {&nbsp;</div></li><li><div>          $result = add_query_arg( 'paged', $pagenum, $base . $request );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $result = $base . $request;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $qs_regex = '|\?.*?$|';&nbsp;</div></li><li><div>      preg_match( $qs_regex, $request, $qs_match );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !empty( $qs_match[0] ) ) {&nbsp;</div></li><li><div>          $query_string = $qs_match[0];&nbsp;</div></li><li><div>          $request = preg_replace( $qs_regex, '', $request );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $query_string = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $request = preg_replace( &quot;|$wp_rewrite-&gt;pagination_base/\d+/?$|&quot;, '', $request);&nbsp;</div></li><li><div>      $request = preg_replace( '|^' . preg_quote( $wp_rewrite-&gt;index, '|' ) . '|i', '', $request);&nbsp;</div></li><li><div>      $request = ltrim($request, '/');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $base = trailingslashit( get_bloginfo( 'url' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $wp_rewrite-&gt;using_index_permalinks() && ( $pagenum &gt; 1 || '' != $request ) )&nbsp;</div></li><li><div>          $base .= $wp_rewrite-&gt;index . '/';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $pagenum &gt; 1 ) {&nbsp;</div></li><li><div>          $request = ( ( !empty( $request ) ) ? trailingslashit( $request ) : $request ) . user_trailingslashit( $wp_rewrite-&gt;pagination_base . &quot;/&quot; . $pagenum, 'paged' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $result = $base . $request . $query_string;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the page number link for the current request.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $result The page number link.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $result = apply_filters( 'get_pagenum_link', $result );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $escape )&nbsp;</div></li><li><div>      return esc_url( $result );&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      return esc_url_raw( $result );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the next posts page link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Backported from 2.1.3 to 2.0.10.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.10</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global int $paged</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $max_page Optional. Max pages. Default 0.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void The link URL for next posts page.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_next_posts_page_link($max_page = 0) {&nbsp;</div></li><li><div>  global $paged;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !is_single() ) {&nbsp;</div></li><li><div>      if ( !$paged )&nbsp;</div></li><li><div>          $paged = 1;&nbsp;</div></li><li><div>      $nextpage = intval($paged) + 1;&nbsp;</div></li><li><div>      if ( !$max_page || $max_page &gt;= $nextpage )&nbsp;</div></li><li><div>          return get_pagenum_link($nextpage);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays or retrieves the next posts page link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 0.71</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int   $max_page Optional. Max pages. Default 0.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool  $echo     Optional. Whether to echo the link. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void The link URL for next posts page if `$echo = false`.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function next_posts( $max_page = 0, $echo = true ) {&nbsp;</div></li><li><div>  $output = esc_url( get_next_posts_page_link( $max_page ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $echo )&nbsp;</div></li><li><div>      echo $output;&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      return $output;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the next posts page link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global int      $paged</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Query $wp_query</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $label    Content for link text.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $max_page Optional. Max pages. Default 0.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void HTML-formatted next posts page link.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_next_posts_link( $label = null, $max_page = 0 ) {&nbsp;</div></li><li><div>  global $paged, $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !$max_page )&nbsp;</div></li><li><div>      $max_page = $wp_query-&gt;max_num_pages;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !$paged )&nbsp;</div></li><li><div>      $paged = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $nextpage = intval($paged) + 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( null === $label )&nbsp;</div></li><li><div>      $label = __( 'Next Page &raquo;' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !is_single() && ( $nextpage &lt;= $max_page ) ) {&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the anchor tag attributes for the next posts page link.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $attributes Attributes for the anchor tag.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $attr = apply_filters( 'next_posts_link_attributes', '' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return '&lt;a href=&quot;' . next_posts( $max_page, false ) . &quot;\&quot; $attr&gt;&quot; . preg_replace('/&([^#])(?![a-z]{1, 8};)/i', '&#038;$1', $label) . '&lt;/a&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the next posts page link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 0.71</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $label    Content for link text.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $max_page Optional. Max pages. Default 0.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function next_posts_link( $label = null, $max_page = 0 ) {&nbsp;</div></li><li><div>  echo get_next_posts_link( $label, $max_page );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the previous posts page link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Will only return string, if not on a single page or post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Backported to 2.0.10 from 2.1.3.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.10</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global int $paged</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void The link for the previous posts page.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_previous_posts_page_link() {&nbsp;</div></li><li><div>  global $paged;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !is_single() ) {&nbsp;</div></li><li><div>      $nextpage = intval($paged) - 1;&nbsp;</div></li><li><div>      if ( $nextpage &lt; 1 )&nbsp;</div></li><li><div>          $nextpage = 1;&nbsp;</div></li><li><div>      return get_pagenum_link($nextpage);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays or retrieves the previous posts page link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 0.71</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $echo Optional. Whether to echo the link. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void The previous posts page link if `$echo = false`.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function previous_posts( $echo = true ) {&nbsp;</div></li><li><div>  $output = esc_url( get_previous_posts_page_link() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $echo )&nbsp;</div></li><li><div>      echo $output;&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      return $output;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the previous posts page link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global int $paged</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $label Optional. Previous page link text.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void HTML-formatted previous page link.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_previous_posts_link( $label = null ) {&nbsp;</div></li><li><div>  global $paged;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( null === $label )&nbsp;</div></li><li><div>      $label = __( '&laquo; Previous Page' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !is_single() && $paged &gt; 1 ) {&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the anchor tag attributes for the previous posts page link.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $attributes Attributes for the anchor tag.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $attr = apply_filters( 'previous_posts_link_attributes', '' );&nbsp;</div></li><li><div>      return '&lt;a href=&quot;' . previous_posts( false ) . &quot;\&quot; $attr&gt;&quot;. preg_replace( '/&([^#])(?![a-z]{1, 8};)/i', '&#038;$1', $label ) .'&lt;/a&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the previous posts page link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 0.71</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $label Optional. Previous page link text.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function previous_posts_link( $label = null ) {&nbsp;</div></li><li><div>  echo get_previous_posts_link( $label );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the post pages link navigation for previous and next pages.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Query $wp_query</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string|array $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     Optional. Arguments to build the post pages link navigation.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $sep      Separator character. Default '&#8212;'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $prelabel Link text to display for the previous page link.</span>&nbsp;</div></li><li><div><span class="comment"> *                            Default '&laquo; Previous Page'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $nxtlabel Link text to display for the next page link.</span>&nbsp;</div></li><li><div><span class="comment"> *                            Default 'Next Page &raquo;'.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The posts link navigation.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_posts_nav_link( $args = array() ) {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $return = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !is_singular() ) {&nbsp;</div></li><li><div>      $defaults = array(&nbsp;</div></li><li><div>          'sep' =&gt; ' &#8212; ', &nbsp;</div></li><li><div>          'prelabel' =&gt; __('&laquo; Previous Page'), &nbsp;</div></li><li><div>          'nxtlabel' =&gt; __('Next Page &raquo;'), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      $args = wp_parse_args( $args, $defaults );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $max_num_pages = $wp_query-&gt;max_num_pages;&nbsp;</div></li><li><div>      $paged = get_query_var('paged');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">//only have sep if there's both prev and next results</span>&nbsp;</div></li><li><div>      if ($paged &lt; 2 || $paged &gt;= $max_num_pages) {&nbsp;</div></li><li><div>          $args['sep'] = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $max_num_pages &gt; 1 ) {&nbsp;</div></li><li><div>          $return = get_previous_posts_link($args['prelabel']);&nbsp;</div></li><li><div>          $return .= preg_replace('/&([^#])(?![a-z]{1, 8};)/i', '&#038;$1', $args['sep']);&nbsp;</div></li><li><div>          $return .= get_next_posts_link($args['nxtlabel']);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return $return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the post pages link navigation for previous and next pages.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 0.71</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $sep      Optional. Separator for posts navigation links. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $prelabel Optional. Label for previous pages. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $nxtlabel Optional Label for next pages. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function posts_nav_link( $sep = '', $prelabel = '', $nxtlabel = '' ) {&nbsp;</div></li><li><div>  $args = array_filter( compact('sep', 'prelabel', 'nxtlabel') );&nbsp;</div></li><li><div>  echo get_posts_nav_link($args);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the navigation to next/previous post, when applicable.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0 Introduced the `in_same_term`, `excluded_terms`, and `taxonomy` arguments.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     Optional. Default post navigation arguments. Default empty array.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string       $prev_text          Anchor text to display in the previous post link. Default '%title'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string       $next_text          Anchor text to display in the next post link. Default '%title'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type bool         $in_same_term       Whether link should be in a same taxonomy term. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type array|string $excluded_terms     Array or comma-separated list of excluded term IDs. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string       $taxonomy           Taxonomy, if `$in_same_term` is true. Default 'category'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string       $screen_reader_text Screen reader text for nav element. Default 'Post navigation'.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Markup for post links.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_the_post_navigation( $args = array() ) {&nbsp;</div></li><li><div>  $args = wp_parse_args( $args, array(&nbsp;</div></li><li><div>      'prev_text' =&gt; '%title', &nbsp;</div></li><li><div>      'next_text' =&gt; '%title', &nbsp;</div></li><li><div>      'in_same_term' =&gt; false, &nbsp;</div></li><li><div>      'excluded_terms' =&gt; '', &nbsp;</div></li><li><div>      'taxonomy' =&gt; 'category', &nbsp;</div></li><li><div>      'screen_reader_text' =&gt; __( 'Post navigation' ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $navigation = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $previous = get_previous_post_link(&nbsp;</div></li><li><div>      '&lt;div class=&quot;nav-previous&quot;&gt;%link&lt;/div&gt;', &nbsp;</div></li><li><div>      $args['prev_text'], &nbsp;</div></li><li><div>      $args['in_same_term'], &nbsp;</div></li><li><div>      $args['excluded_terms'], &nbsp;</div></li><li><div>      $args['taxonomy']&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $next = get_next_post_link(&nbsp;</div></li><li><div>      '&lt;div class=&quot;nav-next&quot;&gt;%link&lt;/div&gt;', &nbsp;</div></li><li><div>      $args['next_text'], &nbsp;</div></li><li><div>      $args['in_same_term'], &nbsp;</div></li><li><div>      $args['excluded_terms'], &nbsp;</div></li><li><div>      $args['taxonomy']&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Only add markup if there's somewhere to navigate to.</span>&nbsp;</div></li><li><div>  if ( $previous || $next ) {&nbsp;</div></li><li><div>      $navigation = _navigation_markup( $previous . $next, 'post-navigation', $args['screen_reader_text'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $navigation;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the navigation to next/previous post, when applicable.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Optional. See get_the_post_navigation() for available arguments.</span>&nbsp;</div></li><li><div><span class="comment"> *                    Default empty array.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function the_post_navigation( $args = array() ) {&nbsp;</div></li><li><div>  echo get_the_post_navigation( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Returns the navigation to next/previous set of posts, when applicable.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Query $wp_query WordPress Query object.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     Optional. Default posts navigation arguments. Default empty array.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $prev_text          Anchor text to display in the previous posts link.</span>&nbsp;</div></li><li><div><span class="comment"> *                                      Default 'Older posts'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $next_text          Anchor text to display in the next posts link.</span>&nbsp;</div></li><li><div><span class="comment"> *                                      Default 'Newer posts'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $screen_reader_text Screen reader text for nav element.</span>&nbsp;</div></li><li><div><span class="comment"> *                                      Default 'Posts navigation'.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Markup for posts links.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_the_posts_navigation( $args = array() ) {&nbsp;</div></li><li><div>  $navigation = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Don't print empty markup if there's only one page.</span></span>&nbsp;</div></li><li><div>  if ( $GLOBALS['wp_query']-&gt;max_num_pages &gt; 1 ) {&nbsp;</div></li><li><div>      $args = wp_parse_args( $args, array(&nbsp;</div></li><li><div>          'prev_text' =&gt; __( 'Older posts' ), &nbsp;</div></li><li><div>          'next_text' =&gt; __( 'Newer posts' ), &nbsp;</div></li><li><div>          'screen_reader_text' =&gt; __( 'Posts navigation' ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $next_link = get_previous_posts_link( $args['next_text'] );&nbsp;</div></li><li><div>      $prev_link = get_next_posts_link( $args['prev_text'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $prev_link ) {&nbsp;</div></li><li><div>          $navigation .= '&lt;div class=&quot;nav-previous&quot;&gt;' . $prev_link . '&lt;/div&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $next_link ) {&nbsp;</div></li><li><div>          $navigation .= '&lt;div class=&quot;nav-next&quot;&gt;' . $next_link . '&lt;/div&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $navigation = _navigation_markup( $navigation, 'posts-navigation', $args['screen_reader_text'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $navigation;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the navigation to next/previous set of posts, when applicable.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Optional. See get_the_posts_navigation() for available arguments.</span>&nbsp;</div></li><li><div><span class="comment"> *                    Default empty array.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function the_posts_navigation( $args = array() ) {&nbsp;</div></li><li><div>  echo get_the_posts_navigation( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves a paginated navigation to next/previous set of posts, when applicable.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     Optional. Default pagination arguments, see paginate_links().</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $screen_reader_text Screen reader text for navigation element.</span>&nbsp;</div></li><li><div><span class="comment"> *                                      Default 'Posts navigation'.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Markup for pagination links.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_the_posts_pagination( $args = array() ) {&nbsp;</div></li><li><div>  $navigation = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Don't print empty markup if there's only one page.</span></span>&nbsp;</div></li><li><div>  if ( $GLOBALS['wp_query']-&gt;max_num_pages &gt; 1 ) {&nbsp;</div></li><li><div>      $args = wp_parse_args( $args, array(&nbsp;</div></li><li><div>          'mid_size' =&gt; 1, &nbsp;</div></li><li><div>          'prev_text' =&gt; _x( 'Previous', 'previous set of posts' ), &nbsp;</div></li><li><div>          'next_text' =&gt; _x( 'Next', 'next set of posts' ), &nbsp;</div></li><li><div>          'screen_reader_text' =&gt; __( 'Posts navigation' ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Make sure we get a string back. Plain is the next best thing.</span>&nbsp;</div></li><li><div>      if ( isset( $args['type'] ) && 'array' == $args['type'] ) {&nbsp;</div></li><li><div>          $args['type'] = 'plain';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set up paginated links.</span>&nbsp;</div></li><li><div>      $links = paginate_links( $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $links ) {&nbsp;</div></li><li><div>          $navigation = _navigation_markup( $links, 'pagination', $args['screen_reader_text'] );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $navigation;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays a paginated navigation to next/previous set of posts, when applicable.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Optional. See get_the_posts_pagination() for available arguments.</span>&nbsp;</div></li><li><div><span class="comment"> *                    Default empty array.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function the_posts_pagination( $args = array() ) {&nbsp;</div></li><li><div>  echo get_the_posts_pagination( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Wraps passed links in navigational markup.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $links              Navigational links.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $class              Optional. Custom class for nav element. Default: 'posts-navigation'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $screen_reader_text Optional. Screen reader text for nav element. Default: 'Posts navigation'.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Navigation template tag.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _navigation_markup( $links, $class = 'posts-navigation', $screen_reader_text = '' ) {&nbsp;</div></li><li><div>  if ( empty( $screen_reader_text ) ) {&nbsp;</div></li><li><div>      $screen_reader_text = __( 'Posts navigation' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $template = '&nbsp;</div></li><li><div>  &lt;nav class=&quot;navigation %1$s&quot; role=&quot;navigation&quot;&gt;&nbsp;</div></li><li><div>      &lt;h2 class=&quot;screen-reader-text&quot;&gt;%2$s&lt;/h2&gt;&nbsp;</div></li><li><div>      &lt;div class=&quot;nav-links&quot;&gt;%3$s&lt;/div&gt;&nbsp;</div></li><li><div>  &lt;/nav&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the navigation markup template.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Note: The filtered template HTML must contain specifiers for the navigation</span>&nbsp;</div></li><li><div><span class="comment">   * class (%1$s), the screen-reader-text value (%2$s), and placement of the</span>&nbsp;</div></li><li><div><span class="comment">   * navigation links (%3$s):</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   *     &lt;nav class=&quot;navigation %1$s&quot; role=&quot;navigation&quot;&gt;</span>&nbsp;</div></li><li><div><span class="comment">   *         &lt;h2 class=&quot;screen-reader-text&quot;&gt;%2$s&lt;/h2&gt;</span>&nbsp;</div></li><li><div><span class="comment">   *         &lt;div class=&quot;nav-links&quot;&gt;%3$s&lt;/div&gt;</span>&nbsp;</div></li><li><div><span class="comment">   *     &lt;/nav&gt;</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $template The default template.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $class    The class passed by the calling function.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Navigation template.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $template = apply_filters( 'navigation_markup_template', $template, $class );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return sprintf( $template, sanitize_html_class( $class ), esc_html( $screen_reader_text ), $links );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the comments page number link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $pagenum  Optional. Page number. Default 1.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $max_page Optional. The maximum number of comment pages. Default 0.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The comments page number link URL.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_comments_pagenum_link( $pagenum = 1, $max_page = 0 ) {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $pagenum = (int) $pagenum;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $result = get_permalink();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'newest' == get_option('default_comments_page') ) {&nbsp;</div></li><li><div>      if ( $pagenum != $max_page ) {&nbsp;</div></li><li><div>          if ( $wp_rewrite-&gt;using_permalinks() )&nbsp;</div></li><li><div>              $result = user_trailingslashit( trailingslashit($result) . $wp_rewrite-&gt;comments_pagination_base . '-' . $pagenum, 'commentpaged');&nbsp;</div></li><li><div>          else&nbsp;</div></li><li><div>              $result = add_query_arg( 'cpage', $pagenum, $result );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } elseif ( $pagenum &gt; 1 ) {&nbsp;</div></li><li><div>      if ( $wp_rewrite-&gt;using_permalinks() )&nbsp;</div></li><li><div>          $result = user_trailingslashit( trailingslashit($result) . $wp_rewrite-&gt;comments_pagination_base . '-' . $pagenum, 'commentpaged');&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          $result = add_query_arg( 'cpage', $pagenum, $result );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $result .= '#comments';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the comments page number link for the current request.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $result The comments page number link.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'get_comments_pagenum_link', $result );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the link to the next comments page.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.1</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Query $wp_query</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $label    Optional. Label for link text. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $max_page Optional. Max page. Default 0.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void HTML-formatted link for the next page of comments.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_next_comments_link( $label = '', $max_page = 0 ) {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! is_singular() )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $page = get_query_var('cpage');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $page ) {&nbsp;</div></li><li><div>      $page = 1;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $nextpage = intval($page) + 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($max_page) )&nbsp;</div></li><li><div>      $max_page = $wp_query-&gt;max_num_comment_pages;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($max_page) )&nbsp;</div></li><li><div>      $max_page = get_comment_pages_count();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $nextpage &gt; $max_page )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($label) )&nbsp;</div></li><li><div>      $label = __('Newer Comments &raquo;');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the anchor tag attributes for the next comments page link.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $attributes Attributes for the anchor tag.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return '&lt;a href=&quot;' . esc_url( get_comments_pagenum_link( $nextpage, $max_page ) ) . '&quot; ' . apply_filters( 'next_comments_link_attributes', '' ) . '&gt;'. preg_replace('/&([^#])(?![a-z]{1, 8};)/i', '&#038;$1', $label) .'&lt;/a&gt;';&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the link to the next comments page.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $label    Optional. Label for link text. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $max_page Optional. Max page. Default 0.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function next_comments_link( $label = '', $max_page = 0 ) {&nbsp;</div></li><li><div>  echo get_next_comments_link( $label, $max_page );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the link to the previous comments page.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.1</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $label Optional. Label for comments link text. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void HTML-formatted link for the previous page of comments.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_previous_comments_link( $label = '' ) {&nbsp;</div></li><li><div>  if ( ! is_singular() )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $page = get_query_var('cpage');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( intval($page) &lt;= 1 )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $prevpage = intval($page) - 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($label) )&nbsp;</div></li><li><div>      $label = __('&laquo; Older Comments');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the anchor tag attributes for the previous comments page link.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $attributes Attributes for the anchor tag.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return '&lt;a href=&quot;' . esc_url( get_comments_pagenum_link( $prevpage ) ) . '&quot; ' . apply_filters( 'previous_comments_link_attributes', '' ) . '&gt;' . preg_replace('/&([^#])(?![a-z]{1, 8};)/i', '&#038;$1', $label) .'&lt;/a&gt;';&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the link to the previous comments page.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $label Optional. Label for comments link text. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function previous_comments_link( $label = '' ) {&nbsp;</div></li><li><div>  echo get_previous_comments_link( $label );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays or retrieves pagination links for the comments on the current post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see paginate_links()</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Rewrite $wp_rewrite</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string|array $args Optional args. See paginate_links(). Default empty array.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void Markup for pagination links.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function paginate_comments_links( $args = array() ) {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! is_singular() )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $page = get_query_var('cpage');&nbsp;</div></li><li><div>  if ( !$page )&nbsp;</div></li><li><div>      $page = 1;&nbsp;</div></li><li><div>  $max_page = get_comment_pages_count();&nbsp;</div></li><li><div>  $defaults = array(&nbsp;</div></li><li><div>      'base' =&gt; add_query_arg( 'cpage', '%#%' ), &nbsp;</div></li><li><div>      'format' =&gt; '', &nbsp;</div></li><li><div>      'total' =&gt; $max_page, &nbsp;</div></li><li><div>      'current' =&gt; $page, &nbsp;</div></li><li><div>      'echo' =&gt; true, &nbsp;</div></li><li><div>      'add_fragment' =&gt; '#comments'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  if ( $wp_rewrite-&gt;using_permalinks() )&nbsp;</div></li><li><div>      $defaults['base'] = user_trailingslashit(trailingslashit(get_permalink()) . $wp_rewrite-&gt;comments_pagination_base . '-%#%', 'commentpaged');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $args = wp_parse_args( $args, $defaults );&nbsp;</div></li><li><div>  $page_links = paginate_links( $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $args['echo'] )&nbsp;</div></li><li><div>      echo $page_links;&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      return $page_links;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves navigation to next/previous set of comments, when applicable.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     Optional. Default comments navigation arguments.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $prev_text          Anchor text to display in the previous comments link.</span>&nbsp;</div></li><li><div><span class="comment"> *                                      Default 'Older comments'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $next_text          Anchor text to display in the next comments link.</span>&nbsp;</div></li><li><div><span class="comment"> *                                      Default 'Newer comments'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $screen_reader_text Screen reader text for nav element. Default 'Comments navigation'.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Markup for comments links.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_the_comments_navigation( $args = array() ) {&nbsp;</div></li><li><div>  $navigation = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Are there comments to navigate through?</span>&nbsp;</div></li><li><div>  if ( get_comment_pages_count() &gt; 1 ) {&nbsp;</div></li><li><div>      $args = wp_parse_args( $args, array(&nbsp;</div></li><li><div>          'prev_text' =&gt; __( 'Older comments' ), &nbsp;</div></li><li><div>          'next_text' =&gt; __( 'Newer comments' ), &nbsp;</div></li><li><div>          'screen_reader_text' =&gt; __( 'Comments navigation' ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $prev_link = get_previous_comments_link( $args['prev_text'] );&nbsp;</div></li><li><div>      $next_link = get_next_comments_link( $args['next_text'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $prev_link ) {&nbsp;</div></li><li><div>          $navigation .= '&lt;div class=&quot;nav-previous&quot;&gt;' . $prev_link . '&lt;/div&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $next_link ) {&nbsp;</div></li><li><div>          $navigation .= '&lt;div class=&quot;nav-next&quot;&gt;' . $next_link . '&lt;/div&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $navigation = _navigation_markup( $navigation, 'comment-navigation', $args['screen_reader_text'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $navigation;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays navigation to next/previous set of comments, when applicable.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args See get_the_comments_navigation() for available arguments. Default empty array.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function the_comments_navigation( $args = array() ) {&nbsp;</div></li><li><div>  echo get_the_comments_navigation( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves a paginated navigation to next/previous set of comments, when applicable.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see paginate_comments_links()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     Optional. Default pagination arguments.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $screen_reader_text Screen reader text for nav element. Default 'Comments navigation'.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Markup for pagination links.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_the_comments_pagination( $args = array() ) {&nbsp;</div></li><li><div>  $navigation = '';&nbsp;</div></li><li><div>  $args = wp_parse_args( $args, array(&nbsp;</div></li><li><div>      'screen_reader_text' =&gt; __( 'Comments navigation' ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>  $args['echo'] = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Make sure we get plain links, so we get a string we can work with.</span>&nbsp;</div></li><li><div>  $args['type'] = 'plain';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $links = paginate_comments_links( $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $links ) {&nbsp;</div></li><li><div>      $navigation = _navigation_markup( $links, 'comments-pagination', $args['screen_reader_text'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $navigation;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays a paginated navigation to next/previous set of comments, when applicable.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args See get_the_comments_pagination() for available arguments. Default empty array.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function the_comments_pagination( $args = array() ) {&nbsp;</div></li><li><div>  echo get_the_comments_pagination( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the Press This bookmarklet link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.6.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global bool          $is_IE      Whether the browser matches an Internet Explorer user agent.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_shortcut_link() {&nbsp;</div></li><li><div>  global $is_IE;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  include_once( ABSPATH . 'wp-admin/includes/class-wp-press-this.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $link = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $is_IE ) {&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Return the old/shorter bookmarklet code for MSIE 8 and lower, </span>&nbsp;</div></li><li><div><span class="comment">       * since they only support a max length of ~2000 characters for</span>&nbsp;</div></li><li><div><span class="comment">       * bookmark[let] URLs, which is way to small for our smarter one.</span>&nbsp;</div></li><li><div><span class="comment">       * Do update the version number so users do not get the &quot;upgrade your</span>&nbsp;</div></li><li><div><span class="comment">       * bookmarklet&quot; notice when using PT in those browsers.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $ua = $_SERVER['HTTP_USER_AGENT'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $ua ) && preg_match( '/\bMSIE (\d)/', $ua, $matches ) && (int) $matches[1] &lt;= 8 ) {&nbsp;</div></li><li><div>          $url = wp_json_encode( admin_url( 'press-this.php' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $link = 'javascript:var d=document, w=window, e=w.getSelection, k=d.getSelection, x=d.selection, ' .&nbsp;</div></li><li><div>              's=(e?e():(k)?k():(x?x.createRange().text:0)), f=' . $url . ', l=d.location, e=encodeURIComponent, ' .&nbsp;</div></li><li><div>              'u=f+&quot;?u=&quot;+e(l.href)+&quot;&t=&quot;+e(d.title)+&quot;&s=&quot;+e(s)+&quot;&v=' . WP_Press_This::VERSION . '&quot;;' .&nbsp;</div></li><li><div>              'a=function() {if(!w.open(u, &quot;t&quot;, &quot;toolbar=0, resizable=1, scrollbars=1, status=1, width=600, height=700&quot;))l.href=u;};' .&nbsp;</div></li><li><div>              'if(/Firefox/.test(navigator.userAgent))setTimeout(a, 0);else a();void(0)';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $link ) ) {&nbsp;</div></li><li><div>      $src = @file_get_contents( ABSPATH . 'wp-admin/js/bookmarklet.min.js' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $src ) {&nbsp;</div></li><li><div>          $url = wp_json_encode( admin_url( 'press-this.php' ) . '?v=' . WP_Press_This::VERSION );&nbsp;</div></li><li><div>          $link = 'javascript:' . str_replace( 'window.pt_url', $url, $src );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $link = str_replace( array( &quot;\r&quot;, &quot;\n&quot;, &quot;\t&quot; ), '', $link );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the Press This bookmarklet link.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.6.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $link The Press This bookmarklet link.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'shortcut_link', $link );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL for the current site where the front end is accessible.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Returns the 'home' option with the appropriate protocol. The protocol will be 'https'</span>&nbsp;</div></li><li><div><span class="comment"> * if is_ssl() evaluates to true; otherwise, it will be the same as the 'home' option.</span>&nbsp;</div></li><li><div><span class="comment"> * If `$scheme` is 'http' or 'https', is_ssl() is overridden.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param  string      $path   Optional. Path relative to the home URL. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param  string|null $scheme Optional. Scheme to give the home URL context. Accepts</span>&nbsp;</div></li><li><div><span class="comment"> *                             'http', 'https', 'relative', 'rest', or null. Default null.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Home URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function home_url( $path = '', $scheme = null ) {&nbsp;</div></li><li><div>  return get_home_url( null, $path, $scheme );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL for a given site where the front end is accessible.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Returns the 'home' option with the appropriate protocol. The protocol will be 'https'</span>&nbsp;</div></li><li><div><span class="comment"> * if is_ssl() evaluates to true; otherwise, it will be the same as the 'home' option.</span>&nbsp;</div></li><li><div><span class="comment"> * If `$scheme` is 'http' or 'https', is_ssl() is overridden.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global string $pagenow</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param  int         $blog_id Optional. Site ID. Default null (current site).</span>&nbsp;</div></li><li><div><span class="comment"> * @param  string      $path    Optional. Path relative to the home URL. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param  string|null $scheme  Optional. Scheme to give the home URL context. Accepts</span>&nbsp;</div></li><li><div><span class="comment"> *                              'http', 'https', 'relative', 'rest', or null. Default null.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Home URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_home_url( $blog_id = null, $path = '', $scheme = null ) {&nbsp;</div></li><li><div>  global $pagenow;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $orig_scheme = $scheme;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $blog_id ) || !is_multisite() ) {&nbsp;</div></li><li><div>      $url = get_option( 'home' );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      switch_to_blog( $blog_id );&nbsp;</div></li><li><div>      $url = get_option( 'home' );&nbsp;</div></li><li><div>      restore_current_blog();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! in_array( $scheme, array( 'http', 'https', 'relative' ) ) ) {&nbsp;</div></li><li><div>      if ( is_ssl() && ! is_admin() && 'wp-login.php' !== $pagenow )&nbsp;</div></li><li><div>          $scheme = 'https';&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          $scheme = parse_url( $url, PHP_URL_SCHEME );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $url = set_url_scheme( $url, $scheme );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $path && is_string( $path ) )&nbsp;</div></li><li><div>      $url .= '/' . ltrim( $path, '/' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the home URL.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string      $url         The complete home URL including scheme and path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string      $path        Path relative to the home URL. Blank string if no path is specified.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string|null $orig_scheme Scheme to give the home URL context. Accepts 'http', 'https', </span>&nbsp;</div></li><li><div><span class="comment">   *                                 'relative', 'rest', or null.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int|null    $blog_id     Site ID, or null for the current site.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'home_url', $url, $path, $orig_scheme, $blog_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL for the current site where WordPress application files</span>&nbsp;</div></li><li><div><span class="comment"> * (e.g. wp-blog-header.php or the wp-admin/ folder) are accessible.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Returns the 'site_url' option with the appropriate protocol, 'https' if</span>&nbsp;</div></li><li><div><span class="comment"> * is_ssl() and 'http' otherwise. If $scheme is 'http' or 'https', is_ssl() is</span>&nbsp;</div></li><li><div><span class="comment"> * overridden.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $path   Optional. Path relative to the site URL. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $scheme Optional. Scheme to give the site URL context. See set_url_scheme().</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Site URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function site_url( $path = '', $scheme = null ) {&nbsp;</div></li><li><div>  return get_site_url( null, $path, $scheme );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL for a given site where WordPress application files</span>&nbsp;</div></li><li><div><span class="comment"> * (e.g. wp-blog-header.php or the wp-admin/ folder) are accessible.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Returns the 'site_url' option with the appropriate protocol, 'https' if</span>&nbsp;</div></li><li><div><span class="comment"> * is_ssl() and 'http' otherwise. If `$scheme` is 'http' or 'https', </span>&nbsp;</div></li><li><div><span class="comment"> * `is_ssl()` is overridden.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $blog_id Optional. Site ID. Default null (current site).</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $path    Optional. Path relative to the site URL. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $scheme  Optional. Scheme to give the site URL context. Accepts</span>&nbsp;</div></li><li><div><span class="comment"> *                        'http', 'https', 'login', 'login_post', 'admin', or</span>&nbsp;</div></li><li><div><span class="comment"> *                        'relative'. Default null.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Site URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_site_url( $blog_id = null, $path = '', $scheme = null ) {&nbsp;</div></li><li><div>  if ( empty( $blog_id ) || !is_multisite() ) {&nbsp;</div></li><li><div>      $url = get_option( 'siteurl' );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      switch_to_blog( $blog_id );&nbsp;</div></li><li><div>      $url = get_option( 'siteurl' );&nbsp;</div></li><li><div>      restore_current_blog();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $url = set_url_scheme( $url, $scheme );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $path && is_string( $path ) )&nbsp;</div></li><li><div>      $url .= '/' . ltrim( $path, '/' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the site URL.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string      $url     The complete site URL including scheme and path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string      $path    Path relative to the site URL. Blank string if no path is specified.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string|null $scheme  Scheme to give the site URL context. Accepts 'http', 'https', 'login', </span>&nbsp;</div></li><li><div><span class="comment">   *                             'login_post', 'admin', 'relative' or null.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int|null    $blog_id Site ID, or null for the current site.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'site_url', $url, $path, $scheme, $blog_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL to the admin area for the current site.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.6.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $path   Optional path relative to the admin URL.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $scheme The scheme to use. Default is 'admin', which obeys force_ssl_admin() and is_ssl().</span>&nbsp;</div></li><li><div><span class="comment"> *                       'http' or 'https' can be passed to force those schemes.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Admin URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function admin_url( $path = '', $scheme = 'admin' ) {&nbsp;</div></li><li><div>  return get_admin_url( null, $path, $scheme );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL to the admin area for a given site.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $blog_id Optional. Site ID. Default null (current site).</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $path    Optional. Path relative to the admin URL. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $scheme  Optional. The scheme to use. Accepts 'http' or 'https', </span>&nbsp;</div></li><li><div><span class="comment"> *                        to force those schemes. Default 'admin', which obeys</span>&nbsp;</div></li><li><div><span class="comment"> *                        force_ssl_admin() and is_ssl().</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Admin URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_admin_url( $blog_id = null, $path = '', $scheme = 'admin' ) {&nbsp;</div></li><li><div>  $url = get_site_url($blog_id, 'wp-admin/', $scheme);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $path && is_string( $path ) )&nbsp;</div></li><li><div>      $url .= ltrim( $path, '/' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the admin area URL.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string   $url     The complete admin area URL including scheme and path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string   $path    Path relative to the admin area URL. Blank string if no path is specified.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int|null $blog_id Site ID, or null for the current site.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'admin_url', $url, $path, $blog_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL to the includes directory.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.6.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $path   Optional. Path relative to the includes URL. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $scheme Optional. Scheme to give the includes URL context. Accepts</span>&nbsp;</div></li><li><div><span class="comment"> *                       'http', 'https', or 'relative'. Default null.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Includes URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function includes_url( $path = '', $scheme = null ) {&nbsp;</div></li><li><div>  $url = site_url( '/' . WPINC . '/', $scheme );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $path && is_string( $path ) )&nbsp;</div></li><li><div>      $url .= ltrim($path, '/');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the URL to the includes directory.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url  The complete URL to the includes directory including scheme and path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $path Path relative to the URL to the wp-includes directory. Blank string</span>&nbsp;</div></li><li><div><span class="comment">   *                     if no path is specified.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'includes_url', $url, $path );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL to the content directory.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.6.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $path Optional. Path relative to the content URL. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Content URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function content_url( $path = '' ) {&nbsp;</div></li><li><div>  $url = set_url_scheme( WP_CONTENT_URL );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $path && is_string( $path ) )&nbsp;</div></li><li><div>      $url .= '/' . ltrim($path, '/');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the URL to the content directory.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url  The complete URL to the content directory including scheme and path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $path Path relative to the URL to the content directory. Blank string</span>&nbsp;</div></li><li><div><span class="comment">   *                     if no path is specified.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'content_url', $url, $path);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves a URL within the plugins or mu-plugins directory.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Defaults to the plugins directory URL if no arguments are supplied.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.6.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param  string $path   Optional. Extra path appended to the end of the URL, including</span>&nbsp;</div></li><li><div><span class="comment"> *                        the relative directory if $plugin is supplied. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param  string $plugin Optional. A full path to a file inside a plugin or mu-plugin.</span>&nbsp;</div></li><li><div><span class="comment"> *                        The URL will be relative to its directory. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> *                        Typically this is done by passing `__FILE__` as the argument.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Plugins URL link with optional paths appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function plugins_url( $path = '', $plugin = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $path = wp_normalize_path( $path );&nbsp;</div></li><li><div>  $plugin = wp_normalize_path( $plugin );&nbsp;</div></li><li><div>  $mu_plugin_dir = wp_normalize_path( WPMU_PLUGIN_DIR );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !empty($plugin) && 0 === strpos($plugin, $mu_plugin_dir) )&nbsp;</div></li><li><div>      $url = WPMU_PLUGIN_URL;&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      $url = WP_PLUGIN_URL;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $url = set_url_scheme( $url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !empty($plugin) && is_string($plugin) ) {&nbsp;</div></li><li><div>      $folder = dirname(plugin_basename($plugin));&nbsp;</div></li><li><div>      if ( '.' != $folder )&nbsp;</div></li><li><div>          $url .= '/' . ltrim($folder, '/');&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $path && is_string( $path ) )&nbsp;</div></li><li><div>      $url .= '/' . ltrim($path, '/');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the URL to the plugins directory.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url    The complete URL to the plugins directory including scheme and path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $path   Path relative to the URL to the plugins directory. Blank string</span>&nbsp;</div></li><li><div><span class="comment">   *                       if no path is specified.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $plugin The plugin file path to be relative to. Blank string if no plugin</span>&nbsp;</div></li><li><div><span class="comment">   *                       is specified.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'plugins_url', $url, $path, $plugin );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the site URL for the current network.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Returns the site URL with the appropriate protocol, 'https' if</span>&nbsp;</div></li><li><div><span class="comment"> * is_ssl() and 'http' otherwise. If $scheme is 'http' or 'https', is_ssl() is</span>&nbsp;</div></li><li><div><span class="comment"> * overridden.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see set_url_scheme()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $path   Optional. Path relative to the site URL. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $scheme Optional. Scheme to give the site URL context. Accepts</span>&nbsp;</div></li><li><div><span class="comment"> *                       'http', 'https', or 'relative'. Default null.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Site URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function network_site_url( $path = '', $scheme = null ) {&nbsp;</div></li><li><div>  if ( ! is_multisite() )&nbsp;</div></li><li><div>      return site_url($path, $scheme);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $current_network = get_network();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'relative' == $scheme )&nbsp;</div></li><li><div>      $url = $current_network-&gt;path;&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      $url = set_url_scheme( 'http:<span class="comment"><span class="comment">//' . $current_network-&gt;domain . $current_network-&gt;path, $scheme );</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $path && is_string( $path ) )&nbsp;</div></li><li><div>      $url .= ltrim( $path, '/' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the network site URL.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string      $url    The complete network site URL including scheme and path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string      $path   Path relative to the network site URL. Blank string if</span>&nbsp;</div></li><li><div><span class="comment">   *                            no path is specified.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string|null $scheme Scheme to give the URL context. Accepts 'http', 'https', </span>&nbsp;</div></li><li><div><span class="comment">   *                            'relative' or null.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'network_site_url', $url, $path, $scheme );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the home URL for the current network.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Returns the home URL with the appropriate protocol, 'https' is_ssl()</span>&nbsp;</div></li><li><div><span class="comment"> * and 'http' otherwise. If `$scheme` is 'http' or 'https', `is_ssl()` is</span>&nbsp;</div></li><li><div><span class="comment"> * overridden.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param  string $path   Optional. Path relative to the home URL. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param  string $scheme Optional. Scheme to give the home URL context. Accepts</span>&nbsp;</div></li><li><div><span class="comment"> *                        'http', 'https', or 'relative'. Default null.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Home URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function network_home_url( $path = '', $scheme = null ) {&nbsp;</div></li><li><div>  if ( ! is_multisite() )&nbsp;</div></li><li><div>      return home_url($path, $scheme);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $current_network = get_network();&nbsp;</div></li><li><div>  $orig_scheme = $scheme;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! in_array( $scheme, array( 'http', 'https', 'relative' ) ) )&nbsp;</div></li><li><div>      $scheme = is_ssl() && ! is_admin() ? 'https' : 'http';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'relative' == $scheme )&nbsp;</div></li><li><div>      $url = $current_network-&gt;path;&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      $url = set_url_scheme( 'http:<span class="comment"><span class="comment">//' . $current_network-&gt;domain . $current_network-&gt;path, $scheme );</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $path && is_string( $path ) )&nbsp;</div></li><li><div>      $url .= ltrim( $path, '/' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the network home URL.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string      $url         The complete network home URL including scheme and path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string      $path        Path relative to the network home URL. Blank string</span>&nbsp;</div></li><li><div><span class="comment">   *                                 if no path is specified.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string|null $orig_scheme Scheme to give the URL context. Accepts 'http', 'https', </span>&nbsp;</div></li><li><div><span class="comment">   *                                 'relative' or null.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'network_home_url', $url, $path, $orig_scheme);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL to the admin area for the network.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $path   Optional path relative to the admin URL. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $scheme Optional. The scheme to use. Default is 'admin', which obeys force_ssl_admin()</span>&nbsp;</div></li><li><div><span class="comment"> *                       and is_ssl(). 'http' or 'https' can be passed to force those schemes.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Admin URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function network_admin_url( $path = '', $scheme = 'admin' ) {&nbsp;</div></li><li><div>  if ( ! is_multisite() )&nbsp;</div></li><li><div>      return admin_url( $path, $scheme );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $url = network_site_url('wp-admin/network/', $scheme);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $path && is_string( $path ) )&nbsp;</div></li><li><div>      $url .= ltrim($path, '/');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the network admin URL.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url  The complete network admin URL including scheme and path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $path Path relative to the network admin URL. Blank string if</span>&nbsp;</div></li><li><div><span class="comment">   *                     no path is specified.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'network_admin_url', $url, $path );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL to the admin area for the current user.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $path   Optional. Path relative to the admin URL. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $scheme Optional. The scheme to use. Default is 'admin', which obeys force_ssl_admin()</span>&nbsp;</div></li><li><div><span class="comment"> *                       and is_ssl(). 'http' or 'https' can be passed to force those schemes.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Admin URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function user_admin_url( $path = '', $scheme = 'admin' ) {&nbsp;</div></li><li><div>  $url = network_site_url('wp-admin/user/', $scheme);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $path && is_string( $path ) )&nbsp;</div></li><li><div>      $url .= ltrim($path, '/');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the user admin URL for the current user.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url  The complete URL including scheme and path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $path Path relative to the URL. Blank string if</span>&nbsp;</div></li><li><div><span class="comment">   *                     no path is specified.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'user_admin_url', $url, $path );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL to the admin area for either the current site or the network depending on context.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $path   Optional. Path relative to the admin URL. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $scheme Optional. The scheme to use. Default is 'admin', which obeys force_ssl_admin()</span>&nbsp;</div></li><li><div><span class="comment"> *                       and is_ssl(). 'http' or 'https' can be passed to force those schemes.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Admin URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function self_admin_url( $path = '', $scheme = 'admin' ) {&nbsp;</div></li><li><div>  if ( is_network_admin() )&nbsp;</div></li><li><div>      return network_admin_url($path, $scheme);&nbsp;</div></li><li><div>  elseif ( is_user_admin() )&nbsp;</div></li><li><div>      return user_admin_url($path, $scheme);&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      return admin_url($path, $scheme);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Sets the scheme for a URL.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.4.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0 The 'rest' scheme was added.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string      $url    Absolute URL that includes a scheme</span>&nbsp;</div></li><li><div><span class="comment"> * @param string|null $scheme Optional. Scheme to give $url. Currently 'http', 'https', 'login', </span>&nbsp;</div></li><li><div><span class="comment"> *                            'login_post', 'admin', 'relative', 'rest', 'rpc', or null. Default null.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string $url URL with chosen scheme.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function set_url_scheme( $url, $scheme = null ) {&nbsp;</div></li><li><div>  $orig_scheme = $scheme;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $scheme ) {&nbsp;</div></li><li><div>      $scheme = is_ssl() ? 'https' : 'http';&nbsp;</div></li><li><div>  } elseif ( $scheme === 'admin' || $scheme === 'login' || $scheme === 'login_post' || $scheme === 'rpc' ) {&nbsp;</div></li><li><div>      $scheme = is_ssl() || force_ssl_admin() ? 'https' : 'http';&nbsp;</div></li><li><div>  } elseif ( $scheme !== 'http' && $scheme !== 'https' && $scheme !== 'relative' ) {&nbsp;</div></li><li><div>      $scheme = is_ssl() ? 'https' : 'http';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $url = trim( $url );&nbsp;</div></li><li><div>  if ( substr( $url, 0, 2 ) === '<span class="comment">//' )</span>&nbsp;</div></li><li><div>      $url = 'http:' . $url;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'relative' == $scheme ) {&nbsp;</div></li><li><div>      $url = ltrim( preg_replace( '#^\w+:<span class="comment">//[^/]*#', '', $url ) );</span>&nbsp;</div></li><li><div>      if ( $url !== '' && $url[0] === '/' )&nbsp;</div></li><li><div>          $url = '/' . ltrim($url , &quot;/ \t\n\r\0\x0B&quot; );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $url = preg_replace( '#^\w+:<span class="comment">//#', $scheme . '://', $url );</span>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the resulting URL after setting the scheme.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string      $url         The complete URL including scheme and path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string      $scheme      Scheme applied to the URL. One of 'http', 'https', or 'relative'.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string|null $orig_scheme Scheme requested for the URL. One of 'http', 'https', 'login', </span>&nbsp;</div></li><li><div><span class="comment">   *                                 'login_post', 'admin', 'relative', 'rest', 'rpc', or null.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'set_url_scheme', $url, $scheme, $orig_scheme );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL to the user's dashboard.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * If a user does not belong to any site, the global user dashboard is used. If the user</span>&nbsp;</div></li><li><div><span class="comment"> * belongs to the current site, the dashboard for the current site is returned. If the user</span>&nbsp;</div></li><li><div><span class="comment"> * cannot edit the current site, the dashboard to the user's primary site is returned.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $user_id Optional. User ID. Defaults to current user.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $path    Optional path relative to the dashboard. Use only paths known to</span>&nbsp;</div></li><li><div><span class="comment"> *                        both site and user admins. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $scheme  The scheme to use. Default is 'admin', which obeys force_ssl_admin()</span>&nbsp;</div></li><li><div><span class="comment"> *                        and is_ssl(). 'http' or 'https' can be passed to force those schemes.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Dashboard URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_dashboard_url( $user_id = 0, $path = '', $scheme = 'admin' ) {&nbsp;</div></li><li><div>  $user_id = $user_id ? (int) $user_id : get_current_user_id();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $blogs = get_blogs_of_user( $user_id );&nbsp;</div></li><li><div>  if ( ! is_super_admin() && empty($blogs) ) {&nbsp;</div></li><li><div>      $url = user_admin_url( $path, $scheme );&nbsp;</div></li><li><div>  } elseif ( ! is_multisite() ) {&nbsp;</div></li><li><div>      $url = admin_url( $path, $scheme );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $current_blog = get_current_blog_id();&nbsp;</div></li><li><div>      if ( $current_blog  && ( is_super_admin( $user_id ) || in_array( $current_blog, array_keys( $blogs ) ) ) ) {&nbsp;</div></li><li><div>          $url = admin_url( $path, $scheme );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $active = get_active_blog_for_user( $user_id );&nbsp;</div></li><li><div>          if ( $active )&nbsp;</div></li><li><div>              $url = get_admin_url( $active-&gt;blog_id, $path, $scheme );&nbsp;</div></li><li><div>          else&nbsp;</div></li><li><div>              $url = user_admin_url( $path, $scheme );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the dashboard URL for a user.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url     The complete URL including scheme and path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $user_id The user ID.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $path    Path relative to the URL. Blank string if no path is specified.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $scheme  Scheme to give the URL context. Accepts 'http', 'https', 'login', </span>&nbsp;</div></li><li><div><span class="comment">   *                        'login_post', 'admin', 'relative' or null.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'user_dashboard_url', $url, $user_id, $path, $scheme);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL to the user's profile editor.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $user_id Optional. User ID. Defaults to current user.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $scheme  Optional. The scheme to use. Default is 'admin', which obeys force_ssl_admin()</span>&nbsp;</div></li><li><div><span class="comment"> *                        and is_ssl(). 'http' or 'https' can be passed to force those schemes.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Dashboard URL link with optional path appended.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_edit_profile_url( $user_id = 0, $scheme = 'admin' ) {&nbsp;</div></li><li><div>  $user_id = $user_id ? (int) $user_id : get_current_user_id();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_user_admin() )&nbsp;</div></li><li><div>      $url = user_admin_url( 'profile.php', $scheme );&nbsp;</div></li><li><div>  elseif ( is_network_admin() )&nbsp;</div></li><li><div>      $url = network_admin_url( 'profile.php', $scheme );&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      $url = get_dashboard_url( $user_id, 'profile.php', $scheme );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the URL for a user's profile editor.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url     The complete URL including scheme and path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $user_id The user ID.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $scheme  Scheme to give the URL context. Accepts 'http', 'https', 'login', </span>&nbsp;</div></li><li><div><span class="comment">   *                        'login_post', 'admin', 'relative' or null.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'edit_profile_url', $url, $user_id, $scheme);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Returns the canonical URL for a post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * When the post is the same as the current requested page the function will handle the</span>&nbsp;</div></li><li><div><span class="comment"> * pagination arguments too.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.6.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|WP_Post $post Optional. Post ID or object. Default is global `$post`.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|false The canonical URL, or false if the post does not exist or has not</span>&nbsp;</div></li><li><div><span class="comment"> *                      been published yet.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_get_canonical_url( $post = null ) {&nbsp;</div></li><li><div>  $post = get_post( $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $post ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'publish' !== $post-&gt;post_status ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $canonical_url = get_permalink( $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// If a canonical is being generated for the current page, make sure it has pagination if needed.</span>&nbsp;</div></li><li><div>  if ( $post-&gt;ID === get_queried_object_id() ) {&nbsp;</div></li><li><div>      $page = get_query_var( 'page', 0 );&nbsp;</div></li><li><div>      if ( $page &gt;= 2 ) {&nbsp;</div></li><li><div>          if ( '' == get_option( 'permalink_structure' ) ) {&nbsp;</div></li><li><div>              $canonical_url = add_query_arg( 'page', $page, $canonical_url );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $canonical_url = trailingslashit( $canonical_url ) . user_trailingslashit( $page, 'single_paged' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $cpage = get_query_var( 'cpage', 0 );&nbsp;</div></li><li><div>      if ( $cpage ) {&nbsp;</div></li><li><div>          $canonical_url = get_comments_pagenum_link( $cpage );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the canonical URL for a post.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.6.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $string The post's canonical URL.</span>&nbsp;</div></li><li><div><span class="comment">   * @param WP_Post $post   Post object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'get_canonical_url', $canonical_url, $post );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Outputs rel=canonical for singular queries.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.6.0 Adjusted to use wp_get_canonical_url().</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function rel_canonical() {&nbsp;</div></li><li><div>  if ( ! is_singular() ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $id = get_queried_object_id();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 0 === $id ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $url = wp_get_canonical_url( $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $url ) ) {&nbsp;</div></li><li><div>      echo '&lt;link rel=&quot;canonical&quot; href=&quot;' . esc_url( $url ) . '&quot; /&gt;' . &quot;\n&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Returns a shortlink for a post, page, attachment, or site.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function exists to provide a shortlink tag that all themes and plugins can target.</span>&nbsp;</div></li><li><div><span class="comment"> * A plugin must hook in to provide the actual shortlinks. Default shortlink support is</span>&nbsp;</div></li><li><div><span class="comment"> * limited to providing ?p= style links for posts. Plugins can short-circuit this function</span>&nbsp;</div></li><li><div><span class="comment"> * via the {@see 'pre_get_shortlink'} filter or filter the output via the {@see 'get_shortlink'}</span>&nbsp;</div></li><li><div><span class="comment"> * filter.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $id          Optional. A post or site id. Default is 0, which means the current post or site.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $context     Optional. Whether the id is a 'site' id, 'post' id, or 'media' id. If 'post', </span>&nbsp;</div></li><li><div><span class="comment"> *                            the post_type of the post is consulted. If 'query', the current query is consulted</span>&nbsp;</div></li><li><div><span class="comment"> *                            to determine the id and context. Default 'post'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool   $allow_slugs Optional. Whether to allow post slugs in the shortlink. It is up to the plugin how</span>&nbsp;</div></li><li><div><span class="comment"> *                            and whether to honor this. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string A shortlink or an empty string if no shortlink exists for the requested resource or if shortlinks</span>&nbsp;</div></li><li><div><span class="comment"> *                are not enabled.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_get_shortlink( $id = 0, $context = 'post', $allow_slugs = true ) {&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether to preempt generating a shortlink for the given post.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Passing a truthy value to the filter will effectively short-circuit the</span>&nbsp;</div></li><li><div><span class="comment">   * shortlink-generation process, returning that value instead.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool|string $return      Short-circuit return value. Either false or a URL string.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int         $id          Post ID, or 0 for the current post.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string      $context     The context for the link. One of 'post' or 'query', </span>&nbsp;</div></li><li><div><span class="comment">   * @param bool        $allow_slugs Whether to allow post slugs in the shortlink.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $shortlink = apply_filters( 'pre_get_shortlink', false, $id, $context, $allow_slugs );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( false !== $shortlink ) {&nbsp;</div></li><li><div>      return $shortlink;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $post_id = 0;&nbsp;</div></li><li><div>  if ( 'query' == $context && is_singular() ) {&nbsp;</div></li><li><div>      $post_id = get_queried_object_id();&nbsp;</div></li><li><div>      $post = get_post( $post_id );&nbsp;</div></li><li><div>  } elseif ( 'post' == $context ) {&nbsp;</div></li><li><div>      $post = get_post( $id );&nbsp;</div></li><li><div>      if ( ! empty( $post-&gt;ID ) )&nbsp;</div></li><li><div>          $post_id = $post-&gt;ID;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $shortlink = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Return p= link for all public post types.</span>&nbsp;</div></li><li><div>  if ( ! empty( $post_id ) ) {&nbsp;</div></li><li><div>      $post_type = get_post_type_object( $post-&gt;post_type );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 'page' === $post-&gt;post_type && $post-&gt;ID == get_option( 'page_on_front' ) && 'page' == get_option( 'show_on_front' ) ) {&nbsp;</div></li><li><div>          $shortlink = home_url( '/' );&nbsp;</div></li><li><div>      } elseif ( $post_type-&gt;public ) {&nbsp;</div></li><li><div>          $shortlink = home_url( '?p=' . $post_id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the shortlink for a post.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $shortlink   Shortlink URL.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $id          Post ID, or 0 for the current post.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $context     The context for the link. One of 'post' or 'query', </span>&nbsp;</div></li><li><div><span class="comment">   * @param bool   $allow_slugs Whether to allow post slugs in the shortlink. Not used by default.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'get_shortlink', $shortlink, $id, $context, $allow_slugs );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Injects rel=shortlink into the head if a shortlink is defined for the current page.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Attached to the {@see 'wp_head'} action.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_shortlink_wp_head() {&nbsp;</div></li><li><div>  $shortlink = wp_get_shortlink( 0, 'query' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $shortlink ) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo &quot;&lt;link rel='shortlink' href='&quot; . esc_url( $shortlink ) . &quot;' /&gt;\n&quot;;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Sends a Link: rel=shortlink header if a shortlink is defined for the current page.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Attached to the {@see 'wp'} action.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_shortlink_header() {&nbsp;</div></li><li><div>  if ( headers_sent() )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $shortlink = wp_get_shortlink(0, 'query');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($shortlink) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  header('Link: &lt;' . $shortlink . '&gt;; rel=shortlink', false);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the shortlink for a post.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Must be called from inside &quot;The Loop&quot;</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Call like the_shortlink( __( 'Shortlinkage FTW' ) )</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $text   Optional The link text or HTML to be displayed. Defaults to 'This is the short link.'</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $title  Optional The tooltip for the link. Must be sanitized. Defaults to the sanitized post title.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $before Optional HTML to display before the link. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $after  Optional HTML to display after the link. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function the_shortlink( $text = '', $title = '', $before = '', $after = '' ) {&nbsp;</div></li><li><div>  $post = get_post();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $text ) )&nbsp;</div></li><li><div>      $text = __('This is the short link.');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $title ) )&nbsp;</div></li><li><div>      $title = the_title_attribute( array( 'echo' =&gt; false ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $shortlink = wp_get_shortlink( $post-&gt;ID );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !empty( $shortlink ) ) {&nbsp;</div></li><li><div>      $link = '&lt;a rel=&quot;shortlink&quot; href=&quot;' . esc_url( $shortlink ) . '&quot; title=&quot;' . $title . '&quot;&gt;' . $text . '&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the short link anchor tag for a post.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $link      Shortlink anchor tag.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $shortlink Shortlink URL.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $text      Shortlink's text.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $title     Shortlink's title attribute.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $link = apply_filters( 'the_shortlink', $link, $shortlink, $text, $title );&nbsp;</div></li><li><div>      echo $before, $link, $after;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the avatar URL.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $id_or_email The Gravatar to retrieve a URL for. Accepts a user_id, gravatar md5 hash, </span>&nbsp;</div></li><li><div><span class="comment"> *                           user email, WP_User object, WP_Post object, or WP_Comment object.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     Optional. Arguments to return instead of the default arguments.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int    $size           Height and width of the avatar in pixels. Default 96.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $default        URL for the default image or a default type. Accepts '404' (return</span>&nbsp;</div></li><li><div><span class="comment"> *                                  a 404 instead of a default image), 'retro' (8bit), 'monsterid' (monster), </span>&nbsp;</div></li><li><div><span class="comment"> *                                  'wavatar' (cartoon face), 'indenticon' (the &quot;quilt&quot;), 'mystery', 'mm', </span>&nbsp;</div></li><li><div><span class="comment"> *                                  or 'mysteryman' (The Oyster Man), 'blank' (transparent GIF), or</span>&nbsp;</div></li><li><div><span class="comment"> *                                  'gravatar_default' (the Gravatar logo). Default is the value of the</span>&nbsp;</div></li><li><div><span class="comment"> *                                  'avatar_default' option, with a fallback of 'mystery'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type bool   $force_default  Whether to always show the default image, never the Gravatar. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $rating         What rating to display avatars up to. Accepts 'G', 'PG', 'R', 'X', and are</span>&nbsp;</div></li><li><div><span class="comment"> *                                  judged in that order. Default is the value of the 'avatar_rating' option.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $scheme         URL scheme to use. See set_url_scheme() for accepted values.</span>&nbsp;</div></li><li><div><span class="comment"> *                                  Default null.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type array  $processed_args When the function returns, the value will be the processed/sanitized $args</span>&nbsp;</div></li><li><div><span class="comment"> *                                  plus a &quot;found_avatar&quot; guess. Pass as a reference. Default null.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> * @return false|string The URL of the avatar we found, or false if we couldn't find an avatar.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_avatar_url( $id_or_email, $args = null ) {&nbsp;</div></li><li><div>  $args = get_avatar_data( $id_or_email, $args );&nbsp;</div></li><li><div>  return $args['url'];&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves default data about the avatar.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $id_or_email The Gravatar to retrieve. Accepts a user_id, gravatar md5 hash, </span>&nbsp;</div></li><li><div><span class="comment"> *                            user email, WP_User object, WP_Post object, or WP_Comment object.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     Optional. Arguments to return instead of the default arguments.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int    $size           Height and width of the avatar image file in pixels. Default 96.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int    $height         Display height of the avatar in pixels. Defaults to $size.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int    $width          Display width of the avatar in pixels. Defaults to $size.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $default        URL for the default image or a default type. Accepts '404' (return</span>&nbsp;</div></li><li><div><span class="comment"> *                                  a 404 instead of a default image), 'retro' (8bit), 'monsterid' (monster), </span>&nbsp;</div></li><li><div><span class="comment"> *                                  'wavatar' (cartoon face), 'indenticon' (the &quot;quilt&quot;), 'mystery', 'mm', </span>&nbsp;</div></li><li><div><span class="comment"> *                                  or 'mysteryman' (The Oyster Man), 'blank' (transparent GIF), or</span>&nbsp;</div></li><li><div><span class="comment"> *                                  'gravatar_default' (the Gravatar logo). Default is the value of the</span>&nbsp;</div></li><li><div><span class="comment"> *                                  'avatar_default' option, with a fallback of 'mystery'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type bool   $force_default  Whether to always show the default image, never the Gravatar. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $rating         What rating to display avatars up to. Accepts 'G', 'PG', 'R', 'X', and are</span>&nbsp;</div></li><li><div><span class="comment"> *                                  judged in that order. Default is the value of the 'avatar_rating' option.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $scheme         URL scheme to use. See set_url_scheme() for accepted values.</span>&nbsp;</div></li><li><div><span class="comment"> *                                  Default null.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type array  $processed_args When the function returns, the value will be the processed/sanitized $args</span>&nbsp;</div></li><li><div><span class="comment"> *                                  plus a &quot;found_avatar&quot; guess. Pass as a reference. Default null.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $extra_attr     HTML attributes to insert in the IMG element. Is not sanitized. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> * @return array $processed_args {</span>&nbsp;</div></li><li><div><span class="comment"> *     Along with the arguments passed in `$args`, this will contain a couple of extra arguments.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type bool   $found_avatar True if we were able to find an avatar for this user, </span>&nbsp;</div></li><li><div><span class="comment"> *                                false or not set if we couldn't.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $url          The URL of the avatar we found.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_avatar_data( $id_or_email, $args = null ) {&nbsp;</div></li><li><div>  $args = wp_parse_args( $args, array(&nbsp;</div></li><li><div>      'size' =&gt; 96, &nbsp;</div></li><li><div>      'height' =&gt; null, &nbsp;</div></li><li><div>      'width' =&gt; null, &nbsp;</div></li><li><div>      'default' =&gt; get_option( 'avatar_default', 'mystery' ), &nbsp;</div></li><li><div>      'force_default' =&gt; false, &nbsp;</div></li><li><div>      'rating' =&gt; get_option( 'avatar_rating' ), &nbsp;</div></li><li><div>      'scheme' =&gt; null, &nbsp;</div></li><li><div>      'processed_args' =&gt; null, <span class="comment">// if used, should be a reference</span>&nbsp;</div></li><li><div>      'extra_attr' =&gt; '', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_numeric( $args['size'] ) ) {&nbsp;</div></li><li><div>      $args['size'] = absint( $args['size'] );&nbsp;</div></li><li><div>      if ( ! $args['size'] ) {&nbsp;</div></li><li><div>          $args['size'] = 96;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $args['size'] = 96;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_numeric( $args['height'] ) ) {&nbsp;</div></li><li><div>      $args['height'] = absint( $args['height'] );&nbsp;</div></li><li><div>      if ( ! $args['height'] ) {&nbsp;</div></li><li><div>          $args['height'] = $args['size'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $args['height'] = $args['size'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_numeric( $args['width'] ) ) {&nbsp;</div></li><li><div>      $args['width'] = absint( $args['width'] );&nbsp;</div></li><li><div>      if ( ! $args['width'] ) {&nbsp;</div></li><li><div>          $args['width'] = $args['size'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $args['width'] = $args['size'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $args['default'] ) ) {&nbsp;</div></li><li><div>      $args['default'] = get_option( 'avatar_default', 'mystery' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  switch ( $args['default'] ) {&nbsp;</div></li><li><div>      case 'mm' :&nbsp;</div></li><li><div>      case 'mystery' :&nbsp;</div></li><li><div>      case 'mysteryman' :&nbsp;</div></li><li><div>          $args['default'] = 'mm';&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      case 'gravatar_default' :&nbsp;</div></li><li><div>          $args['default'] = false;&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $args['force_default'] = (bool) $args['force_default'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $args['rating'] = strtolower( $args['rating'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $args['found_avatar'] = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether to retrieve the avatar URL early.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Passing a non-null value in the 'url' member of the return array will</span>&nbsp;</div></li><li><div><span class="comment">   * effectively short circuit get_avatar_data(), passing the value through</span>&nbsp;</div></li><li><div><span class="comment">   * the {@see 'get_avatar_data'} filter and returning early.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.2.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $args        Arguments passed to get_avatar_data(), after processing.</span>&nbsp;</div></li><li><div><span class="comment">   * @param mixed  $id_or_email The Gravatar to retrieve. Accepts a user_id, gravatar md5 hash, </span>&nbsp;</div></li><li><div><span class="comment">   *                            user email, WP_User object, WP_Post object, or WP_Comment object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $args = apply_filters( 'pre_get_avatar_data', $args, $id_or_email );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $args['url'] ) && ! is_null( $args['url'] ) ) {&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment">/** This filter is documented in wp-includes/link-template.php */</span></span></span></span>&nbsp;</div></li><li><div>      return apply_filters( 'get_avatar_data', $args, $id_or_email );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $email_hash = '';&nbsp;</div></li><li><div>  $user = $email = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_object( $id_or_email ) && isset( $id_or_email-&gt;comment_ID ) ) {&nbsp;</div></li><li><div>      $id_or_email = get_comment( $id_or_email );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Process the user identifier.</span>&nbsp;</div></li><li><div>  if ( is_numeric( $id_or_email ) ) {&nbsp;</div></li><li><div>      $user = get_user_by( 'id', absint( $id_or_email ) );&nbsp;</div></li><li><div>  } elseif ( is_string( $id_or_email ) ) {&nbsp;</div></li><li><div>      if ( strpos( $id_or_email, '@md5.gravatar.com' ) ) {&nbsp;</div></li><li><div>          <span class="comment">// md5 hash</span>&nbsp;</div></li><li><div>          list( $email_hash ) = explode( '@', $id_or_email );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          <span class="comment">// email address</span>&nbsp;</div></li><li><div>          $email = $id_or_email;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } elseif ( $id_or_email instanceof WP_User ) {&nbsp;</div></li><li><div>      <span class="comment">// User Object</span>&nbsp;</div></li><li><div>      $user = $id_or_email;&nbsp;</div></li><li><div>  } elseif ( $id_or_email instanceof WP_Post ) {&nbsp;</div></li><li><div>      <span class="comment">// Post Object</span>&nbsp;</div></li><li><div>      $user = get_user_by( 'id', (int) $id_or_email-&gt;post_author );&nbsp;</div></li><li><div>  } elseif ( $id_or_email instanceof WP_Comment ) {&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the list of allowed comment types for retrieving avatars.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $types An array of content types. Default only contains 'comment'.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $allowed_comment_types = apply_filters( 'get_avatar_comment_types', array( 'comment' ) );&nbsp;</div></li><li><div>      if ( ! empty( $id_or_email-&gt;comment_type ) && ! in_array( $id_or_email-&gt;comment_type, (array) $allowed_comment_types ) ) {&nbsp;</div></li><li><div>          $args['url'] = false;&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment"><span class="comment">/** This filter is documented in wp-includes/link-template.php */</span></span></span></span>&nbsp;</div></li><li><div>          return apply_filters( 'get_avatar_data', $args, $id_or_email );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $id_or_email-&gt;user_id ) ) {&nbsp;</div></li><li><div>          $user = get_user_by( 'id', (int) $id_or_email-&gt;user_id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if ( ( ! $user || is_wp_error( $user ) ) && ! empty( $id_or_email-&gt;comment_author_email ) ) {&nbsp;</div></li><li><div>          $email = $id_or_email-&gt;comment_author_email;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $email_hash ) {&nbsp;</div></li><li><div>      if ( $user ) {&nbsp;</div></li><li><div>          $email = $user-&gt;user_email;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $email ) {&nbsp;</div></li><li><div>          $email_hash = md5( strtolower( trim( $email ) ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $email_hash ) {&nbsp;</div></li><li><div>      $args['found_avatar'] = true;&nbsp;</div></li><li><div>      $gravatar_server = hexdec( $email_hash[0] ) % 3;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $gravatar_server = rand( 0, 2 );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $url_args = array(&nbsp;</div></li><li><div>      's' =&gt; $args['size'], &nbsp;</div></li><li><div>      'd' =&gt; $args['default'], &nbsp;</div></li><li><div>      'f' =&gt; $args['force_default'] ? 'y' : false, &nbsp;</div></li><li><div>      'r' =&gt; $args['rating'], &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_ssl() ) {&nbsp;</div></li><li><div>      $url = 'https:<span class="comment">//secure.gravatar.com/avatar/' . $email_hash;</span>&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $url = sprintf( 'http:<span class="comment">//%d.gravatar.com/avatar/%s', $gravatar_server, $email_hash );</span>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $url = add_query_arg(&nbsp;</div></li><li><div>      rawurlencode_deep( array_filter( $url_args ) ), &nbsp;</div></li><li><div>      set_url_scheme( $url, $args['scheme'] )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the avatar URL.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.2.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url         The URL of the avatar.</span>&nbsp;</div></li><li><div><span class="comment">   * @param mixed  $id_or_email The Gravatar to retrieve. Accepts a user_id, gravatar md5 hash, </span>&nbsp;</div></li><li><div><span class="comment">   *                            user email, WP_User object, WP_Post object, or WP_Comment object.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $args        Arguments passed to get_avatar_data(), after processing.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $args['url'] = apply_filters( 'get_avatar_url', $url, $id_or_email, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the avatar data.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.2.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $args        Arguments passed to get_avatar_data(), after processing.</span>&nbsp;</div></li><li><div><span class="comment">   * @param mixed  $id_or_email The Gravatar to retrieve. Accepts a user_id, gravatar md5 hash, </span>&nbsp;</div></li><li><div><span class="comment">   *                            user email, WP_User object, WP_Post object, or WP_Comment object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'get_avatar_data', $args, $id_or_email );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL of a file in the theme.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Searches in the stylesheet directory before the template directory so themes</span>&nbsp;</div></li><li><div><span class="comment"> * which inherit from a parent theme can just override one file.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $file Optional. File to search for in the stylesheet directory.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The URL of the file.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_theme_file_uri( $file = '' ) {&nbsp;</div></li><li><div>  $file = ltrim( $file, '/' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $file ) ) {&nbsp;</div></li><li><div>      $url = get_stylesheet_directory_uri();&nbsp;</div></li><li><div>  } elseif ( file_exists( get_stylesheet_directory() . '/' . $file ) ) {&nbsp;</div></li><li><div>      $url = get_stylesheet_directory_uri() . '/' . $file;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $url = get_template_directory_uri() . '/' . $file;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the URL to a file in the theme.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url  The file URL.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $file The requested file to search for.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'theme_file_uri', $url, $file );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the URL of a file in the parent theme.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $file Optional. File to return the URL for in the template directory.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The URL of the file.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_parent_theme_file_uri( $file = '' ) {&nbsp;</div></li><li><div>  $file = ltrim( $file, '/' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $file ) ) {&nbsp;</div></li><li><div>      $url = get_template_directory_uri();&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $url = get_template_directory_uri() . '/' . $file;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the URL to a file in the parent theme.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $url  The file URL.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $file The requested file to search for.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'parent_theme_file_uri', $url, $file );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the path of a file in the theme.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Searches in the stylesheet directory before the template directory so themes</span>&nbsp;</div></li><li><div><span class="comment"> * which inherit from a parent theme can just override one file.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $file Optional. File to search for in the stylesheet directory.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The path of the file.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_theme_file_path( $file = '' ) {&nbsp;</div></li><li><div>  $file = ltrim( $file, '/' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $file ) ) {&nbsp;</div></li><li><div>      $path = get_stylesheet_directory();&nbsp;</div></li><li><div>  } elseif ( file_exists( get_stylesheet_directory() . '/' . $file ) ) {&nbsp;</div></li><li><div>      $path = get_stylesheet_directory() . '/' . $file;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $path = get_template_directory() . '/' . $file;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the path to a file in the theme.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $path The file path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $file The requested file to search for.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'theme_file_path', $path, $file );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the path of a file in the parent theme.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $file Optional. File to return the path for in the template directory.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The path of the file.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_parent_theme_file_path( $file = '' ) {&nbsp;</div></li><li><div>  $file = ltrim( $file, '/' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $file ) ) {&nbsp;</div></li><li><div>      $path = get_template_directory();&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $path = get_template_directory() . '/' . $file;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the path to a file in the parent theme.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $path The file path.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $file The requested file to search for.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'parent_theme_file_path', $path, $file );&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>wordpress</li><li><span></span>file</li><li><span></span></li><li><span></span>wp-include</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2021 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>