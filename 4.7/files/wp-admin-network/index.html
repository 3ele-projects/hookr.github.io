<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="wordpress" data-version="4.7" data-type="file" data-id="4550"><head xmlns="http://www.w3.org/1999/xhtml"><title> wp-admin-network | file | WordPress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, wordpress, 4.7" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.25"}};!function(e,n,t){var a;function i(e){var t=n.createElement("canvas"),a=t.getContext&&t.getContext("2d"),i=String.fromCharCode;return!(!a||!a.fillText)&&(a.textBaseline="top",a.font="600 32px Arial","flag"===e?(a.fillText(i(55356,56806,55356,56826),0,0),3e3<t.toDataURL().length):"diversity"===e?(a.fillText(i(55356,57221),0,0),t=a.getImageData(16,16,1,1).data,a.fillText(i(55356,57221,55356,57343),0,0),(t=a.getImageData(16,16,1,1).data)[0],t[1],t[2],t[3],!0):("simple"===e?a.fillText(i(55357,56835),0,0):a.fillText(i(55356,57135),0,0),0!==a.getImageData(16,16,1,1).data[0]))}function o(e){var t=n.createElement("script");t.src=e,t.type="text/javascript",n.getElementsByTagName("head")[0].appendChild(t)}t.supports={simple:i("simple"),flag:i("flag"),unicode8:i("unicode8"),diversity:i("diversity")},t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.simple&&t.supports.flag&&t.supports.unicode8&&t.supports.diversity||(a=function(){t.readyCallback()},n.addEventListener?(n.addEventListener("DOMContentLoaded",a,!1),e.addEventListener("load",a,!1)):(e.attachEvent("onload",a),n.attachEvent("onreadystatechange",function(){"complete"===n.readyState&&t.readyCallback()})),(a=t.source||{}).concatemoji?o(a.concatemoji):a.wpemoji&&a.twemoji&&(o(a.twemoji),o(a.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=17a770bc19ed89b2201acf9d6d0bd858' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.25' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/wp-admin-network/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-admin-network%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-admin-network%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"wordpress-4.7-file-wp-admin-network","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wp-admin-network" class="blog single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 4.7." href="http://hookr.io/4.7/" class="H_VERSION"><span property="name">4.7</span></a><meta property="position" content="2"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wp-admin-network</span><meta property="position" content="3"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="6307"><a href="http://hookr.io/4.7/all/" title="All">All <span class="count badge">6307</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/4.7/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="2531"><a href="http://hookr.io/4.7/hooks/" title="Hooks">Hooks <span class="count badge">2531</span></a></li><li class="" data-id="action" data-count="864"><a href="http://hookr.io/4.7/actions/" title="Actions">Actions <span class="count badge">864</span></a></li><li class="" data-id="filter" data-count="1667"><a href="http://hookr.io/4.7/filters/" title="Filters">Filters <span class="count badge">1667</span></a></li><li class="" data-id="class" data-count="351"><a href="http://hookr.io/4.7/classes/" title="Classes">Classes <span class="count badge">351</span></a></li><li class="" data-id="constant" data-count="566"><a href="http://hookr.io/4.7/constants/" title="Constants">Constants <span class="count badge">566</span></a></li><li class="" data-id="function" data-count="2851"><a href="http://hookr.io/4.7/functions/" title="Functions">Functions <span class="count badge">2851</span></a></li><li class="" data-id="shortcode" data-count="8"><a href="http://hookr.io/4.7/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">8</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class="active"><a href="http://hookr.io/all/" title="Core">Core</a></li><li class=""><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/wp-admin/network.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Network installation administration panel.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * A multi-step process allowing the user to enable a network of WordPress sites.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package WordPress</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage Administration</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>define( 'WP_INSTALLING_NETWORK', true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** WordPress Administration Bootstrap */</span>&nbsp;</div></li><li><div>require_once( dirname( __FILE__ ) . '/admin.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( ! is_super_admin() ) {&nbsp;</div></li><li><div>  wp_die( __( 'Sorry, you are not allowed to manage options for this site.' ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( is_multisite() ) {&nbsp;</div></li><li><div>  if ( ! is_network_admin() ) {&nbsp;</div></li><li><div>      wp_redirect( network_admin_url( 'setup.php' ) );&nbsp;</div></li><li><div>      exit;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! defined( 'MULTISITE' ) ) {&nbsp;</div></li><li><div>      wp_die( __( 'The Network creation panel is not for WordPress MU networks.' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>require_once( dirname( __FILE__ ) . '/includes/network.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// We need to create references to ms global tables to enable Network.</span>&nbsp;</div></li><li><div>foreach ( $wpdb-&gt;tables( 'ms_global' ) as $table =&gt; $prefixed_table ) {&nbsp;</div></li><li><div>  $wpdb-&gt;$table = $prefixed_table;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( ! network_domain_check() && ( ! defined( 'WP_ALLOW_MULTISITE' ) || ! WP_ALLOW_MULTISITE ) ) {&nbsp;</div></li><li><div>  wp_die(&nbsp;</div></li><li><div>      printf(&nbsp;</div></li><li><div>          <span class="comment">/** translators: 1: WP_ALLOW_MULTISITE 2: wp-config.php */</span>&nbsp;</div></li><li><div>          __( 'You must define the %1$s constant as true in your %2$s file to allow creation of a Network.' ), &nbsp;</div></li><li><div>          '&lt;code&gt;WP_ALLOW_MULTISITE&lt;/code&gt;', &nbsp;</div></li><li><div>          '&lt;code&gt;wp-config.php&lt;/code&gt;'&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( is_network_admin() ) {&nbsp;</div></li><li><div>  $title = __( 'Network Setup' );&nbsp;</div></li><li><div>  $parent_file = 'settings.php';&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  $title = __( 'Create a Network of WordPress Sites' );&nbsp;</div></li><li><div>  $parent_file = 'tools.php';&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$network_help = '&lt;p&gt;' . __('This screen allows you to configure a network as having subdomains (&lt;code&gt;site1.example.com&lt;/code&gt;) or subdirectories (&lt;code&gt;example.com/site1&lt;/code&gt;). Subdomains require wildcard subdomains to be enabled in Apache and DNS records, if your host allows it.') . '&lt;/p&gt;' .&nbsp;</div></li><li><div>  '&lt;p&gt;' . __('Choose subdomains or subdirectories; this can only be switched afterwards by reconfiguring your install. Fill out the network details, and click install. If this does not work, you may have to add a wildcard DNS record (for subdomains) or change to another setting in Permalinks (for subdirectories).') . '&lt;/p&gt;' .&nbsp;</div></li><li><div>  '&lt;p&gt;' . __('The next screen for Network Setup will give you individually-generated lines of code to add to your wp-config.php and .htaccess files. Make sure the settings of your FTP client make files starting with a dot visible, so that you can find .htaccess; you may have to create this file if it really is not there. Make backup copies of those two files.') . '&lt;/p&gt;' .&nbsp;</div></li><li><div>  '&lt;p&gt;' . __('Add the designated lines of code to wp-config.php (just before &lt;code&gt;<span class="comment">/*...stop editing...*/</span>&lt;/code&gt;) and &lt;code&gt;.htaccess&lt;/code&gt; (replacing the existing WordPress rules).') . '&lt;/p&gt;' .&nbsp;</div></li><li><div>  '&lt;p&gt;' . __('Once you add this code and refresh your browser, multisite should be enabled. This screen, now in the Network Admin navigation menu, will keep an archive of the added code. You can toggle between Network Admin and Site Admin by clicking on the Network Admin or an individual site name under the My Sites dropdown in the Toolbar.') . '&lt;/p&gt;' .&nbsp;</div></li><li><div>  '&lt;p&gt;' . __('The choice of subdirectory sites is disabled if this setup is more than a month old because of permalink problems with &#8220;/blog/&#8221; from the main site. This disabling will be addressed in a future version.') . '&lt;/p&gt;' .&nbsp;</div></li><li><div>  '&lt;p&gt;&lt;strong&gt;' . __('For more information:') . '&lt;/strong&gt;&lt;/p&gt;' .&nbsp;</div></li><li><div>  '&lt;p&gt;' . __( '&lt;a href=&quot;https:<span class="comment"><span class="comment">//codex.wordpress.org/Create_A_Network&quot;&gt;Documentation on Creating a Network&lt;/a&gt;' ) . '&lt;/p&gt;' .</span></span>&nbsp;</div></li><li><div>  '&lt;p&gt;' . __( '&lt;a href=&quot;https:<span class="comment">//codex.wordpress.org/Tools_Network_Screen&quot;&gt;Documentation on the Network Screen&lt;/a&gt;' ) . '&lt;/p&gt;';</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>get_current_screen()-&gt;add_help_tab( array(&nbsp;</div></li><li><div>  'id' =&gt; 'network', &nbsp;</div></li><li><div>  'title' =&gt; __('Network'), &nbsp;</div></li><li><div>  'content' =&gt; $network_help, &nbsp;</div></li><li><div>) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>get_current_screen()-&gt;set_help_sidebar(&nbsp;</div></li><li><div>  '&lt;p&gt;&lt;strong&gt;' . __('For more information:') . '&lt;/strong&gt;&lt;/p&gt;' .&nbsp;</div></li><li><div>  '&lt;p&gt;' . __( '&lt;a href=&quot;https:<span class="comment"><span class="comment">//codex.wordpress.org/Create_A_Network&quot;&gt;Documentation on Creating a Network&lt;/a&gt;' ) . '&lt;/p&gt;' .</span></span>&nbsp;</div></li><li><div>  '&lt;p&gt;' . __( '&lt;a href=&quot;https:<span class="comment">//codex.wordpress.org/Tools_Network_Screen&quot;&gt;Documentation on the Network Screen&lt;/a&gt;' ) . '&lt;/p&gt;' .</span>&nbsp;</div></li><li><div>  '&lt;p&gt;' . __( '&lt;a href=&quot;https:<span class="comment">//wordpress.org/support/&quot;&gt;Support Forums&lt;/a&gt;' ) . '&lt;/p&gt;'</span>&nbsp;</div></li><li><div>);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>include( ABSPATH . 'wp-admin/admin-header.php' );&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>&lt;div class=&quot;wrap&quot;&gt;&nbsp;</div></li><li><div>&lt;h1&gt;&lt;?php echo esc_html( $title ); ?&gt;&lt;/h1&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>if ( $_POST ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  check_admin_referer( 'install-network-1' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  require_once( ABSPATH . 'wp-admin/includes/upgrade.php' );&nbsp;</div></li><li><div>  <span class="comment">// Create network tables.</span>&nbsp;</div></li><li><div>  install_network();&nbsp;</div></li><li><div>  $base = parse_url( trailingslashit( get_option( 'home' ) ), PHP_URL_PATH );&nbsp;</div></li><li><div>  $subdomain_install = allow_subdomain_install() ? !empty( $_POST['subdomain_install'] ) : false;&nbsp;</div></li><li><div>  if ( ! network_domain_check() ) {&nbsp;</div></li><li><div>      $result = populate_network( 1, get_clean_basedomain(), sanitize_email( $_POST['email'] ), wp_unslash( $_POST['sitename'] ), $base, $subdomain_install );&nbsp;</div></li><li><div>      if ( is_wp_error( $result ) ) {&nbsp;</div></li><li><div>          if ( 1 == count( $result-&gt;get_error_codes() ) && 'no_wildcard_dns' == $result-&gt;get_error_code() )&nbsp;</div></li><li><div>              network_step2( $result );&nbsp;</div></li><li><div>          else&nbsp;</div></li><li><div>              network_step1( $result );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          network_step2();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      network_step2();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>} elseif ( is_multisite() || network_domain_check() ) {&nbsp;</div></li><li><div>  network_step2();&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  network_step1();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>&lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php include( ABSPATH . 'wp-admin/admin-footer.php' ); ?&gt;&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>wordpress</li><li><span></span>file</li><li><span></span></li><li><span></span>wp-admin</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2021 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>