<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="wordpress" data-version="4.7.4" data-type="file" data-id="4509"><head xmlns="http://www.w3.org/1999/xhtml"><title> wp-admin-includes-plugin-install | file | WordPress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, wordpress, 4.7.4" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.10"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=50e4774c08629642ae3109b813ecb2be' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.10' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/wp-admin-includes-plugin-install/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-admin-includes-plugin-install%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-admin-includes-plugin-install%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"wordpress-4.7.4-file-wp-admin-includes-plugin-install","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wp-admin-includes-plugin-install" class="blog single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 4.7.4." href="http://hookr.io/4.7.4/" class="H_VERSION"><span property="name">4.7.4</span></a><meta property="position" content="2"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wp-admin-includes-plugin-inst&hellip;</span><meta property="position" content="3"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="6316"><a href="http://hookr.io/4.7.4/all/" title="All">All <span class="count badge">6316</span></a></li><li class="" data-id="new" data-count="6"><a href="http://hookr.io/4.7.4/new/" title="New">New <span class="count badge">6</span></a></li><li class="" data-id="hooks" data-count="2538"><a href="http://hookr.io/4.7.4/hooks/" title="Hooks">Hooks <span class="count badge">2538</span></a></li><li class="" data-id="action" data-count="864"><a href="http://hookr.io/4.7.4/actions/" title="Actions">Actions <span class="count badge">864</span></a></li><li class="" data-id="filter" data-count="1674"><a href="http://hookr.io/4.7.4/filters/" title="Filters">Filters <span class="count badge">1674</span></a></li><li class="" data-id="class" data-count="351"><a href="http://hookr.io/4.7.4/classes/" title="Classes">Classes <span class="count badge">351</span></a></li><li class="" data-id="constant" data-count="566"><a href="http://hookr.io/4.7.4/constants/" title="Constants">Constants <span class="count badge">566</span></a></li><li class="" data-id="function" data-count="2853"><a href="http://hookr.io/4.7.4/functions/" title="Functions">Functions <span class="count badge">2853</span></a></li><li class="" data-id="shortcode" data-count="8"><a href="http://hookr.io/4.7.4/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">8</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class="active"><a href="http://hookr.io/all/" title="Core">Core</a></li><li class=""><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/wp-admin/includes/plugin-install.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * WordPress Plugin Install Administration API</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package WordPress</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage Administration</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves plugin installer pages from the WordPress.org Plugins API.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * It is possible for a plugin to override the Plugin API result with three</span>&nbsp;</div></li><li><div><span class="comment"> * filters. Assume this is for plugins, which can extend on the Plugin Info to</span>&nbsp;</div></li><li><div><span class="comment"> * offer more choices. This is very powerful and must be used with care when</span>&nbsp;</div></li><li><div><span class="comment"> * overriding the filters.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The first filter, {@see 'plugins_api_args'}, is for the args and gives the action</span>&nbsp;</div></li><li><div><span class="comment"> * as the second parameter. The hook for {@see 'plugins_api_args'} must ensure that</span>&nbsp;</div></li><li><div><span class="comment"> * an object is returned.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The second filter, {@see 'plugins_api'}, allows a plugin to override the WordPress.org</span>&nbsp;</div></li><li><div><span class="comment"> * Plugin Install API entirely. If `$action` is 'query_plugins' or 'plugin_information', </span>&nbsp;</div></li><li><div><span class="comment"> * an object MUST be passed. If `$action` is 'hot_tags' or 'hot_categories', an array MUST</span>&nbsp;</div></li><li><div><span class="comment"> * be passed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Finally, the third filter, {@see 'plugins_api_result'}, makes it possible to filter the</span>&nbsp;</div></li><li><div><span class="comment"> * response object or array, depending on the `$action` type.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Supported arguments per action:</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * | Argument Name        | query_plugins | plugin_information | hot_tags | hot_categories |</span>&nbsp;</div></li><li><div><span class="comment"> * | -------------------- | :-----------: | :----------------: | :------: | :------------: |</span>&nbsp;</div></li><li><div><span class="comment"> * | `$slug`              | No            |  Yes               | No       | No             |</span>&nbsp;</div></li><li><div><span class="comment"> * | `$per_page`          | Yes           |  No                | No       | No             |</span>&nbsp;</div></li><li><div><span class="comment"> * | `$page`              | Yes           |  No                | No       | No             |</span>&nbsp;</div></li><li><div><span class="comment"> * | `$number`            | No            |  No                | Yes      | Yes            |</span>&nbsp;</div></li><li><div><span class="comment"> * | `$search`            | Yes           |  No                | No       | No             |</span>&nbsp;</div></li><li><div><span class="comment"> * | `$tag`               | Yes           |  No                | No       | No             |</span>&nbsp;</div></li><li><div><span class="comment"> * | `$author`            | Yes           |  No                | No       | No             |</span>&nbsp;</div></li><li><div><span class="comment"> * | `$user`              | Yes           |  No                | No       | No             |</span>&nbsp;</div></li><li><div><span class="comment"> * | `$browse`            | Yes           |  No                | No       | No             |</span>&nbsp;</div></li><li><div><span class="comment"> * | `$locale`            | Yes           |  Yes               | No       | No             |</span>&nbsp;</div></li><li><div><span class="comment"> * | `$installed_plugins` | Yes           |  No                | No       | No             |</span>&nbsp;</div></li><li><div><span class="comment"> * | `$is_ssl`            | Yes           |  Yes               | No       | No             |</span>&nbsp;</div></li><li><div><span class="comment"> * | `$fields`            | Yes           |  Yes               | No       | No             |</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $action API action to perform: 'query_plugins', 'plugin_information', </span>&nbsp;</div></li><li><div><span class="comment"> *                             'hot_tags' or 'hot_categories'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|object $args   {</span>&nbsp;</div></li><li><div><span class="comment"> *     Optional. Array or object of arguments to serialize for the Plugin Info API.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string  $slug              The plugin slug. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int     $per_page          Number of plugins per page. Default 24.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int     $page              Number of current page. Default 1.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int     $number            Number of tags or categories to be queried.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string  $search            A search term. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string  $tag               Tag to filter plugins. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string  $author            Username of an plugin author to filter plugins. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string  $user              Username to query for their favorites. Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string  $browse            Browse view: 'popular', 'new', 'beta', 'recommended'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string  $locale            Locale to provide context-sensitive results. Default is the value</span>&nbsp;</div></li><li><div><span class="comment"> *                                      of get_locale().</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string  $installed_plugins Installed plugins to provide context-sensitive results.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type bool    $is_ssl            Whether links should be returned with https or not. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type array   $fields            {</span>&nbsp;</div></li><li><div><span class="comment"> *         Array of fields which should or should not be returned.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $short_description Whether to return the plugin short description. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $description       Whether to return the plugin full description. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $sections          Whether to return the plugin readme sections: description, installation, </span>&nbsp;</div></li><li><div><span class="comment"> *                                       FAQ, screenshots, other notes, and changelog. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $tested            Whether to return the 'Compatible up to' value. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $requires          Whether to return the required WordPress version. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $rating            Whether to return the rating in percent and total number of ratings.</span>&nbsp;</div></li><li><div><span class="comment"> *                                       Default true.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $ratings           Whether to return the number of rating for each star (1-5). Default true.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $downloaded        Whether to return the download count. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $downloadlink      Whether to return the download link for the package. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $last_updated      Whether to return the date of the last update. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $added             Whether to return the date when the plugin was added to the wordpress.org</span>&nbsp;</div></li><li><div><span class="comment"> *                                       repository. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $tags              Whether to return the assigned tags. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $compatibility     Whether to return the WordPress compatibility list. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $homepage          Whether to return the plugin homepage link. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $versions          Whether to return the list of all available versions. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $donate_link       Whether to return the donation link. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $reviews           Whether to return the plugin reviews. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $banners           Whether to return the banner images links. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $icons             Whether to return the icon links. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $active_installs   Whether to return the number of active installs. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $group             Whether to return the assigned group. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> *         @type bool $contributors      Whether to return the list of contributors. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> *     }</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> * @return object|array|WP_Error Response object or array on success, WP_Error on failure. See the</span>&nbsp;</div></li><li><div><span class="comment"> *         {@link https://developer.wordpress.org/reference/functions/plugins_api/ function reference article}</span>&nbsp;</div></li><li><div><span class="comment"> *         for more information on the make-up of possible return values depending on the value of `$action`.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function plugins_api( $action, $args = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_array( $args ) ) {&nbsp;</div></li><li><div>      $args = (object) $args;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! isset( $args-&gt;per_page ) ) {&nbsp;</div></li><li><div>      $args-&gt;per_page = 24;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! isset( $args-&gt;locale ) ) {&nbsp;</div></li><li><div>      $args-&gt;locale = get_user_locale();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the WordPress.org Plugin Install API arguments.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Important: An object MUST be returned to this filter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object $args   Plugin API arguments.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $action The type of information being requested from the Plugin Install API.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $args = apply_filters( 'plugins_api_args', $args, $action );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the response for the current WordPress.org Plugin Install API request.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Passing a non-false value will effectively short-circuit the WordPress.org API request.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * If `$action` is 'query_plugins' or 'plugin_information', an object MUST be passed.</span>&nbsp;</div></li><li><div><span class="comment">   * If `$action` is 'hot_tags' or 'hot_categories', an array should be passed.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param false|object|array $result The result object or array. Default false.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string             $action The type of information being requested from the Plugin Install API.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object             $args   Plugin API arguments.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $res = apply_filters( 'plugins_api', false, $action, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( false === $res ) {&nbsp;</div></li><li><div>      $url = $http_url = 'http:<span class="comment">//api.wordpress.org/plugins/info/1.0/';</span>&nbsp;</div></li><li><div>      if ( $ssl = wp_http_supports( array( 'ssl' ) ) )&nbsp;</div></li><li><div>          $url = set_url_scheme( $url, 'https' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $http_args = array(&nbsp;</div></li><li><div>          'timeout' =&gt; 15, &nbsp;</div></li><li><div>          'body' =&gt; array(&nbsp;</div></li><li><div>              'action' =&gt; $action, &nbsp;</div></li><li><div>              'request' =&gt; serialize( $args )&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      $request = wp_remote_post( $url, $http_args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $ssl && is_wp_error( $request ) ) {&nbsp;</div></li><li><div>          trigger_error(&nbsp;</div></li><li><div>              sprintf(&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment"><span class="comment">/** translators: %s: support forums URL */</span></span></span>&nbsp;</div></li><li><div>                  __( 'An unexpected error occurred. Something may be wrong with WordPress.org or this server&#8217;s configuration. If you continue to have problems, please try the &lt;a href=&quot;%s&quot;&gt;support forums&lt;/a&gt;.' ), &nbsp;</div></li><li><div>                  __( 'https:<span class="comment"><span class="comment"><span class="comment">//wordpress.org/support/' )</span></span></span>&nbsp;</div></li><li><div> ) . ' ' . __( '(WordPress could not establish a secure connection to WordPress.org. Please contact your server administrator.)' ), &nbsp;</div></li><li><div>              headers_sent() || WP_DEBUG ? E_USER_WARNING : E_USER_NOTICE&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          $request = wp_remote_post( $http_url, $http_args );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_wp_error($request) ) {&nbsp;</div></li><li><div>          $res = new WP_Error( 'plugins_api_failed', &nbsp;</div></li><li><div>              sprintf(&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment"><span class="comment">/** translators: %s: support forums URL */</span></span></span>&nbsp;</div></li><li><div>                  __( 'An unexpected error occurred. Something may be wrong with WordPress.org or this server&#8217;s configuration. If you continue to have problems, please try the &lt;a href=&quot;%s&quot;&gt;support forums&lt;/a&gt;.' ), &nbsp;</div></li><li><div>                  __( 'https:<span class="comment"><span class="comment"><span class="comment">//wordpress.org/support/' )</span></span></span>&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>              $request-&gt;get_error_message()&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $res = maybe_unserialize( wp_remote_retrieve_body( $request ) );&nbsp;</div></li><li><div>          if ( ! is_object( $res ) && ! is_array( $res ) ) {&nbsp;</div></li><li><div>              $res = new WP_Error( 'plugins_api_failed', &nbsp;</div></li><li><div>                  sprintf(&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment">/** translators: %s: support forums URL */</span></span></span>&nbsp;</div></li><li><div>                      __( 'An unexpected error occurred. Something may be wrong with WordPress.org or this server&#8217;s configuration. If you continue to have problems, please try the &lt;a href=&quot;%s&quot;&gt;support forums&lt;/a&gt;.' ), &nbsp;</div></li><li><div>                      __( 'https:<span class="comment"><span class="comment"><span class="comment">//wordpress.org/support/' )</span></span></span>&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  wp_remote_retrieve_body( $request )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } elseif ( !is_wp_error($res) ) {&nbsp;</div></li><li><div>      $res-&gt;external = true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the Plugin Install API response results.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|WP_Error $res    Response object or WP_Error.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string          $action The type of information being requested from the Plugin Install API.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object          $args   Plugin API arguments.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'plugins_api_result', $res, $action, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieve popular WordPress plugin tags.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args</span>&nbsp;</div></li><li><div><span class="comment"> * @return array</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function install_popular_tags( $args = array() ) {&nbsp;</div></li><li><div>  $key = md5(serialize($args));&nbsp;</div></li><li><div>  if ( false !== ($tags = get_site_transient('poptags_' . $key) ) )&nbsp;</div></li><li><div>      return $tags;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $tags = plugins_api('hot_tags', $args);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_wp_error($tags) )&nbsp;</div></li><li><div>      return $tags;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  set_site_transient( 'poptags_' . $key, $tags, 3 * HOUR_IN_SECONDS );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $tags;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function install_dashboard() {&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;p&gt;&lt;?php printf( __( 'Plugins extend and expand the functionality of WordPress. You may automatically install plugins from the &lt;a href=&quot;%1$s&quot;&gt;WordPress Plugin Directory&lt;/a&gt; or upload a plugin in .zip format by clicking the button at the top of this page.' ), __( 'https:<span class="comment">//wordpress.org/plugins/' ) ); ?&gt;&lt;/p&gt;</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php display_plugins_table(); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;div class=&quot;plugins-popular-tags-wrapper&quot;&gt;&nbsp;</div></li><li><div>  &lt;h2&gt;&lt;?php _e( 'Popular tags' ) ?&gt;&lt;/h2&gt;&nbsp;</div></li><li><div>  &lt;p&gt;&lt;?php _e( 'You may also browse based on the most popular tags in the Plugin Directory:' ) ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $api_tags = install_popular_tags();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo '&lt;p class=&quot;popular-tags&quot;&gt;';&nbsp;</div></li><li><div>  if ( is_wp_error($api_tags) ) {&nbsp;</div></li><li><div>      echo $api_tags-&gt;get_error_message();&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      <span class="comment">//Set up the tags in a way which can be interpreted by wp_generate_tag_cloud()</span>&nbsp;</div></li><li><div>      $tags = array();&nbsp;</div></li><li><div>      foreach ( (array) $api_tags as $tag ) {&nbsp;</div></li><li><div>          $url = self_admin_url( 'plugin-install.php?tab=search&type=tag&s=' . urlencode( $tag['name'] ) );&nbsp;</div></li><li><div>          $data = array(&nbsp;</div></li><li><div>              'link' =&gt; esc_url( $url ), &nbsp;</div></li><li><div>              'name' =&gt; $tag['name'], &nbsp;</div></li><li><div>              'slug' =&gt; $tag['slug'], &nbsp;</div></li><li><div>              'id' =&gt; sanitize_title_with_dashes( $tag['name'] ), &nbsp;</div></li><li><div>              'count' =&gt; $tag['count']&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          $tags[ $tag['name'] ] = (object) $data;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      echo wp_generate_tag_cloud($tags, array( 'single_text' =&gt; __('%s plugin'), 'multiple_text' =&gt; __('%s plugins') ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  echo '&lt;/p&gt;&lt;br class=&quot;clear&quot; /&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays a search form for searching plugins.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.6.0 The `$type_selector` parameter was deprecated.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $deprecated Not used.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function install_search_form( $deprecated = true ) {&nbsp;</div></li><li><div>  $type = isset( $_REQUEST['type'] ) ? wp_unslash( $_REQUEST['type'] ) : 'term';&nbsp;</div></li><li><div>  $term = isset( $_REQUEST['s'] ) ? wp_unslash( $_REQUEST['s'] ) : '';&nbsp;</div></li><li><div>  ?&gt;&lt;form class=&quot;search-form search-plugins&quot; method=&quot;get&quot;&gt;&nbsp;</div></li><li><div>      &lt;input type=&quot;hidden&quot; name=&quot;tab&quot; value=&quot;search&quot; /&gt;&nbsp;</div></li><li><div>      &lt;label class=&quot;screen-reader-text&quot; for=&quot;typeselector&quot;&gt;&lt;?php _e( 'Search plugins by:' ); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>      &lt;select name=&quot;type&quot; id=&quot;typeselector&quot;&gt;&nbsp;</div></li><li><div>          &lt;option value=&quot;term&quot;&lt;?php selected( 'term', $type ); ?&gt;&gt;&lt;?php _e( 'Keyword' ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>          &lt;option value=&quot;author&quot;&lt;?php selected( 'author', $type ); ?&gt;&gt;&lt;?php _e( 'Author' ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>          &lt;option value=&quot;tag&quot;&lt;?php selected( 'tag', $type ); ?&gt;&gt;&lt;?php _ex( 'Tag', 'Plugin Installer' ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>      &lt;/select&gt;&nbsp;</div></li><li><div>      &lt;label&gt;&lt;span class=&quot;screen-reader-text&quot;&gt;&lt;?php _e( 'Search Plugins' ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>          &lt;input type=&quot;search&quot; name=&quot;s&quot; value=&quot;&lt;?php echo esc_attr( $term ) ?&gt;&quot; class=&quot;wp-filter-search&quot; placeholder=&quot;&lt;?php esc_attr_e( 'Search plugins...' ); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>      &lt;/label&gt;&nbsp;</div></li><li><div>      &lt;?php submit_button( __( 'Search Plugins' ), 'hide-if-js', false, false, array( 'id' =&gt; 'search-submit' ) ); ?&gt;&nbsp;</div></li><li><div>  &lt;/form&gt;&lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Upload from zip</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function install_plugins_upload() {&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>&lt;div class=&quot;upload-plugin&quot;&gt;&nbsp;</div></li><li><div>  &lt;p class=&quot;install-help&quot;&gt;&lt;?php _e('If you have a plugin in a .zip format, you may install it by uploading it here.'); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>  &lt;form method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; class=&quot;wp-upload-form&quot; action=&quot;&lt;?php echo self_admin_url('update.php?action=upload-plugin'); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>      &lt;?php wp_nonce_field( 'plugin-upload' ); ?&gt;&nbsp;</div></li><li><div>      &lt;label class=&quot;screen-reader-text&quot; for=&quot;pluginzip&quot;&gt;&lt;?php _e( 'Plugin zip file' ); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>      &lt;input type=&quot;file&quot; id=&quot;pluginzip&quot; name=&quot;pluginzip&quot; /&gt;&nbsp;</div></li><li><div>      &lt;?php submit_button( __( 'Install Now' ), '', 'install-plugin-submit', false ); ?&gt;&nbsp;</div></li><li><div>  &lt;/form&gt;&nbsp;</div></li><li><div>&lt;/div&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Show a username form for the favorites page</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function install_plugins_favorites_form() {&nbsp;</div></li><li><div>  $user = get_user_option( 'wporg_favorites' );&nbsp;</div></li><li><div>  $action = 'save_wporg_username_' . get_current_user_id();&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;p class=&quot;install-help&quot;&gt;&lt;?php _e( 'If you have marked plugins as favorites on WordPress.org, you can browse them here.' ); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>  &lt;form method=&quot;get&quot;&gt;&nbsp;</div></li><li><div>      &lt;input type=&quot;hidden&quot; name=&quot;tab&quot; value=&quot;favorites&quot; /&gt;&nbsp;</div></li><li><div>      &lt;p&gt;&nbsp;</div></li><li><div>          &lt;label for=&quot;user&quot;&gt;&lt;?php _e( 'Your WordPress.org username:' ); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>          &lt;input type=&quot;search&quot; id=&quot;user&quot; name=&quot;user&quot; value=&quot;&lt;?php echo esc_attr( $user ); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>          &lt;input type=&quot;submit&quot; class=&quot;button&quot; value=&quot;&lt;?php esc_attr_e( 'Get Favorites' ); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>          &lt;input type=&quot;hidden&quot; id=&quot;wporg-username-nonce&quot; name=&quot;_wpnonce&quot; value=&quot;&lt;?php echo esc_attr( wp_create_nonce( $action ) ); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>      &lt;/p&gt;&nbsp;</div></li><li><div>  &lt;/form&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Display plugin content based on plugin list.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_List_Table $wp_list_table</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function display_plugins_table() {&nbsp;</div></li><li><div>  global $wp_list_table;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  switch ( current_filter() ) {&nbsp;</div></li><li><div>      case 'install_plugins_favorites' :&nbsp;</div></li><li><div>          if ( empty( $_GET['user'] ) && ! get_user_option( 'wporg_favorites' ) ) {&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      case 'install_plugins_recommended' :&nbsp;</div></li><li><div>          echo '&lt;p&gt;' . __( 'These suggestions are based on the plugins you and other users have installed.' ) . '&lt;/p&gt;';&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      case 'install_plugins_beta' :&nbsp;</div></li><li><div>          printf(&nbsp;</div></li><li><div>              '&lt;p&gt;' . __( 'You are using a development version of WordPress. These feature plugins are also under development. &lt;a href=&quot;%s&quot;&gt;Learn more&lt;/a&gt;.' ) . '&lt;/p&gt;', &nbsp;</div></li><li><div>              'https:<span class="comment">//make.wordpress.org/core/handbook/about/release-cycle/features-as-plugins/'</span>&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;form id=&quot;plugin-filter&quot; method=&quot;post&quot;&gt;&nbsp;</div></li><li><div>      &lt;?php $wp_list_table-&gt;display(); ?&gt;&nbsp;</div></li><li><div>  &lt;/form&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determine the status we can perform on a plugin.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param  array|object $api  Data about the plugin retrieved from the API.</span>&nbsp;</div></li><li><div><span class="comment"> * @param  bool         $loop Optional. Disable further loops. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @return array {</span>&nbsp;</div></li><li><div><span class="comment"> *     Plugin installation status data.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $status  Status of a plugin. Could be one of 'install', 'update_available', 'latest_installed' or 'newer_installed'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $url     Plugin installation URL.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $version The most recent version of the plugin.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $file    Plugin filename relative to the plugins directory.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function install_plugin_install_status($api, $loop = false) {&nbsp;</div></li><li><div>  <span class="comment">// This function is called recursively, $loop prevents further loops.</span>&nbsp;</div></li><li><div>  if ( is_array($api) )&nbsp;</div></li><li><div>      $api = (object) $api;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Default to a &quot;new&quot; plugin</span>&nbsp;</div></li><li><div>  $status = 'install';&nbsp;</div></li><li><div>  $url = false;&nbsp;</div></li><li><div>  $update_file = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Check to see if this plugin is known to be installed, </span>&nbsp;</div></li><li><div><span class="comment">   * and has an update awaiting it.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $update_plugins = get_site_transient('update_plugins');&nbsp;</div></li><li><div>  if ( isset( $update_plugins-&gt;response ) ) {&nbsp;</div></li><li><div>      foreach ( (array)$update_plugins-&gt;response as $file =&gt; $plugin ) {&nbsp;</div></li><li><div>          if ( $plugin-&gt;slug === $api-&gt;slug ) {&nbsp;</div></li><li><div>              $status = 'update_available';&nbsp;</div></li><li><div>              $update_file = $file;&nbsp;</div></li><li><div>              $version = $plugin-&gt;new_version;&nbsp;</div></li><li><div>              if ( current_user_can('update_plugins') )&nbsp;</div></li><li><div>                  $url = wp_nonce_url(self_admin_url('update.php?action=upgrade-plugin&plugin=' . $update_file), 'upgrade-plugin_' . $update_file);&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'install' == $status ) {&nbsp;</div></li><li><div>      if ( is_dir( WP_PLUGIN_DIR . '/' . $api-&gt;slug ) ) {&nbsp;</div></li><li><div>          $installed_plugin = get_plugins('/' . $api-&gt;slug);&nbsp;</div></li><li><div>          if ( empty($installed_plugin) ) {&nbsp;</div></li><li><div>              if ( current_user_can('install_plugins') )&nbsp;</div></li><li><div>                  $url = wp_nonce_url(self_admin_url('update.php?action=install-plugin&plugin=' . $api-&gt;slug), 'install-plugin_' . $api-&gt;slug);&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $key = array_keys( $installed_plugin );&nbsp;</div></li><li><div>              $key = reset( $key ); <span class="comment">//Use the first plugin regardless of the name, Could have issues for multiple-plugins in one directory if they share different version numbers</span>&nbsp;</div></li><li><div>              $update_file = $api-&gt;slug . '/' . $key;&nbsp;</div></li><li><div>              if ( version_compare($api-&gt;version, $installed_plugin[ $key ]['Version'], '=') ) {&nbsp;</div></li><li><div>                  $status = 'latest_installed';&nbsp;</div></li><li><div>              } elseif ( version_compare($api-&gt;version, $installed_plugin[ $key ]['Version'], '&lt;') ) {&nbsp;</div></li><li><div>                  $status = 'newer_installed';&nbsp;</div></li><li><div>                  $version = $installed_plugin[ $key ]['Version'];&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  <span class="comment">//If the above update check failed, Then that probably means that the update checker has out-of-date information, force a refresh</span>&nbsp;</div></li><li><div>                  if ( ! $loop ) {&nbsp;</div></li><li><div>                      delete_site_transient('update_plugins');&nbsp;</div></li><li><div>                      wp_update_plugins();&nbsp;</div></li><li><div>                      return install_plugin_install_status($api, true);&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          <span class="comment">// &quot;install&quot; & no directory with that slug</span>&nbsp;</div></li><li><div>          if ( current_user_can('install_plugins') )&nbsp;</div></li><li><div>              $url = wp_nonce_url(self_admin_url('update.php?action=install-plugin&plugin=' . $api-&gt;slug), 'install-plugin_' . $api-&gt;slug);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( isset($_GET['from']) )&nbsp;</div></li><li><div>      $url .= '&amp;from=' . urlencode( wp_unslash( $_GET['from'] ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $file = $update_file;&nbsp;</div></li><li><div>  return compact( 'status', 'url', 'version', 'file' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Display plugin information in dialog box form.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global string $tab</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function install_plugin_information() {&nbsp;</div></li><li><div>  global $tab;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $_REQUEST['plugin'] ) ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $api = plugins_api( 'plugin_information', array(&nbsp;</div></li><li><div>      'slug' =&gt; wp_unslash( $_REQUEST['plugin'] ), &nbsp;</div></li><li><div>      'is_ssl' =&gt; is_ssl(), &nbsp;</div></li><li><div>      'fields' =&gt; array(&nbsp;</div></li><li><div>          'banners' =&gt; true, &nbsp;</div></li><li><div>          'reviews' =&gt; true, &nbsp;</div></li><li><div>          'downloaded' =&gt; false, &nbsp;</div></li><li><div>          'active_installs' =&gt; true&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_wp_error( $api ) ) {&nbsp;</div></li><li><div>      wp_die( $api );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $plugins_allowedtags = array(&nbsp;</div></li><li><div>      'a' =&gt; array( 'href' =&gt; array(), 'title' =&gt; array(), 'target' =&gt; array() ), &nbsp;</div></li><li><div>      'abbr' =&gt; array( 'title' =&gt; array() ), 'acronym' =&gt; array( 'title' =&gt; array() ), &nbsp;</div></li><li><div>      'code' =&gt; array(), 'pre' =&gt; array(), 'em' =&gt; array(), 'strong' =&gt; array(), &nbsp;</div></li><li><div>      'div' =&gt; array( 'class' =&gt; array() ), 'span' =&gt; array( 'class' =&gt; array() ), &nbsp;</div></li><li><div>      'p' =&gt; array(), 'ul' =&gt; array(), 'ol' =&gt; array(), 'li' =&gt; array(), &nbsp;</div></li><li><div>      'h1' =&gt; array(), 'h2' =&gt; array(), 'h3' =&gt; array(), 'h4' =&gt; array(), 'h5' =&gt; array(), 'h6' =&gt; array(), &nbsp;</div></li><li><div>      'img' =&gt; array( 'src' =&gt; array(), 'class' =&gt; array(), 'alt' =&gt; array() )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $plugins_section_titles = array(&nbsp;</div></li><li><div>      'description' =&gt; _x( 'Description', 'Plugin installer section title' ), &nbsp;</div></li><li><div>      'installation' =&gt; _x( 'Installation', 'Plugin installer section title' ), &nbsp;</div></li><li><div>      'faq' =&gt; _x( 'FAQ', 'Plugin installer section title' ), &nbsp;</div></li><li><div>      'screenshots' =&gt; _x( 'Screenshots', 'Plugin installer section title' ), &nbsp;</div></li><li><div>      'changelog' =&gt; _x( 'Changelog', 'Plugin installer section title' ), &nbsp;</div></li><li><div>      'reviews' =&gt; _x( 'Reviews', 'Plugin installer section title' ), &nbsp;</div></li><li><div>      'other_notes' =&gt; _x( 'Other Notes', 'Plugin installer section title' )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Sanitize HTML</span>&nbsp;</div></li><li><div>  foreach ( (array) $api-&gt;sections as $section_name =&gt; $content ) {&nbsp;</div></li><li><div>      $api-&gt;sections[$section_name] = wp_kses( $content, $plugins_allowedtags );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( array( 'version', 'author', 'requires', 'tested', 'homepage', 'downloaded', 'slug' ) as $key ) {&nbsp;</div></li><li><div>      if ( isset( $api-&gt;$key ) ) {&nbsp;</div></li><li><div>          $api-&gt;$key = wp_kses( $api-&gt;$key, $plugins_allowedtags );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $_tab = esc_attr( $tab );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $section = isset( $_REQUEST['section'] ) ? wp_unslash( $_REQUEST['section'] ) : 'description'; <span class="comment">// Default to the Description tab, Do not translate, API returns English.</span>&nbsp;</div></li><li><div>  if ( empty( $section ) || ! isset( $api-&gt;sections[ $section ] ) ) {&nbsp;</div></li><li><div>      $section_titles = array_keys( (array) $api-&gt;sections );&nbsp;</div></li><li><div>      $section = reset( $section_titles );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  iframe_header( __( 'Plugin Install' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $_with_banner = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $api-&gt;banners ) && ( ! empty( $api-&gt;banners['low'] ) || ! empty( $api-&gt;banners['high'] ) ) ) {&nbsp;</div></li><li><div>      $_with_banner = 'with-banner';&nbsp;</div></li><li><div>      $low = empty( $api-&gt;banners['low'] ) ? $api-&gt;banners['high'] : $api-&gt;banners['low'];&nbsp;</div></li><li><div>      $high = empty( $api-&gt;banners['high'] ) ? $api-&gt;banners['low'] : $api-&gt;banners['high'];&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;style type=&quot;text/css&quot;&gt;&nbsp;</div></li><li><div>          #plugin-information-title.with-banner {&nbsp;</div></li><li><div>              background-image: url( &lt;?php echo esc_url( $low ); ?&gt; );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          @media only screen and ( -webkit-min-device-pixel-ratio: 1.5 ) {&nbsp;</div></li><li><div>              #plugin-information-title.with-banner {&nbsp;</div></li><li><div>                  background-image: url( &lt;?php echo esc_url( $high ); ?&gt; );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      &lt;/style&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo '&lt;div id=&quot;plugin-information-scrollable&quot;&gt;';&nbsp;</div></li><li><div>  echo &quot;&lt;div id='{$_tab}-title' class='{$_with_banner}'&gt;&lt;div class='vignette'&gt;&lt;/div&gt;&lt;h2&gt;{$api-&gt;name}&lt;/h2&gt;&lt;/div&gt;&quot;;&nbsp;</div></li><li><div>  echo &quot;&lt;div id='{$_tab}-tabs' class='{$_with_banner}'&gt;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( (array) $api-&gt;sections as $section_name =&gt; $content ) {&nbsp;</div></li><li><div>      if ( 'reviews' === $section_name && ( empty( $api-&gt;ratings ) || 0 === array_sum( (array) $api-&gt;ratings ) ) ) {&nbsp;</div></li><li><div>          continue;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $plugins_section_titles[ $section_name ] ) ) {&nbsp;</div></li><li><div>          $title = $plugins_section_titles[ $section_name ];&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $title = ucwords( str_replace( '_', ' ', $section_name ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $class = ( $section_name === $section ) ? ' class=&quot;current&quot;' : '';&nbsp;</div></li><li><div>      $href = add_query_arg( array('tab' =&gt; $tab, 'section' =&gt; $section_name) );&nbsp;</div></li><li><div>      $href = esc_url( $href );&nbsp;</div></li><li><div>      $san_section = esc_attr( $section_name );&nbsp;</div></li><li><div>      echo &quot;\t&lt;a name='$san_section' href='$href' $class&gt;$title&lt;/a&gt;\n&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo &quot;&lt;/div&gt;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>&lt;div id=&quot;&lt;?php echo $_tab; ?&gt;-content&quot; class='&lt;?php echo $_with_banner; ?&gt;'&gt;&nbsp;</div></li><li><div>  &lt;div class=&quot;fyi&quot;&gt;&nbsp;</div></li><li><div>      &lt;ul&gt;&nbsp;</div></li><li><div>          &lt;?php if ( ! empty( $api-&gt;version ) ) { ?&gt;&nbsp;</div></li><li><div>              &lt;li&gt;&lt;strong&gt;&lt;?php _e( 'Version:' ); ?&gt;&lt;/strong&gt; &lt;?php echo $api-&gt;version; ?&gt;&lt;/li&gt;&nbsp;</div></li><li><div>          &lt;?php } if ( ! empty( $api-&gt;author ) ) { ?&gt;&nbsp;</div></li><li><div>              &lt;li&gt;&lt;strong&gt;&lt;?php _e( 'Author:' ); ?&gt;&lt;/strong&gt; &lt;?php echo links_add_target( $api-&gt;author, '_blank' ); ?&gt;&lt;/li&gt;&nbsp;</div></li><li><div>          &lt;?php } if ( ! empty( $api-&gt;last_updated ) ) { ?&gt;&nbsp;</div></li><li><div>              &lt;li&gt;&lt;strong&gt;&lt;?php _e( 'Last Updated:' ); ?&gt;&lt;/strong&gt;&nbsp;</div></li><li><div>                  &lt;?php&nbsp;</div></li><li><div>                  <span class="comment">/** translators: %s: Time since the last update */</span>&nbsp;</div></li><li><div>                  printf( __( '%s ago' ), human_time_diff( strtotime( $api-&gt;last_updated ) ) );&nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>              &lt;/li&gt;&nbsp;</div></li><li><div>          &lt;?php } if ( ! empty( $api-&gt;requires ) ) { ?&gt;&nbsp;</div></li><li><div>              &lt;li&gt;&nbsp;</div></li><li><div>                  &lt;strong&gt;&lt;?php _e( 'Requires WordPress Version:' ); ?&gt;&lt;/strong&gt;&nbsp;</div></li><li><div>                  &lt;?php&nbsp;</div></li><li><div>                  <span class="comment">/** translators: %s: WordPress version */</span>&nbsp;</div></li><li><div>                  printf( __( '%s or higher' ), $api-&gt;requires );&nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>              &lt;/li&gt;&nbsp;</div></li><li><div>          &lt;?php } if ( ! empty( $api-&gt;tested ) ) { ?&gt;&nbsp;</div></li><li><div>              &lt;li&gt;&lt;strong&gt;&lt;?php _e( 'Compatible up to:' ); ?&gt;&lt;/strong&gt; &lt;?php echo $api-&gt;tested; ?&gt;&lt;/li&gt;&nbsp;</div></li><li><div>          &lt;?php } if ( isset( $api-&gt;active_installs ) ) { ?&gt;&nbsp;</div></li><li><div>              &lt;li&gt;&lt;strong&gt;&lt;?php _e( 'Active Installs:' ); ?&gt;&lt;/strong&gt; &lt;?php&nbsp;</div></li><li><div>                  if ( $api-&gt;active_installs &gt;= 1000000 ) {&nbsp;</div></li><li><div>                      _ex( '1+ Million', 'Active plugin installs' );&nbsp;</div></li><li><div>                  } elseif ( 0 == $api-&gt;active_installs ) {&nbsp;</div></li><li><div>                      _ex( 'Less Than 10', 'Active plugin installs' );&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      echo number_format_i18n( $api-&gt;active_installs ) . '+';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  ?&gt;&lt;/li&gt;&nbsp;</div></li><li><div>          &lt;?php } if ( ! empty( $api-&gt;slug ) && empty( $api-&gt;external ) ) { ?&gt;&nbsp;</div></li><li><div>              &lt;li&gt;&lt;a target=&quot;_blank&quot; href=&quot;&lt;?php echo __( 'https:<span class="comment">//wordpress.org/plugins/' ) . $api-&gt;slug; ?&gt;/&quot;&gt;&lt;?php _e( 'WordPress.org Plugin Page &#187;' ); ?&gt;&lt;/a&gt;&lt;/li&gt;</span>&nbsp;</div></li><li><div>          &lt;?php } if ( ! empty( $api-&gt;homepage ) ) { ?&gt;&nbsp;</div></li><li><div>              &lt;li&gt;&lt;a target=&quot;_blank&quot; href=&quot;&lt;?php echo esc_url( $api-&gt;homepage ); ?&gt;&quot;&gt;&lt;?php _e( 'Plugin Homepage &#187;' ); ?&gt;&lt;/a&gt;&lt;/li&gt;&nbsp;</div></li><li><div>          &lt;?php } if ( ! empty( $api-&gt;donate_link ) && empty( $api-&gt;contributors ) ) { ?&gt;&nbsp;</div></li><li><div>              &lt;li&gt;&lt;a target=&quot;_blank&quot; href=&quot;&lt;?php echo esc_url( $api-&gt;donate_link ); ?&gt;&quot;&gt;&lt;?php _e( 'Donate to this plugin &#187;' ); ?&gt;&lt;/a&gt;&lt;/li&gt;&nbsp;</div></li><li><div>          &lt;?php } ?&gt;&nbsp;</div></li><li><div>      &lt;/ul&gt;&nbsp;</div></li><li><div>      &lt;?php if ( ! empty( $api-&gt;rating ) ) { ?&gt;&nbsp;</div></li><li><div>          &lt;h3&gt;&lt;?php _e( 'Average Rating' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>          &lt;?php wp_star_rating( array( 'rating' =&gt; $api-&gt;rating, 'type' =&gt; 'percent', 'number' =&gt; $api-&gt;num_ratings ) ); ?&gt;&nbsp;</div></li><li><div>          &lt;p aria-hidden=&quot;true&quot; class=&quot;fyi-description&quot;&gt;&lt;?php printf( _n( '(based on %s rating)', '(based on %s ratings)', $api-&gt;num_ratings ), number_format_i18n( $api-&gt;num_ratings ) ); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>      &lt;?php }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $api-&gt;ratings ) && array_sum( (array) $api-&gt;ratings ) &gt; 0 ) { ?&gt;&nbsp;</div></li><li><div>          &lt;h3&gt;&lt;?php _e( 'Reviews' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>          &lt;p class=&quot;fyi-description&quot;&gt;&lt;?php _e( 'Read all reviews on WordPress.org or write your own!' ); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>          foreach ( $api-&gt;ratings as $key =&gt; $ratecount ) {&nbsp;</div></li><li><div>              <span class="comment">// Avoid div-by-zero.</span>&nbsp;</div></li><li><div>              $_rating = $api-&gt;num_ratings ? ( $ratecount / $api-&gt;num_ratings ) : 0;&nbsp;</div></li><li><div>              <span class="comment">/** translators: 1: number of stars (used to determine singular/plural), 2: number of reviews */</span>&nbsp;</div></li><li><div>              $aria_label = esc_attr( sprintf( _n( 'Reviews with %1$d star: %2$s. Opens in a new window.', 'Reviews with %1$d stars: %2$s. Opens in a new window.', $key ), &nbsp;</div></li><li><div>                  $key, &nbsp;</div></li><li><div>                  number_format_i18n( $ratecount )&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>              &lt;div class=&quot;counter-container&quot;&gt;&nbsp;</div></li><li><div>                      &lt;span class=&quot;counter-label&quot;&gt;&lt;a href=&quot;https:<span class="comment">//wordpress.org/support/view/plugin-reviews/&lt;?php echo $api-&gt;slug; ?&gt;?filter=&lt;?php echo $key; ?&gt;&quot;</span>&nbsp;</div></li><li><div>                                                     target=&quot;_blank&quot; aria-label=&quot;&lt;?php echo $aria_label; ?&gt;&quot;&gt;&lt;?php printf( _n( '%d star', '%d stars', $key ), $key ); ?&gt;&lt;/a&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;span class=&quot;counter-back&quot;&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;counter-bar&quot; style=&quot;width: &lt;?php echo 92 * $_rating; ?&gt;px;&quot;&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;span class=&quot;counter-count&quot; aria-hidden=&quot;true&quot;&gt;&lt;?php echo number_format_i18n( $ratecount ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>              &lt;/div&gt;&nbsp;</div></li><li><div>              &lt;?php&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if ( ! empty( $api-&gt;contributors ) ) { ?&gt;&nbsp;</div></li><li><div>          &lt;h3&gt;&lt;?php _e( 'Contributors' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>          &lt;ul class=&quot;contributors&quot;&gt;&nbsp;</div></li><li><div>              &lt;?php&nbsp;</div></li><li><div>              foreach ( (array) $api-&gt;contributors as $contrib_username =&gt; $contrib_profile ) {&nbsp;</div></li><li><div>                  if ( empty( $contrib_username ) && empty( $contrib_profile ) ) {&nbsp;</div></li><li><div>                      continue;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  if ( empty( $contrib_username ) ) {&nbsp;</div></li><li><div>                      $contrib_username = preg_replace( '/^.+\/(.+)\/?$/', '\1', $contrib_profile );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  $contrib_username = sanitize_user( $contrib_username );&nbsp;</div></li><li><div>                  if ( empty( $contrib_profile ) ) {&nbsp;</div></li><li><div>                      echo &quot;&lt;li&gt;&lt;img src='https:<span class="comment">//wordpress.org/grav-redirect.php?user={$contrib_username}&amp;s=36' width='18' height='18' alt='' /&gt;{$contrib_username}&lt;/li&gt;&quot;;</span>&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      echo &quot;&lt;li&gt;&lt;a href='{$contrib_profile}' target='_blank'&gt;&lt;img src='https:<span class="comment">//wordpress.org/grav-redirect.php?user={$contrib_username}&amp;s=36' width='18' height='18' alt='' /&gt;{$contrib_username}&lt;/a&gt;&lt;/li&gt;&quot;;</span>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>          &lt;/ul&gt;&nbsp;</div></li><li><div>          &lt;?php if ( ! empty( $api-&gt;donate_link ) ) { ?&gt;&nbsp;</div></li><li><div>              &lt;a target=&quot;_blank&quot; href=&quot;&lt;?php echo esc_url( $api-&gt;donate_link ); ?&gt;&quot;&gt;&lt;?php _e( 'Donate to this plugin &#187;' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>          &lt;?php } ?&gt;&nbsp;</div></li><li><div>      &lt;?php } ?&gt;&nbsp;</div></li><li><div>  &lt;/div&gt;&nbsp;</div></li><li><div>  &lt;div id=&quot;section-holder&quot; class=&quot;wrap&quot;&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>  $wp_version = get_bloginfo( 'version' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $api-&gt;tested ) && version_compare( substr( $wp_version, 0, strlen( $api-&gt;tested ) ), $api-&gt;tested, '&gt;' ) ) {&nbsp;</div></li><li><div>      echo '&lt;div class=&quot;notice notice-warning notice-alt&quot;&gt;&lt;p&gt;' . __( '&lt;strong&gt;Warning:&lt;/strong&gt; This plugin has &lt;strong&gt;not been tested&lt;/strong&gt; with your current version of WordPress.' ) . '&lt;/p&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>  } elseif ( ! empty( $api-&gt;requires ) && version_compare( substr( $wp_version, 0, strlen( $api-&gt;requires ) ), $api-&gt;requires, '&lt;' ) ) {&nbsp;</div></li><li><div>      echo '&lt;div class=&quot;notice notice-warning notice-alt&quot;&gt;&lt;p&gt;' . __( '&lt;strong&gt;Warning:&lt;/strong&gt; This plugin has &lt;strong&gt;not been marked as compatible&lt;/strong&gt; with your version of WordPress.' ) . '&lt;/p&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( (array) $api-&gt;sections as $section_name =&gt; $content ) {&nbsp;</div></li><li><div>      $content = links_add_base_url( $content, 'https:<span class="comment">//wordpress.org/plugins/' . $api-&gt;slug . '/' );</span>&nbsp;</div></li><li><div>      $content = links_add_target( $content, '_blank' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $san_section = esc_attr( $section_name );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $display = ( $section_name === $section ) ? 'block' : 'none';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo &quot;\t&lt;div id='section-{$san_section}' class='section' style='display: {$display};'&gt;\n&quot;;&nbsp;</div></li><li><div>      echo $content;&nbsp;</div></li><li><div>      echo &quot;\t&lt;/div&gt;\n&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  echo &quot;&lt;/div&gt;\n&quot;;&nbsp;</div></li><li><div>  echo &quot;&lt;/div&gt;\n&quot;;&nbsp;</div></li><li><div>  echo &quot;&lt;/div&gt;\n&quot;; <span class="comment">// #plugin-information-scrollable</span>&nbsp;</div></li><li><div>  echo &quot;&lt;div id='$tab-footer'&gt;\n&quot;;&nbsp;</div></li><li><div>  if ( ! empty( $api-&gt;download_link ) && ( current_user_can( 'install_plugins' ) || current_user_can( 'update_plugins' ) ) ) {&nbsp;</div></li><li><div>      $status = install_plugin_install_status( $api );&nbsp;</div></li><li><div>      switch ( $status['status'] ) {&nbsp;</div></li><li><div>          case 'install':&nbsp;</div></li><li><div>              if ( $status['url'] ) {&nbsp;</div></li><li><div>                  echo '&lt;a data-slug=&quot;' . esc_attr( $api-&gt;slug ) . '&quot; id=&quot;plugin_install_from_iframe&quot; class=&quot;button button-primary right&quot; href=&quot;' . $status['url'] . '&quot; target=&quot;_parent&quot;&gt;' . __( 'Install Now' ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>          case 'update_available':&nbsp;</div></li><li><div>              if ( $status['url'] ) {&nbsp;</div></li><li><div>                  echo '&lt;a data-slug=&quot;' . esc_attr( $api-&gt;slug ) . '&quot; data-plugin=&quot;' . esc_attr( $status['file'] ) . '&quot; id=&quot;plugin_update_from_iframe&quot; class=&quot;button button-primary right&quot; href=&quot;' . $status['url'] . '&quot; target=&quot;_parent&quot;&gt;' . __( 'Install Update Now' ) .'&lt;/a&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>          case 'newer_installed':&nbsp;</div></li><li><div>              <span class="comment">/** translators: %s: Plugin version */</span>&nbsp;</div></li><li><div>              echo '&lt;a class=&quot;button button-primary right disabled&quot;&gt;' . sprintf( __( 'Newer Version (%s) Installed'), $status['version'] ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>          case 'latest_installed':&nbsp;</div></li><li><div>              echo '&lt;a class=&quot;button button-primary right disabled&quot;&gt;' . __( 'Latest Version Installed' ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  echo &quot;&lt;/div&gt;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  iframe_footer();&nbsp;</div></li><li><div>  exit;&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>wordpress</li><li><span></span>file</li><li><span></span></li><li><span></span>wp-admin</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>