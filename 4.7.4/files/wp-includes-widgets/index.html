<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="wordpress" data-version="4.7.4" data-type="file" data-id="4985"><head xmlns="http://www.w3.org/1999/xhtml"><title> wp-includes-widgets | file | WordPress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, wordpress, 4.7.4" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=db7cd070d8f9380f20dd6a5d005f72f9' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/wp-includes-widgets/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-includes-widgets%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-includes-widgets%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"wordpress-4.7.4-file-wp-includes-widgets","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wp-includes-widgets" class="blog single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 4.7.4." href="http://hookr.io/4.7.4/" class="H_VERSION"><span property="name">4.7.4</span></a><meta property="position" content="2"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wp-includes-widgets</span><meta property="position" content="3"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="6316"><a href="http://hookr.io/4.7.4/all/" title="All">All <span class="count badge">6316</span></a></li><li class="" data-id="new" data-count="6"><a href="http://hookr.io/4.7.4/new/" title="New">New <span class="count badge">6</span></a></li><li class="" data-id="hooks" data-count="2538"><a href="http://hookr.io/4.7.4/hooks/" title="Hooks">Hooks <span class="count badge">2538</span></a></li><li class="" data-id="action" data-count="864"><a href="http://hookr.io/4.7.4/actions/" title="Actions">Actions <span class="count badge">864</span></a></li><li class="" data-id="filter" data-count="1674"><a href="http://hookr.io/4.7.4/filters/" title="Filters">Filters <span class="count badge">1674</span></a></li><li class="" data-id="class" data-count="351"><a href="http://hookr.io/4.7.4/classes/" title="Classes">Classes <span class="count badge">351</span></a></li><li class="" data-id="constant" data-count="566"><a href="http://hookr.io/4.7.4/constants/" title="Constants">Constants <span class="count badge">566</span></a></li><li class="" data-id="function" data-count="2853"><a href="http://hookr.io/4.7.4/functions/" title="Functions">Functions <span class="count badge">2853</span></a></li><li class="" data-id="shortcode" data-count="8"><a href="http://hookr.io/4.7.4/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">8</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class="active"><a href="http://hookr.io/all/" title="Core">Core</a></li><li class=""><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/wp-includes/widgets.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Core Widgets API</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This API is used for creating dynamic sidebar without hardcoding functionality into</span>&nbsp;</div></li><li><div><span class="comment"> * themes</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Includes both internal WordPress routines and theme-use routines.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This functionality was found in a plugin before the WordPress 2.2 release, which</span>&nbsp;</div></li><li><div><span class="comment"> * included it in the core from that point on.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @link https://codex.wordpress.org/Plugins/WordPress_Widgets WordPress Widgets</span>&nbsp;</div></li><li><div><span class="comment"> * @link https://codex.wordpress.org/Plugins/WordPress_Widgets_Api Widgets API</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package WordPress</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage Widgets</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//</span>&nbsp;</div></li><li><div><span class="comment">// Global Variables</span>&nbsp;</div></li><li><div><span class="comment">//</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">/** @ignore */</span>&nbsp;</div></li><li><div>global $wp_registered_sidebars, $wp_registered_widgets, $wp_registered_widget_controls, $wp_registered_widget_updates;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Stores the sidebars, since many themes can have more than one.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_sidebars</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>$wp_registered_sidebars = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Stores the registered widgets.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widgets</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>$wp_registered_widgets = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Stores the registered widget control (options).</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widget_controls</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>$wp_registered_widget_controls = array();&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widget_updates</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>$wp_registered_widget_updates = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $_wp_sidebars_widgets</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>$_wp_sidebars_widgets = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $_wp_deprecated_widgets_callbacks</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>$GLOBALS['_wp_deprecated_widgets_callbacks'] = array(&nbsp;</div></li><li><div>  'wp_widget_pages', &nbsp;</div></li><li><div>  'wp_widget_pages_control', &nbsp;</div></li><li><div>  'wp_widget_calendar', &nbsp;</div></li><li><div>  'wp_widget_calendar_control', &nbsp;</div></li><li><div>  'wp_widget_archives', &nbsp;</div></li><li><div>  'wp_widget_archives_control', &nbsp;</div></li><li><div>  'wp_widget_links', &nbsp;</div></li><li><div>  'wp_widget_meta', &nbsp;</div></li><li><div>  'wp_widget_meta_control', &nbsp;</div></li><li><div>  'wp_widget_search', &nbsp;</div></li><li><div>  'wp_widget_recent_entries', &nbsp;</div></li><li><div>  'wp_widget_recent_entries_control', &nbsp;</div></li><li><div>  'wp_widget_tag_cloud', &nbsp;</div></li><li><div>  'wp_widget_tag_cloud_control', &nbsp;</div></li><li><div>  'wp_widget_categories', &nbsp;</div></li><li><div>  'wp_widget_categories_control', &nbsp;</div></li><li><div>  'wp_widget_text', &nbsp;</div></li><li><div>  'wp_widget_text_control', &nbsp;</div></li><li><div>  'wp_widget_rss', &nbsp;</div></li><li><div>  'wp_widget_rss_control', &nbsp;</div></li><li><div>  'wp_widget_recent_comments', &nbsp;</div></li><li><div>  'wp_widget_recent_comments_control'&nbsp;</div></li><li><div>);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>// Template tags & API functions&nbsp;</div></li><li><div><span class="comment">//</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Register a widget</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Registers a WP_Widget widget</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see WP_Widget</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Widget_Factory $wp_widget_factory</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $widget_class The name of a class that extends WP_Widget</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function register_widget($widget_class) {&nbsp;</div></li><li><div>  global $wp_widget_factory;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $wp_widget_factory-&gt;register($widget_class);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Unregisters a widget.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Unregisters a WP_Widget widget. Useful for un-registering default widgets.</span>&nbsp;</div></li><li><div><span class="comment"> * Run within a function hooked to the {@see 'widgets_init'} action.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see WP_Widget</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Widget_Factory $wp_widget_factory</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $widget_class The name of a class that extends WP_Widget.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function unregister_widget($widget_class) {&nbsp;</div></li><li><div>  global $wp_widget_factory;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $wp_widget_factory-&gt;unregister($widget_class);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Creates multiple sidebars.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * If you wanted to quickly create multiple sidebars for a theme or internally.</span>&nbsp;</div></li><li><div><span class="comment"> * This function will allow you to do so. If you don't pass the 'name' and/or</span>&nbsp;</div></li><li><div><span class="comment"> * 'id' in `$args`, then they will be built for you.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see register_sidebar() The second parameter is documented by register_sidebar() and is the same here.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_sidebars</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int          $number Optional. Number of sidebars to create. Default 1.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     Optional. Array or string of arguments for building a sidebar.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $id   The base string of the unique identifier for each sidebar. If provided, and multiple</span>&nbsp;</div></li><li><div><span class="comment"> *                        sidebars are being defined, the id will have &quot;-2&quot; appended, and so on.</span>&nbsp;</div></li><li><div><span class="comment"> *                        Default 'sidebar-' followed by the number the sidebar creation is currently at.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $name The name or title for the sidebars displayed in the admin dashboard. If registering</span>&nbsp;</div></li><li><div><span class="comment"> *                        more than one sidebar, include '%d' in the string as a placeholder for the uniquely</span>&nbsp;</div></li><li><div><span class="comment"> *                        assigned number for each sidebar.</span>&nbsp;</div></li><li><div><span class="comment"> *                        Default 'Sidebar' for the first sidebar, otherwise 'Sidebar %d'.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function register_sidebars( $number = 1, $args = array() ) {&nbsp;</div></li><li><div>  global $wp_registered_sidebars;&nbsp;</div></li><li><div>  $number = (int) $number;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_string($args) )&nbsp;</div></li><li><div>      parse_str($args, $args);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  for ( $i = 1; $i &lt;= $number; $i++ ) {&nbsp;</div></li><li><div>      $_args = $args;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $number &gt; 1 )&nbsp;</div></li><li><div>          $_args['name'] = isset($args['name']) ? sprintf($args['name'], $i) : sprintf(__('Sidebar %d'), $i);&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          $_args['name'] = isset($args['name']) ? $args['name'] : __('Sidebar');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Custom specified ID's are suffixed if they exist already.</span>&nbsp;</div></li><li><div>      <span class="comment">// Automatically generated sidebar names need to be suffixed regardless starting at -0</span>&nbsp;</div></li><li><div>      if ( isset($args['id']) ) {&nbsp;</div></li><li><div>          $_args['id'] = $args['id'];&nbsp;</div></li><li><div>          $n = 2; <span class="comment">// Start at -2 for conflicting custom ID's</span>&nbsp;</div></li><li><div>          while ( is_registered_sidebar( $_args['id'] ) ) {&nbsp;</div></li><li><div>              $_args['id'] = $args['id'] . '-' . $n++;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $n = count( $wp_registered_sidebars );&nbsp;</div></li><li><div>          do {&nbsp;</div></li><li><div>              $_args['id'] = 'sidebar-' . ++$n;&nbsp;</div></li><li><div>          } while ( is_registered_sidebar( $_args['id'] ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      register_sidebar($_args);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Builds the definition for a single sidebar and returns the ID.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Accepts either a string or an array and then parses that against a set</span>&nbsp;</div></li><li><div><span class="comment"> * of default arguments for the new sidebar. WordPress will automatically</span>&nbsp;</div></li><li><div><span class="comment"> * generate a sidebar ID and name based on the current number of registered</span>&nbsp;</div></li><li><div><span class="comment"> * sidebars if those arguments are not included.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * When allowing for automatic generation of the name and ID parameters, keep</span>&nbsp;</div></li><li><div><span class="comment"> * in mind that the incrementor for your sidebar can change over time depending</span>&nbsp;</div></li><li><div><span class="comment"> * on what other plugins and themes are installed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * If theme support for 'widgets' has not yet been added when this function is</span>&nbsp;</div></li><li><div><span class="comment"> * called, it will be automatically enabled through the use of add_theme_support()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_sidebars Stores the new sidebar in this array by sidebar ID.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     Optional. Array or string of arguments for the sidebar being registered.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $name          The name or title of the sidebar displayed in the Widgets</span>&nbsp;</div></li><li><div><span class="comment"> *                                 interface. Default 'Sidebar $instance'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $id            The unique identifier by which the sidebar will be called.</span>&nbsp;</div></li><li><div><span class="comment"> *                                 Default 'sidebar-$instance'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $description   Description of the sidebar, displayed in the Widgets interface.</span>&nbsp;</div></li><li><div><span class="comment"> *                                 Default empty string.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $class         Extra CSS class to assign to the sidebar in the Widgets interface.</span>&nbsp;</div></li><li><div><span class="comment"> *                                 Default empty.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $before_widget HTML content to prepend to each widget's HTML output when</span>&nbsp;</div></li><li><div><span class="comment"> *                                 assigned to this sidebar. Default is an opening list item element.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $after_widget  HTML content to append to each widget's HTML output when</span>&nbsp;</div></li><li><div><span class="comment"> *                                 assigned to this sidebar. Default is a closing list item element.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $before_title  HTML content to prepend to the sidebar title when displayed.</span>&nbsp;</div></li><li><div><span class="comment"> *                                 Default is an opening h2 element.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $after_title   HTML content to append to the sidebar title when displayed.</span>&nbsp;</div></li><li><div><span class="comment"> *                                 Default is a closing h2 element.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Sidebar ID added to $wp_registered_sidebars global.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function register_sidebar($args = array()) {&nbsp;</div></li><li><div>  global $wp_registered_sidebars;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $i = count($wp_registered_sidebars) + 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $id_is_empty = empty( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $defaults = array(&nbsp;</div></li><li><div>      'name' =&gt; sprintf(__('Sidebar %d'), $i ), &nbsp;</div></li><li><div>      'id' =&gt; &quot;sidebar-$i&quot;, &nbsp;</div></li><li><div>      'description' =&gt; '', &nbsp;</div></li><li><div>      'class' =&gt; '', &nbsp;</div></li><li><div>      'before_widget' =&gt; '&lt;li id=&quot;%1$s&quot; class=&quot;widget %2$s&quot;&gt;', &nbsp;</div></li><li><div>      'after_widget' =&gt; &quot;&lt;/li&gt;\n&quot;, &nbsp;</div></li><li><div>      'before_title' =&gt; '&lt;h2 class=&quot;widgettitle&quot;&gt;', &nbsp;</div></li><li><div>      'after_title' =&gt; &quot;&lt;/h2&gt;\n&quot;, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $sidebar = wp_parse_args( $args, $defaults );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $id_is_empty ) {&nbsp;</div></li><li><div>      <span class="comment">/** translators: 1: the id argument, 2: sidebar name, 3: recommended id value */</span>&nbsp;</div></li><li><div>      _doing_it_wrong( __FUNCTION__, sprintf( __( 'No %1$s was set in the arguments array for the &quot;%2$s&quot; sidebar. Defaulting to &quot;%3$s&quot;. Manually set the %1$s to &quot;%3$s&quot; to silence this notice and keep existing sidebar content.' ), '&lt;code&gt;id&lt;/code&gt;', $sidebar['name'], $sidebar['id'] ), '4.2.0' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $wp_registered_sidebars[$sidebar['id']] = $sidebar;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  add_theme_support('widgets');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Fires once a sidebar has been registered.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $sidebar Parsed arguments for the registered sidebar.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  do_action( 'register_sidebar', $sidebar );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $sidebar['id'];&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Removes a sidebar from the list.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_sidebars Stores the new sidebar in this array by sidebar ID.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $name The ID of the sidebar when it was added.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function unregister_sidebar( $name ) {&nbsp;</div></li><li><div>  global $wp_registered_sidebars;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  unset( $wp_registered_sidebars[ $name ] );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Checks if a sidebar is registered.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_sidebars Registered sidebars.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string|int $sidebar_id The ID of the sidebar when it was registered.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if the sidebar is registered, false otherwise.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function is_registered_sidebar( $sidebar_id ) {&nbsp;</div></li><li><div>  global $wp_registered_sidebars;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return isset( $wp_registered_sidebars[ $sidebar_id ] );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Register an instance of a widget.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The default widget option is 'classname' that can be overridden.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The function can also be used to un-register widgets when `$output_callback`</span>&nbsp;</div></li><li><div><span class="comment"> * parameter is an empty string.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widgets       Uses stored registered widgets.</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_register_widget_defaults Retrieves widget defaults.</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widget_updates</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $_wp_deprecated_widgets_callbacks</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|string $id              Widget ID.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string     $name            Widget display title.</span>&nbsp;</div></li><li><div><span class="comment"> * @param callable   $output_callback Run when widget is called.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array      $options {</span>&nbsp;</div></li><li><div><span class="comment"> *     Optional. An array of supplementary widget options for the instance.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $classname   Class name for the widget's HTML container. Default is a shortened</span>&nbsp;</div></li><li><div><span class="comment"> *                               version of the output callback name.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $description Widget description for display in the widget administration</span>&nbsp;</div></li><li><div><span class="comment"> *                               panel and/or theme.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_register_sidebar_widget( $id, $name, $output_callback, $options = array() ) {&nbsp;</div></li><li><div>  global $wp_registered_widgets, $wp_registered_widget_controls, $wp_registered_widget_updates, $_wp_deprecated_widgets_callbacks;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $id = strtolower($id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($output_callback) ) {&nbsp;</div></li><li><div>      unset($wp_registered_widgets[$id]);&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $id_base = _get_widget_id_base($id);&nbsp;</div></li><li><div>  if ( in_array($output_callback, $_wp_deprecated_widgets_callbacks, true) && !is_callable($output_callback) ) {&nbsp;</div></li><li><div>      unset( $wp_registered_widget_controls[ $id ] );&nbsp;</div></li><li><div>      unset( $wp_registered_widget_updates[ $id_base ] );&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $defaults = array('classname' =&gt; $output_callback);&nbsp;</div></li><li><div>  $options = wp_parse_args($options, $defaults);&nbsp;</div></li><li><div>  $widget = array(&nbsp;</div></li><li><div>      'name' =&gt; $name, &nbsp;</div></li><li><div>      'id' =&gt; $id, &nbsp;</div></li><li><div>      'callback' =&gt; $output_callback, &nbsp;</div></li><li><div>      'params' =&gt; array_slice(func_get_args(), 4)&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  $widget = array_merge($widget, $options);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_callable($output_callback) && ( !isset($wp_registered_widgets[$id]) || did_action( 'widgets_init' ) ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Fires once for each registered widget.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $widget An array of default widget arguments.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      do_action( 'wp_register_sidebar_widget', $widget );&nbsp;</div></li><li><div>      $wp_registered_widgets[$id] = $widget;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieve description for widget.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * When registering widgets, the options can also include 'description' that</span>&nbsp;</div></li><li><div><span class="comment"> * describes the widget for display on the widget administration panel or</span>&nbsp;</div></li><li><div><span class="comment"> * in the theme.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widgets</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|string $id Widget ID.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void Widget description, if available.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_widget_description( $id ) {&nbsp;</div></li><li><div>  if ( !is_scalar($id) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $wp_registered_widgets;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset($wp_registered_widgets[$id]['description']) )&nbsp;</div></li><li><div>      return esc_html( $wp_registered_widgets[$id]['description'] );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieve description for a sidebar.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * When registering sidebars a 'description' parameter can be included that</span>&nbsp;</div></li><li><div><span class="comment"> * describes the sidebar for display on the widget administration panel.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.9.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_sidebars</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $id sidebar ID.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|void Sidebar description, if available.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_sidebar_description( $id ) {&nbsp;</div></li><li><div>  if ( !is_scalar($id) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $wp_registered_sidebars;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset($wp_registered_sidebars[$id]['description']) )&nbsp;</div></li><li><div>      return esc_html( $wp_registered_sidebars[$id]['description'] );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Remove widget from sidebar.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|string $id Widget ID.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_unregister_sidebar_widget($id) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Fires just before a widget is removed from a sidebar.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $id The widget ID.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  do_action( 'wp_unregister_sidebar_widget', $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  wp_register_sidebar_widget($id, '', '');&nbsp;</div></li><li><div>  wp_unregister_widget_control($id);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Registers widget control callback for customizing options.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @todo `$params` parameter?</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widget_controls</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widget_updates</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widgets</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $_wp_deprecated_widgets_callbacks</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|string   $id               Sidebar ID.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string       $name             Sidebar display name.</span>&nbsp;</div></li><li><div><span class="comment"> * @param callable     $control_callback Run when sidebar is displayed.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $options {</span>&nbsp;</div></li><li><div><span class="comment"> *     Optional. Array or string of control options. Default empty array.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int        $height  Never used. Default 200.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int        $width   Width of the fully expanded control form (but try hard to use the default width).</span>&nbsp;</div></li><li><div><span class="comment"> *                               Default 250.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int|string $id_base Required for multi-widgets, i.e widgets that allow multiple instances such as the</span>&nbsp;</div></li><li><div><span class="comment"> *                               text widget. The widget id will end up looking like `{$id_base}-{$unique_number}`.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_register_widget_control( $id, $name, $control_callback, $options = array() ) {&nbsp;</div></li><li><div>  global $wp_registered_widget_controls, $wp_registered_widget_updates, $wp_registered_widgets, $_wp_deprecated_widgets_callbacks;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $id = strtolower($id);&nbsp;</div></li><li><div>  $id_base = _get_widget_id_base($id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($control_callback) ) {&nbsp;</div></li><li><div>      unset($wp_registered_widget_controls[$id]);&nbsp;</div></li><li><div>      unset($wp_registered_widget_updates[$id_base]);&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( in_array($control_callback, $_wp_deprecated_widgets_callbacks, true) && !is_callable($control_callback) ) {&nbsp;</div></li><li><div>      unset( $wp_registered_widgets[ $id ] );&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset($wp_registered_widget_controls[$id]) && !did_action( 'widgets_init' ) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $defaults = array('width' =&gt; 250, 'height' =&gt; 200 ); <span class="comment">// height is never used</span>&nbsp;</div></li><li><div>  $options = wp_parse_args($options, $defaults);&nbsp;</div></li><li><div>  $options['width'] = (int) $options['width'];&nbsp;</div></li><li><div>  $options['height'] = (int) $options['height'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $widget = array(&nbsp;</div></li><li><div>      'name' =&gt; $name, &nbsp;</div></li><li><div>      'id' =&gt; $id, &nbsp;</div></li><li><div>      'callback' =&gt; $control_callback, &nbsp;</div></li><li><div>      'params' =&gt; array_slice(func_get_args(), 4)&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  $widget = array_merge($widget, $options);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $wp_registered_widget_controls[$id] = $widget;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset($wp_registered_widget_updates[$id_base]) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset($widget['params'][0]['number']) )&nbsp;</div></li><li><div>      $widget['params'][0]['number'] = -1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  unset($widget['width'], $widget['height'], $widget['name'], $widget['id']);&nbsp;</div></li><li><div>  $wp_registered_widget_updates[$id_base] = $widget;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Registers the update callback for a widget.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widget_updates</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string   $id_base         The base ID of a widget created by extending WP_Widget.</span>&nbsp;</div></li><li><div><span class="comment"> * @param callable $update_callback Update callback method for the widget.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array    $options         Optional. Widget control options. See wp_register_widget_control().</span>&nbsp;</div></li><li><div><span class="comment"> *                                  Default empty array.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _register_widget_update_callback( $id_base, $update_callback, $options = array() ) {&nbsp;</div></li><li><div>  global $wp_registered_widget_updates;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset($wp_registered_widget_updates[$id_base]) ) {&nbsp;</div></li><li><div>      if ( empty($update_callback) )&nbsp;</div></li><li><div>          unset($wp_registered_widget_updates[$id_base]);&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $widget = array(&nbsp;</div></li><li><div>      'callback' =&gt; $update_callback, &nbsp;</div></li><li><div>      'params' =&gt; array_slice(func_get_args(), 3)&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $widget = array_merge($widget, $options);&nbsp;</div></li><li><div>  $wp_registered_widget_updates[$id_base] = $widget;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Registers the form callback for a widget.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widget_controls</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|string $id            Widget ID.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string     $name          Name attribute for the widget.</span>&nbsp;</div></li><li><div><span class="comment"> * @param callable   $form_callback Form callback.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array      $options       Optional. Widget control options. See wp_register_widget_control().</span>&nbsp;</div></li><li><div><span class="comment"> *                                  Default empty array.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _register_widget_form_callback($id, $name, $form_callback, $options = array()) {&nbsp;</div></li><li><div>  global $wp_registered_widget_controls;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $id = strtolower($id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty($form_callback) ) {&nbsp;</div></li><li><div>      unset($wp_registered_widget_controls[$id]);&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset($wp_registered_widget_controls[$id]) && !did_action( 'widgets_init' ) )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $defaults = array('width' =&gt; 250, 'height' =&gt; 200 );&nbsp;</div></li><li><div>  $options = wp_parse_args($options, $defaults);&nbsp;</div></li><li><div>  $options['width'] = (int) $options['width'];&nbsp;</div></li><li><div>  $options['height'] = (int) $options['height'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $widget = array(&nbsp;</div></li><li><div>      'name' =&gt; $name, &nbsp;</div></li><li><div>      'id' =&gt; $id, &nbsp;</div></li><li><div>      'callback' =&gt; $form_callback, &nbsp;</div></li><li><div>      'params' =&gt; array_slice(func_get_args(), 4)&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  $widget = array_merge($widget, $options);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $wp_registered_widget_controls[$id] = $widget;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Remove control callback for widget.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|string $id Widget ID.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_unregister_widget_control($id) {&nbsp;</div></li><li><div>  wp_register_widget_control( $id, '', '' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Display dynamic sidebar.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * By default this displays the default sidebar or 'sidebar-1'. If your theme specifies the 'id' or</span>&nbsp;</div></li><li><div><span class="comment"> * 'name' parameter for its registered sidebars you can pass an id or name as the $index parameter.</span>&nbsp;</div></li><li><div><span class="comment"> * Otherwise, you can pass in a numerical index to display the sidebar at that index.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_sidebars</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widgets</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|string $index Optional, default is 1. Index, name or ID of dynamic sidebar.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True, if widget sidebar was found and called. False if not found or not called.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function dynamic_sidebar( $index = 1 ) {&nbsp;</div></li><li><div>  global $wp_registered_sidebars, $wp_registered_widgets;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_int( $index ) ) {&nbsp;</div></li><li><div>      $index = &quot;sidebar-$index&quot;;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $index = sanitize_title( $index );&nbsp;</div></li><li><div>      foreach ( (array) $wp_registered_sidebars as $key =&gt; $value ) {&nbsp;</div></li><li><div>          if ( sanitize_title( $value['name'] ) == $index ) {&nbsp;</div></li><li><div>              $index = $key;&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $sidebars_widgets = wp_get_sidebars_widgets();&nbsp;</div></li><li><div>  if ( empty( $wp_registered_sidebars[ $index ] ) || empty( $sidebars_widgets[ $index ] ) || ! is_array( $sidebars_widgets[ $index ] ) ) {&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">/** This action is documented in wp-includes/widget.php */</span></span>&nbsp;</div></li><li><div>      do_action( 'dynamic_sidebar_before', $index, false );&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">/** This action is documented in wp-includes/widget.php */</span></span>&nbsp;</div></li><li><div>      do_action( 'dynamic_sidebar_after', $index, false );&nbsp;</div></li><li><div>      <span class="comment">/** This filter is documented in wp-includes/widget.php */</span>&nbsp;</div></li><li><div>      return apply_filters( 'dynamic_sidebar_has_widgets', false, $index );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Fires before widgets are rendered in a dynamic sidebar.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Note: The action also fires for empty sidebars, and on both the front end</span>&nbsp;</div></li><li><div><span class="comment">   * and back end, including the Inactive Widgets sidebar on the Widgets screen.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.9.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int|string $index       Index, name, or ID of the dynamic sidebar.</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool       $has_widgets Whether the sidebar is populated with widgets.</span>&nbsp;</div></li><li><div><span class="comment">   *                                Default true.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  do_action( 'dynamic_sidebar_before', $index, true );&nbsp;</div></li><li><div>  $sidebar = $wp_registered_sidebars[$index];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $did_one = false;&nbsp;</div></li><li><div>  foreach ( (array) $sidebars_widgets[$index] as $id ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !isset($wp_registered_widgets[$id]) ) continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $params = array_merge(&nbsp;</div></li><li><div>          array( array_merge( $sidebar, array('widget_id' =&gt; $id, 'widget_name' =&gt; $wp_registered_widgets[$id]['name']) ) ), &nbsp;</div></li><li><div>          (array) $wp_registered_widgets[$id]['params']&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Substitute HTML id and class attributes into before_widget</span>&nbsp;</div></li><li><div>      $classname_ = '';&nbsp;</div></li><li><div>      foreach ( (array) $wp_registered_widgets[$id]['classname'] as $cn ) {&nbsp;</div></li><li><div>          if ( is_string($cn) )&nbsp;</div></li><li><div>              $classname_ .= '_' . $cn;&nbsp;</div></li><li><div>          elseif ( is_object($cn) )&nbsp;</div></li><li><div>              $classname_ .= '_' . get_class($cn);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $classname_ = ltrim($classname_, '_');&nbsp;</div></li><li><div>      $params[0]['before_widget'] = sprintf($params[0]['before_widget'], $id, $classname_);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the parameters passed to a widget's display callback.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * Note: The filter is evaluated on both the front end and back end, </span>&nbsp;</div></li><li><div><span class="comment">       * including for the Inactive Widgets sidebar on the Widgets screen.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @see register_sidebar()</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $params {</span>&nbsp;</div></li><li><div><span class="comment">       *     @type array $args  {</span>&nbsp;</div></li><li><div><span class="comment">       *         An array of widget display arguments.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       *         @type string $name          Name of the sidebar the widget is assigned to.</span>&nbsp;</div></li><li><div><span class="comment">       *         @type string $id            ID of the sidebar the widget is assigned to.</span>&nbsp;</div></li><li><div><span class="comment">       *         @type string $description   The sidebar description.</span>&nbsp;</div></li><li><div><span class="comment">       *         @type string $class         CSS class applied to the sidebar container.</span>&nbsp;</div></li><li><div><span class="comment">       *         @type string $before_widget HTML markup to prepend to each widget in the sidebar.</span>&nbsp;</div></li><li><div><span class="comment">       *         @type string $after_widget  HTML markup to append to each widget in the sidebar.</span>&nbsp;</div></li><li><div><span class="comment">       *         @type string $before_title  HTML markup to prepend to the widget title when displayed.</span>&nbsp;</div></li><li><div><span class="comment">       *         @type string $after_title   HTML markup to append to the widget title when displayed.</span>&nbsp;</div></li><li><div><span class="comment">       *         @type string $widget_id     ID of the widget.</span>&nbsp;</div></li><li><div><span class="comment">       *         @type string $widget_name   Name of the widget.</span>&nbsp;</div></li><li><div><span class="comment">       *     }</span>&nbsp;</div></li><li><div><span class="comment">       *     @type array $widget_args {</span>&nbsp;</div></li><li><div><span class="comment">       *         An array of multi-widget arguments.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       *         @type int $number Number increment used for multiples of the same widget.</span>&nbsp;</div></li><li><div><span class="comment">       *     }</span>&nbsp;</div></li><li><div><span class="comment">       * }</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $params = apply_filters( 'dynamic_sidebar_params', $params );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $callback = $wp_registered_widgets[$id]['callback'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Fires before a widget's display callback is called.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * Note: The action fires on both the front end and back end, including</span>&nbsp;</div></li><li><div><span class="comment">       * for widgets in the Inactive Widgets sidebar on the Widgets screen.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * The action is not fired for empty sidebars.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $widget_id {</span>&nbsp;</div></li><li><div><span class="comment">       *     An associative array of widget arguments.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       *     @type string $name                Name of the widget.</span>&nbsp;</div></li><li><div><span class="comment">       *     @type string $id                  Widget ID.</span>&nbsp;</div></li><li><div><span class="comment">       *     @type array|callable $callback    When the hook is fired on the front end, $callback is an array</span>&nbsp;</div></li><li><div><span class="comment">       *                                       containing the widget object. Fired on the back end, $callback</span>&nbsp;</div></li><li><div><span class="comment">       *                                       is 'wp_widget_control', see $_callback.</span>&nbsp;</div></li><li><div><span class="comment">       *     @type array          $params      An associative array of multi-widget arguments.</span>&nbsp;</div></li><li><div><span class="comment">       *     @type string         $classname   CSS class applied to the widget container.</span>&nbsp;</div></li><li><div><span class="comment">       *     @type string         $description The widget description.</span>&nbsp;</div></li><li><div><span class="comment">       *     @type array          $_callback   When the hook is fired on the back end, $_callback is populated</span>&nbsp;</div></li><li><div><span class="comment">       *                                       with an array containing the widget object, see $callback.</span>&nbsp;</div></li><li><div><span class="comment">       * }</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      do_action( 'dynamic_sidebar', $wp_registered_widgets[ $id ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_callable($callback) ) {&nbsp;</div></li><li><div>          call_user_func_array($callback, $params);&nbsp;</div></li><li><div>          $did_one = true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Fires after widgets are rendered in a dynamic sidebar.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Note: The action also fires for empty sidebars, and on both the front end</span>&nbsp;</div></li><li><div><span class="comment">   * and back end, including the Inactive Widgets sidebar on the Widgets screen.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.9.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int|string $index       Index, name, or ID of the dynamic sidebar.</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool       $has_widgets Whether the sidebar is populated with widgets.</span>&nbsp;</div></li><li><div><span class="comment">   *                                Default true.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  do_action( 'dynamic_sidebar_after', $index, true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether a sidebar has widgets.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Note: The filter is also evaluated for empty sidebars, and on both the front end</span>&nbsp;</div></li><li><div><span class="comment">   * and back end, including the Inactive Widgets sidebar on the Widgets screen.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.9.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool       $did_one Whether at least one widget was rendered in the sidebar.</span>&nbsp;</div></li><li><div><span class="comment">   *                            Default false.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int|string $index   Index, name, or ID of the dynamic sidebar.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'dynamic_sidebar_has_widgets', $did_one, $index );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Whether widget is displayed on the front end.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Either $callback or $id_base can be used</span>&nbsp;</div></li><li><div><span class="comment"> * $id_base is the first argument when extending WP_Widget class</span>&nbsp;</div></li><li><div><span class="comment"> * Without the optional $widget_id parameter, returns the ID of the first sidebar</span>&nbsp;</div></li><li><div><span class="comment"> * in which the first instance of the widget with the given callback or $id_base is found.</span>&nbsp;</div></li><li><div><span class="comment"> * With the $widget_id parameter, returns the ID of the sidebar where</span>&nbsp;</div></li><li><div><span class="comment"> * the widget with that callback/$id_base AND that ID is found.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * NOTE: $widget_id and $id_base are the same for single widgets. To be effective</span>&nbsp;</div></li><li><div><span class="comment"> * this function has to run after widgets have initialized, at action {@see 'init'} or later.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widgets</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string|false $callback      Optional, Widget callback to check. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|false    $widget_id     Optional. Widget ID. Optional, but needed for checking. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string|false $id_base       Optional. The base ID of a widget created by extending WP_Widget. Default false.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool         $skip_inactive Optional. Whether to check in 'wp_inactive_widgets'. Default true.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|false False if widget is not active or id of sidebar in which the widget is active.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function is_active_widget( $callback = false, $widget_id = false, $id_base = false, $skip_inactive = true ) {&nbsp;</div></li><li><div>  global $wp_registered_widgets;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $sidebars_widgets = wp_get_sidebars_widgets();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_array($sidebars_widgets) ) {&nbsp;</div></li><li><div>      foreach ( $sidebars_widgets as $sidebar =&gt; $widgets ) {&nbsp;</div></li><li><div>          if ( $skip_inactive && ( 'wp_inactive_widgets' === $sidebar || 'orphaned_widgets' === substr( $sidebar, 0, 16 ) ) ) {&nbsp;</div></li><li><div>              continue;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( is_array($widgets) ) {&nbsp;</div></li><li><div>              foreach ( $widgets as $widget ) {&nbsp;</div></li><li><div>                  if ( ( $callback && isset($wp_registered_widgets[$widget]['callback']) && $wp_registered_widgets[$widget]['callback'] == $callback ) || ( $id_base && _get_widget_id_base($widget) == $id_base ) ) {&nbsp;</div></li><li><div>                      if ( !$widget_id || $widget_id == $wp_registered_widgets[$widget]['id'] )&nbsp;</div></li><li><div>                          return $sidebar;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Whether the dynamic sidebar is enabled and used by theme.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widgets</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_sidebars</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True, if using widgets. False, if not using widgets.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function is_dynamic_sidebar() {&nbsp;</div></li><li><div>  global $wp_registered_widgets, $wp_registered_sidebars;&nbsp;</div></li><li><div>  $sidebars_widgets = get_option('sidebars_widgets');&nbsp;</div></li><li><div>  foreach ( (array) $wp_registered_sidebars as $index =&gt; $sidebar ) {&nbsp;</div></li><li><div>      if ( ! empty( $sidebars_widgets[ $index ] ) ) {&nbsp;</div></li><li><div>          foreach ( (array) $sidebars_widgets[$index] as $widget )&nbsp;</div></li><li><div>              if ( array_key_exists($widget, $wp_registered_widgets) )&nbsp;</div></li><li><div>                  return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Whether a sidebar is in use.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string|int $index Sidebar name, id or number to check.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool true if the sidebar is in use, false otherwise.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function is_active_sidebar( $index ) {&nbsp;</div></li><li><div>  $index = ( is_int($index) ) ? &quot;sidebar-$index&quot; : sanitize_title($index);&nbsp;</div></li><li><div>  $sidebars_widgets = wp_get_sidebars_widgets();&nbsp;</div></li><li><div>  $is_active_sidebar = ! empty( $sidebars_widgets[$index] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether a dynamic sidebar is considered &quot;active&quot;.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.9.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool       $is_active_sidebar Whether or not the sidebar should be considered &quot;active&quot;.</span>&nbsp;</div></li><li><div><span class="comment">   *                                      In other words, whether the sidebar contains any widgets.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int|string $index             Index, name, or ID of the dynamic sidebar.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'is_active_sidebar', $is_active_sidebar, $index );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>// Internal Functions&nbsp;</div></li><li><div><span class="comment">//</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieve full list of sidebars and their widget instance IDs.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Will upgrade sidebar widget list, if needed. Will also save updated list, if</span>&nbsp;</div></li><li><div><span class="comment"> * needed.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $_wp_sidebars_widgets</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $sidebars_widgets</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $deprecated Not used (argument deprecated).</span>&nbsp;</div></li><li><div><span class="comment"> * @return array Upgraded list of widgets to version 3 array format when called from the admin.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_get_sidebars_widgets( $deprecated = true ) {&nbsp;</div></li><li><div>  if ( $deprecated !== true )&nbsp;</div></li><li><div>      _deprecated_argument( __FUNCTION__, '2.8.1' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $_wp_sidebars_widgets, $sidebars_widgets;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// If loading from front page, consult $_wp_sidebars_widgets rather than options</span>&nbsp;</div></li><li><div>  <span class="comment">// to see if wp_convert_widget_settings() has made manipulations in memory.</span>&nbsp;</div></li><li><div>  if ( !is_admin() ) {&nbsp;</div></li><li><div>      if ( empty($_wp_sidebars_widgets) )&nbsp;</div></li><li><div>          $_wp_sidebars_widgets = get_option('sidebars_widgets', array());&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $sidebars_widgets = $_wp_sidebars_widgets;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $sidebars_widgets = get_option('sidebars_widgets', array());&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_array( $sidebars_widgets ) && isset($sidebars_widgets['array_version']) )&nbsp;</div></li><li><div>      unset($sidebars_widgets['array_version']);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the list of sidebars and their widgets.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $sidebars_widgets An associative array of sidebars and their widgets.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'sidebars_widgets', $sidebars_widgets );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Set the sidebar widget option to update sidebars.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $sidebars_widgets Sidebar widgets and their settings.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_set_sidebars_widgets( $sidebars_widgets ) {&nbsp;</div></li><li><div>  if ( !isset( $sidebars_widgets['array_version'] ) )&nbsp;</div></li><li><div>      $sidebars_widgets['array_version'] = 3;&nbsp;</div></li><li><div>  update_option( 'sidebars_widgets', $sidebars_widgets );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieve default registered sidebars list.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_sidebars</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return array</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_get_widget_defaults() {&nbsp;</div></li><li><div>  global $wp_registered_sidebars;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $defaults = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( (array) $wp_registered_sidebars as $index =&gt; $sidebar )&nbsp;</div></li><li><div>      $defaults[$index] = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $defaults;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Convert the widget settings from single to multi-widget format.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $_wp_sidebars_widgets</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $base_name</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $option_name</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $settings</span>&nbsp;</div></li><li><div><span class="comment"> * @return array</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_convert_widget_settings($base_name, $option_name, $settings) {&nbsp;</div></li><li><div>  <span class="comment">// This test may need expanding.</span>&nbsp;</div></li><li><div>  $single = $changed = false;&nbsp;</div></li><li><div>  if ( empty($settings) ) {&nbsp;</div></li><li><div>      $single = true;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      foreach ( array_keys($settings) as $number ) {&nbsp;</div></li><li><div>          if ( 'number' == $number )&nbsp;</div></li><li><div>              continue;&nbsp;</div></li><li><div>          if ( !is_numeric($number) ) {&nbsp;</div></li><li><div>              $single = true;&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $single ) {&nbsp;</div></li><li><div>      $settings = array( 2 =&gt; $settings );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If loading from the front page, update sidebar in memory but don't save to options</span>&nbsp;</div></li><li><div>      if ( is_admin() ) {&nbsp;</div></li><li><div>          $sidebars_widgets = get_option('sidebars_widgets');&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          if ( empty($GLOBALS['_wp_sidebars_widgets']) )&nbsp;</div></li><li><div>              $GLOBALS['_wp_sidebars_widgets'] = get_option('sidebars_widgets', array());&nbsp;</div></li><li><div>          $sidebars_widgets = &$GLOBALS['_wp_sidebars_widgets'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( (array) $sidebars_widgets as $index =&gt; $sidebar ) {&nbsp;</div></li><li><div>          if ( is_array($sidebar) ) {&nbsp;</div></li><li><div>              foreach ( $sidebar as $i =&gt; $name ) {&nbsp;</div></li><li><div>                  if ( $base_name == $name ) {&nbsp;</div></li><li><div>                      $sidebars_widgets[$index][$i] = &quot;$name-2&quot;;&nbsp;</div></li><li><div>                      $changed = true;&nbsp;</div></li><li><div>                      break 2;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_admin() && $changed )&nbsp;</div></li><li><div>          update_option('sidebars_widgets', $sidebars_widgets);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $settings['_multiwidget'] = 1;&nbsp;</div></li><li><div>  if ( is_admin() )&nbsp;</div></li><li><div>      update_option( $option_name, $settings );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $settings;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output an arbitrary widget as a template tag.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Widget_Factory $wp_widget_factory</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $widget   The widget's PHP class name (see class-wp-widget.php).</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $instance Optional. The widget's instance settings. Default empty array.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     Optional. Array of arguments to configure the display of the widget.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $before_widget HTML content that will be prepended to the widget's HTML output.</span>&nbsp;</div></li><li><div><span class="comment"> *                                 Default `&lt;div class=&quot;widget %s&quot;&gt;`, where `%s` is the widget's class name.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $after_widget  HTML content that will be appended to the widget's HTML output.</span>&nbsp;</div></li><li><div><span class="comment"> *                                 Default `&lt;/div&gt;`.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $before_title  HTML content that will be prepended to the widget's title when displayed.</span>&nbsp;</div></li><li><div><span class="comment"> *                                 Default `&lt;h2 class=&quot;widgettitle&quot;&gt;`.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string $after_title   HTML content that will be appended to the widget's title when displayed.</span>&nbsp;</div></li><li><div><span class="comment"> *                                 Default `&lt;/h2&gt;`.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function the_widget( $widget, $instance = array(), $args = array() ) {&nbsp;</div></li><li><div>  global $wp_widget_factory;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $widget_obj = $wp_widget_factory-&gt;widgets[$widget];&nbsp;</div></li><li><div>  if ( ! ( $widget_obj instanceof WP_Widget ) ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $default_args = array(&nbsp;</div></li><li><div>      'before_widget' =&gt; '&lt;div class=&quot;widget %s&quot;&gt;', &nbsp;</div></li><li><div>      'after_widget' =&gt; &quot;&lt;/div&gt;&quot;, &nbsp;</div></li><li><div>      'before_title' =&gt; '&lt;h2 class=&quot;widgettitle&quot;&gt;', &nbsp;</div></li><li><div>      'after_title' =&gt; '&lt;/h2&gt;', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  $args = wp_parse_args( $args, $default_args );&nbsp;</div></li><li><div>  $args['before_widget'] = sprintf( $args['before_widget'], $widget_obj-&gt;widget_options['classname'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $instance = wp_parse_args($instance);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Fires before rendering the requested widget.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $widget   The widget's class name.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $instance The current widget instance's settings.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $args     An array of the widget's sidebar arguments.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  do_action( 'the_widget', $widget, $instance, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $widget_obj-&gt;_set(-1);&nbsp;</div></li><li><div>  $widget_obj-&gt;widget($args, $instance);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves the widget ID base value.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $id Widget ID.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Widget ID base.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _get_widget_id_base( $id ) {&nbsp;</div></li><li><div>  return preg_replace( '/-[0-9]+$/', '', $id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Handle sidebars config after theme change</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.3.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $sidebars_widgets</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _wp_sidebars_changed() {&nbsp;</div></li><li><div>  global $sidebars_widgets;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! is_array( $sidebars_widgets ) )&nbsp;</div></li><li><div>      $sidebars_widgets = wp_get_sidebars_widgets();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  retrieve_widgets(true);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Look for &quot;lost&quot; widgets, this has to run at least on each theme change.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_sidebars</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $sidebars_widgets</span>&nbsp;</div></li><li><div><span class="comment"> * @global array $wp_registered_widgets</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string|bool $theme_changed Whether the theme was changed as a boolean. A value</span>&nbsp;</div></li><li><div><span class="comment"> *                                   of 'customize' defers updates for the Customizer.</span>&nbsp;</div></li><li><div><span class="comment"> * @return array|void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function retrieve_widgets( $theme_changed = false ) {&nbsp;</div></li><li><div>  global $wp_registered_sidebars, $sidebars_widgets, $wp_registered_widgets;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $registered_sidebar_keys = array_keys( $wp_registered_sidebars );&nbsp;</div></li><li><div>  $orphaned = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $old_sidebars_widgets = get_theme_mod( 'sidebars_widgets' );&nbsp;</div></li><li><div>  if ( is_array( $old_sidebars_widgets ) ) {&nbsp;</div></li><li><div>      <span class="comment">// time() that sidebars were stored is in $old_sidebars_widgets['time']</span>&nbsp;</div></li><li><div>      $_sidebars_widgets = $old_sidebars_widgets['data'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 'customize' !== $theme_changed ) {&nbsp;</div></li><li><div>          remove_theme_mod( 'sidebars_widgets' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $_sidebars_widgets as $sidebar =&gt; $widgets ) {&nbsp;</div></li><li><div>          if ( 'wp_inactive_widgets' === $sidebar || 'orphaned_widgets' === substr( $sidebar, 0, 16 ) ) {&nbsp;</div></li><li><div>              continue;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( !in_array( $sidebar, $registered_sidebar_keys ) ) {&nbsp;</div></li><li><div>              $_sidebars_widgets['orphaned_widgets_' . ++$orphaned] = $widgets;&nbsp;</div></li><li><div>              unset( $_sidebars_widgets[$sidebar] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      if ( empty( $sidebars_widgets ) )&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      unset( $sidebars_widgets['array_version'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $old = array_keys($sidebars_widgets);&nbsp;</div></li><li><div>      sort($old);&nbsp;</div></li><li><div>      sort($registered_sidebar_keys);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $old == $registered_sidebar_keys )&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $_sidebars_widgets = array(&nbsp;</div></li><li><div>          'wp_inactive_widgets' =&gt; !empty( $sidebars_widgets['wp_inactive_widgets'] ) ? $sidebars_widgets['wp_inactive_widgets'] : array()&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      unset( $sidebars_widgets['wp_inactive_widgets'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $wp_registered_sidebars as $id =&gt; $settings ) {&nbsp;</div></li><li><div>          if ( $theme_changed ) {&nbsp;</div></li><li><div>              $_sidebars_widgets[$id] = array_shift( $sidebars_widgets );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              <span class="comment">// no theme change, grab only sidebars that are currently registered</span>&nbsp;</div></li><li><div>              if ( isset( $sidebars_widgets[$id] ) ) {&nbsp;</div></li><li><div>                  $_sidebars_widgets[$id] = $sidebars_widgets[$id];&nbsp;</div></li><li><div>                  unset( $sidebars_widgets[$id] );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $sidebars_widgets as $val ) {&nbsp;</div></li><li><div>          if ( is_array($val) && ! empty( $val ) )&nbsp;</div></li><li><div>              $_sidebars_widgets['orphaned_widgets_' . ++$orphaned] = $val;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// discard invalid, theme-specific widgets from sidebars</span>&nbsp;</div></li><li><div>  $shown_widgets = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( $_sidebars_widgets as $sidebar =&gt; $widgets ) {&nbsp;</div></li><li><div>      if ( !is_array($widgets) )&nbsp;</div></li><li><div>          continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $_widgets = array();&nbsp;</div></li><li><div>      foreach ( $widgets as $widget ) {&nbsp;</div></li><li><div>          if ( isset($wp_registered_widgets[$widget]) )&nbsp;</div></li><li><div>              $_widgets[] = $widget;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $_sidebars_widgets[$sidebar] = $_widgets;&nbsp;</div></li><li><div>      $shown_widgets = array_merge($shown_widgets, $_widgets);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $sidebars_widgets = $_sidebars_widgets;&nbsp;</div></li><li><div>  unset($_sidebars_widgets, $_widgets);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// find hidden/lost multi-widget instances</span>&nbsp;</div></li><li><div>  $lost_widgets = array();&nbsp;</div></li><li><div>  foreach ( $wp_registered_widgets as $key =&gt; $val ) {&nbsp;</div></li><li><div>      if ( in_array($key, $shown_widgets, true) )&nbsp;</div></li><li><div>          continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $number = preg_replace('/.+?-([0-9]+)$/', '$1', $key);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 2 &gt; (int) $number )&nbsp;</div></li><li><div>          continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $lost_widgets[] = $key;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $sidebars_widgets['wp_inactive_widgets'] = array_merge($lost_widgets, (array) $sidebars_widgets['wp_inactive_widgets']);&nbsp;</div></li><li><div>  if ( 'customize' !== $theme_changed ) {&nbsp;</div></li><li><div>      wp_set_sidebars_widgets( $sidebars_widgets );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $sidebars_widgets;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Display the RSS entries in a list.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string|array|object $rss RSS url.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Widget arguments.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_widget_rss_output( $rss, $args = array() ) {&nbsp;</div></li><li><div>  if ( is_string( $rss ) ) {&nbsp;</div></li><li><div>      $rss = fetch_feed($rss);&nbsp;</div></li><li><div>  } elseif ( is_array($rss) && isset($rss['url']) ) {&nbsp;</div></li><li><div>      $args = $rss;&nbsp;</div></li><li><div>      $rss = fetch_feed($rss['url']);&nbsp;</div></li><li><div>  } elseif ( !is_object($rss) ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_wp_error($rss) ) {&nbsp;</div></li><li><div>      if ( is_admin() || current_user_can('manage_options') )&nbsp;</div></li><li><div>          echo '&lt;p&gt;&lt;strong&gt;' . __( 'RSS Error:' ) . '&lt;/strong&gt; ' . $rss-&gt;get_error_message() . '&lt;/p&gt;';&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $default_args = array( 'show_author' =&gt; 0, 'show_date' =&gt; 0, 'show_summary' =&gt; 0, 'items' =&gt; 0 );&nbsp;</div></li><li><div>  $args = wp_parse_args( $args, $default_args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $items = (int) $args['items'];&nbsp;</div></li><li><div>  if ( $items &lt; 1 || 20 &lt; $items )&nbsp;</div></li><li><div>      $items = 10;&nbsp;</div></li><li><div>  $show_summary = (int) $args['show_summary'];&nbsp;</div></li><li><div>  $show_author = (int) $args['show_author'];&nbsp;</div></li><li><div>  $show_date = (int) $args['show_date'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !$rss-&gt;get_item_quantity() ) {&nbsp;</div></li><li><div>      echo '&lt;ul&gt;&lt;li&gt;' . __( 'An error has occurred, which probably means the feed is down. Try again later.' ) . '&lt;/li&gt;&lt;/ul&gt;';&nbsp;</div></li><li><div>      $rss-&gt;__destruct();&nbsp;</div></li><li><div>      unset($rss);&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo '&lt;ul&gt;';&nbsp;</div></li><li><div>  foreach ( $rss-&gt;get_items( 0, $items ) as $item ) {&nbsp;</div></li><li><div>      $link = $item-&gt;get_link();&nbsp;</div></li><li><div>      while ( stristr( $link, 'http' ) != $link ) {&nbsp;</div></li><li><div>          $link = substr( $link, 1 );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $link = esc_url( strip_tags( $link ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $title = esc_html( trim( strip_tags( $item-&gt;get_title() ) ) );&nbsp;</div></li><li><div>      if ( empty( $title ) ) {&nbsp;</div></li><li><div>          $title = __( 'Untitled' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $desc = @html_entity_decode( $item-&gt;get_description(), ENT_QUOTES, get_option( 'blog_charset' ) );&nbsp;</div></li><li><div>      $desc = esc_attr( wp_trim_words( $desc, 55, ' [&hellip;]' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $summary = '';&nbsp;</div></li><li><div>      if ( $show_summary ) {&nbsp;</div></li><li><div>          $summary = $desc;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Change existing [...] to [&hellip;].</span>&nbsp;</div></li><li><div>          if ( '[...]' == substr( $summary, -5 ) ) {&nbsp;</div></li><li><div>              $summary = substr( $summary, 0, -5 ) . '[&hellip;]';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $summary = '&lt;div class=&quot;rssSummary&quot;&gt;' . esc_html( $summary ) . '&lt;/div&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $date = '';&nbsp;</div></li><li><div>      if ( $show_date ) {&nbsp;</div></li><li><div>          $date = $item-&gt;get_date( 'U' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $date ) {&nbsp;</div></li><li><div>              $date = ' &lt;span class=&quot;rss-date&quot;&gt;' . date_i18n( get_option( 'date_format' ), $date ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $author = '';&nbsp;</div></li><li><div>      if ( $show_author ) {&nbsp;</div></li><li><div>          $author = $item-&gt;get_author();&nbsp;</div></li><li><div>          if ( is_object($author) ) {&nbsp;</div></li><li><div>              $author = $author-&gt;get_name();&nbsp;</div></li><li><div>              $author = ' &lt;cite&gt;' . esc_html( strip_tags( $author ) ) . '&lt;/cite&gt;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $link == '' ) {&nbsp;</div></li><li><div>          echo &quot;&lt;li&gt;$title{$date}{$summary}{$author}&lt;/li&gt;&quot;;&nbsp;</div></li><li><div>      } elseif ( $show_summary ) {&nbsp;</div></li><li><div>          echo &quot;&lt;li&gt;&lt;a class='rsswidget' href='$link'&gt;$title&lt;/a&gt;{$date}{$summary}{$author}&lt;/li&gt;&quot;;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          echo &quot;&lt;li&gt;&lt;a class='rsswidget' href='$link'&gt;$title&lt;/a&gt;{$date}{$author}&lt;/li&gt;&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  echo '&lt;/ul&gt;';&nbsp;</div></li><li><div>  $rss-&gt;__destruct();&nbsp;</div></li><li><div>  unset($rss);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Display RSS widget options form.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The options for what fields are displayed for the RSS form are all booleans</span>&nbsp;</div></li><li><div><span class="comment"> * and are as follows: 'url', 'title', 'items', 'show_summary', 'show_author', </span>&nbsp;</div></li><li><div><span class="comment"> * 'show_date'.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args Values for input fields.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $inputs Override default display options.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_widget_rss_form( $args, $inputs = null ) {&nbsp;</div></li><li><div>  $default_inputs = array( 'url' =&gt; true, 'title' =&gt; true, 'items' =&gt; true, 'show_summary' =&gt; true, 'show_author' =&gt; true, 'show_date' =&gt; true );&nbsp;</div></li><li><div>  $inputs = wp_parse_args( $inputs, $default_inputs );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $args['title'] = isset( $args['title'] ) ? $args['title'] : '';&nbsp;</div></li><li><div>  $args['url'] = isset( $args['url'] ) ? $args['url'] : '';&nbsp;</div></li><li><div>  $args['items'] = isset( $args['items'] ) ? (int) $args['items'] : 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $args['items'] &lt; 1 || 20 &lt; $args['items'] ) {&nbsp;</div></li><li><div>      $args['items'] = 10;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $args['show_summary'] = isset( $args['show_summary'] ) ? (int) $args['show_summary'] : (int) $inputs['show_summary'];&nbsp;</div></li><li><div>  $args['show_author'] = isset( $args['show_author'] ) ? (int) $args['show_author'] : (int) $inputs['show_author'];&nbsp;</div></li><li><div>  $args['show_date'] = isset( $args['show_date'] ) ? (int) $args['show_date'] : (int) $inputs['show_date'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $args['error'] ) ) {&nbsp;</div></li><li><div>      echo '&lt;p class=&quot;widget-error&quot;&gt;&lt;strong&gt;' . __( 'RSS Error:' ) . '&lt;/strong&gt; ' . $args['error'] . '&lt;/p&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $esc_number = esc_attr( $args['number'] );&nbsp;</div></li><li><div>  if ( $inputs['url'] ) :&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>  &lt;p&gt;&lt;label for=&quot;rss-url-&lt;?php echo $esc_number; ?&gt;&quot;&gt;&lt;?php _e( 'Enter the RSS feed URL here:' ); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>  &lt;input class=&quot;widefat&quot; id=&quot;rss-url-&lt;?php echo $esc_number; ?&gt;&quot; name=&quot;widget-rss[&lt;?php echo $esc_number; ?&gt;][url]&quot; type=&quot;text&quot; value=&quot;&lt;?php echo esc_url( $args['url'] ); ?&gt;&quot; /&gt;&lt;/p&gt;&nbsp;</div></li><li><div>&lt;?php endif; if ( $inputs['title'] ) : ?&gt;&nbsp;</div></li><li><div>  &lt;p&gt;&lt;label for=&quot;rss-title-&lt;?php echo $esc_number; ?&gt;&quot;&gt;&lt;?php _e( 'Give the feed a title (optional):' ); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>  &lt;input class=&quot;widefat&quot; id=&quot;rss-title-&lt;?php echo $esc_number; ?&gt;&quot; name=&quot;widget-rss[&lt;?php echo $esc_number; ?&gt;][title]&quot; type=&quot;text&quot; value=&quot;&lt;?php echo esc_attr( $args['title'] ); ?&gt;&quot; /&gt;&lt;/p&gt;&nbsp;</div></li><li><div>&lt;?php endif; if ( $inputs['items'] ) : ?&gt;&nbsp;</div></li><li><div>  &lt;p&gt;&lt;label for=&quot;rss-items-&lt;?php echo $esc_number; ?&gt;&quot;&gt;&lt;?php _e( 'How many items would you like to display?' ); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>  &lt;select id=&quot;rss-items-&lt;?php echo $esc_number; ?&gt;&quot; name=&quot;widget-rss[&lt;?php echo $esc_number; ?&gt;][items]&quot;&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>  for ( $i = 1; $i &lt;= 20; ++$i ) {&nbsp;</div></li><li><div>      echo &quot;&lt;option value='$i' &quot; . selected( $args['items'], $i, false ) . &quot;&gt;$i&lt;/option&gt;&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;/select&gt;&lt;/p&gt;&nbsp;</div></li><li><div>&lt;?php endif; if ( $inputs['show_summary'] ) : ?&gt;&nbsp;</div></li><li><div>  &lt;p&gt;&lt;input id=&quot;rss-show-summary-&lt;?php echo $esc_number; ?&gt;&quot; name=&quot;widget-rss[&lt;?php echo $esc_number; ?&gt;][show_summary]&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php checked( $args['show_summary'] ); ?&gt; /&gt;&nbsp;</div></li><li><div>  &lt;label for=&quot;rss-show-summary-&lt;?php echo $esc_number; ?&gt;&quot;&gt;&lt;?php _e( 'Display item content?' ); ?&gt;&lt;/label&gt;&lt;/p&gt;&nbsp;</div></li><li><div>&lt;?php endif; if ( $inputs['show_author'] ) : ?&gt;&nbsp;</div></li><li><div>  &lt;p&gt;&lt;input id=&quot;rss-show-author-&lt;?php echo $esc_number; ?&gt;&quot; name=&quot;widget-rss[&lt;?php echo $esc_number; ?&gt;][show_author]&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php checked( $args['show_author'] ); ?&gt; /&gt;&nbsp;</div></li><li><div>  &lt;label for=&quot;rss-show-author-&lt;?php echo $esc_number; ?&gt;&quot;&gt;&lt;?php _e( 'Display item author if available?' ); ?&gt;&lt;/label&gt;&lt;/p&gt;&nbsp;</div></li><li><div>&lt;?php endif; if ( $inputs['show_date'] ) : ?&gt;&nbsp;</div></li><li><div>  &lt;p&gt;&lt;input id=&quot;rss-show-date-&lt;?php echo $esc_number; ?&gt;&quot; name=&quot;widget-rss[&lt;?php echo $esc_number; ?&gt;][show_date]&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php checked( $args['show_date'] ); ?&gt;/&gt;&nbsp;</div></li><li><div>  &lt;label for=&quot;rss-show-date-&lt;?php echo $esc_number; ?&gt;&quot;&gt;&lt;?php _e( 'Display item date?' ); ?&gt;&lt;/label&gt;&lt;/p&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>  foreach ( array_keys($default_inputs) as $input ) :&nbsp;</div></li><li><div>      if ( 'hidden' === $inputs[$input] ) :&nbsp;</div></li><li><div>          $id = str_replace( '_', '-', $input );&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>  &lt;input type=&quot;hidden&quot; id=&quot;rss-&lt;?php echo esc_attr( $id ); ?&gt;-&lt;?php echo $esc_number; ?&gt;&quot; name=&quot;widget-rss[&lt;?php echo $esc_number; ?&gt;][&lt;?php echo esc_attr( $input ); ?&gt;]&quot; value=&quot;&lt;?php echo esc_attr( $args[ $input ] ); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>  endforeach;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Process RSS feed widget data and optionally retrieve feed items.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The feed widget can not have more than 20 items or it will reset back to the</span>&nbsp;</div></li><li><div><span class="comment"> * default, which is 10.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The resulting array has the feed title, feed url, feed link (from channel), </span>&nbsp;</div></li><li><div><span class="comment"> * feed items, error (if any), and whether to show summary, author, and date.</span>&nbsp;</div></li><li><div><span class="comment"> * All respectively in the order of the array elements.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $widget_rss RSS widget feed data. Expects unescaped data.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $check_feed Optional, default is true. Whether to check feed for errors.</span>&nbsp;</div></li><li><div><span class="comment"> * @return array</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_widget_rss_process( $widget_rss, $check_feed = true ) {&nbsp;</div></li><li><div>  $items = (int) $widget_rss['items'];&nbsp;</div></li><li><div>  if ( $items &lt; 1 || 20 &lt; $items )&nbsp;</div></li><li><div>      $items = 10;&nbsp;</div></li><li><div>  $url = esc_url_raw( strip_tags( $widget_rss['url'] ) );&nbsp;</div></li><li><div>  $title = isset( $widget_rss['title'] ) ? trim( strip_tags( $widget_rss['title'] ) ) : '';&nbsp;</div></li><li><div>  $show_summary = isset( $widget_rss['show_summary'] ) ? (int) $widget_rss['show_summary'] : 0;&nbsp;</div></li><li><div>  $show_author = isset( $widget_rss['show_author'] ) ? (int) $widget_rss['show_author'] :0;&nbsp;</div></li><li><div>  $show_date = isset( $widget_rss['show_date'] ) ? (int) $widget_rss['show_date'] : 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $check_feed ) {&nbsp;</div></li><li><div>      $rss = fetch_feed($url);&nbsp;</div></li><li><div>      $error = false;&nbsp;</div></li><li><div>      $link = '';&nbsp;</div></li><li><div>      if ( is_wp_error($rss) ) {&nbsp;</div></li><li><div>          $error = $rss-&gt;get_error_message();&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $link = esc_url(strip_tags($rss-&gt;get_permalink()));&nbsp;</div></li><li><div>          while ( stristr($link, 'http') != $link )&nbsp;</div></li><li><div>              $link = substr($link, 1);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $rss-&gt;__destruct();&nbsp;</div></li><li><div>          unset($rss);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return compact( 'title', 'url', 'link', 'items', 'error', 'show_summary', 'show_author', 'show_date' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Registers all of the default WordPress widgets on startup.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Calls {@see 'widgets_init'} action after all of the WordPress widgets have been registered.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_widgets_init() {&nbsp;</div></li><li><div>  if ( !is_blog_installed() )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  register_widget('WP_Widget_Pages');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  register_widget('WP_Widget_Calendar');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  register_widget('WP_Widget_Archives');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( get_option( 'link_manager_enabled' ) )&nbsp;</div></li><li><div>      register_widget('WP_Widget_Links');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  register_widget('WP_Widget_Meta');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  register_widget('WP_Widget_Search');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  register_widget('WP_Widget_Text');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  register_widget('WP_Widget_Categories');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  register_widget('WP_Widget_Recent_Posts');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  register_widget('WP_Widget_Recent_Comments');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  register_widget('WP_Widget_RSS');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  register_widget('WP_Widget_Tag_Cloud');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  register_widget('WP_Nav_Menu_Widget');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Fires after all default WordPress widgets have been registered.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  do_action( 'widgets_init' );&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>wordpress</li><li><span></span>file</li><li><span></span></li><li><span></span>wp-include</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>