<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="wordpress" data-version="4.7.4" data-type="file" data-id="4924"><head xmlns="http://www.w3.org/1999/xhtml"><title> wp-includes-rss | file | WordPress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, wordpress, 4.7.4" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.25"}};!function(e,n,t){var a;function i(e){var t=n.createElement("canvas"),a=t.getContext&&t.getContext("2d"),i=String.fromCharCode;return!(!a||!a.fillText)&&(a.textBaseline="top",a.font="600 32px Arial","flag"===e?(a.fillText(i(55356,56806,55356,56826),0,0),3e3<t.toDataURL().length):"diversity"===e?(a.fillText(i(55356,57221),0,0),t=a.getImageData(16,16,1,1).data,a.fillText(i(55356,57221,55356,57343),0,0),(t=a.getImageData(16,16,1,1).data)[0],t[1],t[2],t[3],!0):("simple"===e?a.fillText(i(55357,56835),0,0):a.fillText(i(55356,57135),0,0),0!==a.getImageData(16,16,1,1).data[0]))}function o(e){var t=n.createElement("script");t.src=e,t.type="text/javascript",n.getElementsByTagName("head")[0].appendChild(t)}t.supports={simple:i("simple"),flag:i("flag"),unicode8:i("unicode8"),diversity:i("diversity")},t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.simple&&t.supports.flag&&t.supports.unicode8&&t.supports.diversity||(a=function(){t.readyCallback()},n.addEventListener?(n.addEventListener("DOMContentLoaded",a,!1),e.addEventListener("load",a,!1)):(e.attachEvent("onload",a),n.attachEvent("onreadystatechange",function(){"complete"===n.readyState&&t.readyCallback()})),(a=t.source||{}).concatemoji?o(a.concatemoji):a.wpemoji&&a.twemoji&&(o(a.twemoji),o(a.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=e06e682f371fbc4a437fa46137fcf457' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.25' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/wp-includes-rss/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-includes-rss%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwp-includes-rss%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"wordpress-4.7.4-file-wp-includes-rss","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wp-includes-rss" class="blog single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 4.7.4." href="http://hookr.io/4.7.4/" class="H_VERSION"><span property="name">4.7.4</span></a><meta property="position" content="2"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wp-includes-rss</span><meta property="position" content="3"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="6316"><a href="http://hookr.io/4.7.4/all/" title="All">All <span class="count badge">6316</span></a></li><li class="" data-id="new" data-count="6"><a href="http://hookr.io/4.7.4/new/" title="New">New <span class="count badge">6</span></a></li><li class="" data-id="hooks" data-count="2538"><a href="http://hookr.io/4.7.4/hooks/" title="Hooks">Hooks <span class="count badge">2538</span></a></li><li class="" data-id="action" data-count="864"><a href="http://hookr.io/4.7.4/actions/" title="Actions">Actions <span class="count badge">864</span></a></li><li class="" data-id="filter" data-count="1674"><a href="http://hookr.io/4.7.4/filters/" title="Filters">Filters <span class="count badge">1674</span></a></li><li class="" data-id="class" data-count="351"><a href="http://hookr.io/4.7.4/classes/" title="Classes">Classes <span class="count badge">351</span></a></li><li class="" data-id="constant" data-count="566"><a href="http://hookr.io/4.7.4/constants/" title="Constants">Constants <span class="count badge">566</span></a></li><li class="" data-id="function" data-count="2853"><a href="http://hookr.io/4.7.4/functions/" title="Functions">Functions <span class="count badge">2853</span></a></li><li class="" data-id="shortcode" data-count="8"><a href="http://hookr.io/4.7.4/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">8</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class="active"><a href="http://hookr.io/all/" title="Core">Core</a></li><li class=""><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/wp-includes/rss.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * MagpieRSS: a simple RSS integration tool</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * A compiled file for RSS syndication</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @author Kellan Elliott-McCrea &lt;kellan@protest.net&gt;</span>&nbsp;</div></li><li><div><span class="comment"> * @version 0.51</span>&nbsp;</div></li><li><div><span class="comment"> * @license GPL</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package External</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage MagpieRSS</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated 3.0.0 Use SimplePie instead.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Deprecated. Use SimplePie (class-simplepie.php) instead.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>_deprecated_file( basename( __FILE__ ), '3.0.0', WPINC . '/class-simplepie.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Fires before MagpieRSS is loaded, to optionally replace it.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.3.0</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated 3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>do_action( 'load_feed_engine' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** RSS feed constant. */</span>&nbsp;</div></li><li><div>define('RSS', 'RSS');&nbsp;</div></li><li><div>define('ATOM', 'Atom');&nbsp;</div></li><li><div>define('MAGPIE_USER_AGENT', 'WordPress/' . $GLOBALS['wp_version']);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>class MagpieRSS {&nbsp;</div></li><li><div>  var $parser;&nbsp;</div></li><li><div>  var $current_item = array();    <span class="comment">// item currently being parsed</span>&nbsp;</div></li><li><div>  var $items = array();    <span class="comment">// collection of parsed items</span>&nbsp;</div></li><li><div>  var $channel = array();    <span class="comment">// hash of channel fields</span>&nbsp;</div></li><li><div>  var $textinput = array();&nbsp;</div></li><li><div>  var $image = array();&nbsp;</div></li><li><div>  var $feed_type;&nbsp;</div></li><li><div>  var $feed_version;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// parser variables</span>&nbsp;</div></li><li><div>  var $stack = array(); <span class="comment">// parser stack</span>&nbsp;</div></li><li><div>  var $inchannel = false;&nbsp;</div></li><li><div>  var $initem = false;&nbsp;</div></li><li><div>  var $incontent = false; <span class="comment">// if in Atom &lt;content mode=&quot;xml&quot;&gt; field</span>&nbsp;</div></li><li><div>  var $intextinput = false;&nbsp;</div></li><li><div>  var $inimage = false;&nbsp;</div></li><li><div>  var $current_field = '';&nbsp;</div></li><li><div>  var $current_namespace = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">//var $ERROR = &quot;&quot;;</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  var $_CONTENT_CONSTRUCTS = array('content', 'summary', 'info', 'title', 'tagline', 'copyright');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * PHP5 constructor.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function __construct( $source ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      # Check if PHP xml isn't compiled&nbsp;</div></li><li><div>      #&nbsp;</div></li><li><div>      if ( ! function_exists('xml_parser_create') ) {&nbsp;</div></li><li><div>          return trigger_error( &quot;PHP's XML extension is not available. Please contact your hosting provider to enable PHP's XML extension.&quot; );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $parser = xml_parser_create();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;parser = $parser;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      # pass in parser, and a reference to this object&nbsp;</div></li><li><div>      # set up handlers&nbsp;</div></li><li><div>      #&nbsp;</div></li><li><div>      xml_set_object( $this-&gt;parser, $this );&nbsp;</div></li><li><div>      xml_set_element_handler($this-&gt;parser, &nbsp;</div></li><li><div>              'feed_start_element', 'feed_end_element' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      xml_set_character_data_handler( $this-&gt;parser, 'feed_cdata' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $status = xml_parse( $this-&gt;parser, $source );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if (! $status ) {&nbsp;</div></li><li><div>          $errorcode = xml_get_error_code( $this-&gt;parser );&nbsp;</div></li><li><div>          if ( $errorcode != XML_ERROR_NONE ) {&nbsp;</div></li><li><div>              $xml_error = xml_error_string( $errorcode );&nbsp;</div></li><li><div>              $error_line = xml_get_current_line_number($this-&gt;parser);&nbsp;</div></li><li><div>              $error_col = xml_get_current_column_number($this-&gt;parser);&nbsp;</div></li><li><div>              $errormsg = &quot;$xml_error at line $error_line, column $error_col&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;error( $errormsg );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      xml_parser_free( $this-&gt;parser );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;normalize();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * PHP4 constructor.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function MagpieRSS( $source ) {&nbsp;</div></li><li><div>      self::__construct( $source );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  function feed_start_element($p, $element, &$attrs) {&nbsp;</div></li><li><div>      $el = $element = strtolower($element);&nbsp;</div></li><li><div>      $attrs = array_change_key_case($attrs, CASE_LOWER);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// check for a namespace, and split if found</span>&nbsp;</div></li><li><div>      $ns = false;&nbsp;</div></li><li><div>      if ( strpos( $element, ':' ) ) {&nbsp;</div></li><li><div>          list($ns, $el) = explode( ':', $element, 2);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if ( $ns and $ns != 'rdf' ) {&nbsp;</div></li><li><div>          $this-&gt;current_namespace = $ns;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      # if feed type isn't set, then this is first element of feed&nbsp;</div></li><li><div>      # identify feed from root element&nbsp;</div></li><li><div>      #&nbsp;</div></li><li><div>      if (!isset($this-&gt;feed_type) ) {&nbsp;</div></li><li><div>          if ( $el == 'rdf' ) {&nbsp;</div></li><li><div>              $this-&gt;feed_type = RSS;&nbsp;</div></li><li><div>              $this-&gt;feed_version = '1.0';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          elseif ( $el == 'rss' ) {&nbsp;</div></li><li><div>              $this-&gt;feed_type = RSS;&nbsp;</div></li><li><div>              $this-&gt;feed_version = $attrs['version'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          elseif ( $el == 'feed' ) {&nbsp;</div></li><li><div>              $this-&gt;feed_type = ATOM;&nbsp;</div></li><li><div>              $this-&gt;feed_version = $attrs['version'];&nbsp;</div></li><li><div>              $this-&gt;inchannel = true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $el == 'channel' )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          $this-&gt;inchannel = true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      elseif ($el == 'item' or $el == 'entry' )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          $this-&gt;initem = true;&nbsp;</div></li><li><div>          if ( isset($attrs['rdf:about']) ) {&nbsp;</div></li><li><div>              $this-&gt;current_item['about'] = $attrs['rdf:about'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// if we're in the default namespace of an RSS feed, </span>&nbsp;</div></li><li><div>      <span class="comment">//  record textinput or image fields</span>&nbsp;</div></li><li><div>      elseif (&nbsp;</div></li><li><div>          $this-&gt;feed_type == RSS and&nbsp;</div></li><li><div>          $this-&gt;current_namespace == '' and&nbsp;</div></li><li><div>          $el == 'textinput' )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          $this-&gt;intextinput = true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      elseif (&nbsp;</div></li><li><div>          $this-&gt;feed_type == RSS and&nbsp;</div></li><li><div>          $this-&gt;current_namespace == '' and&nbsp;</div></li><li><div>          $el == 'image' )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          $this-&gt;inimage = true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      # handle atom content constructs&nbsp;</div></li><li><div>      elseif ( $this-&gt;feed_type == ATOM and in_array($el, $this-&gt;_CONTENT_CONSTRUCTS) )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          <span class="comment">// avoid clashing w/ RSS mod_content</span>&nbsp;</div></li><li><div>          if ($el == 'content' ) {&nbsp;</div></li><li><div>              $el = 'atom_content';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;incontent = $el;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// if inside an Atom content construct (e.g. content or summary) field treat tags as text</span>&nbsp;</div></li><li><div>      elseif ($this-&gt;feed_type == ATOM and $this-&gt;incontent )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          <span class="comment">// if tags are inlined, then flatten</span>&nbsp;</div></li><li><div>          $attrs_str = join(' ', &nbsp;</div></li><li><div>                  array_map(array('MagpieRSS', 'map_attrs'), &nbsp;</div></li><li><div>                  array_keys($attrs), &nbsp;</div></li><li><div>                  array_values($attrs) ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;append_content( &quot;&lt;$element $attrs_str&gt;&quot; );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          array_unshift( $this-&gt;stack, $el );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Atom support many links per containging element.</span>&nbsp;</div></li><li><div>      <span class="comment">// Magpie treats link elements of type rel='alternate'</span>&nbsp;</div></li><li><div>      <span class="comment">// as being equivalent to RSS's simple link element.</span>&nbsp;</div></li><li><div>      <span class="comment">//</span>&nbsp;</div></li><li><div><span class="comment">      elseif ($this-&gt;feed_type == ATOM and $el == 'link' )</span>&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          if ( isset($attrs['rel']) and $attrs['rel'] == 'alternate' )&nbsp;</div></li><li><div>          {&nbsp;</div></li><li><div>              $link_el = 'link';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          else {&nbsp;</div></li><li><div>              $link_el = 'link_' . $attrs['rel'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;append($link_el, $attrs['href']);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      <span class="comment">// set stack[0] to current element</span>&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          array_unshift($this-&gt;stack, $el);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  function feed_cdata ($p, $text) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ($this-&gt;feed_type == ATOM and $this-&gt;incontent)&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          $this-&gt;append_content( $text );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          $current_el = join('_', array_reverse($this-&gt;stack));&nbsp;</div></li><li><div>          $this-&gt;append($current_el, $text);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  function feed_end_element ($p, $el) {&nbsp;</div></li><li><div>      $el = strtolower($el);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $el == 'item' or $el == 'entry' )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          $this-&gt;items[] = $this-&gt;current_item;&nbsp;</div></li><li><div>          $this-&gt;current_item = array();&nbsp;</div></li><li><div>          $this-&gt;initem = false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      elseif ($this-&gt;feed_type == RSS and $this-&gt;current_namespace == '' and $el == 'textinput' )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          $this-&gt;intextinput = false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      elseif ($this-&gt;feed_type == RSS and $this-&gt;current_namespace == '' and $el == 'image' )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          $this-&gt;inimage = false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      elseif ($this-&gt;feed_type == ATOM and in_array($el, $this-&gt;_CONTENT_CONSTRUCTS) )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          $this-&gt;incontent = false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      elseif ($el == 'channel' or $el == 'feed' )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          $this-&gt;inchannel = false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      elseif ($this-&gt;feed_type == ATOM and $this-&gt;incontent ) {&nbsp;</div></li><li><div>          <span class="comment">// balance tags properly</span>&nbsp;</div></li><li><div>          <span class="comment">// note: This may not actually be necessary</span>&nbsp;</div></li><li><div>          if ( $this-&gt;stack[0] == $el )&nbsp;</div></li><li><div>          {&nbsp;</div></li><li><div>              $this-&gt;append_content(&quot;&lt;/$el&gt;&quot;);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          else {&nbsp;</div></li><li><div>              $this-&gt;append_content(&quot;&lt;$el /&gt;&quot;);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          array_shift( $this-&gt;stack );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          array_shift( $this-&gt;stack );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;current_namespace = false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  function concat (&$str1, $str2=&quot;&quot;) {&nbsp;</div></li><li><div>      if (!isset($str1) ) {&nbsp;</div></li><li><div>          $str1=&quot;&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $str1 .= $str2;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  function append_content($text) {&nbsp;</div></li><li><div>      if ( $this-&gt;initem ) {&nbsp;</div></li><li><div>          $this-&gt;concat( $this-&gt;current_item[ $this-&gt;incontent ], $text );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      elseif ( $this-&gt;inchannel ) {&nbsp;</div></li><li><div>          $this-&gt;concat( $this-&gt;channel[ $this-&gt;incontent ], $text );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// smart append - field and namespace aware</span>&nbsp;</div></li><li><div>  function append($el, $text) {&nbsp;</div></li><li><div>      if (!$el) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if ( $this-&gt;current_namespace )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          if ( $this-&gt;initem ) {&nbsp;</div></li><li><div>              $this-&gt;concat(&nbsp;</div></li><li><div>                  $this-&gt;current_item[ $this-&gt;current_namespace ][ $el ], $text);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          elseif ($this-&gt;inchannel) {&nbsp;</div></li><li><div>              $this-&gt;concat(&nbsp;</div></li><li><div>                  $this-&gt;channel[ $this-&gt;current_namespace][ $el ], $text );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          elseif ($this-&gt;intextinput) {&nbsp;</div></li><li><div>              $this-&gt;concat(&nbsp;</div></li><li><div>                  $this-&gt;textinput[ $this-&gt;current_namespace][ $el ], $text );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          elseif ($this-&gt;inimage) {&nbsp;</div></li><li><div>              $this-&gt;concat(&nbsp;</div></li><li><div>                  $this-&gt;image[ $this-&gt;current_namespace ][ $el ], $text );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          if ( $this-&gt;initem ) {&nbsp;</div></li><li><div>              $this-&gt;concat(&nbsp;</div></li><li><div>                  $this-&gt;current_item[ $el ], $text);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          elseif ($this-&gt;intextinput) {&nbsp;</div></li><li><div>              $this-&gt;concat(&nbsp;</div></li><li><div>                  $this-&gt;textinput[ $el ], $text );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          elseif ($this-&gt;inimage) {&nbsp;</div></li><li><div>              $this-&gt;concat(&nbsp;</div></li><li><div>                  $this-&gt;image[ $el ], $text );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          elseif ($this-&gt;inchannel) {&nbsp;</div></li><li><div>              $this-&gt;concat(&nbsp;</div></li><li><div>                  $this-&gt;channel[ $el ], $text );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  function normalize () {&nbsp;</div></li><li><div>      <span class="comment">// if atom populate rss fields</span>&nbsp;</div></li><li><div>      if ( $this-&gt;is_atom() ) {&nbsp;</div></li><li><div>          $this-&gt;channel['descripton'] = $this-&gt;channel['tagline'];&nbsp;</div></li><li><div>          for ( $i = 0; $i &lt; count($this-&gt;items); $i++) {&nbsp;</div></li><li><div>              $item = $this-&gt;items[$i];&nbsp;</div></li><li><div>              if ( isset($item['summary']) )&nbsp;</div></li><li><div>                  $item['description'] = $item['summary'];&nbsp;</div></li><li><div>              if ( isset($item['atom_content']))&nbsp;</div></li><li><div>                  $item['content']['encoded'] = $item['atom_content'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;items[$i] = $item;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      elseif ( $this-&gt;is_rss() ) {&nbsp;</div></li><li><div>          $this-&gt;channel['tagline'] = $this-&gt;channel['description'];&nbsp;</div></li><li><div>          for ( $i = 0; $i &lt; count($this-&gt;items); $i++) {&nbsp;</div></li><li><div>              $item = $this-&gt;items[$i];&nbsp;</div></li><li><div>              if ( isset($item['description']))&nbsp;</div></li><li><div>                  $item['summary'] = $item['description'];&nbsp;</div></li><li><div>              if ( isset($item['content']['encoded'] ) )&nbsp;</div></li><li><div>                  $item['atom_content'] = $item['content']['encoded'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;items[$i] = $item;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  function is_rss () {&nbsp;</div></li><li><div>      if ( $this-&gt;feed_type == RSS ) {&nbsp;</div></li><li><div>          return $this-&gt;feed_version;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  function is_atom() {&nbsp;</div></li><li><div>      if ( $this-&gt;feed_type == ATOM ) {&nbsp;</div></li><li><div>          return $this-&gt;feed_version;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  function map_attrs($k, $v) {&nbsp;</div></li><li><div>      return &quot;$k=\&quot;$v\&quot;&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  function error( $errormsg, $lvl = E_USER_WARNING ) {&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// append PHP's error message if track_errors enabled</span></span>&nbsp;</div></li><li><div>      if ( isset($php_errormsg) ) {&nbsp;</div></li><li><div>          $errormsg .= &quot; ($php_errormsg)&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if ( MAGPIE_DEBUG ) {&nbsp;</div></li><li><div>          trigger_error( $errormsg, $lvl);&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          error_log( $errormsg, 0);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('fetch_rss') ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Build Magpie object based on RSS from URL.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> * @package External</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage MagpieRSS</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $url URL to retrieve feed</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool|MagpieRSS false on failure or MagpieRSS object on success.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function fetch_rss ($url) {&nbsp;</div></li><li><div>  <span class="comment">// initialize constants</span>&nbsp;</div></li><li><div>  init();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !isset($url) ) {&nbsp;</div></li><li><div>      <span class="comment">// error(&quot;fetch_rss called without a url&quot;);</span>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// if cache is disabled</span>&nbsp;</div></li><li><div>  if ( !MAGPIE_CACHE_ON ) {&nbsp;</div></li><li><div>      <span class="comment">// fetch file, and parse it</span>&nbsp;</div></li><li><div>      $resp = _fetch_remote_file( $url );&nbsp;</div></li><li><div>      if ( is_success( $resp-&gt;status ) ) {&nbsp;</div></li><li><div>          return _response_to_rss( $resp );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          <span class="comment">// error(&quot;Failed to fetch $url and cache is off&quot;);</span>&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  <span class="comment">// else cache is ON</span>&nbsp;</div></li><li><div>  else {&nbsp;</div></li><li><div>      <span class="comment">// Flow</span>&nbsp;</div></li><li><div>      <span class="comment">// 1. check cache</span>&nbsp;</div></li><li><div>      <span class="comment">// 2. if there is a hit, make sure it's fresh</span>&nbsp;</div></li><li><div>      <span class="comment">// 3. if cached obj fails freshness check, fetch remote</span>&nbsp;</div></li><li><div>      <span class="comment">// 4. if remote fails, return stale object, or error</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $cache = new RSSCache( MAGPIE_CACHE_DIR, MAGPIE_CACHE_AGE );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if (MAGPIE_DEBUG and $cache-&gt;ERROR) {&nbsp;</div></li><li><div>          debug($cache-&gt;ERROR, E_USER_WARNING);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $cache_status = 0;        <span class="comment">// response of check_cache</span>&nbsp;</div></li><li><div>      $request_headers = array(); <span class="comment">// HTTP headers to send with fetch</span>&nbsp;</div></li><li><div>      $rss = 0;        <span class="comment">// parsed RSS object</span>&nbsp;</div></li><li><div>      $errormsg = 0;        <span class="comment">// errors, if any</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if (!$cache-&gt;ERROR) {&nbsp;</div></li><li><div>          <span class="comment">// return cache HIT, MISS, or STALE</span>&nbsp;</div></li><li><div>          $cache_status = $cache-&gt;check_cache( $url );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// if object cached, and cache is fresh, return cached obj</span>&nbsp;</div></li><li><div>      if ( $cache_status == 'HIT' ) {&nbsp;</div></li><li><div>          $rss = $cache-&gt;get( $url );&nbsp;</div></li><li><div>          if ( isset($rss) and $rss ) {&nbsp;</div></li><li><div>              $rss-&gt;from_cache = 1;&nbsp;</div></li><li><div>              if ( MAGPIE_DEBUG &gt; 1) {&nbsp;</div></li><li><div>              debug(&quot;MagpieRSS: Cache HIT&quot;, E_USER_NOTICE);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>              return $rss;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// else attempt a conditional get</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// set up headers</span>&nbsp;</div></li><li><div>      if ( $cache_status == 'STALE' ) {&nbsp;</div></li><li><div>          $rss = $cache-&gt;get( $url );&nbsp;</div></li><li><div>          if ( isset($rss-&gt;etag) and $rss-&gt;last_modified ) {&nbsp;</div></li><li><div>              $request_headers['If-None-Match'] = $rss-&gt;etag;&nbsp;</div></li><li><div>              $request_headers['If-Last-Modified'] = $rss-&gt;last_modified;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $resp = _fetch_remote_file( $url, $request_headers );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if (isset($resp) and $resp) {&nbsp;</div></li><li><div>          if ($resp-&gt;status == '304' ) {&nbsp;</div></li><li><div>              <span class="comment">// we have the most current copy</span>&nbsp;</div></li><li><div>              if ( MAGPIE_DEBUG &gt; 1) {&nbsp;</div></li><li><div>                  debug(&quot;Got 304 for $url&quot;);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              <span class="comment">// reset cache on 304 (at minutillo insistent prodding)</span>&nbsp;</div></li><li><div>              $cache-&gt;set($url, $rss);&nbsp;</div></li><li><div>              return $rss;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          elseif ( is_success( $resp-&gt;status ) ) {&nbsp;</div></li><li><div>              $rss = _response_to_rss( $resp );&nbsp;</div></li><li><div>              if ( $rss ) {&nbsp;</div></li><li><div>                  if (MAGPIE_DEBUG &gt; 1) {&nbsp;</div></li><li><div>                      debug(&quot;Fetch successful&quot;);&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  <span class="comment">// add object to cache</span>&nbsp;</div></li><li><div>                  $cache-&gt;set( $url, $rss );&nbsp;</div></li><li><div>                  return $rss;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          else {&nbsp;</div></li><li><div>              $errormsg = &quot;Failed to fetch $url. &quot;;&nbsp;</div></li><li><div>              if ( $resp-&gt;error ) {&nbsp;</div></li><li><div>                  # compensate for Snoopy's annoying habbit to tacking&nbsp;</div></li><li><div>                  # on '\n'&nbsp;</div></li><li><div>                  $http_error = substr($resp-&gt;error, 0, -2);&nbsp;</div></li><li><div>                  $errormsg .= &quot;(HTTP Error: $http_error)&quot;;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              else {&nbsp;</div></li><li><div>                  $errormsg .=  &quot;(HTTP Response: &quot; . $resp-&gt;response_code .')';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          $errormsg = &quot;Unable to retrieve RSS file for unknown reasons.&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// else fetch failed</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// attempt to return cached object</span>&nbsp;</div></li><li><div>      if ($rss) {&nbsp;</div></li><li><div>          if ( MAGPIE_DEBUG ) {&nbsp;</div></li><li><div>              debug(&quot;Returning STALE object for $url&quot;);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $rss;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// else we totally failed</span>&nbsp;</div></li><li><div>      <span class="comment">// error( $errormsg );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } <span class="comment">// end if ( !MAGPIE_CACHE_ON ) {</span>&nbsp;</div></li><li><div>} <span class="comment">// end fetch_rss()</span>&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieve URL headers and content using WP HTTP Request API.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> * @package External</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage MagpieRSS</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $url URL to retrieve</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $headers Optional. Headers to send to the URL.</span>&nbsp;</div></li><li><div><span class="comment"> * @return Snoopy style response</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _fetch_remote_file($url, $headers = &quot;&quot; ) {&nbsp;</div></li><li><div>  $resp = wp_safe_remote_request( $url, array( 'headers' =&gt; $headers, 'timeout' =&gt; MAGPIE_FETCH_TIME_OUT ) );&nbsp;</div></li><li><div>  if ( is_wp_error($resp) ) {&nbsp;</div></li><li><div>      $error = array_shift($resp-&gt;errors);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $resp = new stdClass;&nbsp;</div></li><li><div>      $resp-&gt;status = 500;&nbsp;</div></li><li><div>      $resp-&gt;response_code = 500;&nbsp;</div></li><li><div>      $resp-&gt;error = $error[0] . &quot;\n&quot;; <span class="comment">//\n = Snoopy compatibility</span>&nbsp;</div></li><li><div>      return $resp;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Snoopy returns headers unprocessed.</span>&nbsp;</div></li><li><div>  <span class="comment">// Also note, WP_HTTP lowercases all keys, Snoopy did not.</span>&nbsp;</div></li><li><div>  $return_headers = array();&nbsp;</div></li><li><div>  foreach ( wp_remote_retrieve_headers( $resp ) as $key =&gt; $value ) {&nbsp;</div></li><li><div>      if ( !is_array($value) ) {&nbsp;</div></li><li><div>          $return_headers[] = &quot;$key: $value&quot;;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          foreach ( $value as $v )&nbsp;</div></li><li><div>              $return_headers[] = &quot;$key: $v&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $response = new stdClass;&nbsp;</div></li><li><div>  $response-&gt;status = wp_remote_retrieve_response_code( $resp );&nbsp;</div></li><li><div>  $response-&gt;response_code = wp_remote_retrieve_response_code( $resp );&nbsp;</div></li><li><div>  $response-&gt;headers = $return_headers;&nbsp;</div></li><li><div>  $response-&gt;results = wp_remote_retrieve_body( $resp );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $response;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieve</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> * @package External</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage MagpieRSS</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $resp</span>&nbsp;</div></li><li><div><span class="comment"> * @return MagpieRSS|bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _response_to_rss ($resp) {&nbsp;</div></li><li><div>  $rss = new MagpieRSS( $resp-&gt;results );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// if RSS parsed successfully</span>&nbsp;</div></li><li><div>  if ( $rss && (!isset($rss-&gt;ERROR) || !$rss-&gt;ERROR) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// find Etag, and Last-Modified</span>&nbsp;</div></li><li><div>      foreach ( (array) $resp-&gt;headers as $h) {&nbsp;</div></li><li><div>          <span class="comment">// 2003-03-02 - Nicola Asuni (www.tecnick.com) - fixed bug &quot;Undefined offset: 1&quot;</span>&nbsp;</div></li><li><div>          if (strpos($h, &quot;: &quot;)) {&nbsp;</div></li><li><div>              list($field, $val) = explode(&quot;: &quot;, $h, 2);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          else {&nbsp;</div></li><li><div>              $field = $h;&nbsp;</div></li><li><div>              $val = &quot;&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $field == 'etag' ) {&nbsp;</div></li><li><div>              $rss-&gt;etag = $val;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $field == 'last-modified' ) {&nbsp;</div></li><li><div>              $rss-&gt;last_modified = $val;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $rss;&nbsp;</div></li><li><div>  } <span class="comment">// else construct error message</span>&nbsp;</div></li><li><div>  else {&nbsp;</div></li><li><div>      $errormsg = &quot;Failed to parse RSS file.&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ($rss) {&nbsp;</div></li><li><div>          $errormsg .= &quot; (&quot; . $rss-&gt;ERROR . &quot;)&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      <span class="comment">// error($errormsg);</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  } <span class="comment">// end if ($rss and !$rss-&gt;error)</span>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Set up constants with default values, unless user overrides.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> * @package External</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage MagpieRSS</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function init () {&nbsp;</div></li><li><div>  if ( defined('MAGPIE_INITALIZED') ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  else {&nbsp;</div></li><li><div>      define('MAGPIE_INITALIZED', 1);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !defined('MAGPIE_CACHE_ON') ) {&nbsp;</div></li><li><div>      define('MAGPIE_CACHE_ON', 1);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !defined('MAGPIE_CACHE_DIR') ) {&nbsp;</div></li><li><div>      define('MAGPIE_CACHE_DIR', './cache');&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !defined('MAGPIE_CACHE_AGE') ) {&nbsp;</div></li><li><div>      define('MAGPIE_CACHE_AGE', 60*60); <span class="comment">// one hour</span>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !defined('MAGPIE_CACHE_FRESH_ONLY') ) {&nbsp;</div></li><li><div>      define('MAGPIE_CACHE_FRESH_ONLY', 0);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !defined('MAGPIE_DEBUG') ) {&nbsp;</div></li><li><div>      define('MAGPIE_DEBUG', 0);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !defined('MAGPIE_USER_AGENT') ) {&nbsp;</div></li><li><div>      $ua = 'WordPress/' . $GLOBALS['wp_version'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( MAGPIE_CACHE_ON ) {&nbsp;</div></li><li><div>          $ua = $ua . ')';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          $ua = $ua . '; No cache)';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      define('MAGPIE_USER_AGENT', $ua);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !defined('MAGPIE_FETCH_TIME_OUT') ) {&nbsp;</div></li><li><div>      define('MAGPIE_FETCH_TIME_OUT', 2);    <span class="comment">// 2 second timeout</span>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// use gzip encoding to fetch rss files if supported?</span>&nbsp;</div></li><li><div>  if ( !defined('MAGPIE_USE_GZIP') ) {&nbsp;</div></li><li><div>      define('MAGPIE_USE_GZIP', true);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function is_info ($sc) {&nbsp;</div></li><li><div>  return $sc &gt;= 100 && $sc &lt; 200;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function is_success ($sc) {&nbsp;</div></li><li><div>  return $sc &gt;= 200 && $sc &lt; 300;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function is_redirect ($sc) {&nbsp;</div></li><li><div>  return $sc &gt;= 300 && $sc &lt; 400;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function is_error ($sc) {&nbsp;</div></li><li><div>  return $sc &gt;= 400 && $sc &lt; 600;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function is_client_error ($sc) {&nbsp;</div></li><li><div>  return $sc &gt;= 400 && $sc &lt; 500;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function is_server_error ($sc) {&nbsp;</div></li><li><div>  return $sc &gt;= 500 && $sc &lt; 600;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>class RSSCache {&nbsp;</div></li><li><div>  var $BASE_CACHE;    <span class="comment">// where the cache files are stored</span>&nbsp;</div></li><li><div>  var $MAX_AGE = 43200;          <span class="comment">// when are files stale, default twelve hours</span>&nbsp;</div></li><li><div>  var $ERROR = '';            <span class="comment">// accumulate error messages</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * PHP5 constructor.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function __construct( $base = '', $age = '' ) {&nbsp;</div></li><li><div>      $this-&gt;BASE_CACHE = WP_CONTENT_DIR . '/cache';&nbsp;</div></li><li><div>      if ( $base ) {&nbsp;</div></li><li><div>          $this-&gt;BASE_CACHE = $base;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if ( $age ) {&nbsp;</div></li><li><div>          $this-&gt;MAX_AGE = $age;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * PHP4 constructor.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function RSSCache( $base = '', $age = '' ) {&nbsp;</div></li><li><div>      self::__construct( $base, $age );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**=======================================================================*\</span>&nbsp;</div></li><li><div><span class="comment">  Function:    set</span>&nbsp;</div></li><li><div><span class="comment">  Purpose:    add an item to the cache, keyed on url</span>&nbsp;</div></li><li><div><span class="comment">  Input:        url from which the rss file was fetched</span>&nbsp;</div></li><li><div><span class="comment">  Output:        true on success</span>&nbsp;</div></li><li><div><span class="comment">\*=======================================================================*/</span>&nbsp;</div></li><li><div>  function set ($url, $rss) {&nbsp;</div></li><li><div>      $cache_option = 'rss_' . $this-&gt;file_name( $url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      set_transient($cache_option, $rss, $this-&gt;MAX_AGE);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $cache_option;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**=======================================================================*\</span>&nbsp;</div></li><li><div><span class="comment">  Function:    get</span>&nbsp;</div></li><li><div><span class="comment">  Purpose:    fetch an item from the cache</span>&nbsp;</div></li><li><div><span class="comment">  Input:        url from which the rss file was fetched</span>&nbsp;</div></li><li><div><span class="comment">  Output:        cached object on HIT, false on MISS</span>&nbsp;</div></li><li><div><span class="comment">\*=======================================================================*/</span>&nbsp;</div></li><li><div>  function get ($url) {&nbsp;</div></li><li><div>      $this-&gt;ERROR = &quot;&quot;;&nbsp;</div></li><li><div>      $cache_option = 'rss_' . $this-&gt;file_name( $url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! $rss = get_transient( $cache_option ) ) {&nbsp;</div></li><li><div>          $this-&gt;debug(&nbsp;</div></li><li><div>              &quot;Cache doesn't contain: $url (cache option: $cache_option)&quot;&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          return 0;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $rss;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**=======================================================================*\</span>&nbsp;</div></li><li><div><span class="comment">  Function:    check_cache</span>&nbsp;</div></li><li><div><span class="comment">  Purpose:    check a url for membership in the cache</span>&nbsp;</div></li><li><div><span class="comment">              and whether the object is older then MAX_AGE (ie. STALE)</span>&nbsp;</div></li><li><div><span class="comment">  Input:        url from which the rss file was fetched</span>&nbsp;</div></li><li><div><span class="comment">  Output:        cached object on HIT, false on MISS</span>&nbsp;</div></li><li><div><span class="comment">\*=======================================================================*/</span>&nbsp;</div></li><li><div>  function check_cache ( $url ) {&nbsp;</div></li><li><div>      $this-&gt;ERROR = &quot;&quot;;&nbsp;</div></li><li><div>      $cache_option = 'rss_' . $this-&gt;file_name( $url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( get_transient($cache_option) ) {&nbsp;</div></li><li><div>          <span class="comment">// object exists and is current</span>&nbsp;</div></li><li><div>              return 'HIT';&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          <span class="comment">// object does not exist</span>&nbsp;</div></li><li><div>          return 'MISS';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**=======================================================================*\</span>&nbsp;</div></li><li><div><span class="comment">  Function:    serialize</span>&nbsp;</div></li><li><div><span class="comment">\*=======================================================================*/</span>&nbsp;</div></li><li><div>  function serialize ( $rss ) {&nbsp;</div></li><li><div>      return serialize( $rss );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**=======================================================================*\</span>&nbsp;</div></li><li><div><span class="comment">  Function:    unserialize</span>&nbsp;</div></li><li><div><span class="comment">\*=======================================================================*/</span>&nbsp;</div></li><li><div>  function unserialize ( $data ) {&nbsp;</div></li><li><div>      return unserialize( $data );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**=======================================================================*\</span>&nbsp;</div></li><li><div><span class="comment">  Function:    file_name</span>&nbsp;</div></li><li><div><span class="comment">  Purpose:    map url to location in cache</span>&nbsp;</div></li><li><div><span class="comment">  Input:        url from which the rss file was fetched</span>&nbsp;</div></li><li><div><span class="comment">  Output:        a file name</span>&nbsp;</div></li><li><div><span class="comment">\*=======================================================================*/</span>&nbsp;</div></li><li><div>  function file_name ($url) {&nbsp;</div></li><li><div>      return md5( $url );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**=======================================================================*\</span>&nbsp;</div></li><li><div><span class="comment">  Function:    error</span>&nbsp;</div></li><li><div><span class="comment">  Purpose:    register error</span>&nbsp;</div></li><li><div><span class="comment">\*=======================================================================*/</span>&nbsp;</div></li><li><div>  function error ($errormsg, $lvl=E_USER_WARNING) {&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// append PHP's error message if track_errors enabled</span></span>&nbsp;</div></li><li><div>      if ( isset($php_errormsg) ) {&nbsp;</div></li><li><div>          $errormsg .= &quot; ($php_errormsg)&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $this-&gt;ERROR = $errormsg;&nbsp;</div></li><li><div>      if ( MAGPIE_DEBUG ) {&nbsp;</div></li><li><div>          trigger_error( $errormsg, $lvl);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          error_log( $errormsg, 0);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>          function debug ($debugmsg, $lvl=E_USER_NOTICE) {&nbsp;</div></li><li><div>      if ( MAGPIE_DEBUG ) {&nbsp;</div></li><li><div>          $this-&gt;error(&quot;MagpieRSS [debug] $debugmsg&quot;, $lvl);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('parse_w3cdtf') ) :&nbsp;</div></li><li><div>function parse_w3cdtf ( $date_str ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  # regex to match wc3dtf&nbsp;</div></li><li><div>  $pat = &quot;/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2})(:(\d{2}))?(?:([-+])(\d{2}):?(\d{2})|(Z))?/&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( preg_match( $pat, $date_str, $match ) ) {&nbsp;</div></li><li><div>      list( $year, $month, $day, $hours, $minutes, $seconds) =&nbsp;</div></li><li><div>          array( $match[1], $match[2], $match[3], $match[4], $match[5], $match[7]);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      # calc epoch for current date assuming GMT&nbsp;</div></li><li><div>      $epoch = gmmktime( $hours, $minutes, $seconds, $month, $day, $year);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $offset = 0;&nbsp;</div></li><li><div>      if ( $match[11] == 'Z' ) {&nbsp;</div></li><li><div>          # zulu time, aka GMT&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          list( $tz_mod, $tz_hour, $tz_min ) =&nbsp;</div></li><li><div>              array( $match[8], $match[9], $match[10]);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          # zero out the variables&nbsp;</div></li><li><div>          if ( ! $tz_hour ) { $tz_hour = 0; }&nbsp;</div></li><li><div>          if ( ! $tz_min ) { $tz_min = 0; }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $offset_secs = (($tz_hour*60)+$tz_min)*60;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          # is timezone ahead of GMT?  then subtract offset&nbsp;</div></li><li><div>          #&nbsp;</div></li><li><div>          if ( $tz_mod == '+' ) {&nbsp;</div></li><li><div>              $offset_secs = $offset_secs * -1;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $offset = $offset_secs;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $epoch = $epoch + $offset;&nbsp;</div></li><li><div>      return $epoch;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  else {&nbsp;</div></li><li><div>      return -1;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wp_rss') ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Display all RSS items in a HTML ordered list.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> * @package External</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage MagpieRSS</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $url URL of feed to display. Will not auto sense feed URL.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $num_items Optional. Number of items to display, default is all.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wp_rss( $url, $num_items = -1 ) {&nbsp;</div></li><li><div>  if ( $rss = fetch_rss( $url ) ) {&nbsp;</div></li><li><div>      echo '&lt;ul&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $num_items !== -1 ) {&nbsp;</div></li><li><div>          $rss-&gt;items = array_slice( $rss-&gt;items, 0, $num_items );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( (array) $rss-&gt;items as $item ) {&nbsp;</div></li><li><div>          printf(&nbsp;</div></li><li><div>              '&lt;li&gt;&lt;a href=&quot;%1$s&quot; title=&quot;%2$s&quot;&gt;%3$s&lt;/a&gt;&lt;/li&gt;', &nbsp;</div></li><li><div>              esc_url( $item['link'] ), &nbsp;</div></li><li><div>              esc_attr( strip_tags( $item['description'] ) ), &nbsp;</div></li><li><div>              esc_html( $item['title'] )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo '&lt;/ul&gt;';&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      _e( 'An error has occurred, which probably means the feed is down. Try again later.' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('get_rss') ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Display RSS items in HTML list items.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * You have to specify which HTML list you want, either ordered or unordered</span>&nbsp;</div></li><li><div><span class="comment"> * before using the function. You also have to specify how many items you wish</span>&nbsp;</div></li><li><div><span class="comment"> * to display. You can't display all of them like you can with wp_rss()</span>&nbsp;</div></li><li><div><span class="comment"> * function.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> * @package External</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage MagpieRSS</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $url URL of feed to display. Will not auto sense feed URL.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $num_items Optional. Number of items to display, default is all.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool False on failure.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_rss ($url, $num_items = 5) { <span class="comment">// Like get posts, but for RSS</span>&nbsp;</div></li><li><div>  $rss = fetch_rss($url);&nbsp;</div></li><li><div>  if ( $rss ) {&nbsp;</div></li><li><div>      $rss-&gt;items = array_slice($rss-&gt;items, 0, $num_items);&nbsp;</div></li><li><div>      foreach ( (array) $rss-&gt;items as $item ) {&nbsp;</div></li><li><div>          echo &quot;&lt;li&gt;\n&quot;;&nbsp;</div></li><li><div>          echo &quot;&lt;a href='$item[link]' title='$item[description]'&gt;&quot;;&nbsp;</div></li><li><div>          echo esc_html($item['title']);&nbsp;</div></li><li><div>          echo &quot;&lt;/a&gt;&lt;br /&gt;\n&quot;;&nbsp;</div></li><li><div>          echo &quot;&lt;/li&gt;\n&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>endif;&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>wordpress</li><li><span></span>file</li><li><span></span></li><li><span></span>wp-include</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2021 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>