<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="3.9.5" data-slug="wp-ecommerce" data-type="file" data-id="27645"><head xmlns="http://www.w3.org/1999/xhtml"><title> wpsc-core-wpsc-deprecated | file | Wp Ecommerce | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, wp-ecommerce, 3.9.5" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.17"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=87a54e54c794f1530f34f5e7d7846b81' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.17' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/wpsc-core-wpsc-deprecated/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwpsc-core-wpsc-deprecated%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwpsc-core-wpsc-deprecated%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-wp-ecommerce-3.9.5-file-wpsc-core-wpsc-deprecated","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wpsc-core-wpsc-deprecated" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to wp-ecommerce." href="http://hookr.io/plugins/wp-ecommerce/" class="plugin"><span property="name">wp-ecommerce</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 3.9.5." href="http://hookr.io/plugins/wp-ecommerce/3.9.5/" class="H_VERSION"><span property="name">3.9.5</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/wp-ecommerce/3.9.5/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wpsc-core-wpsc-deprecated</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="4119"><a href="http://hookr.io/plugins/wp-ecommerce/3.9.5/all/" title="All">All <span class="count badge">4119</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/wp-ecommerce/3.9.5/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="836"><a href="http://hookr.io/plugins/wp-ecommerce/3.9.5/hooks/" title="Hooks">Hooks <span class="count badge">836</span></a></li><li class="" data-id="action" data-count="253"><a href="http://hookr.io/plugins/wp-ecommerce/3.9.5/actions/" title="Actions">Actions <span class="count badge">253</span></a></li><li class="" data-id="filter" data-count="583"><a href="http://hookr.io/plugins/wp-ecommerce/3.9.5/filters/" title="Filters">Filters <span class="count badge">583</span></a></li><li class="" data-id="class" data-count="581"><a href="http://hookr.io/plugins/wp-ecommerce/3.9.5/classes/" title="Classes">Classes <span class="count badge">581</span></a></li><li class="" data-id="constant" data-count="1044"><a href="http://hookr.io/plugins/wp-ecommerce/3.9.5/constants/" title="Constants">Constants <span class="count badge">1044</span></a></li><li class="" data-id="function" data-count="1652"><a href="http://hookr.io/plugins/wp-ecommerce/3.9.5/functions/" title="Functions">Functions <span class="count badge">1652</span></a></li><li class="" data-id="shortcode" data-count="6"><a href="http://hookr.io/plugins/wp-ecommerce/3.9.5/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">6</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/wpsc-core/wpsc-deprecated.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc_cart_item_custom_message()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Deprecated function for checking whether a cart item has a custom message or not</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return false</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_cart_item_custom_message() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc_merchants_modules_deprecated()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Deprecated function for merchants modules</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_merchants_modules_deprecated($nzshpcrt_gateways) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>  $nzshpcrt_gateways = apply_filters( 'wpsc_gateway_modules', $nzshpcrt_gateways );&nbsp;</div></li><li><div>  return $nzshpcrt_gateways;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * nzshpcrt_price_range()</span>&nbsp;</div></li><li><div><span class="comment"> * Deprecated</span>&nbsp;</div></li><li><div><span class="comment"> * Alias of Price Range Widget content function</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Displays a list of price ranges.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param $args (array) Arguments.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function nzshpcrt_price_range($args) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>  wpsc_price_range($args);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// preserved for backwards compatibility</span>&nbsp;</div></li><li><div>function nzshpcrt_shopping_basket( $input = null, $override_state = null ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8', 'wpsc_shopping_cart');&nbsp;</div></li><li><div>  return wpsc_shopping_cart( $input, $override_state );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Function show_cats_brands</span>&nbsp;</div></li><li><div><span class="comment"> * deprecated as we do not have brands anymore...</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function show_cats_brands($category_group = null , $display_method = null, $order_by = 'name', $image = null) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8', 'wpsc_shopping_cart');&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Filter: wpsc-purchlogitem-links-start</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This filter has been deprecated and replaced with one that follows the</span>&nbsp;</div></li><li><div><span class="comment"> * correct naming conventions with underscores.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.7.6rc2</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_purchlogitem_links_start_deprecated() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>  do_action( 'wpsc-purchlogitem-links-start' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nzshpcrt_donations($args) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>  wpsc_donations($args);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Latest Product Widget content function</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the latest products.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @todo Make this use wp_query and a theme file (if no theme file present there should be a default output).</span>&nbsp;</div></li><li><div><span class="comment"> * @todo Remove marketplace theme specific code and maybe replce with a filter for the image output? (not required if themeable as above)</span>&nbsp;</div></li><li><div><span class="comment"> * @todo Should this latest products function live in a different file, seperate to the widget logic?</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Changes made in 3.8 that may affect users:</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * 1. The product title link text does now not have a bold tag, it should be styled via css.</span>&nbsp;</div></li><li><div><span class="comment"> * 2. &lt;br /&gt; tags have been ommitted. Padding and margins should be applied via css.</span>&nbsp;</div></li><li><div><span class="comment"> * 3. Each product is enclosed in a &lt;div&gt; with a 'wpec-latest-product' class.</span>&nbsp;</div></li><li><div><span class="comment"> * 4. The product list is enclosed in a &lt;div&gt; with a 'wpec-latest-products' class.</span>&nbsp;</div></li><li><div><span class="comment"> * 5. Function now expects two arrays as per the standard Widget API.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function nzshpcrt_latest_product( $args = null, $instance ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8', 'wpsc_latest_product');&nbsp;</div></li><li><div>  echo wpsc_latest_product( $args, $instance );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * nzshpcrt_currency_display function.</span>&nbsp;</div></li><li><div><span class="comment"> * Obsolete, preserved for backwards compatibility</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @access public</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $price_in</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $tax_status</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $nohtml deprecated</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $id. deprecated</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $no_dollar_sign. (default: false)</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function nzshpcrt_currency_display($price_in, $tax_status, $nohtml = false, $id = false, $no_dollar_sign = false) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $output = wpsc_currency_display($price_in, array(&nbsp;</div></li><li><div>      'display_currency_symbol' =&gt; !(bool)$no_dollar_sign, &nbsp;</div></li><li><div>      'display_as_html' =&gt; ! (bool)$nohtml, &nbsp;</div></li><li><div>      'display_decimal_point' =&gt; true, &nbsp;</div></li><li><div>      'display_currency_code' =&gt; false&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>  return $output;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * This should be deprecated using _wpsc_deprecated_function() however the</span>&nbsp;</div></li><li><div><span class="comment"> * constants are still being used in admin-legacy.js, which is still enqueued</span>&nbsp;</div></li><li><div><span class="comment"> * by default in wp-admin.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_include_language_constants() {&nbsp;</div></li><li><div>  <span class="comment">// _wpsc_deprecated_function( __FUNCTION__, '3.8' );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if(!defined('TXT_WPSC_ABOUT_THIS_PAGE'))&nbsp;</div></li><li><div>      include_once(WPSC_FILE_PATH.'/wpsc-languages/EN_en.php');&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action('init', 'wpsc_include_language_constants');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if(!function_exists('wpsc_has_noca_message')) {&nbsp;</div></li><li><div>  function wpsc_has_noca_message() {&nbsp;</div></li><li><div>      _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>      if(isset($_SESSION['nocamsg']) && isset($_GET['noca']) && $_GET['noca'] == 'confirm')&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if(!function_exists('wpsc_is_noca_gateway')) {&nbsp;</div></li><li><div>  function wpsc_is_noca_gateway() {&nbsp;</div></li><li><div>      _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>      if(count($wpsc_gateway-&gt;wpsc_gateways) == 1 && $wpsc_gateway-&gt;wpsc_gateways[0]['name'] == 'Noca')&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc current_page</span>&nbsp;</div></li><li><div><span class="comment"> * @return (int) The current page number</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_current_page() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $wpsc_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $current_page = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $wpsc_query-&gt;query_vars['page'] &gt; 1) {&nbsp;</div></li><li><div>      $current_page = $wpsc_query-&gt;query_vars['page'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $current_page;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc showing products</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the number of page showing in the form &quot;10 to 20&quot;.</span>&nbsp;</div></li><li><div><span class="comment"> * If only on page is being display it will return the total amount of products showing.</span>&nbsp;</div></li><li><div><span class="comment"> * @return (string) Number of products showing</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_showing_products() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $wpsc_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// If we are using pages...</span>&nbsp;</div></li><li><div>  if ( ( get_option( 'use_pagination' ) == 1 ) ) {&nbsp;</div></li><li><div>      $products_per_page = $wpsc_query-&gt;query_vars['number_per_page'];&nbsp;</div></li><li><div>      if ( $wpsc_query-&gt;query_vars['page'] &gt; 0 ) {&nbsp;</div></li><li><div>          $startnum = ( $wpsc_query-&gt;query_vars['page'] - 1 ) * $products_per_page;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $startnum = 0;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return ( $startnum + 1 ) . ' to ' . ( $startnum + wpsc_product_count() );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return wpsc_total_product_count();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc showing products page</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the number of page showing in the form &quot;5 of 10&quot;.</span>&nbsp;</div></li><li><div><span class="comment"> * @return (string) Number of pages showing.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_showing_products_page() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $wpsc_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $output = $wpsc_query-&gt;page_count;&nbsp;</div></li><li><div>  $current_page = wpsc_current_page();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $current_page . ' of ' . $output;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * is wpsc profile page</span>&nbsp;</div></li><li><div><span class="comment"> * Checks if the current account page tab is Edit Profile.</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.10</span>&nbsp;</div></li><li><div><span class="comment"> * @return (boolean) true if current tab ID is edit_profile.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function is_wpsc_profile_page() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.10' );&nbsp;</div></li><li><div>  return !empty($_REQUEST['tab']) && ( $_REQUEST['tab'] == 'edit_profile' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * is wpsc profile page</span>&nbsp;</div></li><li><div><span class="comment"> * Checks if the current account page tab is Downloads.</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.10</span>&nbsp;</div></li><li><div><span class="comment"> * @return (boolean) true if current tab ID is downloads.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function is_wpsc_downloads_page() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.10' );&nbsp;</div></li><li><div>  return !empty($_REQUEST['tab']) && ( $_REQUEST['tab'] == 'downloads' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc user details</span>&nbsp;</div></li><li><div><span class="comment"> * Displays the Purchase History account page section.</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.10</span>&nbsp;</div></li><li><div><span class="comment"> * @return (string) The Purchase History page template.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_user_details() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.10' );&nbsp;</div></li><li><div>  return wpsc_user_purchases();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc product search url</span>&nbsp;</div></li><li><div><span class="comment"> * Add product_search parameter if required.</span>&nbsp;</div></li><li><div><span class="comment"> * @param $url (string) URL.</span>&nbsp;</div></li><li><div><span class="comment"> * @return (string) URL.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_product_search_url( $url ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>  if ( isset( $_GET['product_search'] ) ) {&nbsp;</div></li><li><div>      if ( strrpos( $url, '?') ) {&nbsp;</div></li><li><div>          $url .= '&product_search=' . $_GET['product_search'];&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $url .= '?product_search=' . $_GET['product_search'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $url;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc adjacent products url</span>&nbsp;</div></li><li><div><span class="comment"> * URL for the next or previous page of products on a category or group page.</span>&nbsp;</div></li><li><div><span class="comment"> * @param $n (int) Page number.</span>&nbsp;</div></li><li><div><span class="comment"> * @return (string) URL for the adjacent products page link.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_adjacent_products_url( $n ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8', 'wpsc_pagination');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc next products link</span>&nbsp;</div></li><li><div><span class="comment"> * Links to the next page of products on a category or group page.</span>&nbsp;</div></li><li><div><span class="comment"> * @param $text (string) Link text.</span>&nbsp;</div></li><li><div><span class="comment"> * @param $show_disabled (bool) Show unlinked text if last page.</span>&nbsp;</div></li><li><div><span class="comment"> * @return (string) Next page link or text.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_next_products_link( $text = 'Next', $show_disabled = false ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8', 'wpsc_pagination');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc previous products link</span>&nbsp;</div></li><li><div><span class="comment"> * Links to the previous page of products on a category or group page.</span>&nbsp;</div></li><li><div><span class="comment"> * @param $text (string) Link text.</span>&nbsp;</div></li><li><div><span class="comment"> * @param $show_disabled (bool) Show unlinked text if first page.</span>&nbsp;</div></li><li><div><span class="comment"> * @return (string) Previous page link or text.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_previous_products_link( $text = 'Previous', $show_disabled = false ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8', 'wpsc_pagination');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc first products link</span>&nbsp;</div></li><li><div><span class="comment"> * Links to the first page of products on a category or group page.</span>&nbsp;</div></li><li><div><span class="comment"> * @param $text (string) Link text.</span>&nbsp;</div></li><li><div><span class="comment"> * @param $show_disabled (bool) Show unlinked text if last page.</span>&nbsp;</div></li><li><div><span class="comment"> * @return (string) First page link or text.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_first_products_link( $text = 'First', $show_disabled = false ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8', 'wpsc_pagination');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc last products link</span>&nbsp;</div></li><li><div><span class="comment"> * Links to the last page of products on a category or group page.</span>&nbsp;</div></li><li><div><span class="comment"> * @param $text (string) Link text.</span>&nbsp;</div></li><li><div><span class="comment"> * @param $show_disabled (bool) Show unlinked text if first page.</span>&nbsp;</div></li><li><div><span class="comment"> * @return (string) Last page link or text.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_last_products_link( $text = 'Last', $show_disabled = false ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8', 'wpsc_pagination');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Saves the variation set data</span>&nbsp;</div></li><li><div><span class="comment"> * @param nothing</span>&nbsp;</div></li><li><div><span class="comment"> * @return nothing</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_save_variation_set() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc have pages function</span>&nbsp;</div></li><li><div><span class="comment"> * @return boolean - true while we have pages to loop through</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_have_pages() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8', 'wpsc_pagination');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc the page function</span>&nbsp;</div></li><li><div><span class="comment"> * @return nothing - iterate through the pages</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_the_page() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8', 'wpsc_pagination');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc page number function</span>&nbsp;</div></li><li><div><span class="comment"> * @return integer - the page number</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_page_number() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8', 'wpsc_pagination');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_ordersummary() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function display_ecomm_rss_feed() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function display_ecomm_admin_menu() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// displays error messages if the category setup is odd in some way</span>&nbsp;</div></li><li><div><span class="comment">// needs to be in a function because there are at least three places where this code must be used.</span>&nbsp;</div></li><li><div>function wpsc_odd_category_setup() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_product_image_html( $image_name, $product_id ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_delete_currency_layer() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_akst_send_mail() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_akst_hide_pop() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_akst_page() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_akst_share_link($action = 'print') {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8');&nbsp;</div></li><li><div>  if($action == 'print')&nbsp;</div></li><li><div>      echo '&lt;div class=&quot;st_sharethis&quot; displayText=&quot;ShareThis&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      return '&lt;div class=&quot;st_sharethis&quot; displayText=&quot;ShareThis&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_akst_share_form() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_has_shipping_form() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8');&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc_is_admin function.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @access public</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> * General use function for checking if user is on WPSC admin pages</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_is_admin() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8');&nbsp;</div></li><li><div>  global $pagenow;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $current_screen = get_current_screen();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if( 'post.php' == $pagenow && 'wpsc-product' == $current_screen-&gt;post_type ) return true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * used in legacy theme templates</span>&nbsp;</div></li><li><div><span class="comment"> * see http://plugins.svn.wordpress.org/wp-e-commerce/tags/3.7.8/themes/default/category_widget.php</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_print_product_list() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * count total products on a page</span>&nbsp;</div></li><li><div><span class="comment"> * see http://plugins.svn.wordpress.org/wp-e-commerce/tags/3.7.8/themes/iShop/products_page.php</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return int</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_total_product_count() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>  return wpsc_product_count();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * WPSC_Query() is deprecated in favor of WP_Query()</span>&nbsp;</div></li><li><div><span class="comment"> * Note that although we fall back to WP_Query() when WPSC_Query() is used, </span>&nbsp;</div></li><li><div><span class="comment"> * the results might not be what you expect.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>class WPSC_Query extends WP_Query {&nbsp;</div></li><li><div>  function WPSC_Query( $query = '' ) {&nbsp;</div></li><li><div>      _wpsc_deprecated_function( __FUNCTION__, '3.8', 'WP_Query()' );&nbsp;</div></li><li><div>      $query = wp_parse_args( $query );&nbsp;</div></li><li><div>      $query['post_type'] = 'wpsc-product';&nbsp;</div></li><li><div>      parent::WP_Query( $query );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpec_get_the_post_id_by_shortcode( $shortcode ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9', 'wpsc_get_the_post_id_by_shortcode' );&nbsp;</div></li><li><div>  return wpsc_get_the_post_id_by_shortcode( $shortcode );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc_update_permalinks update the product pages permalinks when WordPress permalinks are changed</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @public</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated Use _wpsc_action_permalink_structure_changed() instead.</span>&nbsp;</div></li><li><div><span class="comment"> * @3.8</span>&nbsp;</div></li><li><div><span class="comment"> * @returns nothing</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_update_permalinks( $return = '' ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9', '_wpsc_action_permalink_structure_changed' );&nbsp;</div></li><li><div>  _wpsc_action_permalink_structure_changed();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated Use _wpsc_display_permalink_refresh_notice() instead;</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_check_permalink_notice() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9', '_wpsc_display_permalink_refresh_notice' );&nbsp;</div></li><li><div>  _wpsc_display_permalink_refresh_notice();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_display_tracking_id() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> $value = wpsc_trackingid_value();&nbsp;</div></li><li><div> if(!empty($value))&nbsp;</div></li><li><div>    return $value;&nbsp;</div></li><li><div> else&nbsp;</div></li><li><div>    return __('Add New', 'wpsc');&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_the_purch_item_price() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> if ( $purchlogs-&gt;purchitem-&gt;processed &gt; 1 && $purchlogs-&gt;purchitem-&gt;processed != 6 ) {&nbsp;</div></li><li><div>    $purchlogs-&gt;totalAmount += $purchlogs-&gt;purchitem-&gt;totalprice;&nbsp;</div></li><li><div> }&nbsp;</div></li><li><div> return $purchlogs-&gt;purchitem-&gt;totalprice;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_the_purch_item_date() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> return date( 'M d Y, g:i a', $purchlogs-&gt;purchitem-&gt;date );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_the_purch_item_name() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> if ( wpsc_purchlogs_has_customfields( wpsc_the_purch_item_id() ) ) {&nbsp;</div></li><li><div>    return $purchlogs-&gt;the_purch_item_name() . '&lt;img src=&quot;' . WPSC_CORE_IMAGES_URL . '/info_icon.jpg&quot; title=&quot;' . esc_attr__( 'This Purchase has custom user content', 'wpsc' ) . '&quot; alt=&quot;' . esc_attr__( 'exclamation icon', 'wpsc' ) . '&quot; /&gt;';&nbsp;</div></li><li><div> } else {&nbsp;</div></li><li><div>    return $purchlogs-&gt;the_purch_item_name();&nbsp;</div></li><li><div> }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_the_purch_item_id() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> return $purchlogs-&gt;purchitem-&gt;id;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_the_purch_item_details() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> return $purchlogs-&gt;the_purch_item_details();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//status loop functions</span>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * status loop functions</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_have_purch_items_statuses() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> return $purchlogs-&gt;have_purch_status();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_the_purch_status() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> return $purchlogs-&gt;the_purch_status();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_purchlogs_is_google_checkout() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> if ( $purchlogs-&gt;purchitem-&gt;gateway == 'google' ) {&nbsp;</div></li><li><div>    return true;&nbsp;</div></li><li><div> } else {&nbsp;</div></li><li><div>    return false;&nbsp;</div></li><li><div> }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_the_purch_total() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> return $purchlogs-&gt;totalAmount;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_the_purch_item() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> if ( isset( $_SESSION['newlogs'] ) ) {&nbsp;</div></li><li><div>    $purchlogs-&gt;allpurchaselogs = $_SESSION['newlogs'];&nbsp;</div></li><li><div>    $purchlogs-&gt;purch_item_count = count( $_SESSION['newlogs'] );&nbsp;</div></li><li><div> }&nbsp;</div></li><li><div> return $purchlogs-&gt;the_purch_item();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_the_purch_item_statuses() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> return $purchlogs-&gt;the_purch_item_statuses();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_the_purch_item_status() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> return $purchlogs-&gt;the_purch_item_status();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_the_purch_status_id() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> return $purchlogs-&gt;purchstatus['order'];&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_purchlog_filter_by() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div>  wpsc_change_purchlog_view( $_POST['view_purchlogs_by'], $_POST['view_purchlogs_by_status'] );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_the_purch_status_name() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> if ( isset( $purchlogs-&gt;purchstatus['label'] ) ) {&nbsp;</div></li><li><div>    return $purchlogs-&gt;purchstatus['label'];&nbsp;</div></li><li><div> }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_purchlogs_getfirstdates() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> $dates = $purchlogs-&gt;getdates();&nbsp;</div></li><li><div> $fDate = '';&nbsp;</div></li><li><div> foreach ( $dates as $date ) {&nbsp;</div></li><li><div>    $is_selected = '';&nbsp;</div></li><li><div>    $cleanDate = date( 'M Y', $date['start'] );&nbsp;</div></li><li><div>    $value = $date[&quot;start&quot;] . &quot;_&quot; . $date[&quot;end&quot;];&nbsp;</div></li><li><div>    if ( $value == $_GET['view_purchlogs_by'] ) {&nbsp;</div></li><li><div>       $is_selected = 'selected=&quot;selected&quot;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    $fDate .= &quot;&lt;option value='{$value}' {$is_selected}&gt;&quot; . $cleanDate . &quot;&lt;/option&gt;&quot;;&nbsp;</div></li><li><div> }&nbsp;</div></li><li><div> return $fDate;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_change_purchlog_view( $viewby, $status='' ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> if ( $viewby == 'all' ) {&nbsp;</div></li><li><div>    $dates = $purchlogs-&gt;getdates();&nbsp;</div></li><li><div>    $purchaselogs = $purchlogs-&gt;get_purchlogs( $dates, $status );&nbsp;</div></li><li><div>    $_SESSION['newlogs'] = $purchaselogs;&nbsp;</div></li><li><div>    $purchlogs-&gt;allpurchaselogs = $purchaselogs;&nbsp;</div></li><li><div> } elseif ( $viewby == '3mnths' ) {&nbsp;</div></li><li><div>    $dates = $purchlogs-&gt;getdates();&nbsp;</div></li><li><div>    $dates = array_slice( $dates, 0, 3 );&nbsp;</div></li><li><div>    $purchlogs-&gt;current_start_timestamp = $dates[count($dates)-1]['start'];&nbsp;</div></li><li><div>    $purchlogs-&gt;current_end_timestamp = $dates[0]['end'];&nbsp;</div></li><li><div>    $newlogs = $purchlogs-&gt;get_purchlogs( $dates, $status );&nbsp;</div></li><li><div>    $_SESSION['newlogs'] = $newlogs;&nbsp;</div></li><li><div>    $purchlogs-&gt;allpurchaselogs = $newlogs;&nbsp;</div></li><li><div> } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    $dates = explode( '_', $viewby );&nbsp;</div></li><li><div>    $date[0]['start'] = $dates[0];&nbsp;</div></li><li><div>    $date[0]['end'] = $dates[1];&nbsp;</div></li><li><div>    $purchlogs-&gt;current_start_timestamp = $dates[0];&nbsp;</div></li><li><div>    $purchlogs-&gt;current_end_timestamp = $dates[1];&nbsp;</div></li><li><div>    $newlogs = $purchlogs-&gt;get_purchlogs( $date, $status );&nbsp;</div></li><li><div>    $_SESSION['newlogs'] = $newlogs;&nbsp;</div></li><li><div>    $purchlogs-&gt;allpurchaselogs = $newlogs;&nbsp;</div></li><li><div> }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_search_purchlog_view( $search ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogs;&nbsp;</div></li><li><div> $newlogs = $purchlogs-&gt;search_purchlog_view( $search );&nbsp;</div></li><li><div> $purchlogs-&gt;getDates();&nbsp;</div></li><li><div> $purchlogs-&gt;purch_item_count = count( $newlogs );&nbsp;</div></li><li><div> $purchlogs-&gt;allpurchaselogs = $newlogs;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.8. Not used in core any more.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_purchlog_is_checked_status() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8' );&nbsp;</div></li><li><div> global $purchlogitem, $purchlogs;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div> if ( $purchlogs-&gt;purchstatus['order'] == $purchlogitem-&gt;extrainfo-&gt;processed ) {&nbsp;</div></li><li><div>    return 'selected=&quot;selected&quot;';&nbsp;</div></li><li><div> } else {&nbsp;</div></li><li><div>    return '';&nbsp;</div></li><li><div> }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.9. Use _wpsc_country_dropdown_options instead.</span>&nbsp;</div></li><li><div><span class="comment"> * @param  string $selected_country ISO code of selected country</span>&nbsp;</div></li><li><div><span class="comment"> * @return string                   output</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function country_list( $selected_country = null ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9', '_wpsc_country_dropdown_options' );&nbsp;</div></li><li><div>  return _wpsc_country_dropdown_options( array( 'selected' =&gt; $selected_country ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.9. Use wpsc_get_the_product_tags() instead.</span>&nbsp;</div></li><li><div><span class="comment"> * @param  integer $id Product ID</span>&nbsp;</div></li><li><div><span class="comment"> * @return array       Product tags</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function get_the_product_tags( $id = 0 ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9', 'wpsc_get_the_product_tags' );&nbsp;</div></li><li><div>  return wpsc_get_the_product_tags( $id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc_product_rows function, copies the functionality of the wordpress code for displaying posts and pages, but is for products</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.9</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_admin_product_listing( $parent_product = null, $args = array() ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9' );&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $args ) )&nbsp;</div></li><li><div>      $args = $wp_query-&gt;query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  add_filter( 'the_title', 'esc_html' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $args = array_merge( $args, array( 'posts_per_page' =&gt; '-1' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $GLOBALS['wpsc_products'] = get_posts( $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $GLOBALS['wpsc_products'] ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;tr&gt;&nbsp;</div></li><li><div>      &lt;td colspan=&quot;8&quot;&gt;&nbsp;</div></li><li><div>          &lt;?php _e( 'You have no Variations added.', 'wpsc' ); ?&gt;&nbsp;</div></li><li><div>      &lt;/td&gt;&nbsp;</div></li><li><div>  &lt;/tr&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( (array)$GLOBALS['wpsc_products'] as $product ) {&nbsp;</div></li><li><div>      wpsc_product_row( $product, $parent_product );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Spits out the current products details in a table row for manage products page and variations on edit product page.</span>&nbsp;</div></li><li><div><span class="comment"> * @access public</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.9</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.8</span>&nbsp;</div></li><li><div><span class="comment"> * @param $product (Object), $parent_product (Int) Note: I believe parent_product is unused</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_product_row(&$product, $parent_product = null) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9' );&nbsp;</div></li><li><div>  global $mode, $current_user, $wpsc_products;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">//is this good practice? &lt;v.bakaitis@gmail.com&gt;</span>&nbsp;</div></li><li><div>  static $rowclass, $object_terms_cache = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// store terms associated with variants inside a cache array. This only requires 1 DB query.</span>&nbsp;</div></li><li><div>  if ( empty( $object_terms_cache ) ) {&nbsp;</div></li><li><div>      $ids = wp_list_pluck( $wpsc_products, 'ID' );&nbsp;</div></li><li><div>      $object_terms = wp_get_object_terms( $ids, 'wpsc-variation', array( 'fields' =&gt; 'all_with_object_id' ) );&nbsp;</div></li><li><div>      foreach ( $object_terms as $term ) {&nbsp;</div></li><li><div>          if ( ! array_key_exists( $term-&gt;object_id, $object_terms_cache ) )&nbsp;</div></li><li><div>              $object_terms_cache[$term-&gt;object_id] = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $object_terms_cache[$term-&gt;object_id][$term-&gt;parent] = $term-&gt;name;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $global_product = $product;&nbsp;</div></li><li><div>  setup_postdata($product);&nbsp;</div></li><li><div>  $product_post_type_object = get_post_type_object('wpsc-product');&nbsp;</div></li><li><div>  $current_user_can_edit_this_product = current_user_can( $product_post_type_object-&gt;cap-&gt;edit_post, $product-&gt;ID );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $rowclass = 'alternate' == $rowclass ? '' : 'alternate';&nbsp;</div></li><li><div>  $post_owner = ( $current_user-&gt;ID == $product-&gt;post_author ? 'self' : 'other' );&nbsp;</div></li><li><div>  $edit_link = get_edit_post_link( $product-&gt;ID );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $object_terms_cache[$product-&gt;ID] ) ) {&nbsp;</div></li><li><div>      ksort( $object_terms_cache[$product-&gt;ID] );&nbsp;</div></li><li><div>      $title = implode( ', ', $object_terms_cache[$product-&gt;ID] );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $title = get_the_title( $product-&gt;ID );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $title ) )&nbsp;</div></li><li><div>      $title = __( '(no title)', 'wpsc' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;tr id='post-&lt;?php echo $product-&gt;ID; ?&gt;' class='&lt;?php echo trim( $rowclass . ' author-' . $post_owner . ' status-' . $product-&gt;post_status ); ?&gt; iedit &lt;?php if ( get_option ( 'wpsc_sort_by' ) == 'dragndrop') { echo 'product-edit'; } ?&gt;' valign=&quot;top&quot;&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>  $posts_columns = get_column_headers( 'wpsc-product_variants' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if(empty($posts_columns))&nbsp;</div></li><li><div>      $posts_columns = array('image' =&gt; '', 'title' =&gt; __('Name', 'wpsc') , 'weight' =&gt; __('Weight', 'wpsc'), 'stock' =&gt; __('Stock', 'wpsc'), 'price' =&gt; __('Price', 'wpsc'), 'sale_price' =&gt; __('Sale Price', 'wpsc'), 'SKU' =&gt; __('SKU', 'wpsc'), 'hidden_alerts' =&gt; '');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( $posts_columns as $column_name=&gt;$column_display_name ) {&nbsp;</div></li><li><div>      $attributes = &quot;class=\&quot;$column_name column-$column_name\&quot;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      switch ($column_name) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  case 'date': <span class="comment">/** !date case */</span>&nbsp;</div></li><li><div>          if ( '0000-00-00 00:00:00' == $product-&gt;post_date && 'date' == $column_name ) {&nbsp;</div></li><li><div>              $t_time = $h_time = __( 'Unpublished', 'wpsc' );&nbsp;</div></li><li><div>              $time_diff = 0;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $t_time = get_the_time( __( 'Y/m/d g:i:s A', 'wpsc' ) );&nbsp;</div></li><li><div>              $m_time = $product-&gt;post_date;&nbsp;</div></li><li><div>              $time = get_post_time('G', true, $post);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $time_diff = time() - $time;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $time_diff &gt; 0 && $time_diff &lt; 24*60*60 )&nbsp;</div></li><li><div>                  $h_time = sprintf( __( '%s ago', 'wpsc' ), human_time_diff( $time ) );&nbsp;</div></li><li><div>              else&nbsp;</div></li><li><div>                  $h_time = mysql2date(__( 'Y/m/d', 'wpsc' ), $m_time);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo '&lt;td ' . $attributes . '&gt;';&nbsp;</div></li><li><div>          if ( 'excerpt' == $mode )&nbsp;</div></li><li><div>              echo apply_filters('post_date_column_time', $t_time, $post, $column_name, $mode);&nbsp;</div></li><li><div>          else&nbsp;</div></li><li><div>              echo '&lt;abbr title=&quot;' . $t_time . '&quot;&gt;' . apply_filters('post_date_column_time', $h_time, $post, $column_name, $mode) . '&lt;/abbr&gt;';&nbsp;</div></li><li><div>          echo '&lt;br /&gt;';&nbsp;</div></li><li><div>          if ( 'publish' == $product-&gt;post_status ) {&nbsp;</div></li><li><div>              _e( 'Published', 'wpsc' );&nbsp;</div></li><li><div>          } elseif ( 'future' == $product-&gt;post_status ) {&nbsp;</div></li><li><div>              if ( $time_diff &gt; 0 )&nbsp;</div></li><li><div>                  echo '&lt;strong class=&quot;attention&quot;&gt;' . __( 'Missed schedule', 'wpsc' ) . '&lt;/strong&gt;';&nbsp;</div></li><li><div>              else&nbsp;</div></li><li><div>                  _e( 'Scheduled', 'wpsc' );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              _e( 'Last Modified', 'wpsc' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          echo '&lt;/td&gt;';&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'title': <span class="comment">/** !title case */</span>&nbsp;</div></li><li><div>          $attributes = 'class=&quot;post-title column-title&quot;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $edit_link = wp_nonce_url( $edit_link, 'edit-product_'.$product-&gt;ID );&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;td &lt;?php echo $attributes ?&gt;&gt;&nbsp;</div></li><li><div>          &lt;strong&gt;&nbsp;</div></li><li><div>          &lt;?php if ( $current_user_can_edit_this_product && $product-&gt;post_status != 'trash' ) { ?&gt;&nbsp;</div></li><li><div>              &lt;span&gt;&lt;a class=&quot;row-title&quot; href=&quot;&lt;?php echo esc_url( $edit_link ); ?&gt;&quot; title=&quot;&lt;?php echo esc_attr( sprintf( __( 'Edit &#8220;%s&#8221;', 'wpsc' ), $title ) ); ?&gt;&quot;&gt;&lt;?php echo esc_html( $title ) ?&gt;&lt;/a&gt;&lt;/span&gt;&nbsp;</div></li><li><div>              &lt;?php if($parent_product): ?&gt;&nbsp;</div></li><li><div>                  &lt;a href=&quot;&lt;?php echo esc_url( $edit_link ); ?&gt;&quot; title=&quot;&lt;?php echo esc_attr( sprintf( __( 'Edit &#8220;%s&#8221;', 'wpsc' ), $title ) ); ?&gt;&quot;&gt;&lt;?php echo esc_html( $title ) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>          &lt;?php } else {&nbsp;</div></li><li><div>              echo esc_html( $title );&nbsp;</div></li><li><div>          };&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>           _post_states($product);&nbsp;</div></li><li><div>          $product_alert = apply_filters('wpsc_product_alert', array(false, ''), $product);&nbsp;</div></li><li><div>          if(!empty($product_alert['messages']))&nbsp;</div></li><li><div>              $product_alert['messages'] = implode(&quot;\n&quot;, (array)$product_alert['messages']);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if($product_alert['state'] === true) {&nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>              &lt;img alt='&lt;?php echo $product_alert['messages'];?&gt;' title='&lt;?php echo $product_alert['messages'];?&gt;' class='product-alert-image' src='&lt;?php echo  WPSC_CORE_IMAGES_URL;?&gt;/product-alert.jpg' alt='' /&gt;&nbsp;</div></li><li><div>              &lt;?php&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// If a product alert has stuff to display, show it.</span>&nbsp;</div></li><li><div>          <span class="comment">// Can be used to add extra icons etc</span>&nbsp;</div></li><li><div>          if ( !empty( $product_alert['display'] ) ) {&nbsp;</div></li><li><div>              echo $product_alert['display'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>           ?&gt;&nbsp;</div></li><li><div>          &lt;/strong&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>           $has_var = '';&nbsp;</div></li><li><div>           if(! $parent_product && wpsc_product_has_children($product-&gt;ID))&nbsp;</div></li><li><div>               $has_var = 'wpsc_has_variation';&nbsp;</div></li><li><div>          $actions = array();&nbsp;</div></li><li><div>          if ( $current_user_can_edit_this_product && 'trash' != $product-&gt;post_status ) {&nbsp;</div></li><li><div>              $actions['edit'] = '&lt;a class=&quot;edit-product&quot; href=&quot;'.$edit_link.'&quot; title=&quot;' . esc_attr__( 'Edit this product', 'wpsc' ) . '&quot;&gt;'. __( 'Edit', 'wpsc' ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>              <span class="comment">//commenting this out for now as we are trying new variation ui quick edit boxes are open by default so we dont need this link.</span>&nbsp;</div></li><li><div>              <span class="comment">//$actions['quick_edit'] = &quot;&lt;a class='wpsc_editinline &quot;.$has_var.&quot;' title='&quot;.esc_attr(__('Quick Edit', 'wpsc')).&quot;' href='#'&gt;&quot;.__('Quick Edit', 'wpsc').&quot;&lt;/a&gt;&quot;;</span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $actions = apply_filters('post_row_actions', $actions, $product);&nbsp;</div></li><li><div>          $action_count = count($actions);&nbsp;</div></li><li><div>          $i = 0;&nbsp;</div></li><li><div>          echo '&lt;div class=&quot;row-actions&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $actions as $action =&gt; $link ) {&nbsp;</div></li><li><div>              ++$i;&nbsp;</div></li><li><div>              ( $i == $action_count ) ? $sep = '' : $sep = ' | ';&nbsp;</div></li><li><div>              echo &quot;&lt;span class='$action'&gt;$link$sep&lt;/span&gt;&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo '&lt;/div&gt;';&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;/td&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'image':  <span class="comment">/** !image case */</span>&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>          &lt;td class=&quot;product-image &quot;&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>          $attachment_args = array(&nbsp;</div></li><li><div>                'post_type' =&gt; 'attachment', &nbsp;</div></li><li><div>                'numberposts' =&gt; 1, &nbsp;</div></li><li><div>                'post_status' =&gt; null, &nbsp;</div></li><li><div>                'post_parent' =&gt; $product-&gt;ID, &nbsp;</div></li><li><div>                'orderby' =&gt; 'menu_order', &nbsp;</div></li><li><div>                'order' =&gt; 'ASC'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if(isset($product-&gt;ID) && has_post_thumbnail($product-&gt;ID)) {&nbsp;</div></li><li><div>              echo get_the_post_thumbnail($product-&gt;ID, 'admin-product-thumbnails');&nbsp;</div></li><li><div>           } else {&nbsp;</div></li><li><div>                $image_url = WPSC_CORE_IMAGES_URL . &quot;/no-image-uploaded.gif&quot;;&nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>                  &lt;img title='&lt;?php esc_attr_e( 'Drag to a new position', 'wpsc' ); ?&gt;' src='&lt;?php echo esc_url( $image_url ); ?&gt;' alt='&lt;?php echo esc_attr( $title ); ?&gt;' width='38' height='38' /&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>          &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'price':  <span class="comment">/** !price case */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $price = get_product_meta($product-&gt;ID, 'price', true);&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>              &lt;td  &lt;?php echo $attributes ?&gt;&gt;&nbsp;</div></li><li><div>                  &lt;?php echo wpsc_currency_display( $price ); ?&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; class=&quot;wpsc_ie_field wpsc_ie_price&quot; value=&quot;&lt;?php echo esc_attr( $price ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                  &lt;a href=&quot;&lt;?php echo $edit_link?&gt;/#wpsc_downloads&quot;&gt;&lt;?php esc_html_e( 'Variant Download Files', 'wpsc' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'weight' :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $product_data['meta'] = array();&nbsp;</div></li><li><div>          $product_data['meta'] = get_post_meta($product-&gt;ID, '');&nbsp;</div></li><li><div>              foreach($product_data['meta'] as $meta_name =&gt; $meta_value) {&nbsp;</div></li><li><div>                  $product_data['meta'][$meta_name] = maybe_unserialize(array_pop($meta_value));&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      $product_data['transformed'] = array();&nbsp;</div></li><li><div>      if(!isset($product_data['meta']['_wpsc_product_metadata']['weight'])) $product_data['meta']['_wpsc_product_metadata']['weight'] = &quot;&quot;;&nbsp;</div></li><li><div>      if(!isset($product_data['meta']['_wpsc_product_metadata']['weight_unit'])) $product_data['meta']['_wpsc_product_metadata']['weight_unit'] = &quot;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $product_data['transformed']['weight'] = wpsc_convert_weight($product_data['meta']['_wpsc_product_metadata']['weight'], &quot;pound&quot;, $product_data['meta']['_wpsc_product_metadata']['weight_unit'], false);&nbsp;</div></li><li><div>          $weight = $product_data['transformed']['weight'];&nbsp;</div></li><li><div>          if($weight == '') {&nbsp;</div></li><li><div>              $weight = '0';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>              &lt;td  &lt;?php echo $attributes ?&gt;&gt;&nbsp;</div></li><li><div>                  &lt;span&gt;&lt;?php echo esc_html( $weight ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; class=&quot;wpsc_ie_field wpsc_ie_weight&quot; value=&quot;&lt;?php echo esc_attr( $weight ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                  &lt;a href=&quot;&lt;?php echo $edit_link?&gt;/#wpsc_tax&quot;&gt;&lt;?php esc_html_e( 'Set Variant Tax', 'wpsc' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'stock' :&nbsp;</div></li><li><div>          $stock = get_post_meta($product-&gt;ID, '_wpsc_stock', true);&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>              &lt;td  &lt;?php echo $attributes ?&gt;&gt;&nbsp;</div></li><li><div>                  &lt;span&gt;&lt;?php echo $stock ? $stock : __( 'N/A', 'wpsc' ) ; ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; class=&quot;wpsc_ie_field wpsc_ie_stock&quot; value=&quot;&lt;?php echo esc_attr( $stock ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                  &lt;a href=&quot;&lt;?php echo $edit_link?&gt;/#wpsc_shipping&quot;&gt;&lt;?php esc_html_e( 'Set Variant Shipping', 'wpsc' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'categories':  <span class="comment">/** !categories case */</span>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;td &lt;?php echo $attributes ?&gt;&gt;&lt;?php&nbsp;</div></li><li><div>          $categories = get_the_product_category($product-&gt;ID);&nbsp;</div></li><li><div>          if ( !empty( $categories ) ) {&nbsp;</div></li><li><div>              $out = array();&nbsp;</div></li><li><div>              foreach ( $categories as $c )&nbsp;</div></li><li><div>                  $out[] = &quot;&lt;a href='admin.php?page=wpsc-edit-products&amp;category={$c-&gt;slug}'&gt; &quot; . esc_html(sanitize_term_field('name', $c-&gt;name, $c-&gt;term_id, 'category', 'display')) . &quot;&lt;/a&gt;&quot;;&nbsp;</div></li><li><div>                  echo join( ', ', $out );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              esc_html_e( 'Uncategorized', 'wpsc' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'tags':  <span class="comment">/** !tags case */</span>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;td &lt;?php echo $attributes ?&gt;&gt;&lt;?php&nbsp;</div></li><li><div>          $tags = get_the_tags($product-&gt;ID);&nbsp;</div></li><li><div>          if ( !empty( $tags ) ) {&nbsp;</div></li><li><div>              $out = array();&nbsp;</div></li><li><div>              foreach ( $tags as $c )&nbsp;</div></li><li><div>                  $out[] = &quot;&lt;a href='edit.php?tag=$c-&gt;slug'&gt; &quot; . esc_html(sanitize_term_field('name', $c-&gt;name, $c-&gt;term_id, 'post_tag', 'display')) . &quot;&lt;/a&gt;&quot;;&nbsp;</div></li><li><div>              echo join( ', ', $out );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              esc_html_e( 'No Tags', 'wpsc' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>      case 'SKU':&nbsp;</div></li><li><div>          $sku = get_post_meta($product-&gt;ID, '_wpsc_sku', true);&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>              &lt;td  &lt;?php echo $attributes ?&gt;&gt;&nbsp;</div></li><li><div>                  &lt;span&gt;&lt;?php echo $sku ? $sku : esc_html__( 'N/A', 'wpsc' ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; class=&quot;wpsc_ie_field wpsc_ie_sku&quot; value=&quot;&lt;?php echo esc_attr( $sku ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                                      &lt;input type=&quot;hidden&quot; class=&quot;wpsc_ie_id wpsc_ie_field&quot; value=&quot;&lt;?php echo $product-&gt;ID ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                  &lt;div class=&quot;wpsc_inline_actions&quot;&gt;&lt;input type=&quot;button&quot; class=&quot;button-primary wpsc_ie_save&quot; value=&quot;Save&quot;&gt;&lt;img src=&quot;&lt;?php echo admin_url( 'images/wpspin_light.gif' ) ?&gt;&quot; class=&quot;loading_indicator&quot;&gt;&lt;br/&gt;&lt;/div&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>      case 'sale_price':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sale_price = get_post_meta($product-&gt;ID, '_wpsc_special_price', true);&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>              &lt;td  &lt;?php echo $attributes ?&gt;&gt;&nbsp;</div></li><li><div>                  &lt;span&gt;&lt;?php echo wpsc_currency_display( $sale_price ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; class=&quot;wpsc_ie_field wpsc_ie_special_price&quot; value=&quot;&lt;?php echo esc_attr( $sale_price ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'comments':  <span class="comment">/** !comments case */</span>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;td &lt;?php echo $attributes ?&gt;&gt;&lt;div class=&quot;post-com-count-wrapper&quot;&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>          $pending_phrase = sprintf( __( '%s pending', 'wpsc' ), number_format( $pending_comments ) );&nbsp;</div></li><li><div>          if ( $pending_comments )&nbsp;</div></li><li><div>              echo '&lt;strong&gt;';&nbsp;</div></li><li><div>              comments_number(&quot;&lt;a href='edit-comments.php?p=$product-&gt;ID' title='$pending_phrase' class='post-com-count'&gt;&lt;span class='comment-count'&gt;&quot; . <span class="comment"><span class="comment">/** translators: comment count link */</span></span> _x( '0', 'comment count', 'wpsc' ) . '&lt;/span&gt;&lt;/a&gt;', &quot;&lt;a href='edit-comments.php?p=$product-&gt;ID' title='$pending_phrase' class='post-com-count'&gt;&lt;span class='comment-count'&gt;&quot; . <span class="comment"><span class="comment">/** translators: comment count link */</span></span> _x('1', 'comment count', 'wpsc') . '&lt;/span&gt;&lt;/a&gt;', &quot;&lt;a href='edit-comments.php?p=$product-&gt;ID' title='$pending_phrase' class='post-com-count'&gt;&lt;span class='comment-count'&gt;&quot; . <span class="comment">/** translators: comment count link: % will be substituted by comment count */</span> _x('%', 'comment count', 'wpsc') . '&lt;/span&gt;&lt;/a&gt;');&nbsp;</div></li><li><div>              if ( $pending_comments )&nbsp;</div></li><li><div>              echo '&lt;/strong&gt;';&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&lt;/td&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'author':  <span class="comment">/** !author case */</span>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;td &lt;?php echo $attributes ?&gt;&gt;&lt;a href=&quot;edit.php?author=&lt;?php the_author_meta('ID'); ?&gt;&quot;&gt;&lt;?php the_author() ?&gt;&lt;/a&gt;&lt;/td&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'control_view':  <span class="comment">/** !control view case */</span>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;td&gt;&lt;a href=&quot;&lt;?php the_permalink(); ?&gt;&quot; rel=&quot;permalink&quot; class=&quot;view&quot;&gt;&lt;?php esc_html_e( 'View', 'wpsc' ); ?&gt;&lt;/a&gt;&lt;/td&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'control_edit':  <span class="comment">/** !control edit case */</span>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;td&gt;&lt;?php if ( $current_user_can_edit_this_product ) { echo &quot;&lt;a href='$edit_link' class='edit'&gt;&quot; . esc_html__( 'Edit', 'wpsc' ) . &quot;&lt;/a&gt;&quot;; } ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'control_delete':  <span class="comment">/** !control delete case */</span>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;td&gt;&lt;?php if ( $current_user_can_edit_this_product ) { echo &quot;&lt;a href='&quot; . wp_nonce_url(&quot;post.php?action=delete&amp;post=$id&quot;, 'delete-post_' . $product-&gt;ID) . &quot;' class='delete'&gt;&quot; . __( 'Delete', 'wpsc' ) . &quot;&lt;/a&gt;&quot;; } ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      case 'featured': <span class="comment">/** !control featured case */</span>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>          &lt;td&gt;&lt;?php do_action( 'manage_posts_featured_column', $product-&gt;ID ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>      default:   <span class="comment">/** !default case */</span>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;td &lt;?php echo $attributes ?&gt;&gt;&lt;?php do_action( 'manage_posts_custom_column', $column_name, $product-&gt;ID ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>  &lt;/tr&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>  $product = $global_product;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Adds the -trash status in the product row of manage products page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Gary asks      : Why do we need this?</span>&nbsp;</div></li><li><div><span class="comment"> * Justin answers : We don't.  Deprecate?</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @access public</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.9</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.8</span>&nbsp;</div></li><li><div><span class="comment"> * @param $post_status (array) of current posts statuses</span>&nbsp;</div></li><li><div><span class="comment"> * @return $post_status (array)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_trashed_post_status($post_status) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9' );&nbsp;</div></li><li><div>  $post = get_post(get_the_ID());&nbsp;</div></li><li><div>  if( !empty($post) && 'wpsc-product' == $post-&gt;post_type && 'trash' == $post-&gt;post_status && !in_array('trash', $post_status))&nbsp;</div></li><li><div>      $post_status[] = 'Trash';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $post_status;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_product_label_forms() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_convert_weights($weight, $unit) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8', 'wpsc_convert_weight' );&nbsp;</div></li><li><div>  if (is_array($weight)) {&nbsp;</div></li><li><div>      $weight = $weight['weight'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return wpsc_convert_weight( $weight, $unit, 'gram', true );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc in the loop function, </span>&nbsp;</div></li><li><div><span class="comment"> * @return boolean - true if we are in the loop</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_in_the_loop() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>  global $wpsc_query;&nbsp;</div></li><li><div>  return $wpsc_query-&gt;in_the_loop;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc rewind products function, rewinds back to the first product</span>&nbsp;</div></li><li><div><span class="comment"> * @return nothing</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_rewind_products() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>  global $wpsc_query;&nbsp;</div></li><li><div>  return $wpsc_query-&gt;rewind_posts();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc product has file function</span>&nbsp;</div></li><li><div><span class="comment"> * @return boolean - true if the product has a file</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_product_has_file() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>  global $wpsc_query, $wpdb;&nbsp;</div></li><li><div>  if ( is_numeric( $wpsc_query-&gt;product['file'] ) && ($wpsc_query-&gt;product['file'] &gt; 0) )&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc currency sign function</span>&nbsp;</div></li><li><div><span class="comment"> * @return string - the selected currency sign for the store</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_currency_sign() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>  global $wpdb;&nbsp;</div></li><li><div>  $currency_sign_location = get_option( 'currency_sign_location' );&nbsp;</div></li><li><div>  $currency_type = get_option( 'currency_type' );&nbsp;</div></li><li><div>  $currency_symbol = $wpdb-&gt;get_var( $wpdb-&gt;prepare( &quot;SELECT `symbol_html` FROM `&quot; . WPSC_TABLE_CURRENCY_LIST . &quot;` WHERE `id` = %d LIMIT 1&quot;, $currency_type ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $currency_symbol;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc page is selected function</span>&nbsp;</div></li><li><div><span class="comment"> * @return boolean - true if the page is selected</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_page_is_selected() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>  <span class="comment">// determine if we are on this page</span>&nbsp;</div></li><li><div>  global $wpsc_query;&nbsp;</div></li><li><div>  return $wpsc_query-&gt;page['selected'];&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc page URL function</span>&nbsp;</div></li><li><div><span class="comment"> * @return string - the page URL</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_page_url() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8' );&nbsp;</div></li><li><div>  <span class="comment">// generate the page URL</span>&nbsp;</div></li><li><div>  global $wpsc_query;&nbsp;</div></li><li><div>  return $wpsc_query-&gt;page['url'];&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function shipwire_build_xml( $log_id ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9', 'WPSC_Shipwire' );&nbsp;</div></li><li><div>  return WPSC_Shipwire::get_order_xml( $log_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function shipwire_built_sync_xml() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9', 'WPSC_Shipwire' );&nbsp;</div></li><li><div>  return WPSC_Shipwire::get_inventory_xml();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function shipwire_built_tracking_xml() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9', 'WPSC_Shipwire' );&nbsp;</div></li><li><div>  return WPSC_Shipwire::get_tracking_xml();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function shipwire_send_sync_request( $xml ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9', 'WPSC_Shipwire' );&nbsp;</div></li><li><div>  return WPSC_Shipwire::send_inventory_request( $xml );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function shipwire_sent_request( $xml ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9', 'WPSC_Shipwire' );&nbsp;</div></li><li><div>  return WPSC_Shipwire::send_order_request( $xml );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function shipwire_send_tracking_request( $xml ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9', 'WPSC_Shipwire' );&nbsp;</div></li><li><div>  return WPSC_Shipwire::send_tracking_request( $xml );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_rage_where( $where ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.8', 'wpsc_range_where()' );&nbsp;</div></li><li><div>  return wpsc_range_where( $where );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * WPSC Product Variation Price Available</span>&nbsp;</div></li><li><div><span class="comment"> * Gets the formatted lowest price of a product's available variations.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param  $product_id         (int)     Product ID</span>&nbsp;</div></li><li><div><span class="comment"> * @param  $from_text          (string)  From text with price placeholder eg. 'from %s'</span>&nbsp;</div></li><li><div><span class="comment"> * @param  $only_normal_price  (bool)    Don't show sale price</span>&nbsp;</div></li><li><div><span class="comment"> * @return                     (string)  Number formatted price</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses   wpsc_product_variation_price_from()</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_product_variation_price_available( $product_id, $from_text = false, $only_normal_price = false ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.10', 'wpsc_product_variation_price_from()' );&nbsp;</div></li><li><div>  $args = array(&nbsp;</div></li><li><div>      'from_text' =&gt; $from_text, &nbsp;</div></li><li><div>      'only_normal_price' =&gt; $only_normal_price, &nbsp;</div></li><li><div>      'only_in_stock' =&gt; true&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  return wpsc_product_variation_price_from( $product_id, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Deprecated function</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated 3.8.9</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_post_title_seo( $title ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.9' );&nbsp;</div></li><li><div>  global $wpdb, $page_id, $wp_query;&nbsp;</div></li><li><div>  $new_title = wpsc_obtain_the_title();&nbsp;</div></li><li><div>  if ( $new_title != '' ) {&nbsp;</div></li><li><div>      $title = $new_title;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return esc_html( $title );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_product_image_forms() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $post;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  edit_multiple_image_gallery( $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;p&gt;&lt;strong &lt;?php if ( isset( $display ) ) echo $display; ?&gt;&gt;&lt;a href=&quot;media-upload.php?parent_page=wpsc-edit-products&amp;post_id=&lt;?php echo $post-&gt;ID; ?&gt;&amp;type=image&amp;tab=gallery&amp;TB_iframe=1&amp;width=640&amp;height=566&quot; class=&quot;thickbox&quot; title=&quot;&lt;?php esc_attr_e( 'Manage Product Images', 'wpsc' ); ?&gt;&quot;&gt;&lt;?php esc_html_e( 'Manage Product Images', 'wpsc' ); ?&gt;&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function edit_multiple_image_gallery( $post ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Make sure thumbnail isn't duplicated</span>&nbsp;</div></li><li><div>  if ( $post-&gt;ID &gt; 0 ) {&nbsp;</div></li><li><div>      if ( has_post_thumbnail( $post-&gt;ID ) )&nbsp;</div></li><li><div>          echo get_the_post_thumbnail( $post-&gt;ID, 'admin-product-thumbnails' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $args = array(&nbsp;</div></li><li><div>          'post_type' =&gt; 'attachment', &nbsp;</div></li><li><div>          'numberposts' =&gt; -1, &nbsp;</div></li><li><div>          'post_status' =&gt; null, &nbsp;</div></li><li><div>          'post_parent' =&gt; $post-&gt;ID, &nbsp;</div></li><li><div>          'orderby' =&gt; 'menu_order', &nbsp;</div></li><li><div>          'order' =&gt; 'ASC'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $attached_images = (array)get_posts( $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( count( $attached_images ) &gt; 0 ) {&nbsp;</div></li><li><div>          foreach ( $attached_images as $images ) {&nbsp;</div></li><li><div>              $attached_image = wp_get_attachment_image( $images-&gt;ID, 'admin-product-thumbnails' );&nbsp;</div></li><li><div>              echo $attached_image. '&nbsp;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_media_upload_tab_gallery( $tabs ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  unset( $tabs['gallery'] );&nbsp;</div></li><li><div>  $tabs['gallery'] = __( 'Product Image Gallery', 'wpsc' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $tabs;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_media_upload_url( $form_action_url ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $form_action_url = esc_url( add_query_arg( array( 'parent_page'=&gt;'wpsc-edit-products' ) ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $form_action_url;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_gallery_css_mods() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  print '&lt;style type=&quot;text/css&quot;&gt;&nbsp;</div></li><li><div>          #gallery-settings *{&nbsp;</div></li><li><div>          display:none;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          a.wp-post-thumbnail {&nbsp;</div></li><li><div>                  color:green;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          #media-upload a.del-link {&nbsp;</div></li><li><div>              color:red;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          #media-upload a.wp-post-thumbnail {&nbsp;</div></li><li><div>              margin-left:0px;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          td.savesend input.button {&nbsp;</div></li><li><div>              display:none;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>  &lt;/style&gt;';&nbsp;</div></li><li><div>  print '&nbsp;</div></li><li><div>  &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>  jQuery(function() {&nbsp;</div></li><li><div>      jQuery(&quot;td.A1B1&quot;).each(function() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          var target = jQuery(this).next();&nbsp;</div></li><li><div>              jQuery(&quot;p &gt; input.button&quot;, this).appendTo(target);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      });&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      jQuery(&quot;a.wp-post-thumbnail&quot;).each(function() {&nbsp;</div></li><li><div>          var product_image = jQuery(this).text();&nbsp;</div></li><li><div>          if (product_image == &quot;' . __( 'Use as featured image' ) . '&quot;) {&nbsp;</div></li><li><div>              jQuery(this).text(&quot;' . __( 'Use as Product Thumbnail', 'wpsc' ) . '&quot;);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      });&nbsp;</div></li><li><div>  });&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;/script&gt;';&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_filter_delete_text( $translation, $text, $domain ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'Delete' == $text && isset( $_REQUEST['post_id'] ) && isset( $_REQUEST['parent_page'] ) ) {&nbsp;</div></li><li><div>      $translations = &get_translations_for_domain( $domain );&nbsp;</div></li><li><div>      return $translations-&gt;translate( 'Trash' ) ;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return $translation;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * This filter translates string before it is displayed</span>&nbsp;</div></li><li><div><span class="comment"> * specifically for the words 'Use as featured image' with 'Use as Product Thumbnail' when the user is selecting a Product Thumbnail</span>&nbsp;</div></li><li><div><span class="comment"> * using media gallery.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @todo As this feature is entirely cosmetic and breaks with WP_DEBUG on in WP 3.5+, we've removed the filter for it.  Will revisit the functionality in 3.9 when we look at new media workflows.</span>&nbsp;</div></li><li><div><span class="comment"> * @param $translation The current translation</span>&nbsp;</div></li><li><div><span class="comment"> * @param $text The text being translated</span>&nbsp;</div></li><li><div><span class="comment"> * @param $domain The domain for the translation</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The translated / filtered text.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_filter_feature_image_text( $translation, $text, $domain ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13' );&nbsp;</div></li><li><div>  if ( 'Use as featured image' == $text && isset( $_REQUEST['post_id'] ) ) {&nbsp;</div></li><li><div>      $post = get_post( $_REQUEST['post_id'] );&nbsp;</div></li><li><div>      if ( $post-&gt;post_type != 'wpsc-product' ) return $translation;&nbsp;</div></li><li><div>      $translations = &get_translations_for_domain( $domain );&nbsp;</div></li><li><div>      return $translations-&gt;translate( 'Use as Product Thumbnail', 'wpsc' );&nbsp;</div></li><li><div>      <span class="comment">//this will never happen, this is here only for gettexr to pick up the translation</span>&nbsp;</div></li><li><div>      return __( 'Use as Product Thumbnail', 'wpsc' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $translation;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_display_invoice() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! wpsc_is_store_admin() ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $purchase_id = (int)$_REQUEST['purchaselog_id'];&nbsp;</div></li><li><div>  add_action('wpsc_packing_slip', 'wpsc_packing_slip');&nbsp;</div></li><li><div>  do_action('wpsc_before_packing_slip', $purchase_id);&nbsp;</div></li><li><div>  do_action('wpsc_packing_slip', $purchase_id);&nbsp;</div></li><li><div>  exit();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_packing_slip( $purchase_id ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13' );&nbsp;</div></li><li><div>  echo &quot;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;meta http-equiv=\&quot;content-type\&quot; content=\&quot;text-html; charset=utf-8\&quot;&gt;&lt;head&gt;&lt;title&gt;&quot; . __( 'Packing Slip', 'wpsc' ) . &quot;&lt;/title&gt;&lt;/head&gt;&lt;body id='wpsc-packing-slip'&gt;&quot;;&nbsp;</div></li><li><div>  global $wpdb;&nbsp;</div></li><li><div>  $purch_sql = $wpdb-&gt;prepare( &quot;SELECT * FROM `&quot;.WPSC_TABLE_PURCHASE_LOGS.&quot;` WHERE `id`=%d&quot;, $purchase_id );&nbsp;</div></li><li><div>  $purch_data = $wpdb-&gt;get_row( $purch_sql, ARRAY_A ) ;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $cartsql = $wpdb-&gt;prepare( &quot;SELECT * FROM `&quot;.WPSC_TABLE_CART_CONTENTS.&quot;` WHERE `purchaseid`=%d&quot;, $purchase_id );&nbsp;</div></li><li><div>  $cart_log = $wpdb-&gt;get_results($cartsql, ARRAY_A) ;&nbsp;</div></li><li><div>  $j = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if($cart_log != null) {&nbsp;</div></li><li><div>      echo &quot;&lt;div class='packing_slip'&gt;\n\r&quot;;&nbsp;</div></li><li><div>      echo apply_filters( 'wpsc_packing_slip_header', '&lt;h2&gt;' . esc_html__( 'Packing Slip', 'wpsc' ) . &quot;&lt;/h2&gt;\n\r&quot; );&nbsp;</div></li><li><div>      echo &quot;&lt;strong&gt;&quot;. esc_html__( 'Order', 'wpsc' ).&quot; #&lt;/strong&gt; &quot;.$purchase_id.&quot;&lt;br /&gt;&lt;br /&gt;\n\r&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo &quot;&lt;table&gt;\n\r&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $form_sql = $wpdb-&gt;prepare( &quot;SELECT * FROM `&quot;.WPSC_TABLE_SUBMITTED_FORM_DATA.&quot;` WHERE `log_id` = %d&quot;, $purchase_id );&nbsp;</div></li><li><div>      $input_data = $wpdb-&gt;get_results($form_sql, ARRAY_A);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach($input_data as $input_row) {&nbsp;</div></li><li><div>          $rekeyed_input[$input_row['form_id']] = $input_row;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if($input_data != null) {&nbsp;</div></li><li><div>          $form_data = $wpdb-&gt;get_results( &quot;SELECT * FROM `&quot;.WPSC_TABLE_CHECKOUT_FORMS.&quot;` WHERE `active` = '1' ORDER BY `checkout_order`&quot; , ARRAY_A );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach($form_data as $form_field) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              switch($form_field['type']) {&nbsp;</div></li><li><div>                  case 'country':&nbsp;</div></li><li><div>                      $region_count_sql = $wpdb-&gt;prepare( &quot;SELECT COUNT(`regions`.`id`) FROM `&quot;.WPSC_TABLE_REGION_TAX.&quot;` AS `regions` INNER JOIN `&quot;.WPSC_TABLE_CURRENCY_LIST.&quot;` AS `country` ON `country`.`id` = `regions`.`country_id` WHERE `country`.`isocode` IN('%s')&quot;, $purch_data['billing_country'] );&nbsp;</div></li><li><div>                      $delivery_region_count = $wpdb-&gt;get_var( $region_count_sql );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if(is_numeric($purch_data['billing_region']) && ($delivery_region_count &gt; 0))&nbsp;</div></li><li><div>                          echo &quot;    &lt;tr&gt;&lt;td&gt;&quot;.esc_html__('State', 'wpsc').&quot;:&lt;/td&gt;&lt;td&gt;&quot;.wpsc_get_region($purch_data['billing_region']).&quot;&lt;/td&gt;&lt;/tr&gt;\n\r&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                       echo &quot;    &lt;tr&gt;&lt;td&gt;&quot; . esc_html( $form_field['name'] ) . &quot;:&lt;/td&gt;&lt;td&gt;&quot; . esc_html(  $rekeyed_input[$form_field['id']]['value'] ) . &quot;&lt;/td&gt;&lt;/tr&gt;\n\r&quot;;&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  case 'delivery_country':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if(is_numeric($purch_data['shipping_region']) && ($delivery_region_count &gt; 0))&nbsp;</div></li><li><div>                          echo &quot;    &lt;tr&gt;&lt;td&gt;&quot;.esc_html__('State', 'wpsc').&quot;:&lt;/td&gt;&lt;td&gt;&quot;.wpsc_get_region($purch_data['shipping_region']).&quot;&lt;/td&gt;&lt;/tr&gt;\n\r&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                       echo &quot;    &lt;tr&gt;&lt;td&gt;&quot; . esc_html( $form_field['name'] ) . &quot;:&lt;/td&gt;&lt;td&gt;&quot; . esc_html( $rekeyed_input[ $form_field['id']]['value'] ) . &quot;&lt;/td&gt;&lt;/tr&gt;\n\r&quot;;&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  case 'heading':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if($form_field['name'] == &quot;Hidden Fields&quot;)&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                      else&nbsp;</div></li><li><div>                        echo &quot;    &lt;tr class='heading'&gt;&lt;td colspan='2'&gt;&lt;strong&gt;&quot; . esc_html( $form_field['name'] ) . &quot;:&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;\n\r&quot;;&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  default:&nbsp;</div></li><li><div>                      if ($form_field['name']==&quot;State&quot; && !empty($purch_data['billing_region']) || $form_field['name']==&quot;State&quot; && !empty($purch_data['billing_region']))&nbsp;</div></li><li><div>                          echo &quot;&quot;;&nbsp;</div></li><li><div>                      else&nbsp;</div></li><li><div>                          echo &quot;    &lt;tr&gt;&lt;td&gt;&quot; . esc_html( $form_field['name'] ) . &quot;:&lt;/td&gt;&lt;td&gt;&quot;.&nbsp;</div></li><li><div>                              ( isset( $rekeyed_input[$form_field['id']] ) ? esc_html( $rekeyed_input[$form_field['id']]['value'] ) : '' ) .&nbsp;</div></li><li><div>                              &quot;&lt;/td&gt;&lt;/tr&gt;\n\r&quot;;&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          echo &quot;    &lt;tr&gt;&lt;td&gt;&quot;.esc_html__('Name', 'wpsc').&quot;:&lt;/td&gt;&lt;td&gt;&quot;.$purch_data['firstname'].&quot; &quot;.$purch_data['lastname'].&quot;&lt;/td&gt;&lt;/tr&gt;\n\r&quot;;&nbsp;</div></li><li><div>          echo &quot;    &lt;tr&gt;&lt;td&gt;&quot;.esc_html__('Address', 'wpsc').&quot;:&lt;/td&gt;&lt;td&gt;&quot;.$purch_data['address'].&quot;&lt;/td&gt;&lt;/tr&gt;\n\r&quot;;&nbsp;</div></li><li><div>          echo &quot;    &lt;tr&gt;&lt;td&gt;&quot;.esc_html__('Phone', 'wpsc').&quot;:&lt;/td&gt;&lt;td&gt;&quot;.$purch_data['phone'].&quot;&lt;/td&gt;&lt;/tr&gt;\n\r&quot;;&nbsp;</div></li><li><div>          echo &quot;    &lt;tr&gt;&lt;td&gt;&quot;.esc_html__('Email', 'wpsc').&quot;:&lt;/td&gt;&lt;td&gt;&quot;.$purch_data['email'].&quot;&lt;/td&gt;&lt;/tr&gt;\n\r&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 2 == get_option( 'payment_method' ) ) {&nbsp;</div></li><li><div>          $gateway_name = '';&nbsp;</div></li><li><div>          global $nzshpcrt_gateways;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach( $nzshpcrt_gateways as $gateway ) {&nbsp;</div></li><li><div>              if ( $purch_data['gateway'] != 'testmode' ) {&nbsp;</div></li><li><div>                  if ( $gateway['internalname'] == $purch_data['gateway'] ) {&nbsp;</div></li><li><div>                      $gateway_name = $gateway['name'];&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $gateway_name = esc_html__('Manual Payment', 'wpsc');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo &quot;&lt;/table&gt;\n\r&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      do_action ('wpsc_packing_slip_extra_info', $purchase_id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo &quot;&lt;table class='packing_slip'&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo &quot;&lt;tr&gt;&quot;;&nbsp;</div></li><li><div>      echo &quot; &lt;th&gt;&quot;.esc_html__('Quantity', 'wpsc').&quot; &lt;/th&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo &quot; &lt;th&gt;&quot;.esc_html__('Name', 'wpsc').&quot;&lt;/th&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo &quot; &lt;th&gt;&quot;.esc_html__('Price', 'wpsc').&quot; &lt;/th&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo &quot; &lt;th&gt;&quot;.esc_html__('Shipping', 'wpsc').&quot; &lt;/th&gt;&quot;;&nbsp;</div></li><li><div>      echo '&lt;th&gt;' . esc_html__('Tax', 'wpsc') . '&lt;/th&gt;';&nbsp;</div></li><li><div>      echo '&lt;/tr&gt;';&nbsp;</div></li><li><div>      $endtotal = 0;&nbsp;</div></li><li><div>      $all_donations = true;&nbsp;</div></li><li><div>      $all_no_shipping = true;&nbsp;</div></li><li><div>      $file_link_list = array();&nbsp;</div></li><li><div>      $total_shipping = 0;&nbsp;</div></li><li><div>      foreach($cart_log as $cart_row) {&nbsp;</div></li><li><div>          $alternate = &quot;&quot;;&nbsp;</div></li><li><div>          $j++;&nbsp;</div></li><li><div>          if(($j % 2) != 0) {&nbsp;</div></li><li><div>              $alternate = &quot;class='alt'&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// product ID will be $cart_row['prodid']. need to fetch name and stuff</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $variation_list = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if($cart_row['donation'] != 1) {&nbsp;</div></li><li><div>              $all_donations = false;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if($cart_row['no_shipping'] != 1) {&nbsp;</div></li><li><div>              $shipping = $cart_row['pnp'];&nbsp;</div></li><li><div>              $total_shipping += $shipping;&nbsp;</div></li><li><div>              $all_no_shipping = false;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $shipping = 0;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $price = $cart_row['price'] * $cart_row['quantity'];&nbsp;</div></li><li><div>          $gst = $price - ($price    / (1+($cart_row['gst'] / 100)));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if($gst &gt; 0) {&nbsp;</div></li><li><div>              $tax_per_item = $gst / $cart_row['quantity'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo &quot;&lt;tr $alternate&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo &quot; &lt;td&gt;&quot;;&nbsp;</div></li><li><div>          echo $cart_row['quantity'];&nbsp;</div></li><li><div>          echo &quot; &lt;/td&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo &quot; &lt;td&gt;&quot;;&nbsp;</div></li><li><div>          echo apply_filters( 'the_title', $cart_row['name'] );&nbsp;</div></li><li><div>          echo $variation_list;&nbsp;</div></li><li><div>          echo &quot; &lt;/td&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo &quot; &lt;td&gt;&quot;;&nbsp;</div></li><li><div>          echo wpsc_currency_display( $price );&nbsp;</div></li><li><div>          echo &quot; &lt;/td&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo &quot; &lt;td&gt;&quot;;&nbsp;</div></li><li><div>          echo wpsc_currency_display($shipping );&nbsp;</div></li><li><div>          echo &quot; &lt;/td&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo '&lt;td&gt;';&nbsp;</div></li><li><div>          echo wpsc_currency_display( $cart_row['tax_charged'] );&nbsp;</div></li><li><div>          echo '&lt;/td&gt;';&nbsp;</div></li><li><div>          echo '&lt;/tr&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo &quot;&lt;/table&gt;&quot;;&nbsp;</div></li><li><div>      echo '&lt;table class=&quot;packing-slip-totals&quot;&gt;';&nbsp;</div></li><li><div>      if ( floatval( $purch_data['discount_value'] ) )&nbsp;</div></li><li><div>          echo '&lt;tr&gt;&lt;th&gt;'.esc_html__('Discount', 'wpsc').'&lt;/th&gt;&lt;td&gt;(' . wpsc_currency_display( $purch_data['discount_value'] ) . ')&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo '&lt;tr&gt;&lt;th&gt;'.esc_html__('Base Shipping', 'wpsc').'&lt;/th&gt;&lt;td&gt;' . wpsc_currency_display( $purch_data['base_shipping'] ) . '&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>      echo '&lt;tr&gt;&lt;th&gt;'.esc_html__('Total Shipping', 'wpsc').'&lt;/th&gt;&lt;td&gt;' . wpsc_currency_display( $purch_data['base_shipping'] + $total_shipping ) . '&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>      <span class="comment">//wpec_taxes</span>&nbsp;</div></li><li><div>      if($purch_data['wpec_taxes_total'] != 0.00)&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>         echo '&lt;tr&gt;&lt;th&gt;'.esc_html__('Taxes', 'wpsc').'&lt;/th&gt;&lt;td&gt;' . wpsc_currency_display( $purch_data['wpec_taxes_total'] ) . '&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      echo '&lt;tr&gt;&lt;th&gt;'.esc_html__('Total Price', 'wpsc').'&lt;/th&gt;&lt;td&gt;' . wpsc_currency_display( $purch_data['totalprice'] ) . '&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>      echo '&lt;/table&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo &quot;&lt;/div&gt;\n\r&quot;;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      echo &quot;&lt;br /&gt;&quot;.esc_html__('This users cart was empty', 'wpsc');&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//other actions are here</span>&nbsp;</div></li><li><div>if ( isset( $_GET['display_invoice'] ) && ( 'true' == $_GET['display_invoice'] ) )&nbsp;</div></li><li><div>  add_action( 'admin_init', 'wpsc_display_invoice', 0 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['wpsc_admin_action'] ) && ( 'wpsc_display_invoice' == $_REQUEST['wpsc_admin_action'] ) )&nbsp;</div></li><li><div>  add_action( 'admin_init', 'wpsc_display_invoice' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Disable SSL validation for Curl. Added/removed on a per need basis, like so:</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * add_filter('http_api_curl', 'wpsc_curl_ssl');</span>&nbsp;</div></li><li><div><span class="comment"> * remove_filter('http_api_curl', 'wpsc_curl_ssl');</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param resource $ch</span>&nbsp;</div></li><li><div><span class="comment"> * @return resource $ch</span>&nbsp;</div></li><li><div><span class="comment"> **/</span>&nbsp;</div></li><li><div>function wpsc_curl_ssl( $ch ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13', &quot;add_filter( 'https_ssl_verify', '__return_false' )&quot; );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);&nbsp;</div></li><li><div>  curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE);&nbsp;</div></li><li><div>  return $ch;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Get cart item meta</span>&nbsp;</div></li><li><div><span class="comment"> * @access public</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.13</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_get_cartmeta( $cart_item_id, $meta_key ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13', 'wpsc_get_cart_item_meta');&nbsp;</div></li><li><div>  return wpsc_get_cart_item_meta( $cart_item_id, $meta_key, true );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Update cart item meta</span>&nbsp;</div></li><li><div><span class="comment"> * @access public</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.13</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_update_cartmeta( $cart_item_id, $meta_key, $meta_value ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13', 'wpsc_update_cart_item_meta');&nbsp;</div></li><li><div>  return wpsc_update_cart_item_meta( $cart_item_id, $meta_key, $meta_value );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Delete cart item meta</span>&nbsp;</div></li><li><div><span class="comment"> * @access public</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.13</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_delete_cartmeta( $cart_item_id, $meta_key, $meta_value = '' ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13', 'wpsc_delete_cart_item_meta');&nbsp;</div></li><li><div>  return wpsc_delete_cart_item_meta( $cart_item_id, $meta_key, $meta_value );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_get_exchange_rate( $from, $to ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13' );&nbsp;</div></li><li><div>  return _wpsc_get_exchange_rate( $from, $to );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @access public</span>&nbsp;</div></li><li><div><span class="comment"> * @param unknown $stuff</span>&nbsp;</div></li><li><div><span class="comment"> * @param unknown $post_ID</span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.13.3</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_the_featured_image_fix( $stuff, $post_ID ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.13.2', 'wpsc_the_featured_image_fix');&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $is_tax = is_tax( 'wpsc_product_category' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $queried_object = get_queried_object();&nbsp;</div></li><li><div>  $is_single = is_single() && $queried_object-&gt;ID == $post_ID && get_post_type() == 'wpsc-product';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $is_tax || $is_single ) {&nbsp;</div></li><li><div>      $header_image = get_header_image();&nbsp;</div></li><li><div>      $stuff = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $header_image )&nbsp;</div></li><li><div>          $stuff = '&lt;img src=&quot;' . esc_url( $header_image ) . '&quot; width=&quot;' . HEADER_IMAGE_WIDTH . '&quot; height=&quot;' . HEADER_IMAGE_HEIGHT . '&quot; alt=&quot;&quot; /&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  remove_action( 'post_thumbnail_html', 'wpsc_the_featured_image_fix' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $stuff;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @access public</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $meta_object_type Type of object metadata is for (e.g., variation. cart, etc)</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Name of the custom meta table defined in $wpdb, or the name as it would be defined</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.13.4</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_meta_table_name( $meta_object_type ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.14', '_wpsc_meta_table_name' );&nbsp;</div></li><li><div>  return _wpsc_meta_table_name( $meta_object_type );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Google checkout not longer available or supported, so we are deprecating this function</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @access public</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.14</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_google_checkout() {&nbsp;</div></li><li><div>  $currpage = wpsc_selfURL();&nbsp;</div></li><li><div>  if (array_search(&quot;google&quot;, (array)get_option('custom_gateway_options')) !== false && $currpage != get_option('shopping_cart_url')) {&nbsp;</div></li><li><div>      global $nzshpcrt_gateways;&nbsp;</div></li><li><div>      foreach($nzshpcrt_gateways as $gateway) {&nbsp;</div></li><li><div>          if($gateway['internalname'] == 'google' ) {&nbsp;</div></li><li><div>              $gateway_used = $gateway['internalname'];&nbsp;</div></li><li><div>              $gateway['function'](true);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Google checkout not longer available or supported, so we are deprecating this function</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @access public</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.14</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_empty_google_logs() {&nbsp;</div></li><li><div>  global $wpdb;&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.14', 'wpsc_empty_google_logs' );&nbsp;</div></li><li><div>  $sql = $wpdb-&gt;prepare( &quot;DELETE FROM  `&quot;.WPSC_TABLE_PURCHASE_LOGS.&quot;` WHERE `sessionid` = '%s'&quot;, wpsc_get_customer_meta( 'checkout_session_id' ) );&nbsp;</div></li><li><div>  $wpdb-&gt;query( $sql );&nbsp;</div></li><li><div>  wpsc_delete_customer_meta( 'checkout_session_id' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @access public</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.13.4</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_user_dynamic_js() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.14', 'wpsc_javascript_localizations' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Over time certain javascript variables that were once localized into scripts will become obsolete</span>&nbsp;</div></li><li><div><span class="comment"> * When they do moving them here will continue to create the variables for older javascript to use.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _wpsc_deprecated_javascript_localization_vars() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @deprecated since 3.8.14</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * wpsc_deprecated_vars as an object with the properties below has been replaced and each of the properties</span>&nbsp;</div></li><li><div><span class="comment">   * is available as it's own variable, that means devs instead of referencing &quot;wpsc_ajax.base_url&quot; do</span>&nbsp;</div></li><li><div><span class="comment">   * &quot;base_url&quot;</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $wpsc_deprecated_js_vars = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $wpsc_deprecated_js_vars['WPSC_DIR_NAME'] = WPSC_DIR_NAME;&nbsp;</div></li><li><div>  $wpsc_deprecated_js_vars['fileLoadingImage'] = WPSC_CORE_IMAGES_URL . '/loading.gif';&nbsp;</div></li><li><div>  $wpsc_deprecated_js_vars['fileBottomNavCloseImage'] = WPSC_CORE_IMAGES_URL . '/closelabel.gif';&nbsp;</div></li><li><div>  $wpsc_deprecated_js_vars['resizeSpeed'] = 9;  <span class="comment">// controls the speed of the image resizing (1=slowest and 10=fastest)</span>&nbsp;</div></li><li><div>  $wpsc_deprecated_js_vars['borderSize'] = 10; <span class="comment">//if you adjust the padding in the CSS, you will need to update this variable</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $wpsc_deprecated_js_vars;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wpsc google checkout submit used for google checkout (unsure whether necessary in 3.8)</span>&nbsp;</div></li><li><div><span class="comment"> * @access public</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated since 3.8.14</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_google_checkout_submit() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.14' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $wpdb, $wpsc_cart, $current_user;&nbsp;</div></li><li><div>  $wpsc_checkout = new wpsc_checkout();&nbsp;</div></li><li><div>  $purchase_log_id = $wpdb-&gt;get_var( &quot;SELECT `id` FROM `&quot; . WPSC_TABLE_PURCHASE_LOGS . &quot;` WHERE `sessionid` IN(%s) LIMIT 1&quot;, wpsc_get_customer_meta( 'checkout_session_id' ) );&nbsp;</div></li><li><div>  get_currentuserinfo();&nbsp;</div></li><li><div>  if ( $current_user-&gt;display_name != '' ) {&nbsp;</div></li><li><div>      foreach ( $wpsc_checkout-&gt;checkout_items as $checkoutfield ) {&nbsp;</div></li><li><div>          if ( $checkoutfield-&gt;unique_name == 'billingfirstname' ) {&nbsp;</div></li><li><div>              $checkoutfield-&gt;value = $current_user-&gt;display_name;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( $current_user-&gt;user_email != '' ) {&nbsp;</div></li><li><div>      foreach ( $wpsc_checkout-&gt;checkout_items as $checkoutfield ) {&nbsp;</div></li><li><div>          if ( $checkoutfield-&gt;unique_name == 'billingemail' ) {&nbsp;</div></li><li><div>              $checkoutfield-&gt;value = $current_user-&gt;user_email;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $wpsc_checkout-&gt;save_forms_to_db( $purchase_log_id );&nbsp;</div></li><li><div>  $wpsc_cart-&gt;save_to_db( $purchase_log_id );&nbsp;</div></li><li><div>  $wpsc_cart-&gt;submit_stock_claims( $purchase_log_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated 3.8.14</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters()      Allows manipulation of the flash upload params.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_admin_dynamic_css() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.14' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  header( 'Content-Type: text/css' );&nbsp;</div></li><li><div>  header( 'Expires: ' . gmdate( 'r', mktime( 0, 0, 0, date( 'm' ), ( date( 'd' ) + 12 ), date( 'Y' ) ) ) . '' );&nbsp;</div></li><li><div>  header( 'Cache-Control: public, must-revalidate, max-age=86400' );&nbsp;</div></li><li><div>  header( 'Pragma: public' );&nbsp;</div></li><li><div>  $flash = 0;&nbsp;</div></li><li><div>  $flash = apply_filters( 'flash_uploader', $flash );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 1 == $flash ) {&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>      div.flash-image-uploader {&nbsp;</div></li><li><div>          display: block;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      div.browser-image-uploader {&nbsp;</div></li><li><div>          display: none;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>      div.flash-image-uploader {&nbsp;</div></li><li><div>          display: none;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      div.browser-image-uploader {&nbsp;</div></li><li><div>          display: block;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  exit();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * everywhere else in the code we use &quot;wpsc_ajax_action&quot;, not the plural, deprecate this version</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated 3.8.14</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['wpsc_ajax_actions'] ) && 'update_location' == $_REQUEST['wpsc_ajax_actions'] ) {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( 'wpsc_ajax_actions', '3.8.14', 'wpsc_ajax_action' );&nbsp;</div></li><li><div>  add_action( 'init', 'wpsc_update_location' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['wpsc_ajax_actions'] ) && 'update_location' == $_REQUEST['wpsc_ajax_actions'] ) {&nbsp;</div></li><li><div>  _wpsc_doing_it_wrong( 'wpsc_ajax_actions', __( 'wpsc_ajax_actions is not the proper parameter to pass AJAX handlers to WPeC.  Use wpsc_ajax_action instead.', 'wpsc' ) );&nbsp;</div></li><li><div>  add_action( 'init', 'wpsc_update_location' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Update products page URL options when permalink scheme changes.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since  3.8.9</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses wpsc_update_page_urls() Gets the premalinks for product pages and stores for quick reference</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _wpsc_action_permalink_structure_changed() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.14' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  add_action( 'admin_notices', 'wpsc_check_permalink_notice' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  wpsc_update_page_urls( true );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Display warning if the user is using WordPress prior to 3.3 because there is a bug with custom</span>&nbsp;</div></li><li><div><span class="comment"> * post type and taxonomy permalink generation.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.8.9</span>&nbsp;</div></li><li><div><span class="comment"> * @access private</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function _wpsc_display_permalink_refresh_notice() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.14' );&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;div id=&quot;notice&quot; class=&quot;error fade&quot;&gt;&nbsp;</div></li><li><div>      &lt;p&gt;&nbsp;</div></li><li><div>          &lt;?php printf( __( 'Due to &lt;a href=&quot;%1$s&quot;&gt;a bug in WordPress prior to version 3.3&lt;/a&gt;, you might run into 404 errors when viewing your products. To work around this, &lt;a href=&quot;%2$s&quot;&gt;upgrade to WordPress 3.3 or later&lt;/a&gt;, or simply click &quot;Save Changes&quot; below a second time.' , 'wpsc' ), 'http:<span class="comment">//core.trac.wordpress.org/ticket/16736', 'http://codex.wordpress.org/Updating_WordPress' ); ?&gt;</span>&nbsp;</div></li><li><div>      &lt;/p&gt;&nbsp;</div></li><li><div>  &lt;/div&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** These deprecated functions were quite horribly named, begging for namespace colliding. */</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'change_context' ) )  {&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Adding function to change text for media buttons</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function change_context( $context ) {&nbsp;</div></li><li><div>      _wpsc_deprecated_function( __FUNCTION__, '3.8.14' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $current_screen = get_current_screen();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $current_screen-&gt;id != 'wpsc-product' )&nbsp;</div></li><li><div>          return $context;&nbsp;</div></li><li><div>      return __( 'Upload Image%s', 'wpsc' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( ! function_exists( 'change_link' ) ) {&nbsp;</div></li><li><div>  function change_link( $link ) {&nbsp;</div></li><li><div>      _wpsc_deprecated_function( __FUNCTION__, '3.8.14' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      global $post_ID;&nbsp;</div></li><li><div>      $current_screen = get_current_screen();&nbsp;</div></li><li><div>      if ( $current_screen && $current_screen-&gt;id != 'wpsc-product' )&nbsp;</div></li><li><div>          return $link;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $uploading_iframe_ID = $post_ID;&nbsp;</div></li><li><div>      $media_upload_iframe_src = &quot;media-upload.php?post_id=$uploading_iframe_ID&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $media_upload_iframe_src . &quot;&amp;type=image&parent_page=wpsc-edit-products&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_google_shipping_settings() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.14' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! wpsc_is_store_admin() ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $_POST['submit'] ) ) {&nbsp;</div></li><li><div>      foreach ( (array) $_POST['google_shipping'] as $key =&gt; $country ) {&nbsp;</div></li><li><div>          if ( $country == 'on' ) {&nbsp;</div></li><li><div>              $google_shipping_country[] = $key;&nbsp;</div></li><li><div>              $updated++;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      update_option( 'google_shipping_country', $google_shipping_country );&nbsp;</div></li><li><div>      $sendback = wp_get_referer();&nbsp;</div></li><li><div>      $sendback = remove_query_arg( 'googlecheckoutshipping', $sendback );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $updated ) ) {&nbsp;</div></li><li><div>          $sendback = add_query_arg( 'updated', $updated, $sendback );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      wp_redirect( esc_url_raw( $sendback ) );&nbsp;</div></li><li><div>      exit();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['wpsc_admin_action'] ) && ($_REQUEST['wpsc_admin_action'] == 'google_shipping_settings') ) {&nbsp;</div></li><li><div>  add_action( 'admin_init', 'wpsc_google_shipping_settings' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpsc_css_header() {&nbsp;</div></li><li><div>  _wpsc_deprecated_function( __FUNCTION__, '3.8.14' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * deprecating item filters from wpsc_display_form_fields() in release 3.8.13.4</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *  @deprecated 3.8.14</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function displays each of the form fields.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Each of them are filterable via 'wpsc_account_form_field_$tag'</span>&nbsp;</div></li><li><div><span class="comment"> * where tag is permalink-styled name or uniquename. i.e. First Name under Shipping would be</span>&nbsp;</div></li><li><div><span class="comment"> * 'wpsc_account_form_field_shippingfirstname' - while Your Billing Details would be filtered</span>&nbsp;</div></li><li><div><span class="comment"> * via 'wpsc_account_form_field_your-billing-details'.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param varies  $meta_value</span>&nbsp;</div></li><li><div><span class="comment"> * @param string  $meta_key</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_user_log_deprecated_filter_values( $meta_value, $meta_key ) {&nbsp;</div></li><li><div>  $filter = 'wpsc_account_form_field_' . $meta_key;&nbsp;</div></li><li><div>  if ( has_filter( $filter ) ) {&nbsp;</div></li><li><div>      $meta_value = apply_filters( $filter , esc_html( $meta_value ) );&nbsp;</div></li><li><div>      _wpsc_doing_it_wrong( $filter, __( 'The filter being used has been deprecated. Use wpsc_get_visitor_meta or wpsc_get_visitor_meta_$neta_name instead.' ), '3.8.14' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $meta_value;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_filter( 'wpsc_get_visitor_meta', 'wpsc_user_log_deprecated_filter_values', 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * deprecating user log filter for getting all customer meta as an array.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *@deprecated 3.8.14</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return none</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_deprecated_filter_user_log_get() {&nbsp;</div></li><li><div>  if ( has_filter( 'wpsc_user_log_get' ) ) {&nbsp;</div></li><li><div>      $meta_data = wpsc_get_customer_meta( 'checkout_details' );&nbsp;</div></li><li><div>      $meta_data = apply_filters( 'wpsc_user_log_get', $meta_data, wpsc_get_current_customer_id() );&nbsp;</div></li><li><div>      wpsc_update_customer_meta( 'checkout_details', $meta_data );&nbsp;</div></li><li><div>      _wpsc_doing_it_wrong( 'wpsc_user_log_get', __( 'The filter being used has been deprecated. Use wpsc_get_visitor_meta or wpsc_get_visitor_meta_$neta_name instead.' ), '3.8.14' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action( 'wpsc_start_display_user_log_form_fields', 'wpsc_deprecated_filter_user_log_get', 10, 0 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * function to provide deprecated variables to older shipping modules</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 3.8.14</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wpsc_deprecated_vars_for_shipping( $wpsc_cart ) {&nbsp;</div></li><li><div>  <span class="comment">// extracted from the Instinct fedex module</span>&nbsp;</div></li><li><div>  $_POST['country'] = wpsc_get_customer_meta( 'shippingcountry' );&nbsp;</div></li><li><div>  $_POST['region'] = wpsc_get_customer_meta( 'shippingregion' );&nbsp;</div></li><li><div>  $_POST['zipcode'] = wpsc_get_customer_meta( 'shippingpostcode' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action( 'wpsc_before_get_shipping_method', 'wpsc_deprecated_vars_for_shipping' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function _wpsc_action_user_update_errors( $errors, $update, $user ) {&nbsp;</div></li><li><div>  if ( isset( $user-&gt;role ) && $user-&gt;role == 'wpsc_anonymous' ) {&nbsp;</div></li><li><div>      unset( $errors-&gt;errors['empty_email'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// add_action( 'user_profile_update_errors', '_wpsc_action_user_update_errors', 10, 3 );</span>&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span><a href="http://wpecommerce.org/">WP eCommerce</a></li><li><span></span>3.9.5</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>