<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="1.14.8" data-slug="pods-framework" data-type="class" data-id="59281"><head xmlns="http://www.w3.org/1999/xhtml"><title> pod | class | Pods Framework | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="Pod, class, plugin, pods-framework, 1.14.8" /><meta name="description" content="Include and Init the Pods class" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.17"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=af0587368358b55ab6d174890bafe12f' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.17' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/pod/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fpod%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fpod%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-pods-framework-1.14.8-class-pod","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="pod" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to pods-framework." href="http://hookr.io/plugins/pods-framework/" class="plugin"><span property="name">pods-framework</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><span property="name">1.14.8</span><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/pods-framework/1.14.8/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">pod</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="199"><a href="http://hookr.io/plugins/pods-framework/1.14.8/all/" title="All">All <span class="count badge">199</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/pods-framework/1.14.8/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="122"><a href="http://hookr.io/plugins/pods-framework/1.14.8/hooks/" title="Hooks">Hooks <span class="count badge">122</span></a></li><li class="" data-id="action" data-count="41"><a href="http://hookr.io/plugins/pods-framework/1.14.8/actions/" title="Actions">Actions <span class="count badge">41</span></a></li><li class="" data-id="filter" data-count="81"><a href="http://hookr.io/plugins/pods-framework/1.14.8/filters/" title="Filters">Filters <span class="count badge">81</span></a></li><li class="active" data-id="class" data-count="5"><a href="http://hookr.io/plugins/pods-framework/1.14.8/classes/" title="Classes">Classes <span class="count badge">5</span></a></li><li class="" data-id="constant" data-count="7"><a href="http://hookr.io/plugins/pods-framework/1.14.8/constants/" title="Constants">Constants <span class="count badge">7</span></a></li><li class="" data-id="function" data-count="64"><a href="http://hookr.io/plugins/pods-framework/1.14.8/functions/" title="Functions">Functions <span class="count badge">64</span></a></li><li class="" data-id="shortcode" data-count="1"><a href="http://hookr.io/plugins/pods-framework/1.14.8/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">1</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>Pod</strong></h1><p>Include and Init the Pods class.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/pods-framework/1.14.8/files/classes-pod/" class="file">/classes/Pod.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="2" class="block" start="2"><li><div>class Pod&nbsp;</div></li><li><div>{&nbsp;</div></li><li><div>    var $id;&nbsp;</div></li><li><div>    var $sql;&nbsp;</div></li><li><div>    var $raw_sql;&nbsp;</div></li><li><div>    var $data;&nbsp;</div></li><li><div>    var $row_number = -1;&nbsp;</div></li><li><div>    var $zebra = false;&nbsp;</div></li><li><div>    var $result;&nbsp;</div></li><li><div>    var $datatype;&nbsp;</div></li><li><div>    var $datatype_id;&nbsp;</div></li><li><div>    var $calc_found_rows = true;&nbsp;</div></li><li><div>    var $count_found_rows = false;&nbsp;</div></li><li><div>    var $total;&nbsp;</div></li><li><div>    var $total_rows;&nbsp;</div></li><li><div>    var $detail_page;&nbsp;</div></li><li><div>    var $rpp = 15;&nbsp;</div></li><li><div>    var $page_var = 'pg';&nbsp;</div></li><li><div>    var $page = 1;&nbsp;</div></li><li><div>    var $pagination = true;&nbsp;</div></li><li><div>    var $search = true;&nbsp;</div></li><li><div>    var $search_var = 'search';&nbsp;</div></li><li><div>    var $search_where = '';&nbsp;</div></li><li><div>    var $search_mode = 'int'; // int | text | text_like&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    var $traverse = array();&nbsp;</div></li><li><div>    var $rabit_hole = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Constructor - Pods CMS core&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param string $datatype The pod name&nbsp;</div></li><li><div>     * @param mixed $id (optional) The ID or slug, to load a single record; Provide array of $params to run findRecords immediately&nbsp;</div></li><li><div>     * @license http://www.gnu.org/licenses/gpl-2.0.html&nbsp;</div></li><li><div>     * @since 1.0.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function __construct($datatype = null, $id = null) {&nbsp;</div></li><li><div>        $datatype = pods_sanitize($datatype);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (defined('PODS_STRICT_MODE') && PODS_STRICT_MODE) {&nbsp;</div></li><li><div>            $this-&gt;page = 1;&nbsp;</div></li><li><div>            $this-&gt;pagination = false;&nbsp;</div></li><li><div>            $this-&gt;search = false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else {&nbsp;</div></li><li><div>            // Get the page variable&nbsp;</div></li><li><div>            $this-&gt;page = pods_var($this-&gt;page_var, 'get');&nbsp;</div></li><li><div>            $this-&gt;page = empty($this-&gt;page) ? 1 : max((int) $this-&gt;page, 1);&nbsp;</div></li><li><div>            if (defined('PODS_GLOBAL_POD_PAGINATION') && !PODS_GLOBAL_POD_PAGINATION) {&nbsp;</div></li><li><div>                $this-&gt;page = 1;&nbsp;</div></li><li><div>                $this-&gt;pagination = false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if (defined('PODS_GLOBAL_POD_SEARCH') && !PODS_GLOBAL_POD_SEARCH)&nbsp;</div></li><li><div>                $this-&gt;search = false;&nbsp;</div></li><li><div>            if (defined('PODS_GLOBAL_POD_SEARCH_MODE') && in_array(PODS_GLOBAL_POD_SEARCH_MODE, array('int', 'text', 'text_like')))&nbsp;</div></li><li><div>                $this-&gt;search_mode = PODS_GLOBAL_POD_SEARCH_MODE;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (!empty($datatype)) {&nbsp;</div></li><li><div>            $result = pod_query(&quot;SELECT id, name, detail_page FROM @wp_pod_types WHERE name = '$datatype' LIMIT 1&quot;);&nbsp;</div></li><li><div>            if (0 &lt; pods_mysql_num_rows($result)) {&nbsp;</div></li><li><div>                $row = pods_mysql_fetch_assoc($result);&nbsp;</div></li><li><div>                $this-&gt;datatype = $row['name'];&nbsp;</div></li><li><div>                $this-&gt;datatype_id = $row['id'];&nbsp;</div></li><li><div>                $this-&gt;detail_page = $row['detail_page'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if (null !== $id) {&nbsp;</div></li><li><div>                    if (is_array($id) || is_object($id))&nbsp;</div></li><li><div>                        $this-&gt;findRecords($id);&nbsp;</div></li><li><div>                    else {&nbsp;</div></li><li><div>                        $this-&gt;getRecordById($id);&nbsp;</div></li><li><div>                        if (!empty($this-&gt;data))&nbsp;</div></li><li><div>                            $this-&gt;id = $this-&gt;get_field('id');&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                echo &quot;&lt;e&gt;Error: Pod '{$datatype}' does not exist&lt;/e&gt;&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Fetch a row of results from the DB&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.2.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function fetchRecord() {&nbsp;</div></li><li><div>        if ($this-&gt;data = pods_mysql_fetch_assoc($this-&gt;result)) {&nbsp;</div></li><li><div>            $this-&gt;row_number++;&nbsp;</div></li><li><div>            if (true === $this-&gt;zebra)&nbsp;</div></li><li><div>                $this-&gt;zebra = false;&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                $this-&gt;zebra = true;&nbsp;</div></li><li><div>            return $this-&gt;data;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Return a field's value(s)&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param string $name The field name&nbsp;</div></li><li><div>     * @param string $orderby (optional) The orderby string, for PICK fields&nbsp;</div></li><li><div>     * @since 1.2.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_field($name, $orderby = null) {&nbsp;</div></li><li><div>        if (empty($this-&gt;data) && empty($this-&gt;datatype_id)) {&nbsp;</div></li><li><div>            echo &quot;&lt;e&gt;Error: Pod name invalid, no data available&lt;/e&gt;&quot;;&nbsp;</div></li><li><div>            return null;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // No data&nbsp;</div></li><li><div>        elseif ( !isset( $this-&gt;data[ 'id' ] ) )&nbsp;</div></li><li><div>            return null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset($this-&gt;data[$name])) {&nbsp;</div></li><li><div>            return $this-&gt;data[$name];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ('created' == $name || 'modified' == $name) {&nbsp;</div></li><li><div>            $pod_id = (int) $this-&gt;get_pod_id();&nbsp;</div></li><li><div>            if (!empty($pod_id))&nbsp;</div></li><li><div>                $result = pod_query(&quot;SELECT id, created, modified FROM @wp_pod WHERE id = {$pod_id} LIMIT 1&quot;);&nbsp;</div></li><li><div>            else {&nbsp;</div></li><li><div>                $tbl_row_id = (int) $this-&gt;get_field('id');&nbsp;</div></li><li><div>                if (!empty($tbl_row_id))&nbsp;</div></li><li><div>                    $result = pod_query(&quot;SELECT id, created, modified FROM @wp_pod WHERE tbl_row_id = {$tbl_row_id} LIMIT 1&quot;);&nbsp;</div></li><li><div>                else&nbsp;</div></li><li><div>                    return;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $row = pods_mysql_fetch_assoc($result);&nbsp;</div></li><li><div>            $this-&gt;data['pod_id'] = $row['pod_id'];&nbsp;</div></li><li><div>            $this-&gt;data['created'] = $row['created'];&nbsp;</div></li><li><div>            $this-&gt;data['modified'] = $row['modified'];&nbsp;</div></li><li><div>            return $this-&gt;data[$name];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ('detail_url' == $name) {&nbsp;</div></li><li><div>            return $this-&gt;parse_magic_tags(array('', '', 'detail_url'));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else {&nbsp;</div></li><li><div>            // Dot-traversal&nbsp;</div></li><li><div>            $last_loop = false;&nbsp;</div></li><li><div>            $datatype_id = $this-&gt;datatype_id;&nbsp;</div></li><li><div>            $tbl_row_ids = ( isset( $this-&gt;data[ 'id' ] ) ? $this-&gt;data[ 'id' ] : 0 ); // allow for custom selects&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $traverse = (false !== strpos($name, '.')) ? explode('.', $name) : array($name);&nbsp;</div></li><li><div>            $traverse_fields = implode(&quot;', '&quot;, $traverse);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Get columns matching traversal names&nbsp;</div></li><li><div>            $result = pod_query(&quot;SELECT id, datatype, name, coltype, pickval FROM @wp_pod_fields WHERE name IN ('$traverse_fields')&quot;);&nbsp;</div></li><li><div>            if (0 &lt; pods_mysql_num_rows($result)) {&nbsp;</div></li><li><div>                while ($row = pods_mysql_fetch_assoc($result)) {&nbsp;</div></li><li><div>                    $all_fields[$row['datatype']][$row['name']] = $row;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            // No matching columns&nbsp;</div></li><li><div>            else {&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $last_coltype = $last_pickval = '';&nbsp;</div></li><li><div>            // Loop through each traversal level&nbsp;</div></li><li><div>            foreach ($traverse as $key =&gt; $column_name) {&nbsp;</div></li><li><div>                $last_loop = (1 &lt; count($traverse) - $key) ? false : true;&nbsp;</div></li><li><div>                $column_exists = isset($all_fields[$datatype_id][$column_name]);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ($column_exists) {&nbsp;</div></li><li><div>                    $col = $all_fields[$datatype_id][$column_name];&nbsp;</div></li><li><div>                    $field_id = $col['id'];&nbsp;</div></li><li><div>                    $coltype = $col['coltype'];&nbsp;</div></li><li><div>                    $pickval = $col['pickval'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ('pick' == $coltype || 'file' == $coltype) {&nbsp;</div></li><li><div>                        $last_coltype = $coltype;&nbsp;</div></li><li><div>                        $last_pickval = $pickval;&nbsp;</div></li><li><div>                        $tbl_row_ids = $this-&gt;lookup_row_ids($field_id, $datatype_id, $tbl_row_ids);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        if (false === $tbl_row_ids) {&nbsp;</div></li><li><div>                            return false;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        // Get datatype ID for non-WP PICK columns&nbsp;</div></li><li><div>                        if (&nbsp;</div></li><li><div>                            !empty($pickval) &&&nbsp;</div></li><li><div>                            !in_array($pickval, array('wp_taxonomy', 'wp_post', 'wp_page', 'wp_user')))&nbsp;</div></li><li><div>                        {&nbsp;</div></li><li><div>                            $result = pod_query(&quot;SELECT id FROM @wp_pod_types WHERE name = '$pickval' LIMIT 1&quot;);&nbsp;</div></li><li><div>                            $datatype_id = pods_mysql_result($result, 0);&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    else {&nbsp;</div></li><li><div>                        $last_loop = true;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                // Assume last iteration&nbsp;</div></li><li><div>                else {&nbsp;</div></li><li><div>                    // Invalid column name&nbsp;</div></li><li><div>                    if (0 == $key) {&nbsp;</div></li><li><div>                        return false;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $last_loop = true;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ($last_loop) {&nbsp;</div></li><li><div>                    $table = ('file' == $last_coltype) ? 'file' : $last_pickval;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if (!empty($table)) {&nbsp;</div></li><li><div>                        $data = $this-&gt;rel_lookup($tbl_row_ids, $table, $orderby);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if (empty($data)) {&nbsp;</div></li><li><div>                        $results = false;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    // Return entire array&nbsp;</div></li><li><div>                    elseif (false !== $column_exists && ('pick' == $coltype || 'file' == $coltype)) {&nbsp;</div></li><li><div>                        $results = $data;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    // Return a single column value&nbsp;</div></li><li><div>                    elseif (1 == count($data)) {&nbsp;</div></li><li><div>                        $results = $data[0][$column_name];&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    // Return an array of single column values&nbsp;</div></li><li><div>                    else {&nbsp;</div></li><li><div>                        foreach ($data as $key =&gt; $val) {&nbsp;</div></li><li><div>                            $results[] = $val[$column_name];&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    return $results;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Find items related to a parent field&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param int $field_id The field ID&nbsp;</div></li><li><div>     * @param int $datatype_id The datatype ID&nbsp;</div></li><li><div>     * @param mixed $tbl_row_ids A comma-separated string (or array) of row IDs&nbsp;</div></li><li><div>     * @since 1.2.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function lookup_row_ids($field_id, $datatype_id, $tbl_row_ids) {&nbsp;</div></li><li><div>        if (empty($tbl_row_ids))&nbsp;</div></li><li><div>            $tbl_row_ids = 0;&nbsp;</div></li><li><div>        else {&nbsp;</div></li><li><div>            if (!is_array($tbl_row_ids))&nbsp;</div></li><li><div>                $tbl_row_ids = explode(', ', $tbl_row_ids);&nbsp;</div></li><li><div>            foreach ($tbl_row_ids as $key =&gt; $id) {&nbsp;</div></li><li><div>                $tbl_row_ids[$key] = (int) $id;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $tbl_row_ids = implode(', ', $tbl_row_ids);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $field_id = (int) $field_id;&nbsp;</div></li><li><div>        $datatype_id = (int) $datatype_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $sql = &quot;&nbsp;</div></li><li><div>        SELECT&nbsp;</div></li><li><div>            `r`.`tbl_row_id`&nbsp;</div></li><li><div>        FROM&nbsp;</div></li><li><div>            `@wp_pod` AS `p`&nbsp;</div></li><li><div>        INNER JOIN&nbsp;</div></li><li><div>            `@wp_pod_rel` AS `r` ON `r`.`field_id` = {$field_id} AND `r`.`pod_id` = `p`.`id`&nbsp;</div></li><li><div>        WHERE&nbsp;</div></li><li><div>            `p`.`datatype` = {$datatype_id} AND `p`.`tbl_row_id` IN ($tbl_row_ids)&nbsp;</div></li><li><div>        ORDER BY&nbsp;</div></li><li><div>            `r`.`weight`&nbsp;</div></li><li><div>        &quot;;&nbsp;</div></li><li><div>        $result = pod_query($sql);&nbsp;</div></li><li><div>        if (0 &lt; pods_mysql_num_rows($result)) {&nbsp;</div></li><li><div>            while ($row = pods_mysql_fetch_assoc($result)) {&nbsp;</div></li><li><div>                $out[] = $row['tbl_row_id'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            return implode(', ', $out);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Lookup values from a single relationship field&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param mixed $tbl_row_ids A comma-separated string of row IDs&nbsp;</div></li><li><div>     * @param string $table The database table alias&nbsp;</div></li><li><div>     * @param string $orderby (optional) MySQL &quot;ORDER BY&quot; clause&nbsp;</div></li><li><div>     * @return array $data Associative array of table column values&nbsp;</div></li><li><div>     * @since 1.2.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function rel_lookup($tbl_row_ids, $table, $orderby = null) {&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>        $orderby = empty($orderby) ? '' : &quot;ORDER BY $orderby&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // WP taxonomy item&nbsp;</div></li><li><div>        if ('wp_taxonomy' == $table) {&nbsp;</div></li><li><div>            $result = pod_query(&quot;SELECT * FROM `$wpdb-&gt;terms` WHERE `term_id` IN ($tbl_row_ids) $orderby&quot;);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // WP page, post, or attachment&nbsp;</div></li><li><div>        elseif ('wp_page' == $table || 'wp_post' == $table || 'file' == $table) {&nbsp;</div></li><li><div>            $result = pod_query(&quot;SELECT * FROM `$wpdb-&gt;posts` WHERE `ID` IN ($tbl_row_ids) $orderby&quot;);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // WP user&nbsp;</div></li><li><div>        elseif ('wp_user' == $table) {&nbsp;</div></li><li><div>            $result = pod_query(&quot;SELECT * FROM `$wpdb-&gt;users` WHERE `ID` IN ($tbl_row_ids) $orderby&quot;);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // Pod table&nbsp;</div></li><li><div>        else {&nbsp;</div></li><li><div>            $result = pod_query(&quot;SELECT * FROM `@wp_pod_tbl_$table` WHERE `id` IN ($tbl_row_ids) $orderby&quot;);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //override with custom relational query&nbsp;</div></li><li><div>        $result = apply_filters('pods_rel_lookup', $result, $tbl_row_ids, $table, $orderby, $this);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Put all related items into an array&nbsp;</div></li><li><div>        if (!is_array($result)) {&nbsp;</div></li><li><div>            while ($row = pods_mysql_fetch_assoc($result)) {&nbsp;</div></li><li><div>                $data[] = $row;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $data = $result;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //override with custom data&nbsp;</div></li><li><div>        $data = apply_filters('pods_rel_lookup_data', $data, $tbl_row_ids, $table, $orderby, $this);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $data;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Get the current item's pod ID from its datatype ID and tbl_row_id&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @todo pod_id should NEVER be needed by users - fix code so tbl_row_id is used instead&nbsp;</div></li><li><div>     * @return int The ID from the wp_pod table&nbsp;</div></li><li><div>     * @since 1.2.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_pod_id() {&nbsp;</div></li><li><div>        if (empty($this-&gt;data) && empty($this-&gt;datatype_id)) {&nbsp;</div></li><li><div>            echo &quot;&lt;e&gt;Error: Pod name invalid, no data available&lt;/e&gt;&quot;;&nbsp;</div></li><li><div>            return null;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif (empty($this-&gt;data))&nbsp;</div></li><li><div>            return 0;&nbsp;</div></li><li><div>        elseif ((!isset($this-&gt;data['pod_id']) ||empty($this-&gt;data['pod_id'])) && isset($this-&gt;data['id']) && 0 &lt; $this-&gt;data['id']) {&nbsp;</div></li><li><div>            $this-&gt;data['pod_id'] = 0;&nbsp;</div></li><li><div>            $tbl_row_id = (isset($this-&gt;data['id']) ? (int) $this-&gt;data['id'] : 0);&nbsp;</div></li><li><div>            $result = pod_query(&quot;SELECT `id` FROM `@wp_pod` WHERE `datatype` = '$this-&gt;datatype_id' AND `tbl_row_id` = '$tbl_row_id' LIMIT 1&quot;);&nbsp;</div></li><li><div>            if (0 &lt; pods_mysql_num_rows($result)) {&nbsp;</div></li><li><div>                $this-&gt;data['pod_id'] = pods_mysql_result($result, 0);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $this-&gt;data['pod_id'];&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Set a custom data value (no database changes)&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param string $name The field name&nbsp;</div></li><li><div>     * @param mixed $data The value to set&nbsp;</div></li><li><div>     * @return mixed The value of $data&nbsp;</div></li><li><div>     * @since 1.2.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function set_field($name, $data) {&nbsp;</div></li><li><div>        return $this-&gt;data[$name] = $data;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Run a helper within a Pod Page or WP Template or Magic Tags&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param string $helper The helper name&nbsp;</div></li><li><div>     * @return mixed Anything returned by the helper&nbsp;</div></li><li><div>     * @since 1.2.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function pod_helper($helper, $value = null, $name = null) {&nbsp;</div></li><li><div>        ob_start();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action('pods_pre_pod_helper', $helper, $value, $name, $this);&nbsp;</div></li><li><div>        do_action(&quot;pods_pre_pod_helper_{$helper}&quot;, $helper, $value, $name, $this);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $function_or_file = $helper;&nbsp;</div></li><li><div>        $check_function = $function_or_file;&nbsp;</div></li><li><div>        if ((!defined('PODS_STRICT_MODE') || !PODS_STRICT_MODE) && (!defined('PODS_HELPER_FUNCTIONS') || !PODS_HELPER_FUNCTIONS))&nbsp;</div></li><li><div>            $check_function = false;&nbsp;</div></li><li><div>        $check_file = null;&nbsp;</div></li><li><div>        if ((!defined('PODS_STRICT_MODE') || !PODS_STRICT_MODE) && (!defined('PODS_HELPER_FILES') || !PODS_HELPER_FILES))&nbsp;</div></li><li><div>            $check_file = false;&nbsp;</div></li><li><div>        if (false !== $check_function && false !== $check_file)&nbsp;</div></li><li><div>            $function_or_file = pods_function_or_file($function_or_file, $check_function, 'helper', $check_file);&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $function_or_file = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $content = false;&nbsp;</div></li><li><div>        if (!$function_or_file) {&nbsp;</div></li><li><div>            $api = new PodAPI();&nbsp;</div></li><li><div>            $params = array('name' =&gt; $helper, 'type' =&gt; 'display');&nbsp;</div></li><li><div>            if (!defined('PODS_STRICT_MODE') || !PODS_STRICT_MODE)&nbsp;</div></li><li><div>                $params = pods_sanitize($params);&nbsp;</div></li><li><div>            $content = $api-&gt;load_helper($params);&nbsp;</div></li><li><div>            if (false !== $content && 0 &lt; strlen(trim($content['phpcode'])))&nbsp;</div></li><li><div>                $content = $content['phpcode'];&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                $content = false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (false === $content && false !== $function_or_file && isset($function_or_file['function']))&nbsp;</div></li><li><div>            echo $function_or_file['function']($value, $name, $this);&nbsp;</div></li><li><div>        elseif (false === $content && false !== $function_or_file && isset($function_or_file['file']))&nbsp;</div></li><li><div>            locate_template($function_or_file['file'], true, true);&nbsp;</div></li><li><div>        elseif (false !== $content) {&nbsp;</div></li><li><div>            if (!defined('PODS_DISABLE_EVAL') || !PODS_DISABLE_EVAL)&nbsp;</div></li><li><div>                eval(&quot;?&gt;$content&quot;);&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                echo $content;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //post-helper hooks&nbsp;</div></li><li><div>        do_action('pods_post_pod_helper', $helper, $value, $name, $this);&nbsp;</div></li><li><div>        do_action(&quot;pods_post_pod_helper_{$helper}&quot;, $helper, $value, $name, $this);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return apply_filters('pods_helper', ob_get_clean(), $helper, $value, $this);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Get pod or category dropdown values&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_dropdown_values($params) {&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $params = (object) $params;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $params-&gt;orderby = empty($params-&gt;pick_orderby) ? '`name` ASC' : $params-&gt;pick_orderby;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // WP taxonomy dropdown&nbsp;</div></li><li><div>        if ('wp_taxonomy' == $params-&gt;table) {&nbsp;</div></li><li><div>            $where = (false !== $params-&gt;unique_vals) ? &quot;WHERE `t`.term_id NOT IN ({$params-&gt;unique_vals})&quot; : '';&nbsp;</div></li><li><div>            if (!empty($params-&gt;pick_filter)) {&nbsp;</div></li><li><div>                $where .= (empty($where) ? ' WHERE ' : ' AND ') . $params-&gt;pick_filter;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $sql = &quot;SELECT `t`.term_id AS id, `t`.`name` FROM `{$wpdb-&gt;term_taxonomy}` AS `tx` INNER JOIN `{$wpdb-&gt;terms}` AS `t` ON `t`.`term_id` = `tx`.`term_id` {$where} ORDER BY {$params-&gt;orderby}&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // WP page or post dropdown&nbsp;</div></li><li><div>        elseif ('wp_page' == $params-&gt;table || 'wp_post' == $params-&gt;table) {&nbsp;</div></li><li><div>            $post_type = substr($params-&gt;table, 3);&nbsp;</div></li><li><div>            $where = (false !== $params-&gt;unique_vals) ? &quot;AND `id` NOT IN ({$params-&gt;unique_vals})&quot; : '';&nbsp;</div></li><li><div>            if (!empty($params-&gt;pick_filter)) {&nbsp;</div></li><li><div>                $where .= &quot; AND {$params-&gt;pick_filter}&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $sql = &quot;SELECT `t`.ID AS id, `t`.post_title AS `name` FROM `{$wpdb-&gt;posts}` AS `t` WHERE `t`.`post_type` = '{$post_type}' {$where} ORDER BY {$params-&gt;orderby}&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // WP user dropdown&nbsp;</div></li><li><div>        elseif ('wp_user' == $params-&gt;table) {&nbsp;</div></li><li><div>            $where = (false !== $params-&gt;unique_vals) ? &quot;WHERE `id` NOT IN ({$params-&gt;unique_vals})&quot; : '';&nbsp;</div></li><li><div>            if (!empty($params-&gt;pick_filter)) {&nbsp;</div></li><li><div>                $where .= (empty($where) ? ' WHERE ' : ' AND ') . $params-&gt;pick_filter;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $sql = &quot;SELECT `t`.`ID` AS `id`, `t`.`display_name` AS `name` FROM `{$wpdb-&gt;users}` AS `t` {$where} ORDER BY {$params-&gt;orderby}&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // Pod table dropdown&nbsp;</div></li><li><div>        else {&nbsp;</div></li><li><div>            $where = (false !== $params-&gt;unique_vals) ? &quot;WHERE id NOT IN ({$params-&gt;unique_vals})&quot; : '';&nbsp;</div></li><li><div>            if (!empty($params-&gt;pick_filter)) {&nbsp;</div></li><li><div>                $where .= (empty($where) ? ' WHERE ' : ' AND ') . $params-&gt;pick_filter;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $sql = &quot;SELECT * FROM `@wp_pod_tbl_{$params-&gt;table}` AS `t` {$where} ORDER BY {$params-&gt;orderby}&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //override with custom dropdown values&nbsp;</div></li><li><div>        $sql = apply_filters('pods_get_dropdown_values', $sql, $params, $this);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $val = array();&nbsp;</div></li><li><div>        $result = pod_query($sql);&nbsp;</div></li><li><div>        while ($row = pods_mysql_fetch_assoc($result)) {&nbsp;</div></li><li><div>            $row['active'] = false;&nbsp;</div></li><li><div>            if (!empty($params-&gt;tbl_row_ids)) {&nbsp;</div></li><li><div>                $row['active'] = in_array($row['id'], $params-&gt;tbl_row_ids);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            elseif (isset($_GET[$params-&gt;field_name])) {&nbsp;</div></li><li><div>                if ('int' == $this-&gt;search_mode && $row['id'] == (int) $_GET[$params-&gt;field_name])&nbsp;</div></li><li><div>                    $row['active'] = true;&nbsp;</div></li><li><div>                elseif ('text' == $this-&gt;search_mode && $row['name'] == $_GET[$params-&gt;field_name])&nbsp;</div></li><li><div>                    $row['active'] = true;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $val[] = $row;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $val;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Setup fields for rabit hole&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function feed_rabit ($fields) {&nbsp;</div></li><li><div>        $feed = array();&nbsp;</div></li><li><div>        foreach ($fields as $field =&gt; $data) {&nbsp;</div></li><li><div>            if (!is_array($data))&nbsp;</div></li><li><div>                $field = $data;&nbsp;</div></li><li><div>            if (isset($_GET[$field]))&nbsp;</div></li><li><div>                $feed['traverse_' . $field] = array($field);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $feed;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Recursively join tables based on fields&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function recurse_rabit_hole ($pod, $fields, $joined = 't', $depth = 0) {&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (!isset($this-&gt;rabit_hole[$pod]))&nbsp;</div></li><li><div>            $this-&gt;rabit_hole[$pod] = array();&nbsp;</div></li><li><div>        $api = new PodAPI($pod);&nbsp;</div></li><li><div>        $pod_id = (int) $api-&gt;dt;&nbsp;</div></li><li><div>        foreach ($api-&gt;fields as $field) {&nbsp;</div></li><li><div>            if (!in_array($field['coltype'], array('pick', 'file')) && !isset($this-&gt;rabit_hole[$pod][$field['name']]))&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>            $the_pod = null;&nbsp;</div></li><li><div>            $table = $field['pickval'];&nbsp;</div></li><li><div>            $on = 'id';&nbsp;</div></li><li><div>            $name = 'name';&nbsp;</div></li><li><div>            $recurse = true;&nbsp;</div></li><li><div>            if ('file' == $field['coltype'] || 'wp_page' == $table || 'wp_post' == $table) {&nbsp;</div></li><li><div>                $table = $wpdb-&gt;posts;&nbsp;</div></li><li><div>                $on = 'ID';&nbsp;</div></li><li><div>                $name = 'post_title';&nbsp;</div></li><li><div>                $recurse = false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            elseif ('wp_taxonomy' == $table) {&nbsp;</div></li><li><div>                $table = $wpdb-&gt;terms;&nbsp;</div></li><li><div>                $on = 'term_id';&nbsp;</div></li><li><div>                $recurse = false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            elseif ('wp_user' == $table) {&nbsp;</div></li><li><div>                $table = $wpdb-&gt;users;&nbsp;</div></li><li><div>                $on = 'ID';&nbsp;</div></li><li><div>                $name = 'display_name';&nbsp;</div></li><li><div>                $recurse = false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            elseif (!empty($table)) {&nbsp;</div></li><li><div>                $the_pod = $table;&nbsp;</div></li><li><div>                $table = '@wp_pod_tbl_' . $table;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $rabit_hole = array_merge($field, &nbsp;</div></li><li><div>                                      array('table' =&gt; $table, &nbsp;</div></li><li><div>                                            'pod' =&gt; $the_pod, &nbsp;</div></li><li><div>                                            'on' =&gt; $on, &nbsp;</div></li><li><div>                                            'name' =&gt; $name, &nbsp;</div></li><li><div>                                            'recurse' =&gt; $recurse));&nbsp;</div></li><li><div>            if (isset($this-&gt;rabit_hole[$pod][$field['name']]))&nbsp;</div></li><li><div>                $rabit_hole = array_merge($rabit_hole, (array) $this-&gt;rabit_hole[$pod][$field['name']]);&nbsp;</div></li><li><div>            $this-&gt;rabit_hole[$pod][$field['name']] = apply_filters('pods_rabit_hole', $rabit_hole, $pod, $fields, $joined, $depth);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        unset($api);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $joins = array();&nbsp;</div></li><li><div>        if (!isset($fields[$depth]) || empty($fields[$depth]))&nbsp;</div></li><li><div>            return $joins;&nbsp;</div></li><li><div>        $field = $fields[$depth];&nbsp;</div></li><li><div>        if (!isset($this-&gt;rabit_hole[$pod][$field]))&nbsp;</div></li><li><div>            return $joins;&nbsp;</div></li><li><div>        $this-&gt;rabit_hole[$pod][$field] = array_merge(array('table' =&gt; null, &nbsp;</div></li><li><div>                                                            'pod' =&gt; null, &nbsp;</div></li><li><div>                                                            'on' =&gt; 'id', &nbsp;</div></li><li><div>                                                            'name' =&gt; 'name', &nbsp;</div></li><li><div>                                                            'recurse' =&gt; false, &nbsp;</div></li><li><div>                                                            'id' =&gt; 0, &nbsp;</div></li><li><div>                                                            'coltype' =&gt; null), &nbsp;</div></li><li><div>                                                      $this-&gt;rabit_hole[$pod][$field]);&nbsp;</div></li><li><div>        $this-&gt;rabit_hole[$pod][$field]['id'] = (int) $this-&gt;rabit_hole[$pod][$field]['id'];&nbsp;</div></li><li><div>        $field_joined = $field;&nbsp;</div></li><li><div>        if (0 &lt; $depth && 't' != $joined)&nbsp;</div></li><li><div>            $field_joined = $joined . '_' . $field;&nbsp;</div></li><li><div>        if (false !== $this-&gt;search) {&nbsp;</div></li><li><div>            if (0 &lt; strlen(pods_var($field_joined, 'get'))) {&nbsp;</div></li><li><div>                $val = absint(pods_var($field_joined, 'get'));&nbsp;</div></li><li><div>                $on = $this-&gt;rabit_hole[$pod][$field]['on'];&nbsp;</div></li><li><div>                $search = &quot;`{$field_joined}`.`{$on}` = {$val}&quot;;&nbsp;</div></li><li><div>                if ('text' == $this-&gt;search_mode) {&nbsp;</div></li><li><div>                    $val = pods_var($field_joined, 'get');&nbsp;</div></li><li><div>                    $on = $this-&gt;rabit_hole[$pod][$field]['name'];&nbsp;</div></li><li><div>                    $search = &quot;`{$field_joined}`.`{$on}` = '{$val}'&quot;;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                elseif ('text_like' == $this-&gt;search_mode) {&nbsp;</div></li><li><div>                    $val = pods_sanitize(like_escape($_GET[$field_joined]));&nbsp;</div></li><li><div>                    $on = $this-&gt;rabit_hole[$pod][$field]['name'];&nbsp;</div></li><li><div>                    $search = &quot;`{$field_joined}`.`{$on}` LIKE '%{$val}%'&quot;;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $this-&gt;search_where .= &quot; AND {$search} &quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $p_alias = 'p';&nbsp;</div></li><li><div>        $p_join = '';&nbsp;</div></li><li><div>        if (0 &lt; $depth && 't' != $joined) {&nbsp;</div></li><li><div>            $p_alias = 'p_' . $joined;&nbsp;</div></li><li><div>            $p_join = &quot;&nbsp;</div></li><li><div>            LEFT JOIN `@wp_pod` AS `{$p_alias}` ON `{$p_alias}`.`datatype` = {$pod_id} AND `{$p_alias}`.`tbl_row_id` = `{$joined}`.`id`&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $rel_alias = 'rel_' . $field_joined;&nbsp;</div></li><li><div>        $the_join = &quot;{$p_join}&nbsp;</div></li><li><div>            LEFT JOIN `@wp_pod_rel` AS `{$rel_alias}` ON `{$rel_alias}`.`field_id` = {$this-&gt;rabit_hole[$pod][$field]['id']} AND `{$rel_alias}`.`pod_id` = `{$p_alias}`.id&nbsp;</div></li><li><div>            LEFT JOIN `{$this-&gt;rabit_hole[$pod][$field]['table']}` AS `{$field_joined}` ON `{$field_joined}`.`{$this-&gt;rabit_hole[$pod][$field]['on']}` = `{$rel_alias}`.`tbl_row_id`&nbsp;</div></li><li><div>        &quot;;&nbsp;</div></li><li><div>        if (!in_array($this-&gt;rabit_hole[$pod][$field]['coltype'], array('pick', 'file'))) {&nbsp;</div></li><li><div>            $the_join = &quot;&nbsp;</div></li><li><div>            LEFT JOIN `{$this-&gt;rabit_hole[$pod][$field]['table']}` AS `{$field_joined}` ON `{$field_joined}`.`{$this-&gt;rabit_hole[$pod][$field]['on']}` = CONVERT(`{$joined}`.`{$field_joined}`, SIGNED)&nbsp;</div></li><li><div>            &quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $joins[$pod . '_' . $depth . '_' . $this-&gt;rabit_hole[$pod][$field]['id']] = apply_filters('pods_rabit_hole_the_join', $the_join, $pod, $fields, $joined, $depth, $this);&nbsp;</div></li><li><div>        if (($depth + 1) &lt; count($fields) && null !== $this-&gt;rabit_hole[$pod][$field]['pod'] && false !== $this-&gt;rabit_hole[$pod][$field]['recurse'])&nbsp;</div></li><li><div>            $joins = array_merge($joins, $this-&gt;recurse_rabit_hole($this-&gt;rabit_hole[$pod][$field]['pod'], $fields, $field_joined, ($depth + 1)));&nbsp;</div></li><li><div>        return $joins;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Recursively join tables based on fields&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function rabit_hole ($pod, $fields = null) {&nbsp;</div></li><li><div>        $joins = array();&nbsp;</div></li><li><div>        if (null === $fields) {&nbsp;</div></li><li><div>            $api = new PodAPI($pod);&nbsp;</div></li><li><div>            $fields = $this-&gt;feed_rabit($api-&gt;fields);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        foreach ((array) $fields as $field_group) {&nbsp;</div></li><li><div>            if (is_array($field_group))&nbsp;</div></li><li><div>                $joins = array_merge($joins, $this-&gt;recurse_rabit_hole($pod, $field_group));&nbsp;</div></li><li><div>            else {&nbsp;</div></li><li><div>                $joins = array_merge($joins, $this-&gt;recurse_rabit_hole($pod, $fields));&nbsp;</div></li><li><div>                $joins = array_filter($joins);&nbsp;</div></li><li><div>                return $joins;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $joins = array_filter($joins);&nbsp;</div></li><li><div>        return $joins;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Return a single record&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function getRecordById($id) {&nbsp;</div></li><li><div>        if (empty($this-&gt;datatype_id)) {&nbsp;</div></li><li><div>            echo &quot;&lt;e&gt;Error: Pod name invalid&lt;/e&gt;&quot;;&nbsp;</div></li><li><div>            return null;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>        $datatype = $this-&gt;datatype;&nbsp;</div></li><li><div>        $datatype_id = $this-&gt;datatype_id;&nbsp;</div></li><li><div>        if ($this-&gt;is_val($datatype)) {&nbsp;</div></li><li><div>            $this-&gt;result = null;&nbsp;</div></li><li><div>            if (is_numeric($id)) {&nbsp;</div></li><li><div>                $id = (int) $id;&nbsp;</div></li><li><div>                $sql = &quot;&nbsp;</div></li><li><div>                SELECT&nbsp;</div></li><li><div>                    DISTINCT `t`.*, `p`.`id` AS `pod_id`, `p`.`created`, `p`.`modified`&nbsp;</div></li><li><div>                FROM&nbsp;</div></li><li><div>                    `@wp_pod` AS `p`&nbsp;</div></li><li><div>                INNER JOIN&nbsp;</div></li><li><div>                    `@wp_pod_tbl_{$datatype}` AS `t` ON `t`.`id` = `p`.`tbl_row_id`&nbsp;</div></li><li><div>                WHERE&nbsp;</div></li><li><div>                    `p`.`datatype` = {$datatype_id}&nbsp;</div></li><li><div>                    AND `t`.`id` = {$id}&nbsp;</div></li><li><div>                LIMIT 1&nbsp;</div></li><li><div>                &quot;;&nbsp;</div></li><li><div>                $this-&gt;raw_sql = $sql;&nbsp;</div></li><li><div>                $this-&gt;sql = str_replace('@wp_', $wpdb-&gt;prefix, $sql);&nbsp;</div></li><li><div>                $this-&gt;result = pod_query($sql);&nbsp;</div></li><li><div>                $this-&gt;row_number = 0;&nbsp;</div></li><li><div>                $this-&gt;zebra = false;&nbsp;</div></li><li><div>                $this-&gt;total = $this-&gt;total_rows = 1;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            else {&nbsp;</div></li><li><div>                // Get the slug column&nbsp;</div></li><li><div>                $fields_result = pod_query(&quot;SELECT name FROM @wp_pod_fields WHERE coltype = 'slug' AND datatype = $this-&gt;datatype_id LIMIT 1&quot;);&nbsp;</div></li><li><div>                if (0 &lt; pods_mysql_num_rows($fields_result)) {&nbsp;</div></li><li><div>                    $field_name = pods_mysql_result($fields_result, 0);&nbsp;</div></li><li><div>                    $sql = &quot;&nbsp;</div></li><li><div>                    SELECT&nbsp;</div></li><li><div>                        DISTINCT `t`.*, `p`.`id` AS `pod_id`, `p`.`created`, `p`.`modified`&nbsp;</div></li><li><div>                    FROM&nbsp;</div></li><li><div>                        `@wp_pod` AS `p`&nbsp;</div></li><li><div>                    INNER JOIN&nbsp;</div></li><li><div>                        `@wp_pod_tbl_{$datatype}` AS `t` ON `t`.`id` = `p`.`tbl_row_id`&nbsp;</div></li><li><div>                    WHERE&nbsp;</div></li><li><div>                        `p`.`datatype` = {$datatype_id}&nbsp;</div></li><li><div>                        AND `t`.`{$field_name}` = '{$id}'&nbsp;</div></li><li><div>                    LIMIT 1&nbsp;</div></li><li><div>                    &quot;;&nbsp;</div></li><li><div>                    $this-&gt;raw_sql = $sql;&nbsp;</div></li><li><div>                    $this-&gt;sql = str_replace('@wp_', $wpdb-&gt;prefix, $sql);&nbsp;</div></li><li><div>                    $this-&gt;result = pod_query($sql);&nbsp;</div></li><li><div>                    $this-&gt;row_number = 0;&nbsp;</div></li><li><div>                    $this-&gt;zebra = false;&nbsp;</div></li><li><div>                    $this-&gt;total = $this-&gt;total_rows = 1;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if (0 &lt; pods_mysql_num_rows($this-&gt;result)) {&nbsp;</div></li><li><div>                $this-&gt;data = pods_mysql_fetch_assoc($this-&gt;result);&nbsp;</div></li><li><div>                $this-&gt;data['type'] = $datatype;&nbsp;</div></li><li><div>                return $this-&gt;data;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $this-&gt;data = false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            die('&lt;e&gt;Datatype not set');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Search and filter records&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function findRecords($orderby = '`t`.`id` DESC', $rows_per_page = 15, $where = null, $sql = null) {&nbsp;</div></li><li><div>        if (empty($this-&gt;datatype_id)) {&nbsp;</div></li><li><div>            echo &quot;&lt;e&gt;Error: Pod name invalid&lt;/e&gt;&quot;;&nbsp;</div></li><li><div>            return null;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>        $join = $groupby = $having = '';&nbsp;</div></li><li><div>        $params = null;&nbsp;</div></li><li><div>        $select = '`t`.*, `p`.`id` AS `pod_id`, `p`.`created`, `p`.`modified`';&nbsp;</div></li><li><div>        $this-&gt;traverse = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $defaults = array('select' =&gt; $select, &nbsp;</div></li><li><div>                          'join' =&gt; $join, &nbsp;</div></li><li><div>                          'where' =&gt; $where, &nbsp;</div></li><li><div>                          'groupby' =&gt; $groupby, &nbsp;</div></li><li><div>                          'having' =&gt; $having, &nbsp;</div></li><li><div>                          'orderby' =&gt; (is_array($orderby) ? '`t`.`id` DESC' : $orderby), &nbsp;</div></li><li><div>                          'limit' =&gt; $rows_per_page, &nbsp;</div></li><li><div>                          'offset' =&gt; null, &nbsp;</div></li><li><div>                          'search' =&gt; $this-&gt;search, &nbsp;</div></li><li><div>                          'search_var' =&gt; $this-&gt;search_var, &nbsp;</div></li><li><div>                          'search_mode' =&gt; $this-&gt;search_mode, &nbsp;</div></li><li><div>                          'traverse' =&gt; $this-&gt;traverse, &nbsp;</div></li><li><div>                          'page' =&gt; $this-&gt;page, &nbsp;</div></li><li><div>                          'page_var' =&gt; null, &nbsp;</div></li><li><div>                          'pagination' =&gt; $this-&gt;pagination, &nbsp;</div></li><li><div>                          'calc_found_rows' =&gt; $this-&gt;calc_found_rows, &nbsp;</div></li><li><div>                          'count_found_rows' =&gt; $this-&gt;count_found_rows, &nbsp;</div></li><li><div>                          'sql' =&gt; $sql);&nbsp;</div></li><li><div>        $defaults = (array) apply_filters('pods_findrecords_defaults', $defaults, $orderby, $this);&nbsp;</div></li><li><div>        $params = (object) $defaults;&nbsp;</div></li><li><div>        if (is_array($orderby) && !empty($orderby))&nbsp;</div></li><li><div>            $params = (object) array_merge($defaults, $orderby);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (0 &lt; strlen($params-&gt;select))&nbsp;</div></li><li><div>            $select = $params-&gt;select;&nbsp;</div></li><li><div>        $join = $params-&gt;join;&nbsp;</div></li><li><div>        $this-&gt;search = (boolean) $params-&gt;search;&nbsp;</div></li><li><div>        $this-&gt;search_var = $params-&gt;search_var;&nbsp;</div></li><li><div>        $this-&gt;search_mode = (in_array($params-&gt;search_mode, array('int', 'text')) ? $params-&gt;search_mode : 'int');&nbsp;</div></li><li><div>        $this-&gt;traverse = (array) $params-&gt;traverse;&nbsp;</div></li><li><div>        $where = $params-&gt;where;&nbsp;</div></li><li><div>        $groupby = $params-&gt;groupby;&nbsp;</div></li><li><div>        $having = $params-&gt;having;&nbsp;</div></li><li><div>        $orderby = $params-&gt;orderby;&nbsp;</div></li><li><div>        $rows_per_page = (int) $params-&gt;limit;&nbsp;</div></li><li><div>        $this-&gt;page = (int) $params-&gt;page;&nbsp;</div></li><li><div>        if (null !== $params-&gt;page_var)&nbsp;</div></li><li><div>            $this-&gt;page_var = (int) $params-&gt;page_var;&nbsp;</div></li><li><div>        if ($this-&gt;page &lt; 1 || null !== $params-&gt;page_var)&nbsp;</div></li><li><div>            $this-&gt;page = max(pods_var($this-&gt;page_var, 'get'), 1);&nbsp;</div></li><li><div>        $this-&gt;pagination = (bool) $params-&gt;pagination;&nbsp;</div></li><li><div>        $this-&gt;calc_found_rows = (boolean) $params-&gt;calc_found_rows;&nbsp;</div></li><li><div>        $this-&gt;count_found_rows = (boolean) $params-&gt;count_found_rows;&nbsp;</div></li><li><div>        $sql = $params-&gt;sql;&nbsp;</div></li><li><div>        if (true === $this-&gt;count_found_rows && empty($sql))&nbsp;</div></li><li><div>            $this-&gt;calc_found_rows = false;&nbsp;</div></li><li><div>        $page = (int) $this-&gt;page;&nbsp;</div></li><li><div>        if ($rows_per_page &lt; 0 || false === $this-&gt;pagination)&nbsp;</div></li><li><div>            $page = $this-&gt;page = 1;&nbsp;</div></li><li><div>        $datatype = $this-&gt;datatype;&nbsp;</div></li><li><div>        $datatype_id = (int) $this-&gt;datatype_id;&nbsp;</div></li><li><div>        $this-&gt;rpp = (int) $rows_per_page;&nbsp;</div></li><li><div>        $this-&gt;offset = ($this-&gt;rpp * ($page - 1));&nbsp;</div></li><li><div>        if (null !== $params-&gt;offset)&nbsp;</div></li><li><div>            $this-&gt;offset += (int) $params-&gt;offset;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $sql_builder = false;&nbsp;</div></li><li><div>        if (empty($sql)) {&nbsp;</div></li><li><div>            $sql_builder = true;&nbsp;</div></li><li><div>            $limit = $this-&gt;search_where = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // ctype_digit expects a string, or it returns FALSE&nbsp;</div></li><li><div>            if (ctype_digit(&quot;$rows_per_page&quot;) && 0 &lt;= $rows_per_page) {&nbsp;</div></li><li><div>                $limit = $this-&gt;offset . ', ' . $rows_per_page;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            elseif (false !== strpos($rows_per_page, ', ')) {&nbsp;</div></li><li><div>                // Custom offset&nbsp;</div></li><li><div>                $limit = $rows_per_page;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $where = empty($where) ? '' : &quot; AND ( $where )&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if (false !== $this-&gt;search) {&nbsp;</div></li><li><div>                // Handle search&nbsp;</div></li><li><div>                if (0 &lt; strlen(pods_var($this-&gt;search_var, 'get'))) {&nbsp;</div></li><li><div>                    $val = pods_sanitize(like_escape($_GET[$this-&gt;search_var]));&nbsp;</div></li><li><div>                    $this-&gt;search_where = &quot; AND (`t`.`name` LIKE '%{$val}%') &quot;;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Add &quot;`t`.&quot; prefix to $orderby if needed&nbsp;</div></li><li><div>            if (!empty($orderby) && false === strpos($orderby, ', ') && false === strpos($orderby, '(') && false === strpos($orderby, '.')) {&nbsp;</div></li><li><div>                if (false !== strpos($orderby, ' ASC'))&nbsp;</div></li><li><div>                    $orderby = '`t`.`' . trim(str_replace(array('`', ' ASC'), '', $orderby)) . '` ASC';&nbsp;</div></li><li><div>                else&nbsp;</div></li><li><div>                    $orderby = '`t`.`' . trim(str_replace(array('`', ' DESC'), '', $orderby)) . '` DESC';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $haystack = preg_replace('/\s/', ' ', &quot;$select $where $groupby $having $orderby&quot;);&nbsp;</div></li><li><div>            $haystack = preg_replace('/\w\(/', ' ', $haystack);&nbsp;</div></li><li><div>            $haystack = str_replace(array('(', ')', '  '), ' ', $haystack);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            preg_match_all('/`?[\w]+`?(?:\\.`?[\w]+`?)+(?=[^&quot;\']*(?:&quot;[^&quot;]*&quot;[^&quot;]*|\'[^\']*\'[^\']*)*$)/', $haystack, $found, PREG_PATTERN_ORDER);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $found = (array) @current($found);&nbsp;</div></li><li><div>            $find = $replace = array();&nbsp;</div></li><li><div>            foreach ($found as $key =&gt; $value) {&nbsp;</div></li><li><div>                $value = str_replace('`', '', $value);&nbsp;</div></li><li><div>                $value = explode('.', $value);&nbsp;</div></li><li><div>                $dot = array_pop($value);&nbsp;</div></li><li><div>                if (in_array('/\b' . trim($found[$key], '`') . '\b(?=[^&quot;\']*(?:&quot;[^&quot;]*&quot;[^&quot;]*|\'[^\']*\'[^\']*)*$)/', $find)) {&nbsp;</div></li><li><div>                    unset($found[$key]);&nbsp;</div></li><li><div>                    continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $find[$key] = '/\b' . trim($found[$key], '`') . '\b(?=[^&quot;\']*(?:&quot;[^&quot;]*&quot;[^&quot;]*|\'[^\']*\'[^\']*)*$)/';&nbsp;</div></li><li><div>                $esc_start = $esc_end = '`';&nbsp;</div></li><li><div>                if (strlen(ltrim($found[$key], '`')) &lt; strlen($found[$key]))&nbsp;</div></li><li><div>                    $esc_start = '';&nbsp;</div></li><li><div>                if (strlen(rtrim($found[$key], '`')) &lt; strlen($found[$key]))&nbsp;</div></li><li><div>                    $esc_end = '';&nbsp;</div></li><li><div>                if ('*' != $dot)&nbsp;</div></li><li><div>                    $dot = '`' . $dot . $esc_end;&nbsp;</div></li><li><div>                $replace[$key] = $esc_start . implode('_', $value) . '`.' . $dot;&nbsp;</div></li><li><div>                if (in_array($value[0], array('t', 'p'))) {&nbsp;</div></li><li><div>                    unset($found[$key]);&nbsp;</div></li><li><div>                    continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                unset($found[$key]);&nbsp;</div></li><li><div>                if (!in_array($value, $found))&nbsp;</div></li><li><div>                    $found[$key] = $value;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if (!empty($this-&gt;traverse)) {&nbsp;</div></li><li><div>                foreach ((array) $this-&gt;traverse as $key =&gt; $traverse) {&nbsp;</div></li><li><div>                    $traverse = str_replace('`', '', $traverse);&nbsp;</div></li><li><div>                    $already_found = false;&nbsp;</div></li><li><div>                    foreach ($found as $traversal) {&nbsp;</div></li><li><div>                        if (is_array($traversal))&nbsp;</div></li><li><div>                            $traversal = implode('.', $traversal);&nbsp;</div></li><li><div>                        if ($traversal == $traverse) {&nbsp;</div></li><li><div>                            $already_found = true;&nbsp;</div></li><li><div>                            break;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (!$already_found)&nbsp;</div></li><li><div>                        $found['traverse_' . $key] = explode('.', $traverse);&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $joins = array();&nbsp;</div></li><li><div>            if (!empty($find)) {&nbsp;</div></li><li><div>                $select = preg_replace($find, $replace, $select);&nbsp;</div></li><li><div>                $where = preg_replace($find, $replace, $where);&nbsp;</div></li><li><div>                $groupby = preg_replace($find, $replace, $groupby);&nbsp;</div></li><li><div>                $having = preg_replace($find, $replace, $having);&nbsp;</div></li><li><div>                $orderby = preg_replace($find, $replace, $orderby);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if (!empty($found))&nbsp;</div></li><li><div>                    $joins = $this-&gt;rabit_hole($this-&gt;datatype, $found);&nbsp;</div></li><li><div>                elseif (false !== $this-&gt;search)&nbsp;</div></li><li><div>                    $joins = $this-&gt;rabit_hole($this-&gt;datatype);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if (0 &lt; strlen($join)) {&nbsp;</div></li><li><div>                $joins[] = &quot;&nbsp;</div></li><li><div>                    {$join}&nbsp;</div></li><li><div>                &quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $join = apply_filters('pods_findrecords_join', implode(' ', $joins), $params, $this);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $groupby = trim($groupby);&nbsp;</div></li><li><div>            $orderby = trim($orderby);&nbsp;</div></li><li><div>            $limit = trim($limit);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $calc_found_rows = '';&nbsp;</div></li><li><div>            if (false !== $this-&gt;calc_found_rows)&nbsp;</div></li><li><div>                $calc_found_rows = 'SQL_CALC_FOUND_ROWS';&nbsp;</div></li><li><div>            $sql = &quot;&nbsp;</div></li><li><div>            SELECT&nbsp;</div></li><li><div>                {$calc_found_rows} DISTINCT {$select}&nbsp;</div></li><li><div>            FROM&nbsp;</div></li><li><div>                `@wp_pod` AS `p`&nbsp;</div></li><li><div>            INNER JOIN&nbsp;</div></li><li><div>                `@wp_pod_tbl_{$datatype}` AS `t` ON `t`.`id` = `p`.`tbl_row_id`&nbsp;</div></li><li><div>            {$join}&nbsp;</div></li><li><div>            WHERE&nbsp;</div></li><li><div>                `p`.`datatype` = {$datatype_id}&quot;;&nbsp;</div></li><li><div>            if (!empty($this-&gt;search_where)) {&nbsp;</div></li><li><div>                $sql .= &quot;&nbsp;</div></li><li><div>                {$this-&gt;search_where}&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if (!empty($where)) {&nbsp;</div></li><li><div>                $sql .= &quot;&nbsp;</div></li><li><div>                {$where}&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if (!empty($groupby)) {&nbsp;</div></li><li><div>                $sql .= &quot;&nbsp;</div></li><li><div>            GROUP BY {$groupby}&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if (!empty($having)) {&nbsp;</div></li><li><div>                $sql .= &quot;&nbsp;</div></li><li><div>            HAVING {$having}&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if (!empty($orderby)) {&nbsp;</div></li><li><div>                $sql .= &quot;&nbsp;</div></li><li><div>            ORDER BY {$orderby}&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if (!empty($limit)) {&nbsp;</div></li><li><div>                $sql .= &quot;&nbsp;</div></li><li><div>            LIMIT {$limit}&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $this-&gt;raw_sql = $sql;&nbsp;</div></li><li><div>        $this-&gt;sql = str_replace('@wp_', $wpdb-&gt;prefix, $sql);&nbsp;</div></li><li><div>        $this-&gt;result = pod_query($sql);&nbsp;</div></li><li><div>        $this-&gt;row_number = -1;&nbsp;</div></li><li><div>        $this-&gt;zebra = false;&nbsp;</div></li><li><div>        $this-&gt;total = absint(@pods_mysql_num_rows($this-&gt;result));&nbsp;</div></li><li><div>        if (false !== $this-&gt;calc_found_rows) {&nbsp;</div></li><li><div>            $this-&gt;total_rows = pod_query(&quot;SELECT FOUND_ROWS()&quot;);&nbsp;</div></li><li><div>            $this-&gt;getTotalRows();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif (false !== $this-&gt;count_found_rows && false !== $sql_builder) {&nbsp;</div></li><li><div>            $sql = &quot;&nbsp;</div></li><li><div>            SELECT&nbsp;</div></li><li><div>                COUNT(*) AS `found_rows`&nbsp;</div></li><li><div>            FROM&nbsp;</div></li><li><div>                `@wp_pod` AS `p`&nbsp;</div></li><li><div>            INNER JOIN&nbsp;</div></li><li><div>                `@wp_pod_tbl_{$datatype}` AS `t` ON `t`.`id` = `p`.`tbl_row_id`&nbsp;</div></li><li><div>            {$join}&nbsp;</div></li><li><div>            WHERE&nbsp;</div></li><li><div>                `p`.`datatype` = {$datatype_id}&quot;;&nbsp;</div></li><li><div>            if (!empty($this-&gt;search_where)) {&nbsp;</div></li><li><div>                $sql .= &quot;&nbsp;</div></li><li><div>                {$this-&gt;search_where}&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if (!empty($where)) {&nbsp;</div></li><li><div>                $sql .= &quot;&nbsp;</div></li><li><div>                {$where}&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if (!empty($groupby)) {&nbsp;</div></li><li><div>                $sql .= &quot;&nbsp;</div></li><li><div>            GROUP BY {$groupby}&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if (!empty($having)) {&nbsp;</div></li><li><div>                $sql .= &quot;&nbsp;</div></li><li><div>            HAVING {$having}&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $this-&gt;total_rows = pod_query($sql);&nbsp;</div></li><li><div>            $this-&gt;getTotalRows();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Fetch the total row count&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function getTotalRows() {&nbsp;</div></li><li><div>        if (false === is_numeric($this-&gt;total_rows)) {&nbsp;</div></li><li><div>            if ($row = pods_mysql_fetch_array($this-&gt;total_rows))&nbsp;</div></li><li><div>                $this-&gt;total_rows = $row[0];&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                $this-&gt;total_rows = 0;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return (int) $this-&gt;total_rows;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Fetch the current row number&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function getRowNumber() {&nbsp;</div></li><li><div>        return (int) $this-&gt;row_number;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Fetch the current row number&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function getZebra() {&nbsp;</div></li><li><div>        return (boolean) $this-&gt;zebra;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * (Re)set the MySQL result pointer&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function resetPointer($row_number = 0) {&nbsp;</div></li><li><div>        $row_number = absint($row_number);&nbsp;</div></li><li><div>        if (0 &lt; pods_mysql_num_rows($this-&gt;result)) {&nbsp;</div></li><li><div>            $this-&gt;row_number = $row_number;&nbsp;</div></li><li><div>            $this-&gt;zebra = false;&nbsp;</div></li><li><div>            return pods_mysql_data_seek($this-&gt;result, $row_number);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display HTML for all datatype fields&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function showform($pod_id = null, $public_columns = null, $label = 'Save changes') {&nbsp;</div></li><li><div>        if (empty($this-&gt;datatype_id)) {&nbsp;</div></li><li><div>            echo &quot;&lt;e&gt;Error: Pod name invalid&lt;/e&gt;&quot;;&nbsp;</div></li><li><div>            return null;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $pod_id = absint($pod_id);&nbsp;</div></li><li><div>        $cache = PodCache::instance();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $datatype = $this-&gt;datatype;&nbsp;</div></li><li><div>        $datatype_id = (int) $this-&gt;datatype_id;&nbsp;</div></li><li><div>        $this-&gt;data['pod_id'] = $pod_id = (int) $pod_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $where = '';&nbsp;</div></li><li><div>        if (!empty($public_columns)) {&nbsp;</div></li><li><div>            foreach ($public_columns as $key =&gt; $val) {&nbsp;</div></li><li><div>                if (is_array($public_columns[$key])) {&nbsp;</div></li><li><div>                    $where[] = $key;&nbsp;</div></li><li><div>                    $attributes[$key] = $val;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                else {&nbsp;</div></li><li><div>                    $where[] = $val;&nbsp;</div></li><li><div>                    $attributes[$val] = array();&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $where = &quot;AND name IN ('&quot; . implode(&quot;', '&quot;, $where) . &quot;')&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $result = pod_query(&quot;SELECT * FROM @wp_pod_fields WHERE datatype = $datatype_id $where ORDER BY weight ASC&quot;);&nbsp;</div></li><li><div>        $public_columns = array();&nbsp;</div></li><li><div>        while ($row = pods_mysql_fetch_assoc($result)) {&nbsp;</div></li><li><div>            $fields[$row['name']] = $row;&nbsp;</div></li><li><div>            $public_columns[] = $row['name'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Re-order the fields if a public form&nbsp;</div></li><li><div>        if (!empty($attributes)) {&nbsp;</div></li><li><div>            $tmp = $fields;&nbsp;</div></li><li><div>            $fields = array();&nbsp;</div></li><li><div>            foreach ($attributes as $key =&gt; $val) {&nbsp;</div></li><li><div>                if (isset($tmp[$key]))&nbsp;</div></li><li><div>                    $fields[$key] = $tmp[$key];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            unset($tmp);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Edit an existing item&nbsp;</div></li><li><div>        if (!empty($pod_id)) {&nbsp;</div></li><li><div>            $sql = &quot;&nbsp;</div></li><li><div>            SELECT&nbsp;</div></li><li><div>                `t`.*&nbsp;</div></li><li><div>            FROM&nbsp;</div></li><li><div>                @wp_pod `p`&nbsp;</div></li><li><div>            INNER JOIN&nbsp;</div></li><li><div>                `@wp_pod_tbl_{$datatype}` AS `t` ON `t`.`id` = `p`.`tbl_row_id`&nbsp;</div></li><li><div>            WHERE&nbsp;</div></li><li><div>                `p`.`id` = {$pod_id}&nbsp;</div></li><li><div>            LIMIT&nbsp;</div></li><li><div>                1&nbsp;</div></li><li><div>            &quot;;&nbsp;</div></li><li><div>            $result = pod_query($sql);&nbsp;</div></li><li><div>            if (0 &lt; pods_mysql_num_rows($result)) {&nbsp;</div></li><li><div>                $tbl_cols = pods_mysql_fetch_assoc($result);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $uri_hash = wp_hash($_SERVER['REQUEST_URI']);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action('pods_showform_pre', $pod_id, $public_columns, $label, $this);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ($fields as $key =&gt; $field) {&nbsp;</div></li><li><div>            // Replace field attributes with public form attributes&nbsp;</div></li><li><div>            if (!empty($attributes) && is_array($attributes[$key])) {&nbsp;</div></li><li><div>                $field = array_merge($field, $attributes[$key]);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if (empty($field['label'])) {&nbsp;</div></li><li><div>                $field['label'] = ucwords($key);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if (1 == $field['required']) {&nbsp;</div></li><li><div>                $field['label'] .= ' &lt;span class=&quot;red&quot;&gt;*&lt;/span&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if (!empty($field['pickval'])) {&nbsp;</div></li><li><div>                $val = array();&nbsp;</div></li><li><div>                $tbl_row_ids = array();&nbsp;</div></li><li><div>                $table = $field['pickval'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $result = pod_query(&quot;SELECT `id` FROM `@wp_pod_fields` WHERE `datatype` = {$datatype_id} AND `name` = '$key' LIMIT 1&quot;);&nbsp;</div></li><li><div>                $field_id = (int) pods_mysql_result($result, 0);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $result = pod_query(&quot;SELECT `tbl_row_id` FROM `@wp_pod_rel` WHERE `field_id` = {$field_id} AND `pod_id` = {$pod_id}&quot;);&nbsp;</div></li><li><div>                while ($row = pods_mysql_fetch_assoc($result)) {&nbsp;</div></li><li><div>                    $tbl_row_ids[] = (int) $row['tbl_row_id'];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // Use default values for public forms&nbsp;</div></li><li><div>                if (empty($tbl_row_ids) && !empty($field['default'])) {&nbsp;</div></li><li><div>                    $tbl_row_ids = $field['default'];&nbsp;</div></li><li><div>                    if (!is_array($field['default'])) {&nbsp;</div></li><li><div>                        $tbl_row_ids = explode(', ', $tbl_row_ids);&nbsp;</div></li><li><div>                        foreach ($tbl_row_ids as $row_key =&gt; $row_val) {&nbsp;</div></li><li><div>                            $tbl_row_ids[$row_key] = (int) trim($row_val);&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // If the PICK column is unique, get values already chosen&nbsp;</div></li><li><div>                $unique_vals = false;&nbsp;</div></li><li><div>                if (1 == $field['unique']) {&nbsp;</div></li><li><div>                    $exclude = empty($pod_id) ? '' : &quot;AND `pod_id` != {$pod_id}&quot;;&nbsp;</div></li><li><div>                    $result = pod_query(&quot;SELECT `tbl_row_id` FROM `@wp_pod_rel` WHERE `field_id` = {$field_id} {$exclude}&quot;);&nbsp;</div></li><li><div>                    if (0 &lt; pods_mysql_num_rows($result)) {&nbsp;</div></li><li><div>                        $unique_vals = array();&nbsp;</div></li><li><div>                        while ($row = pods_mysql_fetch_assoc($result)) {&nbsp;</div></li><li><div>                            $unique_vals[] = (int) $row['tbl_row_id'];&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        $unique_vals = implode(', ', $unique_vals);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $params = array(&nbsp;</div></li><li><div>                    'table' =&gt; $table, &nbsp;</div></li><li><div>                    'field_name' =&gt; null, &nbsp;</div></li><li><div>                    'tbl_row_ids' =&gt; $tbl_row_ids, &nbsp;</div></li><li><div>                    'unique_vals' =&gt; $unique_vals, &nbsp;</div></li><li><div>                    'pick_filter' =&gt; $field['pick_filter'], &nbsp;</div></li><li><div>                    'pick_orderby' =&gt; $field['pick_orderby']&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                $this-&gt;data[$key] = $this-&gt;get_dropdown_values($params);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            else {&nbsp;</div></li><li><div>                // Set a default value if no value is entered&nbsp;</div></li><li><div>                if (!isset($this-&gt;data[$key]) && !empty($field['default'])) {&nbsp;</div></li><li><div>                    $this-&gt;data[$key] = $field['default'];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                else {&nbsp;</div></li><li><div>                    $this-&gt;data[$key] = isset($tbl_cols[$key]) && $this-&gt;is_val($tbl_cols[$key]) ? $tbl_cols[$key] : null;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $this-&gt;build_field_html($field);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $uri_hash = wp_hash($_SERVER['REQUEST_URI']);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $save_button_atts = array(&nbsp;</div></li><li><div>            'type' =&gt; 'button', &nbsp;</div></li><li><div>            'class' =&gt; 'button btn_save', &nbsp;</div></li><li><div>            'value' =&gt; $label, &nbsp;</div></li><li><div>            'onclick' =&gt; &quot;saveForm($cache-&gt;form_count)&quot;&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        $save_button_atts = apply_filters('pods_showform_save_button_atts', $save_button_atts, $this);&nbsp;</div></li><li><div>        $atts = '';&nbsp;</div></li><li><div>        foreach ($save_button_atts as $att =&gt; $value) {&nbsp;</div></li><li><div>            $atts .= $att.'=&quot;'.$value.'&quot; ';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $save_button = '&lt;input '.$atts.'/&gt;';&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>    &lt;div&gt;&nbsp;</div></li><li><div>    &lt;input type=&quot;hidden&quot; class=&quot;form num pod_id&quot; value=&quot;&lt;?php echo $pod_id; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>    &lt;input type=&quot;hidden&quot; class=&quot;form num tbl_row_id&quot; value=&quot;&lt;?php echo (!empty($tbl_cols) ? $tbl_cols['id'] : 0); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>    &lt;input type=&quot;hidden&quot; class=&quot;form txt datatype&quot; value=&quot;&lt;?php echo $datatype; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>    &lt;input type=&quot;hidden&quot; class=&quot;form txt form_count&quot; value=&quot;&lt;?php echo $cache-&gt;form_count; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>    &lt;input type=&quot;hidden&quot; class=&quot;form txt token&quot; value=&quot;&lt;?php echo pods_generate_key($datatype, $uri_hash, $public_columns, $cache-&gt;form_count); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>    &lt;input type=&quot;hidden&quot; class=&quot;form txt uri_hash&quot; value=&quot;&lt;?php echo $uri_hash; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>    &lt;?php echo apply_filters('pods_showform_save_button', $save_button, $save_button_atts, $this); ?&gt;&nbsp;</div></li><li><div>    &lt;/div&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>        do_action('pods_showform_post', $pod_id, $public_columns, $label, $this);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Does the field have a value? (incl. 0)&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function is_val($val) {&nbsp;</div></li><li><div>        return (null != $val && false !== $val) ? true : false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display the pagination controls&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function getPagination($label = 'Go to page:') {&nbsp;</div></li><li><div>        if ($this-&gt;rpp &lt; $this-&gt;getTotalRows() && 0 &lt; $this-&gt;rpp && false !== $this-&gt;pagination) {&nbsp;</div></li><li><div>            include PODS_DIR . '/ui/pagination.php';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display the list filters&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function getFilters($filters = null, $label = 'Filter', $action = '') {&nbsp;</div></li><li><div>        include PODS_DIR . '/ui/list_filters.php';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Build public input form&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function publicForm($public_columns = null, $label = 'Save changes', $thankyou_url = null) {&nbsp;</div></li><li><div>        include PODS_DIR . '/ui/input_form.php';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Build HTML for a single field&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function build_field_html($field) {&nbsp;</div></li><li><div>        include PODS_DIR . '/ui/input_fields.php';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display the page template&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function showTemplate($template, $code = null) {&nbsp;</div></li><li><div>        ob_start();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //pre-template hooks&nbsp;</div></li><li><div>        do_action('pods_pre_showtemplate', $template, $code, $this);&nbsp;</div></li><li><div>        do_action(&quot;pods_pre_showtemplate_$template&quot;, $template, $code, $this);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (!empty($code))&nbsp;</div></li><li><div>            $function_or_file = false;&nbsp;</div></li><li><div>        else {&nbsp;</div></li><li><div>            $function_or_file = $template;&nbsp;</div></li><li><div>            $check_function = false;&nbsp;</div></li><li><div>            $check_file = null;&nbsp;</div></li><li><div>            if ((!defined('PODS_STRICT_MODE') || !PODS_STRICT_MODE) && (!defined('PODS_TEMPLATE_FILES') || !PODS_TEMPLATE_FILES))&nbsp;</div></li><li><div>                $check_file = false;&nbsp;</div></li><li><div>            if (false !== $check_function && false !== $check_file)&nbsp;</div></li><li><div>                $function_or_file = pods_function_or_file($function_or_file, $check_function, 'template', $check_file);&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                $function_or_file = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if (!$function_or_file) {&nbsp;</div></li><li><div>                $api = new PodAPI();&nbsp;</div></li><li><div>                $params = array('name' =&gt; $template);&nbsp;</div></li><li><div>                if (!defined('PODS_STRICT_MODE') || !PODS_STRICT_MODE)&nbsp;</div></li><li><div>                    $params = pods_sanitize($params);&nbsp;</div></li><li><div>                $code = $api-&gt;load_template($params);&nbsp;</div></li><li><div>                if (false !== $code && 0 &lt; strlen(trim($code['code'])))&nbsp;</div></li><li><div>                    $code = $code['code'];&nbsp;</div></li><li><div>                else&nbsp;</div></li><li><div>                    $code = false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (empty($code) && false !== $function_or_file && isset($function_or_file['file'])) {&nbsp;</div></li><li><div>            // Only detail templates need $this-&gt;id&nbsp;</div></li><li><div>            if (empty($this-&gt;id)) {&nbsp;</div></li><li><div>                while ($this-&gt;fetchRecord()) {&nbsp;</div></li><li><div>                    locate_template($function_or_file['file'], true, true);&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                locate_template($function_or_file['file'], true, true);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif (!empty($code)) {&nbsp;</div></li><li><div>            // Only detail templates need $this-&gt;id&nbsp;</div></li><li><div>            if (empty($this-&gt;id)) {&nbsp;</div></li><li><div>                while ($this-&gt;fetchRecord()) {&nbsp;</div></li><li><div>                    echo $this-&gt;parse_template_string($code);&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                echo $this-&gt;parse_template_string($code);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //post-template hooks&nbsp;</div></li><li><div>        do_action('pods_post_showtemplate', $template, $code, $this);&nbsp;</div></li><li><div>        do_action(&quot;pods_post_showtemplate_$template&quot;, $template, $code, $this);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return apply_filters('pods_showtemplate', ob_get_clean(), $template, $code, $this);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Parse a template string&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param string $in The template string to parse&nbsp;</div></li><li><div>     * @since 1.8.5&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function parse_template_string($in) {&nbsp;</div></li><li><div>        ob_start();&nbsp;</div></li><li><div>        if (!defined('PODS_DISABLE_EVAL') || !PODS_DISABLE_EVAL)&nbsp;</div></li><li><div>            eval(&quot;?&gt;$in&quot;);&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            echo $in;&nbsp;</div></li><li><div>        $out = ob_get_clean();&nbsp;</div></li><li><div>        $out = preg_replace_callback(&quot;/({@(.*?)})/m&quot;, array($this, &quot;parse_magic_tags&quot;), $out);&nbsp;</div></li><li><div>        return apply_filters('pods_parse_template_string', $out, $in, $this);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Replace magic tags with their values&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function parse_magic_tags($in) {&nbsp;</div></li><li><div>        $name = $in[2];&nbsp;</div></li><li><div>        $before = $after = $helper = '';&nbsp;</div></li><li><div>        if (false !== strpos($name, ', ')) {&nbsp;</div></li><li><div>            @list($name, $helper, $before, $after) = explode(', ', $name);&nbsp;</div></li><li><div>            $name = trim($name);&nbsp;</div></li><li><div>            $helper = trim($helper);&nbsp;</div></li><li><div>            $before = trim($before);&nbsp;</div></li><li><div>            $after = trim($after);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ('type' == $name)&nbsp;</div></li><li><div>            $value = $this-&gt;datatype;&nbsp;</div></li><li><div>        elseif ('detail_url' == $name)&nbsp;</div></li><li><div>            $value = get_bloginfo('url') . '/' . $this-&gt;parse_template_string($this-&gt;detail_page);&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $value = $this-&gt;get_field($name);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Use helper if necessary&nbsp;</div></li><li><div>        if (!empty($helper))&nbsp;</div></li><li><div>            $value = $this-&gt;pod_helper($helper, $value, $name);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Clean out PHP in case it exists&nbsp;</div></li><li><div>        $value = str_replace(array('&lt;' . '?php', '&lt;' . '?', '?' .'&gt;'), array('&lt;?php', '&lt;?', '?&gt;'), $value);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $value = apply_filters('pods_parse_magic_tags', $value, $name, $helper, $before, $after);&nbsp;</div></li><li><div>        if (null != $value && false !== $value)&nbsp;</div></li><li><div>            return $before . $value . $after;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd> <a href="http://hookr.io/plugins/pods-framework/1.14.8/classes/pod/">1.14.8</a></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>Pod</li><li><span></span>Pods Framework</li><li><span></span>1.14.8</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>