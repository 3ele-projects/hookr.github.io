<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="3.8.0" data-slug="jetpack-by-wordpress-com" data-type="class" data-id="13762"><head xmlns="http://www.w3.org/1999/xhtml"><title> videopress_player | class | Jetpack By WordPress Com | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="VideoPress_Player, class, plugin, jetpack-by-wordpress-com, 3.8.0" /><meta name="description" content="VideoPress playback module markup generator." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=ce4dca1fa2a51e9bfe09037f23407dcd' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/video_press_player/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fvideo_press_player%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fvideo_press_player%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-jetpack-by-wordpress-com-3.8.0-class-video_press_player","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="video_press_player" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to jetpack-by-wordpress-com." href="http://hookr.io/plugins/jetpack-by-wordpress-com/" class="plugin"><span property="name">jetpack-by-wordpress-com</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 3.8.0." href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/" class="H_VERSION"><span property="name">3.8.0</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">video_press_player</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="1499"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/all/" title="All">All <span class="count badge">1499</span></a></li><li class="" data-id="new" data-count="17"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/new/" title="New">New <span class="count badge">17</span></a></li><li class="" data-id="hooks" data-count="599"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/hooks/" title="Hooks">Hooks <span class="count badge">599</span></a></li><li class="" data-id="action" data-count="195"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/actions/" title="Actions">Actions <span class="count badge">195</span></a></li><li class="" data-id="filter" data-count="404"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/filters/" title="Filters">Filters <span class="count badge">404</span></a></li><li class="active" data-id="class" data-count="262"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/classes/" title="Classes">Classes <span class="count badge">262</span></a></li><li class="" data-id="constant" data-count="62"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/constants/" title="Constants">Constants <span class="count badge">62</span></a></li><li class="" data-id="function" data-count="530"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/functions/" title="Functions">Functions <span class="count badge">530</span></a></li><li class="" data-id="shortcode" data-count="46"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">46</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>VideoPress_Player</strong></h1><p>VideoPress playback module markup generator.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/files/modules-videopress-class-videopress-player/" class="file">/modules/videopress/class.videopress-player.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="7" class="block" start="7"><li><div>class VideoPress_Player {&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Video data for the requested guid and maximum width&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.3&nbsp;</div></li><li><div>     * @var VideoPress_Video&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected $video;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * DOM identifier of the video container&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @var string&nbsp;</div></li><li><div>     * @since 1.3&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected $video_container_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * DOM identifier of the video element (video, object, embed)&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @var string&nbsp;</div></li><li><div>     * @since 1.3&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected $video_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Array of playback options: force_flash or freedom&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     * @since 1.3&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected $options;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Array of video GUIDs shown and their counts, &nbsp;</div></li><li><div>     * moved from the old VideoPress class.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static $shown = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Initiate a player object based on shortcode values and possible blog-level option overrides&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.3&nbsp;</div></li><li><div>     * @var string $guid VideoPress unique identifier&nbsp;</div></li><li><div>     * @var int $maxwidth maximum desired width of the video player if specified&nbsp;</div></li><li><div>     * @var array $options player customizations&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function __construct( $guid, $maxwidth = 0, $options = array() ) {&nbsp;</div></li><li><div>        if ( empty( self::$shown[ $guid ] ) )&nbsp;</div></li><li><div>            self::$shown[ $guid ] = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        self::$shown[ $guid ]++;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;video_container_id = 'v-' . $guid . '-' . self::$shown[ $guid ];&nbsp;</div></li><li><div>        $this-&gt;video_id = $this-&gt;video_container_id . '-video';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_array( $options ) )&nbsp;</div></li><li><div>            $this-&gt;options = $options;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $this-&gt;options = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // set up the video&nbsp;</div></li><li><div>        $cache_key = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // disable cache in debug mode&nbsp;</div></li><li><div>        if ( defined('WP_DEBUG') && WP_DEBUG === true ) {&nbsp;</div></li><li><div>            $cached_video = null;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $cache_key_pieces = array( 'video' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( is_multisite() && is_subdomain_install() )&nbsp;</div></li><li><div>                $cache_key_pieces[] = get_current_blog_id();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $cache_key_pieces[] = $guid;&nbsp;</div></li><li><div>            if ( $maxwidth &gt; 0 )&nbsp;</div></li><li><div>                $cache_key_pieces[] = $maxwidth;&nbsp;</div></li><li><div>            if ( is_ssl() )&nbsp;</div></li><li><div>                $cache_key_pieces[] = 'ssl';&nbsp;</div></li><li><div>            $cache_key = implode( '-', $cache_key_pieces );&nbsp;</div></li><li><div>            unset( $cache_key_pieces );&nbsp;</div></li><li><div>            $cached_video = wp_cache_get( $cache_key, 'video' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( empty( $cached_video ) ) {&nbsp;</div></li><li><div>            $video = new VideoPress_Video( $guid, $maxwidth );&nbsp;</div></li><li><div>            if ( empty( $video ) ) {&nbsp;</div></li><li><div>                return;&nbsp;</div></li><li><div>            } elseif ( isset( $video-&gt;error ) ) {&nbsp;</div></li><li><div>                $this-&gt;video = $video-&gt;error;&nbsp;</div></li><li><div>                return;&nbsp;</div></li><li><div>            } elseif ( is_wp_error( $video ) ) {&nbsp;</div></li><li><div>                $this-&gt;video = $video;&nbsp;</div></li><li><div>                return;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $this-&gt;video = $video;&nbsp;</div></li><li><div>            unset( $video );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( ! defined( 'WP_DEBUG' ) || WP_DEBUG !== true ) {&nbsp;</div></li><li><div>                $expire = 3600;&nbsp;</div></li><li><div>                if ( isset( $video-&gt;expires ) && is_int( $video-&gt;expires ) ) {&nbsp;</div></li><li><div>                    $expires_diff = time() - $video-&gt;expires;&nbsp;</div></li><li><div>                    if ( $expires_diff &gt; 0 && $expires_diff &lt; 86400 ) // allowed range: 1 second to 1 day&nbsp;</div></li><li><div>                        $expire = $expires_diff;&nbsp;</div></li><li><div>                    unset( $expires_diff );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                wp_cache_set( $cache_key, serialize( $this-&gt;video ), 'video', $expire );&nbsp;</div></li><li><div>                unset( $expire );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $this-&gt;video = unserialize( $cached_video );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        unset( $cache_key );&nbsp;</div></li><li><div>        unset( $cached_video );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Wrap output in a VideoPress player container&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.3&nbsp;</div></li><li><div>     * @var string $content HTML string&nbsp;</div></li><li><div>     * @return string HTML string or blank string if nothing to wrap&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function html_wrapper( $content ) {&nbsp;</div></li><li><div>        if ( empty( $content ) )&nbsp;</div></li><li><div>            return '';&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            return '&lt;div id=&quot;' . esc_attr( $this-&gt;video_container_id ) . '&quot; class=&quot;video-player&quot;&gt;' . $content . '&lt;/div&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Output content suitable for a feed reader displaying RSS or Atom feeds&nbsp;</div></li><li><div>     * We do not display error messages in the feed view due to caching concerns.&nbsp;</div></li><li><div>     * Flash content presented using &lt;embed&gt; markup for feed reader compatibility.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.3&nbsp;</div></li><li><div>     * @return string HTML string or empty string if error&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function asXML() {&nbsp;</div></li><li><div>        if ( empty( $this-&gt;video ) || is_wp_error( $this-&gt;video ) )&nbsp;</div></li><li><div>            return '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( isset( $this-&gt;options['freedom'] ) && $this-&gt;options['freedom'] === true )&nbsp;</div></li><li><div>            $content = $this-&gt;html5_static();&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $content = $this-&gt;flash_embed();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $this-&gt;html_wrapper( $content );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Video player markup for best matching the current request and publisher options&nbsp;</div></li><li><div>     * @since 1.3&nbsp;</div></li><li><div>     * @return string HTML markup string or empty string if no video property found&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function asHTML() {&nbsp;</div></li><li><div>        if ( empty( $this-&gt;video ) ) {&nbsp;</div></li><li><div>            $content = '';&nbsp;</div></li><li><div>        } elseif ( is_wp_error( $this-&gt;video ) ) {&nbsp;</div></li><li><div>            $content = $this-&gt;error_message( $this-&gt;video );&nbsp;</div></li><li><div>        } elseif ( isset( $this-&gt;options['force_flash'] ) && $this-&gt;options['force_flash'] === true ) {&nbsp;</div></li><li><div>            $content = $this-&gt;flash_object();&nbsp;</div></li><li><div>        } elseif ( isset( $this-&gt;video-&gt;restricted_embed ) && $this-&gt;video-&gt;restricted_embed === true ) {&nbsp;</div></li><li><div>            if( $this-&gt;options['forcestatic'] )&nbsp;</div></li><li><div>                $content = $this-&gt;flash_object();&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                $content = $this-&gt;html5_dynamic();&nbsp;</div></li><li><div>        } elseif ( isset( $this-&gt;options['freedom'] ) && $this-&gt;options['freedom'] === true ) {&nbsp;</div></li><li><div>            $content = $this-&gt;html5_static();&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $content = $this-&gt;html5_dynamic();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $this-&gt;html_wrapper( $content );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display an error message to users capable of doing something about the error&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.3&nbsp;</div></li><li><div>     * @uses current_user_can() to test if current user has edit_posts capability&nbsp;</div></li><li><div>     * @var WP_Error $error WordPress error&nbsp;</div></li><li><div>     * @return string HTML string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function error_message( $error ) {&nbsp;</div></li><li><div>        if ( ! current_user_can( 'edit_posts' ) || empty( $error ) )&nbsp;</div></li><li><div>            return '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $html = '&lt;div class=&quot;videopress-error&quot; style=&quot;background-color:rgb(255, 0, 0);color:rgb(255, 255, 255);font-family:font-family:\'Helvetica Neue\', Arial, Helvetica, \'Nimbus Sans L\', sans-serif;font-size:140%;min-height:10em;padding-top:1.5em;padding-bottom:1.5em&quot;&gt;';&nbsp;</div></li><li><div>        $html .= '&lt;h1 style=&quot;font-size:180%;font-style:bold;line-height:130%;text-decoration:underline&quot;&gt;' . esc_html( sprintf( __( '%s Error', 'jetpack' ), 'VideoPress' ) ) . '&lt;/h1&gt;';&nbsp;</div></li><li><div>        foreach( $error-&gt;get_error_messages() as $message ) {&nbsp;</div></li><li><div>            $html .= $message;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $html .= '&lt;/div&gt;';&nbsp;</div></li><li><div>        return $html;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Rating agencies and industry associations require a potential viewer verify his or her age before a video or its poster frame are displayed.&nbsp;</div></li><li><div>     * Content rated for audiences 17 years of age or older requires such verification across multiple rating agencies and industry associations&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.3&nbsp;</div></li><li><div>     * @return bool true if video requires the viewer verify he or she is 17 years of age or older&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function age_gate_required() {&nbsp;</div></li><li><div>        if ( isset( $this-&gt;video-&gt;age_rating ) && $this-&gt;video-&gt;age_rating &gt;= 17 )&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Select a date of birth using HTML form elements.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.5&nbsp;</div></li><li><div>     * @return string HTML markup&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function html_age_gate() {&nbsp;</div></li><li><div>        global $wp_locale;&nbsp;</div></li><li><div>        $text_align = 'left';&nbsp;</div></li><li><div>        if ( $this-&gt;video-&gt;text_direction === 'rtl' )&nbsp;</div></li><li><div>            $text_align = 'right';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $html = '&lt;div class=&quot;videopress-age-gate&quot; style=&quot;margin:0 60px&quot;&gt;';&nbsp;</div></li><li><div>        $html .= '&lt;p class=&quot;instructions&quot; style=&quot;color:rgb(255, 255, 255);font-size:21px;padding-top:60px;padding-bottom:20px;text-align:' . $text_align . '&quot;&gt;' . esc_html( __( 'This video is intended for mature audiences.', 'jetpack' ) ) . '&lt;br /&gt;' . esc_html( __( 'Please verify your birthday.', 'jetpack' ) ) . '&lt;/p&gt;';&nbsp;</div></li><li><div>        $html .= '&lt;fieldset id=&quot;birthday&quot; style=&quot;border:0 none;text-align:' . $text_align . ';padding:0;&quot;&gt;';&nbsp;</div></li><li><div>        $inputs_style = 'border:1px solid #444;margin-';&nbsp;</div></li><li><div>        if ( $this-&gt;video-&gt;text_direction === 'rtl' )&nbsp;</div></li><li><div>            $inputs_style .= 'left';&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $inputs_style .= 'right';&nbsp;</div></li><li><div>        $inputs_style .= ':10px;background-color:rgb(0, 0, 0);font-size:14px;color:rgb(255, 255, 255);padding:4px 6px;line-height: 2em;vertical-align: middle';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * Display a list of months in the Gregorian calendar.&nbsp;</div></li><li><div>         * Set values to 0-based to match JavaScript Date.&nbsp;</div></li><li><div>         * @link https://developer.mozilla.org/en/JavaScript/Reference/global_objects/date Mozilla JavaScript Reference: Date&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        $html .= '&lt;select name=&quot;month&quot; style=&quot;' . $inputs_style . '&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        for( $i=0; $i&lt;12; $i++ ) {&nbsp;</div></li><li><div>            $html .= '&lt;option value=&quot;' . esc_attr( $i ) . '&quot;&gt;' . esc_html( $wp_locale-&gt;get_month( $i + 1 ) )  . '&lt;/option&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $html .= '&lt;/select&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * todo: numdays variance by month&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        $html .= '&lt;select name=&quot;day&quot; style=&quot;' . $inputs_style . '&quot;&gt;';&nbsp;</div></li><li><div>        for ( $i=1; $i&lt;32; $i++ ) {&nbsp;</div></li><li><div>            $html .= '&lt;option&gt;' . $i . '&lt;/option&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $html .= '&lt;/select&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * Current record for human life is 122. Go back 130 years and no one is left out.&nbsp;</div></li><li><div>         * Don't ask infants younger than 2 for their birthday&nbsp;</div></li><li><div>         * Default to 13&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        $html .= '&lt;select name=&quot;year&quot; style=&quot;' . $inputs_style . '&quot;&gt;';&nbsp;</div></li><li><div>        $start_year = date('Y') - 2;&nbsp;</div></li><li><div>        $default_year = $start_year - 11;&nbsp;</div></li><li><div>        $end_year = $start_year - 128;&nbsp;</div></li><li><div>        for ( $year=$start_year; $year&gt;$end_year; $year-- ) {&nbsp;</div></li><li><div>            $html .= '&lt;option';&nbsp;</div></li><li><div>            if ( $year === $default_year )&nbsp;</div></li><li><div>                $html .= ' selected=&quot;selected&quot;';&nbsp;</div></li><li><div>            $html .= '&gt;' . $year . '&lt;/option&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        unset( $start_year );&nbsp;</div></li><li><div>        unset( $default_year );&nbsp;</div></li><li><div>        unset( $end_year );&nbsp;</div></li><li><div>        $html .= '&lt;/select&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $html .= '&lt;input type=&quot;submit&quot; value=&quot;' . __( 'Submit', 'jetpack' ) . '&quot; style=&quot;cursor:pointer;border-radius: 1em;border:1px solid #333;background-color:#333;background:-webkit-gradient( linear, left top, left bottom, color-stop(0.0, #444), color-stop(1, #111) );background:-moz-linear-gradient(center top, #444 0%, #111 100%);font-size:13px;padding:4px 10px 5px;line-height:1em;vertical-align:top;color:white;text-decoration:none;margin:0&quot; /&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $html .= '&lt;/fieldset&gt;';&nbsp;</div></li><li><div>        $html .= '&lt;p style=&quot;padding-top:20px;padding-bottom:60px;text-align:' . $text_align . ';&quot;&gt;&lt;a rel=&quot;nofollow&quot; href=&quot;http://videopress.com/&quot; style=&quot;color:rgb(128, 128, 128);text-decoration:underline;font-size:15px&quot;&gt;' . __( 'More information', 'jetpack' ) . '&lt;/a&gt;&lt;/p&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $html .= '&lt;/div&gt;';&nbsp;</div></li><li><div>        return $html;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Return HTML5 video static markup for the given video parameters.&nbsp;</div></li><li><div>     * Use default browser player controls.&nbsp;</div></li><li><div>     * No Flash fallback.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.2&nbsp;</div></li><li><div>     * @link http://www.whatwg.org/specs/web-apps/current-work/multipage/video.html HTML5 video&nbsp;</div></li><li><div>     * @return string HTML5 video element and children&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function html5_static() {&nbsp;</div></li><li><div>        wp_enqueue_script( 'videopress' );&nbsp;</div></li><li><div>        $thumbnail = esc_url( $this-&gt;video-&gt;poster_frame_uri );&nbsp;</div></li><li><div>        $html = &quot;&lt;video id=\&quot;{$this-&gt;video_id}\&quot; width=\&quot;{$this-&gt;video-&gt;calculated_width}\&quot; height=\&quot;{$this-&gt;video-&gt;calculated_height}\&quot; poster=\&quot;$thumbnail\&quot; controls=\&quot;true\&quot;&quot;;&nbsp;</div></li><li><div>        if ( isset( $this-&gt;options['autoplay'] ) && $this-&gt;options['autoplay'] === true )&nbsp;</div></li><li><div>            $html .= ' autoplay=&quot;true&quot;';&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $html .= ' preload=&quot;metadata&quot;';&nbsp;</div></li><li><div>        if ( isset( $this-&gt;video-&gt;text_direction ) )&nbsp;</div></li><li><div>            $html .= ' dir=&quot;' . esc_attr( $this-&gt;video-&gt;text_direction ) . '&quot;';&nbsp;</div></li><li><div>        if ( isset( $this-&gt;video-&gt;language ) )&nbsp;</div></li><li><div>            $html .= ' lang=&quot;' . esc_attr( $this-&gt;video-&gt;language ) . '&quot;';&nbsp;</div></li><li><div>        $html .= '&gt;';&nbsp;</div></li><li><div>        if ( ! isset( $this-&gt;options['freedom'] ) || $this-&gt;options['freedom'] === false ) {&nbsp;</div></li><li><div>            $mp4 = $this-&gt;video-&gt;videos-&gt;mp4-&gt;url;&nbsp;</div></li><li><div>            if ( ! empty( $mp4 ) )&nbsp;</div></li><li><div>                $html .= '&lt;source src=&quot;' . esc_url( $mp4 ) . '&quot; type=&quot;video/mp4; codecs=&quot;' . esc_attr( $this-&gt;video-&gt;videos-&gt;mp4-&gt;codecs ) . '&quot;&quot; /&gt;';&nbsp;</div></li><li><div>            unset( $mp4 );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $ogg = $this-&gt;video-&gt;videos-&gt;ogv-&gt;url;&nbsp;</div></li><li><div>        if ( ! empty( $ogg ) )&nbsp;</div></li><li><div>            $html .= '&lt;source src=&quot;' . esc_url( $ogg ) . '&quot; type=&quot;video/ogg; codecs=&quot;' . esc_attr( $this-&gt;video-&gt;videos-&gt;ogv-&gt;codecs ) . '&quot;&quot; /&gt;';&nbsp;</div></li><li><div>        unset( $ogg );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $html .= '&lt;div&gt;&lt;img alt=&quot;';&nbsp;</div></li><li><div>        if ( isset( $this-&gt;video-&gt;title ) )&nbsp;</div></li><li><div>            $html .= esc_attr( $this-&gt;video-&gt;title );&nbsp;</div></li><li><div>        $html .= '&quot; src=&quot;' . $thumbnail . '&quot; width=&quot;' . $this-&gt;video-&gt;calculated_width . '&quot; height=&quot;' . $this-&gt;video-&gt;calculated_height . '&quot; /&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>        if ( isset( $this-&gt;options['freedom'] ) && $this-&gt;options['freedom'] === true )&nbsp;</div></li><li><div>            $html .= '&lt;p class=&quot;robots-nocontent&quot;&gt;' . sprintf( __( 'You do not have sufficient &lt;a rel=&quot;nofollow&quot; href=&quot;%s&quot;&gt;freedom levels&lt;/a&gt; to view this video. Support free software and upgrade.', 'jetpack' ), 'http://www.gnu.org/philosophy/free-sw.html' ) . '&lt;/p&gt;';&nbsp;</div></li><li><div>        elseif ( isset( $this-&gt;video-&gt;title ) )&nbsp;</div></li><li><div>            $html .= '&lt;p&gt;' . esc_html( $this-&gt;video-&gt;title ) . '&lt;/p&gt;';&nbsp;</div></li><li><div>        $html .= '&lt;/video&gt;';&nbsp;</div></li><li><div>        return $html;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Click to play dynamic HTML5-capable player.&nbsp;</div></li><li><div>     * The player displays a video preview section including poster frame, &nbsp;</div></li><li><div>     * video title, play button and watermark on the original page load&nbsp;</div></li><li><div>     * and calculates the playback capabilities of the browser. The video player&nbsp;</div></li><li><div>     * is loaded when the visitor clicks on the video preview area.&nbsp;</div></li><li><div>     * If Flash Player 10 or above is available the browser will display&nbsp;</div></li><li><div>     * the Flash version of the video. If HTML5 video appears to be supported&nbsp;</div></li><li><div>     * and the browser may be capable of MP4 (H.264, AAC) or OGV (Theora, Vorbis)&nbsp;</div></li><li><div>     * playback the browser will display its native HTML5 player.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.5&nbsp;</div></li><li><div>     * @return string HTML markup&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function html5_dynamic() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * Filter the VideoPress legacy player feature&nbsp;</div></li><li><div>         *&nbsp;</div></li><li><div>         * This filter allows you to control whether the legacy VideoPress player should be used&nbsp;</div></li><li><div>         * instead of the improved one.&nbsp;</div></li><li><div>         *&nbsp;</div></li><li><div>         * @module videopress&nbsp;</div></li><li><div>         *&nbsp;</div></li><li><div>         * @since 3.7.0&nbsp;</div></li><li><div>         *&nbsp;</div></li><li><div>         * @param boolean $videopress_use_legacy_player&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        if ( ! apply_filters( 'jetpack_videopress_use_legacy_player', false ) ) {&nbsp;</div></li><li><div>            return $this-&gt;html5_dynamic_next();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        wp_enqueue_script( 'videopress' );&nbsp;</div></li><li><div>        $video_placeholder_id = $this-&gt;video_container_id . '-placeholder';&nbsp;</div></li><li><div>        $age_gate_required = $this-&gt;age_gate_required();&nbsp;</div></li><li><div>        $width = absint( $this-&gt;video-&gt;calculated_width );&nbsp;</div></li><li><div>        $height = absint( $this-&gt;video-&gt;calculated_height );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $html = '&lt;div id=&quot;' . $video_placeholder_id . '&quot; class=&quot;videopress-placeholder&quot; style=&quot;';&nbsp;</div></li><li><div>        if ( $age_gate_required )&nbsp;</div></li><li><div>            $html .= &quot;min-width:{$width}px;min-height:{$height}px&quot;;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $html .= &quot;width:{$width}px;height:{$height}px&quot;;&nbsp;</div></li><li><div>        $html .= ';display:none;cursor:pointer !important;position:relative;';&nbsp;</div></li><li><div>        if ( isset( $this-&gt;video-&gt;skin ) && isset( $this-&gt;video-&gt;skin-&gt;background_color ) )&nbsp;</div></li><li><div>            $html .= 'background-color:' . esc_attr( $this-&gt;video-&gt;skin-&gt;background_color ) . ';';&nbsp;</div></li><li><div>        $html .= 'font-family: \'Helvetica Neue\', Arial, Helvetica, \'Nimbus Sans L\', sans-serif;font-weight:bold;font-size:18px&quot;&gt;' . PHP_EOL;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * Do not display a poster frame, title, or any other content hints for mature content.&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        if ( ! $age_gate_required ) {&nbsp;</div></li><li><div>            if ( ! empty( $this-&gt;video-&gt;title ) ) {&nbsp;</div></li><li><div>                $html .= '&lt;div class=&quot;videopress-title&quot; style=&quot;display:inline;position:absolute;margin:20px 20px 0 20px;padding:4px 8px;vertical-align:top;text-align:';&nbsp;</div></li><li><div>                if ( $this-&gt;video-&gt;text_direction === 'rtl' )&nbsp;</div></li><li><div>                    $html .= 'right&quot; dir=&quot;rtl&quot;';&nbsp;</div></li><li><div>                else&nbsp;</div></li><li><div>                    $html .= 'left&quot; dir=&quot;ltr&quot;';&nbsp;</div></li><li><div>                if ( isset( $this-&gt;video-&gt;language ) )&nbsp;</div></li><li><div>                    $html .= ' lang=&quot;' . esc_attr( $this-&gt;video-&gt;language ) . '&quot;';&nbsp;</div></li><li><div>                $html .= '&gt;&lt;span style=&quot;padding:3px 0;line-height:1.5em;';&nbsp;</div></li><li><div>                if ( isset( $this-&gt;video-&gt;skin ) && isset( $this-&gt;video-&gt;skin-&gt;background_color ) ) {&nbsp;</div></li><li><div>                    $html .= 'background-color:';&nbsp;</div></li><li><div>                    if ( $this-&gt;video-&gt;skin-&gt;background_color === 'rgb(0, 0, 0)' )&nbsp;</div></li><li><div>                        $html .= 'rgba(0, 0, 0, 0.8)';&nbsp;</div></li><li><div>                    else&nbsp;</div></li><li><div>                        $html .= esc_attr( $this-&gt;video-&gt;skin-&gt;background_color );&nbsp;</div></li><li><div>                    $html .= ';';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $html .= 'color:rgb(255, 255, 255)&quot;&gt;' . esc_html( $this-&gt;video-&gt;title ) . '&lt;/span&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $html .= '&lt;img class=&quot;videopress-poster&quot; alt=&quot;';&nbsp;</div></li><li><div>            if ( ! empty( $this-&gt;video-&gt;title ) )&nbsp;</div></li><li><div>                $html .= esc_attr( $this-&gt;video-&gt;title ) . '&quot; title=&quot;' . esc_attr( sprintf( _x( 'Watch: %s', 'watch a video title', 'jetpack' ), $this-&gt;video-&gt;title ) );&nbsp;</div></li><li><div>            $html .= '&quot; src=&quot;' . esc_url( $this-&gt;video-&gt;poster_frame_uri, array( 'http', 'https' ) ) . '&quot; width=&quot;' . $width . '&quot; height=&quot;' . $height . '&quot; /&gt;' . PHP_EOL;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            //style a play button hovered over the poster frame&nbsp;</div></li><li><div>            $html .= '&lt;div class=&quot;play-button&quot;&gt;&lt;span style=&quot;z-index:2;display:block;position:absolute;top:50%;left:50%;text-align:center;vertical-align:middle;color:rgb(255, 255, 255);opacity:0.9;margin:0 0 0 -0.45em;padding:0;line-height:0;font-size:500%;text-shadow:0 0 40px rgba(0, 0, 0, 0.5)&quot;&gt;&#9654;&lt;/span&gt;&lt;/div&gt;' . PHP_EOL;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // watermark&nbsp;</div></li><li><div>            if ( isset( $this-&gt;video-&gt;skin ) && isset( $this-&gt;video-&gt;skin-&gt;watermark ) ) {&nbsp;</div></li><li><div>                $html .= '&lt;div style=&quot;position:relative;margin-top:-40px;height:25px;margin-bottom:35px;';&nbsp;</div></li><li><div>                if ( $this-&gt;video-&gt;text_direction === 'rtl' )&nbsp;</div></li><li><div>                    $html .= 'margin-left:20px;text-align:left;';&nbsp;</div></li><li><div>                else&nbsp;</div></li><li><div>                    $html .= 'margin-right:20px;text-align:right;';&nbsp;</div></li><li><div>                $html .= 'vertical-align:bottom;z-index:3&quot;&gt;';&nbsp;</div></li><li><div>                $html .= '&lt;img alt=&quot;&quot; src=&quot;' . esc_url( $this-&gt;video-&gt;skin-&gt;watermark, array( 'http', 'https' ) ) . '&quot; width=&quot;90&quot; height=&quot;13&quot; style=&quot;background-color:transparent;background-image:none;background-repeat:no-repeat;border:none;margin:0;padding:0&quot;/&gt;';&nbsp;</div></li><li><div>                $html .= '&lt;/div&gt;' . PHP_EOL;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $data = array(&nbsp;</div></li><li><div>            'blog' =&gt; absint( $this-&gt;video-&gt;blog_id ), &nbsp;</div></li><li><div>            'post' =&gt; absint( $this-&gt;video-&gt;post_id ), &nbsp;</div></li><li><div>            'duration'=&gt; absint( $this-&gt;video-&gt;duration ), &nbsp;</div></li><li><div>            'poster' =&gt; esc_url_raw( $this-&gt;video-&gt;poster_frame_uri, array( 'http', 'https' ) ), &nbsp;</div></li><li><div>            'hd' =&gt; (bool) $this-&gt;options['hd']&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        if ( isset( $this-&gt;video-&gt;videos ) ) {&nbsp;</div></li><li><div>            if ( isset( $this-&gt;video-&gt;videos-&gt;mp4 ) && isset( $this-&gt;video-&gt;videos-&gt;mp4-&gt;url ) )&nbsp;</div></li><li><div>                $data['mp4'] = array( 'size' =&gt; $this-&gt;video-&gt;videos-&gt;mp4-&gt;format, 'uri' =&gt; esc_url_raw( $this-&gt;video-&gt;videos-&gt;mp4-&gt;url, array( 'http', 'https' ) ) );&nbsp;</div></li><li><div>            if ( isset( $this-&gt;video-&gt;videos-&gt;ogv ) && isset( $this-&gt;video-&gt;videos-&gt;ogv-&gt;url ) )&nbsp;</div></li><li><div>                $data['ogv'] = array( 'size' =&gt; 'std', 'uri' =&gt; esc_url_raw( $this-&gt;video-&gt;videos-&gt;ogv-&gt;url, array( 'http', 'https' ) ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $locale = array( 'dir' =&gt; $this-&gt;video-&gt;text_direction );&nbsp;</div></li><li><div>        if ( isset( $this-&gt;video-&gt;language ) )&nbsp;</div></li><li><div>            $locale['lang'] = $this-&gt;video-&gt;language;&nbsp;</div></li><li><div>        $data['locale'] = $locale;&nbsp;</div></li><li><div>        unset( $locale );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $guid = $this-&gt;video-&gt;guid;&nbsp;</div></li><li><div>        $guid_js = json_encode( $guid );&nbsp;</div></li><li><div>        $html .= '&lt;script type=&quot;text/javascript&quot;&gt;' . PHP_EOL;&nbsp;</div></li><li><div>        $html .= 'jQuery(document).ready(function() {';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $html .= 'if ( !jQuery.VideoPress.data[' . json_encode($guid) . '] ) { jQuery.VideoPress.data[' . json_encode($guid) . '] = new Array(); }' . PHP_EOL;&nbsp;</div></li><li><div>        $html .= 'jQuery.VideoPress.data[' . json_encode( $guid ) . '][' . self::$shown[ $guid ] . ']=' . json_encode($data) . ';' . PHP_EOL;&nbsp;</div></li><li><div>        unset( $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $jq_container = json_encode( '#' . $this-&gt;video_container_id );&nbsp;</div></li><li><div>        $jq_placeholder = json_encode( '#' . $video_placeholder_id );&nbsp;</div></li><li><div>        $player_config = &quot;{width:{$width}, height:{$height}, &quot;;&nbsp;</div></li><li><div>        if ( isset( $this-&gt;options['freedom'] ) && $this-&gt;options['freedom'] === true )&nbsp;</div></li><li><div>            $player_config .= 'freedom:&quot;true&quot;, ';&nbsp;</div></li><li><div>        $player_config .= 'container:jQuery(' . $jq_container . ')}';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $html .= &quot;jQuery({$jq_placeholder}).show(0, function() {jQuery.VideoPress.analytics.impression({$guid_js})});&quot; . PHP_EOL;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $age_gate_required ) {&nbsp;</div></li><li><div>            $html .= 'if ( jQuery.VideoPress.support.flash() ) {' . PHP_EOL;&nbsp;</div></li><li><div>            /**&nbsp;</div></li><li><div>             * @link http://code.google.com/p/swfobject/wiki/api#swfobject.embedSWF(swfUrlStr, _replaceElemIdStr, _widthStr, _height&nbsp;</div></li><li><div>             */&nbsp;</div></li><li><div>            $html .= 'swfobject.embedSWF(' . implode( ', ', array(&nbsp;</div></li><li><div>                'jQuery.VideoPress.video.flash.player_uri', &nbsp;</div></li><li><div>                json_encode( $this-&gt;video_container_id ), &nbsp;</div></li><li><div>                json_encode( $width ), &nbsp;</div></li><li><div>                json_encode( $height ), &nbsp;</div></li><li><div>                'jQuery.VideoPress.video.flash.min_version', &nbsp;</div></li><li><div>                'jQuery.VideoPress.video.flash.expressinstall', // attempt to upgrade the Flash player if less than min_version. requires a 310x137 container or larger but we will always try to include&nbsp;</div></li><li><div>                '{guid:' . $guid_js . '}', // FlashVars&nbsp;</div></li><li><div>                'jQuery.VideoPress.video.flash.params', &nbsp;</div></li><li><div>                'null', // no attributes&nbsp;</div></li><li><div>                'jQuery.VideoPress.video.flash.embedCallback' // error fallback&nbsp;</div></li><li><div> ) ) . ');';&nbsp;</div></li><li><div>            $html .= '} else {' . PHP_EOL;&nbsp;</div></li><li><div>            $html .= &quot;if ( jQuery.VideoPress.video.prepare({$guid_js}, {$player_config}, &quot; . self::$shown[ $guid ] . ') ) {' . PHP_EOL;&nbsp;</div></li><li><div>            $html .= 'if ( jQuery(' . $jq_container . ').data( &quot;player&quot; ) === &quot;flash&quot; ) {jQuery.VideoPress.video.play(jQuery(' . json_encode('#' . $this-&gt;video_container_id) . '));}else{';&nbsp;</div></li><li><div>            $html .= 'jQuery(' . $jq_placeholder . ').html(' . json_encode( $this-&gt;html_age_date() ) . ');' . PHP_EOL;&nbsp;</div></li><li><div>            $html .= 'jQuery(' . json_encode( '#' . $video_placeholder_id . ' input[type=submit]' ) . ').one(&quot;click&quot;, function(event) {jQuery.VideoPress.requirements.isSufficientAge(jQuery(' . $jq_container . '), ' . absint( $this-&gt;video-&gt;age_rating ) . ')});' . PHP_EOL;&nbsp;</div></li><li><div>            $html .= '}}}' . PHP_EOL;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $html .= &quot;if ( jQuery.VideoPress.video.prepare({$guid_js}, {$player_config}, &quot; . self::$shown[ $guid ] . ') ) {' . PHP_EOL;&nbsp;</div></li><li><div>            if ( isset( $this-&gt;options['autoplay'] ) && $this-&gt;options['autoplay'] === true )&nbsp;</div></li><li><div>                $html .= &quot;jQuery.VideoPress.video.play(jQuery({$jq_container}));&quot;;&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                $html .= 'jQuery(' . $jq_placeholder .  ').one(&quot;click&quot;, function() {jQuery.VideoPress.video.play(jQuery(' . $jq_container . '))});';&nbsp;</div></li><li><div>            $html .= '}';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // close the jQuery(document).ready() function&nbsp;</div></li><li><div>            $html .= '});';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $html .= '&lt;/script&gt;' . PHP_EOL;&nbsp;</div></li><li><div>        $html .= '&lt;/div&gt;' . PHP_EOL;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * JavaScript required&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        $noun = __( 'this video', 'jetpack' );&nbsp;</div></li><li><div>        if ( ! $age_gate_required ) {&nbsp;</div></li><li><div>            $vid_type = '';&nbsp;</div></li><li><div>            if ( ( isset( $this-&gt;options['freedom'] ) && $this-&gt;options['freedom'] === true ) && ( isset( $this-&gt;video-&gt;videos-&gt;ogv ) && isset( $this-&gt;video-&gt;videos-&gt;ogv-&gt;url ) ) )&nbsp;</div></li><li><div>                $vid_type = 'ogv';&nbsp;</div></li><li><div>            elseif ( isset( $this-&gt;video-&gt;videos-&gt;mp4 ) && isset( $this-&gt;video-&gt;videos-&gt;mp4-&gt;url ) )&nbsp;</div></li><li><div>                $vid_type = 'mp4';&nbsp;</div></li><li><div>            elseif ( isset( $this-&gt;video-&gt;videos-&gt;ogv ) && isset( $this-&gt;video-&gt;videos-&gt;ogv-&gt;url ) )&nbsp;</div></li><li><div>                $vid_type = 'ogv';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $vid_type !== '' ) {&nbsp;</div></li><li><div>                $noun = '&lt;a ';&nbsp;</div></li><li><div>                if ( isset( $this-&gt;video-&gt;language ) )&nbsp;</div></li><li><div>                    $noun .= 'hreflang=&quot;' . esc_attr( $this-&gt;video-&gt;language ) . '&quot; ';&nbsp;</div></li><li><div>                if ( $vid_type === 'mp4' )&nbsp;</div></li><li><div>                    $noun .= 'type=&quot;video/mp4&quot; href=&quot;' . esc_url( $this-&gt;video-&gt;videos-&gt;mp4-&gt;url, array( 'http', 'https' ) );&nbsp;</div></li><li><div>                elseif ( $vid_type === 'ogv' )&nbsp;</div></li><li><div>                    $noun .= 'type=&quot;video/ogv&quot; href=&quot;' . esc_url( $this-&gt;video-&gt;videos-&gt;ogv-&gt;url, array( 'http', 'https' ) );&nbsp;</div></li><li><div>                $noun .= '&quot;&gt;';&nbsp;</div></li><li><div>                if ( isset( $this-&gt;video-&gt;title ) )&nbsp;</div></li><li><div>                    $noun .= esc_html( $this-&gt;video-&gt;title );&nbsp;</div></li><li><div>                else&nbsp;</div></li><li><div>                    $noun .= __( 'this video', 'jetpack' );&nbsp;</div></li><li><div>                $noun .= '&lt;/a&gt;';&nbsp;</div></li><li><div>            } elseif ( ! empty( $this-&gt;title ) ) {&nbsp;</div></li><li><div>                $noun = esc_html( $this-&gt;title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            unset( $vid_type );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $html .= '&lt;noscript&gt;&lt;p&gt;' . sprintf( _x( 'JavaScript required to play %s.', 'Play as in playback or view a movie', 'jetpack' ), $noun ) . '&lt;/p&gt;&lt;/noscript&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $html;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function html5_dynamic_next() {&nbsp;</div></li><li><div>        $video_container_id = 'v-' . $this-&gt;video-&gt;guid;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Must not use iframes for IE11 due to a fullscreen bug&nbsp;</div></li><li><div>        if ( isset( $_SERVER['HTTP_USER_AGENT'] ) && stristr( $_SERVER['HTTP_USER_AGENT'], 'Trident/7.0; rv:11.0' ) ) {&nbsp;</div></li><li><div>            $iframe_embed = false;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            /**&nbsp;</div></li><li><div>             * Filter the VideoPress iframe embed&nbsp;</div></li><li><div>             *&nbsp;</div></li><li><div>             * This filter allows you to control whether the videos will be embedded using an iframe.&nbsp;</div></li><li><div>             * Set this to false in order to use an in-page embed rather than an iframe.&nbsp;</div></li><li><div>             *&nbsp;</div></li><li><div>             * @module videopress&nbsp;</div></li><li><div>             *&nbsp;</div></li><li><div>             * @since 3.7.0&nbsp;</div></li><li><div>             *&nbsp;</div></li><li><div>             * @param boolean $videopress_player_use_iframe&nbsp;</div></li><li><div>             */&nbsp;</div></li><li><div>            $iframe_embed = apply_filters( 'jetpack_videopress_player_use_iframe', true );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! array_key_exists( 'hd', $this-&gt;options ) ) {&nbsp;</div></li><li><div>            $this-&gt;options['hd'] = (bool) get_option( 'video_player_high_quality', false );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $videopress_options = array(&nbsp;</div></li><li><div>            'width' =&gt; absint( $this-&gt;video-&gt;calculated_width ), &nbsp;</div></li><li><div>            'height' =&gt; absint( $this-&gt;video-&gt;calculated_height ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        foreach ( $this-&gt;options as $option =&gt; $value ) {&nbsp;</div></li><li><div>            switch ( $option ) {&nbsp;</div></li><li><div>                case 'at':&nbsp;</div></li><li><div>                    if ( intval( $value ) ) {&nbsp;</div></li><li><div>                        $videopress_options[ $option ] = intval( $value );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 'autoplay':&nbsp;</div></li><li><div>                    $option = 'autoPlay';&nbsp;</div></li><li><div>                case 'hd':&nbsp;</div></li><li><div>                case 'loop':&nbsp;</div></li><li><div>                case 'permalink':&nbsp;</div></li><li><div>                    if ( in_array( $value, array( 1, 'true' ) ) ) {&nbsp;</div></li><li><div>                        $videopress_options[ $option ] = true;&nbsp;</div></li><li><div>                    } elseif ( in_array( $value, array( 0, 'false' ) ) ) {&nbsp;</div></li><li><div>                        $videopress_options[ $option ] = false;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 'defaultlangcode':&nbsp;</div></li><li><div>                    $option = 'defaultLangCode';&nbsp;</div></li><li><div>                    if ( $value ) {&nbsp;</div></li><li><div>                        $videopress_options[ $option ] = $value;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $iframe_embed ) {&nbsp;</div></li><li><div>            $iframe_url = &quot;https://videopress.com/embed/{$this-&gt;video-&gt;guid}&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $videopress_options as $option =&gt; $value ) {&nbsp;</div></li><li><div>                if ( ! in_array( $option, array( 'width', 'height' ) ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    // add_query_arg ignores false as a value, so replacing it with 0&nbsp;</div></li><li><div>                    $iframe_url = add_query_arg( $option, ( false === $value ) ? 0 : $value, $iframe_url );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $js_url = 'https://s0.wp.com/wp-content/plugins/video/assets/js/next/videopress-iframe.js';&nbsp;</div></li><li><div>            $js_url = add_query_arg( 'jetpack_version', JETPACK__VERSION, $js_url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return &quot;&lt;iframe width='&quot; . esc_attr( $videopress_options['width'] )&nbsp;</div></li><li><div>                . &quot;' height='&quot; . esc_attr( $videopress_options['height'] )&nbsp;</div></li><li><div>                . &quot;' src='&quot; . esc_attr( $iframe_url )&nbsp;</div></li><li><div>                . &quot;' frameborder='0' allowfullscreen&gt;&lt;/iframe&gt;&quot;&nbsp;</div></li><li><div>                . &quot;&lt;script src='&quot; . esc_attr( $js_url ) . &quot;'&gt;&lt;/script&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $videopress_options = json_encode( $videopress_options );&nbsp;</div></li><li><div>            $js_url = 'https://s0.wp.com/wp-content/plugins/video/assets/js/next/videopress.js';&nbsp;</div></li><li><div>            $js_url = add_query_arg( 'jetpack_version', JETPACK__VERSION, $js_url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return &quot;&lt;div id='{$video_container_id}'&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                &lt;script src='{$js_url}'&gt;&lt;/script&gt;&nbsp;</div></li><li><div>                &lt;script&gt;&nbsp;</div></li><li><div>                    videopress('{$this-&gt;video-&gt;guid}', document.querySelector('#{$video_container_id}'), {$videopress_options});&nbsp;</div></li><li><div>                &lt;/script&gt;&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Only allow legitimate Flash parameters and their values&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.2&nbsp;</div></li><li><div>     * @link http://kb2.adobe.com/cps/127/tn_12701.html Flash object and embed attributes&nbsp;</div></li><li><div>     * @link http://kb2.adobe.com/cps/133/tn_13331.html devicefont&nbsp;</div></li><li><div>     * @link http://kb2.adobe.com/cps/164/tn_16494.html allowscriptaccess&nbsp;</div></li><li><div>     * @link http://www.adobe.com/devnet/flashplayer/articles/full_screen_mode.html full screen mode&nbsp;</div></li><li><div>     * @link http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001079.html allownetworking&nbsp;</div></li><li><div>     * @param array $flash_params Flash parameters expressed in key-value form&nbsp;</div></li><li><div>     * @return array validated Flash parameters&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function esc_flash_params( $flash_params ) {&nbsp;</div></li><li><div>        $allowed_params = array(&nbsp;</div></li><li><div>            'swliveconnect' =&gt; array('true', 'false'), &nbsp;</div></li><li><div>            'play' =&gt; array('true', 'false'), &nbsp;</div></li><li><div>            'loop' =&gt; array('true', 'false'), &nbsp;</div></li><li><div>            'menu' =&gt; array('true', 'false'), &nbsp;</div></li><li><div>            'quality' =&gt; array('low', 'autolow', 'autohigh', 'medium', 'high', 'best'), &nbsp;</div></li><li><div>            'scale' =&gt; array('default', 'noborder', 'exactfit', 'noscale'), &nbsp;</div></li><li><div>            'align' =&gt; array('l', 'r', 't'), &nbsp;</div></li><li><div>            'salign' =&gt; array('l', 'r', 't', 'tl', 'tr', 'bl', 'br'), &nbsp;</div></li><li><div>            'wmode' =&gt; array('window', 'opaque', 'transparent', 'direct', 'gpu'), &nbsp;</div></li><li><div>            'devicefont' =&gt; array('_sans', '_serif', '_typewriter'), &nbsp;</div></li><li><div>            'allowscriptaccess' =&gt; array('always', 'samedomain', 'never'), &nbsp;</div></li><li><div>            'allownetworking' =&gt; array('all', 'internal', 'none'), &nbsp;</div></li><li><div>            'seamlesstabbing' =&gt; array('true', 'false'), &nbsp;</div></li><li><div>            'allowfullscreen' =&gt; array('true', 'false'), &nbsp;</div></li><li><div>            'fullScreenAspectRatio' =&gt; array('portrait', 'landscape'), &nbsp;</div></li><li><div>            'base', &nbsp;</div></li><li><div>            'bgcolor', &nbsp;</div></li><li><div>            'flashvars'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $allowed_params_keys = array_keys( $allowed_params );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $filtered_params = array();&nbsp;</div></li><li><div>        foreach( $flash_params as $param=&gt;$value ) {&nbsp;</div></li><li><div>            if ( empty($param) || empty($value) )&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>            $param = strtolower($param);&nbsp;</div></li><li><div>            if ( in_array($param, $allowed_params_keys) ) {&nbsp;</div></li><li><div>                if ( isset( $allowed_params[$param] ) && is_array( $allowed_params[$param] ) ) {&nbsp;</div></li><li><div>                    $value = strtolower($value);&nbsp;</div></li><li><div>                    if ( in_array( $value, $allowed_params[$param] ) )&nbsp;</div></li><li><div>                        $filtered_params[$param] = $value;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $filtered_params[$param] = $value;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        unset( $allowed_params_keys );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * Flash specifies sameDomain, not samedomain. change from lowercase value for preciseness&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        if ( isset( $filtered_params['allowscriptaccess'] ) && $filtered_params['allowscriptaccess'] === 'samedomain' )&nbsp;</div></li><li><div>            $filtered_params['allowscriptaccess'] = 'sameDomain';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $filtered_params;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Filter Flash variables from the response, taking into consideration player options.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.3&nbsp;</div></li><li><div>     * @return array Flash variable key value pairs&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function get_flash_variables() {&nbsp;</div></li><li><div>        if ( ! isset( $this-&gt;video-&gt;players-&gt;swf-&gt;vars ) )&nbsp;</div></li><li><div>            return array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $flashvars = (array) $this-&gt;video-&gt;players-&gt;swf-&gt;vars;&nbsp;</div></li><li><div>        if ( isset( $this-&gt;options['autoplay'] ) && $this-&gt;options['autoplay'] === true )&nbsp;</div></li><li><div>            $flashvars['autoPlay'] = 'true';&nbsp;</div></li><li><div>        return $flashvars;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Validate and filter Flash parameters&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.3&nbsp;</div></li><li><div>     * @return array Flash parameters passed through key and value validation&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function get_flash_parameters() {&nbsp;</div></li><li><div>        if ( ! isset( $this-&gt;video-&gt;players-&gt;swf-&gt;params ) )&nbsp;</div></li><li><div>            return array();&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            return self::esc_flash_params(&nbsp;</div></li><li><div>                /**&nbsp;</div></li><li><div>                 * Filters the Flash parameters of the VideoPress player.&nbsp;</div></li><li><div>                 *&nbsp;</div></li><li><div>                 * @module videopress&nbsp;</div></li><li><div>                 *&nbsp;</div></li><li><div>                 * @since 1.2.0&nbsp;</div></li><li><div>                 *&nbsp;</div></li><li><div>                 * @param array $this-&gt;video-&gt;players-&gt;swf-&gt;params Array of swf parameters for the VideoPress flash player.&nbsp;</div></li><li><div>                 */&nbsp;</div></li><li><div>                apply_filters( 'video_flash_params', (array) $this-&gt;video-&gt;players-&gt;swf-&gt;params, 10, 1 )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Flash player markup in a HTML embed element.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.1&nbsp;</div></li><li><div>     * @link http://www.whatwg.org/specs/web-apps/current-work/multipage/the-iframe-element.html#the-embed-element embed element&nbsp;</div></li><li><div>     * @link http://www.google.com/support/reader/bin/answer.py?answer=70664 Google Reader markup support&nbsp;</div></li><li><div>     * @return string HTML markup. Embed element with no children&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function flash_embed() {&nbsp;</div></li><li><div>        wp_enqueue_script( 'videopress' );&nbsp;</div></li><li><div>        if ( ! isset( $this-&gt;video-&gt;players-&gt;swf ) || ! isset( $this-&gt;video-&gt;players-&gt;swf-&gt;url ) )&nbsp;</div></li><li><div>            return '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $embed = array(&nbsp;</div></li><li><div>            'id' =&gt; $this-&gt;video_id, &nbsp;</div></li><li><div>            'src' =&gt; esc_url_raw( $this-&gt;video-&gt;players-&gt;swf-&gt;url . '&' . http_build_query( $this-&gt;get_flash_variables(), null, '&' ) , array( 'http', 'https' ) ), &nbsp;</div></li><li><div>            'type' =&gt; 'application/x-shockwave-flash', &nbsp;</div></li><li><div>            'width' =&gt; $this-&gt;video-&gt;calculated_width, &nbsp;</div></li><li><div>            'height' =&gt; $this-&gt;video-&gt;calculated_height&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        if ( isset( $this-&gt;video-&gt;title ) )&nbsp;</div></li><li><div>            $embed['title'] = $this-&gt;video-&gt;title;&nbsp;</div></li><li><div>        $embed = array_merge( $embed, $this-&gt;get_flash_parameters() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $html = '&lt;embed';&nbsp;</div></li><li><div>        foreach ( $embed as $attribute =&gt; $value ) {&nbsp;</div></li><li><div>            $html .= ' ' . esc_html( $attribute ) . '=&quot;' . esc_attr( $value ) . '&quot;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        unset( $embed );&nbsp;</div></li><li><div>        $html .= '&gt;&lt;/embed&gt;';&nbsp;</div></li><li><div>        return $html;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Double-baked Flash object markup for Internet Explorer and more standards-friendly consuming agents.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.1&nbsp;</div></li><li><div>     * @return HTML markup. Object and children.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function flash_object() {&nbsp;</div></li><li><div>        wp_enqueue_script( 'videopress' );&nbsp;</div></li><li><div>        if ( ! isset( $this-&gt;video-&gt;players-&gt;swf ) || ! isset( $this-&gt;video-&gt;players-&gt;swf-&gt;url ) )&nbsp;</div></li><li><div>            return '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $thumbnail_html = '&lt;img alt=&quot;';&nbsp;</div></li><li><div>        if ( isset( $this-&gt;video-&gt;title ) )&nbsp;</div></li><li><div>            $thumbnail_html .= esc_attr( $this-&gt;video-&gt;title );&nbsp;</div></li><li><div>        $thumbnail_html .= '&quot; src=&quot;' . esc_url( $this-&gt;video-&gt;poster_frame_uri, array( 'http', 'https' ) ) . '&quot; width=&quot;' . $this-&gt;video-&gt;calculated_width . '&quot; height=&quot;' . $this-&gt;video-&gt;calculated_height . '&quot; /&gt;';&nbsp;</div></li><li><div>        $flash_vars = esc_attr( http_build_query( $this-&gt;get_flash_variables(), null, '&' ) );&nbsp;</div></li><li><div>        $flash_params = '';&nbsp;</div></li><li><div>        foreach ( $this-&gt;get_flash_parameters() as $attribute =&gt; $value ) {&nbsp;</div></li><li><div>            $flash_params .= '&lt;param name=&quot;' . esc_attr( $attribute ) . '&quot; value=&quot;' . esc_attr( $value ) . '&quot; /&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $flash_help = sprintf( __( 'This video requires &lt;a rel=&quot;nofollow&quot; href=&quot;%s&quot;&gt;Adobe Flash&lt;/a&gt; for playback.', 'jetpack' ), 'http://www.adobe.com/go/getflashplayer');&nbsp;</div></li><li><div>        $flash_player_url = esc_url( $this-&gt;video-&gt;players-&gt;swf-&gt;url, array( 'http', 'https' ) );&nbsp;</div></li><li><div>        $description = '';&nbsp;</div></li><li><div>        if ( isset( $this-&gt;video-&gt;title ) ) {&nbsp;</div></li><li><div>            $standby = $this-&gt;video-&gt;title;&nbsp;</div></li><li><div>            $description = '&lt;p&gt;&lt;strong&gt;' . esc_html( $this-&gt;video-&gt;title ) . '&lt;/strong&gt;&lt;/p&gt;';&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $standby = __( 'Loading video...', 'jetpack' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $standby = ' standby=&quot;' . esc_attr( $standby ) . '&quot;';&nbsp;</div></li><li><div>        return &lt;&lt;&lt;OBJECT&nbsp;</div></li><li><div>&lt;script type=&quot;text/javascript&quot;&gt;if(typeof swfobject!==&quot;undefined&quot;) {swfobject.registerObject(&quot;{$this-&gt;video_id}&quot;, &quot;{$this-&gt;video-&gt;players-&gt;swf-&gt;version}&quot;);}&lt;/script&gt;&nbsp;</div></li><li><div>&lt;object classid=&quot;clsid:D27CDB6E-AE6D-11cf-96B8-444553540000&quot; width=&quot;{$this-&gt;video-&gt;calculated_width}&quot; height=&quot;{$this-&gt;video-&gt;calculated_height}&quot; id=&quot;{$this-&gt;video_id}&quot;{$standby}&gt;&nbsp;</div></li><li><div>    &lt;param name=&quot;movie&quot; value=&quot;{$flash_player_url}&quot; /&gt;&nbsp;</div></li><li><div>    {$flash_params}&nbsp;</div></li><li><div>    &lt;param name=&quot;flashvars&quot; value=&quot;{$flash_vars}&quot; /&gt;&nbsp;</div></li><li><div>    &lt;!--[if !IE]&gt;--&gt;&nbsp;</div></li><li><div>    &lt;object type=&quot;application/x-shockwave-flash&quot; data=&quot;{$flash_player_url}&quot; width=&quot;{$this-&gt;video-&gt;calculated_width}&quot; height=&quot;{$this-&gt;video-&gt;calculated_height}&quot;{$standby}&gt;&nbsp;</div></li><li><div>        {$flash_params}&nbsp;</div></li><li><div>        &lt;param name=&quot;flashvars&quot; value=&quot;{$flash_vars}&quot; /&gt;&nbsp;</div></li><li><div>    &lt;!--&lt;![endif]--&gt;&nbsp;</div></li><li><div>    {$thumbnail_html}{$description}&lt;p class=&quot;robots-nocontent&quot;&gt;{$flash_help}&lt;/p&gt;&nbsp;</div></li><li><div>    &lt;!--[if !IE]&gt;--&gt;&nbsp;</div></li><li><div>    &lt;/object&gt;&nbsp;</div></li><li><div>    &lt;!--&lt;![endif]--&gt;&nbsp;</div></li><li><div>&lt;/object&gt;&nbsp;</div></li><li><div>OBJECT;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 1.3</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.2/classes/video_press_player/" class="">3.8.2</a></li><li><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.1/classes/video_press_player/" class="">3.8.1</a></li><li><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/classes/video_press_player/" class="active">3.8.0</a></li><li><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.7.2/classes/video_press_player/" class="">3.7.2</a></li><li><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.7.1/classes/video_press_player/" class="">3.7.1</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>VideoPress_Player</li><li><span></span>Jetpack by WordPress.com</li><li><span></span>3.8.2</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>