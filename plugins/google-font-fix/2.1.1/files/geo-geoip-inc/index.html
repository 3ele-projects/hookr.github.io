<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="2.1.1" data-slug="google-font-fix" data-type="file" data-id="62025"><head xmlns="http://www.w3.org/1999/xhtml"><title> geo-geoip-inc | file | Google Font Fix | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, google-font-fix, 2.1.1" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.8"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=7568a70ff978d8391d29b2e5cc7764cd' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.8' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/geo-geoip-inc/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fgeo-geoip-inc%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fgeo-geoip-inc%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-google-font-fix-2.1.1-file-geo-geoip-inc","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="geo-geoip-inc" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to google-font-fix." href="http://hookr.io/plugins/google-font-fix/" class="plugin"><span property="name">google-font-fix</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.1.1." href="http://hookr.io/plugins/google-font-fix/2.1.1/" class="H_VERSION"><span property="name">2.1.1</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/google-font-fix/2.1.1/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">geo-geoip-inc</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="85"><a href="http://hookr.io/plugins/google-font-fix/2.1.1/all/" title="All">All <span class="count badge">85</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/google-font-fix/2.1.1/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="1"><a href="http://hookr.io/plugins/google-font-fix/2.1.1/hooks/" title="Hooks">Hooks <span class="count badge">1</span></a></li><li class="" data-id="action" data-count="0"><a href="http://hookr.io/plugins/google-font-fix/2.1.1/actions/" title="Actions">Actions <span class="count badge">0</span></a></li><li class="" data-id="filter" data-count="1"><a href="http://hookr.io/plugins/google-font-fix/2.1.1/filters/" title="Filters">Filters <span class="count badge">1</span></a></li><li class="" data-id="class" data-count="1"><a href="http://hookr.io/plugins/google-font-fix/2.1.1/classes/" title="Classes">Classes <span class="count badge">1</span></a></li><li class="" data-id="constant" data-count="49"><a href="http://hookr.io/plugins/google-font-fix/2.1.1/constants/" title="Constants">Constants <span class="count badge">49</span></a></li><li class="" data-id="function" data-count="34"><a href="http://hookr.io/plugins/google-font-fix/2.1.1/functions/" title="Functions">Functions <span class="count badge">34</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/plugins/google-font-fix/2.1.1/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/geo/geoip.inc.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** -*- Mode: C; indent-tabs-mode: t; c-basic-offset: 2; tab-width: 2 -*- */</span>&nbsp;</div></li><li><div><span class="comment">/** geoip.inc</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Copyright (C) 2007 MaxMind LLC</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This library is free software; you can redistribute it and/or</span>&nbsp;</div></li><li><div><span class="comment"> * modify it under the terms of the GNU Lesser General Public</span>&nbsp;</div></li><li><div><span class="comment"> * License as published by the Free Software Foundation; either</span>&nbsp;</div></li><li><div><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This library is distributed in the hope that it will be useful, </span>&nbsp;</div></li><li><div><span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>&nbsp;</div></li><li><div><span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>&nbsp;</div></li><li><div><span class="comment"> * Lesser General Public License for more details.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * You should have received a copy of the GNU Lesser General Public</span>&nbsp;</div></li><li><div><span class="comment"> * License along with this library; if not, write to the Free Software</span>&nbsp;</div></li><li><div><span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>define(&quot;GEOIP_COUNTRY_BEGIN&quot;, 16776960);&nbsp;</div></li><li><div>define(&quot;GEOIP_STATE_BEGIN_REV0&quot;, 16700000);&nbsp;</div></li><li><div>define(&quot;GEOIP_STATE_BEGIN_REV1&quot;, 16000000);&nbsp;</div></li><li><div>define(&quot;GEOIP_STANDARD&quot;, 0);&nbsp;</div></li><li><div>define(&quot;GEOIP_MEMORY_CACHE&quot;, 1);&nbsp;</div></li><li><div>define(&quot;GEOIP_SHARED_MEMORY&quot;, 2);&nbsp;</div></li><li><div>define(&quot;STRUCTURE_INFO_MAX_SIZE&quot;, 20);&nbsp;</div></li><li><div>define(&quot;DATABASE_INFO_MAX_SIZE&quot;, 100);&nbsp;</div></li><li><div>define(&quot;GEOIP_COUNTRY_EDITION&quot;, 106);&nbsp;</div></li><li><div>define(&quot;GEOIP_PROXY_EDITION&quot;, 8);&nbsp;</div></li><li><div>define(&quot;GEOIP_ASNUM_EDITION&quot;, 9);&nbsp;</div></li><li><div>define(&quot;GEOIP_NETSPEED_EDITION&quot;, 10);&nbsp;</div></li><li><div>define(&quot;GEOIP_REGION_EDITION_REV0&quot;, 112);&nbsp;</div></li><li><div>define(&quot;GEOIP_REGION_EDITION_REV1&quot;, 3);&nbsp;</div></li><li><div>define(&quot;GEOIP_CITY_EDITION_REV0&quot;, 111);&nbsp;</div></li><li><div>define(&quot;GEOIP_CITY_EDITION_REV1&quot;, 2);&nbsp;</div></li><li><div>define(&quot;GEOIP_ORG_EDITION&quot;, 110);&nbsp;</div></li><li><div>define(&quot;GEOIP_ISP_EDITION&quot;, 4);&nbsp;</div></li><li><div>define(&quot;SEGMENT_RECORD_LENGTH&quot;, 3);&nbsp;</div></li><li><div>define(&quot;STANDARD_RECORD_LENGTH&quot;, 3);&nbsp;</div></li><li><div>define(&quot;ORG_RECORD_LENGTH&quot;, 4);&nbsp;</div></li><li><div>define(&quot;MAX_RECORD_LENGTH&quot;, 4);&nbsp;</div></li><li><div>define(&quot;MAX_ORG_RECORD_LENGTH&quot;, 300);&nbsp;</div></li><li><div>define(&quot;GEOIP_SHM_KEY&quot;, 0x4f415401);&nbsp;</div></li><li><div>define(&quot;US_OFFSET&quot;, 1);&nbsp;</div></li><li><div>define(&quot;CANADA_OFFSET&quot;, 677);&nbsp;</div></li><li><div>define(&quot;WORLD_OFFSET&quot;, 1353);&nbsp;</div></li><li><div>define(&quot;FIPS_RANGE&quot;, 360);&nbsp;</div></li><li><div>define(&quot;GEOIP_UNKNOWN_SPEED&quot;, 0);&nbsp;</div></li><li><div>define(&quot;GEOIP_DIALUP_SPEED&quot;, 1);&nbsp;</div></li><li><div>define(&quot;GEOIP_CABLEDSL_SPEED&quot;, 2);&nbsp;</div></li><li><div>define(&quot;GEOIP_CORPORATE_SPEED&quot;, 3);&nbsp;</div></li><li><div>define(&quot;GEOIP_DOMAIN_EDITION&quot;, 11);&nbsp;</div></li><li><div>define(&quot;GEOIP_COUNTRY_EDITION_V6&quot;, 12);&nbsp;</div></li><li><div>define(&quot;GEOIP_LOCATIONA_EDITION&quot;, 13);&nbsp;</div></li><li><div>define(&quot;GEOIP_ACCURACYRADIUS_EDITION&quot;, 14);&nbsp;</div></li><li><div>define(&quot;GEOIP_CITYCOMBINED_EDITION&quot;, 15);&nbsp;</div></li><li><div>define(&quot;GEOIP_CITY_EDITION_REV1_V6&quot;, 30);&nbsp;</div></li><li><div>define(&quot;GEOIP_CITY_EDITION_REV0_V6&quot;, 31);&nbsp;</div></li><li><div>define(&quot;GEOIP_NETSPEED_EDITION_REV1&quot;, 32);&nbsp;</div></li><li><div>define(&quot;GEOIP_NETSPEED_EDITION_REV1_V6&quot;, 33);&nbsp;</div></li><li><div>define(&quot;GEOIP_USERTYPE_EDITION&quot;, 28);&nbsp;</div></li><li><div>define(&quot;GEOIP_USERTYPE_EDITION_V6&quot;, 29);&nbsp;</div></li><li><div>define(&quot;GEOIP_ASNUM_EDITION_V6&quot;, 21);&nbsp;</div></li><li><div>define(&quot;GEOIP_ISP_EDITION_V6&quot;, 22);&nbsp;</div></li><li><div>define(&quot;GEOIP_ORG_EDITION_V6&quot;, 23);&nbsp;</div></li><li><div>define(&quot;GEOIP_DOMAIN_EDITION_V6&quot;, 24);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>define(&quot;CITYCOMBINED_FIXED_RECORD&quot;, 7 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>class GeoIP {&nbsp;</div></li><li><div>  var $flags;&nbsp;</div></li><li><div>  var $filehandle;&nbsp;</div></li><li><div>  var $memory_buffer;&nbsp;</div></li><li><div>  var $databaseType;&nbsp;</div></li><li><div>  var $databaseSegments;&nbsp;</div></li><li><div>  var $record_length;&nbsp;</div></li><li><div>  var $shmid;&nbsp;</div></li><li><div>  var $GEOIP_COUNTRY_CODE_TO_NUMBER = array(&nbsp;</div></li><li><div>      &quot;&quot; =&gt; 0, &quot;AP&quot; =&gt; 1, &quot;EU&quot; =&gt; 2, &quot;AD&quot; =&gt; 3, &quot;AE&quot; =&gt; 4, &quot;AF&quot; =&gt; 5, &nbsp;</div></li><li><div>      &quot;AG&quot; =&gt; 6, &quot;AI&quot; =&gt; 7, &quot;AL&quot; =&gt; 8, &quot;AM&quot; =&gt; 9, &quot;CW&quot; =&gt; 10, &quot;AO&quot; =&gt; 11, &nbsp;</div></li><li><div>      &quot;AQ&quot; =&gt; 12, &quot;AR&quot; =&gt; 13, &quot;AS&quot; =&gt; 14, &quot;AT&quot; =&gt; 15, &quot;AU&quot; =&gt; 16, &quot;AW&quot; =&gt; 17, &nbsp;</div></li><li><div>      &quot;AZ&quot; =&gt; 18, &quot;BA&quot; =&gt; 19, &quot;BB&quot; =&gt; 20, &quot;BD&quot; =&gt; 21, &quot;BE&quot; =&gt; 22, &quot;BF&quot; =&gt; 23, &nbsp;</div></li><li><div>      &quot;BG&quot; =&gt; 24, &quot;BH&quot; =&gt; 25, &quot;BI&quot; =&gt; 26, &quot;BJ&quot; =&gt; 27, &quot;BM&quot; =&gt; 28, &quot;BN&quot; =&gt; 29, &nbsp;</div></li><li><div>      &quot;BO&quot; =&gt; 30, &quot;BR&quot; =&gt; 31, &quot;BS&quot; =&gt; 32, &quot;BT&quot; =&gt; 33, &quot;BV&quot; =&gt; 34, &quot;BW&quot; =&gt; 35, &nbsp;</div></li><li><div>      &quot;BY&quot; =&gt; 36, &quot;BZ&quot; =&gt; 37, &quot;CA&quot; =&gt; 38, &quot;CC&quot; =&gt; 39, &quot;CD&quot; =&gt; 40, &quot;CF&quot; =&gt; 41, &nbsp;</div></li><li><div>      &quot;CG&quot; =&gt; 42, &quot;CH&quot; =&gt; 43, &quot;CI&quot; =&gt; 44, &quot;CK&quot; =&gt; 45, &quot;CL&quot; =&gt; 46, &quot;CM&quot; =&gt; 47, &nbsp;</div></li><li><div>      &quot;CN&quot; =&gt; 48, &quot;CO&quot; =&gt; 49, &quot;CR&quot; =&gt; 50, &quot;CU&quot; =&gt; 51, &quot;CV&quot; =&gt; 52, &quot;CX&quot; =&gt; 53, &nbsp;</div></li><li><div>      &quot;CY&quot; =&gt; 54, &quot;CZ&quot; =&gt; 55, &quot;DE&quot; =&gt; 56, &quot;DJ&quot; =&gt; 57, &quot;DK&quot; =&gt; 58, &quot;DM&quot; =&gt; 59, &nbsp;</div></li><li><div>      &quot;DO&quot; =&gt; 60, &quot;DZ&quot; =&gt; 61, &quot;EC&quot; =&gt; 62, &quot;EE&quot; =&gt; 63, &quot;EG&quot; =&gt; 64, &quot;EH&quot; =&gt; 65, &nbsp;</div></li><li><div>      &quot;ER&quot; =&gt; 66, &quot;ES&quot; =&gt; 67, &quot;ET&quot; =&gt; 68, &quot;FI&quot; =&gt; 69, &quot;FJ&quot; =&gt; 70, &quot;FK&quot; =&gt; 71, &nbsp;</div></li><li><div>      &quot;FM&quot; =&gt; 72, &quot;FO&quot; =&gt; 73, &quot;FR&quot; =&gt; 74, &quot;SX&quot; =&gt; 75, &quot;GA&quot; =&gt; 76, &quot;GB&quot; =&gt; 77, &nbsp;</div></li><li><div>      &quot;GD&quot; =&gt; 78, &quot;GE&quot; =&gt; 79, &quot;GF&quot; =&gt; 80, &quot;GH&quot; =&gt; 81, &quot;GI&quot; =&gt; 82, &quot;GL&quot; =&gt; 83, &nbsp;</div></li><li><div>      &quot;GM&quot; =&gt; 84, &quot;GN&quot; =&gt; 85, &quot;GP&quot; =&gt; 86, &quot;GQ&quot; =&gt; 87, &quot;GR&quot; =&gt; 88, &quot;GS&quot; =&gt; 89, &nbsp;</div></li><li><div>      &quot;GT&quot; =&gt; 90, &quot;GU&quot; =&gt; 91, &quot;GW&quot; =&gt; 92, &quot;GY&quot; =&gt; 93, &quot;HK&quot; =&gt; 94, &quot;HM&quot; =&gt; 95, &nbsp;</div></li><li><div>      &quot;HN&quot; =&gt; 96, &quot;HR&quot; =&gt; 97, &quot;HT&quot; =&gt; 98, &quot;HU&quot; =&gt; 99, &quot;ID&quot; =&gt; 100, &quot;IE&quot; =&gt; 101, &nbsp;</div></li><li><div>      &quot;IL&quot; =&gt; 102, &quot;IN&quot; =&gt; 103, &quot;IO&quot; =&gt; 104, &quot;IQ&quot; =&gt; 105, &quot;IR&quot; =&gt; 106, &quot;IS&quot; =&gt; 107, &nbsp;</div></li><li><div>      &quot;IT&quot; =&gt; 108, &quot;JM&quot; =&gt; 109, &quot;JO&quot; =&gt; 110, &quot;JP&quot; =&gt; 111, &quot;KE&quot; =&gt; 112, &quot;KG&quot; =&gt; 113, &nbsp;</div></li><li><div>      &quot;KH&quot; =&gt; 114, &quot;KI&quot; =&gt; 115, &quot;KM&quot; =&gt; 116, &quot;KN&quot; =&gt; 117, &quot;KP&quot; =&gt; 118, &quot;KR&quot; =&gt; 119, &nbsp;</div></li><li><div>      &quot;KW&quot; =&gt; 120, &quot;KY&quot; =&gt; 121, &quot;KZ&quot; =&gt; 122, &quot;LA&quot; =&gt; 123, &quot;LB&quot; =&gt; 124, &quot;LC&quot; =&gt; 125, &nbsp;</div></li><li><div>      &quot;LI&quot; =&gt; 126, &quot;LK&quot; =&gt; 127, &quot;LR&quot; =&gt; 128, &quot;LS&quot; =&gt; 129, &quot;LT&quot; =&gt; 130, &quot;LU&quot; =&gt; 131, &nbsp;</div></li><li><div>      &quot;LV&quot; =&gt; 132, &quot;LY&quot; =&gt; 133, &quot;MA&quot; =&gt; 134, &quot;MC&quot; =&gt; 135, &quot;MD&quot; =&gt; 136, &quot;MG&quot; =&gt; 137, &nbsp;</div></li><li><div>      &quot;MH&quot; =&gt; 138, &quot;MK&quot; =&gt; 139, &quot;ML&quot; =&gt; 140, &quot;MM&quot; =&gt; 141, &quot;MN&quot; =&gt; 142, &quot;MO&quot; =&gt; 143, &nbsp;</div></li><li><div>      &quot;MP&quot; =&gt; 144, &quot;MQ&quot; =&gt; 145, &quot;MR&quot; =&gt; 146, &quot;MS&quot; =&gt; 147, &quot;MT&quot; =&gt; 148, &quot;MU&quot; =&gt; 149, &nbsp;</div></li><li><div>      &quot;MV&quot; =&gt; 150, &quot;MW&quot; =&gt; 151, &quot;MX&quot; =&gt; 152, &quot;MY&quot; =&gt; 153, &quot;MZ&quot; =&gt; 154, &quot;NA&quot; =&gt; 155, &nbsp;</div></li><li><div>      &quot;NC&quot; =&gt; 156, &quot;NE&quot; =&gt; 157, &quot;NF&quot; =&gt; 158, &quot;NG&quot; =&gt; 159, &quot;NI&quot; =&gt; 160, &quot;NL&quot; =&gt; 161, &nbsp;</div></li><li><div>      &quot;NO&quot; =&gt; 162, &quot;NP&quot; =&gt; 163, &quot;NR&quot; =&gt; 164, &quot;NU&quot; =&gt; 165, &quot;NZ&quot; =&gt; 166, &quot;OM&quot; =&gt; 167, &nbsp;</div></li><li><div>      &quot;PA&quot; =&gt; 168, &quot;PE&quot; =&gt; 169, &quot;PF&quot; =&gt; 170, &quot;PG&quot; =&gt; 171, &quot;PH&quot; =&gt; 172, &quot;PK&quot; =&gt; 173, &nbsp;</div></li><li><div>      &quot;PL&quot; =&gt; 174, &quot;PM&quot; =&gt; 175, &quot;PN&quot; =&gt; 176, &quot;PR&quot; =&gt; 177, &quot;PS&quot; =&gt; 178, &quot;PT&quot; =&gt; 179, &nbsp;</div></li><li><div>      &quot;PW&quot; =&gt; 180, &quot;PY&quot; =&gt; 181, &quot;QA&quot; =&gt; 182, &quot;RE&quot; =&gt; 183, &quot;RO&quot; =&gt; 184, &quot;RU&quot; =&gt; 185, &nbsp;</div></li><li><div>      &quot;RW&quot; =&gt; 186, &quot;SA&quot; =&gt; 187, &quot;SB&quot; =&gt; 188, &quot;SC&quot; =&gt; 189, &quot;SD&quot; =&gt; 190, &quot;SE&quot; =&gt; 191, &nbsp;</div></li><li><div>      &quot;SG&quot; =&gt; 192, &quot;SH&quot; =&gt; 193, &quot;SI&quot; =&gt; 194, &quot;SJ&quot; =&gt; 195, &quot;SK&quot; =&gt; 196, &quot;SL&quot; =&gt; 197, &nbsp;</div></li><li><div>      &quot;SM&quot; =&gt; 198, &quot;SN&quot; =&gt; 199, &quot;SO&quot; =&gt; 200, &quot;SR&quot; =&gt; 201, &quot;ST&quot; =&gt; 202, &quot;SV&quot; =&gt; 203, &nbsp;</div></li><li><div>      &quot;SY&quot; =&gt; 204, &quot;SZ&quot; =&gt; 205, &quot;TC&quot; =&gt; 206, &quot;TD&quot; =&gt; 207, &quot;TF&quot; =&gt; 208, &quot;TG&quot; =&gt; 209, &nbsp;</div></li><li><div>      &quot;TH&quot; =&gt; 210, &quot;TJ&quot; =&gt; 211, &quot;TK&quot; =&gt; 212, &quot;TM&quot; =&gt; 213, &quot;TN&quot; =&gt; 214, &quot;TO&quot; =&gt; 215, &nbsp;</div></li><li><div>      &quot;TL&quot; =&gt; 216, &quot;TR&quot; =&gt; 217, &quot;TT&quot; =&gt; 218, &quot;TV&quot; =&gt; 219, &quot;TW&quot; =&gt; 220, &quot;TZ&quot; =&gt; 221, &nbsp;</div></li><li><div>      &quot;UA&quot; =&gt; 222, &quot;UG&quot; =&gt; 223, &quot;UM&quot; =&gt; 224, &quot;US&quot; =&gt; 225, &quot;UY&quot; =&gt; 226, &quot;UZ&quot; =&gt; 227, &nbsp;</div></li><li><div>      &quot;VA&quot; =&gt; 228, &quot;VC&quot; =&gt; 229, &quot;VE&quot; =&gt; 230, &quot;VG&quot; =&gt; 231, &quot;VI&quot; =&gt; 232, &quot;VN&quot; =&gt; 233, &nbsp;</div></li><li><div>      &quot;VU&quot; =&gt; 234, &quot;WF&quot; =&gt; 235, &quot;WS&quot; =&gt; 236, &quot;YE&quot; =&gt; 237, &quot;YT&quot; =&gt; 238, &quot;RS&quot; =&gt; 239, &nbsp;</div></li><li><div>      &quot;ZA&quot; =&gt; 240, &quot;ZM&quot; =&gt; 241, &quot;ME&quot; =&gt; 242, &quot;ZW&quot; =&gt; 243, &quot;A1&quot; =&gt; 244, &quot;A2&quot; =&gt; 245, &nbsp;</div></li><li><div>      &quot;O1&quot; =&gt; 246, &quot;AX&quot; =&gt; 247, &quot;GG&quot; =&gt; 248, &quot;IM&quot; =&gt; 249, &quot;JE&quot; =&gt; 250, &quot;BL&quot; =&gt; 251, &nbsp;</div></li><li><div>      &quot;MF&quot; =&gt; 252, &quot;BQ&quot; =&gt; 253, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  var $GEOIP_COUNTRY_CODES = array(&nbsp;</div></li><li><div>      &quot;&quot;, &quot;AP&quot;, &quot;EU&quot;, &quot;AD&quot;, &quot;AE&quot;, &quot;AF&quot;, &quot;AG&quot;, &quot;AI&quot;, &quot;AL&quot;, &quot;AM&quot;, &quot;CW&quot;, &nbsp;</div></li><li><div>      &quot;AO&quot;, &quot;AQ&quot;, &quot;AR&quot;, &quot;AS&quot;, &quot;AT&quot;, &quot;AU&quot;, &quot;AW&quot;, &quot;AZ&quot;, &quot;BA&quot;, &quot;BB&quot;, &nbsp;</div></li><li><div>      &quot;BD&quot;, &quot;BE&quot;, &quot;BF&quot;, &quot;BG&quot;, &quot;BH&quot;, &quot;BI&quot;, &quot;BJ&quot;, &quot;BM&quot;, &quot;BN&quot;, &quot;BO&quot;, &nbsp;</div></li><li><div>      &quot;BR&quot;, &quot;BS&quot;, &quot;BT&quot;, &quot;BV&quot;, &quot;BW&quot;, &quot;BY&quot;, &quot;BZ&quot;, &quot;CA&quot;, &quot;CC&quot;, &quot;CD&quot;, &nbsp;</div></li><li><div>      &quot;CF&quot;, &quot;CG&quot;, &quot;CH&quot;, &quot;CI&quot;, &quot;CK&quot;, &quot;CL&quot;, &quot;CM&quot;, &quot;CN&quot;, &quot;CO&quot;, &quot;CR&quot;, &nbsp;</div></li><li><div>      &quot;CU&quot;, &quot;CV&quot;, &quot;CX&quot;, &quot;CY&quot;, &quot;CZ&quot;, &quot;DE&quot;, &quot;DJ&quot;, &quot;DK&quot;, &quot;DM&quot;, &quot;DO&quot;, &nbsp;</div></li><li><div>      &quot;DZ&quot;, &quot;EC&quot;, &quot;EE&quot;, &quot;EG&quot;, &quot;EH&quot;, &quot;ER&quot;, &quot;ES&quot;, &quot;ET&quot;, &quot;FI&quot;, &quot;FJ&quot;, &nbsp;</div></li><li><div>      &quot;FK&quot;, &quot;FM&quot;, &quot;FO&quot;, &quot;FR&quot;, &quot;SX&quot;, &quot;GA&quot;, &quot;GB&quot;, &quot;GD&quot;, &quot;GE&quot;, &quot;GF&quot;, &nbsp;</div></li><li><div>      &quot;GH&quot;, &quot;GI&quot;, &quot;GL&quot;, &quot;GM&quot;, &quot;GN&quot;, &quot;GP&quot;, &quot;GQ&quot;, &quot;GR&quot;, &quot;GS&quot;, &quot;GT&quot;, &nbsp;</div></li><li><div>      &quot;GU&quot;, &quot;GW&quot;, &quot;GY&quot;, &quot;HK&quot;, &quot;HM&quot;, &quot;HN&quot;, &quot;HR&quot;, &quot;HT&quot;, &quot;HU&quot;, &quot;ID&quot;, &nbsp;</div></li><li><div>      &quot;IE&quot;, &quot;IL&quot;, &quot;IN&quot;, &quot;IO&quot;, &quot;IQ&quot;, &quot;IR&quot;, &quot;IS&quot;, &quot;IT&quot;, &quot;JM&quot;, &quot;JO&quot;, &nbsp;</div></li><li><div>      &quot;JP&quot;, &quot;KE&quot;, &quot;KG&quot;, &quot;KH&quot;, &quot;KI&quot;, &quot;KM&quot;, &quot;KN&quot;, &quot;KP&quot;, &quot;KR&quot;, &quot;KW&quot;, &nbsp;</div></li><li><div>      &quot;KY&quot;, &quot;KZ&quot;, &quot;LA&quot;, &quot;LB&quot;, &quot;LC&quot;, &quot;LI&quot;, &quot;LK&quot;, &quot;LR&quot;, &quot;LS&quot;, &quot;LT&quot;, &nbsp;</div></li><li><div>      &quot;LU&quot;, &quot;LV&quot;, &quot;LY&quot;, &quot;MA&quot;, &quot;MC&quot;, &quot;MD&quot;, &quot;MG&quot;, &quot;MH&quot;, &quot;MK&quot;, &quot;ML&quot;, &nbsp;</div></li><li><div>      &quot;MM&quot;, &quot;MN&quot;, &quot;MO&quot;, &quot;MP&quot;, &quot;MQ&quot;, &quot;MR&quot;, &quot;MS&quot;, &quot;MT&quot;, &quot;MU&quot;, &quot;MV&quot;, &nbsp;</div></li><li><div>      &quot;MW&quot;, &quot;MX&quot;, &quot;MY&quot;, &quot;MZ&quot;, &quot;NA&quot;, &quot;NC&quot;, &quot;NE&quot;, &quot;NF&quot;, &quot;NG&quot;, &quot;NI&quot;, &nbsp;</div></li><li><div>      &quot;NL&quot;, &quot;NO&quot;, &quot;NP&quot;, &quot;NR&quot;, &quot;NU&quot;, &quot;NZ&quot;, &quot;OM&quot;, &quot;PA&quot;, &quot;PE&quot;, &quot;PF&quot;, &nbsp;</div></li><li><div>      &quot;PG&quot;, &quot;PH&quot;, &quot;PK&quot;, &quot;PL&quot;, &quot;PM&quot;, &quot;PN&quot;, &quot;PR&quot;, &quot;PS&quot;, &quot;PT&quot;, &quot;PW&quot;, &nbsp;</div></li><li><div>      &quot;PY&quot;, &quot;QA&quot;, &quot;RE&quot;, &quot;RO&quot;, &quot;RU&quot;, &quot;RW&quot;, &quot;SA&quot;, &quot;SB&quot;, &quot;SC&quot;, &quot;SD&quot;, &nbsp;</div></li><li><div>      &quot;SE&quot;, &quot;SG&quot;, &quot;SH&quot;, &quot;SI&quot;, &quot;SJ&quot;, &quot;SK&quot;, &quot;SL&quot;, &quot;SM&quot;, &quot;SN&quot;, &quot;SO&quot;, &nbsp;</div></li><li><div>      &quot;SR&quot;, &quot;ST&quot;, &quot;SV&quot;, &quot;SY&quot;, &quot;SZ&quot;, &quot;TC&quot;, &quot;TD&quot;, &quot;TF&quot;, &quot;TG&quot;, &quot;TH&quot;, &nbsp;</div></li><li><div>      &quot;TJ&quot;, &quot;TK&quot;, &quot;TM&quot;, &quot;TN&quot;, &quot;TO&quot;, &quot;TL&quot;, &quot;TR&quot;, &quot;TT&quot;, &quot;TV&quot;, &quot;TW&quot;, &nbsp;</div></li><li><div>      &quot;TZ&quot;, &quot;UA&quot;, &quot;UG&quot;, &quot;UM&quot;, &quot;US&quot;, &quot;UY&quot;, &quot;UZ&quot;, &quot;VA&quot;, &quot;VC&quot;, &quot;VE&quot;, &nbsp;</div></li><li><div>      &quot;VG&quot;, &quot;VI&quot;, &quot;VN&quot;, &quot;VU&quot;, &quot;WF&quot;, &quot;WS&quot;, &quot;YE&quot;, &quot;YT&quot;, &quot;RS&quot;, &quot;ZA&quot;, &nbsp;</div></li><li><div>      &quot;ZM&quot;, &quot;ME&quot;, &quot;ZW&quot;, &quot;A1&quot;, &quot;A2&quot;, &quot;O1&quot;, &quot;AX&quot;, &quot;GG&quot;, &quot;IM&quot;, &quot;JE&quot;, &nbsp;</div></li><li><div>      &quot;BL&quot;, &quot;MF&quot;, &quot;BQ&quot;&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  var $GEOIP_COUNTRY_CODES3 = array(&nbsp;</div></li><li><div>      &quot;&quot;, &quot;AP&quot;, &quot;EU&quot;, &quot;AND&quot;, &quot;ARE&quot;, &quot;AFG&quot;, &quot;ATG&quot;, &quot;AIA&quot;, &quot;ALB&quot;, &quot;ARM&quot;, &quot;CUW&quot;, &nbsp;</div></li><li><div>      &quot;AGO&quot;, &quot;ATA&quot;, &quot;ARG&quot;, &quot;ASM&quot;, &quot;AUT&quot;, &quot;AUS&quot;, &quot;ABW&quot;, &quot;AZE&quot;, &quot;BIH&quot;, &quot;BRB&quot;, &nbsp;</div></li><li><div>      &quot;BGD&quot;, &quot;BEL&quot;, &quot;BFA&quot;, &quot;BGR&quot;, &quot;BHR&quot;, &quot;BDI&quot;, &quot;BEN&quot;, &quot;BMU&quot;, &quot;BRN&quot;, &quot;BOL&quot;, &nbsp;</div></li><li><div>      &quot;BRA&quot;, &quot;BHS&quot;, &quot;BTN&quot;, &quot;BVT&quot;, &quot;BWA&quot;, &quot;BLR&quot;, &quot;BLZ&quot;, &quot;CAN&quot;, &quot;CCK&quot;, &quot;COD&quot;, &nbsp;</div></li><li><div>      &quot;CAF&quot;, &quot;COG&quot;, &quot;CHE&quot;, &quot;CIV&quot;, &quot;COK&quot;, &quot;CHL&quot;, &quot;CMR&quot;, &quot;CHN&quot;, &quot;COL&quot;, &quot;CRI&quot;, &nbsp;</div></li><li><div>      &quot;CUB&quot;, &quot;CPV&quot;, &quot;CXR&quot;, &quot;CYP&quot;, &quot;CZE&quot;, &quot;DEU&quot;, &quot;DJI&quot;, &quot;DNK&quot;, &quot;DMA&quot;, &quot;DOM&quot;, &nbsp;</div></li><li><div>      &quot;DZA&quot;, &quot;ECU&quot;, &quot;EST&quot;, &quot;EGY&quot;, &quot;ESH&quot;, &quot;ERI&quot;, &quot;ESP&quot;, &quot;ETH&quot;, &quot;FIN&quot;, &quot;FJI&quot;, &nbsp;</div></li><li><div>      &quot;FLK&quot;, &quot;FSM&quot;, &quot;FRO&quot;, &quot;FRA&quot;, &quot;SXM&quot;, &quot;GAB&quot;, &quot;GBR&quot;, &quot;GRD&quot;, &quot;GEO&quot;, &quot;GUF&quot;, &nbsp;</div></li><li><div>      &quot;GHA&quot;, &quot;GIB&quot;, &quot;GRL&quot;, &quot;GMB&quot;, &quot;GIN&quot;, &quot;GLP&quot;, &quot;GNQ&quot;, &quot;GRC&quot;, &quot;SGS&quot;, &quot;GTM&quot;, &nbsp;</div></li><li><div>      &quot;GUM&quot;, &quot;GNB&quot;, &quot;GUY&quot;, &quot;HKG&quot;, &quot;HMD&quot;, &quot;HND&quot;, &quot;HRV&quot;, &quot;HTI&quot;, &quot;HUN&quot;, &quot;IDN&quot;, &nbsp;</div></li><li><div>      &quot;IRL&quot;, &quot;ISR&quot;, &quot;IND&quot;, &quot;IOT&quot;, &quot;IRQ&quot;, &quot;IRN&quot;, &quot;ISL&quot;, &quot;ITA&quot;, &quot;JAM&quot;, &quot;JOR&quot;, &nbsp;</div></li><li><div>      &quot;JPN&quot;, &quot;KEN&quot;, &quot;KGZ&quot;, &quot;KHM&quot;, &quot;KIR&quot;, &quot;COM&quot;, &quot;KNA&quot;, &quot;PRK&quot;, &quot;KOR&quot;, &quot;KWT&quot;, &nbsp;</div></li><li><div>      &quot;CYM&quot;, &quot;KAZ&quot;, &quot;LAO&quot;, &quot;LBN&quot;, &quot;LCA&quot;, &quot;LIE&quot;, &quot;LKA&quot;, &quot;LBR&quot;, &quot;LSO&quot;, &quot;LTU&quot;, &nbsp;</div></li><li><div>      &quot;LUX&quot;, &quot;LVA&quot;, &quot;LBY&quot;, &quot;MAR&quot;, &quot;MCO&quot;, &quot;MDA&quot;, &quot;MDG&quot;, &quot;MHL&quot;, &quot;MKD&quot;, &quot;MLI&quot;, &nbsp;</div></li><li><div>      &quot;MMR&quot;, &quot;MNG&quot;, &quot;MAC&quot;, &quot;MNP&quot;, &quot;MTQ&quot;, &quot;MRT&quot;, &quot;MSR&quot;, &quot;MLT&quot;, &quot;MUS&quot;, &quot;MDV&quot;, &nbsp;</div></li><li><div>      &quot;MWI&quot;, &quot;MEX&quot;, &quot;MYS&quot;, &quot;MOZ&quot;, &quot;NAM&quot;, &quot;NCL&quot;, &quot;NER&quot;, &quot;NFK&quot;, &quot;NGA&quot;, &quot;NIC&quot;, &nbsp;</div></li><li><div>      &quot;NLD&quot;, &quot;NOR&quot;, &quot;NPL&quot;, &quot;NRU&quot;, &quot;NIU&quot;, &quot;NZL&quot;, &quot;OMN&quot;, &quot;PAN&quot;, &quot;PER&quot;, &quot;PYF&quot;, &nbsp;</div></li><li><div>      &quot;PNG&quot;, &quot;PHL&quot;, &quot;PAK&quot;, &quot;POL&quot;, &quot;SPM&quot;, &quot;PCN&quot;, &quot;PRI&quot;, &quot;PSE&quot;, &quot;PRT&quot;, &quot;PLW&quot;, &nbsp;</div></li><li><div>      &quot;PRY&quot;, &quot;QAT&quot;, &quot;REU&quot;, &quot;ROU&quot;, &quot;RUS&quot;, &quot;RWA&quot;, &quot;SAU&quot;, &quot;SLB&quot;, &quot;SYC&quot;, &quot;SDN&quot;, &nbsp;</div></li><li><div>      &quot;SWE&quot;, &quot;SGP&quot;, &quot;SHN&quot;, &quot;SVN&quot;, &quot;SJM&quot;, &quot;SVK&quot;, &quot;SLE&quot;, &quot;SMR&quot;, &quot;SEN&quot;, &quot;SOM&quot;, &nbsp;</div></li><li><div>      &quot;SUR&quot;, &quot;STP&quot;, &quot;SLV&quot;, &quot;SYR&quot;, &quot;SWZ&quot;, &quot;TCA&quot;, &quot;TCD&quot;, &quot;ATF&quot;, &quot;TGO&quot;, &quot;THA&quot;, &nbsp;</div></li><li><div>      &quot;TJK&quot;, &quot;TKL&quot;, &quot;TKM&quot;, &quot;TUN&quot;, &quot;TON&quot;, &quot;TLS&quot;, &quot;TUR&quot;, &quot;TTO&quot;, &quot;TUV&quot;, &quot;TWN&quot;, &nbsp;</div></li><li><div>      &quot;TZA&quot;, &quot;UKR&quot;, &quot;UGA&quot;, &quot;UMI&quot;, &quot;USA&quot;, &quot;URY&quot;, &quot;UZB&quot;, &quot;VAT&quot;, &quot;VCT&quot;, &quot;VEN&quot;, &nbsp;</div></li><li><div>      &quot;VGB&quot;, &quot;VIR&quot;, &quot;VNM&quot;, &quot;VUT&quot;, &quot;WLF&quot;, &quot;WSM&quot;, &quot;YEM&quot;, &quot;MYT&quot;, &quot;SRB&quot;, &quot;ZAF&quot;, &nbsp;</div></li><li><div>      &quot;ZMB&quot;, &quot;MNE&quot;, &quot;ZWE&quot;, &quot;A1&quot;, &quot;A2&quot;, &quot;O1&quot;, &quot;ALA&quot;, &quot;GGY&quot;, &quot;IMN&quot;, &quot;JEY&quot;, &nbsp;</div></li><li><div>      &quot;BLM&quot;, &quot;MAF&quot;, &quot;BES&quot;&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  var $GEOIP_COUNTRY_NAMES = array(&nbsp;</div></li><li><div>      &quot;&quot;, &quot;Asia/Pacific Region&quot;, &quot;Europe&quot;, &quot;Andorra&quot;, &quot;United Arab Emirates&quot;, &quot;Afghanistan&quot;, &quot;Antigua and Barbuda&quot;, &quot;Anguilla&quot;, &quot;Albania&quot;, &quot;Armenia&quot;, &quot;Curcao&quot;, &nbsp;</div></li><li><div>      &quot;Angola&quot;, &quot;Antarctica&quot;, &quot;Argentina&quot;, &quot;American Samoa&quot;, &quot;Austria&quot;, &quot;Australia&quot;, &quot;Aruba&quot;, &quot;Azerbaijan&quot;, &quot;Bosnia and Herzegovina&quot;, &quot;Barbados&quot;, &nbsp;</div></li><li><div>      &quot;Bangladesh&quot;, &quot;Belgium&quot;, &quot;Burkina Faso&quot;, &quot;Bulgaria&quot;, &quot;Bahrain&quot;, &quot;Burundi&quot;, &quot;Benin&quot;, &quot;Bermuda&quot;, &quot;Brunei Darussalam&quot;, &quot;Bolivia&quot;, &nbsp;</div></li><li><div>      &quot;Brazil&quot;, &quot;Bahamas&quot;, &quot;Bhutan&quot;, &quot;Bouvet Island&quot;, &quot;Botswana&quot;, &quot;Belarus&quot;, &quot;Belize&quot;, &quot;Canada&quot;, &quot;Cocos (Keeling) Islands&quot;, &quot;Congo, The Democratic Republic of the&quot;, &nbsp;</div></li><li><div>      &quot;Central African Republic&quot;, &quot;Congo&quot;, &quot;Switzerland&quot;, &quot;Cote D'Ivoire&quot;, &quot;Cook Islands&quot;, &quot;Chile&quot;, &quot;Cameroon&quot;, &quot;China&quot;, &quot;Colombia&quot;, &quot;Costa Rica&quot;, &nbsp;</div></li><li><div>      &quot;Cuba&quot;, &quot;Cape Verde&quot;, &quot;Christmas Island&quot;, &quot;Cyprus&quot;, &quot;Czech Republic&quot;, &quot;Germany&quot;, &quot;Djibouti&quot;, &quot;Denmark&quot;, &quot;Dominica&quot;, &quot;Dominican Republic&quot;, &nbsp;</div></li><li><div>      &quot;Algeria&quot;, &quot;Ecuador&quot;, &quot;Estonia&quot;, &quot;Egypt&quot;, &quot;Western Sahara&quot;, &quot;Eritrea&quot;, &quot;Spain&quot;, &quot;Ethiopia&quot;, &quot;Finland&quot;, &quot;Fiji&quot;, &nbsp;</div></li><li><div>      &quot;Falkland Islands (Malvinas)&quot;, &quot;Micronesia, Federated States of&quot;, &quot;Faroe Islands&quot;, &quot;France&quot;, &quot;Sint Maarten (Dutch part)&quot;, &quot;Gabon&quot;, &quot;United Kingdom&quot;, &quot;Grenada&quot;, &quot;Georgia&quot;, &quot;French Guiana&quot;, &nbsp;</div></li><li><div>      &quot;Ghana&quot;, &quot;Gibraltar&quot;, &quot;Greenland&quot;, &quot;Gambia&quot;, &quot;Guinea&quot;, &quot;Guadeloupe&quot;, &quot;Equatorial Guinea&quot;, &quot;Greece&quot;, &quot;South Georgia and the South Sandwich Islands&quot;, &quot;Guatemala&quot;, &nbsp;</div></li><li><div>      &quot;Guam&quot;, &quot;Guinea-Bissau&quot;, &quot;Guyana&quot;, &quot;Hong Kong&quot;, &quot;Heard Island and McDonald Islands&quot;, &quot;Honduras&quot;, &quot;Croatia&quot;, &quot;Haiti&quot;, &quot;Hungary&quot;, &quot;Indonesia&quot;, &nbsp;</div></li><li><div>      &quot;Ireland&quot;, &quot;Israel&quot;, &quot;India&quot;, &quot;British Indian Ocean Territory&quot;, &quot;Iraq&quot;, &quot;Iran, Islamic Republic of&quot;, &quot;Iceland&quot;, &quot;Italy&quot;, &quot;Jamaica&quot;, &quot;Jordan&quot;, &nbsp;</div></li><li><div>      &quot;Japan&quot;, &quot;Kenya&quot;, &quot;Kyrgyzstan&quot;, &quot;Cambodia&quot;, &quot;Kiribati&quot;, &quot;Comoros&quot;, &quot;Saint Kitts and Nevis&quot;, &quot;Korea, Democratic People's Republic of&quot;, &quot;Korea, Republic of&quot;, &quot;Kuwait&quot;, &nbsp;</div></li><li><div>      &quot;Cayman Islands&quot;, &quot;Kazakhstan&quot;, &quot;Lao People's Democratic Republic&quot;, &quot;Lebanon&quot;, &quot;Saint Lucia&quot;, &quot;Liechtenstein&quot;, &quot;Sri Lanka&quot;, &quot;Liberia&quot;, &quot;Lesotho&quot;, &quot;Lithuania&quot;, &nbsp;</div></li><li><div>      &quot;Luxembourg&quot;, &quot;Latvia&quot;, &quot;Libya&quot;, &quot;Morocco&quot;, &quot;Monaco&quot;, &quot;Moldova, Republic of&quot;, &quot;Madagascar&quot;, &quot;Marshall Islands&quot;, &quot;Macedonia&quot;, &quot;Mali&quot;, &nbsp;</div></li><li><div>      &quot;Myanmar&quot;, &quot;Mongolia&quot;, &quot;Macau&quot;, &quot;Northern Mariana Islands&quot;, &quot;Martinique&quot;, &quot;Mauritania&quot;, &quot;Montserrat&quot;, &quot;Malta&quot;, &quot;Mauritius&quot;, &quot;Maldives&quot;, &nbsp;</div></li><li><div>      &quot;Malawi&quot;, &quot;Mexico&quot;, &quot;Malaysia&quot;, &quot;Mozambique&quot;, &quot;Namibia&quot;, &quot;New Caledonia&quot;, &quot;Niger&quot;, &quot;Norfolk Island&quot;, &quot;Nigeria&quot;, &quot;Nicaragua&quot;, &nbsp;</div></li><li><div>      &quot;Netherlands&quot;, &quot;Norway&quot;, &quot;Nepal&quot;, &quot;Nauru&quot;, &quot;Niue&quot;, &quot;New Zealand&quot;, &quot;Oman&quot;, &quot;Panama&quot;, &quot;Peru&quot;, &quot;French Polynesia&quot;, &nbsp;</div></li><li><div>      &quot;Papua New Guinea&quot;, &quot;Philippines&quot;, &quot;Pakistan&quot;, &quot;Poland&quot;, &quot;Saint Pierre and Miquelon&quot;, &quot;Pitcairn Islands&quot;, &quot;Puerto Rico&quot;, &quot;Palestinian Territory&quot;, &quot;Portugal&quot;, &quot;Palau&quot;, &nbsp;</div></li><li><div>      &quot;Paraguay&quot;, &quot;Qatar&quot;, &quot;Reunion&quot;, &quot;Romania&quot;, &quot;Russian Federation&quot;, &quot;Rwanda&quot;, &quot;Saudi Arabia&quot;, &quot;Solomon Islands&quot;, &quot;Seychelles&quot;, &quot;Sudan&quot;, &nbsp;</div></li><li><div>      &quot;Sweden&quot;, &quot;Singapore&quot;, &quot;Saint Helena&quot;, &quot;Slovenia&quot;, &quot;Svalbard and Jan Mayen&quot;, &quot;Slovakia&quot;, &quot;Sierra Leone&quot;, &quot;San Marino&quot;, &quot;Senegal&quot;, &quot;Somalia&quot;, &quot;Suriname&quot;, &nbsp;</div></li><li><div>      &quot;Sao Tome and Principe&quot;, &quot;El Salvador&quot;, &quot;Syrian Arab Republic&quot;, &quot;Swaziland&quot;, &quot;Turks and Caicos Islands&quot;, &quot;Chad&quot;, &quot;French Southern Territories&quot;, &quot;Togo&quot;, &quot;Thailand&quot;, &nbsp;</div></li><li><div>      &quot;Tajikistan&quot;, &quot;Tokelau&quot;, &quot;Turkmenistan&quot;, &quot;Tunisia&quot;, &quot;Tonga&quot;, &quot;Timor-Leste&quot;, &quot;Turkey&quot;, &quot;Trinidad and Tobago&quot;, &quot;Tuvalu&quot;, &quot;Taiwan&quot;, &nbsp;</div></li><li><div>      &quot;Tanzania, United Republic of&quot;, &quot;Ukraine&quot;, &quot;Uganda&quot;, &quot;United States Minor Outlying Islands&quot;, &quot;United States&quot;, &quot;Uruguay&quot;, &quot;Uzbekistan&quot;, &quot;Holy See (Vatican City State)&quot;, &quot;Saint Vincent and the Grenadines&quot;, &quot;Venezuela&quot;, &nbsp;</div></li><li><div>      &quot;Virgin Islands, British&quot;, &quot;Virgin Islands, U.S.&quot;, &quot;Vietnam&quot;, &quot;Vanuatu&quot;, &quot;Wallis and Futuna&quot;, &quot;Samoa&quot;, &quot;Yemen&quot;, &quot;Mayotte&quot;, &quot;Serbia&quot;, &quot;South Africa&quot;, &nbsp;</div></li><li><div>      &quot;Zambia&quot;, &quot;Montenegro&quot;, &quot;Zimbabwe&quot;, &quot;Anonymous Proxy&quot;, &quot;Satellite Provider&quot;, &quot;Other&quot;, &quot;Aland Islands&quot;, &quot;Guernsey&quot;, &quot;Isle of Man&quot;, &quot;Jersey&quot;, &nbsp;</div></li><li><div>      &quot;Saint Barthelemy&quot;, &quot;Saint Martin&quot;, &quot;Bonaire, Saint Eustatius and Saba&quot;&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  var $GEOIP_CONTINENT_CODES = array(&nbsp;</div></li><li><div>      &quot;--&quot;, &quot;AS&quot;, &quot;EU&quot;, &quot;EU&quot;, &quot;AS&quot;, &quot;AS&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;EU&quot;, &quot;AS&quot;, &quot;NA&quot;, &nbsp;</div></li><li><div>      &quot;AF&quot;, &quot;AN&quot;, &quot;SA&quot;, &quot;OC&quot;, &quot;EU&quot;, &quot;OC&quot;, &quot;NA&quot;, &quot;AS&quot;, &quot;EU&quot;, &quot;NA&quot;, &nbsp;</div></li><li><div>      &quot;AS&quot;, &quot;EU&quot;, &quot;AF&quot;, &quot;EU&quot;, &quot;AS&quot;, &quot;AF&quot;, &quot;AF&quot;, &quot;NA&quot;, &quot;AS&quot;, &quot;SA&quot;, &nbsp;</div></li><li><div>      &quot;SA&quot;, &quot;NA&quot;, &quot;AS&quot;, &quot;AN&quot;, &quot;AF&quot;, &quot;EU&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;AS&quot;, &quot;AF&quot;, &nbsp;</div></li><li><div>      &quot;AF&quot;, &quot;AF&quot;, &quot;EU&quot;, &quot;AF&quot;, &quot;OC&quot;, &quot;SA&quot;, &quot;AF&quot;, &quot;AS&quot;, &quot;SA&quot;, &quot;NA&quot;, &nbsp;</div></li><li><div>      &quot;NA&quot;, &quot;AF&quot;, &quot;AS&quot;, &quot;AS&quot;, &quot;EU&quot;, &quot;EU&quot;, &quot;AF&quot;, &quot;EU&quot;, &quot;NA&quot;, &quot;NA&quot;, &nbsp;</div></li><li><div>      &quot;AF&quot;, &quot;SA&quot;, &quot;EU&quot;, &quot;AF&quot;, &quot;AF&quot;, &quot;AF&quot;, &quot;EU&quot;, &quot;AF&quot;, &quot;EU&quot;, &quot;OC&quot;, &nbsp;</div></li><li><div>      &quot;SA&quot;, &quot;OC&quot;, &quot;EU&quot;, &quot;EU&quot;, &quot;NA&quot;, &quot;AF&quot;, &quot;EU&quot;, &quot;NA&quot;, &quot;AS&quot;, &quot;SA&quot;, &nbsp;</div></li><li><div>      &quot;AF&quot;, &quot;EU&quot;, &quot;NA&quot;, &quot;AF&quot;, &quot;AF&quot;, &quot;NA&quot;, &quot;AF&quot;, &quot;EU&quot;, &quot;AN&quot;, &quot;NA&quot;, &nbsp;</div></li><li><div>      &quot;OC&quot;, &quot;AF&quot;, &quot;SA&quot;, &quot;AS&quot;, &quot;AN&quot;, &quot;NA&quot;, &quot;EU&quot;, &quot;NA&quot;, &quot;EU&quot;, &quot;AS&quot;, &nbsp;</div></li><li><div>      &quot;EU&quot;, &quot;AS&quot;, &quot;AS&quot;, &quot;AS&quot;, &quot;AS&quot;, &quot;AS&quot;, &quot;EU&quot;, &quot;EU&quot;, &quot;NA&quot;, &quot;AS&quot;, &nbsp;</div></li><li><div>      &quot;AS&quot;, &quot;AF&quot;, &quot;AS&quot;, &quot;AS&quot;, &quot;OC&quot;, &quot;AF&quot;, &quot;NA&quot;, &quot;AS&quot;, &quot;AS&quot;, &quot;AS&quot;, &nbsp;</div></li><li><div>      &quot;NA&quot;, &quot;AS&quot;, &quot;AS&quot;, &quot;AS&quot;, &quot;NA&quot;, &quot;EU&quot;, &quot;AS&quot;, &quot;AF&quot;, &quot;AF&quot;, &quot;EU&quot;, &nbsp;</div></li><li><div>      &quot;EU&quot;, &quot;EU&quot;, &quot;AF&quot;, &quot;AF&quot;, &quot;EU&quot;, &quot;EU&quot;, &quot;AF&quot;, &quot;OC&quot;, &quot;EU&quot;, &quot;AF&quot;, &nbsp;</div></li><li><div>      &quot;AS&quot;, &quot;AS&quot;, &quot;AS&quot;, &quot;OC&quot;, &quot;NA&quot;, &quot;AF&quot;, &quot;NA&quot;, &quot;EU&quot;, &quot;AF&quot;, &quot;AS&quot;, &nbsp;</div></li><li><div>      &quot;AF&quot;, &quot;NA&quot;, &quot;AS&quot;, &quot;AF&quot;, &quot;AF&quot;, &quot;OC&quot;, &quot;AF&quot;, &quot;OC&quot;, &quot;AF&quot;, &quot;NA&quot;, &nbsp;</div></li><li><div>      &quot;EU&quot;, &quot;EU&quot;, &quot;AS&quot;, &quot;OC&quot;, &quot;OC&quot;, &quot;OC&quot;, &quot;AS&quot;, &quot;NA&quot;, &quot;SA&quot;, &quot;OC&quot;, &nbsp;</div></li><li><div>      &quot;OC&quot;, &quot;AS&quot;, &quot;AS&quot;, &quot;EU&quot;, &quot;NA&quot;, &quot;OC&quot;, &quot;NA&quot;, &quot;AS&quot;, &quot;EU&quot;, &quot;OC&quot;, &nbsp;</div></li><li><div>      &quot;SA&quot;, &quot;AS&quot;, &quot;AF&quot;, &quot;EU&quot;, &quot;EU&quot;, &quot;AF&quot;, &quot;AS&quot;, &quot;OC&quot;, &quot;AF&quot;, &quot;AF&quot;, &nbsp;</div></li><li><div>      &quot;EU&quot;, &quot;AS&quot;, &quot;AF&quot;, &quot;EU&quot;, &quot;EU&quot;, &quot;EU&quot;, &quot;AF&quot;, &quot;EU&quot;, &quot;AF&quot;, &quot;AF&quot;, &nbsp;</div></li><li><div>      &quot;SA&quot;, &quot;AF&quot;, &quot;NA&quot;, &quot;AS&quot;, &quot;AF&quot;, &quot;NA&quot;, &quot;AF&quot;, &quot;AN&quot;, &quot;AF&quot;, &quot;AS&quot;, &nbsp;</div></li><li><div>      &quot;AS&quot;, &quot;OC&quot;, &quot;AS&quot;, &quot;AF&quot;, &quot;OC&quot;, &quot;AS&quot;, &quot;EU&quot;, &quot;NA&quot;, &quot;OC&quot;, &quot;AS&quot;, &nbsp;</div></li><li><div>      &quot;AF&quot;, &quot;EU&quot;, &quot;AF&quot;, &quot;OC&quot;, &quot;NA&quot;, &quot;SA&quot;, &quot;AS&quot;, &quot;EU&quot;, &quot;NA&quot;, &quot;SA&quot;, &nbsp;</div></li><li><div>      &quot;NA&quot;, &quot;NA&quot;, &quot;AS&quot;, &quot;OC&quot;, &quot;OC&quot;, &quot;OC&quot;, &quot;AS&quot;, &quot;AF&quot;, &quot;EU&quot;, &quot;AF&quot;, &nbsp;</div></li><li><div>      &quot;AF&quot;, &quot;EU&quot;, &quot;AF&quot;, &quot;--&quot;, &quot;--&quot;, &quot;--&quot;, &quot;EU&quot;, &quot;EU&quot;, &quot;EU&quot;, &quot;EU&quot;, &nbsp;</div></li><li><div>      &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_load_shared_mem ($file) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $fp = fopen($file, &quot;rb&quot;);&nbsp;</div></li><li><div>  if (!$fp) {&nbsp;</div></li><li><div>      print &quot;error opening $file: $php_errormsg\n&quot;;&nbsp;</div></li><li><div>      exit;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  $s_array = fstat($fp);&nbsp;</div></li><li><div>  $size = $s_array['size'];&nbsp;</div></li><li><div>  if ($shmid = @shmop_open (GEOIP_SHM_KEY, &quot;w&quot;, 0, 0)) {&nbsp;</div></li><li><div>      shmop_delete ($shmid);&nbsp;</div></li><li><div>      shmop_close ($shmid);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  $shmid = shmop_open (GEOIP_SHM_KEY, &quot;c&quot;, 0644, $size);&nbsp;</div></li><li><div>  shmop_write ($shmid, fread($fp, $size), 0);&nbsp;</div></li><li><div>  shmop_close ($shmid);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function _setup_segments($gi) {&nbsp;</div></li><li><div>  $gi-&gt;databaseType = GEOIP_COUNTRY_EDITION;&nbsp;</div></li><li><div>  $gi-&gt;record_length = STANDARD_RECORD_LENGTH;&nbsp;</div></li><li><div>  if ($gi-&gt;flags & GEOIP_SHARED_MEMORY) {&nbsp;</div></li><li><div>      $offset = @shmop_size ($gi-&gt;shmid) - 3;&nbsp;</div></li><li><div>      for ($i = 0; $i &lt; STRUCTURE_INFO_MAX_SIZE; $i++) {&nbsp;</div></li><li><div>              $delim = @shmop_read ($gi-&gt;shmid, $offset, 3);&nbsp;</div></li><li><div>              $offset += 3;&nbsp;</div></li><li><div>              if ($delim == (chr(255).chr(255).chr(255))) {&nbsp;</div></li><li><div>                      $gi-&gt;databaseType = ord(@shmop_read ($gi-&gt;shmid, $offset, 1));&nbsp;</div></li><li><div>                      $offset++;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ($gi-&gt;databaseType == GEOIP_REGION_EDITION_REV0) {&nbsp;</div></li><li><div>                              $gi-&gt;databaseSegments = GEOIP_STATE_BEGIN_REV0;&nbsp;</div></li><li><div>                      } else if ($gi-&gt;databaseType == GEOIP_REGION_EDITION_REV1) {&nbsp;</div></li><li><div>                              $gi-&gt;databaseSegments = GEOIP_STATE_BEGIN_REV1;&nbsp;</div></li><li><div>          } else if (($gi-&gt;databaseType == GEOIP_CITY_EDITION_REV0)||&nbsp;</div></li><li><div>                                       ($gi-&gt;databaseType == GEOIP_CITY_EDITION_REV1) &nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_ORG_EDITION)&nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_ORG_EDITION_V6)&nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_DOMAIN_EDITION)&nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_DOMAIN_EDITION_V6)&nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_ISP_EDITION)&nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_ISP_EDITION_V6)&nbsp;</div></li><li><div>                          || ($gi-&gt;databaseType == GEOIP_USERTYPE_EDITION)&nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_USERTYPE_EDITION_V6)&nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_LOCATIONA_EDITION)&nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_ACCURACYRADIUS_EDITION)&nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_CITY_EDITION_REV0_V6)&nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_CITY_EDITION_REV1_V6)&nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_NETSPEED_EDITION_REV1)                    &nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_NETSPEED_EDITION_REV1_V6)                    &nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_ASNUM_EDITION)&nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_ASNUM_EDITION_V6)) {&nbsp;</div></li><li><div>                              $gi-&gt;databaseSegments = 0;&nbsp;</div></li><li><div>                              $buf = @shmop_read ($gi-&gt;shmid, $offset, SEGMENT_RECORD_LENGTH);&nbsp;</div></li><li><div>                              for ($j = 0;$j &lt; SEGMENT_RECORD_LENGTH;$j++) {&nbsp;</div></li><li><div>                                      $gi-&gt;databaseSegments += (ord($buf[$j]) &lt;&lt; ($j * 8));&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          if (($gi-&gt;databaseType == GEOIP_ORG_EDITION)&nbsp;</div></li><li><div>                                  || ($gi-&gt;databaseType == GEOIP_ORG_EDITION_V6)&nbsp;</div></li><li><div>                                              || ($gi-&gt;databaseType == GEOIP_DOMAIN_EDITION)&nbsp;</div></li><li><div>                                              || ($gi-&gt;databaseType == GEOIP_DOMAIN_EDITION_V6)&nbsp;</div></li><li><div>          || ($gi-&gt;databaseType == GEOIP_ISP_EDITION)&nbsp;</div></li><li><div>          || ($gi-&gt;databaseType == GEOIP_ISP_EDITION_V6)) {&nbsp;</div></li><li><div>                                  $gi-&gt;record_length = ORG_RECORD_LENGTH;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                      $offset -= 4;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if (($gi-&gt;databaseType == GEOIP_COUNTRY_EDITION)||&nbsp;</div></li><li><div>              ($gi-&gt;databaseType == GEOIP_COUNTRY_EDITION_V6)||&nbsp;</div></li><li><div>              ($gi-&gt;databaseType == GEOIP_PROXY_EDITION)||&nbsp;</div></li><li><div>              ($gi-&gt;databaseType == GEOIP_NETSPEED_EDITION)) {&nbsp;</div></li><li><div>              $gi-&gt;databaseSegments = GEOIP_COUNTRY_BEGIN;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $filepos = ftell($gi-&gt;filehandle);&nbsp;</div></li><li><div>      fseek($gi-&gt;filehandle, -3, SEEK_END);&nbsp;</div></li><li><div>      for ($i = 0; $i &lt; STRUCTURE_INFO_MAX_SIZE; $i++) {&nbsp;</div></li><li><div>              $delim = fread($gi-&gt;filehandle, 3);&nbsp;</div></li><li><div>              if ($delim == (chr(255).chr(255).chr(255))) {&nbsp;</div></li><li><div>              $gi-&gt;databaseType = ord(fread($gi-&gt;filehandle, 1));&nbsp;</div></li><li><div>              if ($gi-&gt;databaseType == GEOIP_REGION_EDITION_REV0) {&nbsp;</div></li><li><div>                      $gi-&gt;databaseSegments = GEOIP_STATE_BEGIN_REV0;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              else if ($gi-&gt;databaseType == GEOIP_REGION_EDITION_REV1) {&nbsp;</div></li><li><div>          $gi-&gt;databaseSegments = GEOIP_STATE_BEGIN_REV1;&nbsp;</div></li><li><div>                              }  else if (($gi-&gt;databaseType == GEOIP_CITY_EDITION_REV0)&nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_CITY_EDITION_REV1)&nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_CITY_EDITION_REV0_V6)&nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_CITY_EDITION_REV1_V6)&nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_ORG_EDITION) &nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_DOMAIN_EDITION)&nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_ISP_EDITION)&nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_ORG_EDITION_V6) &nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_DOMAIN_EDITION_V6)&nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_ISP_EDITION_V6)&nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_LOCATIONA_EDITION)&nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_ACCURACYRADIUS_EDITION)&nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_CITY_EDITION_REV0_V6)&nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_CITY_EDITION_REV1_V6)&nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_NETSPEED_EDITION_REV1)                    &nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_NETSPEED_EDITION_REV1_V6)                    &nbsp;</div></li><li><div>                      || ($gi-&gt;databaseType == GEOIP_USERTYPE_EDITION)&nbsp;</div></li><li><div>              || ($gi-&gt;databaseType == GEOIP_USERTYPE_EDITION_V6) &nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_ASNUM_EDITION)&nbsp;</div></li><li><div>                                      || ($gi-&gt;databaseType == GEOIP_ASNUM_EDITION_V6)) {&nbsp;</div></li><li><div>                      $gi-&gt;databaseSegments = 0;&nbsp;</div></li><li><div>                      $buf = fread($gi-&gt;filehandle, SEGMENT_RECORD_LENGTH);&nbsp;</div></li><li><div>                      for ($j = 0;$j &lt; SEGMENT_RECORD_LENGTH;$j++) {&nbsp;</div></li><li><div>                      $gi-&gt;databaseSegments += (ord($buf[$j]) &lt;&lt; ($j * 8));&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>          if (   ( $gi-&gt;databaseType == GEOIP_ORG_EDITION )&nbsp;</div></li><li><div>                              || ( $gi-&gt;databaseType == GEOIP_DOMAIN_EDITION )&nbsp;</div></li><li><div>                              || ( $gi-&gt;databaseType == GEOIP_ISP_EDITION ) &nbsp;</div></li><li><div>                              || ( $gi-&gt;databaseType == GEOIP_ORG_EDITION_V6 )&nbsp;</div></li><li><div>                              || ( $gi-&gt;databaseType == GEOIP_DOMAIN_EDITION_V6 )&nbsp;</div></li><li><div>                              || ( $gi-&gt;databaseType == GEOIP_ISP_EDITION_V6 )) {&nbsp;</div></li><li><div>          $gi-&gt;record_length = ORG_RECORD_LENGTH;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>              fseek($gi-&gt;filehandle, -4, SEEK_CUR);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if (($gi-&gt;databaseType == GEOIP_COUNTRY_EDITION)||&nbsp;</div></li><li><div>              ($gi-&gt;databaseType == GEOIP_COUNTRY_EDITION_V6)||&nbsp;</div></li><li><div>              ($gi-&gt;databaseType == GEOIP_PROXY_EDITION)||&nbsp;</div></li><li><div>              ($gi-&gt;databaseType == GEOIP_NETSPEED_EDITION)) {&nbsp;</div></li><li><div>               $gi-&gt;databaseSegments = GEOIP_COUNTRY_BEGIN;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      fseek($gi-&gt;filehandle, $filepos, SEEK_SET);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return $gi;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_open($filename, $flags) {&nbsp;</div></li><li><div>  $gi = new GeoIP;&nbsp;</div></li><li><div>  $gi-&gt;flags = $flags;&nbsp;</div></li><li><div>  if ($gi-&gt;flags & GEOIP_SHARED_MEMORY) {&nbsp;</div></li><li><div>      $gi-&gt;shmid = @shmop_open (GEOIP_SHM_KEY, &quot;a&quot;, 0, 0);&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>      $gi-&gt;filehandle = fopen($filename, &quot;rb&quot;) or die( &quot;Can not open $filename\n&quot; );&nbsp;</div></li><li><div>      if ($gi-&gt;flags & GEOIP_MEMORY_CACHE) {&nbsp;</div></li><li><div>              $s_array = fstat($gi-&gt;filehandle);&nbsp;</div></li><li><div>              $gi-&gt;memory_buffer = fread($gi-&gt;filehandle, $s_array['size']);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $gi = _setup_segments($gi);&nbsp;</div></li><li><div>  return $gi;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_close($gi) {&nbsp;</div></li><li><div>  if ($gi-&gt;flags & GEOIP_SHARED_MEMORY) {&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return fclose($gi-&gt;filehandle);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_country_id_by_name_v6($gi, $name) {&nbsp;</div></li><li><div>  $rec = dns_get_record($name, DNS_AAAA);&nbsp;</div></li><li><div>  if ( !$rec ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  $addr = $rec[0][&quot;ipv6&quot;];&nbsp;</div></li><li><div>  if (!$addr || $addr == $name) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return geoip_country_id_by_addr_v6($gi, $addr);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_country_id_by_name($gi, $name) {&nbsp;</div></li><li><div>  $addr = gethostbyname($name);&nbsp;</div></li><li><div>  if (!$addr || $addr == $name) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return geoip_country_id_by_addr($gi, $addr);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_country_code_by_name_v6($gi, $name) {&nbsp;</div></li><li><div>  $country_id = geoip_country_id_by_name_v6($gi, $name);&nbsp;</div></li><li><div>  if ($country_id !== false) {&nbsp;</div></li><li><div>              return $gi-&gt;GEOIP_COUNTRY_CODES[$country_id];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_country_code_by_name($gi, $name) {&nbsp;</div></li><li><div>  $country_id = geoip_country_id_by_name($gi, $name);&nbsp;</div></li><li><div>  if ($country_id !== false) {&nbsp;</div></li><li><div>              return $gi-&gt;GEOIP_COUNTRY_CODES[$country_id];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_country_name_by_name_v6($gi, $name) {&nbsp;</div></li><li><div>  $country_id = geoip_country_id_by_name_v6($gi, $name);&nbsp;</div></li><li><div>  if ($country_id !== false) {&nbsp;</div></li><li><div>              return $gi-&gt;GEOIP_COUNTRY_NAMES[$country_id];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_country_name_by_code($gi, $code) {&nbsp;</div></li><li><div>      $id = isset($gi-&gt;GEOIP_COUNTRY_CODE_TO_NUMBER[$code])?$gi-&gt;GEOIP_COUNTRY_CODE_TO_NUMBER[$code]:-1;&nbsp;</div></li><li><div>      if($id&gt;-1) {&nbsp;</div></li><li><div>              return isset($gi-&gt;GEOIP_COUNTRY_NAMES[$id])?$gi-&gt;GEOIP_COUNTRY_NAMES[$id]:'unknown';&nbsp;</div></li><li><div>      }else{&nbsp;</div></li><li><div>              return &quot;unknown&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_country_name_by_name($gi, $name) {&nbsp;</div></li><li><div>  $country_id = geoip_country_id_by_name($gi, $name);&nbsp;</div></li><li><div>  if ($country_id !== false) {&nbsp;</div></li><li><div>              return $gi-&gt;GEOIP_COUNTRY_NAMES[$country_id];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_country_id_by_addr_v6($gi, $addr) {&nbsp;</div></li><li><div>  $ipnum = inet_pton($addr);&nbsp;</div></li><li><div>  return _geoip_seek_country_v6($gi, $ipnum) - GEOIP_COUNTRY_BEGIN;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_country_id_by_addr($gi, $addr) {&nbsp;</div></li><li><div>  $ipnum = ip2long($addr);&nbsp;</div></li><li><div>  return _geoip_seek_country($gi, $ipnum) - GEOIP_COUNTRY_BEGIN;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_country_code_by_addr_v6($gi, $addr) {&nbsp;</div></li><li><div>      $country_id = geoip_country_id_by_addr_v6($gi, $addr);&nbsp;</div></li><li><div>      if ($country_id !== false) {&nbsp;</div></li><li><div>          return $gi-&gt;GEOIP_COUNTRY_CODES[$country_id];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_country_code_by_addr($gi, $addr) {&nbsp;</div></li><li><div>  if ($gi-&gt;databaseType == GEOIP_CITY_EDITION_REV1) {&nbsp;</div></li><li><div>      $record = geoip_record_by_addr($gi, $addr);&nbsp;</div></li><li><div>      if ( $record !== false ) {&nbsp;</div></li><li><div>          return $record-&gt;country_code;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $country_id = geoip_country_id_by_addr($gi, $addr);&nbsp;</div></li><li><div>      if ($country_id !== false) {&nbsp;</div></li><li><div>          return $gi-&gt;GEOIP_COUNTRY_CODES[$country_id];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_country_name_by_addr_v6($gi, $addr) {&nbsp;</div></li><li><div>      $country_id = geoip_country_id_by_addr_v6($gi, $addr);&nbsp;</div></li><li><div>      if ($country_id !== false) {&nbsp;</div></li><li><div>          return $gi-&gt;GEOIP_COUNTRY_NAMES[$country_id];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_country_name_by_addr($gi, $addr) {&nbsp;</div></li><li><div>  if ($gi-&gt;databaseType == GEOIP_CITY_EDITION_REV1) {&nbsp;</div></li><li><div>      $record = geoip_record_by_addr($gi, $addr);&nbsp;</div></li><li><div>      return $record-&gt;country_name;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $country_id = geoip_country_id_by_addr($gi, $addr);&nbsp;</div></li><li><div>      if ($country_id !== false) {&nbsp;</div></li><li><div>          return $gi-&gt;GEOIP_COUNTRY_NAMES[$country_id];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function _geoip_seek_country_v6($gi, $ipnum) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  # arrays from unpack start with offset 1&nbsp;</div></li><li><div>  # yet another php mystery. array_merge work around &nbsp;</div></li><li><div>  # this broken behaviour&nbsp;</div></li><li><div>  $v6vec = array_merge(unpack( &quot;C16&quot;, $ipnum));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $offset = 0;&nbsp;</div></li><li><div>  for ($depth = 127; $depth &gt;= 0; --$depth) {&nbsp;</div></li><li><div>      if ($gi-&gt;flags & GEOIP_MEMORY_CACHE) {&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment">// workaround php's broken substr, strpos, etc handling with</span></span></span>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment">// mbstring.func_overload and mbstring.internal_encoding</span></span></span>&nbsp;</div></li><li><div>          $enc = mb_internal_encoding();&nbsp;</div></li><li><div>           mb_internal_encoding('ISO-8859-1'); &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $buf = substr($gi-&gt;memory_buffer, &nbsp;</div></li><li><div>                                                      2 * $gi-&gt;record_length * $offset, &nbsp;</div></li><li><div>                                                      2 * $gi-&gt;record_length);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          mb_internal_encoding($enc);&nbsp;</div></li><li><div>      } elseif ($gi-&gt;flags & GEOIP_SHARED_MEMORY) {&nbsp;</div></li><li><div>          $buf = @shmop_read ($gi-&gt;shmid, &nbsp;</div></li><li><div>                                                      2 * $gi-&gt;record_length * $offset, &nbsp;</div></li><li><div>                                                      2 * $gi-&gt;record_length );&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>          fseek($gi-&gt;filehandle, 2 * $gi-&gt;record_length * $offset, SEEK_SET) == 0&nbsp;</div></li><li><div>              or die(&quot;fseek failed&quot;);&nbsp;</div></li><li><div>          $buf = fread($gi-&gt;filehandle, 2 * $gi-&gt;record_length);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $x = array(0, 0);&nbsp;</div></li><li><div>      for ($i = 0; $i &lt; 2; ++$i) {&nbsp;</div></li><li><div>          for ($j = 0; $j &lt; $gi-&gt;record_length; ++$j) {&nbsp;</div></li><li><div>              $x[$i] += ord($buf[$gi-&gt;record_length * $i + $j]) &lt;&lt; ($j * 8);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $bnum = 127 - $depth;&nbsp;</div></li><li><div>      $idx = $bnum &gt;&gt; 3;&nbsp;</div></li><li><div>      $b_mask = 1 &lt;&lt; ( $bnum & 7 ^ 7 );&nbsp;</div></li><li><div>      if (($v6vec[$idx] & $b_mask) &gt; 0) {&nbsp;</div></li><li><div>          if ($x[1] &gt;= $gi-&gt;databaseSegments) {&nbsp;</div></li><li><div>              return $x[1];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $offset = $x[1];&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          if ($x[0] &gt;= $gi-&gt;databaseSegments) {&nbsp;</div></li><li><div>              return $x[0];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $offset = $x[0];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  trigger_error(&quot;error traversing database - perhaps it is corrupt?&quot;, E_USER_ERROR);&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function _geoip_seek_country($gi, $ipnum) {&nbsp;</div></li><li><div>  $offset = 0;&nbsp;</div></li><li><div>  for ($depth = 31; $depth &gt;= 0; --$depth) {&nbsp;</div></li><li><div>      if ($gi-&gt;flags & GEOIP_MEMORY_CACHE) {&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment">// workaround php's broken substr, strpos, etc handling with</span></span></span>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment">// mbstring.func_overload and mbstring.internal_encoding</span></span></span>&nbsp;</div></li><li><div>          $enc = mb_internal_encoding();&nbsp;</div></li><li><div>           mb_internal_encoding('ISO-8859-1'); &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $buf = substr($gi-&gt;memory_buffer, &nbsp;</div></li><li><div>                                                      2 * $gi-&gt;record_length * $offset, &nbsp;</div></li><li><div>                                                      2 * $gi-&gt;record_length);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          mb_internal_encoding($enc);&nbsp;</div></li><li><div>      } elseif ($gi-&gt;flags & GEOIP_SHARED_MEMORY) {&nbsp;</div></li><li><div>          $buf = @shmop_read ($gi-&gt;shmid, &nbsp;</div></li><li><div>                                                      2 * $gi-&gt;record_length * $offset, &nbsp;</div></li><li><div>                                                      2 * $gi-&gt;record_length );&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>          fseek($gi-&gt;filehandle, 2 * $gi-&gt;record_length * $offset, SEEK_SET) == 0&nbsp;</div></li><li><div>              or die(&quot;fseek failed&quot;);&nbsp;</div></li><li><div>          $buf = fread($gi-&gt;filehandle, 2 * $gi-&gt;record_length);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $x = array(0, 0);&nbsp;</div></li><li><div>      for ($i = 0; $i &lt; 2; ++$i) {&nbsp;</div></li><li><div>          for ($j = 0; $j &lt; $gi-&gt;record_length; ++$j) {&nbsp;</div></li><li><div>              $x[$i] += ord($buf[$gi-&gt;record_length * $i + $j]) &lt;&lt; ($j * 8);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if ($ipnum & (1 &lt;&lt; $depth)) {&nbsp;</div></li><li><div>          if ($x[1] &gt;= $gi-&gt;databaseSegments) {&nbsp;</div></li><li><div>              return $x[1];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $offset = $x[1];&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>          if ($x[0] &gt;= $gi-&gt;databaseSegments) {&nbsp;</div></li><li><div>              return $x[0];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $offset = $x[0];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  trigger_error(&quot;error traversing database - perhaps it is corrupt?&quot;, E_USER_ERROR);&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function _common_get_org($gi, $seek_org) {&nbsp;</div></li><li><div>  $record_pointer = $seek_org + (2 * $gi-&gt;record_length - 1) * $gi-&gt;databaseSegments;&nbsp;</div></li><li><div>  if ($gi-&gt;flags & GEOIP_SHARED_MEMORY) {&nbsp;</div></li><li><div>      $org_buf = @shmop_read ($gi-&gt;shmid, $record_pointer, MAX_ORG_RECORD_LENGTH);&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>      fseek($gi-&gt;filehandle, $record_pointer, SEEK_SET);&nbsp;</div></li><li><div>      $org_buf = fread($gi-&gt;filehandle, MAX_ORG_RECORD_LENGTH);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment">// workaround php's broken substr, strpos, etc handling with</span></span></span>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment">// mbstring.func_overload and mbstring.internal_encoding</span></span></span>&nbsp;</div></li><li><div>  $enc = mb_internal_encoding();&nbsp;</div></li><li><div>  mb_internal_encoding('ISO-8859-1'); &nbsp;</div></li><li><div>  $org_buf = substr($org_buf, 0, strpos($org_buf, &quot;\0&quot;));&nbsp;</div></li><li><div>  mb_internal_encoding($enc);&nbsp;</div></li><li><div>  return $org_buf;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function _get_org_v6($gi, $ipnum) {&nbsp;</div></li><li><div>  $seek_org = _geoip_seek_country_v6($gi, $ipnum);&nbsp;</div></li><li><div>  if ($seek_org == $gi-&gt;databaseSegments) {&nbsp;</div></li><li><div>      return NULL;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return _common_get_org($gi, $seek_org);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function _get_org($gi, $ipnum) {&nbsp;</div></li><li><div>  $seek_org = _geoip_seek_country($gi, $ipnum);&nbsp;</div></li><li><div>  if ($seek_org == $gi-&gt;databaseSegments) {&nbsp;</div></li><li><div>      return NULL;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return _common_get_org($gi, $seek_org);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_name_by_addr_v6 ($gi, $addr) {&nbsp;</div></li><li><div>  if ($addr == NULL) {&nbsp;</div></li><li><div>      return 0;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  $ipnum = inet_pton($addr);&nbsp;</div></li><li><div>  return _get_org_v6($gi, $ipnum);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_name_by_addr ($gi, $addr) {&nbsp;</div></li><li><div>  if ($addr == NULL) {&nbsp;</div></li><li><div>      return 0;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  $ipnum = ip2long($addr);&nbsp;</div></li><li><div>  return _get_org($gi, $ipnum);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_org_by_addr ($gi, $addr) {&nbsp;</div></li><li><div>  return geoip_name_by_addr($gi, $addr);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function _get_region($gi, $ipnum) {&nbsp;</div></li><li><div>  if ($gi-&gt;databaseType == GEOIP_REGION_EDITION_REV0) {&nbsp;</div></li><li><div>      $seek_region = _geoip_seek_country($gi, $ipnum) - GEOIP_STATE_BEGIN_REV0;&nbsp;</div></li><li><div>      if ($seek_region &gt;= 1000) {&nbsp;</div></li><li><div>          $country_code = &quot;US&quot;;&nbsp;</div></li><li><div>          $region = chr(($seek_region - 1000)/26 + 65) . chr(($seek_region - 1000)%26 + 65);&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>                      $country_code = $gi-&gt;GEOIP_COUNTRY_CODES[$seek_region];&nbsp;</div></li><li><div>          $region = &quot;&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  return array ($country_code, $region);&nbsp;</div></li><li><div>      }  else if ($gi-&gt;databaseType == GEOIP_REGION_EDITION_REV1) {&nbsp;</div></li><li><div>      $seek_region = _geoip_seek_country($gi, $ipnum) - GEOIP_STATE_BEGIN_REV1;&nbsp;</div></li><li><div>      <span class="comment">//print $seek_region;</span>&nbsp;</div></li><li><div>      if ($seek_region &lt; US_OFFSET) {&nbsp;</div></li><li><div>          $country_code = &quot;&quot;;&nbsp;</div></li><li><div>          $region = &quot;&quot;;  &nbsp;</div></li><li><div>              } else if ($seek_region &lt; CANADA_OFFSET) {&nbsp;</div></li><li><div>          $country_code = &quot;US&quot;;&nbsp;</div></li><li><div>          $region = chr(($seek_region - US_OFFSET)/26 + 65) . chr(($seek_region - US_OFFSET)%26 + 65);&nbsp;</div></li><li><div>              } else if ($seek_region &lt; WORLD_OFFSET) {&nbsp;</div></li><li><div>          $country_code = &quot;CA&quot;;&nbsp;</div></li><li><div>          $region = chr(($seek_region - CANADA_OFFSET)/26 + 65) . chr(($seek_region - CANADA_OFFSET)%26 + 65);&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>                      $country_code = $gi-&gt;GEOIP_COUNTRY_CODES[($seek_region - WORLD_OFFSET) / FIPS_RANGE];&nbsp;</div></li><li><div>          $region = &quot;&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  return array ($country_code, $region);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function geoip_region_by_addr ($gi, $addr) {&nbsp;</div></li><li><div>  if ($addr == NULL) {&nbsp;</div></li><li><div>      return 0;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  $ipnum = ip2long($addr);&nbsp;</div></li><li><div>  return _get_region($gi, $ipnum);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function getdnsattributes ($l, $ip) {&nbsp;</div></li><li><div>  $r = new Net_DNS_Resolver();&nbsp;</div></li><li><div>  $r-&gt;nameservers = array(&quot;ws1.maxmind.com&quot;);&nbsp;</div></li><li><div>  $p = $r-&gt;search($l.&quot;.&quot; . $ip .&quot;.s.maxmind.com&quot;, &quot;TXT&quot;, &quot;IN&quot;);&nbsp;</div></li><li><div>  $str = is_object($p-&gt;answer[0])?$p-&gt;answer[0]-&gt;string():'';&nbsp;</div></li><li><div>  $str = substr( $str, 1, -1 );&nbsp;</div></li><li><div>  return $str;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>Google Font Fix</li><li><span></span>2.1.1</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>