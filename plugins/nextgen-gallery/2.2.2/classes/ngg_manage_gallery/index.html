<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="2.2.2" data-slug="nextgen-gallery" data-type="class" data-id="65332"><head xmlns="http://www.w3.org/1999/xhtml"><title> nggmanagegallery | class | Nextgen Gallery | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="nggManageGallery, class, plugin, nextgen-gallery, 2.2.2" /><meta name="description" content="The NextGEN Gallery nggManageGallery class." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.25"}};!function(e,n,t){var a;function i(e){var t=n.createElement("canvas"),a=t.getContext&&t.getContext("2d"),i=String.fromCharCode;return!(!a||!a.fillText)&&(a.textBaseline="top",a.font="600 32px Arial","flag"===e?(a.fillText(i(55356,56806,55356,56826),0,0),3e3<t.toDataURL().length):"diversity"===e?(a.fillText(i(55356,57221),0,0),t=a.getImageData(16,16,1,1).data,a.fillText(i(55356,57221,55356,57343),0,0),(t=a.getImageData(16,16,1,1).data)[0],t[1],t[2],t[3],!0):("simple"===e?a.fillText(i(55357,56835),0,0):a.fillText(i(55356,57135),0,0),0!==a.getImageData(16,16,1,1).data[0]))}function o(e){var t=n.createElement("script");t.src=e,t.type="text/javascript",n.getElementsByTagName("head")[0].appendChild(t)}t.supports={simple:i("simple"),flag:i("flag"),unicode8:i("unicode8"),diversity:i("diversity")},t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.simple&&t.supports.flag&&t.supports.unicode8&&t.supports.diversity||(a=function(){t.readyCallback()},n.addEventListener?(n.addEventListener("DOMContentLoaded",a,!1),e.addEventListener("load",a,!1)):(e.attachEvent("onload",a),n.attachEvent("onreadystatechange",function(){"complete"===n.readyState&&t.readyCallback()})),(a=t.source||{}).concatemoji?o(a.concatemoji):a.wpemoji&&a.twemoji&&(o(a.twemoji),o(a.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=9dacf1704b1750a70ff4852c80b5bb3a' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.25' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/ngg_manage_gallery/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fngg_manage_gallery%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fngg_manage_gallery%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-nextgen-gallery-2.2.2-class-ngg_manage_gallery","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="ngg_manage_gallery" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to nextgen-gallery." href="http://hookr.io/plugins/nextgen-gallery/" class="plugin"><span property="name">nextgen-gallery</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.2.2." href="http://hookr.io/plugins/nextgen-gallery/2.2.2/" class="H_VERSION"><span property="name">2.2.2</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/nextgen-gallery/2.2.2/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">ngg_manage_gallery</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="783"><a href="http://hookr.io/plugins/nextgen-gallery/2.2.2/all/" title="All">All <span class="count badge">783</span></a></li><li class="" data-id="new" data-count="2"><a href="http://hookr.io/plugins/nextgen-gallery/2.2.2/new/" title="New">New <span class="count badge">2</span></a></li><li class="" data-id="hooks" data-count="157"><a href="http://hookr.io/plugins/nextgen-gallery/2.2.2/hooks/" title="Hooks">Hooks <span class="count badge">157</span></a></li><li class="" data-id="action" data-count="48"><a href="http://hookr.io/plugins/nextgen-gallery/2.2.2/actions/" title="Actions">Actions <span class="count badge">48</span></a></li><li class="" data-id="filter" data-count="109"><a href="http://hookr.io/plugins/nextgen-gallery/2.2.2/filters/" title="Filters">Filters <span class="count badge">109</span></a></li><li class="active" data-id="class" data-count="374"><a href="http://hookr.io/plugins/nextgen-gallery/2.2.2/classes/" title="Classes">Classes <span class="count badge">374</span></a></li><li class="" data-id="constant" data-count="172"><a href="http://hookr.io/plugins/nextgen-gallery/2.2.2/constants/" title="Constants">Constants <span class="count badge">172</span></a></li><li class="" data-id="function" data-count="79"><a href="http://hookr.io/plugins/nextgen-gallery/2.2.2/functions/" title="Functions">Functions <span class="count badge">79</span></a></li><li class="" data-id="shortcode" data-count="1"><a href="http://hookr.io/plugins/nextgen-gallery/2.2.2/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">1</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>nggManageGallery</strong></h1><p>The NextGEN Gallery <strong>nggManageGallery</strong> class.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/nextgen-gallery/2.2.2/files/products-photocrati-nextgen-modules-ngglegacy-admin-manage/" class="file">/products/photocrati_nextgen/modules/ngglegacy/admin/manage.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="5" class="block" start="5"><li><div>class nggManageGallery {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    var $mode = 'main';&nbsp;</div></li><li><div>    var $gid = false;&nbsp;</div></li><li><div>    var $gallery = NULL;&nbsp;</div></li><li><div>    var $pid = false;&nbsp;</div></li><li><div>    var $base_page = 'admin.php?page=nggallery-manage-gallery';&nbsp;</div></li><li><div>    var $search_result = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // initiate the manage page&nbsp;</div></li><li><div>    function __construct()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        // GET variables&nbsp;</div></li><li><div>        if( isset($_GET['gid']) ) {&nbsp;</div></li><li><div>            $this-&gt;gid = (int) $_GET['gid'];&nbsp;</div></li><li><div>            $this-&gt;gallery = C_Gallery_Mapper::get_instance()-&gt;find($this-&gt;gid);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if( isset($_GET['pid']) )&nbsp;</div></li><li><div>            $this-&gt;pid = (int) $_GET['pid'];&nbsp;</div></li><li><div>        if( isset($_GET['mode']) )&nbsp;</div></li><li><div>            $this-&gt;mode = trim ($_GET['mode']);&nbsp;</div></li><li><div>        // Check for pagination request, avoid post process of other submit button, exclude search results&nbsp;</div></li><li><div>        if ( isset($_POST['post_paged']) && !isset($_GET['s'] ) ) {&nbsp;</div></li><li><div>            if ( $_GET['paged'] != $_POST['post_paged'] ) {&nbsp;</div></li><li><div>                $_GET['paged'] = absint( $_POST['post_paged'] );&nbsp;</div></li><li><div>                return;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // Should be only called via manage galleries overview&nbsp;</div></li><li><div>        if ( isset($_POST['page']) && $_POST['page'] == 'manage-galleries' )&nbsp;</div></li><li><div>            $this-&gt;post_processor_galleries();&nbsp;</div></li><li><div>        // Should be only called via a edit single gallery page&nbsp;</div></li><li><div>        if ( isset($_POST['page']) && $_POST['page'] == 'manage-images' )&nbsp;</div></li><li><div>            $this-&gt;post_processor_images();&nbsp;</div></li><li><div>        // Should be called via a publish dialog&nbsp;</div></li><li><div>        if ( isset($_POST['page']) && $_POST['page'] == 'publish-post' )&nbsp;</div></li><li><div>            $this-&gt;publish_post();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //Look for other POST process&nbsp;</div></li><li><div>        if ( !empty($_POST) || !empty($_GET) )&nbsp;</div></li><li><div>            $this-&gt;processor();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        M_NextGen_Admin::emit_do_notices_action();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function controller() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        switch($this-&gt;mode) {&nbsp;</div></li><li><div>            case 'sort':&nbsp;</div></li><li><div>                include_once (dirname (__FILE__) . '/manage-sort.php');&nbsp;</div></li><li><div>                nggallery_sortorder($this-&gt;gid);&nbsp;</div></li><li><div>            break;&nbsp;</div></li><li><div>            case 'edit':&nbsp;</div></li><li><div>                $this-&gt;setup_gallery_fields();&nbsp;</div></li><li><div>                $this-&gt;setup_image_rows();&nbsp;</div></li><li><div>                include_once (dirname (__FILE__) . '/manage-images.php');&nbsp;</div></li><li><div>                nggallery_picturelist($this);&nbsp;</div></li><li><div>            break;&nbsp;</div></li><li><div>            case 'main':&nbsp;</div></li><li><div>            default:&nbsp;</div></li><li><div>                include_once (dirname (__FILE__) . '/manage-galleries.php');&nbsp;</div></li><li><div>                nggallery_manage_gallery_main();&nbsp;</div></li><li><div>            break;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function processor() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        global $wpdb, $ngg, $nggdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Delete a picture&nbsp;</div></li><li><div>        if ($this-&gt;mode == 'delpic') {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            //TODO:Remove also Tag reference&nbsp;</div></li><li><div>            check_admin_referer('ngg_delpicture');&nbsp;</div></li><li><div>            $image = $nggdb-&gt;find_image( $this-&gt;pid );&nbsp;</div></li><li><div>            if ($image) {&nbsp;</div></li><li><div>                do_action('ngg_delete_picture', $this-&gt;pid, $image);&nbsp;</div></li><li><div>                if ($ngg-&gt;options['deleteImg']) {&nbsp;</div></li><li><div>                    $storage = $storage = C_Gallery_Storage::get_instance();&nbsp;</div></li><li><div>                    $storage-&gt;delete_image($this-&gt;pid);&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $mapper = C_Image_Mapper::get_instance();&nbsp;</div></li><li><div>                $result = $mapper-&gt;destroy($this-&gt;pid);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ($result)&nbsp;</div></li><li><div>                    nggGallery::show_message( __('Picture', 'nggallery').' \''.$this-&gt;pid.'\' '.__('deleted successfully', 'nggallery') );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>             $this-&gt;mode = 'edit'; // show pictures&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Recover picture from backup&nbsp;</div></li><li><div>        if ($this-&gt;mode == 'recoverpic') {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            check_admin_referer('ngg_recoverpicture');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // bring back the old image&nbsp;</div></li><li><div>            nggAdmin::recover_image($this-&gt;pid);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            nggGallery::show_message(__('Operation successful. Please clear your browser cache.', &quot;nggallery&quot;));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>             $this-&gt;mode = 'edit'; // show pictures&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // will be called after a ajax operation&nbsp;</div></li><li><div>        if (isset ($_POST['ajax_callback']))  {&nbsp;</div></li><li><div>                if ($_POST['ajax_callback'] == 1)&nbsp;</div></li><li><div>                    nggGallery::show_message(__('Operation successful. Please clear your browser cache.', &quot;nggallery&quot;));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // show sort order&nbsp;</div></li><li><div>        if ( isset ($_POST['sortGallery']) )&nbsp;</div></li><li><div>            $this-&gt;mode = 'sort';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( isset ($_GET['s']) )&nbsp;</div></li><li><div>            $this-&gt;search_images();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function setup_image_rows()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        add_filter('ngg_manage_images_row', array(&$this, 'render_image_row'), 10, 2);&nbsp;</div></li><li><div>        add_filter('ngg_manage_images_column_1_header', array(&$this, 'render_image_column_1_header'));&nbsp;</div></li><li><div>        add_filter('ngg_manage_images_column_1_content', array(&$this, 'render_image_column_1'), 10, 2);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_filter('ngg_manage_images_column_2_header', array(&$this, 'render_image_column_2_header'));&nbsp;</div></li><li><div>        add_filter('ngg_manage_images_column_2_content', array(&$this, 'render_image_column_2'), 10, 2);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_filter('ngg_manage_images_column_3_header', array(&$this, 'render_image_column_3_header'));&nbsp;</div></li><li><div>        add_filter('ngg_manage_images_column_3_content', array(&$this, 'render_image_column_3'), 10, 2);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_filter('ngg_manage_images_column_4_header', array(&$this, 'render_image_column_4_header'));&nbsp;</div></li><li><div>        add_filter('ngg_manage_images_column_4_content', array(&$this, 'render_image_column_4'), 10, 2);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_filter('ngg_manage_images_column_5_header', array(&$this, 'render_image_column_5_header'));&nbsp;</div></li><li><div>        add_filter('ngg_manage_images_column_5_content', array(&$this, 'render_image_column_5'), 10, 2);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_filter('ngg_manage_images_column_6_header', array(&$this, 'render_image_column_6_header'));&nbsp;</div></li><li><div>        add_filter('ngg_manage_images_column_6_content', array(&$this, 'render_image_column_6'), 10, 2);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_image_column_1_header()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return '&lt;input type=&quot;checkbox&quot; id=&quot;cb-select-all-1&quot; onclick=&quot;checkAll(document.getElementById(\'updategallery\'));&quot;&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_image_column_2_header()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return __('ID', 'nggallery');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_image_column_3_header()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return __('Thumbnail', 'nggallery');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_image_column_4_header()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return __('Filename', 'nggallery');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_image_column_5_header()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return __('Alt & Title Text / Description', 'nggallery');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_image_column_6_header()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return __('Tags', 'nggallery');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_image_column_1($output='', $picture=array())&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return &quot;&lt;input type='checkbox' name='doaction[]' value='{$picture-&gt;pid}'/&gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_image_column_2($output='', $picture=array())&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return $picture-&gt;pid;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_image_column_3($output='', $picture=array())&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $image_url = add_query_arg('i', mt_rand(), $picture-&gt;imageURL);&nbsp;</div></li><li><div>        $thumb_url = add_query_arg('i', mt_rand(), $picture-&gt;thumbURL);&nbsp;</div></li><li><div>        $filename = esc_attr($picture-&gt;filename);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output[] = &quot;&lt;a href='{$image_url}' class='shutter' title='{$filename}'&gt;&quot;;&nbsp;</div></li><li><div>        $output[] = &quot;&lt;img class='thumb' src='{$thumb_url}' id='thumb{$picture-&gt;pid}'/&gt;&quot;;&nbsp;</div></li><li><div>        $output[] = &quot;&lt;/a&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return ($output = implode(&quot;\n&quot;, $output));&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_image_column_4($output='', $picture=array())&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $image_url = nextgen_esc_url($picture-&gt;imageURL);&nbsp;</div></li><li><div>        $filename = esc_attr($picture-&gt;filename);&nbsp;</div></li><li><div>        $caption = esc_html((empty($picture-&gt;alttext) ? $picture-&gt;filename: $picture-&gt;alttext));&nbsp;</div></li><li><div>        $date = mysql2date(get_option('date_format'), $picture-&gt;imagedate);&nbsp;</div></li><li><div>        $width = $picture-&gt;meta_data['width'];&nbsp;</div></li><li><div>        $height = $picture-&gt;meta_data['height'];&nbsp;</div></li><li><div>        $pixels = &quot;{$width} x {$height} pixels&quot;;&nbsp;</div></li><li><div>        $excluded = checked($picture-&gt;exclude, 1, false);&nbsp;</div></li><li><div>        $exclude_label = __(&quot;Exclude ?&quot;, 'nggallery');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output[] =  &quot;&lt;div&gt;&lt;strong&gt;&lt;a href='{$image_url}' class='thickbox' title='{$caption}'&gt;{$filename}&lt;/a&gt;&lt;/strong&gt;&lt;/div&gt;&quot;;&nbsp;</div></li><li><div>        $output[] =  '&lt;div class=&quot;meta&quot;&gt;'. esc_html($date) . '&lt;/div&gt;';&nbsp;</div></li><li><div>        $output[] =  &quot;&lt;div class='meta'&gt;{$pixels}&lt;/div&gt;&quot;;&nbsp;</div></li><li><div>        $output[] =  &quot;&lt;label for='exclude_{$picture-&gt;pid}'&gt;&quot;;&nbsp;</div></li><li><div>        $output[] =  &quot;&lt;input type='checkbox' id='exclude_{$picture-&gt;pid}' value='1' name='images[{$picture-&gt;pid}][exclude]' {$excluded}/&gt; {$exclude_label}&quot;;&nbsp;</div></li><li><div>        $output[] =  &quot;&lt;/label&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return ($output = implode(&quot;\n&quot;, $output));&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_image_column_5($output='', $picture=array())&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $alttext = esc_attr(stripslashes($picture-&gt;alttext));&nbsp;</div></li><li><div>        $desc = esc_html(stripslashes($picture-&gt;description));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output[] = &quot;&lt;input title='Alt/Title Text' type='text' name='images[{$picture-&gt;pid}][alttext]' value='{$alttext}'/&gt;&quot;;&nbsp;</div></li><li><div>        $output[] = &quot;&lt;textarea title='Description' rows='3' name='images[$picture-&gt;pid][description]'&gt;{$desc}&lt;/textarea&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return ($output = implode(&quot;\n&quot;, $output));&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_image_column_6($output='', $picture=array())&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        global $wp_version;&nbsp;</div></li><li><div>        $fields = version_compare($wp_version, '4.6', '&lt;=') ? 'fields=names' : array('fields' =&gt; 'names');&nbsp;</div></li><li><div>        $tags = wp_get_object_terms($picture-&gt;pid, 'ngg_tag', $fields);&nbsp;</div></li><li><div>        if (is_array($tags)) $tags = implode(', ', $tags);&nbsp;</div></li><li><div>        $tags = esc_html($tags);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return &quot;&lt;textarea rows='4' name='images[{$picture-&gt;pid}][tags]'&gt;{$tags}&lt;/textarea&gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_image_row($picture, $counter)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        // Get number of columns&nbsp;</div></li><li><div>        $class = !($counter % 2 == 0) ? '' : 'alternate';&nbsp;</div></li><li><div>        $columns = apply_filters('ngg_manage_images_number_of_columns', 6);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Get the valid row actions&nbsp;</div></li><li><div>        $actions = array();&nbsp;</div></li><li><div>        $row_actions = apply_filters('ngg_manage_images_row_actions', array(&nbsp;</div></li><li><div>            'view' =&gt;    array(&$this, 'render_view_action_link'), &nbsp;</div></li><li><div>            'meta' =&gt;    array(&$this, 'render_meta_action_link'), &nbsp;</div></li><li><div>            'custom_thumb' =&gt;    array(&$this, 'render_custom_thumb_action_link'), &nbsp;</div></li><li><div>            'rotate' =&gt;    array(&$this, 'render_rotate_action_link'), &nbsp;</div></li><li><div>            'publish' =&gt;    array(&$this, 'render_publish_action_link'), &nbsp;</div></li><li><div>            'recover' =&gt;    array(&$this, 'render_recover_action_link'), &nbsp;</div></li><li><div>            'delete' =&gt;    array(&$this, 'render_delete_action_link')&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>        foreach ($row_actions as $id =&gt; $callback) {&nbsp;</div></li><li><div>            if (is_callable($callback)) {&nbsp;</div></li><li><div>                $result = call_user_func($callback, $id, $picture);&nbsp;</div></li><li><div>                if ($result) $actions[] = $result;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Output row columns&nbsp;</div></li><li><div>        echo &quot;&lt;tr class='{$class} iedit' valign='top'&gt;&quot;;&nbsp;</div></li><li><div>        for ($i=1; $i &lt;= $columns; $i++) {&nbsp;</div></li><li><div>            $rowspan = $i &gt; 4 ? &quot;rowspan='2'&quot; : '';&nbsp;</div></li><li><div>            echo &quot;&lt;td class='column column-{$i}' {$rowspan}&gt;&quot;;&nbsp;</div></li><li><div>            echo apply_filters(&quot;ngg_manage_images_column_{$i}_content&quot;, '', $picture);&nbsp;</div></li><li><div>            echo '&lt;/td&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        echo '&lt;/tr&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Actions row&nbsp;</div></li><li><div>        echo &quot;&lt;tr class='{$class} row_actions'&gt;&quot;;&nbsp;</div></li><li><div>        echo '&lt;td colspan=&quot;2&quot;&gt;&lt;/td&gt;';&nbsp;</div></li><li><div>        echo &quot;&lt;td colspan='&quot;.($columns-2).&quot;'&gt;&quot;;&nbsp;</div></li><li><div>        echo &quot;&lt;div class='row-actions'&gt;&quot;;&nbsp;</div></li><li><div>        echo implode(&quot; | &quot;, $actions);&nbsp;</div></li><li><div>        echo &quot;&lt;/div&gt;&quot;;&nbsp;</div></li><li><div>        echo &quot;&lt;/td&gt;&quot;;&nbsp;</div></li><li><div>        echo '&lt;/tr&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_view_action_link($id, $picture)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $image_url = nextgen_esc_url($picture-&gt;imageURL);&nbsp;</div></li><li><div>        $label = esc_html__('View', 'nggallery');&nbsp;</div></li><li><div>        $alt_text = empty($picture-&gt;alttext) ? $picture-&gt;filename: $picture-&gt;alttext;&nbsp;</div></li><li><div>        $title = esc_attr(__('View', 'nggallery'). &quot; \&quot;{$alt_text}\&quot;&quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return &quot;&lt;a href='{$image_url}' class='shutter' title='{$title}'&gt;{$label}&lt;/a&gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_meta_action_link($id, $picture)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $url = nextgen_esc_url(NGGALLERY_URLPATH.'admin/showmeta.php?id='.$picture-&gt;pid);&nbsp;</div></li><li><div>        $title = esc_attr__('Show meta data', 'nggallery');&nbsp;</div></li><li><div>        $label = esc_html__('Meta', 'nggallery');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return &quot;&lt;a href='{$url}' class='ngg-dialog' title='{$title}'&gt;{$label}&lt;/a&gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_custom_thumb_action_link($id, $picture)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $url = nextgen_esc_url(NGGALLERY_URLPATH.'admin/edit-thumbnail.php?id='.$picture-&gt;pid);&nbsp;</div></li><li><div>        $title = esc_attr__('Customize thumbnail', 'nggallery');&nbsp;</div></li><li><div>        $label = esc_html__(&quot;Edit thumb&quot;, 'nggallery');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return &quot;&lt;a href='{$url}' class='ngg-dialog' title='{$title}'&gt;{$label}&lt;/a&gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_rotate_action_link($id, $picture)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $url = nextgen_esc_url(NGGALLERY_URLPATH.'admin/rotate.php?id='.$picture-&gt;pid);&nbsp;</div></li><li><div>        $title = esc_attr__('Rotate', 'nggallery');&nbsp;</div></li><li><div>        $label = esc_html__('Rotate', 'nggallery');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return &quot;&lt;a href='{$url}' class='ngg-dialog' title='{$title}'&gt;{$label}&lt;/a&gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_publish_action_link($id, $picture)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if (!current_user_can('publish_posts')) return FALSE;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $url = nextgen_esc_url(NGGALLERY_URLPATH.'admin/publish.php?h=230&id='.$picture-&gt;pid);&nbsp;</div></li><li><div>        $title = esc_attr__('Publish this image', 'nggallery');&nbsp;</div></li><li><div>        $label = esc_html__('Publish', 'nggallery');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return &quot;&lt;a href='{$url}' class='ngg-dialog' title='{$title}'&gt;{$label}&lt;/a&gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_recover_action_link($id, $picture)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if ( !file_exists( $picture-&gt;imagePath . '_backup' )) return FALSE;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $url = wp_nonce_url(&quot;admin.php?page=nggallery-manage-gallery&amp;mode=recoverpic&amp;gid={$picture-&gt;galleryid}&amp;pid={$picture-&gt;pid}&quot;, 'ngg_recoverpicture');&nbsp;</div></li><li><div>        $title = esc_attr__('Recover image from backup', 'nggallery');&nbsp;</div></li><li><div>        $label = esc_html__('Recover', 'nggallery');&nbsp;</div></li><li><div>        $alttext = empty($picture-&gt;alttext) ? $picture-&gt;filename : $picture-&gt;alttext;&nbsp;</div></li><li><div>        $confirm = addslashes(__(&quot;Recover&quot;, 'nggallery'). &quot; \&quot;{$alttext}\&quot;?&quot;);&nbsp;</div></li><li><div>        $onclick = &quot;javascript:if(!confirm(\&quot;{$confirm}\&quot;)) return false&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return &quot;&lt;a href='{$url}' onclick='{$onclick}' class='confirmrecover' title='{$title}'&gt;{$label}&lt;/a&gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_delete_action_link($id, $picture)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $url = wp_nonce_url(&quot;admin.php?page=nggallery-manage-gallery&amp;mode=delpic&amp;gid={$picture-&gt;galleryid}&amp;pid={$picture-&gt;pid}&quot;, 'ngg_delpicture');&nbsp;</div></li><li><div>        $title = esc_attr__('Delete image', 'nggallery');&nbsp;</div></li><li><div>        $label = esc_html__('Delete', 'nggallery');&nbsp;</div></li><li><div>        $alttext = empty($picture-&gt;alttext) ? $picture-&gt;filename : $picture-&gt;alttext;&nbsp;</div></li><li><div>        $confirm = addslashes(__(&quot;Delete&quot;, 'nggallery'). &quot; \&quot;{$alttext}\&quot;?&quot;);&nbsp;</div></li><li><div>        $onclick = &quot;javascript:if(!confirm(\&quot;{$confirm}\&quot;)) return false;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return &quot;&lt;a href='{$url}' onclick='{$onclick}' class='submitdelete delete' title='{$title}'&gt;{$label}&lt;/a&gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_image_row_header()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $columns = apply_filters('ngg_manage_images_number_of_columns', 6);&nbsp;</div></li><li><div>        echo '&lt;tr&gt;';&nbsp;</div></li><li><div>        for($i=1; $i&lt;=$columns; $i++) {&nbsp;</div></li><li><div>            echo &quot;&lt;th class='column column-{$i}'&gt;&quot;;&nbsp;</div></li><li><div>            echo apply_filters('ngg_manage_images_column_'.$i.'_header', &quot;Column #{$i}&quot;);&nbsp;</div></li><li><div>            echo '&lt;/th&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        echo '&lt;/tr&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function setup_gallery_fields()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        add_filter('ngg_manage_gallery_fields', array(&$this, 'default_gallery_fields'), 10, 2);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function default_gallery_fields($fields=array(), $gallery=NULL)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $fields['left'] = array(&nbsp;</div></li><li><div>            'title' =&gt;    array(&nbsp;</div></li><li><div>                'callback' =&gt;    array(&$this, 'render_gallery_title_field'), &nbsp;</div></li><li><div>                'label' =&gt;    __('Title:', 'nggallery'), &nbsp;</div></li><li><div>                'tooltip' =&gt;  NULL, &nbsp;</div></li><li><div>                'id' =&gt;    'gallery_title'&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'description' =&gt;    array(&nbsp;</div></li><li><div>                'callback' =&gt;    array(&$this, 'render_gallery_desc_field'), &nbsp;</div></li><li><div>                'label' =&gt;    __('Description:', 'nggallery'), &nbsp;</div></li><li><div>                'tooltip' =&gt;  NULL, &nbsp;</div></li><li><div>                'id' =&gt;    'gallery_desc'&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'path' =&gt;    array(&nbsp;</div></li><li><div>                'callback' =&gt;    array(&$this, 'render_gallery_path_field'), &nbsp;</div></li><li><div>                'label' =&gt;    __('Gallery path:', 'nggallery'), &nbsp;</div></li><li><div>                'tooltip' =&gt;  NULL, &nbsp;</div></li><li><div>                'id' =&gt;    'gallery_path'&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'gallery_author'=&gt;    array(&nbsp;</div></li><li><div>                'callback' =&gt;    array(&$this, 'render_gallery_author_field'), &nbsp;</div></li><li><div>                'label' =&gt;    __('Author', 'nggallery'), &nbsp;</div></li><li><div>                'tooltip' =&gt;  NULL, &nbsp;</div></li><li><div>                'id' =&gt;    'gallery_author'&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $fields['right'] = array(&nbsp;</div></li><li><div>            'page_link_to' =&gt;    array(&nbsp;</div></li><li><div>                'callback' =&gt;    array(&$this, 'render_gallery_link_to_page_field'), &nbsp;</div></li><li><div>                'label' =&gt;    __('Link to page:', 'nggallery'), &nbsp;</div></li><li><div>                'tooltip' =&gt;  __('Albums will link this gallery to the selected page', 'nggallery'), &nbsp;</div></li><li><div>                'id' =&gt;    'gallery_page_link_to'&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'preview_image' =&gt;    array(&nbsp;</div></li><li><div>                'callback' =&gt;    array(&$this, 'render_gallery_preview_image_field'), &nbsp;</div></li><li><div>                'label' =&gt;    __('Preview image:', 'nggallery'), &nbsp;</div></li><li><div>                'tooltip' =&gt;  NULL, &nbsp;</div></li><li><div>                'id' =&gt;    'gallery_preview_image', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'create_page' =&gt;    array(&nbsp;</div></li><li><div>                'callback' =&gt;    array(&$this, 'render_gallery_create_page_field'), &nbsp;</div></li><li><div>                'label' =&gt;    __('Create new page:', 'nggallery'), &nbsp;</div></li><li><div>                'tooltip' =&gt;  NULL, &nbsp;</div></li><li><div>                'id' =&gt;    'gallery_create_new_page'&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $fields;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_gallery_field_label_column($text, $for, $tooltip = NULL)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $for = esc_attr($for);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (!empty($tooltip))&nbsp;</div></li><li><div>            $tooltip = &quot;title='{$tooltip}' class='tooltip'&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo &quot;&lt;td&gt;&lt;label {$tooltip} for='{$for}'&gt;{$text}&lt;/label&gt;&lt;/td&gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_gallery_fields()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        // Get the gallery entity&nbsp;</div></li><li><div>        $gallery = C_Gallery_Mapper::get_instance()-&gt;find($this-&gt;gid);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Get fields&nbsp;</div></li><li><div>        $fields = apply_filters('ngg_manage_gallery_fields', array(), $gallery);&nbsp;</div></li><li><div>        $left = isset($fields['left']) ? $fields['left'] : array();&nbsp;</div></li><li><div>        $right = isset($fields['right'])? $fields['right']: array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Output table&nbsp;</div></li><li><div>        echo '&lt;table id=&quot;gallery_fields&quot;&gt;';&nbsp;</div></li><li><div>        $number_of_fields = max(count($left), count($right));&nbsp;</div></li><li><div>        $left_keys = array_keys($left);&nbsp;</div></li><li><div>        $right_keys = array_keys($right);&nbsp;</div></li><li><div>        for($i=0; $i&lt;$number_of_fields; $i++) {&nbsp;</div></li><li><div>            // Start row&nbsp;</div></li><li><div>            echo '&lt;tr&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Left column&nbsp;</div></li><li><div>            if (isset($left_keys[$i])) {&nbsp;</div></li><li><div>                extract($left[$left_keys[$i]]);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // Label&nbsp;</div></li><li><div>                $this-&gt;render_gallery_field_label_column($label, $id, $tooltip);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // Input field&nbsp;</div></li><li><div>                if (is_callable($callback)) {&nbsp;</div></li><li><div>                    echo '&lt;td&gt;';&nbsp;</div></li><li><div>                    call_user_func($callback, $gallery);&nbsp;</div></li><li><div>                    echo '&lt;/td&gt;';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                elseif (WP_DEBUG) echo &quot;&lt;p&gt;Could not render {$left_keys[$i]} field. No callback exists&lt;/p&gt;&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            else $output[] = '&lt;td colspan=&quot;2&quot;&gt;&lt;/td&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Right column&nbsp;</div></li><li><div>            if (isset($right_keys[$i])) {&nbsp;</div></li><li><div>                extract($right[$right_keys[$i]]);&nbsp;</div></li><li><div>                // Label&nbsp;</div></li><li><div>                $this-&gt;render_gallery_field_label_column($label, $id, $tooltip);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // Input field&nbsp;</div></li><li><div>                if (is_callable($callback)) {&nbsp;</div></li><li><div>                    echo '&lt;td&gt;';&nbsp;</div></li><li><div>                    call_user_func($callback, $gallery);&nbsp;</div></li><li><div>                    echo '&lt;/td&gt;';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                elseif (WP_DEBUG) echo &quot;&lt;p&gt;Could not render {$right_keys[$i]} field. No callback exists&lt;/p&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            else $output[] = '&lt;td colspan=&quot;2&quot;&gt;&lt;/td&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // End row&nbsp;</div></li><li><div>            echo '&lt;/tr&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        echo '&lt;/table&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_gallery_title_field($gallery)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        include('templates/manage_gallery/gallery_title_field.php');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_gallery_desc_field($gallery)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        include('templates/manage_gallery/gallery_desc_field.php');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_gallery_path_field($gallery)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        include('templates/manage_gallery/gallery_path_field.php');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_gallery_author_field($gallery)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $user = get_userdata($gallery-&gt;author);&nbsp;</div></li><li><div>        $author = isset($user-&gt;display_name) ? $user-&gt;display_name : $user-&gt;user_nicename;&nbsp;</div></li><li><div>        include('templates/manage_gallery/gallery_author_field.php');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_gallery_link_to_page_field($gallery)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $pages = get_pages();&nbsp;</div></li><li><div>        include('templates/manage_gallery/gallery_link_to_page_field.php');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_gallery_preview_image_field($gallery)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $images = array();&nbsp;</div></li><li><div>        foreach (C_Image_Mapper::get_instance()-&gt;find_all(array(&quot;galleryid = %s&quot;, $gallery-&gt;{$gallery-&gt;id_field})) as $image) {&nbsp;</div></li><li><div>            $images[$image-&gt;{$image-&gt;id_field}] = &quot;[{$image-&gt;{$image-&gt;id_field}}] {$image-&gt;filename}&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        include('templates/manage_gallery/gallery_preview_image_field.php');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function render_gallery_create_page_field($gallery)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $pages = get_pages();&nbsp;</div></li><li><div>        include('templates/manage_gallery/gallery_create_page_field.php');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function post_processor_galleries() {&nbsp;</div></li><li><div>        global $wpdb, $ngg, $nggdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // bulk update in a single gallery&nbsp;</div></li><li><div>        if (isset ($_POST['bulkaction']) && isset ($_POST['doaction']))  {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            check_admin_referer('ngg_bulkgallery');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            switch ($_POST['bulkaction']) {&nbsp;</div></li><li><div>                case 'no_action';&nbsp;</div></li><li><div>                // No action&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 'recover_images':&nbsp;</div></li><li><div>                // Recover images from backup&nbsp;</div></li><li><div>                    // A prefix 'gallery_' will first fetch all ids from the selected galleries&nbsp;</div></li><li><div>                    nggAdmin::do_ajax_operation( 'gallery_recover_image' , $_POST['doaction'], __('Recover from backup', 'nggallery') );&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 'set_watermark':&nbsp;</div></li><li><div>                // Set watermark&nbsp;</div></li><li><div>                    // A prefix 'gallery_' will first fetch all ids from the selected galleries&nbsp;</div></li><li><div>                    nggAdmin::do_ajax_operation( 'gallery_set_watermark' , $_POST['doaction'], __('Set watermark', 'nggallery') );&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 'import_meta':&nbsp;</div></li><li><div>                // Import Metadata&nbsp;</div></li><li><div>                    // A prefix 'gallery_' will first fetch all ids from the selected galleries&nbsp;</div></li><li><div>                    nggAdmin::do_ajax_operation( 'gallery_import_metadata' , $_POST['doaction'], __('Import metadata', 'nggallery') );&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 'delete_gallery':&nbsp;</div></li><li><div>                    // Delete gallery&nbsp;</div></li><li><div>                    if (is_array($_POST['doaction']))&nbsp;</div></li><li><div>                    {&nbsp;</div></li><li><div>                        $deleted = FALSE;&nbsp;</div></li><li><div>                        $mapper = C_Gallery_Mapper::get_instance();&nbsp;</div></li><li><div>                        foreach ($_POST['doaction'] as $id) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            $gallery = $mapper-&gt;find($id);&nbsp;</div></li><li><div>                            if ($gallery-&gt;path == '../' || FALSE !== strpos($gallery-&gt;path, '/../'))&nbsp;</div></li><li><div>                            {&nbsp;</div></li><li><div>                                nggGallery::show_message(sprintf(__('One or more &quot;../&quot; in Gallery paths could be unsafe and NextGen Gallery will not delete gallery %s automatically', 'nggallery'), $gallery-&gt;{$gallery-&gt;id_field}));&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                            else {&nbsp;</div></li><li><div>                                if ($mapper-&gt;destroy($id, TRUE))&nbsp;</div></li><li><div>                                    $deleted = TRUE;&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        if ($deleted)&nbsp;</div></li><li><div>                            nggGallery::show_message(__('Gallery deleted successfully ', 'nggallery'));&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($_POST['addgallery']) && isset ($_POST['galleryname'])) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            check_admin_referer('ngg_addgallery');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( !nggGallery::current_user_can( 'NextGEN Add new gallery' ))&nbsp;</div></li><li><div>                wp_die(__('Cheatin&#8217; uh?', 'nggallery'));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // get the default path for a new gallery&nbsp;</div></li><li><div>            $defaultpath = $ngg-&gt;options['gallerypath'];&nbsp;</div></li><li><div>            $newgallery = $_POST['galleryname'];&nbsp;</div></li><li><div>            if ( !empty($newgallery) )&nbsp;</div></li><li><div>                nggAdmin::create_gallery($newgallery, $defaultpath);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            do_action( 'ngg_update_addgallery_page' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($_POST['TB_bulkaction']) && isset ($_POST['TB_ResizeImages']))  {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            check_admin_referer('ngg_thickbox_form');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            //save the new values for the next operation&nbsp;</div></li><li><div>            $ngg-&gt;options['imgWidth'] = (int) $_POST['imgWidth'];&nbsp;</div></li><li><div>            $ngg-&gt;options['imgHeight'] = (int) $_POST['imgHeight'];&nbsp;</div></li><li><div>            // What is in the case the user has no if cap 'NextGEN Change options' ? Check feedback&nbsp;</div></li><li><div>            update_option('ngg_options', $ngg-&gt;options);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $gallery_ids = explode(', ', $_POST['TB_imagelist']);&nbsp;</div></li><li><div>            // A prefix 'gallery_' will first fetch all ids from the selected galleries&nbsp;</div></li><li><div>            nggAdmin::do_ajax_operation( 'gallery_resize_image' , $gallery_ids, __('Resize images', 'nggallery') );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($_POST['TB_bulkaction']) && isset ($_POST['TB_NewThumbnail']))  {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            check_admin_referer('ngg_thickbox_form');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // save the new values for the next operation&nbsp;</div></li><li><div>            $settings = C_NextGen_Settings::get_instance();&nbsp;</div></li><li><div>            $settings-&gt;thumbwidth = (int)$_POST['thumbwidth'];&nbsp;</div></li><li><div>            $settings-&gt;thumbheight = (int)$_POST['thumbheight'];&nbsp;</div></li><li><div>            $settings-&gt;thumbfix = isset($_POST['thumbfix']) ? TRUE : FALSE;&nbsp;</div></li><li><div>            $settings-&gt;save();&nbsp;</div></li><li><div>            ngg_refreshSavedSettings();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // What is in the case the user has no if cap 'NextGEN Change options' ? Check feedback&nbsp;</div></li><li><div>            $gallery_ids = explode(', ', $_POST['TB_imagelist']);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // A prefix 'gallery_' will first fetch all ids from the selected galleries&nbsp;</div></li><li><div>            nggAdmin::do_ajax_operation( 'gallery_create_thumbnail' , $gallery_ids, __('Create new thumbnails', 'nggallery') );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function post_processor_images() {&nbsp;</div></li><li><div>        global $wpdb, $ngg, $nggdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // bulk update in a single gallery&nbsp;</div></li><li><div>        if (isset ($_POST['bulkaction']) && isset ($_POST['doaction']))  {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            check_admin_referer('ngg_updategallery');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            switch ($_POST['bulkaction']) {&nbsp;</div></li><li><div>                case 'no_action';&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 'rotate_cw':&nbsp;</div></li><li><div>                    nggAdmin::do_ajax_operation( 'rotate_cw' , $_POST['doaction'], __('Rotate images', 'nggallery') );&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 'rotate_ccw':&nbsp;</div></li><li><div>                    nggAdmin::do_ajax_operation( 'rotate_ccw' , $_POST['doaction'], __('Rotate images', 'nggallery') );&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 'recover_images':&nbsp;</div></li><li><div>                    nggAdmin::do_ajax_operation( 'recover_image' , $_POST['doaction'], __('Recover from backup', 'nggallery') );&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 'set_watermark':&nbsp;</div></li><li><div>                    nggAdmin::do_ajax_operation( 'set_watermark' , $_POST['doaction'], __('Set watermark', 'nggallery') );&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 'delete_images':&nbsp;</div></li><li><div>                    if ( is_array($_POST['doaction']) ) {&nbsp;</div></li><li><div>                        foreach ( $_POST['doaction'] as $imageID ) {&nbsp;</div></li><li><div>                            $image = $nggdb-&gt;find_image( $imageID );&nbsp;</div></li><li><div>                            if ($image) {&nbsp;</div></li><li><div>                                do_action('ngg_delete_picture', $image-&gt;pid, $image);&nbsp;</div></li><li><div>                                if ($ngg-&gt;options['deleteImg']) {&nbsp;</div></li><li><div>                                    $storage = C_Gallery_Storage::get_instance();&nbsp;</div></li><li><div>                                    $storage-&gt;delete_image($image-&gt;pid);&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>                                $delete_pic = C_Image_Mapper::get_instance()-&gt;destroy($image-&gt;pid);&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        if($delete_pic)&nbsp;</div></li><li><div>                            nggGallery::show_message(__('Pictures deleted successfully ', 'nggallery'));&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 'import_meta':&nbsp;</div></li><li><div>                    nggAdmin::do_ajax_operation( 'import_metadata' , $_POST['doaction'], __('Import metadata', 'nggallery') );&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($_POST['TB_bulkaction']) && isset ($_POST['TB_ResizeImages']))  {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            check_admin_referer('ngg_thickbox_form');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            //save the new values for the next operation&nbsp;</div></li><li><div>            $ngg-&gt;options['imgWidth'] = (int) $_POST['imgWidth'];&nbsp;</div></li><li><div>            $ngg-&gt;options['imgHeight'] = (int) $_POST['imgHeight'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            update_option('ngg_options', $ngg-&gt;options);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pic_ids = explode(', ', $_POST['TB_imagelist']);&nbsp;</div></li><li><div>            nggAdmin::do_ajax_operation( 'resize_image' , $pic_ids, __('Resize images', 'nggallery') );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($_POST['TB_bulkaction']) && isset ($_POST['TB_NewThumbnail']))  {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            check_admin_referer('ngg_thickbox_form');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // save the new values for the next operation&nbsp;</div></li><li><div>            $settings = C_NextGen_Settings::get_instance();&nbsp;</div></li><li><div>            $settings-&gt;thumbwidth = (int)$_POST['thumbwidth'];&nbsp;</div></li><li><div>            $settings-&gt;thumbheight = (int)$_POST['thumbheight'];&nbsp;</div></li><li><div>            $settings-&gt;thumbfix = isset($_POST['thumbfix']) ? TRUE : FALSE;&nbsp;</div></li><li><div>            $settings-&gt;save();&nbsp;</div></li><li><div>            ngg_refreshSavedSettings();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pic_ids = explode(', ', $_POST['TB_imagelist']);&nbsp;</div></li><li><div>            nggAdmin::do_ajax_operation( 'create_thumbnail' , $pic_ids, __('Create new thumbnails', 'nggallery') );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($_POST['TB_bulkaction']) && isset ($_POST['TB_SelectGallery']))  {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            check_admin_referer('ngg_thickbox_form');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pic_ids = explode(', ', $_POST['TB_imagelist']);&nbsp;</div></li><li><div>            $dest_gid = (int) $_POST['dest_gid'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            switch ($_POST['TB_bulkaction']) {&nbsp;</div></li><li><div>                case 'copy_to':&nbsp;</div></li><li><div>                    C_Gallery_Storage::get_instance()-&gt;copy_images($pic_ids, $dest_gid);&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 'move_to':&nbsp;</div></li><li><div>                    C_Gallery_Storage::get_instance()-&gt;move_images($pic_ids, $dest_gid);&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($_POST['TB_bulkaction']) && isset ($_POST['TB_EditTags']))  {&nbsp;</div></li><li><div>            // do tags update&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            check_admin_referer('ngg_thickbox_form');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // get the images list&nbsp;</div></li><li><div>            $pic_ids = explode(', ', $_POST['TB_imagelist']);&nbsp;</div></li><li><div>            $taglist = explode(', ', $_POST['taglist']);&nbsp;</div></li><li><div>            $taglist = array_map('trim', $taglist);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if (is_array($pic_ids)) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                foreach($pic_ids as $pic_id) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    // which action should be performed ?&nbsp;</div></li><li><div>                    switch ($_POST['TB_bulkaction']) {&nbsp;</div></li><li><div>                        case 'no_action';&nbsp;</div></li><li><div>                        // No action&nbsp;</div></li><li><div>                            break;&nbsp;</div></li><li><div>                        case 'overwrite_tags':&nbsp;</div></li><li><div>                        // Overwrite tags&nbsp;</div></li><li><div>                            wp_set_object_terms($pic_id, $taglist, 'ngg_tag');&nbsp;</div></li><li><div>                            break;&nbsp;</div></li><li><div>                        case 'add_tags':&nbsp;</div></li><li><div>                        // Add / append tags&nbsp;</div></li><li><div>                            wp_set_object_terms($pic_id, $taglist, 'ngg_tag', TRUE);&nbsp;</div></li><li><div>                            break;&nbsp;</div></li><li><div>                        case 'delete_tags':&nbsp;</div></li><li><div>                        // Delete tags&nbsp;</div></li><li><div>                            $oldtags = wp_get_object_terms($pic_id, 'ngg_tag', 'fields=names');&nbsp;</div></li><li><div>                            // get the slugs, to vaoid  case sensitive problems&nbsp;</div></li><li><div>                            $slugarray = array_map('sanitize_title', $taglist);&nbsp;</div></li><li><div>                            $oldtags = array_map('sanitize_title', $oldtags);&nbsp;</div></li><li><div>                            // compare them and return the diff&nbsp;</div></li><li><div>                            $newtags = array_diff($oldtags, $slugarray);&nbsp;</div></li><li><div>                            wp_set_object_terms($pic_id, $newtags, 'ngg_tag');&nbsp;</div></li><li><div>                            break;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                nggGallery::show_message( __('Tags changed', 'nggallery') );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($_POST['updatepictures']) )  {&nbsp;</div></li><li><div>        // Update pictures&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            check_admin_referer('ngg_updategallery');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( nggGallery::current_user_can( 'NextGEN Edit gallery options' )  && !isset ($_GET['s']) ) {&nbsp;</div></li><li><div>                $tags = array('&lt;a&gt;', '&lt;abbr&gt;', '&lt;acronym&gt;', '&lt;address&gt;', '&lt;b&gt;', '&lt;base&gt;', '&lt;basefont&gt;', '&lt;big&gt;', '&lt;blockquote&gt;', '&lt;br&gt;', '&lt;br/&gt;', '&lt;caption&gt;', '&lt;center&gt;', '&lt;cite&gt;', '&lt;code&gt;', '&lt;col&gt;', '&lt;colgroup&gt;', '&lt;dd&gt;', '&lt;del&gt;', '&lt;dfn&gt;', '&lt;dir&gt;', '&lt;div&gt;', '&lt;dl&gt;', '&lt;dt&gt;', '&lt;em&gt;', '&lt;fieldset&gt;', '&lt;font&gt;', '&lt;h1&gt;', '&lt;h2&gt;', '&lt;h3&gt;', '&lt;h4&gt;', '&lt;h5&gt;', '&lt;h6&gt;', '&lt;hr&gt;', '&lt;i&gt;', '&lt;img&gt;', '&lt;ins&gt;', '&lt;label&gt;', '&lt;legend&gt;', '&lt;li&gt;', '&lt;menu&gt;', '&lt;noframes&gt;', '&lt;noscript&gt;', '&lt;ol&gt;', '&lt;optgroup&gt;', '&lt;option&gt;', '&lt;p&gt;', '&lt;pre&gt;', '&lt;q&gt;', '&lt;s&gt;', '&lt;samp&gt;', '&lt;select&gt;', '&lt;small&gt;', '&lt;span&gt;', '&lt;strike&gt;', '&lt;strong&gt;', '&lt;sub&gt;', '&lt;sup&gt;', '&lt;table&gt;', '&lt;tbody&gt;', '&lt;td&gt;', '&lt;tfoot&gt;', '&lt;th&gt;', '&lt;thead&gt;', '&lt;tr&gt;', '&lt;tt&gt;', '&lt;u&gt;', '&lt;ul&gt;');&nbsp;</div></li><li><div>                $fields = array('title', 'galdesc');&nbsp;</div></li><li><div>                &nbsp;</div></li><li><div>                // Sanitize fields&nbsp;</div></li><li><div>                foreach ($fields as $field) {&nbsp;</div></li><li><div>                    $html = stripslashes($_POST[$field]);&nbsp;</div></li><li><div>                    $html = preg_replace('/\\s+on\\w+=([&quot;\']).*?\\1/i', '', $html);&nbsp;</div></li><li><div>                    $html = preg_replace('/(&lt;\/[^&gt;]+?&gt;)(&lt;[^&gt;\/][^&gt;]*?&gt;)/', '$1 $2', $html);&nbsp;</div></li><li><div>                    $html = strip_tags($html, implode('', $tags));&nbsp;</div></li><li><div>                    $_POST[$field] = $html;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                &nbsp;</div></li><li><div>                // Update the gallery&nbsp;</div></li><li><div>                $mapper = C_Gallery_Mapper::get_instance();&nbsp;</div></li><li><div>                if ($entity = $mapper-&gt;find($this-&gt;gid)) {&nbsp;</div></li><li><div>                    foreach ($_POST as $key =&gt; $value) {&nbsp;</div></li><li><div>                        $entity-&gt;$key = $value;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $mapper-&gt;save($entity);&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ($entity-&gt;path == '../' || FALSE !== strpos($entity-&gt;path, '/../'))&nbsp;</div></li><li><div>                    nggGallery::show_message(sprintf(__('One or more &quot;../&quot; in Gallery paths could be unsafe and NextGen Gallery will not delete this gallery automatically', 'nggallery'), $entity-&gt;{$entity-&gt;id_field}));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                wp_cache_delete($this-&gt;gid, 'ngg_gallery');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $this-&gt;update_pictures();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            //hook for other plugin to update the fields&nbsp;</div></li><li><div>            do_action('ngg_update_gallery', $this-&gt;gid, $_POST);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            nggGallery::show_message(__('Update successful', 'nggallery'));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($_POST['scanfolder']))  {&nbsp;</div></li><li><div>        // Rescan folder&nbsp;</div></li><li><div>            check_admin_referer('ngg_updategallery');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $gallerypath = $wpdb-&gt;get_var(&quot;SELECT path FROM $wpdb-&gt;nggallery WHERE gid = '$this-&gt;gid' &quot;);&nbsp;</div></li><li><div>            nggAdmin::import_gallery($gallerypath, $this-&gt;gid);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add a new page&nbsp;</div></li><li><div>        if (isset ($_POST['addnewpage']))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            check_admin_referer('ngg_updategallery');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $parent_id = esc_attr($_POST['parent_id']);&nbsp;</div></li><li><div>            $gallery_title = esc_attr($_POST['title']);&nbsp;</div></li><li><div>            $mapper = C_Gallery_Mapper::get_instance();&nbsp;</div></li><li><div>            $gallery = $mapper-&gt;find($this-&gt;gid);&nbsp;</div></li><li><div>            $gallery_name = $gallery-&gt;name;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Create a WP page&nbsp;</div></li><li><div>            global $user_ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $page['post_type'] = 'page';&nbsp;</div></li><li><div>            $page['post_content'] = apply_filters('ngg_add_page_shortcode', '[nggallery id=&quot;' . $this-&gt;gid . '&quot;]' );&nbsp;</div></li><li><div>            $page['post_parent'] = $parent_id;&nbsp;</div></li><li><div>            $page['post_author'] = $user_ID;&nbsp;</div></li><li><div>            $page['post_status'] = 'publish';&nbsp;</div></li><li><div>            $page['post_title'] = $gallery_title == '' ? $gallery_name : $gallery_title;&nbsp;</div></li><li><div>            $page = apply_filters('ngg_add_new_page', $page, $this-&gt;gid);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $gallery_pageid = wp_insert_post ($page);&nbsp;</div></li><li><div>            if ($gallery_pageid != 0)&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                $gallery-&gt;pageid = $gallery_pageid;&nbsp;</div></li><li><div>                $mapper-&gt;save($gallery);&nbsp;</div></li><li><div>                nggGallery::show_message(__('New gallery page ID', 'nggallery') . ' ' . $gallery_pageid . ' -&gt; &lt;strong&gt;' . $gallery_title . '&lt;/strong&gt; ' . __('created', 'nggallery'));&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            do_action('ngg_gallery_addnewpage', $this-&gt;gid);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>       /**&nbsp;</div></li><li><div>        * Publish a new post with the shortcode from the selected image&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>        * @since 1.7.0&nbsp;</div></li><li><div>        * @return void&nbsp;</div></li><li><div>        */&nbsp;</div></li><li><div>       function publish_post() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>           check_admin_referer('publish-post');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Create a WP page&nbsp;</div></li><li><div>        global $user_ID, $ngg;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $ngg-&gt;options['publish_width'] = (int) $_POST['width'];&nbsp;</div></li><li><div>        $ngg-&gt;options['publish_height'] = (int) $_POST['height'];&nbsp;</div></li><li><div>        $ngg-&gt;options['publish_align'] = $_POST['align'];&nbsp;</div></li><li><div>        $align = ( $ngg-&gt;options['publish_align'] == 'none') ? '' : 'float='.$ngg-&gt;options['publish_align'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //save the new values for the next operation&nbsp;</div></li><li><div>        update_option('ngg_options', $ngg-&gt;options);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $post['post_type'] = 'post';&nbsp;</div></li><li><div>        $post['post_content'] = '[singlepic id=' . intval($_POST['pid']) . ' w=' . $ngg-&gt;options['publish_width'] . ' h=' . $ngg-&gt;options['publish_height'] . ' ' . $align . ']';&nbsp;</div></li><li><div>        $post['post_author'] = $user_ID;&nbsp;</div></li><li><div>        $post['post_status'] = isset ( $_POST['publish'] ) ? 'publish' : 'draft';&nbsp;</div></li><li><div>        $post['post_title'] = $_POST['post_title'];&nbsp;</div></li><li><div>        $post = apply_filters('ngg_add_new_post', $post, $_POST['pid']);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $post_id = wp_insert_post ($post);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ($post_id != 0)&nbsp;</div></li><li><div>            nggGallery::show_message( __('Published a new post', 'nggallery') );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function can_user_manage_gallery()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $retval = FALSE;&nbsp;</div></li><li><div>        $registry = C_Component_Registry::get_instance();&nbsp;</div></li><li><div>        $security = $registry-&gt;get_utility('I_Security_Manager');&nbsp;</div></li><li><div>        $actor = $security-&gt;get_current_actor();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ($this-&gt;gallery && $actor-&gt;get_entity_id()== $this-&gt;gallery-&gt;author) {&nbsp;</div></li><li><div>            $retval = TRUE;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif($actor-&gt;is_allowed('nextgen_edit_gallery_unowned')) {&nbsp;</div></li><li><div>            $retval = TRUE;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $retval;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function update_pictures()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $updated = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (!$this-&gt;can_user_manage_gallery()) return $updated;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset($_POST['images']) && is_array($_POST['images'])) {&nbsp;</div></li><li><div>            $image_mapper = C_Image_Mapper::get_instance();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ($_POST['images'] as $pid =&gt; $data) {&nbsp;</div></li><li><div>                if (!isset($data['exclude'])) $data['exclude'] = 0;&nbsp;</div></li><li><div>                if (($image = $image_mapper-&gt;find($pid))) {&nbsp;</div></li><li><div>                    // Strip slashes from title/description/alttext fields&nbsp;</div></li><li><div>                    if (isset($data['description'])) {&nbsp;</div></li><li><div>                        $data['description'] = stripslashes($data['description']);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (isset($data['alttext'])) {&nbsp;</div></li><li><div>                        $data['alttext'] = stripslashes($data['alttext']);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (isset($data['title'])) {&nbsp;</div></li><li><div>                        $data['title'] = stripslashes($data['title']);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    // Generate new slug if the alttext has changed&nbsp;</div></li><li><div>                    if (isset($data['alttext']) && $image-&gt;alttext != $data['alttext']) {&nbsp;</div></li><li><div>                        $data['slug'] = NULL; // will cause a new slug to be generated&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    // Update all fields&nbsp;</div></li><li><div>                    foreach ($data as $key =&gt; $value) {&nbsp;</div></li><li><div>                        $image-&gt;$key = $value;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ($image_mapper-&gt;save($image)) {&nbsp;</div></li><li><div>                        $updated += 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        // Update the tags for the image&nbsp;</div></li><li><div>                        if (isset($data['tags'])) {&nbsp;</div></li><li><div>                            $tags = $data['tags'];&nbsp;</div></li><li><div>                            if (!is_array($tags)) $tags = explode(', ', $tags);&nbsp;</div></li><li><div>                            foreach ($tags as &$tag) $tag = trim($tag);&nbsp;</div></li><li><div>                            wp_set_object_terms($image-&gt;{$image-&gt;id_field}, $tags, 'ngg_tag');&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        // remove from cache&nbsp;</div></li><li><div>                        wp_cache_delete($image-&gt;pid, 'ngg_image');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        // hook for other plugins after image is updated&nbsp;</div></li><li><div>                        do_action('ngg_image_updated', $image);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $updated;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // Check if user can select a author&nbsp;</div></li><li><div>    function get_editable_user_ids( $user_id, $exclude_zeros = true ) {&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $user = new WP_User( $user_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! $user-&gt;has_cap('NextGEN Manage others gallery') ) {&nbsp;</div></li><li><div>            if ( $user-&gt;has_cap('NextGEN Manage gallery') || $exclude_zeros == false )&nbsp;</div></li><li><div>                return array($user-&gt;id);&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $level_key = $wpdb-&gt;prefix . 'user_level';&nbsp;</div></li><li><div>        $query = &quot;SELECT user_id FROM $wpdb-&gt;usermeta WHERE meta_key = '$level_key'&quot;;&nbsp;</div></li><li><div>        if ( $exclude_zeros )&nbsp;</div></li><li><div>            $query .= &quot; AND meta_value != '0'&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $wpdb-&gt;get_col( $query );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function search_images() {&nbsp;</div></li><li><div>        global $nggdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty($_GET['s']) )&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        //on what ever reason I need to set again the query var&nbsp;</div></li><li><div>        set_query_var('s', $_GET['s']);&nbsp;</div></li><li><div>        $request = get_search_query();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // look now for the images&nbsp;</div></li><li><div>        $search_for_images = (array) $nggdb-&gt;search_for_images( $request );&nbsp;</div></li><li><div>        $search_for_tags = (array) nggTags::find_images_for_tags( $request , 'ASC' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // finally merge the two results together&nbsp;</div></li><li><div>        $this-&gt;search_result = array_merge( $search_for_images , $search_for_tags );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // TODO: Currently we didn't support a proper pagination&nbsp;</div></li><li><div>        $nggdb-&gt;paged['total_objects'] = $nggdb-&gt;paged['objects_per_page'] = count ($this-&gt;search_result) ;&nbsp;</div></li><li><div>        $nggdb-&gt;paged['max_objects_per_page'] = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // show pictures page&nbsp;</div></li><li><div>        $this-&gt;mode = 'edit';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display the pagination.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 1.8.0&nbsp;</div></li><li><div>     * @author taken from WP core (see includes/class-wp-list-table.php)&nbsp;</div></li><li><div>     * @return string echo the html pagination bar&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function pagination( $which, $current, $total_items, $per_page ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $total_pages = ($per_page &gt; 0) ? ceil( $total_items / $per_page ) : 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output = '&lt;span class=&quot;displaying-num&quot;&gt;' . sprintf( _n( '1 item', '%s items', $total_items ), number_format_i18n( $total_items ) ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $current_url = ( is_ssl() ? 'https://' : 'http://' ) . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $current_url = remove_query_arg( array( 'hotkeys_highlight_last', 'hotkeys_highlight_first' ), $current_url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $page_links = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $disable_first = $disable_last = '';&nbsp;</div></li><li><div>        if ( $current == 1 )&nbsp;</div></li><li><div>            $disable_first = ' disabled';&nbsp;</div></li><li><div>        if ( $current == $total_pages )&nbsp;</div></li><li><div>            $disable_last = ' disabled';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $page_links[] = sprintf( &quot;&lt;a class='%s' title='%s' href='%s'&gt;%s&lt;/a&gt;&quot;, &nbsp;</div></li><li><div>            'first-page' . $disable_first, &nbsp;</div></li><li><div>            esc_attr__( 'Go to the first page' ), &nbsp;</div></li><li><div>            nextgen_esc_url( remove_query_arg( 'paged', $current_url ) ), &nbsp;</div></li><li><div>            '&laquo;'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $page_links[] = sprintf( &quot;&lt;a class='%s' title='%s' href='%s'&gt;%s&lt;/a&gt;&quot;, &nbsp;</div></li><li><div>            'prev-page' . $disable_first, &nbsp;</div></li><li><div>            esc_attr__( 'Go to the previous page' ), &nbsp;</div></li><li><div>            nextgen_esc_url( add_query_arg( 'paged', max( 1, $current-1 ), $current_url ) ), &nbsp;</div></li><li><div>            '&lsaquo;'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( 'bottom' == $which )&nbsp;</div></li><li><div>            $html_current_page = $current;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $html_current_page = sprintf( &quot;&lt;input class='current-page' title='%s' type='text' name='%s' value='%s' size='%d' /&gt;&quot;, &nbsp;</div></li><li><div>                esc_attr__( 'Current page' ), &nbsp;</div></li><li><div>                esc_attr( 'post_paged' ), &nbsp;</div></li><li><div>                $current, &nbsp;</div></li><li><div>                strlen( $total_pages )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $html_total_pages = sprintf( &quot;&lt;span class='total-pages'&gt;%s&lt;/span&gt;&quot;, number_format_i18n( $total_pages ) );&nbsp;</div></li><li><div>        $page_links[] = '&lt;span class=&quot;paging-input&quot;&gt;' . sprintf( _x( '%1$s of %2$s', 'paging' ), $html_current_page, $html_total_pages ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $page_links[] = sprintf( &quot;&lt;a class='%s' title='%s' href='%s'&gt;%s&lt;/a&gt;&quot;, &nbsp;</div></li><li><div>            'next-page' . $disable_last, &nbsp;</div></li><li><div>            esc_attr__( 'Go to the next page' ), &nbsp;</div></li><li><div>            nextgen_esc_url( add_query_arg( 'paged', min( $total_pages, $current+1 ), $current_url ) ), &nbsp;</div></li><li><div>            '&rsaquo;'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $page_links[] = sprintf( &quot;&lt;a class='%s' title='%s' href='%s'&gt;%s&lt;/a&gt;&quot;, &nbsp;</div></li><li><div>            'last-page' . $disable_last, &nbsp;</div></li><li><div>            esc_attr__( 'Go to the last page' ), &nbsp;</div></li><li><div>            nextgen_esc_url( add_query_arg( 'paged', $total_pages, $current_url ) ), &nbsp;</div></li><li><div>            '&raquo;'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output .= &quot;\n&lt;span class='pagination-links'&gt;&quot; . join( &quot;\n&quot;, $page_links ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $total_pages )&nbsp;</div></li><li><div>            $page_class = $total_pages &lt; 2 ? ' one-page' : '';&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $page_class = ' no-pages';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pagination = &quot;&lt;div class='tablenav-pages{$page_class}'&gt;$output&lt;/div&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo $pagination;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 2.1.50</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/nextgen-gallery/2.2.3/classes/ngg_manage_gallery/" class="">2.2.3</a></li><li><a href="http://hookr.io/plugins/nextgen-gallery/2.2.2/classes/ngg_manage_gallery/" class="active">2.2.2</a></li><li><a href="http://hookr.io/plugins/nextgen-gallery/2.2.1/classes/ngg_manage_gallery/" class="">2.2.1</a></li><li><a href="http://hookr.io/plugins/nextgen-gallery/2.1.79/classes/ngg_manage_gallery/" class="">2.1.79</a></li><li><a href="http://hookr.io/plugins/nextgen-gallery/2.1.50/classes/ngg_manage_gallery/" class="">2.1.50</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>nggManageGallery</li><li><span></span>NextGEN Gallery</li><li><span></span>2.2.3</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2021 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>