<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="2.8.2" data-slug="buddypress" data-type="file" data-id="49293"><head xmlns="http://www.w3.org/1999/xhtml"><title> bp-groups-bp-groups-template | file | Buddypress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, buddypress, 2.8.2" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.24"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=6971b027c40ef4b363f4595eee84fff3' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.24' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/bp-groups-bp-groups-template/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fbp-groups-bp-groups-template%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fbp-groups-bp-groups-template%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-buddypress-2.8.2-file-bp-groups-bp-groups-template","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="bp-groups-bp-groups-template" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to buddypress." href="http://hookr.io/plugins/buddypress/" class="plugin"><span property="name">buddypress</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.8.2." href="http://hookr.io/plugins/buddypress/2.8.2/" class="H_VERSION"><span property="name">2.8.2</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/buddypress/2.8.2/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">bp-groups-bp-groups-template</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="7837"><a href="http://hookr.io/plugins/buddypress/2.8.2/all/" title="All">All <span class="count badge">7837</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/buddypress/2.8.2/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="3621"><a href="http://hookr.io/plugins/buddypress/2.8.2/hooks/" title="Hooks">Hooks <span class="count badge">3621</span></a></li><li class="" data-id="action" data-count="1727"><a href="http://hookr.io/plugins/buddypress/2.8.2/actions/" title="Actions">Actions <span class="count badge">1727</span></a></li><li class="" data-id="filter" data-count="1894"><a href="http://hookr.io/plugins/buddypress/2.8.2/filters/" title="Filters">Filters <span class="count badge">1894</span></a></li><li class="" data-id="class" data-count="181"><a href="http://hookr.io/plugins/buddypress/2.8.2/classes/" title="Classes">Classes <span class="count badge">181</span></a></li><li class="" data-id="constant" data-count="161"><a href="http://hookr.io/plugins/buddypress/2.8.2/constants/" title="Constants">Constants <span class="count badge">161</span></a></li><li class="" data-id="function" data-count="3874"><a href="http://hookr.io/plugins/buddypress/2.8.2/functions/" title="Functions">Functions <span class="count badge">3874</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/plugins/buddypress/2.8.2/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/bp-groups/bp-groups-template.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * BuddyPress Groups Template Functions.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package BuddyPress</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage GroupsTemplates</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Exit if accessed directly.</span>&nbsp;</div></li><li><div>defined( 'ABSPATH' ) || exit;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the groups component slug.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_slug() {&nbsp;</div></li><li><div>  echo bp_get_groups_slug();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the groups component slug.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_groups_slug() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the groups component slug.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $slug Groups component slug.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_groups_slug', buddypress()-&gt;groups-&gt;slug );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the groups component root slug.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_root_slug() {&nbsp;</div></li><li><div>  echo bp_get_groups_root_slug();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the groups component root slug.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_groups_root_slug() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the groups component root slug.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $root_slug Groups component root slug.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_groups_root_slug', buddypress()-&gt;groups-&gt;root_slug );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the group type base slug.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_group_type_base() {&nbsp;</div></li><li><div>  echo esc_url( bp_get_groups_group_type_base() );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the group type base slug.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * The base slug is the string used as the base prefix when generating group</span>&nbsp;</div></li><li><div><span class="comment">   * type directory URLs. For example, in example.com/groups/type/foo/, 'foo' is</span>&nbsp;</div></li><li><div><span class="comment">   * the group type and 'type' is the base slug.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_groups_group_type_base() {&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group type URL base.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $base</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_groups_group_type_base', _x( 'type', 'group type URL base', 'buddypress' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output group directory permalink.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_directory_permalink() {&nbsp;</div></li><li><div>  echo esc_url( bp_get_groups_directory_permalink() );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return group directory permalink.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_groups_directory_permalink() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group directory permalink.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Permalink for the group directory.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_groups_directory_permalink', trailingslashit( bp_get_root_domain() . '/' . bp_get_groups_root_slug() ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output group type directory permalink.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $group_type Optional. Group type.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_type_directory_permalink( $group_type = '' ) {&nbsp;</div></li><li><div>  echo esc_url( bp_get_group_type_directory_permalink( $group_type ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return group type directory permalink.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $group_type Optional. Group type. Defaults to current group type.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Group type directory URL on success, an empty string on failure.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_type_directory_permalink( $group_type = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $group_type ) {&nbsp;</div></li><li><div>          $_group_type = $group_type;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          <span class="comment">// Fall back on the current group type.</span>&nbsp;</div></li><li><div>          $_group_type = bp_get_current_group_directory_type();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $type = bp_groups_get_group_type_object( $_group_type );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Bail when member type is not found or has no directory.</span>&nbsp;</div></li><li><div>      if ( ! $type || ! $type-&gt;has_directory ) {&nbsp;</div></li><li><div>          return '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group type directory permalink.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value       Group type directory permalink.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $type        Group type object.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $member_type Group type name, as passed to the function.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_type_directory_permalink', trailingslashit( bp_get_groups_directory_permalink() . bp_get_groups_group_type_base() . '/' . $type-&gt;directory_slug ), $type, $group_type );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output group type directory link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $group_type Unique group type identifier as used in bp_groups_register_group_type().</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_type_directory_link( $group_type = '' ) {&nbsp;</div></li><li><div>  echo bp_get_group_type_directory_link( $group_type );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return group type directory link.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $group_type Unique group type identifier as used in bp_groups_register_group_type().</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_type_directory_link( $group_type = '' ) {&nbsp;</div></li><li><div>      if ( empty( $group_type ) ) {&nbsp;</div></li><li><div>          return '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return sprintf( '&lt;a href=&quot;%s&quot;&gt;%s&lt;/a&gt;', esc_url( bp_get_group_type_directory_permalink( $group_type ) ), bp_groups_get_group_type_object( $group_type )-&gt;labels['name'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output a comma-delimited list of group types.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> * @see   bp_get_group_type_list() for parameter documentation.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_type_list( $group_id = 0, $r = array() ) {&nbsp;</div></li><li><div>  echo bp_get_group_type_list( $group_id, $r );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return a comma-delimited list of group types.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $group_id Group ID. Defaults to current group ID if on a group page.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment">   *     Array of parameters. All items are optional.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string $parent_element Element to wrap around the list. Defaults to 'p'.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type array  $parent_attr    Element attributes for parent element. Defaults to</span>&nbsp;</div></li><li><div><span class="comment">   *                                  array( 'class' =&gt; 'bp-group-type-list' ).</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string $label          Label to add before the list. Defaults to 'Group Types:'.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string $label_element  Element to wrap around the label. Defaults to 'strong'.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type array  $label_attr     Element attributes for label element. Defaults to array().</span>&nbsp;</div></li><li><div><span class="comment">   *     @type bool   $show_all       Whether to show all registered group types. Defaults to 'false'. If</span>&nbsp;</div></li><li><div><span class="comment">   *                                 'false', only shows group types with the 'show_in_list' parameter set to</span>&nbsp;</div></li><li><div><span class="comment">   *                                  true. See bp_groups_register_group_type() for more info.</span>&nbsp;</div></li><li><div><span class="comment">   * }</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_type_list( $group_id = 0, $r = array() ) {&nbsp;</div></li><li><div>      if ( empty( $group_id ) ) {&nbsp;</div></li><li><div>          $group_id = bp_get_current_group_id();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r = bp_parse_args( $r, array(&nbsp;</div></li><li><div>          'parent_element' =&gt; 'p', &nbsp;</div></li><li><div>          'parent_attr' =&gt; array(&nbsp;</div></li><li><div>               'class' =&gt; 'bp-group-type-list', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>          'label' =&gt; __( 'Group Types:', 'buddypress' ), &nbsp;</div></li><li><div>          'label_element' =&gt; 'strong', &nbsp;</div></li><li><div>          'label_attr' =&gt; array(), &nbsp;</div></li><li><div>          'show_all' =&gt; false, &nbsp;</div></li><li><div> ), 'group_type_list' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $retval = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $types = bp_groups_get_group_type( $group_id, false ) ) {&nbsp;</div></li><li><div>          <span class="comment">// Make sure we can show the type in the list.</span>&nbsp;</div></li><li><div>          if ( false === $r['show_all'] ) {&nbsp;</div></li><li><div>              $types = array_intersect( bp_groups_get_group_types( array( 'show_in_list' =&gt; true ) ), $types );&nbsp;</div></li><li><div>              if ( empty( $types ) ) {&nbsp;</div></li><li><div>                  return $retval;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $before = $after = $label = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Render parent element.</span>&nbsp;</div></li><li><div>          if ( ! empty( $r['parent_element'] ) ) {&nbsp;</div></li><li><div>              $parent_elem = new BP_Core_HTML_Element( array(&nbsp;</div></li><li><div>                  'element' =&gt; $r['parent_element'], &nbsp;</div></li><li><div>                  'attr' =&gt; $r['parent_attr']&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Set before and after.</span>&nbsp;</div></li><li><div>              $before = $parent_elem-&gt;get( 'open_tag' );&nbsp;</div></li><li><div>              $after = $parent_elem-&gt;get( 'close_tag' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Render label element.</span>&nbsp;</div></li><li><div>          if ( ! empty( $r['label_element'] ) ) {&nbsp;</div></li><li><div>              $label = new BP_Core_HTML_Element( array(&nbsp;</div></li><li><div>                  'element' =&gt; $r['label_element'], &nbsp;</div></li><li><div>                  'attr' =&gt; $r['label_attr'], &nbsp;</div></li><li><div>                  'inner_html' =&gt; esc_html( $r['label'] )&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>              $label = $label-&gt;contents() . ' ';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// No element, just the label.</span>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $label = esc_html( $r['label'] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Comma-delimit each type into the group type directory link.</span>&nbsp;</div></li><li><div>          $label .= implode( ', ', array_map( 'bp_get_group_type_directory_link', $types ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Retval time!</span>&nbsp;</div></li><li><div>          $retval = $before . $label . $after;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $retval;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Start the Groups Template Loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.6.0 Added `$group_type`, `$group_type__in`, and `$group_type__not_in` parameters.</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0 Added `$update_admin_cache` parameter.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     Array of parameters. All items are optional.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string       $type               Shorthand for certain orderby/order combinations. 'newest', 'active', </span>&nbsp;</div></li><li><div><span class="comment"> *                                            'popular', 'alphabetical', 'random'. When present, will override</span>&nbsp;</div></li><li><div><span class="comment"> *                                            orderby and order params. Default: null.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string       $order              Sort order. 'ASC' or 'DESC'. Default: 'DESC'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string       $orderby            Property to sort by. 'date_created', 'last_activity', </span>&nbsp;</div></li><li><div><span class="comment"> *                                            'total_member_count', 'name', 'random'. Default: 'last_activity'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int          $page               Page offset of results to return. Default: 1 (first page of results).</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int          $per_page           Number of items to return per page of results. Default: 20.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int          $max                Does NOT affect query. May change the reported number of total groups</span>&nbsp;</div></li><li><div><span class="comment"> *                                            found, but not the actual number of found groups. Default: false.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type bool         $show_hidden        Whether to include hidden groups in results. Default: false.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string       $page_arg           Query argument used for pagination. Default: 'grpage'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int          $user_id            If provided, results will be limited to groups of which the specified</span>&nbsp;</div></li><li><div><span class="comment"> *                                            user is a member. Default: value of bp_displayed_user_id().</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string       $slug               If provided, only the group with the matching slug will be returned.</span>&nbsp;</div></li><li><div><span class="comment"> *                                            Default: false.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string       $search_terms       If provided, only groups whose names or descriptions match the search</span>&nbsp;</div></li><li><div><span class="comment"> *                                            terms will be returned. Default: value of `$_REQUEST['groups_search']` or</span>&nbsp;</div></li><li><div><span class="comment"> *                                            `$_REQUEST['s']`, if present. Otherwise false.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type array|string $group_type         Array or comma-separated list of group types to limit results to.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type array|string $group_type__in     Array or comma-separated list of group types to limit results to.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type array|string $group_type__not_in Array or comma-separated list of group types that will be</span>&nbsp;</div></li><li><div><span class="comment"> *                                            excluded from results.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type array        $meta_query         An array of meta_query conditions.</span>&nbsp;</div></li><li><div><span class="comment"> *                                            See {@link WP_Meta_Query::queries} for description.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type array|string $include            Array or comma-separated list of group IDs. Results will be limited</span>&nbsp;</div></li><li><div><span class="comment"> *                                            to groups within the list. Default: false.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type array|string $exclude            Array or comma-separated list of group IDs. Results will exclude</span>&nbsp;</div></li><li><div><span class="comment"> *                                            the listed groups. Default: false.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type array|string $parent_id          Array or comma-separated list of group IDs. Results will include only</span>&nbsp;</div></li><li><div><span class="comment"> *                                            child groups of the listed groups. Default: null.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type bool         $update_meta_cache  Whether to fetch groupmeta for queried groups. Default: true.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type bool         $update_admin_cache Whether to pre-fetch group admins for queried groups.</span>&nbsp;</div></li><li><div><span class="comment"> *                                            Defaults to true when on a group directory, where this</span>&nbsp;</div></li><li><div><span class="comment"> *                                            information is needed in the loop. Otherwise false.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if there are groups to display that match the params</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_has_groups( $args = '' ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Defaults based on the current page & overridden by parsed $args</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $slug = false;&nbsp;</div></li><li><div>  $type = '';&nbsp;</div></li><li><div>  $search_terms = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// When looking your own groups, check for two action variables.</span>&nbsp;</div></li><li><div>  if ( bp_is_current_action( 'my-groups' ) ) {&nbsp;</div></li><li><div>      if ( bp_is_action_variable( 'most-popular', 0 ) ) {&nbsp;</div></li><li><div>          $type = 'popular';&nbsp;</div></li><li><div>      } elseif ( bp_is_action_variable( 'alphabetically', 0 ) ) {&nbsp;</div></li><li><div>          $type = 'alphabetical';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// When looking at invites, set type to invites.</span>&nbsp;</div></li><li><div>  } elseif ( bp_is_current_action( 'invites' ) ) {&nbsp;</div></li><li><div>      $type = 'invites';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// When looking at a single group, set the type and slug.</span>&nbsp;</div></li><li><div>  } elseif ( bp_get_current_group_slug() ) {&nbsp;</div></li><li><div>      $type = 'single-group';&nbsp;</div></li><li><div>      $slug = bp_get_current_group_slug();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $group_type = bp_get_current_group_directory_type();&nbsp;</div></li><li><div>  if ( ! $group_type && ! empty( $_GET['group_type'] ) ) {&nbsp;</div></li><li><div>      if ( is_array( $_GET['group_type'] ) ) {&nbsp;</div></li><li><div>          $group_type = $_GET['group_type'];&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          <span class="comment">// Can be a comma-separated list.</span>&nbsp;</div></li><li><div>          $group_type = explode( ', ', $_GET['group_type'] );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Default search string (too soon to escape here).</span>&nbsp;</div></li><li><div>  $search_query_arg = bp_core_get_component_search_query_arg( 'groups' );&nbsp;</div></li><li><div>  if ( ! empty( $_REQUEST[ $search_query_arg ] ) ) {&nbsp;</div></li><li><div>      $search_terms = stripslashes( $_REQUEST[ $search_query_arg ] );&nbsp;</div></li><li><div>  } elseif ( ! empty( $_REQUEST['group-filter-box'] ) ) {&nbsp;</div></li><li><div>      $search_terms = $_REQUEST['group-filter-box'];&nbsp;</div></li><li><div>  } elseif ( !empty( $_REQUEST['s'] ) ) {&nbsp;</div></li><li><div>      $search_terms = $_REQUEST['s'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Parse defaults and requested arguments.</span>&nbsp;</div></li><li><div>  $r = bp_parse_args( $args, array(&nbsp;</div></li><li><div>      'type' =&gt; $type, &nbsp;</div></li><li><div>      'order' =&gt; 'DESC', &nbsp;</div></li><li><div>      'orderby' =&gt; 'last_activity', &nbsp;</div></li><li><div>      'page' =&gt; 1, &nbsp;</div></li><li><div>      'per_page' =&gt; 20, &nbsp;</div></li><li><div>      'max' =&gt; false, &nbsp;</div></li><li><div>      'show_hidden' =&gt; false, &nbsp;</div></li><li><div>      'page_arg' =&gt; 'grpage', &nbsp;</div></li><li><div>      'user_id' =&gt; bp_displayed_user_id(), &nbsp;</div></li><li><div>      'slug' =&gt; $slug, &nbsp;</div></li><li><div>      'search_terms' =&gt; $search_terms, &nbsp;</div></li><li><div>      'group_type' =&gt; $group_type, &nbsp;</div></li><li><div>      'group_type__in' =&gt; '', &nbsp;</div></li><li><div>      'group_type__not_in' =&gt; '', &nbsp;</div></li><li><div>      'meta_query' =&gt; false, &nbsp;</div></li><li><div>      'include' =&gt; false, &nbsp;</div></li><li><div>      'exclude' =&gt; false, &nbsp;</div></li><li><div>      'parent_id' =&gt; null, &nbsp;</div></li><li><div>      'update_meta_cache' =&gt; true, &nbsp;</div></li><li><div>      'update_admin_cache' =&gt; bp_is_groups_directory() || bp_is_user_groups(), &nbsp;</div></li><li><div> ), 'has_groups' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Setup the Groups template global.</span>&nbsp;</div></li><li><div>  $groups_template = new BP_Groups_Template( array(&nbsp;</div></li><li><div>      'type' =&gt; $r['type'], &nbsp;</div></li><li><div>      'order' =&gt; $r['order'], &nbsp;</div></li><li><div>      'orderby' =&gt; $r['orderby'], &nbsp;</div></li><li><div>      'page' =&gt; (int) $r['page'], &nbsp;</div></li><li><div>      'per_page' =&gt; (int) $r['per_page'], &nbsp;</div></li><li><div>      'max' =&gt; (int) $r['max'], &nbsp;</div></li><li><div>      'show_hidden' =&gt; $r['show_hidden'], &nbsp;</div></li><li><div>      'page_arg' =&gt; $r['page_arg'], &nbsp;</div></li><li><div>      'user_id' =&gt; (int) $r['user_id'], &nbsp;</div></li><li><div>      'slug' =&gt; $r['slug'], &nbsp;</div></li><li><div>      'search_terms' =&gt; $r['search_terms'], &nbsp;</div></li><li><div>      'group_type' =&gt; $r['group_type'], &nbsp;</div></li><li><div>      'group_type__in' =&gt; $r['group_type__in'], &nbsp;</div></li><li><div>      'group_type__not_in' =&gt; $r['group_type__not_in'], &nbsp;</div></li><li><div>      'meta_query' =&gt; $r['meta_query'], &nbsp;</div></li><li><div>      'include' =&gt; $r['include'], &nbsp;</div></li><li><div>      'exclude' =&gt; $r['exclude'], &nbsp;</div></li><li><div>      'parent_id' =&gt; $r['parent_id'], &nbsp;</div></li><li><div>      'update_meta_cache' =&gt; (bool) $r['update_meta_cache'], &nbsp;</div></li><li><div>      'update_admin_cache' =&gt; (bool) $r['update_admin_cache'], &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether or not there are groups to iterate over for the groups loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool               $value           Whether or not there are groups to iterate over.</span>&nbsp;</div></li><li><div><span class="comment">   * @param BP_Groups_Template $groups_template BP_Groups_Template object based on parsed arguments.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array              $r               Array of parsed arguments for the query.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_has_groups', $groups_template-&gt;has_groups(), $groups_template, $r );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check whether there are more groups to iterate over.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups() {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>  return $groups_template-&gt;groups();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Set up the current group inside the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return object</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_the_group() {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>  return $groups_template-&gt;the_group();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Is the group visible to the currently logged-in user?</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param BP_Groups_Group $group Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_is_visible( $group = null ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( bp_current_user_can( 'bp_moderate' ) ) {&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'public' == $group-&gt;status ) {&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      if ( groups_is_user_member( bp_loggedin_user_id(), $group-&gt;id ) ) {&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the ID of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_id( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_id( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the ID of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return int</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_id( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the ID of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param int    $id    ID of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_id', $group-&gt;id, $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the row class of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $classes Array of custom classes.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_class( $classes = array() ) {&nbsp;</div></li><li><div>  echo bp_get_group_class( $classes );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the row class of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $classes Array of custom classes.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Row class of the group.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_class( $classes = array() ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add even/odd classes, but only if there's more than 1 group.</span>&nbsp;</div></li><li><div>      if ( $groups_template-&gt;group_count &gt; 1 ) {&nbsp;</div></li><li><div>          $pos_in_loop = (int) $groups_template-&gt;current_group;&nbsp;</div></li><li><div>          $classes[] = ( $pos_in_loop % 2 ) ? 'even' : 'odd';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If we've only one group in the loop, don't bother with odd and even.</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $classes[] = 'bp-single-group';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Group type - public, private, hidden.</span>&nbsp;</div></li><li><div>      $classes[] = sanitize_key( $groups_template-&gt;group-&gt;status );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add current group types.</span>&nbsp;</div></li><li><div>      if ( $group_types = bp_groups_get_group_type( bp_get_group_id(), false ) ) {&nbsp;</div></li><li><div>          foreach ( $group_types as $group_type ) {&nbsp;</div></li><li><div>              $classes[] = sprintf( 'group-type-%s', esc_attr( $group_type ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// User's group role.</span>&nbsp;</div></li><li><div>      if ( bp_is_user_active() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Admin.</span>&nbsp;</div></li><li><div>          if ( bp_group_is_admin() ) {&nbsp;</div></li><li><div>              $classes[] = 'is-admin';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Moderator.</span>&nbsp;</div></li><li><div>          if ( bp_group_is_mod() ) {&nbsp;</div></li><li><div>              $classes[] = 'is-mod';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Member.</span>&nbsp;</div></li><li><div>          if ( bp_group_is_member() ) {&nbsp;</div></li><li><div>              $classes[] = 'is-member';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Whether a group avatar will appear.</span>&nbsp;</div></li><li><div>      if ( bp_disable_group_avatar_uploads() || ! buddypress()-&gt;avatar-&gt;show_avatars ) {&nbsp;</div></li><li><div>          $classes[] = 'group-no-avatar';&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $classes[] = 'group-has-avatar';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters classes that will be applied to row class of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $classes Array of determined classes for the row.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $classes = apply_filters( 'bp_get_group_class', $classes );&nbsp;</div></li><li><div>      $classes = array_merge( $classes, array() );&nbsp;</div></li><li><div>      $retval = 'class=&quot;' . join( ' ', $classes ) . '&quot;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $retval;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the name of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_name( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_name( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the name of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_name( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the name of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $name  Name of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_name', $group-&gt;name, $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the type of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_type( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_type( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Get the type of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_get_group_type( $group = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'public' == $group-&gt;status ) {&nbsp;</div></li><li><div>      $type = __( &quot;Public Group&quot;, 'buddypress' );&nbsp;</div></li><li><div>  } elseif ( 'hidden' == $group-&gt;status ) {&nbsp;</div></li><li><div>      $type = __( &quot;Hidden Group&quot;, 'buddypress' );&nbsp;</div></li><li><div>  } elseif ( 'private' == $group-&gt;status ) {&nbsp;</div></li><li><div>      $type = __( &quot;Private Group&quot;, 'buddypress' );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $type = ucwords( $group-&gt;status ) . ' ' . __( 'Group', 'buddypress' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the type for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $type  Type for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_get_group_type', $type, $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the status of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_status( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_status( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the status of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_status( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the status of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $status Status of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group  Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_status', $group-&gt;status, $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the group avatar while in the groups loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment"> *      See {@link bp_get_group_avatar()} for description of arguments.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_avatar( $args = '' ) {&nbsp;</div></li><li><div>  echo bp_get_group_avatar( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get a group's avatar.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @see bp_core_fetch_avatar() For a description of arguments and return values.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment">   *     Arguments are listed here with an explanation of their defaults.</span>&nbsp;</div></li><li><div><span class="comment">   *     For more information about the arguments, see {@link bp_core_fetch_avatar()}.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string   $alt     Default: 'Group logo of [group name]'.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string   $class   Default: 'avatar'.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string   $type    Default: 'full'.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type int|bool $width   Default: false.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type int|bool $height  Default: false.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type bool     $id      Passed to `$css_id` parameter.</span>&nbsp;</div></li><li><div><span class="comment">   * }</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Group avatar string.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_avatar( $args = '' ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Bail if avatars are turned off.</span>&nbsp;</div></li><li><div>      if ( bp_disable_group_avatar_uploads() || ! buddypress()-&gt;avatar-&gt;show_avatars ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Parse the arguments.</span>&nbsp;</div></li><li><div>      $r = bp_parse_args( $args, array(&nbsp;</div></li><li><div>          'type' =&gt; 'full', &nbsp;</div></li><li><div>          'width' =&gt; false, &nbsp;</div></li><li><div>          'height' =&gt; false, &nbsp;</div></li><li><div>          'class' =&gt; 'avatar', &nbsp;</div></li><li><div>          'id' =&gt; false, &nbsp;</div></li><li><div>          'alt' =&gt; sprintf( __( 'Group logo of %s', 'buddypress' ), $groups_template-&gt;group-&gt;name )&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Fetch the avatar from the folder.</span>&nbsp;</div></li><li><div>      $avatar = bp_core_fetch_avatar( array(&nbsp;</div></li><li><div>          'item_id' =&gt; $groups_template-&gt;group-&gt;id, &nbsp;</div></li><li><div>          'avatar_dir' =&gt; 'group-avatars', &nbsp;</div></li><li><div>          'object' =&gt; 'group', &nbsp;</div></li><li><div>          'type' =&gt; $r['type'], &nbsp;</div></li><li><div>          'alt' =&gt; $r['alt'], &nbsp;</div></li><li><div>          'css_id' =&gt; $r['id'], &nbsp;</div></li><li><div>          'class' =&gt; $r['class'], &nbsp;</div></li><li><div>          'width' =&gt; $r['width'], &nbsp;</div></li><li><div>          'height' =&gt; $r['height'], &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If No avatar found, provide some backwards compatibility.</span>&nbsp;</div></li><li><div>      if ( empty( $avatar ) ) {&nbsp;</div></li><li><div>          $avatar = '&lt;img src=&quot;' . esc_url( $groups_template-&gt;group-&gt;avatar_thumb ) . '&quot; class=&quot;avatar&quot; alt=&quot;' . esc_attr( $groups_template-&gt;group-&gt;name ) . '&quot; /&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group avatar while in the groups loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $avatar HTML image element holding the group avatar.</span>&nbsp;</div></li><li><div><span class="comment">       * @param array  $r      Array of parsed arguments for the group avatar.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_avatar', $avatar, $r );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the group avatar thumbnail while in the groups loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_avatar_thumb( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_avatar_thumb( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the group avatar thumbnail while in the groups loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_avatar_thumb( $group = false ) {&nbsp;</div></li><li><div>      return bp_get_group_avatar( array(&nbsp;</div></li><li><div>          'type' =&gt; 'thumb', &nbsp;</div></li><li><div>          'id' =&gt; ! empty( $group-&gt;id ) ? $group-&gt;id : false&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the miniature group avatar thumbnail while in the groups loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_avatar_mini( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_avatar_mini( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the miniature group avatar thumbnail while in the groups loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_avatar_mini( $group = false ) {&nbsp;</div></li><li><div>      return bp_get_group_avatar( array(&nbsp;</div></li><li><div>          'type' =&gt; 'thumb', &nbsp;</div></li><li><div>          'width' =&gt; 30, &nbsp;</div></li><li><div>          'height' =&gt; 30, &nbsp;</div></li><li><div>          'id' =&gt; ! empty( $group-&gt;id ) ? $group-&gt;id : false&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Group cover image *********************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Should we use the group's cover image header.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.4.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if the displayed user has a cover image, </span>&nbsp;</div></li><li><div><span class="comment"> *              False otherwise</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_use_cover_image_header() {&nbsp;</div></li><li><div>  return (bool) bp_is_active( 'groups', 'cover_image' ) && ! bp_disable_group_cover_image_uploads() && bp_attachments_is_wp_version_supported();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the 'last active' string for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0 Added $args as a parameter.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool  $group Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args Optional. {@see bp_get_group_last_active()}.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_last_active( $group = false, $args = array() ) {&nbsp;</div></li><li><div>  echo bp_get_group_last_active( $group, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the 'last active' string for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0 Added $args as a parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool  $group Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment">   *     Array of optional parameters.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   *     @type bool $relative Optional. If true, returns relative activity date. eg. active 5 months ago.</span>&nbsp;</div></li><li><div><span class="comment">   *                          If false, returns active date value from database. Default: true.</span>&nbsp;</div></li><li><div><span class="comment">   * }</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_last_active( $group = false, $args = array() ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r = wp_parse_args( $args, array(&nbsp;</div></li><li><div>          'relative' =&gt; true, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $last_active = $group-&gt;last_activity;&nbsp;</div></li><li><div>      if ( ! $last_active ) {&nbsp;</div></li><li><div>          $last_active = groups_get_groupmeta( $group-&gt;id, 'last_activity' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// We do not want relative time, so return now.</span></span></span>&nbsp;</div></li><li><div>      <span class="comment">// @todo Should the 'bp_get_group_last_active' filter be applied here?</span>&nbsp;</div></li><li><div>      if ( ! $r['relative'] ) {&nbsp;</div></li><li><div>          return esc_attr( $last_active );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $last_active ) ) {&nbsp;</div></li><li><div>          return __( 'not yet active', 'buddypress' );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Filters the 'last active' string for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">           * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param string $value Determined last active value for the current group.</span>&nbsp;</div></li><li><div><span class="comment">           * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          return apply_filters( 'bp_get_group_last_active', bp_core_time_since( $last_active ), $group );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the permalink for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param BP_Groups_Group $group Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_permalink( $group = null ) {&nbsp;</div></li><li><div>  echo bp_get_group_permalink( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the permalink for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param BP_Groups_Group $group Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_permalink( $group = null ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the permalink for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Permalink for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_permalink', trailingslashit( bp_get_groups_directory_permalink() . bp_get_group_slug( $group ) . '/' ), $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the permalink for the admin section of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_admin_permalink( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_admin_permalink( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the permalink for the admin section of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_admin_permalink( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the permalink for the admin section of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Permalink for the admin section of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_admin_permalink', trailingslashit( bp_get_group_permalink( $group ) . 'admin' ), $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return the slug for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_slug( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_slug( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the slug for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_slug( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the slug for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $slug  Slug for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_slug', $group-&gt;slug, $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the description for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_description( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_description( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the description for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_description( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the description for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Description for the current group.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_description', stripslashes( $group-&gt;description ), $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the description for the current group in the loop, for use in a textarea.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_description_editable( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_description_editable( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the permalink for the current group in the loop, for use in a textarea.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * 'bp_get_group_description_editable' does not have the formatting</span>&nbsp;</div></li><li><div><span class="comment">   * filters that 'bp_get_group_description' has, which makes it</span>&nbsp;</div></li><li><div><span class="comment">   * appropriate for &quot;raw&quot; editing.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_description_editable( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the permalink for the current group in the loop, for use in a textarea.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * 'bp_get_group_description_editable' does not have the formatting filters that</span>&nbsp;</div></li><li><div><span class="comment">       * 'bp_get_group_description' has, which makes it appropriate for &quot;raw&quot; editing.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $description Description for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group       Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_description_editable', $group-&gt;description, $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output an excerpt of the group description.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. The group being referenced.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Defaults to the group currently being</span>&nbsp;</div></li><li><div><span class="comment"> *                           iterated on in the groups loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_description_excerpt( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_description_excerpt( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get an excerpt of a group description.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. The group being referenced.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Defaults to the group currently being</span>&nbsp;</div></li><li><div><span class="comment">   *                           iterated on in the groups loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Excerpt.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_description_excerpt( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the excerpt of a group description.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Excerpt of a group description.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Object for group whose description is made into an excerpt.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_description_excerpt', bp_create_excerpt( $group-&gt;description ), $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the status of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Either 'Public' or 'Private'.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_public_status( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_public_status( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the status of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Either 'Public' or 'Private'.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_public_status( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $group-&gt;is_public ) {&nbsp;</div></li><li><div>          return __( 'Public', 'buddypress' );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          return __( 'Private', 'buddypress' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output whether the current group in the loop is public.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * No longer used in BuddyPress.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_is_public( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_is_public( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return whether the current group in the loop is public.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * No longer used in BuddyPress.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_is_public( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters whether the current group in the loop is public.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param bool   $public True if the group is public.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_is_public', $group-&gt;is_public, $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the created date of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0 Added $args as a parameter.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool  $group Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args  {@see bp_get_group_date_created()}.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_date_created( $group = false, $args = array() ) {&nbsp;</div></li><li><div>  echo bp_get_group_date_created( $group, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the created date of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0 Added $args as a parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool  $group Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment">   *     Array of optional parameters.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   *     @type bool $relative Optional. If true, returns relative created date. eg. active 5 months ago.</span>&nbsp;</div></li><li><div><span class="comment">   *                          If false, returns created date value from database. Default: true.</span>&nbsp;</div></li><li><div><span class="comment">   * }</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_date_created( $group = false, $args = array() ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r = wp_parse_args( $args, array(&nbsp;</div></li><li><div>          'relative' =&gt; true, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// We do not want relative time, so return now.</span></span></span>&nbsp;</div></li><li><div>      <span class="comment">// @todo Should the 'bp_get_group_date_created' filter be applied here?</span>&nbsp;</div></li><li><div>      if ( ! $r['relative'] ) {&nbsp;</div></li><li><div>          return esc_attr( $group-&gt;date_created );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the created date of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Created date for the current group.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_date_created', bp_core_time_since( $group-&gt;date_created ), $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the username of the creator of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_creator_username( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_creator_username( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the username of the creator of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_creator_username( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the username of the creator of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Username of the group creator.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_creator_username', bp_core_get_user_displayname( $group-&gt;creator_id ), $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the user ID of the creator of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_creator_id( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_creator_id( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the user ID of the creator of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return int</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_creator_id( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the user ID of the creator of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param int $creator_id User ID of the group creator.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_creator_id', $group-&gt;creator_id, $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the permalink of the creator of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_creator_permalink( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_creator_permalink( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the permalink of the creator of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_creator_permalink( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the permalink of the creator of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Permalink of the group creator.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_creator_permalink', bp_core_get_user_domain( $group-&gt;creator_id ), $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determine whether a user is the creator of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param BP_Groups_Group $group   Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int             $user_id ID of the user.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_is_group_creator( $group = null, $user_id = 0 ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $user_id ) ) {&nbsp;</div></li><li><div>      $user_id = bp_loggedin_user_id();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) ( $group-&gt;creator_id == $user_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the avatar of the creator of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @param array       $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     Array of optional arguments. See {@link bp_get_group_creator_avatar()}</span>&nbsp;</div></li><li><div><span class="comment"> *     for description.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_creator_avatar( $group = false, $args = array() ) {&nbsp;</div></li><li><div>  echo bp_get_group_creator_avatar( $group, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the avatar of the creator of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array       $args {</span>&nbsp;</div></li><li><div><span class="comment">   *     Array of optional arguments. See {@link bp_core_fetch_avatar()}</span>&nbsp;</div></li><li><div><span class="comment">   *     for detailed description of arguments.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string $type   Default: 'full'.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type int    $width  Default: false.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type int    $height Default: false.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type int    $class  Default: 'avatar'.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string $id     Passed to 'css_id'. Default: false.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string $alt    Alt text. Default: 'Group creator profile</span>&nbsp;</div></li><li><div><span class="comment">   *                          photo of [user display name]'.</span>&nbsp;</div></li><li><div><span class="comment">   * }</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_creator_avatar( $group = false, $args = array() ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $defaults = array(&nbsp;</div></li><li><div>          'type' =&gt; 'full', &nbsp;</div></li><li><div>          'width' =&gt; false, &nbsp;</div></li><li><div>          'height' =&gt; false, &nbsp;</div></li><li><div>          'class' =&gt; 'avatar', &nbsp;</div></li><li><div>          'id' =&gt; false, &nbsp;</div></li><li><div>          'alt' =&gt; sprintf( __( 'Group creator profile photo of %s', 'buddypress' ), bp_core_get_user_displayname( $group-&gt;creator_id ) )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r = wp_parse_args( $args, $defaults );&nbsp;</div></li><li><div>      extract( $r, EXTR_SKIP );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $avatar = bp_core_fetch_avatar( array( 'item_id' =&gt; $group-&gt;creator_id, 'type' =&gt; $type, 'css_id' =&gt; $id, 'class' =&gt; $class, 'width' =&gt; $width, 'height' =&gt; $height, 'alt' =&gt; $alt ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the avatar of the creator of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.7.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $avatar Avatar of the group creator.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group  Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_creator_avatar', $avatar, $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determine whether the current user is the admin of the current group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Alias of {@link bp_is_item_admin()}.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_is_admin() {&nbsp;</div></li><li><div>  return bp_is_item_admin();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determine whether the current user is a mod of the current group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Alias of {@link bp_is_item_mod()}.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_is_mod() {&nbsp;</div></li><li><div>  return bp_is_item_mod();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output markup listing group admins.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_list_admins( $group = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $group-&gt;admins ) ) { ?&gt;&nbsp;</div></li><li><div>      &lt;ul id=&quot;group-admins&quot;&gt;&nbsp;</div></li><li><div>          &lt;?php foreach( (array) $group-&gt;admins as $admin ) { ?&gt;&nbsp;</div></li><li><div>              &lt;li&gt;&nbsp;</div></li><li><div>                  &lt;a href=&quot;&lt;?php echo bp_core_get_user_domain( $admin-&gt;user_id, $admin-&gt;user_nicename, $admin-&gt;user_login ) ?&gt;&quot;&gt;&lt;?php echo bp_core_fetch_avatar( array( 'item_id' =&gt; $admin-&gt;user_id, 'email' =&gt; $admin-&gt;user_email, 'alt' =&gt; sprintf( __( 'Profile picture of %s', 'buddypress' ), bp_core_get_user_displayname( $admin-&gt;user_id ) ) ) ) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>              &lt;/li&gt;&nbsp;</div></li><li><div>          &lt;?php } ?&gt;&nbsp;</div></li><li><div>      &lt;/ul&gt;&nbsp;</div></li><li><div>  &lt;?php } else { ?&gt;&nbsp;</div></li><li><div>      &lt;span class=&quot;activity&quot;&gt;&lt;?php _e( 'No Admins', 'buddypress' ) ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>  &lt;?php } ?&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output markup listing group mod.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_list_mods( $group = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $group-&gt;mods ) ) : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;ul id=&quot;group-mods&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php foreach( (array) $group-&gt;mods as $mod ) { ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;li&gt;&nbsp;</div></li><li><div>                  &lt;a href=&quot;&lt;?php echo bp_core_get_user_domain( $mod-&gt;user_id, $mod-&gt;user_nicename, $mod-&gt;user_login ) ?&gt;&quot;&gt;&lt;?php echo bp_core_fetch_avatar( array( 'item_id' =&gt; $mod-&gt;user_id, 'email' =&gt; $mod-&gt;user_email, 'alt' =&gt; sprintf( __( 'Profile picture of %s', 'buddypress' ), bp_core_get_user_displayname( $mod-&gt;user_id ) ) ) ) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>              &lt;/li&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php } ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;/ul&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php else : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;span class=&quot;activity&quot;&gt;&lt;?php _e( 'No Mods', 'buddypress' ) ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return a list of user IDs for a group's admins.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param BP_Groups_Group|bool $group     Optional. The group being queried. Defaults</span>&nbsp;</div></li><li><div><span class="comment"> *                                        to the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string               $format    Optional. 'string' to get a comma-separated string, </span>&nbsp;</div></li><li><div><span class="comment"> *                                        'array' to get an array.</span>&nbsp;</div></li><li><div><span class="comment"> * @return mixed               $admin_ids A string or array of user IDs.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_admin_ids( $group = false, $format = 'string' ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $admin_ids = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $group-&gt;admins ) {&nbsp;</div></li><li><div>      foreach( $group-&gt;admins as $admin ) {&nbsp;</div></li><li><div>          $admin_ids[] = $admin-&gt;user_id;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'string' == $format ) {&nbsp;</div></li><li><div>      $admin_ids = implode( ', ', $admin_ids );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters a list of user IDs for a group's admins.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * This filter may return either an array or a comma separated string.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $admin_ids List of user IDs for a group's admins.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object       $group     Group object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_group_admin_ids', $admin_ids, $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return a list of user IDs for a group's moderators.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param BP_Groups_Group|bool $group   Optional. The group being queried.</span>&nbsp;</div></li><li><div><span class="comment"> *                                      Defaults to the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string               $format  Optional. 'string' to get a comma-separated string, </span>&nbsp;</div></li><li><div><span class="comment"> *                                      'array' to get an array.</span>&nbsp;</div></li><li><div><span class="comment"> * @return mixed               $mod_ids A string or array of user IDs.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_mod_ids( $group = false, $format = 'string' ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $mod_ids = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $group-&gt;mods ) {&nbsp;</div></li><li><div>      foreach( $group-&gt;mods as $mod ) {&nbsp;</div></li><li><div>          $mod_ids[] = $mod-&gt;user_id;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'string' == $format ) {&nbsp;</div></li><li><div>      $mod_ids = implode( ', ', $mod_ids );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters a list of user IDs for a group's moderators.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * This filter may return either an array or a comma separated string.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $admin_ids List of user IDs for a group's moderators.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object       $group     Group object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_group_mod_ids', $mod_ids, $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the permalink of the current group's Members page.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_all_members_permalink() {&nbsp;</div></li><li><div>  echo bp_get_group_all_members_permalink();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the permalink of the Members page of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_all_members_permalink( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the permalink of the Members page for the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Permalink of the Members page for the current group.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_all_members_permalink', bp_get_group_permalink( $group ) . 'members', $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Display a Groups search form.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * No longer used in BuddyPress.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @todo Deprecate.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_search_form() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $action = bp_displayed_user_domain() . bp_get_groups_slug() . '/my-groups/search/';&nbsp;</div></li><li><div>  $label = __('Filter Groups', 'buddypress');&nbsp;</div></li><li><div>  $name = 'group-filter-box';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $search_form_html = '&lt;form action=&quot;' . $action . '&quot; id=&quot;group-search-form&quot; method=&quot;post&quot;&gt;&nbsp;</div></li><li><div>      &lt;label for=&quot;'. $name .'&quot; id=&quot;'. $name .'-label&quot;&gt;'. $label .'&lt;/label&gt;&nbsp;</div></li><li><div>      &lt;input type=&quot;search&quot; name=&quot;'. $name . '&quot; id=&quot;'. $name .'&quot; value=&quot;'. $value .'&quot;'.  $disabled .' /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      '. wp_nonce_field( 'group-filter-box', '_wpnonce_group_filter', true, false ) .'&nbsp;</div></li><li><div>      &lt;/form&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'bp_group_search_form', $search_form_html );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determine whether the displayed user has no groups.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * No longer used in BuddyPress.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @todo Deprecate.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if the displayed user has no groups, otherwise false.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_show_no_groups_message() {&nbsp;</div></li><li><div>  if ( !groups_total_groups_for_user( bp_displayed_user_id() ) ) {&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determine whether the current page is a group activity permalink.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * No longer used in BuddyPress.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @todo Deprecate.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if this is a group activity permalink, otherwise false.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_is_activity_permalink() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !bp_is_single_item() || !bp_is_groups_component() || !bp_is_current_action( bp_get_activity_slug() ) ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return true;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the pagination HTML for a group loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_pagination_links() {&nbsp;</div></li><li><div>  echo bp_get_groups_pagination_links();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the pagination HTML for a group loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_groups_pagination_links() {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the pagination HTML for a group loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $pag_links HTML markup for the pagination links.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_groups_pagination_links', $groups_template-&gt;pag_links );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the &quot;Viewing x-y of z groups&quot; pagination message.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_pagination_count() {&nbsp;</div></li><li><div>  echo bp_get_groups_pagination_count();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate the &quot;Viewing x-y of z groups&quot; pagination message.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_groups_pagination_count() {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $start_num = intval( ( $groups_template-&gt;pag_page - 1 ) * $groups_template-&gt;pag_num ) + 1;&nbsp;</div></li><li><div>      $from_num = bp_core_number_format( $start_num );&nbsp;</div></li><li><div>      $to_num = bp_core_number_format( ( $start_num + ( $groups_template-&gt;pag_num - 1 ) &gt; $groups_template-&gt;total_group_count ) ? $groups_template-&gt;total_group_count : $start_num + ( $groups_template-&gt;pag_num - 1 ) );&nbsp;</div></li><li><div>      $total = bp_core_number_format( $groups_template-&gt;total_group_count );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 1 == $groups_template-&gt;total_group_count ) {&nbsp;</div></li><li><div>          $message = __( 'Viewing 1 group', 'buddypress' );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $message = sprintf( _n( 'Viewing %1$s - %2$s of %3$s group', 'Viewing %1$s - %2$s of %3$s groups', $groups_template-&gt;total_group_count, 'buddypress' ), $from_num, $to_num, $total );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the &quot;Viewing x-y of z groups&quot; pagination message.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $message  &quot;Viewing x-y of z groups&quot; text.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $from_num Total amount for the low value in the range.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $to_num   Total amount for the high value in the range.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $total    Total amount of groups found.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_groups_pagination_count', $message, $from_num, $to_num, $total );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determine whether groups auto-join is enabled.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * &quot;Auto-join&quot; is the toggle that determines whether users are joined to a</span>&nbsp;</div></li><li><div><span class="comment"> * public group automatically when creating content in that group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.2.6</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_auto_join() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether groups auto-join is enabled.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.2.6</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $value Enabled status.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_groups_auto_join', (bool) buddypress()-&gt;groups-&gt;auto_join );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the total member count for a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_total_members( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_total_members( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the total member count for a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return int</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_total_members( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the total member count for a group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param int    $total_member_count Total member count for a group.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group              Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_total_members', $group-&gt;total_member_count, $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the &quot;x members&quot; count string for a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_count() {&nbsp;</div></li><li><div>  echo bp_get_group_member_count();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate the &quot;x members&quot; count string for a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_count() {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $groups_template-&gt;group-&gt;total_member_count ) ) {&nbsp;</div></li><li><div>          $count = (int) $groups_template-&gt;group-&gt;total_member_count;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $count = 0;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $count_string = sprintf( _n( '%s member', '%s members', $count, 'buddypress' ), bp_core_number_format( $count ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the &quot;x members&quot; count string for a group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $count_string The &quot;x members&quot; count string for a group.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_count', $count_string );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the URL of the Forum page of the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_forum_permalink() {&nbsp;</div></li><li><div>  echo bp_get_group_forum_permalink();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate the URL of the Forum page of a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_forum_permalink( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the URL of the Forum page of a group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL permalink for the Forum Page.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_forum_permalink', bp_get_group_permalink( $group ) . 'forum', $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the topic count for a group forum.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args See {@link bp_get_group_forum_topic_count()}.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_forum_topic_count( $args = '' ) {&nbsp;</div></li><li><div>  echo bp_get_group_forum_topic_count( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate the topic count string for a group forum.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment">   *     Array of arguments.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type bool $showtext Optional. If true, result will be formatted as &quot;x topics&quot;.</span>&nbsp;</div></li><li><div><span class="comment">   *                          If false, just a number will be returned.</span>&nbsp;</div></li><li><div><span class="comment">   *                          Default: false.</span>&nbsp;</div></li><li><div><span class="comment">   * }</span>&nbsp;</div></li><li><div><span class="comment">   * @return string|int</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_forum_topic_count( $args = '' ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $defaults = array(&nbsp;</div></li><li><div>          'showtext' =&gt; false&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r = wp_parse_args( $args, $defaults );&nbsp;</div></li><li><div>      extract( $r, EXTR_SKIP );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !$forum_id = groups_get_groupmeta( $groups_template-&gt;group-&gt;id, 'forum_id' ) ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !bp_is_active( 'forums' ) ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !$groups_template-&gt;group-&gt;forum_counts ) {&nbsp;</div></li><li><div>          $groups_template-&gt;group-&gt;forum_counts = bp_forums_get_forum_topicpost_count( (int) $forum_id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( (bool) $showtext ) {&nbsp;</div></li><li><div>          if ( 1 == (int) $groups_template-&gt;group-&gt;forum_counts[0]-&gt;topics ) {&nbsp;</div></li><li><div>              $total_topics = sprintf( __( '%d topic', 'buddypress' ), (int) $groups_template-&gt;group-&gt;forum_counts[0]-&gt;topics );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $total_topics = sprintf( __( '%d topics', 'buddypress' ), (int) $groups_template-&gt;group-&gt;forum_counts[0]-&gt;topics );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $total_topics = (int) $groups_template-&gt;group-&gt;forum_counts[0]-&gt;topics;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the topic count string for a group forum.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $total_topics Total topic count string.</span>&nbsp;</div></li><li><div><span class="comment">       * @param bool   $showtext     Whether or not to return as formatted string.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_forum_topic_count', $total_topics, (bool)$showtext );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the post count for a group forum.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args See {@link bp_get_group_forum_post_count()}.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_forum_post_count( $args = '' ) {&nbsp;</div></li><li><div>  echo bp_get_group_forum_post_count( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate the post count string for a group forum.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment">   *     Array of arguments.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type bool $showtext Optional. If true, result will be formatted as &quot;x posts&quot;.</span>&nbsp;</div></li><li><div><span class="comment">   *                          If false, just a number will be returned.</span>&nbsp;</div></li><li><div><span class="comment">   *                          Default: false.</span>&nbsp;</div></li><li><div><span class="comment">   * }</span>&nbsp;</div></li><li><div><span class="comment">   * @return string|int</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_forum_post_count( $args = '' ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $defaults = array(&nbsp;</div></li><li><div>          'showtext' =&gt; false&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r = wp_parse_args( $args, $defaults );&nbsp;</div></li><li><div>      extract( $r, EXTR_SKIP );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !$forum_id = groups_get_groupmeta( $groups_template-&gt;group-&gt;id, 'forum_id' ) ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !bp_is_active( 'forums' ) ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !$groups_template-&gt;group-&gt;forum_counts ) {&nbsp;</div></li><li><div>          $groups_template-&gt;group-&gt;forum_counts = bp_forums_get_forum_topicpost_count( (int) $forum_id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( (bool) $showtext ) {&nbsp;</div></li><li><div>          if ( 1 == (int) $groups_template-&gt;group-&gt;forum_counts[0]-&gt;posts ) {&nbsp;</div></li><li><div>              $total_posts = sprintf( __( '%d post', 'buddypress' ), (int) $groups_template-&gt;group-&gt;forum_counts[0]-&gt;posts );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $total_posts = sprintf( __( '%d posts', 'buddypress' ), (int) $groups_template-&gt;group-&gt;forum_counts[0]-&gt;posts );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $total_posts = (int) $groups_template-&gt;group-&gt;forum_counts[0]-&gt;posts;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the post count string for a group forum.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $total_posts Total post count string.</span>&nbsp;</div></li><li><div><span class="comment">       * @param bool   $showtext    Whether or not to return as formatted string.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_forum_post_count', $total_posts, (bool)$showtext );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determine whether forums are enabled for a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_is_forum_enabled( $group = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $group-&gt;enable_forum ) ) {&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the 'checked' attribute for the group forums settings UI.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_show_forum_setting( $group = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $group-&gt;enable_forum ) {&nbsp;</div></li><li><div>      echo ' checked=&quot;checked&quot;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the 'checked' attribute for a given status in the settings UI.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string      $setting Group status. 'public', 'private', 'hidden'.</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group   Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_show_status_setting( $setting, $group = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $setting == $group-&gt;status ) {&nbsp;</div></li><li><div>      echo ' checked=&quot;checked&quot;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the 'checked' value, if needed, for a given invite_status on the group create/admin screens</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string      $setting The setting you want to check against ('members', </span>&nbsp;</div></li><li><div><span class="comment"> *                             'mods', or 'admins').</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group   Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_show_invite_status_setting( $setting, $group = false ) {&nbsp;</div></li><li><div>  $group_id = isset( $group-&gt;id ) ? $group-&gt;id : false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $invite_status = bp_group_get_invite_status( $group_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $setting == $invite_status ) {&nbsp;</div></li><li><div>      echo ' checked=&quot;checked&quot;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Get the invite status of a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * 'invite_status' became part of BuddyPress in BP 1.5. In order to provide</span>&nbsp;</div></li><li><div><span class="comment"> * backward compatibility with earlier installations, groups without a status</span>&nbsp;</div></li><li><div><span class="comment"> * set will default to 'members', ie all members in a group can send</span>&nbsp;</div></li><li><div><span class="comment"> * invitations. Filter 'bp_group_invite_status_fallback' to change this</span>&nbsp;</div></li><li><div><span class="comment"> * fallback behavior.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function can be used either in or out of the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|bool $group_id Optional. The ID of the group whose status you want to</span>&nbsp;</div></li><li><div><span class="comment"> *                           check. Default: the displayed group, or the current group</span>&nbsp;</div></li><li><div><span class="comment"> *                           in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool|string Returns false when no group can be found. Otherwise</span>&nbsp;</div></li><li><div><span class="comment"> *                     returns the group invite status, from among 'members', </span>&nbsp;</div></li><li><div><span class="comment"> *                     'mods', and 'admins'.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_get_invite_status( $group_id = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !$group_id ) {&nbsp;</div></li><li><div>      $bp = buddypress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $bp-&gt;groups-&gt;current_group-&gt;id ) ) {&nbsp;</div></li><li><div>          <span class="comment">// Default to the current group first.</span>&nbsp;</div></li><li><div>          $group_id = $bp-&gt;groups-&gt;current_group-&gt;id;&nbsp;</div></li><li><div>      } elseif ( isset( $groups_template-&gt;group-&gt;id ) ) {&nbsp;</div></li><li><div>          <span class="comment">// Then see if we're in the loop.</span>&nbsp;</div></li><li><div>          $group_id = $groups_template-&gt;group-&gt;id;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $invite_status = groups_get_groupmeta( $group_id, 'invite_status' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Backward compatibility. When 'invite_status' is not set, fall back to a default value.</span>&nbsp;</div></li><li><div>  if ( !$invite_status ) {&nbsp;</div></li><li><div>      $invite_status = apply_filters( 'bp_group_invite_status_fallback', 'members' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the invite status of a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Invite status in this case means who from the group can send invites.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $invite_status Membership level needed to send an invite.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int    $group_id      ID of the group whose status is being checked.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_group_get_invite_status', $invite_status, $group_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Can a user send invitations in the specified group?</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0 Added the $user_id parameter.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $group_id The group ID to check.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $user_id  The user ID to check.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_user_can_send_invites( $group_id = 0, $user_id = 0 ) {&nbsp;</div></li><li><div>  $can_send_invites = false;&nbsp;</div></li><li><div>  $invite_status = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// If $user_id isn't specified, we check against the logged-in user.</span>&nbsp;</div></li><li><div>  if ( ! $user_id ) {&nbsp;</div></li><li><div>      $user_id = bp_loggedin_user_id();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// If $group_id isn't specified, use existing one if available.</span>&nbsp;</div></li><li><div>  if ( ! $group_id ) {&nbsp;</div></li><li><div>      $group_id = bp_get_current_group_id();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $user_id ) {&nbsp;</div></li><li><div>      <span class="comment">// Users with the 'bp_moderate' cap can always send invitations.</span>&nbsp;</div></li><li><div>      if ( user_can( $user_id, 'bp_moderate' ) ) {&nbsp;</div></li><li><div>          $can_send_invites = true;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $invite_status = bp_group_get_invite_status( $group_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          switch ( $invite_status ) {&nbsp;</div></li><li><div>              case 'admins' :&nbsp;</div></li><li><div>                  if ( groups_is_user_admin( $user_id, $group_id ) ) {&nbsp;</div></li><li><div>                      $can_send_invites = true;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              case 'mods' :&nbsp;</div></li><li><div>                  if ( groups_is_user_mod( $user_id, $group_id ) || groups_is_user_admin( $user_id, $group_id ) ) {&nbsp;</div></li><li><div>                      $can_send_invites = true;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              case 'members' :&nbsp;</div></li><li><div>                  if ( groups_is_user_member( $user_id, $group_id ) ) {&nbsp;</div></li><li><div>                      $can_send_invites = true;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether a user can send invites in a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.2.0 Added the $user_id parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $can_send_invites Whether the user can send invites</span>&nbsp;</div></li><li><div><span class="comment">   * @param int  $group_id         The group ID being checked</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $invite_status    The group's current invite status</span>&nbsp;</div></li><li><div><span class="comment">   * @param int  $user_id          The user ID being checked</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_groups_user_can_send_invites', $can_send_invites, $group_id, $invite_status, $user_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Since BuddyPress 1.0, this generated the group settings admin/member screen.</span>&nbsp;</div></li><li><div><span class="comment"> * As of BuddyPress 1.5 (r4489), and because this function outputs HTML, it was moved into /bp-default/groups/single/admin.php.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated 1.5</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated No longer used.</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> * @todo Remove in 1.4</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $admin_list</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $group</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_admin_memberlist( $admin_list = false, $group = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  _deprecated_function( __FUNCTION__, '1.5', 'No longer used. See /bp-default/groups/single/admin.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $admins = groups_get_group_admins( $group-&gt;id ) ) : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;ul id=&quot;admins-list&quot; class=&quot;item-list&lt;?php if ( !empty( $admin_list ) ) : ?&gt; single-line&lt;?php endif; ?&gt;&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php foreach ( (array) $admins as $admin ) { ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php if ( !empty( $admin_list ) ) : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;li&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;?php echo bp_core_fetch_avatar( array( 'item_id' =&gt; $admin-&gt;user_id, 'type' =&gt; 'thumb', 'width' =&gt; 30, 'height' =&gt; 30, 'alt' =&gt; sprintf( __( 'Profile picture of %s', 'buddypress' ), bp_core_get_user_displayname( $admin-&gt;user_id ) ) ) ) ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;h5&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;?php echo bp_core_get_userlink( $admin-&gt;user_id ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;span class=&quot;small&quot;&gt;&nbsp;</div></li><li><div>                      &lt;a class=&quot;button confirm admin-demote-to-member&quot; href=&quot;&lt;?php bp_group_member_demote_link($admin-&gt;user_id) ?&gt;&quot;&gt;&lt;?php _e( 'Demote to Member', 'buddypress' ) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                  &lt;/span&gt;&nbsp;</div></li><li><div>              &lt;/h5&gt;&nbsp;</div></li><li><div>          &lt;/li&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php else : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;li&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;?php echo bp_core_fetch_avatar( array( 'item_id' =&gt; $admin-&gt;user_id, 'type' =&gt; 'thumb', 'alt' =&gt; sprintf( __( 'Profile picture of %s', 'buddypress' ), bp_core_get_user_displayname( $admin-&gt;user_id ) ) ) ) ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;h5&gt;&lt;?php echo bp_core_get_userlink( $admin-&gt;user_id ) ?&gt;&lt;/h5&gt;&nbsp;</div></li><li><div>              &lt;span class=&quot;activity&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php echo bp_core_get_last_activity( strtotime( $admin-&gt;date_modified ), __( 'joined %s', 'buddypress') ); ?&gt;&nbsp;</div></li><li><div>              &lt;/span&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;?php if ( bp_is_active( 'friends' ) ) : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;div class=&quot;action&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;?php bp_add_friend_button( $admin-&gt;user_id ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/li&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php endif;&nbsp;</div></li><li><div>      } ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;/ul&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php else : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;div id=&quot;message&quot; class=&quot;info&quot;&gt;&nbsp;</div></li><li><div>          &lt;p&gt;&lt;?php _e( 'This group has no administrators', 'buddypress' ); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Generate the HTML for a list of group moderators.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * No longer used.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @todo Deprecate.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $admin_list</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $group</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_mod_memberlist( $admin_list = false, $group = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $group_mods = groups_get_group_mods( $group-&gt;id ) ) { ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;ul id=&quot;mods-list&quot; class=&quot;item-list&lt;?php if ( $admin_list ) { ?&gt; single-line&lt;?php } ?&gt;&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php foreach ( (array) $group_mods as $mod ) { ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php if ( !empty( $admin_list ) ) { ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;li&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;?php echo bp_core_fetch_avatar( array( 'item_id' =&gt; $mod-&gt;user_id, 'type' =&gt; 'thumb', 'width' =&gt; 30, 'height' =&gt; 30, 'alt' =&gt; sprintf( __( 'Profile picture of %s', 'buddypress' ), bp_core_get_user_displayname( $mod-&gt;user_id ) ) ) ) ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;h5&gt;&nbsp;</div></li><li><div>                  &lt;?php echo bp_core_get_userlink( $mod-&gt;user_id ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;span class=&quot;small&quot;&gt;&nbsp;</div></li><li><div>                      &lt;a href=&quot;&lt;?php bp_group_member_promote_admin_link( array( 'user_id' =&gt; $mod-&gt;user_id ) ) ?&gt;&quot; class=&quot;button confirm mod-promote-to-admin&quot;&gt;&lt;?php _e( 'Promote to Admin', 'buddypress' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                      &lt;a class=&quot;button confirm mod-demote-to-member&quot; href=&quot;&lt;?php bp_group_member_demote_link($mod-&gt;user_id) ?&gt;&quot;&gt;&lt;?php _e( 'Demote to Member', 'buddypress' ) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                  &lt;/span&gt;&nbsp;</div></li><li><div>              &lt;/h5&gt;&nbsp;</div></li><li><div>          &lt;/li&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php } else { ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;li&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;?php echo bp_core_fetch_avatar( array( 'item_id' =&gt; $mod-&gt;user_id, 'type' =&gt; 'thumb', 'alt' =&gt; sprintf( __( 'Profile picture of %s', 'buddypress' ), bp_core_get_user_displayname( $mod-&gt;user_id ) ) ) ) ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;h5&gt;&lt;?php echo bp_core_get_userlink( $mod-&gt;user_id ) ?&gt;&lt;/h5&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;span class=&quot;activity&quot;&gt;&lt;?php echo bp_core_get_last_activity( strtotime( $mod-&gt;date_modified ), __( 'joined %s', 'buddypress') ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;?php if ( bp_is_active( 'friends' ) ) : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;div class=&quot;action&quot;&gt;&nbsp;</div></li><li><div>                      &lt;?php bp_add_friend_button( $mod-&gt;user_id ) ?&gt;&nbsp;</div></li><li><div>                  &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/li&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php } ?&gt;&nbsp;</div></li><li><div>      &lt;?php } ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;/ul&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php } else { ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;div id=&quot;message&quot; class=&quot;info&quot;&gt;&nbsp;</div></li><li><div>          &lt;p&gt;&lt;?php _e( 'This group has no moderators', 'buddypress' ); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determine whether a group has moderators.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object. Default: current group in loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @return array Info about group admins (user_id + date_modified).</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_has_moderators( $group = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether a group has moderators.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $value Array of user IDs who are a moderator of the provided group.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_group_has_moderators', groups_get_group_mods( $group-&gt;id ), $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output a URL for promoting a user to moderator.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args See {@link bp_get_group_member_promote_mod_link()}.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_promote_mod_link( $args = '' ) {&nbsp;</div></li><li><div>  echo bp_get_group_member_promote_mod_link( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate a URL for promoting a user to moderator.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment">   *     @type int    $user_id ID of the member to promote. Default:</span>&nbsp;</div></li><li><div><span class="comment">   *                           current member in a group member loop.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type object $group   Group object. Default: current group.</span>&nbsp;</div></li><li><div><span class="comment">   * }</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_promote_mod_link( $args = '' ) {&nbsp;</div></li><li><div>      global $members_template, $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $defaults = array(&nbsp;</div></li><li><div>          'user_id' =&gt; $members_template-&gt;member-&gt;user_id, &nbsp;</div></li><li><div>          'group' =&gt; &$groups_template-&gt;group&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r = wp_parse_args( $args, $defaults );&nbsp;</div></li><li><div>      extract( $r, EXTR_SKIP );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters a URL for promoting a user to moderator.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL to use for promoting a user to moderator.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_promote_mod_link', wp_nonce_url( bp_get_group_permalink( $group ) . 'admin/manage-members/promote/mod/' . $user_id, 'groups_promote_member' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output a URL for promoting a user to admin.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args See {@link bp_get_group_member_promote_admin_link()}.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_promote_admin_link( $args = '' ) {&nbsp;</div></li><li><div>  echo bp_get_group_member_promote_admin_link( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate a URL for promoting a user to admin.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment">   *     @type int    $user_id ID of the member to promote. Default:</span>&nbsp;</div></li><li><div><span class="comment">   *                           current member in a group member loop.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type object $group   Group object. Default: current group.</span>&nbsp;</div></li><li><div><span class="comment">   * }</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_promote_admin_link( $args = '' ) {&nbsp;</div></li><li><div>      global $members_template, $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $defaults = array(&nbsp;</div></li><li><div>          'user_id' =&gt; !empty( $members_template-&gt;member-&gt;user_id ) ? $members_template-&gt;member-&gt;user_id : false, &nbsp;</div></li><li><div>          'group' =&gt; &$groups_template-&gt;group&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r = wp_parse_args( $args, $defaults );&nbsp;</div></li><li><div>      extract( $r, EXTR_SKIP );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters a URL for promoting a user to admin.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL to use for promoting a user to admin.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_promote_admin_link', wp_nonce_url( bp_get_group_permalink( $group ) . 'admin/manage-members/promote/admin/' . $user_id, 'groups_promote_member' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output a URL for demoting a user to member.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $user_id ID of the member to demote. Default: current member in</span>&nbsp;</div></li><li><div><span class="comment"> *                     a member loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_demote_link( $user_id = 0 ) {&nbsp;</div></li><li><div>  global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !$user_id ) {&nbsp;</div></li><li><div>      $user_id = $members_template-&gt;member-&gt;user_id;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo bp_get_group_member_demote_link( $user_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate a URL for demoting a user to member.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int         $user_id ID of the member to demote. Default: current</span>&nbsp;</div></li><li><div><span class="comment">   *                             member in a member loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group   Optional. Group object. Default: current group.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_demote_link( $user_id = 0, $group = false ) {&nbsp;</div></li><li><div>      global $members_template, $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !$user_id ) {&nbsp;</div></li><li><div>          $user_id = $members_template-&gt;member-&gt;user_id;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters a URL for demoting a user to member.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL to use for demoting a user to member.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_demote_link', wp_nonce_url( bp_get_group_permalink( $group ) . 'admin/manage-members/demote/' . $user_id, 'groups_demote_member' ), $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output a URL for banning a member from a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $user_id ID of the member to ban.</span>&nbsp;</div></li><li><div><span class="comment"> *                     Default: current member in a member loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_ban_link( $user_id = 0 ) {&nbsp;</div></li><li><div>  global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !$user_id ) {&nbsp;</div></li><li><div>      $user_id = $members_template-&gt;member-&gt;user_id;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo bp_get_group_member_ban_link( $user_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate a URL for banning a member from a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int         $user_id ID of the member to ban.</span>&nbsp;</div></li><li><div><span class="comment">   *                             Default: current member in a member loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group   Optional. Group object. Default: current group.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_ban_link( $user_id = 0, $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters a URL for banning a member from a group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL to use for banning a member.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_ban_link', wp_nonce_url( bp_get_group_permalink( $group ) . 'admin/manage-members/ban/' . $user_id, 'groups_ban_member' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output a URL for unbanning a member from a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $user_id ID of the member to unban.</span>&nbsp;</div></li><li><div><span class="comment"> *                     Default: current member in a member loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_unban_link( $user_id = 0 ) {&nbsp;</div></li><li><div>  global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !$user_id ) {&nbsp;</div></li><li><div>      $user_id = $members_template-&gt;member-&gt;user_id;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo bp_get_group_member_unban_link( $user_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate a URL for unbanning a member from a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int         $user_id ID of the member to unban.</span>&nbsp;</div></li><li><div><span class="comment">   *                             Default: current member in a member loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group   Optional. Group object. Default: current group.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_unban_link( $user_id = 0, $group = false ) {&nbsp;</div></li><li><div>      global $members_template, $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !$user_id ) {&nbsp;</div></li><li><div>          $user_id = $members_template-&gt;member-&gt;user_id;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters a URL for unbanning a member from a group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL to use for unbanning a member.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_unban_link', wp_nonce_url( bp_get_group_permalink( $group ) . 'admin/manage-members/unban/' . $user_id, 'groups_unban_member' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output a URL for removing a member from a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.2.6</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $user_id ID of the member to remove.</span>&nbsp;</div></li><li><div><span class="comment"> *                     Default: current member in a member loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_remove_link( $user_id = 0 ) {&nbsp;</div></li><li><div>  global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !$user_id ) {&nbsp;</div></li><li><div>      $user_id = $members_template-&gt;member-&gt;user_id;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo bp_get_group_member_remove_link( $user_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate a URL for removing a member from a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.2.6</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int         $user_id ID of the member to remove.</span>&nbsp;</div></li><li><div><span class="comment">   *                             Default: current member in a member loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group   Optional. Group object. Default: current group.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_remove_link( $user_id = 0, $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters a URL for removing a member from a group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.6</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL to use for removing a member.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_remove_link', wp_nonce_url( bp_get_group_permalink( $group ) . 'admin/manage-members/remove/' . $user_id, 'groups_remove_member' ), $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * HTML admin subnav items for group pages.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_admin_tabs( $group = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group = ( $groups_template-&gt;group ) ? $groups_template-&gt;group : groups_get_current_group();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $css_id = 'manage-members';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'private' == $group-&gt;status ) {&nbsp;</div></li><li><div>      $css_id = 'membership-requests';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  add_filter( &quot;bp_get_options_nav_{$css_id}&quot;, 'bp_group_admin_tabs_backcompat', 10, 3 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  bp_get_options_nav( $group-&gt;slug . '_manage' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  remove_filter( &quot;bp_get_options_nav_{$css_id}&quot;, 'bp_group_admin_tabs_backcompat', 10 );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * BackCompat for plugins/themes directly hooking groups_admin_tabs</span>&nbsp;</div></li><li><div><span class="comment"> * without using the Groups Extension API.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param  string $subnav_output Subnav item output.</span>&nbsp;</div></li><li><div><span class="comment"> * @param  string $subnav_item   subnav item params.</span>&nbsp;</div></li><li><div><span class="comment"> * @param  string $selected_item Surrent selected tab.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string HTML output</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_admin_tabs_backcompat( $subnav_output = '', $subnav_item = '', $selected_item = '' ) {&nbsp;</div></li><li><div>  if ( ! has_action( 'groups_admin_tabs' ) ) {&nbsp;</div></li><li><div>      return $subnav_output;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $group = groups_get_current_group();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  ob_start();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  do_action( 'groups_admin_tabs', $selected_item, $group-&gt;slug );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $admin_tabs_backcompat = trim( ob_get_contents() );&nbsp;</div></li><li><div>  ob_end_clean();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $admin_tabs_backcompat ) ) {&nbsp;</div></li><li><div>      _doing_it_wrong( &quot;do_action( 'groups_admin_tabs' )&quot;, __( 'This action should not be used directly. Please use the BuddyPress Group Extension API to generate Manage tabs.', 'buddypress' ), '2.2.0' );&nbsp;</div></li><li><div>      $subnav_output .= $admin_tabs_backcompat;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $subnav_output;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the group count for the displayed user.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_total_for_member() {&nbsp;</div></li><li><div>  echo bp_get_group_total_for_member();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the group count for the displayed user.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_total_for_member() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * FIlters the group count for a displayed user.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param int $value Total group count for a displayed user.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_total_for_member', BP_Groups_Member::total_group_count() );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the 'action' attribute for a group form.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $page Page slug.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_form_action( $page ) {&nbsp;</div></li><li><div>  echo bp_get_group_form_action( $page );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate the 'action' attribute for a group form.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string      $page  Page slug.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_form_action( $page, $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the 'action' attribute for a group form.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Action attribute for a group form.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_group_form_action', bp_get_group_permalink( $group ) . $page, $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the 'action' attribute for a group admin form.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string|bool $page Optional. Page slug.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_admin_form_action( $page = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_admin_form_action( $page );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate the 'action' attribute for a group admin form.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string|bool $page  Optional. Page slug.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_admin_form_action( $page = false, $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $page ) ) {&nbsp;</div></li><li><div>          $page = bp_action_variable( 0 );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the 'action' attribute for a group admin form.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Action attribute for a group admin form.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_group_admin_form_action', bp_get_group_permalink( $group ) . 'admin/' . $page, $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determine whether the logged-in user has requested membership to a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_has_requested_membership( $group = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( groups_check_for_membership_request( bp_loggedin_user_id(), $group-&gt;id ) ) {&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current user is member of a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global object $groups_template</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group to check is_member.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool If user is member of group or not.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_is_member( $group = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Site admins always have access.</span></span>&nbsp;</div></li><li><div>  if ( bp_current_user_can( 'bp_moderate' ) ) {&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether current user is member of a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.2.4</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool   $is_member If user is a member of group or not.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object $group     Group object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_group_is_member', ! empty( $group-&gt;is_member ), $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check whether the current user has an outstanding invite to the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group data object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: the current group in the groups loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if the user has an outstanding invite, otherwise false.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_is_invited( $group = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether current user has an outstanding invite to current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool   $is_invited If user has an outstanding group invite.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object $group      Group object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_group_is_invited', ! empty( $group-&gt;is_invited ), $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if a user is banned from a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * If this function is invoked inside the groups template loop, then we check</span>&nbsp;</div></li><li><div><span class="comment"> * $groups_template-&gt;group-&gt;is_banned instead of using {@link groups_is_user_banned()}</span>&nbsp;</div></li><li><div><span class="comment"> * and making another SQL query.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * In BuddyPress 2.1, to standardize this function, we are defaulting the</span>&nbsp;</div></li><li><div><span class="comment"> * return value to a boolean.  In previous versions, using this function would</span>&nbsp;</div></li><li><div><span class="comment"> * return either a string of the integer (0 or 1) or null if a result couldn't</span>&nbsp;</div></li><li><div><span class="comment"> * be found from the database.  If the logged-in user had the 'bp_moderate'</span>&nbsp;</div></li><li><div><span class="comment"> * capability, the return value would be boolean false.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global BP_Groups_Template $groups_template Group template loop object.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param BP_Groups_Group|bool $group   Group to check if user is banned.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int                  $user_id The user ID to check.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if user is banned.  False if user isn't banned.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_is_user_banned( $group = false, $user_id = 0 ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Site admins always have access.</span></span>&nbsp;</div></li><li><div>  if ( bp_current_user_can( 'bp_moderate' ) ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Check groups loop first</span>&nbsp;</div></li><li><div>  <span class="comment">// @see BP_Groups_Group::get_group_extras().</span>&nbsp;</div></li><li><div>  if ( ! empty( $groups_template-&gt;in_the_loop ) && isset( $groups_template-&gt;group-&gt;is_banned ) ) {&nbsp;</div></li><li><div>      $retval = $groups_template-&gt;group-&gt;is_banned;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Not in loop.</span>&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      <span class="comment">// Default to not banned.</span>&nbsp;</div></li><li><div>      $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group = $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $user_id ) ) {&nbsp;</div></li><li><div>          $user_id = bp_loggedin_user_id();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $user_id ) && ! empty( $group-&gt;id ) ) {&nbsp;</div></li><li><div>          $retval = groups_is_user_banned( $user_id, $group-&gt;id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether current user has been banned from current group in loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool   $is_invited If user has been from current group.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object $group      Group object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bp_group_is_user_banned', $retval, $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the URL for accepting an invitation to the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_accept_invite_link() {&nbsp;</div></li><li><div>  echo bp_get_group_accept_invite_link();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate the URL for accepting an invitation to a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: Current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_accept_invite_link( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $bp = buddypress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the URL for accepting an invitation to a group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL for accepting an invitation to a group.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_accept_invite_link', wp_nonce_url( trailingslashit( bp_loggedin_user_domain() . bp_get_groups_slug() . '/invites/accept/' . $group-&gt;id ), 'groups_accept_invite' ), $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the URL for accepting an invitation to the current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_reject_invite_link() {&nbsp;</div></li><li><div>  echo bp_get_group_reject_invite_link();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate the URL for rejecting an invitation to a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: Current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_reject_invite_link( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $bp = buddypress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the URL for rejecting an invitation to a group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL for rejecting an invitation to a group.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_reject_invite_link', wp_nonce_url( trailingslashit( bp_loggedin_user_domain() . bp_get_groups_slug() . '/invites/reject/' . $group-&gt;id ), 'groups_reject_invite' ), $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the URL for confirming a request to leave a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_leave_confirm_link() {&nbsp;</div></li><li><div>  echo bp_get_group_leave_confirm_link();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate the URL for confirming a request to leave a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: Current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_leave_confirm_link( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the URL for confirming a request to leave a group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL for confirming a request to leave a group.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_group_leave_confirm_link', wp_nonce_url( bp_get_group_permalink( $group ) . 'leave-group/yes', 'groups_leave_group' ), $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the URL for rejecting a request to leave a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_leave_reject_link() {&nbsp;</div></li><li><div>  echo bp_get_group_leave_reject_link();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate the URL for rejecting a request to leave a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: Current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_leave_reject_link( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the URL for rejecting a request to leave a group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL for rejecting a request to leave a group.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_leave_reject_link', bp_get_group_permalink( $group ), $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the 'action' attribute for a group send invite form.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_send_invite_form_action() {&nbsp;</div></li><li><div>  echo bp_get_group_send_invite_form_action();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Output the 'action' attribute for a group send invite form.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment">   *                           Default: current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_send_invite_form_action( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the 'action' attribute for a group send invite form.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Action attribute for a group send invite form.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_group_send_invite_form_action', bp_get_group_permalink( $group ) . 'send-invites/send', $group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determine whether the current user has friends to invite to a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Optional. Group object.</span>&nbsp;</div></li><li><div><span class="comment"> *                           Default: current group in the loop.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_has_friends_to_invite( $group = false ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !bp_is_active( 'friends' ) ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !friends_check_user_has_friends( bp_loggedin_user_id() ) || !friends_count_invitable_friends( bp_loggedin_user_id(), $group-&gt;id ) ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return true;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output a 'New Topic' button for a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.2.7</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param BP_Groups_Group|bool $group The BP Groups_Group object if passed, </span>&nbsp;</div></li><li><div><span class="comment"> *                                    boolean false if not passed.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_new_topic_button( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_new_topic_button( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns a 'New Topic' button for a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.2.7</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param BP_Groups_Group|bool $group The BP Groups_Group object if</span>&nbsp;</div></li><li><div><span class="comment">   *                                    passed, boolean false if not passed.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string HTML code for the button.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_new_topic_button( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !is_user_logged_in() || bp_group_is_user_banned() || !bp_is_group_forum() || bp_is_group_forum_topic() ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $button = array(&nbsp;</div></li><li><div>          'id' =&gt; 'new_topic', &nbsp;</div></li><li><div>          'component' =&gt; 'groups', &nbsp;</div></li><li><div>          'must_be_logged_in' =&gt; true, &nbsp;</div></li><li><div>          'block_self' =&gt; true, &nbsp;</div></li><li><div>          'wrapper_class' =&gt; 'group-button', &nbsp;</div></li><li><div>          'link_href' =&gt; '#post-new', &nbsp;</div></li><li><div>          'link_class' =&gt; 'group-button show-hide-new', &nbsp;</div></li><li><div>          'link_id' =&gt; 'new-topic-button', &nbsp;</div></li><li><div>          'link_text' =&gt; __( 'New Topic', 'buddypress' ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the HTML button for creating a new topic in a group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $button HTML button for a new topic.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group  Group object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return bp_get_button( apply_filters( 'bp_get_group_new_topic_button', $button, $group ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output button to join a group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|bool $group Single group object.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_join_button( $group = false ) {&nbsp;</div></li><li><div>  echo bp_get_group_join_button( $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return button to join a group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object|bool $group Single group object.</span>&nbsp;</div></li><li><div><span class="comment">   * @return false|string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_join_button( $group = false ) {&nbsp;</div></li><li><div>      global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set group to current loop group if none passed.</span>&nbsp;</div></li><li><div>      if ( empty( $group ) ) {&nbsp;</div></li><li><div>          $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Don't show button if not logged in or previously banned.</span>&nbsp;</div></li><li><div>      if ( ! is_user_logged_in() || bp_group_is_user_banned( $group ) ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Group creation was not completed or status is unknown.</span>&nbsp;</div></li><li><div>      if ( empty( $group-&gt;status ) ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Already a member.</span>&nbsp;</div></li><li><div>      if ( ! empty( $group-&gt;is_member ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Stop sole admins from abandoning their group.</span>&nbsp;</div></li><li><div>          $group_admins = groups_get_group_admins( $group-&gt;id );&nbsp;</div></li><li><div>          if ( ( 1 == count( $group_admins ) ) && ( bp_loggedin_user_id() === (int) $group_admins[0]-&gt;user_id ) ) {&nbsp;</div></li><li><div>              return false;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Setup button attributes.</span>&nbsp;</div></li><li><div>          $button = array(&nbsp;</div></li><li><div>              'id' =&gt; 'leave_group', &nbsp;</div></li><li><div>              'component' =&gt; 'groups', &nbsp;</div></li><li><div>              'must_be_logged_in' =&gt; true, &nbsp;</div></li><li><div>              'block_self' =&gt; false, &nbsp;</div></li><li><div>              'wrapper_class' =&gt; 'group-button ' . $group-&gt;status, &nbsp;</div></li><li><div>              'wrapper_id' =&gt; 'groupbutton-' . $group-&gt;id, &nbsp;</div></li><li><div>              'link_href' =&gt; wp_nonce_url( bp_get_group_permalink( $group ) . 'leave-group', 'groups_leave_group' ), &nbsp;</div></li><li><div>              'link_text' =&gt; __( 'Leave Group', 'buddypress' ), &nbsp;</div></li><li><div>              'link_class' =&gt; 'group-button leave-group', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Not a member.</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Show different buttons based on group status.</span>&nbsp;</div></li><li><div>          switch ( $group-&gt;status ) {&nbsp;</div></li><li><div>              case 'hidden' :&nbsp;</div></li><li><div>                  return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              case 'public':&nbsp;</div></li><li><div>                  $button = array(&nbsp;</div></li><li><div>                      'id' =&gt; 'join_group', &nbsp;</div></li><li><div>                      'component' =&gt; 'groups', &nbsp;</div></li><li><div>                      'must_be_logged_in' =&gt; true, &nbsp;</div></li><li><div>                      'block_self' =&gt; false, &nbsp;</div></li><li><div>                      'wrapper_class' =&gt; 'group-button ' . $group-&gt;status, &nbsp;</div></li><li><div>                      'wrapper_id' =&gt; 'groupbutton-' . $group-&gt;id, &nbsp;</div></li><li><div>                      'link_href' =&gt; wp_nonce_url( bp_get_group_permalink( $group ) . 'join', 'groups_join_group' ), &nbsp;</div></li><li><div>                      'link_text' =&gt; __( 'Join Group', 'buddypress' ), &nbsp;</div></li><li><div>                      'link_class' =&gt; 'group-button join-group', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              case 'private' :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Member has outstanding invitation -</span>&nbsp;</div></li><li><div>                  <span class="comment">// show an &quot;Accept Invitation&quot; button.</span>&nbsp;</div></li><li><div>                  if ( $group-&gt;is_invited ) {&nbsp;</div></li><li><div>                      $button = array(&nbsp;</div></li><li><div>                          'id' =&gt; 'accept_invite', &nbsp;</div></li><li><div>                          'component' =&gt; 'groups', &nbsp;</div></li><li><div>                          'must_be_logged_in' =&gt; true, &nbsp;</div></li><li><div>                          'block_self' =&gt; false, &nbsp;</div></li><li><div>                          'wrapper_class' =&gt; 'group-button ' . $group-&gt;status, &nbsp;</div></li><li><div>                          'wrapper_id' =&gt; 'groupbutton-' . $group-&gt;id, &nbsp;</div></li><li><div>                          'link_href' =&gt; add_query_arg( 'redirect_to', bp_get_group_permalink( $group ), bp_get_group_accept_invite_link( $group ) ), &nbsp;</div></li><li><div>                          'link_text' =&gt; __( 'Accept Invitation', 'buddypress' ), &nbsp;</div></li><li><div>                          'link_class' =&gt; 'group-button accept-invite', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Member has requested membership but request is pending -</span>&nbsp;</div></li><li><div>                  <span class="comment">// show a &quot;Request Sent&quot; button.</span>&nbsp;</div></li><li><div>                  } elseif ( $group-&gt;is_pending ) {&nbsp;</div></li><li><div>                      $button = array(&nbsp;</div></li><li><div>                          'id' =&gt; 'membership_requested', &nbsp;</div></li><li><div>                          'component' =&gt; 'groups', &nbsp;</div></li><li><div>                          'must_be_logged_in' =&gt; true, &nbsp;</div></li><li><div>                          'block_self' =&gt; false, &nbsp;</div></li><li><div>                          'wrapper_class' =&gt; 'group-button pending ' . $group-&gt;status, &nbsp;</div></li><li><div>                          'wrapper_id' =&gt; 'groupbutton-' . $group-&gt;id, &nbsp;</div></li><li><div>                          'link_href' =&gt; bp_get_group_permalink( $group ), &nbsp;</div></li><li><div>                          'link_text' =&gt; __( 'Request Sent', 'buddypress' ), &nbsp;</div></li><li><div>                          'link_class' =&gt; 'group-button pending membership-requested', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Member has not requested membership yet -</span>&nbsp;</div></li><li><div>                  <span class="comment">// show a &quot;Request Membership&quot; button.</span>&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $button = array(&nbsp;</div></li><li><div>                          'id' =&gt; 'request_membership', &nbsp;</div></li><li><div>                          'component' =&gt; 'groups', &nbsp;</div></li><li><div>                          'must_be_logged_in' =&gt; true, &nbsp;</div></li><li><div>                          'block_self' =&gt; false, &nbsp;</div></li><li><div>                          'wrapper_class' =&gt; 'group-button ' . $group-&gt;status, &nbsp;</div></li><li><div>                          'wrapper_id' =&gt; 'groupbutton-' . $group-&gt;id, &nbsp;</div></li><li><div>                          'link_href' =&gt; wp_nonce_url( bp_get_group_permalink( $group ) . 'request-membership', 'groups_request_membership' ), &nbsp;</div></li><li><div>                          'link_text' =&gt; __( 'Request Membership', 'buddypress' ), &nbsp;</div></li><li><div>                          'link_class' =&gt; 'group-button request-membership', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the HTML button for joining a group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.6</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.4.0 Added $group parameter to filter args.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $button HTML button for joining a group.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $group BuddyPress group object</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return bp_get_button( apply_filters( 'bp_get_group_join_button', $button, $group ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the Create a Group button.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_create_button() {&nbsp;</div></li><li><div>  echo bp_get_group_create_button();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the Create a Group button.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_create_button() {&nbsp;</div></li><li><div>      if ( ! is_user_logged_in() ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! bp_user_can_create_groups() ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $button_args = array(&nbsp;</div></li><li><div>          'id' =&gt; 'create_group', &nbsp;</div></li><li><div>          'component' =&gt; 'groups', &nbsp;</div></li><li><div>          'link_text' =&gt; __( 'Create a Group', 'buddypress' ), &nbsp;</div></li><li><div>          'link_class' =&gt; 'group-create no-ajax', &nbsp;</div></li><li><div>          'link_href' =&gt; trailingslashit( bp_get_groups_directory_permalink() . 'create' ), &nbsp;</div></li><li><div>          'wrapper' =&gt; false, &nbsp;</div></li><li><div>          'block_self' =&gt; false, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the HTML button for creating a group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $button HTML button for creating a group.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return bp_get_button( apply_filters( 'bp_get_group_create_button', $button_args ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the Create a Group nav item.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_create_nav_item() {&nbsp;</div></li><li><div>  echo bp_get_group_create_nav_item();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the Create a Group nav item.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_create_nav_item() {&nbsp;</div></li><li><div>      <span class="comment">// Get the create a group button.</span>&nbsp;</div></li><li><div>      $create_group_button = bp_get_group_create_button();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Make sure the button is available.</span>&nbsp;</div></li><li><div>      if ( empty( $create_group_button ) ) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $output = '&lt;li id=&quot;group-create-nav&quot;&gt;' . $create_group_button . '&lt;/li&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the Create a Group nav item.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $output HTML output for nav item.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_create_nav_item', $output );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Checks if a specific theme is still filtering the Groups directory title</span>&nbsp;</div></li><li><div><span class="comment"> * if so, transform the title button into a Groups directory nav item.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return string HTML Output</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_backcompat_create_nav_item() {&nbsp;</div></li><li><div>  <span class="comment">// Bail if the Groups nav item is already used by bp-legacy.</span>&nbsp;</div></li><li><div>  if ( has_action( 'bp_groups_directory_group_filter', 'bp_legacy_theme_group_create_nav', 999 ) ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Bail if the theme is not filtering the Groups directory title.</span>&nbsp;</div></li><li><div>  if ( ! has_filter( 'bp_groups_directory_header' ) ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  bp_group_create_nav_item();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action( 'bp_groups_directory_group_filter', 'bp_group_backcompat_create_nav_item', 1000 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Prints a message if the group is not visible to the current user (it is a</span>&nbsp;</div></li><li><div><span class="comment"> * hidden or private group, and the user does not have access).</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global BP_Groups_Template $groups_template Groups template object.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param object|null $group Group to get status message for. Optional; defaults to current group.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_status_message( $group = null ) {&nbsp;</div></li><li><div>  global $groups_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Group not passed so look for loop.</span>&nbsp;</div></li><li><div>  if ( empty( $group ) ) {&nbsp;</div></li><li><div>      $group =& $groups_template-&gt;group;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Group status is not set (maybe outside of group loop?).</span>&nbsp;</div></li><li><div>  if ( empty( $group-&gt;status ) ) {&nbsp;</div></li><li><div>      $message = __( 'This group is not currently accessible.', 'buddypress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Group has a status.</span>&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      switch( $group-&gt;status ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Private group.</span>&nbsp;</div></li><li><div>          case 'private' :&nbsp;</div></li><li><div>              if ( ! bp_group_has_requested_membership( $group ) ) {&nbsp;</div></li><li><div>                  if ( is_user_logged_in() ) {&nbsp;</div></li><li><div>                      if ( bp_group_is_invited( $group ) ) {&nbsp;</div></li><li><div>                          $message = __( 'You must accept your pending invitation before you can access this private group.', 'buddypress' );&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          $message = __( 'This is a private group and you must request group membership in order to join.', 'buddypress' );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $message = __( 'This is a private group. To join you must be a registered site member and request group membership.', 'buddypress' );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $message = __( 'This is a private group. Your membership request is awaiting approval from the group administrator.', 'buddypress' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Hidden group.</span>&nbsp;</div></li><li><div>          case 'hidden' :&nbsp;</div></li><li><div>          default :&nbsp;</div></li><li><div>              $message = __( 'This is a hidden group and only invited members can join.', 'buddypress' );&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters a message if the group is not visible to the current user.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * This will be true if it is a hidden or private group, and the user does not have access.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.6.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $message Message to display to the current user.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object $group   Group to get status message for.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo apply_filters( 'bp_group_status_message', $message, $group );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output hidden form fields for group.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function is no longer used, but may still be used by older themes.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_hidden_fields() {&nbsp;</div></li><li><div>  $query_arg = bp_core_get_component_search_query_arg( 'groups' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $_REQUEST[ $query_arg ] ) ) {&nbsp;</div></li><li><div>      echo '&lt;input type=&quot;hidden&quot; id=&quot;search_terms&quot; value=&quot;' . esc_attr( $_REQUEST[ $query_arg ] ) . '&quot; name=&quot;search_terms&quot; /&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $_REQUEST['letter'] ) ) {&nbsp;</div></li><li><div>      echo '&lt;input type=&quot;hidden&quot; id=&quot;selected_letter&quot; value=&quot;' . esc_attr( $_REQUEST['letter'] ) . '&quot; name=&quot;selected_letter&quot; /&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $_REQUEST['groups_search'] ) ) {&nbsp;</div></li><li><div>      echo '&lt;input type=&quot;hidden&quot; id=&quot;search_terms&quot; value=&quot;' . esc_attr( $_REQUEST['groups_search'] ) . '&quot; name=&quot;search_terms&quot; /&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the total number of groups.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_total_group_count() {&nbsp;</div></li><li><div>  echo bp_get_total_group_count();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the total number of groups.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return type</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_total_group_count() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the total number of groups.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param int $value Total number of groups found.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_total_group_count', groups_get_total_group_count() );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the total number of groups a user belongs to.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $user_id User ID to get group membership count.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_total_group_count_for_user( $user_id = 0 ) {&nbsp;</div></li><li><div>  echo bp_get_total_group_count_for_user( $user_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the total number of groups a user belongs to.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Filtered by `bp_core_number_format()` by default</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $user_id User ID to get group membership count.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_total_group_count_for_user( $user_id = 0 ) {&nbsp;</div></li><li><div>      $count = groups_total_groups_for_user( $user_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the total number of groups a user belongs to.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param int $count   Total number of groups for the user.</span>&nbsp;</div></li><li><div><span class="comment">       * @param int $user_id ID of the user being checked.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_total_group_count_for_user', $count, $user_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Group Members *************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Initialize a group member query loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     An array of optional arguments.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int      $group_id           ID of the group whose members are being queried.</span>&nbsp;</div></li><li><div><span class="comment"> *                                        Default: current group ID.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int      $page               Page of results to be queried. Default: 1.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int      $per_page           Number of items to return per page of results.</span>&nbsp;</div></li><li><div><span class="comment"> *                                        Default: 20.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int      $max                Optional. Max number of items to return.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type array    $exclude            Optional. Array of user IDs to exclude.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type bool|int $exclude_admin_mods True (or 1) to exclude admins and mods from results.</span>&nbsp;</div></li><li><div><span class="comment"> *                                        Default: 1.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type bool|int $exclude_banned     True (or 1) to exclude banned users from results.</span>&nbsp;</div></li><li><div><span class="comment"> *                                        Default: 1.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type array    $group_role         Optional. Array of group roles to include.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string   $type               Optional. Sort order of results. 'last_joined', </span>&nbsp;</div></li><li><div><span class="comment"> *                                        'first_joined', or any of the $type params available in</span>&nbsp;</div></li><li><div><span class="comment"> *                                        {@link BP_User_Query}. Default: 'last_joined'.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type string   $search_terms       Optional. Search terms to match. Pass an</span>&nbsp;</div></li><li><div><span class="comment"> *                                        empty string to force-disable search, even in</span>&nbsp;</div></li><li><div><span class="comment"> *                                        the presence of $_REQUEST['s']. Default: null.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_has_members( $args = '' ) {&nbsp;</div></li><li><div>  global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $exclude_admins_mods = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( bp_is_group_members() ) {&nbsp;</div></li><li><div>      $exclude_admins_mods = 0;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $search_terms_default = null;&nbsp;</div></li><li><div>  $search_query_arg = bp_core_get_component_search_query_arg( 'members' );&nbsp;</div></li><li><div>  if ( ! empty( $_REQUEST[ $search_query_arg ] ) ) {&nbsp;</div></li><li><div>      $search_terms_default = stripslashes( $_REQUEST[ $search_query_arg ] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $r = wp_parse_args( $args, array(&nbsp;</div></li><li><div>      'group_id' =&gt; bp_get_current_group_id(), &nbsp;</div></li><li><div>      'page' =&gt; 1, &nbsp;</div></li><li><div>      'per_page' =&gt; 20, &nbsp;</div></li><li><div>      'max' =&gt; false, &nbsp;</div></li><li><div>      'exclude' =&gt; false, &nbsp;</div></li><li><div>      'exclude_admins_mods' =&gt; $exclude_admins_mods, &nbsp;</div></li><li><div>      'exclude_banned' =&gt; 1, &nbsp;</div></li><li><div>      'group_role' =&gt; false, &nbsp;</div></li><li><div>      'search_terms' =&gt; $search_terms_default, &nbsp;</div></li><li><div>      'type' =&gt; 'last_joined', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_null( $r['search_terms'] ) && ! empty( $_REQUEST['s'] ) ) {&nbsp;</div></li><li><div>      $r['search_terms'] = $_REQUEST['s'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $members_template = new BP_Groups_Group_Members_Template( $r );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether or not a group member query has members to display.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool                             $value            Whether there are members to display.</span>&nbsp;</div></li><li><div><span class="comment">   * @param BP_Groups_Group_Members_Template $members_template Object holding the member query results.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_group_has_members', $members_template-&gt;has_members(), $members_template );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return mixed</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_members() {&nbsp;</div></li><li><div>  global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $members_template-&gt;members();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return mixed</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_the_member() {&nbsp;</div></li><li><div>  global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $members_template-&gt;the_member();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the group member avatar while in the groups members loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args {@see bp_core_fetch_avatar()}.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_avatar( $args = '' ) {&nbsp;</div></li><li><div>  echo bp_get_group_member_avatar( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the group member avatar while in the groups members loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $args {@see bp_core_fetch_avatar()}.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_avatar( $args = '' ) {&nbsp;</div></li><li><div>      global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r = bp_parse_args( $args, array(&nbsp;</div></li><li><div>          'item_id' =&gt; $members_template-&gt;member-&gt;user_id, &nbsp;</div></li><li><div>          'type' =&gt; 'full', &nbsp;</div></li><li><div>          'email' =&gt; $members_template-&gt;member-&gt;user_email, &nbsp;</div></li><li><div>          'alt' =&gt; sprintf( __( 'Profile picture of %s', 'buddypress' ), $members_template-&gt;member-&gt;display_name )&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group member avatar while in the groups members loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value HTML markup for group member avatar.</span>&nbsp;</div></li><li><div><span class="comment">       * @param array  $r     Parsed args used for the avatar query.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_avatar', bp_core_fetch_avatar( $r ), $r );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the group member avatar while in the groups members loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args {@see bp_core_fetch_avatar()}.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_avatar_thumb( $args = '' ) {&nbsp;</div></li><li><div>  echo bp_get_group_member_avatar_thumb( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the group member avatar while in the groups members loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $args {@see bp_core_fetch_avatar()}.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_avatar_thumb( $args = '' ) {&nbsp;</div></li><li><div>      global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r = bp_parse_args( $args, array(&nbsp;</div></li><li><div>          'item_id' =&gt; $members_template-&gt;member-&gt;user_id, &nbsp;</div></li><li><div>          'type' =&gt; 'thumb', &nbsp;</div></li><li><div>          'email' =&gt; $members_template-&gt;member-&gt;user_email, &nbsp;</div></li><li><div>          'alt' =&gt; sprintf( __( 'Profile picture of %s', 'buddypress' ), $members_template-&gt;member-&gt;display_name )&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group member avatar thumb while in the groups members loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value HTML markup for group member avatar thumb.</span>&nbsp;</div></li><li><div><span class="comment">       * @param array  $r     Parsed args used for the avatar query.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_avatar_thumb', bp_core_fetch_avatar( $r ), $r );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the group member avatar while in the groups members loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $width  Width of avatar to fetch.</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $height Height of avatar to fetch.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_avatar_mini( $width = 30, $height = 30 ) {&nbsp;</div></li><li><div>  echo bp_get_group_member_avatar_mini( $width, $height );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Output the group member avatar while in the groups members loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $width  Width of avatar to fetch.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $height Height of avatar to fetch.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_avatar_mini( $width = 30, $height = 30 ) {&nbsp;</div></li><li><div>      global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r = bp_parse_args( array(), array(&nbsp;</div></li><li><div>          'item_id' =&gt; $members_template-&gt;member-&gt;user_id, &nbsp;</div></li><li><div>          'type' =&gt; 'thumb', &nbsp;</div></li><li><div>          'email' =&gt; $members_template-&gt;member-&gt;user_email, &nbsp;</div></li><li><div>          'alt' =&gt; sprintf( __( 'Profile picture of %s', 'buddypress' ), $members_template-&gt;member-&gt;display_name ), &nbsp;</div></li><li><div>          'width' =&gt; absint( $width ), &nbsp;</div></li><li><div>          'height' =&gt; absint( $height )&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group member avatar mini while in the groups members loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value HTML markup for group member avatar mini.</span>&nbsp;</div></li><li><div><span class="comment">       * @param array  $r     Parsed args used for the avatar query.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_avatar_mini', bp_core_fetch_avatar( $r ), $r );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_name() {&nbsp;</div></li><li><div>  echo bp_get_group_member_name();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_name() {&nbsp;</div></li><li><div>      global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group member display name of the current user in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $display_name Display name of the current user.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_name', $members_template-&gt;member-&gt;display_name );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_url() {&nbsp;</div></li><li><div>  echo bp_get_group_member_url();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_url() {&nbsp;</div></li><li><div>      global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group member url for the current user in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL for the current user.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_url', bp_core_get_user_domain( $members_template-&gt;member-&gt;user_id, $members_template-&gt;member-&gt;user_nicename, $members_template-&gt;member-&gt;user_login ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_link() {&nbsp;</div></li><li><div>  echo bp_get_group_member_link();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_link() {&nbsp;</div></li><li><div>      global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group member HTML link for the current user in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value HTML link for the current user.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_link', '&lt;a href=&quot;' . bp_core_get_user_domain( $members_template-&gt;member-&gt;user_id, $members_template-&gt;member-&gt;user_nicename, $members_template-&gt;member-&gt;user_login ) . '&quot;&gt;' . $members_template-&gt;member-&gt;display_name . '&lt;/a&gt;' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_domain() {&nbsp;</div></li><li><div>  echo bp_get_group_member_domain();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_domain() {&nbsp;</div></li><li><div>      global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group member domain for the current user in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Domain for the current user.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_domain', bp_core_get_user_domain( $members_template-&gt;member-&gt;user_id, $members_template-&gt;member-&gt;user_nicename, $members_template-&gt;member-&gt;user_login ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_is_friend() {&nbsp;</div></li><li><div>  echo bp_get_group_member_is_friend();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_is_friend() {&nbsp;</div></li><li><div>      global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !isset( $members_template-&gt;member-&gt;is_friend ) ) {&nbsp;</div></li><li><div>          $friend_status = 'not_friends';&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $friend_status = ( 0 == $members_template-&gt;member-&gt;is_friend )&nbsp;</div></li><li><div>              ? 'pending'&nbsp;</div></li><li><div>              : 'is_friend';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the friendship status between current user and displayed user in group member loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $friend_status Current status of the friendship.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_is_friend', $friend_status );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_is_banned() {&nbsp;</div></li><li><div>  echo bp_get_group_member_is_banned();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_is_banned() {&nbsp;</div></li><li><div>      global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters whether the member is banned from the current group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param bool $is_banned Whether or not the member is banned.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_is_banned', $members_template-&gt;member-&gt;is_banned );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.2.6</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_css_class() {&nbsp;</div></li><li><div>  global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $members_template-&gt;member-&gt;is_banned ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the class to add to the HTML if member is banned.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.6</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value HTML class to add.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      echo apply_filters( 'bp_group_member_css_class', 'banned-user' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the joined date for the current member in the group member loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0 Added $args as a parameter.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args {@see bp_get_group_member_joined_since()}</span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_joined_since( $args = array() ) {&nbsp;</div></li><li><div>  echo bp_get_group_member_joined_since( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the joined date for the current member in the group member loop.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0 Added $args as a parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment">   *     Array of optional parameters.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   *     @type bool $relative Optional. If true, returns relative joined date. eg. joined 5 months ago.</span>&nbsp;</div></li><li><div><span class="comment">   *                          If false, returns joined date value from database. Default: true.</span>&nbsp;</div></li><li><div><span class="comment">   * }</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_joined_since( $args = array() ) {&nbsp;</div></li><li><div>      global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r = wp_parse_args( $args, array(&nbsp;</div></li><li><div>          'relative' =&gt; true, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// We do not want relative time, so return now.</span></span></span>&nbsp;</div></li><li><div>      <span class="comment">// @todo Should the 'bp_get_group_member_joined_since' filter be applied here?</span>&nbsp;</div></li><li><div>      if ( ! $r['relative'] ) {&nbsp;</div></li><li><div>          return esc_attr( $members_template-&gt;member-&gt;date_modified );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the joined since time for the current member in the loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Joined since time.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_joined_since', bp_core_get_last_activity( $members_template-&gt;member-&gt;date_modified, __( 'joined %s', 'buddypress') ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_id() {&nbsp;</div></li><li><div>  echo bp_get_group_member_id();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_id() {&nbsp;</div></li><li><div>      global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the member's user ID for group members loop.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param int $user_id User ID of the member.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_id', $members_template-&gt;member-&gt;user_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_needs_pagination() {&nbsp;</div></li><li><div>  global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $members_template-&gt;total_member_count &gt; $members_template-&gt;pag_num ) {&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_pag_id() {&nbsp;</div></li><li><div>  echo bp_get_group_pag_id();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_pag_id() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the string to be used as the group pag id.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Value to use for the pag id.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_pag_id', 'pag' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_pagination() {&nbsp;</div></li><li><div>  echo bp_get_group_member_pagination();&nbsp;</div></li><li><div>  wp_nonce_field( 'bp_groups_member_list', '_member_pag_nonce' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_pagination() {&nbsp;</div></li><li><div>      global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the HTML markup to be used for group member listing pagination.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $pag_links HTML markup for the pagination.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_pagination', $members_template-&gt;pag_links );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_pagination_count() {&nbsp;</div></li><li><div>  echo bp_get_group_member_pagination_count();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_pagination_count() {&nbsp;</div></li><li><div>      global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $start_num = intval( ( $members_template-&gt;pag_page - 1 ) * $members_template-&gt;pag_num ) + 1;&nbsp;</div></li><li><div>      $from_num = bp_core_number_format( $start_num );&nbsp;</div></li><li><div>      $to_num = bp_core_number_format( ( $start_num + ( $members_template-&gt;pag_num - 1 ) &gt; $members_template-&gt;total_member_count ) ? $members_template-&gt;total_member_count : $start_num + ( $members_template-&gt;pag_num - 1 ) );&nbsp;</div></li><li><div>      $total = bp_core_number_format( $members_template-&gt;total_member_count );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 1 == $members_template-&gt;total_member_count ) {&nbsp;</div></li><li><div>          $message = __( 'Viewing 1 member', 'buddypress' );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $message = sprintf( _n( 'Viewing %1$s - %2$s of %3$s member', 'Viewing %1$s - %2$s of %3$s members', $members_template-&gt;total_member_count, 'buddypress' ), $from_num, $to_num, $total );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the &quot;Viewing x-y of z members&quot; pagination message.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value    &quot;Viewing x-y of z members&quot; text.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $from_num Total amount for the low value in the range.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $to_num   Total amount for the high value in the range.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $total    Total amount of members found.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_member_pagination_count', $message, $from_num, $to_num, $total );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_member_admin_pagination() {&nbsp;</div></li><li><div>  echo bp_get_group_member_admin_pagination();&nbsp;</div></li><li><div>  wp_nonce_field( 'bp_groups_member_admin_list', '_member_admin_pag_nonce' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_member_admin_pagination() {&nbsp;</div></li><li><div>      global $members_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $members_template-&gt;pag_links;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the contents of the current group's home page.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * You should only use this when on a single group page.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.4.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_front_template_part() {&nbsp;</div></li><li><div>  $located = bp_groups_get_front_template();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( false !== $located ) {&nbsp;</div></li><li><div>      $slug = str_replace( '.php', '', $located );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Let plugins adding an action to bp_get_template_part get it from here</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $slug Template part slug requested.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $name Template part name requested.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      do_action( 'get_template_part_' . $slug, $slug, false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      load_template( $located, true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } else if ( bp_is_active( 'activity' ) ) {&nbsp;</div></li><li><div>      bp_get_template_part( 'groups/single/activity' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } else if ( bp_is_active( 'members' ) ) {&nbsp;</div></li><li><div>      bp_groups_members_template_part();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $located;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Locate a custom group front template if it exists.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.4.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.6.0 Adds the Group Type to the front template hierarchy.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param  BP_Groups_Group|null $group Optional. Falls back to current group if not passed.</span>&nbsp;</div></li><li><div><span class="comment"> * @return string|bool                 Path to front template on success; boolean false on failure.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_get_front_template( $group = null ) {&nbsp;</div></li><li><div>  if ( ! is_a( $group, 'BP_Groups_Group' ) ) {&nbsp;</div></li><li><div>      $group = groups_get_current_group();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! isset( $group-&gt;id ) ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $group-&gt;front_template ) ) {&nbsp;</div></li><li><div>      return $group-&gt;front_template;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $template_names = array(&nbsp;</div></li><li><div>      'groups/single/front-id-'     . sanitize_file_name( $group-&gt;id )     . '.php', &nbsp;</div></li><li><div>      'groups/single/front-slug-'   . sanitize_file_name( $group-&gt;slug )   . '.php', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( bp_groups_get_group_types() ) {&nbsp;</div></li><li><div>      $group_type = bp_groups_get_group_type( $group-&gt;id );&nbsp;</div></li><li><div>      if ( ! $group_type ) {&nbsp;</div></li><li><div>          $group_type = 'none';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $template_names[] = 'groups/single/front-group-type-' . sanitize_file_name( $group_type )   . '.php';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $template_names = array_merge( $template_names, array(&nbsp;</div></li><li><div>      'groups/single/front-status-' . sanitize_file_name( $group-&gt;status ) . '.php', &nbsp;</div></li><li><div>      'groups/single/front.php'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the hierarchy of group front templates corresponding to a specific group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.4.0</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.5.0 Added the `$group` parameter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $template_names Array of template paths.</span>&nbsp;</div></li><li><div><span class="comment">   * @param object $group          Group object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return bp_locate_template( apply_filters( 'bp_groups_get_front_template', $template_names, $group ), false, true );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the Group members template</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_members_template_part() {&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;div class=&quot;item-list-tabs&quot; id=&quot;subnav&quot; aria-label=&quot;&lt;?php esc_attr_e( 'Group secondary navigation', 'buddypress' ); ?&gt;&quot; role=&quot;navigation&quot;&gt;&nbsp;</div></li><li><div>      &lt;ul&gt;&nbsp;</div></li><li><div>          &lt;li class=&quot;groups-members-search&quot; role=&quot;search&quot;&gt;&nbsp;</div></li><li><div>              &lt;?php bp_directory_members_search_form(); ?&gt;&nbsp;</div></li><li><div>          &lt;/li&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php bp_groups_members_filter(); ?&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Fires at the end of the group members search unordered list.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * Part of bp_groups_members_template_part().</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          do_action( 'bp_members_directory_member_sub_types' ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;/ul&gt;&nbsp;</div></li><li><div>  &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;h2 class=&quot;bp-screen-reader-text&quot;&gt;&lt;?php&nbsp;</div></li><li><div>      <span class="comment">/** translators: accessibility text */</span>&nbsp;</div></li><li><div>      _e( 'Members', 'buddypress' );&nbsp;</div></li><li><div>  ?&gt;&lt;/h2&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;div id=&quot;members-group-list&quot; class=&quot;group_members dir-list&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php bp_get_template_part( 'groups/single/members' ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;/div&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the Group members filters</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_members_filter() {&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;li id=&quot;group_members-order-select&quot; class=&quot;last filter&quot;&gt;&nbsp;</div></li><li><div>      &lt;label for=&quot;group_members-order-by&quot;&gt;&lt;?php _e( 'Order By:', 'buddypress' ); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>      &lt;select id=&quot;group_members-order-by&quot;&gt;&nbsp;</div></li><li><div>          &lt;option value=&quot;last_joined&quot;&gt;&lt;?php _e( 'Newest', 'buddypress' ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>          &lt;option value=&quot;first_joined&quot;&gt;&lt;?php _e( 'Oldest', 'buddypress' ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php if ( bp_is_active( 'activity' ) ) : ?&gt;&nbsp;</div></li><li><div>              &lt;option value=&quot;group_activity&quot;&gt;&lt;?php _e( 'Group Activity', 'buddypress' ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>          &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;option value=&quot;alphabetical&quot;&gt;&lt;?php _e( 'Alphabetical', 'buddypress' ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Fires at the end of the Group members filters select input.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * Useful for plugins to add more filter options.</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          do_action( 'bp_groups_members_order_options' ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;/select&gt;&nbsp;</div></li><li><div>  &lt;/li&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Group Creation Process Template Tags</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Determine if the current logged in user can create groups.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if user can create groups. False otherwise.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_user_can_create_groups() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Super admin can always create groups.</span>&nbsp;</div></li><li><div>  if ( bp_current_user_can( 'bp_moderate' ) ) {&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Get group creation option, default to 0 (allowed).</span>&nbsp;</div></li><li><div>  $restricted = (int) bp_get_option( 'bp_restrict_group_creation', 0 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Allow by default.</span>&nbsp;</div></li><li><div>  $can_create = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Are regular users restricted?</span>&nbsp;</div></li><li><div>  if ( $restricted ) {&nbsp;</div></li><li><div>      $can_create = false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters if the current logged in user can create groups.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $can_create Whether the person can create groups.</span>&nbsp;</div></li><li><div><span class="comment">   * @param int  $restricted Whether or not group creation is restricted.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_user_can_create_groups', $can_create, $restricted );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_creation_tabs() {&nbsp;</div></li><li><div>  $bp = buddypress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !is_array( $bp-&gt;groups-&gt;group_creation_steps ) ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !bp_get_groups_current_create_step() ) {&nbsp;</div></li><li><div>      $keys = array_keys( $bp-&gt;groups-&gt;group_creation_steps );&nbsp;</div></li><li><div>      $bp-&gt;groups-&gt;current_create_step = array_shift( $keys );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $counter = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( (array) $bp-&gt;groups-&gt;group_creation_steps as $slug =&gt; $step ) {&nbsp;</div></li><li><div>      $is_enabled = bp_are_previous_group_creation_steps_complete( $slug ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;li&lt;?php if ( bp_get_groups_current_create_step() == $slug ) : ?&gt; class=&quot;current&quot;&lt;?php endif; ?&gt;&gt;&lt;?php if ( $is_enabled ) : ?&gt;&lt;a href=&quot;&lt;?php bp_groups_directory_permalink(); ?&gt;create/step/&lt;?php echo $slug ?&gt;/&quot;&gt;&lt;?php else: ?&gt;&lt;span&gt;&lt;?php endif; ?&gt;&lt;?php echo $counter ?&gt;. &lt;?php echo $step['name'] ?&gt;&lt;?php if ( $is_enabled ) : ?&gt;&lt;/a&gt;&lt;?php else: ?&gt;&lt;/span&gt;&lt;?php endif ?&gt;&lt;/li&gt;&lt;?php&nbsp;</div></li><li><div>      $counter++;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  unset( $is_enabled );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Fires at the end of the creation of the group tabs.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  do_action( 'groups_creation_tabs' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_creation_stage_title() {&nbsp;</div></li><li><div>  $bp = buddypress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the group creation stage title.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $value HTML markup for the group creation stage title.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo apply_filters( 'bp_group_creation_stage_title', '&lt;span&gt;&mdash; ' . $bp-&gt;groups-&gt;group_creation_steps[bp_get_groups_current_create_step()]['name'] . '&lt;/span&gt;' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_creation_form_action() {&nbsp;</div></li><li><div>  echo bp_get_group_creation_form_action();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>  function bp_get_group_creation_form_action() {&nbsp;</div></li><li><div>      $bp = buddypress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !bp_action_variable( 1 ) ) {&nbsp;</div></li><li><div>          $keys = array_keys( $bp-&gt;groups-&gt;group_creation_steps );&nbsp;</div></li><li><div>          $bp-&gt;action_variables[1] = array_shift( $keys );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group creation form action.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Action to be used with group creation form.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_creation_form_action', trailingslashit( bp_get_groups_directory_permalink() . 'create/step/' . bp_action_variable( 1 ) ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $step_slug</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_is_group_creation_step( $step_slug ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Make sure we are in the groups component.</span>&nbsp;</div></li><li><div>  if ( ! bp_is_groups_component() || ! bp_is_current_action( 'create' ) ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $bp = buddypress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// If this the first step, we can just accept and return true.</span>&nbsp;</div></li><li><div>  $keys = array_keys( $bp-&gt;groups-&gt;group_creation_steps );&nbsp;</div></li><li><div>  if ( !bp_action_variable( 1 ) && array_shift( $keys ) == $step_slug ) {&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Before allowing a user to see a group creation step we must make sure</span>&nbsp;</div></li><li><div>  <span class="comment">// previous steps are completed.</span>&nbsp;</div></li><li><div>  if ( !bp_is_first_group_creation_step() ) {&nbsp;</div></li><li><div>      if ( !bp_are_previous_group_creation_steps_complete( $step_slug ) ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Check the current step against the step parameter.</span>&nbsp;</div></li><li><div>  if ( bp_is_action_variable( $step_slug ) ) {&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $step_slugs</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_is_group_creation_step_complete( $step_slugs ) {&nbsp;</div></li><li><div>  $bp = buddypress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !isset( $bp-&gt;groups-&gt;completed_create_steps ) ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_array( $step_slugs ) ) {&nbsp;</div></li><li><div>      $found = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( (array) $step_slugs as $step_slug ) {&nbsp;</div></li><li><div>          if ( !in_array( $step_slug, $bp-&gt;groups-&gt;completed_create_steps ) ) {&nbsp;</div></li><li><div>              $found = false;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $found;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      return in_array( $step_slugs, $bp-&gt;groups-&gt;completed_create_steps );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return true;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $step_slug</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_are_previous_group_creation_steps_complete( $step_slug ) {&nbsp;</div></li><li><div>  $bp = buddypress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// If this is the first group creation step, return true.</span>&nbsp;</div></li><li><div>  $keys = array_keys( $bp-&gt;groups-&gt;group_creation_steps );&nbsp;</div></li><li><div>  if ( array_shift( $keys ) == $step_slug ) {&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  reset( $bp-&gt;groups-&gt;group_creation_steps );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $previous_steps = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Get previous steps.</span>&nbsp;</div></li><li><div>  foreach ( (array) $bp-&gt;groups-&gt;group_creation_steps as $slug =&gt; $name ) {&nbsp;</div></li><li><div>      if ( $slug === $step_slug ) {&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $previous_steps[] = $slug;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return bp_is_group_creation_step_complete( $previous_steps );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_new_group_id() {&nbsp;</div></li><li><div>  echo bp_get_new_group_id();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_new_group_id() {&nbsp;</div></li><li><div>      $bp = buddypress();&nbsp;</div></li><li><div>      $new_group_id = isset( $bp-&gt;groups-&gt;new_group_id )&nbsp;</div></li><li><div>          ? $bp-&gt;groups-&gt;new_group_id&nbsp;</div></li><li><div>          : 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the new group ID.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param int $new_group_id ID of the new group.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return (int) apply_filters( 'bp_get_new_group_id', $new_group_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_new_group_name() {&nbsp;</div></li><li><div>  echo bp_get_new_group_name();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_new_group_name() {&nbsp;</div></li><li><div>      $bp = buddypress();&nbsp;</div></li><li><div>      $name = isset( $bp-&gt;groups-&gt;current_group-&gt;name )&nbsp;</div></li><li><div>          ? $bp-&gt;groups-&gt;current_group-&gt;name&nbsp;</div></li><li><div>          : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the new group name.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $name Name of the new group.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_new_group_name', $name );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_new_group_description() {&nbsp;</div></li><li><div>  echo bp_get_new_group_description();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_new_group_description() {&nbsp;</div></li><li><div>      $bp = buddypress();&nbsp;</div></li><li><div>      $description = isset( $bp-&gt;groups-&gt;current_group-&gt;description )&nbsp;</div></li><li><div>          ? $bp-&gt;groups-&gt;current_group-&gt;description&nbsp;</div></li><li><div>          : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the new group description.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $name Description of the new group.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_new_group_description', $description );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_new_group_enable_forum() {&nbsp;</div></li><li><div>  echo bp_get_new_group_enable_forum();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return int</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_new_group_enable_forum() {&nbsp;</div></li><li><div>      $bp = buddypress();&nbsp;</div></li><li><div>      $forum = isset( $bp-&gt;groups-&gt;current_group-&gt;enable_forum )&nbsp;</div></li><li><div>          ? $bp-&gt;groups-&gt;current_group-&gt;enable_forum&nbsp;</div></li><li><div>          : false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters whether or not to enable forums for the new group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param int $forum Whether or not to enable forums.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return (int) apply_filters( 'bp_get_new_group_enable_forum', $forum );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_new_group_status() {&nbsp;</div></li><li><div>  echo bp_get_new_group_status();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_new_group_status() {&nbsp;</div></li><li><div>      $bp = buddypress();&nbsp;</div></li><li><div>      $status = isset( $bp-&gt;groups-&gt;current_group-&gt;status )&nbsp;</div></li><li><div>          ? $bp-&gt;groups-&gt;current_group-&gt;status&nbsp;</div></li><li><div>          : 'public';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the new group status.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $status Status for the new group.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_new_group_status', $status );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the avatar for the group currently being created</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see bp_core_fetch_avatar() For more information on accepted arguments</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args See bp_core_fetch_avatar().</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_new_group_avatar( $args = '' ) {&nbsp;</div></li><li><div>  echo bp_get_new_group_avatar( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the avatar for the group currently being created</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @see bp_core_fetch_avatar() For a description of arguments and return values.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment">   *     Arguments are listed here with an explanation of their defaults.</span>&nbsp;</div></li><li><div><span class="comment">   *     For more information about the arguments, see {@link bp_core_fetch_avatar()}.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string   $alt     Default: 'Group photo'.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string   $class   Default: 'avatar'.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string   $type    Default: 'full'.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type int|bool $width   Default: false.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type int|bool $height  Default: false.</span>&nbsp;</div></li><li><div><span class="comment">   *     @type string   $id      Passed to $css_id parameter. Default: 'avatar-crop-preview'.</span>&nbsp;</div></li><li><div><span class="comment">   * }</span>&nbsp;</div></li><li><div><span class="comment">   * @return string       The avatar for the group being created</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_new_group_avatar( $args = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Parse arguments.</span></span>&nbsp;</div></li><li><div>      $r = bp_parse_args( $args, array(&nbsp;</div></li><li><div>          'type' =&gt; 'full', &nbsp;</div></li><li><div>          'width' =&gt; false, &nbsp;</div></li><li><div>          'height' =&gt; false, &nbsp;</div></li><li><div>          'class' =&gt; 'avatar', &nbsp;</div></li><li><div>          'id' =&gt; 'avatar-crop-preview', &nbsp;</div></li><li><div>          'alt' =&gt; __( 'Group photo', 'buddypress' ), &nbsp;</div></li><li><div> ), 'get_new_group_avatar' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Merge parsed arguments with object specific data.</span>&nbsp;</div></li><li><div>      $r = array_merge( $r, array(&nbsp;</div></li><li><div>          'item_id' =&gt; bp_get_current_group_id(), &nbsp;</div></li><li><div>          'object' =&gt; 'group', &nbsp;</div></li><li><div>          'avatar_dir' =&gt; 'group-avatars', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get the avatar.</span>&nbsp;</div></li><li><div>      $avatar = bp_core_fetch_avatar( $r );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the new group avatar.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $avatar HTML markup for the new group avatar.</span>&nbsp;</div></li><li><div><span class="comment">       * @param array  $r      Array of parsed arguments for the group avatar.</span>&nbsp;</div></li><li><div><span class="comment">       * @param array  $args   Array of original arguments passed to the function.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_new_group_avatar', $avatar, $r, $args );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Escape & output the URL to the previous group creation step</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_creation_previous_link() {&nbsp;</div></li><li><div>  echo esc_url( bp_get_group_creation_previous_link() );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the URL to the previous group creation step</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_creation_previous_link() {&nbsp;</div></li><li><div>      $bp = buddypress();&nbsp;</div></li><li><div>      $steps = array_keys( $bp-&gt;groups-&gt;group_creation_steps );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Loop through steps.</span>&nbsp;</div></li><li><div>      foreach ( $steps as $slug ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Break when the current step is found.</span>&nbsp;</div></li><li><div>          if ( bp_is_action_variable( $slug ) ) {&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Add slug to previous steps.</span>&nbsp;</div></li><li><div>          $previous_steps[] = $slug;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Generate the URL for the previous step.</span>&nbsp;</div></li><li><div>      $group_directory = bp_get_groups_directory_permalink();&nbsp;</div></li><li><div>      $create_step = 'create/step/';&nbsp;</div></li><li><div>      $previous_step = array_pop( $previous_steps );&nbsp;</div></li><li><div>      $url = trailingslashit( $group_directory . $create_step . $previous_step );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the permalink for the previous step with the group creation process.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $url Permalink for the previous step.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_creation_previous_link', $url );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Echoes the current group creation step.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.6.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_current_create_step() {&nbsp;</div></li><li><div>  echo bp_get_groups_current_create_step();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns the current group creation step. If none is found, returns an empty string.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.6.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string $current_create_step</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_groups_current_create_step() {&nbsp;</div></li><li><div>      $bp = buddypress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !empty( $bp-&gt;groups-&gt;current_create_step ) ) {&nbsp;</div></li><li><div>          $current_create_step = $bp-&gt;groups-&gt;current_create_step;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $current_create_step = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the current group creation step.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * If none is found, returns an empty string.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.6.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $current_create_step Current step in the group creation process.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_groups_current_create_step', $current_create_step );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Is the user looking at the last step in the group creation process.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $step Step to compare.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if yes, False if no</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_is_last_group_creation_step( $step = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Use current step, if no step passed.</span></span>&nbsp;</div></li><li><div>  if ( empty( $step ) ) {&nbsp;</div></li><li><div>      $step = bp_get_groups_current_create_step();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Get the last step.</span>&nbsp;</div></li><li><div>  $bp = buddypress();&nbsp;</div></li><li><div>  $steps = array_keys( $bp-&gt;groups-&gt;group_creation_steps );&nbsp;</div></li><li><div>  $l_step = array_pop( $steps );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Compare last step to step.</span>&nbsp;</div></li><li><div>  $retval = ( $l_step === $step );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether or not user is looking at last step in group creation process.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool   $retval Whether or not we are looking at last step.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $steps  Array of steps from the group creation process.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $step   Step to compare.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bp_is_last_group_creation_step', $retval, $steps, $step );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Is the user looking at the first step in the group creation process</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $step Step to compare.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if yes, False if no</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_is_first_group_creation_step( $step = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Use current step, if no step passed.</span></span>&nbsp;</div></li><li><div>  if ( empty( $step ) ) {&nbsp;</div></li><li><div>      $step = bp_get_groups_current_create_step();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Get the first step.</span>&nbsp;</div></li><li><div>  $bp = buddypress();&nbsp;</div></li><li><div>  $steps = array_keys( $bp-&gt;groups-&gt;group_creation_steps );&nbsp;</div></li><li><div>  $f_step = array_shift( $steps );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Compare first step to step.</span>&nbsp;</div></li><li><div>  $retval = ( $f_step === $step );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether or not user is looking at first step in group creation process.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool   $retval Whether or not we are looking at first step.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $steps  Array of steps from the group creation process.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $step   Step to compare.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bp_is_first_group_creation_step', $retval, $steps, $step );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output a list of friends who can be invited to a group</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Array of arguments for friends list output.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_new_group_invite_friend_list( $args = array() ) {&nbsp;</div></li><li><div>  echo bp_get_new_group_invite_friend_list( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return a list of friends who can be invited to a group</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Array of arguments for friends list output.</span>&nbsp;</div></li><li><div><span class="comment">   * @return false|string HTML list of checkboxes, or false</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_new_group_invite_friend_list( $args = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Bail if no friends component.</span>&nbsp;</div></li><li><div>      if ( ! bp_is_active( 'friends' ) ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Parse arguments.</span></span>&nbsp;</div></li><li><div>      $r = wp_parse_args( $args, array(&nbsp;</div></li><li><div>          'user_id' =&gt; bp_loggedin_user_id(), &nbsp;</div></li><li><div>          'group_id' =&gt; false, &nbsp;</div></li><li><div>          'separator' =&gt; 'li'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// No group passed, so look for new or current group ID's.</span>&nbsp;</div></li><li><div>      if ( empty( $r['group_id'] ) ) {&nbsp;</div></li><li><div>          $bp = buddypress();&nbsp;</div></li><li><div>          $r['group_id'] = ! empty( $bp-&gt;groups-&gt;new_group_id )&nbsp;</div></li><li><div>              ? $bp-&gt;groups-&gt;new_group_id&nbsp;</div></li><li><div>              : $bp-&gt;groups-&gt;current_group-&gt;id;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Setup empty items array.</span>&nbsp;</div></li><li><div>      $items = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get user's friends who are not in this group already.</span>&nbsp;</div></li><li><div>      $friends = friends_get_friends_invite_list( $r['user_id'], $r['group_id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $friends ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Get already invited users.</span>&nbsp;</div></li><li><div>          $invites = groups_get_invites_for_group( $r['user_id'], $r['group_id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          for ( $i = 0, $count = count( $friends ); $i &lt; $count; ++$i ) {&nbsp;</div></li><li><div>              $checked = in_array( (int) $friends[ $i ]['id'], (array) $invites );&nbsp;</div></li><li><div>              $items[] = '&lt;' . $r['separator'] . '&gt;&lt;label for=&quot;f-' . esc_attr( $friends[ $i ]['id'] ) . '&quot;&gt;&lt;input' . checked( $checked, true, false ) . ' type=&quot;checkbox&quot; name=&quot;friends[]&quot; id=&quot;f-' . esc_attr( $friends[ $i ]['id'] ) . '&quot; value=&quot;' . esc_attr( $friends[ $i ]['id'] ) . '&quot; /&gt; ' . esc_html( $friends[ $i ]['full_name'] ) . '&lt;/label&gt;&lt;/' . $r['separator'] . '&gt;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the array of friends who can be invited to a group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.4.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $items Array of friends.</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $r     Parsed arguments from bp_get_new_group_invite_friend_list()</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $args  Unparsed arguments from bp_get_new_group_invite_friend_list()</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $invitable_friends = apply_filters( 'bp_get_new_group_invite_friend_list', $items, $r, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $invitable_friends ) && is_array( $invitable_friends ) ) {&nbsp;</div></li><li><div>          $retval = implode( &quot;\n&quot;, $invitable_friends );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $retval = false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $retval;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_directory_groups_search_form() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $query_arg = bp_core_get_component_search_query_arg( 'groups' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $_REQUEST[ $query_arg ] ) ) {&nbsp;</div></li><li><div>      $search_value = stripslashes( $_REQUEST[ $query_arg ] );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $search_value = bp_get_search_default_text( 'groups' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $search_form_html = '&lt;form action=&quot;&quot; method=&quot;get&quot; id=&quot;search-groups-form&quot;&gt;&nbsp;</div></li><li><div>      &lt;label for=&quot;groups_search&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;' . esc_attr( $query_arg ) . '&quot; id=&quot;groups_search&quot; placeholder=&quot;'. esc_attr( $search_value ) .'&quot; /&gt;&lt;/label&gt;&nbsp;</div></li><li><div>      &lt;input type=&quot;submit&quot; id=&quot;groups_search_submit&quot; name=&quot;groups_search_submit&quot; value=&quot;'. __( 'Search', 'buddypress' ) .'&quot; /&gt;&nbsp;</div></li><li><div>  &lt;/form&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the HTML markup for the groups search form.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.9.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $search_form_html HTML markup for the search form.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo apply_filters( 'bp_directory_groups_search_form', $search_form_html );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays group header tabs.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @todo Deprecate?</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_header_tabs() {&nbsp;</div></li><li><div>  $user_groups = bp_displayed_user_domain() . bp_get_groups_slug(); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;li&lt;?php if ( !bp_action_variable( 0 ) || bp_is_action_variable( 'recently-active', 0 ) ) : ?&gt; class=&quot;current&quot;&lt;?php endif; ?&gt;&gt;&lt;a href=&quot;&lt;?php echo trailingslashit( $user_groups . '/my-groups/recently-active' ); ?&gt;&quot;&gt;&lt;?php _e( 'Recently Active', 'buddypress' ); ?&gt;&lt;/a&gt;&lt;/li&gt;&nbsp;</div></li><li><div>  &lt;li&lt;?php if ( bp_is_action_variable( 'recently-joined', 0 ) ) : ?&gt; class=&quot;current&quot;&lt;?php endif; ?&gt;&gt;&lt;a href=&quot;&lt;?php echo trailingslashit( $user_groups . '/my-groups/recently-joined' ); ?&gt;&quot;&gt;&lt;?php _e( 'Recently Joined', 'buddypress' ); ?&gt;&lt;/a&gt;&lt;/li&gt;&nbsp;</div></li><li><div>  &lt;li&lt;?php if ( bp_is_action_variable( 'most-popular', 0 ) ) : ?&gt; class=&quot;current&quot;&lt;?php endif; ?&gt;&gt;&lt;a href=&quot;&lt;?php echo trailingslashit( $user_groups . '/my-groups/most-popular' ); ?&gt;&quot;&gt;&lt;?php _e( 'Most Popular', 'buddypress' ); ?&gt;&lt;/a&gt;&lt;/li&gt;&nbsp;</div></li><li><div>  &lt;li&lt;?php if ( bp_is_action_variable( 'admin-of', 0 ) ) : ?&gt; class=&quot;current&quot;&lt;?php endif; ?&gt;&gt;&lt;a href=&quot;&lt;?php echo trailingslashit( $user_groups . '/my-groups/admin-of' ); ?&gt;&quot;&gt;&lt;?php _e( 'Administrator Of', 'buddypress' ); ?&gt;&lt;/a&gt;&lt;/li&gt;&nbsp;</div></li><li><div>  &lt;li&lt;?php if ( bp_is_action_variable( 'mod-of', 0 ) ) : ?&gt; class=&quot;current&quot;&lt;?php endif; ?&gt;&gt;&lt;a href=&quot;&lt;?php echo trailingslashit( $user_groups . '/my-groups/mod-of' ); ?&gt;&quot;&gt;&lt;?php _e( 'Moderator Of', 'buddypress' ); ?&gt;&lt;/a&gt;&lt;/li&gt;&nbsp;</div></li><li><div>  &lt;li&lt;?php if ( bp_is_action_variable( 'alphabetically' ) ) : ?&gt; class=&quot;current&quot;&lt;?php endif; ?&gt;&gt;&lt;a href=&quot;&lt;?php echo trailingslashit( $user_groups . '/my-groups/alphabetically' ); ?&gt;&quot;&gt;&lt;?php _e( 'Alphabetically', 'buddypress' ); ?&gt;&lt;/a&gt;&lt;/li&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>  do_action( 'groups_header_tabs' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Displays group filter titles.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @todo Deprecate?</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_filter_title() {&nbsp;</div></li><li><div>  $current_filter = bp_action_variable( 0 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  switch ( $current_filter ) {&nbsp;</div></li><li><div>      case 'recently-active': default:&nbsp;</div></li><li><div>          _e( 'Recently Active', 'buddypress' );&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      case 'recently-joined':&nbsp;</div></li><li><div>          _e( 'Recently Joined', 'buddypress' );&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      case 'most-popular':&nbsp;</div></li><li><div>          _e( 'Most Popular', 'buddypress' );&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      case 'admin-of':&nbsp;</div></li><li><div>          _e( 'Administrator Of', 'buddypress' );&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      case 'mod-of':&nbsp;</div></li><li><div>          _e( 'Moderator Of', 'buddypress' );&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      case 'alphabetically':&nbsp;</div></li><li><div>          _e( 'Alphabetically', 'buddypress' );&nbsp;</div></li><li><div>      break;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  do_action( 'bp_groups_filter_title' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Echo the current group type message.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_current_group_directory_type_message() {&nbsp;</div></li><li><div>  echo bp_get_current_group_directory_type_message();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate the current group type message.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_current_group_directory_type_message() {&nbsp;</div></li><li><div>      $type_object = bp_groups_get_group_type_object( bp_get_current_group_directory_type() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $message = sprintf( __( 'Viewing groups of the type: %s', 'buddypress' ), '&lt;strong&gt;' . $type_object-&gt;labels['singular_name'] . '&lt;/strong&gt;' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the current group type message.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.7.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $message Message to filter.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_current_group_type_message', $message );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Is the current page a specific group admin screen?</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $slug Admin screen slug.</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_is_group_admin_screen( $slug = '' ) {&nbsp;</div></li><li><div>  return (bool) ( bp_is_group_admin_page() && bp_is_action_variable( $slug ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Echoes the current group admin tab slug.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.6.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_current_admin_tab() {&nbsp;</div></li><li><div>  echo bp_get_group_current_admin_tab();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns the current group admin tab slug.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.6.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string $tab The current tab's slug.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_current_admin_tab() {&nbsp;</div></li><li><div>      if ( bp_is_groups_component() && bp_is_current_action( 'admin' ) ) {&nbsp;</div></li><li><div>          $tab = bp_action_variable( 0 );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $tab = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the current group admin tab slug.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.6.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $tab Current group admin tab slug.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_current_group_admin_tab', $tab );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Group Avatar Template Tags ************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Outputs the current group avatar.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $type Thumb or full.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_current_avatar( $type = 'thumb' ) {&nbsp;</div></li><li><div>  echo bp_get_group_current_avatar( $type );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns the current group avatar.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $type Thumb or full.</span>&nbsp;</div></li><li><div><span class="comment">   * @return string $tab The current tab's slug.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_current_avatar( $type = 'thumb' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $group_avatar = bp_core_fetch_avatar( array(&nbsp;</div></li><li><div>          'item_id' =&gt; bp_get_current_group_id(), &nbsp;</div></li><li><div>          'object' =&gt; 'group', &nbsp;</div></li><li><div>          'type' =&gt; $type, &nbsp;</div></li><li><div>          'avatar_dir' =&gt; 'group-avatars', &nbsp;</div></li><li><div>          'alt' =&gt; __( 'Group avatar', 'buddypress' ), &nbsp;</div></li><li><div>          'class' =&gt; 'avatar'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the current group avatar.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $group_avatar HTML markup for current group avatar.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_current_avatar', $group_avatar );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return whether a group has an avatar.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|bool $group_id Group ID to check.</span>&nbsp;</div></li><li><div><span class="comment"> * @return boolean</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_get_group_has_avatar( $group_id = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( false === $group_id ) {&nbsp;</div></li><li><div>      $group_id = bp_get_current_group_id();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $avatar_args = array(&nbsp;</div></li><li><div>      'item_id' =&gt; $group_id, &nbsp;</div></li><li><div>      'object' =&gt; 'group', &nbsp;</div></li><li><div>      'no_grav' =&gt; true, &nbsp;</div></li><li><div>      'html' =&gt; false, &nbsp;</div></li><li><div>      'type' =&gt; 'thumb', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $group_avatar = bp_core_fetch_avatar( $avatar_args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( bp_core_avatar_default( 'local', $avatar_args ) === $group_avatar ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return true;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_avatar_delete_link() {&nbsp;</div></li><li><div>  echo bp_get_group_avatar_delete_link();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_avatar_delete_link() {&nbsp;</div></li><li><div>      $bp = buddypress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the URL to delete the group avatar.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL to delete the group avatar.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_avatar_delete_link', wp_nonce_url( bp_get_group_permalink( $bp-&gt;groups-&gt;current_group ) . 'admin/group-avatar/delete', 'bp_group_avatar_delete' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_custom_group_boxes() {&nbsp;</div></li><li><div>  do_action( 'groups_custom_group_boxes' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_custom_group_admin_tabs() {&nbsp;</div></li><li><div>  do_action( 'groups_custom_group_admin_tabs' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_custom_group_fields_editable() {&nbsp;</div></li><li><div>  do_action( 'groups_custom_group_fields_editable' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_custom_group_fields() {&nbsp;</div></li><li><div>  do_action( 'groups_custom_group_fields' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Group Membership Requests *************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Initialize a group membership request template loop.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args {</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int $group_id ID of the group. Defaults to current group.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int $per_page Number of records to return per page. Default: 10.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int $page     Page of results to return. Default: 1.</span>&nbsp;</div></li><li><div><span class="comment"> *     @type int $max      Max number of items to return. Default: false.</span>&nbsp;</div></li><li><div><span class="comment"> * }</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if there are requests, otherwise false.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_has_membership_requests( $args = '' ) {&nbsp;</div></li><li><div>  global $requests_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $defaults = array(&nbsp;</div></li><li><div>      'group_id' =&gt; bp_get_current_group_id(), &nbsp;</div></li><li><div>      'per_page' =&gt; 10, &nbsp;</div></li><li><div>      'page' =&gt; 1, &nbsp;</div></li><li><div>      'max' =&gt; false&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $r = wp_parse_args( $args, $defaults );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $requests_template = new BP_Groups_Membership_Requests_Template( $r );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether or not a group membership query has requests to display.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool                                   $value             Whether there are requests to display.</span>&nbsp;</div></li><li><div><span class="comment">   * @param BP_Groups_Membership_Requests_Template $requests_template Object holding the requests query results.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_group_has_membership_requests', $requests_template-&gt;has_requests(), $requests_template );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return mixed</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_membership_requests() {&nbsp;</div></li><li><div>  global $requests_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $requests_template-&gt;requests();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return mixed</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_the_membership_request() {&nbsp;</div></li><li><div>  global $requests_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $requests_template-&gt;the_request();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_request_user_avatar_thumb() {&nbsp;</div></li><li><div>  global $requests_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the requesting user's avatar thumbnail.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $value HTML markup for the user's avatar thumbnail.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo apply_filters( 'bp_group_request_user_avatar_thumb', bp_core_fetch_avatar( array( 'item_id' =&gt; $requests_template-&gt;request-&gt;user_id, 'type' =&gt; 'thumb', 'alt' =&gt; sprintf( __( 'Profile picture of %s', 'buddypress' ), bp_core_get_user_displayname( $requests_template-&gt;request-&gt;user_id ) ) ) ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_request_reject_link() {&nbsp;</div></li><li><div>  echo bp_get_group_request_reject_link();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.2.6</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_request_reject_link() {&nbsp;</div></li><li><div>      global $requests_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the URL to use to reject a membership request.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.6</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL to use to reject a membership request.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_request_reject_link', wp_nonce_url( bp_get_group_permalink( groups_get_current_group() ) . 'admin/membership-requests/reject/' . $requests_template-&gt;request-&gt;membership_id, 'groups_reject_membership_request' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_request_accept_link() {&nbsp;</div></li><li><div>  echo bp_get_group_request_accept_link();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.2.6</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_request_accept_link() {&nbsp;</div></li><li><div>      global $requests_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the URL to use to accept a membership request.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.6</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL to use to accept a membership request.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_request_accept_link', wp_nonce_url( bp_get_group_permalink( groups_get_current_group() ) . 'admin/membership-requests/accept/' . $requests_template-&gt;request-&gt;membership_id, 'groups_accept_membership_request' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_request_user_link() {&nbsp;</div></li><li><div>  echo bp_get_group_request_user_link();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.2.6</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_request_user_link() {&nbsp;</div></li><li><div>      global $requests_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the URL for the user requesting membership.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.6</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value URL for the user requestion membership.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_request_user_link', bp_core_get_userlink( $requests_template-&gt;request-&gt;user_id ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_request_time_since_requested() {&nbsp;</div></li><li><div>  global $requests_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the formatted time since membership was requested.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $value Formatted time since membership was requested.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo apply_filters( 'bp_group_request_time_since_requested', sprintf( __( 'requested %s', 'buddypress' ), bp_core_time_since( $requests_template-&gt;request-&gt;date_modified ) ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_request_comment() {&nbsp;</div></li><li><div>  global $requests_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the membership request comment left by user.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $value Membership request comment left by user.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  echo apply_filters( 'bp_group_request_comment', strip_tags( stripslashes( $requests_template-&gt;request-&gt;comments ) ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output pagination links for group membership requests.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_requests_pagination_links() {&nbsp;</div></li><li><div>  echo bp_get_group_requests_pagination_links();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get pagination links for group membership requests.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_requests_pagination_links() {&nbsp;</div></li><li><div>      global $requests_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters pagination links for group membership requests.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Pagination links for group membership requests.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_requests_pagination_links', $requests_template-&gt;pag_links );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output pagination count text for group membership requests.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_requests_pagination_count() {&nbsp;</div></li><li><div>  echo bp_get_group_requests_pagination_count();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get pagination count text for group membership requests.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_requests_pagination_count() {&nbsp;</div></li><li><div>      global $requests_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $start_num = intval( ( $requests_template-&gt;pag_page - 1 ) * $requests_template-&gt;pag_num ) + 1;&nbsp;</div></li><li><div>      $from_num = bp_core_number_format( $start_num );&nbsp;</div></li><li><div>      $to_num = bp_core_number_format( ( $start_num + ( $requests_template-&gt;pag_num - 1 ) &gt; $requests_template-&gt;total_request_count ) ? $requests_template-&gt;total_request_count : $start_num + ( $requests_template-&gt;pag_num - 1 ) );&nbsp;</div></li><li><div>      $total = bp_core_number_format( $requests_template-&gt;total_request_count );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 1 == $requests_template-&gt;total_request_count ) {&nbsp;</div></li><li><div>          $message = __( 'Viewing 1 request', 'buddypress' );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $message = sprintf( _n( 'Viewing %1$s - %2$s of %3$s request', 'Viewing %1$s - %2$s of %3$s requests', $requests_template-&gt;total_request_count, 'buddypress' ), $from_num, $to_num, $total );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters pagination count text for group membership requests.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $message  Pagination count text for group membership requests.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $from_num Total amount for the low value in the range.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $to_num   Total amount for the high value in the range.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $total    Total amount of members found.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_requests_pagination_count', $message, $from_num, $to_num, $total );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Group Invitations *********************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Whether or not there are invites.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $args</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool|mixed|void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_has_invites( $args = '' ) {&nbsp;</div></li><li><div>  global $invites_template, $group_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $r = wp_parse_args( $args, array(&nbsp;</div></li><li><div>      'group_id' =&gt; false, &nbsp;</div></li><li><div>      'user_id' =&gt; bp_loggedin_user_id(), &nbsp;</div></li><li><div>      'per_page' =&gt; false, &nbsp;</div></li><li><div>      'page' =&gt; 1, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $r['group_id'] ) ) {&nbsp;</div></li><li><div>      if ( groups_get_current_group() ) {&nbsp;</div></li><li><div>          $r['group_id'] = bp_get_current_group_id();&nbsp;</div></li><li><div>      } elseif ( ! empty( buddypress()-&gt;groups-&gt;new_group_id ) ) {&nbsp;</div></li><li><div>          $r['group_id'] = buddypress()-&gt;groups-&gt;new_group_id;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Set the global (for use in BP_Groups_Invite_Template::the_invite()).</span>&nbsp;</div></li><li><div>  if ( empty( $group_id ) ) {&nbsp;</div></li><li><div>      $group_id = $r['group_id'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $group_id ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $invites_template = new BP_Groups_Invite_Template( $r );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters whether or not a group invites query has invites to display.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool                      $value            Whether there are requests to display.</span>&nbsp;</div></li><li><div><span class="comment">   * @param BP_Groups_Invite_Template $invites_template Object holding the invites query results.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_group_has_invites', $invites_template-&gt;has_invites(), $invites_template );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return mixed</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_invites() {&nbsp;</div></li><li><div>  global $invites_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $invites_template-&gt;invites();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return mixed</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_the_invite() {&nbsp;</div></li><li><div>  global $invites_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $invites_template-&gt;the_invite();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_invite_item_id() {&nbsp;</div></li><li><div>  echo bp_get_group_invite_item_id();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_invite_item_id() {&nbsp;</div></li><li><div>      global $invites_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group invite item ID.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Group invite item ID.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_invite_item_id', 'uid-' . $invites_template-&gt;invite-&gt;user-&gt;id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_invite_user_avatar() {&nbsp;</div></li><li><div>  echo bp_get_group_invite_user_avatar();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_invite_user_avatar() {&nbsp;</div></li><li><div>      global $invites_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group invite user avatar.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Group invite user avatar.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_invite_user_avatar', $invites_template-&gt;invite-&gt;user-&gt;avatar_thumb );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_invite_user_link() {&nbsp;</div></li><li><div>  echo bp_get_group_invite_user_link();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_invite_user_link() {&nbsp;</div></li><li><div>      global $invites_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group invite user link.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Group invite user link.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_invite_user_link', bp_core_get_userlink( $invites_template-&gt;invite-&gt;user-&gt;id ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_invite_user_last_active() {&nbsp;</div></li><li><div>  echo bp_get_group_invite_user_last_active();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed|void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_invite_user_last_active() {&nbsp;</div></li><li><div>      global $invites_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the group invite user's last active time.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Group invite user's last active time.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_invite_user_last_active', $invites_template-&gt;invite-&gt;user-&gt;last_active );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_invite_user_remove_invite_url() {&nbsp;</div></li><li><div>  echo bp_get_group_invite_user_remove_invite_url();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_invite_user_remove_invite_url() {&nbsp;</div></li><li><div>      global $invites_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $user_id = intval( $invites_template-&gt;invite-&gt;user-&gt;id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( bp_is_current_action( 'create' ) ) {&nbsp;</div></li><li><div>          $uninvite_url = bp_get_groups_directory_permalink() . 'create/step/group-invites/?user_id=' . $user_id;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $uninvite_url = bp_get_group_permalink( groups_get_current_group() ) . 'send-invites/remove/' . $user_id;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return wp_nonce_url( $uninvite_url, 'groups_invite_uninvite_user' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output pagination links for group invitations.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_invite_pagination_links() {&nbsp;</div></li><li><div>  echo bp_get_group_invite_pagination_links();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get pagination links for group invitations.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_invite_pagination_links() {&nbsp;</div></li><li><div>      global $invites_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the pagination links for group invitations.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $value Pagination links for group invitations.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_invite_pagination_links', $invites_template-&gt;pag_links );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output pagination count text for group invitations.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_invite_pagination_count() {&nbsp;</div></li><li><div>  echo bp_get_group_invite_pagination_count();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get pagination count text for group invitations.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_invite_pagination_count() {&nbsp;</div></li><li><div>      global $invites_template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $start_num = intval( ( $invites_template-&gt;pag_page - 1 ) * $invites_template-&gt;pag_num ) + 1;&nbsp;</div></li><li><div>      $from_num = bp_core_number_format( $start_num );&nbsp;</div></li><li><div>      $to_num = bp_core_number_format( ( $start_num + ( $invites_template-&gt;pag_num - 1 ) &gt; $invites_template-&gt;total_invite_count ) ? $invites_template-&gt;total_invite_count : $start_num + ( $invites_template-&gt;pag_num - 1 ) );&nbsp;</div></li><li><div>      $total = bp_core_number_format( $invites_template-&gt;total_invite_count );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 1 == $invites_template-&gt;total_invite_count ) {&nbsp;</div></li><li><div>          $message = __( 'Viewing 1 invitation', 'buddypress' );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $message = sprintf( _n( 'Viewing %1$s - %2$s of %3$s invitation', 'Viewing %1$s - %2$s of %3$s invitations', $invites_template-&gt;total_invite_count, 'buddypress' ), $from_num, $to_num, $total );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** This filter is documented in bp-groups/bp-groups-template.php */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_groups_pagination_count', $message, $from_num, $to_num, $total );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Group RSS *****************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Hook group activity feed to &lt;head&gt;.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_activity_feed() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Bail if not viewing a single group or activity is not active.</span>&nbsp;</div></li><li><div>  if ( ! bp_is_active( 'groups' ) || ! bp_is_active( 'activity' ) || ! bp_is_group() ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  } ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;link rel=&quot;alternate&quot; type=&quot;application/rss+xml&quot; title=&quot;&lt;?php bloginfo( 'name' ) ?&gt; | &lt;?php bp_current_group_name() ?&gt; | &lt;?php _e( 'Group Activity RSS Feed', 'buddypress' ) ?&gt;&quot; href=&quot;&lt;?php bp_group_activity_feed_link() ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action( 'bp_head', 'bp_groups_activity_feed' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the current group activity-stream RSS URL.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_group_activity_feed_link() {&nbsp;</div></li><li><div>  echo bp_get_group_activity_feed_link();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the current group activity-stream RSS URL.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_group_activity_feed_link() {&nbsp;</div></li><li><div>      $current_group = groups_get_current_group();&nbsp;</div></li><li><div>      $group_link = bp_get_group_permalink( $current_group ) . 'feed';&nbsp;</div></li><li><div>      $feed_link = trailingslashit( $group_link );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the current group activity-stream RSS URL.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $feed_link Current group activity-stream RSS URL.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_group_activity_feed_link', $feed_link );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Current Group *************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Echoes the output of bp_get_current_group_id().</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_current_group_id() {&nbsp;</div></li><li><div>  echo bp_get_current_group_id();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns the ID of the current group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return int $current_group_id The id of the current group, if there is one.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_current_group_id() {&nbsp;</div></li><li><div>      $current_group = groups_get_current_group();&nbsp;</div></li><li><div>      $current_group_id = isset( $current_group-&gt;id ) ? (int) $current_group-&gt;id : 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the ID of the current group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param int    $current_group_id ID of the current group.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $current_group    Instance holding the current group.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_current_group_id', $current_group_id, $current_group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Echoes the output of bp_get_current_group_slug().</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_current_group_slug() {&nbsp;</div></li><li><div>  echo bp_get_current_group_slug();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns the slug of the current group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string $current_group_slug The slug of the current group, if there is one.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_current_group_slug() {&nbsp;</div></li><li><div>      $current_group = groups_get_current_group();&nbsp;</div></li><li><div>      $current_group_slug = isset( $current_group-&gt;slug ) ? $current_group-&gt;slug : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the slug of the current group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $current_group_slug Slug of the current group.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $current_group      Instance holding the current group.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_current_group_slug', $current_group_slug, $current_group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Echoes the output of bp_get_current_group_name().</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_current_group_name() {&nbsp;</div></li><li><div>  echo bp_get_current_group_name();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns the name of the current group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.5.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string The name of the current group, if there is one.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_current_group_name() {&nbsp;</div></li><li><div>      $current_group = groups_get_current_group();&nbsp;</div></li><li><div>      $current_name = bp_get_group_name( $current_group );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the name of the current group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $current_name  Name of the current group.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $current_group Instance holding the current group.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_current_group_name', $current_name, $current_group );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Echoes the output of bp_get_current_group_description().</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_current_group_description() {&nbsp;</div></li><li><div>  echo bp_get_current_group_description();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns the description of the current group.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment">   *                       this output.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string The description of the current group, if there is one.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_current_group_description() {&nbsp;</div></li><li><div>      $current_group = groups_get_current_group();&nbsp;</div></li><li><div>      $current_group_desc = isset( $current_group-&gt;description ) ? $current_group-&gt;description : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the description of the current group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * This filter is used to apply extra filters related to formatting.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $current_group_desc Description of the current group.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $desc = apply_filters( 'bp_get_group_description', $current_group_desc );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters the description of the current group.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $desc Description of the current group.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_current_group_description', $desc );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output a URL for a group component action.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $action</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $query_args</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $nonce</span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_action_link( $action = '', $query_args = '', $nonce = false ) {&nbsp;</div></li><li><div>  echo bp_get_groups_action_link( $action, $query_args, $nonce );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get a URL for a group component action.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.2.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $action</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $query_args</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $nonce</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bp_get_groups_action_link( $action = '', $query_args = '', $nonce = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $current_group = groups_get_current_group();&nbsp;</div></li><li><div>      $url = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Must be a group.</span>&nbsp;</div></li><li><div>      if ( ! empty( $current_group-&gt;id ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Append $action to $url if provided</span>&nbsp;</div></li><li><div>          if ( !empty( $action ) ) {&nbsp;</div></li><li><div>              $url = bp_get_group_permalink( $current_group ) . $action;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $url = bp_get_group_permalink( $current_group );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Add a slash at the end of our user url.</span>&nbsp;</div></li><li><div>          $url = trailingslashit( $url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Add possible query args.</span>&nbsp;</div></li><li><div>          if ( !empty( $query_args ) && is_array( $query_args ) ) {&nbsp;</div></li><li><div>              $url = add_query_arg( $query_args, $url );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// To nonce, or not to nonce...</span>&nbsp;</div></li><li><div>          if ( true === $nonce ) {&nbsp;</div></li><li><div>              $url = wp_nonce_url( $url );&nbsp;</div></li><li><div>          } elseif ( is_string( $nonce ) ) {&nbsp;</div></li><li><div>              $url = wp_nonce_url( $url, $nonce );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filters a URL for a group component action.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $url        URL for a group component action.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $action     Action being taken for the group.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $query_args Query arguments being passed.</span>&nbsp;</div></li><li><div><span class="comment">       * @param bool   $nonce      Whether or not to add a nonce.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bp_get_groups_action_link', $url, $action, $query_args, $nonce );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Stats **********************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Display the number of groups in user's profile.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args before|after|user_id</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_profile_stats( $args = '' ) {&nbsp;</div></li><li><div>  echo bp_groups_get_profile_stats( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action( 'bp_members_admin_user_stats', 'bp_groups_profile_stats', 8, 1 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return the number of groups in user's profile.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array|string $args before|after|user_id</span>&nbsp;</div></li><li><div><span class="comment"> * @return string HTML for stats output.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_groups_get_profile_stats( $args = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Parse the args</span>&nbsp;</div></li><li><div>  $r = bp_parse_args( $args, array(&nbsp;</div></li><li><div>      'before' =&gt; '&lt;li class=&quot;bp-groups-profile-stats&quot;&gt;', &nbsp;</div></li><li><div>      'after' =&gt; '&lt;/li&gt;', &nbsp;</div></li><li><div>      'user_id' =&gt; bp_displayed_user_id(), &nbsp;</div></li><li><div>      'groups' =&gt; 0, &nbsp;</div></li><li><div>      'output' =&gt; ''&nbsp;</div></li><li><div> ), 'groups_get_profile_stats' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Allow completely overloaded output</span>&nbsp;</div></li><li><div>  if ( empty( $r['output'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Only proceed if a user ID was passed</span>&nbsp;</div></li><li><div>      if ( ! empty( $r['user_id'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Get the user groups</span>&nbsp;</div></li><li><div>          if ( empty( $r['groups'] ) ) {&nbsp;</div></li><li><div>              $r['groups'] = absint( bp_get_total_group_count_for_user( $r['user_id'] ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// If groups exist, show some formatted output</span>&nbsp;</div></li><li><div>          $r['output'] = $r['before'] . sprintf( _n( '%s group', '%s groups', $r['groups'], 'buddypress' ), '&lt;strong&gt;' . $r['groups'] . '&lt;/strong&gt;' ) . $r['after'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filters the number of groups in user's profile.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 2.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $value HTML for stats output.</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $r     Array of parsed arguments for query.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  return apply_filters( 'bp_groups_get_profile_stats', $r['output'], $r );&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>BuddyPress</li><li><span></span>2.8.2</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2021 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>