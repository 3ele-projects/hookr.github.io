<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="2.7.5" data-slug="buddypress" data-type="file" data-id="49467"><head xmlns="http://www.w3.org/1999/xhtml"><title> bp-themes-bp-default-functions | file | Buddypress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, buddypress, 2.7.5" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=2d4163c32cc9137d4400dea6ff667115' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/bp-themes-bp-default-functions/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fbp-themes-bp-default-functions%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fbp-themes-bp-default-functions%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-buddypress-2.7.5-file-bp-themes-bp-default-functions","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="bp-themes-bp-default-functions" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to buddypress." href="http://hookr.io/plugins/buddypress/" class="plugin"><span property="name">buddypress</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.7.5." href="http://hookr.io/plugins/buddypress/2.7.5/" class="H_VERSION"><span property="name">2.7.5</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/buddypress/2.7.5/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">bp-themes-bp-default-functions</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="7768"><a href="http://hookr.io/plugins/buddypress/2.7.5/all/" title="All">All <span class="count badge">7768</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/buddypress/2.7.5/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="3600"><a href="http://hookr.io/plugins/buddypress/2.7.5/hooks/" title="Hooks">Hooks <span class="count badge">3600</span></a></li><li class="" data-id="action" data-count="1718"><a href="http://hookr.io/plugins/buddypress/2.7.5/actions/" title="Actions">Actions <span class="count badge">1718</span></a></li><li class="" data-id="filter" data-count="1882"><a href="http://hookr.io/plugins/buddypress/2.7.5/filters/" title="Filters">Filters <span class="count badge">1882</span></a></li><li class="" data-id="class" data-count="178"><a href="http://hookr.io/plugins/buddypress/2.7.5/classes/" title="Classes">Classes <span class="count badge">178</span></a></li><li class="" data-id="constant" data-count="160"><a href="http://hookr.io/plugins/buddypress/2.7.5/constants/" title="Constants">Constants <span class="count badge">160</span></a></li><li class="" data-id="function" data-count="3830"><a href="http://hookr.io/plugins/buddypress/2.7.5/functions/" title="Functions">Functions <span class="count badge">3830</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/plugins/buddypress/2.7.5/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/bp-themes/bp-default/functions.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * BP-Default theme functions and definitions</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Sets up the theme and provides some helper functions. Some helper functions</span>&nbsp;</div></li><li><div><span class="comment"> * are used in the theme as custom template tags. Others are attached to action and</span>&nbsp;</div></li><li><div><span class="comment"> * filter hooks in WordPress and BuddyPress to change core functionality.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The first function, bp_dtheme_setup(), sets up the theme by registering support</span>&nbsp;</div></li><li><div><span class="comment"> * for various features in WordPress, such as post thumbnails and navigation menus, and</span>&nbsp;</div></li><li><div><span class="comment"> * for BuddyPress, action buttons and javascript localisation.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * When using a child theme (see http://codex.wordpress.org/Theme_Development, http://codex.wordpress.org/Child_Themes</span>&nbsp;</div></li><li><div><span class="comment"> * and http://codex.buddypress.org/theme-development/building-a-buddypress-child-theme/), you can override</span>&nbsp;</div></li><li><div><span class="comment"> * certain functions (those wrapped in a function_exists() call) by defining them first in your</span>&nbsp;</div></li><li><div><span class="comment"> * child theme's functions.php file. The child theme's functions.php file is included before the</span>&nbsp;</div></li><li><div><span class="comment"> * parent theme's file, so the child theme functions would be used.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Functions that are not pluggable (not wrapped in function_exists()) are instead attached</span>&nbsp;</div></li><li><div><span class="comment"> * to a filter or action hook. The hook can be removed by using remove_action() or</span>&nbsp;</div></li><li><div><span class="comment"> * remove_filter() and you can attach your own function to the hook.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * For more information on hooks, actions, and filters, see http://codex.wordpress.org/Plugin_API.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package BuddyPress</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage BP-Default</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.2)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Exit if accessed directly</span>&nbsp;</div></li><li><div>if ( ! defined( 'ABSPATH' ) ) exit;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// If BuddyPress is not activated, switch back to the default WP theme and bail out</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'bp_is_active' ) ) {&nbsp;</div></li><li><div>  switch_theme( WP_DEFAULT_THEME, WP_DEFAULT_THEME );&nbsp;</div></li><li><div>  return;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Set the content width based on the theme's design and stylesheet.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Used to set the width of images and content. Should be equal to the width the theme</span>&nbsp;</div></li><li><div><span class="comment"> * is designed for, generally via the style.css stylesheet.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! isset( $content_width ) )&nbsp;</div></li><li><div>  $content_width = 591;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( ! function_exists( 'bp_dtheme_setup' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Sets up theme defaults and registers support for various WordPress and BuddyPress features.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Note that this function is hooked into the after_setup_theme hook, which runs</span>&nbsp;</div></li><li><div><span class="comment"> * before the init hook. The init hook is too late for some features, such as indicating</span>&nbsp;</div></li><li><div><span class="comment"> * support post thumbnails.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * To override bp_dtheme_setup() in a child theme, add your own bp_dtheme_setup to your child theme's</span>&nbsp;</div></li><li><div><span class="comment"> * functions.php file.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global BuddyPress $bp The one true BuddyPress instance</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.5)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_setup() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Load the AJAX functions for the theme</span>&nbsp;</div></li><li><div>  require( get_template_directory() . '/_inc/ajax.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// This theme styles the visual editor with editor-style.css to match the theme style.</span>&nbsp;</div></li><li><div>  add_editor_style();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// This theme comes with all the BuddyPress goodies</span>&nbsp;</div></li><li><div>  add_theme_support( 'buddypress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// This theme uses post thumbnails</span>&nbsp;</div></li><li><div>  add_theme_support( 'post-thumbnails' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Add default posts and comments RSS feed links to head</span>&nbsp;</div></li><li><div>  add_theme_support( 'automatic-feed-links' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Add responsive layout support to bp-default without forcing child</span>&nbsp;</div></li><li><div>  <span class="comment">// themes to inherit it if they don't want to</span>&nbsp;</div></li><li><div>  add_theme_support( 'bp-default-responsive' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// This theme uses wp_nav_menu() in one location.</span>&nbsp;</div></li><li><div>  register_nav_menus( array(&nbsp;</div></li><li><div>      'primary' =&gt; __( 'Primary Navigation', 'buddypress' ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// This theme allows users to set a custom background</span>&nbsp;</div></li><li><div>  $custom_background_args = array(&nbsp;</div></li><li><div>      'wp-head-callback' =&gt; 'bp_dtheme_custom_background_style'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  add_theme_support( 'custom-background', $custom_background_args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Add custom header support if allowed</span>&nbsp;</div></li><li><div>  if ( !defined( 'BP_DTHEME_DISABLE_CUSTOM_HEADER' ) ) {&nbsp;</div></li><li><div>      define( 'HEADER_TEXTCOLOR', 'FFFFFF' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// The height and width of your custom header. You can hook into the theme's own filters to change these values.</span>&nbsp;</div></li><li><div>      <span class="comment">// Add a filter to bp_dtheme_header_image_width and bp_dtheme_header_image_height to change these values.</span>&nbsp;</div></li><li><div>      define( 'HEADER_IMAGE_WIDTH', apply_filters( 'bp_dtheme_header_image_width', 1250 ) );&nbsp;</div></li><li><div>      define( 'HEADER_IMAGE_HEIGHT', apply_filters( 'bp_dtheme_header_image_height', 133 ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// We'll be using post thumbnails for custom header images on posts and pages. We want them to be 1250 pixels wide by 133 pixels tall.</span>&nbsp;</div></li><li><div>      <span class="comment">// Larger images will be auto-cropped to fit, smaller ones will be ignored.</span>&nbsp;</div></li><li><div>      set_post_thumbnail_size( HEADER_IMAGE_WIDTH, HEADER_IMAGE_HEIGHT, true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add a way for the custom header to be styled in the admin panel that controls custom headers.</span>&nbsp;</div></li><li><div>      $custom_header_args = array(&nbsp;</div></li><li><div>          'wp-head-callback' =&gt; 'bp_dtheme_header_style', &nbsp;</div></li><li><div>          'admin-head-callback' =&gt; 'bp_dtheme_admin_header_style'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      add_theme_support( 'custom-header', $custom_header_args );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! is_admin() || ( defined( 'DOING_AJAX' ) && DOING_AJAX ) ) {&nbsp;</div></li><li><div>      <span class="comment">// Register buttons for the relevant component templates</span>&nbsp;</div></li><li><div>      <span class="comment">// Friends button</span>&nbsp;</div></li><li><div>      if ( bp_is_active( 'friends' ) )&nbsp;</div></li><li><div>          add_action( 'bp_member_header_actions', 'bp_add_friend_button', 5 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Activity button</span>&nbsp;</div></li><li><div>      if ( bp_is_active( 'activity' ) && bp_activity_do_mentions() )&nbsp;</div></li><li><div>          add_action( 'bp_member_header_actions', 'bp_send_public_message_button', 20 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Messages button</span>&nbsp;</div></li><li><div>      if ( bp_is_active( 'messages' ) )&nbsp;</div></li><li><div>          add_action( 'bp_member_header_actions', 'bp_send_private_message_button', 20 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Group buttons</span>&nbsp;</div></li><li><div>      if ( bp_is_active( 'groups' ) ) {&nbsp;</div></li><li><div>          add_action( 'bp_group_header_actions', 'bp_group_join_button', 5 );&nbsp;</div></li><li><div>          add_action( 'bp_group_header_actions', 'bp_group_new_topic_button', 20 );&nbsp;</div></li><li><div>          add_action( 'bp_directory_groups_actions', 'bp_group_join_button' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Blog button</span>&nbsp;</div></li><li><div>      if ( bp_is_active( 'blogs' ) )&nbsp;</div></li><li><div>          add_action( 'bp_directory_blogs_actions', 'bp_blogs_visit_blog_button' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action( 'after_setup_theme', 'bp_dtheme_setup' );&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_enqueue_scripts' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Enqueue theme javascript safely</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see http://codex.wordpress.org/Function_Reference/wp_enqueue_script</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.5)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_enqueue_scripts() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Enqueue various scripts</span>&nbsp;</div></li><li><div>  wp_enqueue_script( 'bp-jquery-query' );&nbsp;</div></li><li><div>  wp_enqueue_script( 'bp-jquery-cookie' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Enqueue scrollTo only on activity pages</span>&nbsp;</div></li><li><div>  if ( bp_is_activity_component() ) {&nbsp;</div></li><li><div>      wp_enqueue_script( 'bp-jquery-scroll-to' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// A similar check is done in BP_Core_Members_Widget, but due to a load order</span>&nbsp;</div></li><li><div>  <span class="comment">// issue, we do it again here</span>&nbsp;</div></li><li><div>  if ( is_active_widget( false, false, 'bp_core_members_widget' ) && ! is_admin() && ! is_network_admin() ) {&nbsp;</div></li><li><div>      wp_enqueue_script( 'bp-widget-members' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Enqueue the global JS - Ajax will not work without it</span>&nbsp;</div></li><li><div>  wp_enqueue_script( 'dtheme-ajax-js', get_template_directory_uri() . '/_inc/global.js', array( 'jquery' ), bp_get_version() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Add words that we need to use in JS to the end of the page so they can be translated and still used.</span>&nbsp;</div></li><li><div>  $params = array(&nbsp;</div></li><li><div>      'my_favs' =&gt; __( 'My Favorites', 'buddypress' ), &nbsp;</div></li><li><div>      'accepted' =&gt; __( 'Accepted', 'buddypress' ), &nbsp;</div></li><li><div>      'rejected' =&gt; __( 'Rejected', 'buddypress' ), &nbsp;</div></li><li><div>      'show_all_comments' =&gt; __( 'Show all comments for this thread', 'buddypress' ), &nbsp;</div></li><li><div>      'show_x_comments' =&gt; __( 'Show all %d comments', 'buddypress' ), &nbsp;</div></li><li><div>      'show_all' =&gt; __( 'Show all', 'buddypress' ), &nbsp;</div></li><li><div>      'comments' =&gt; __( 'comments', 'buddypress' ), &nbsp;</div></li><li><div>      'close' =&gt; __( 'Close', 'buddypress' ), &nbsp;</div></li><li><div>      'view' =&gt; __( 'View', 'buddypress' ), &nbsp;</div></li><li><div>      'mark_as_fav' =&gt; __( 'Favorite', 'buddypress' ), &nbsp;</div></li><li><div>      'remove_fav' =&gt; __( 'Remove Favorite', 'buddypress' ), &nbsp;</div></li><li><div>      'unsaved_changes' =&gt; __( 'Your profile has unsaved changes. If you leave the page, the changes will be lost.', 'buddypress' ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  wp_localize_script( 'dtheme-ajax-js', 'BP_DTheme', $params );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Maybe enqueue comment reply JS</span>&nbsp;</div></li><li><div>  if ( is_singular() && bp_is_blog_page() && get_option( 'thread_comments' ) )&nbsp;</div></li><li><div>      wp_enqueue_script( 'comment-reply' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action( 'wp_enqueue_scripts', 'bp_dtheme_enqueue_scripts' );&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_enqueue_styles' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Enqueue theme CSS safely</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * For maximum flexibility, BuddyPress Default's stylesheet is enqueued, using wp_enqueue_style().</span>&nbsp;</div></li><li><div><span class="comment"> * If you're building a child theme of bp-default, your stylesheet will also be enqueued, </span>&nbsp;</div></li><li><div><span class="comment"> * automatically, as dependent on bp-default's CSS. For this reason, bp-default child themes are</span>&nbsp;</div></li><li><div><span class="comment"> * not recommended to include bp-default's stylesheet using @import.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * If you would prefer to use @import, or would like to change the way in which stylesheets are</span>&nbsp;</div></li><li><div><span class="comment"> * enqueued, you can override bp_dtheme_enqueue_styles() in your theme's functions.php file.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see http://codex.wordpress.org/Function_Reference/wp_enqueue_style</span>&nbsp;</div></li><li><div><span class="comment"> * @see http://codex.buddypress.org/releases/1-5-developer-and-designer-information/</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.5)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_enqueue_styles() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Register our main stylesheet</span>&nbsp;</div></li><li><div>  wp_register_style( 'bp-default-main', get_template_directory_uri() . '/_inc/css/default.css', array(), bp_get_version() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// If the current theme is a child of bp-default, enqueue its stylesheet</span>&nbsp;</div></li><li><div>  if ( is_child_theme() && 'bp-default' == get_template() ) {&nbsp;</div></li><li><div>      wp_enqueue_style( get_stylesheet(), get_stylesheet_uri(), array( 'bp-default-main' ), bp_get_version() );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Enqueue the main stylesheet</span>&nbsp;</div></li><li><div>  wp_enqueue_style( 'bp-default-main' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Default CSS RTL</span>&nbsp;</div></li><li><div>  if ( is_rtl() )&nbsp;</div></li><li><div>      wp_enqueue_style( 'bp-default-main-rtl', get_template_directory_uri() . '/_inc/css/default-rtl.css', array( 'bp-default-main' ), bp_get_version() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Responsive layout</span>&nbsp;</div></li><li><div>  if ( current_theme_supports( 'bp-default-responsive' ) ) {&nbsp;</div></li><li><div>      wp_enqueue_style( 'bp-default-responsive', get_template_directory_uri() . '/_inc/css/responsive.css', array( 'bp-default-main' ), bp_get_version() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_rtl() ) {&nbsp;</div></li><li><div>          wp_enqueue_style( 'bp-default-responsive-rtl', get_template_directory_uri() . '/_inc/css/responsive-rtl.css', array( 'bp-default-responsive' ), bp_get_version() );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action( 'wp_enqueue_scripts', 'bp_dtheme_enqueue_styles' );&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_admin_header_style' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Styles the header image displayed on the Appearance &gt; Header admin panel.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Referenced via add_custom_image_header() in bp_dtheme_setup().</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.2)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_admin_header_style() {&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>  &lt;style type=&quot;text/css&quot;&gt;&nbsp;</div></li><li><div>      #headimg {&nbsp;</div></li><li><div>          position: relative;&nbsp;</div></li><li><div>          color: #fff;&nbsp;</div></li><li><div>          background: url(&lt;?php header_image(); ?&gt;);&nbsp;</div></li><li><div>          -moz-border-radius-bottomleft: 6px;&nbsp;</div></li><li><div>          -webkit-border-bottom-left-radius: 6px;&nbsp;</div></li><li><div>          -moz-border-radius-bottomright: 6px;&nbsp;</div></li><li><div>          -webkit-border-bottom-right-radius: 6px;&nbsp;</div></li><li><div>          margin-bottom: 20px;&nbsp;</div></li><li><div>          height: 133px;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      #headimg h1{&nbsp;</div></li><li><div>          position: absolute;&nbsp;</div></li><li><div>          bottom: 15px;&nbsp;</div></li><li><div>          left: 15px;&nbsp;</div></li><li><div>          width: 44%;&nbsp;</div></li><li><div>          margin: 0;&nbsp;</div></li><li><div>          font-family: Arial, Tahoma, sans-serif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      #headimg h1 a{&nbsp;</div></li><li><div>          color:#&lt;?php header_textcolor(); ?&gt;;&nbsp;</div></li><li><div>          text-decoration: none;&nbsp;</div></li><li><div>          border-bottom: none;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      #headimg #desc{&nbsp;</div></li><li><div>          color:#&lt;?php header_textcolor(); ?&gt;;&nbsp;</div></li><li><div>          font-size:1em;&nbsp;</div></li><li><div>          margin-top:-0.5em;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      #desc {&nbsp;</div></li><li><div>          display: none;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php if ( 'blank' == get_header_textcolor() ) { ?&gt;&nbsp;</div></li><li><div>      #headimg h1, #headimg #desc {&nbsp;</div></li><li><div>          display: none;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      #headimg h1 a, #headimg #desc {&nbsp;</div></li><li><div>          color:#&lt;?php echo HEADER_TEXTCOLOR; ?&gt;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &lt;?php } ?&gt;&nbsp;</div></li><li><div>  &lt;/style&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_custom_background_style' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * The style for the custom background image or colour.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Referenced via add_custom_background() in bp_dtheme_setup().</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see _custom_background_cb()</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.5)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_custom_background_style() {&nbsp;</div></li><li><div>  $background = get_background_image();&nbsp;</div></li><li><div>  $color = get_background_color();&nbsp;</div></li><li><div>  if ( ! $background && ! $color )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $style = $color ? &quot;background-color: #$color;&quot; : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $style && !$background ) {&nbsp;</div></li><li><div>      $style .= ' background-image: none;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( $background ) {&nbsp;</div></li><li><div>      $image = &quot; background-image: url('$background');&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $repeat = get_theme_mod( 'background_repeat', 'repeat' );&nbsp;</div></li><li><div>      if ( ! in_array( $repeat, array( 'no-repeat', 'repeat-x', 'repeat-y', 'repeat' ) ) )&nbsp;</div></li><li><div>          $repeat = 'repeat';&nbsp;</div></li><li><div>      $repeat = &quot; background-repeat: $repeat;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $position = get_theme_mod( 'background_position_x', 'left' );&nbsp;</div></li><li><div>      if ( ! in_array( $position, array( 'center', 'right', 'left' ) ) )&nbsp;</div></li><li><div>          $position = 'left';&nbsp;</div></li><li><div>      $position = &quot; background-position: top $position;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $attachment = get_theme_mod( 'background_attachment', 'scroll' );&nbsp;</div></li><li><div>      if ( ! in_array( $attachment, array( 'fixed', 'scroll' ) ) )&nbsp;</div></li><li><div>          $attachment = 'scroll';&nbsp;</div></li><li><div>      $attachment = &quot; background-attachment: $attachment;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $style .= $image . $repeat . $position . $attachment;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>  &lt;style type=&quot;text/css&quot;&gt;&nbsp;</div></li><li><div>      body { &lt;?php echo trim( $style ); ?&gt; }&nbsp;</div></li><li><div>  &lt;/style&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_header_style' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * The styles for the post thumbnails / custom page headers.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Referenced via add_custom_image_header() in bp_dtheme_setup().</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Query $post The current WP_Query object for the current post or page</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.2)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_header_style() {&nbsp;</div></li><li><div>  global $post;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $header_image = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_singular() && current_theme_supports( 'post-thumbnails' ) && has_post_thumbnail( $post-&gt;ID ) ) {&nbsp;</div></li><li><div>      $image = wp_get_attachment_image_src( get_post_thumbnail_id( $post-&gt;ID ), 'post-thumbnail' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// $src, $width, $height</span>&nbsp;</div></li><li><div>      if ( !empty( $image ) && $image[1] &gt;= HEADER_IMAGE_WIDTH )&nbsp;</div></li><li><div>          $header_image = $image[0];&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          $header_image = get_header_image();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $header_image = get_header_image();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;style type=&quot;text/css&quot;&gt;&nbsp;</div></li><li><div>      &lt;?php if ( !empty( $header_image ) ) : ?&gt;&nbsp;</div></li><li><div>          #header { background-image: url(&lt;?php echo $header_image ?&gt;); }&nbsp;</div></li><li><div>      &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php if ( 'blank' == get_header_textcolor() ) { ?&gt;&nbsp;</div></li><li><div>      #header h1, #header #desc { display: none; }&nbsp;</div></li><li><div>      &lt;?php } else { ?&gt;&nbsp;</div></li><li><div>      #header h1 a, #desc { color:#&lt;?php header_textcolor(); ?&gt;; }&nbsp;</div></li><li><div>      &lt;?php } ?&gt;&nbsp;</div></li><li><div>  &lt;/style&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_widgets_init' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Register widgetised areas, including one sidebar and four widget-ready columns in the footer.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * To override bp_dtheme_widgets_init() in a child theme, remove the action hook and add your own</span>&nbsp;</div></li><li><div><span class="comment"> * function tied to the init hook.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.5)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_widgets_init() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Area 1, located in the sidebar. Empty by default.</span>&nbsp;</div></li><li><div>  register_sidebar( array(&nbsp;</div></li><li><div>      'name' =&gt; 'Sidebar', &nbsp;</div></li><li><div>      'id' =&gt; 'sidebar-1', &nbsp;</div></li><li><div>      'description' =&gt; __( 'The sidebar widget area', 'buddypress' ), &nbsp;</div></li><li><div>      'before_widget' =&gt; '&lt;div id=&quot;%1$s&quot; class=&quot;widget %2$s&quot;&gt;', &nbsp;</div></li><li><div>      'after_widget' =&gt; '&lt;/div&gt;', &nbsp;</div></li><li><div>      'before_title' =&gt; '&lt;h3 class=&quot;widgettitle&quot;&gt;', &nbsp;</div></li><li><div>      'after_title' =&gt; '&lt;/h3&gt;'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Area 2, located in the footer. Empty by default.</span>&nbsp;</div></li><li><div>  register_sidebar( array(&nbsp;</div></li><li><div>      'name' =&gt; __( 'First Footer Widget Area', 'buddypress' ), &nbsp;</div></li><li><div>      'id' =&gt; 'first-footer-widget-area', &nbsp;</div></li><li><div>      'description' =&gt; __( 'The first footer widget area', 'buddypress' ), &nbsp;</div></li><li><div>      'before_widget' =&gt; '&lt;li id=&quot;%1$s&quot; class=&quot;widget %2$s&quot;&gt;', &nbsp;</div></li><li><div>      'after_widget' =&gt; '&lt;/li&gt;', &nbsp;</div></li><li><div>      'before_title' =&gt; '&lt;h3 class=&quot;widgettitle&quot;&gt;', &nbsp;</div></li><li><div>      'after_title' =&gt; '&lt;/h3&gt;', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Area 3, located in the footer. Empty by default.</span>&nbsp;</div></li><li><div>  register_sidebar( array(&nbsp;</div></li><li><div>      'name' =&gt; __( 'Second Footer Widget Area', 'buddypress' ), &nbsp;</div></li><li><div>      'id' =&gt; 'second-footer-widget-area', &nbsp;</div></li><li><div>      'description' =&gt; __( 'The second footer widget area', 'buddypress' ), &nbsp;</div></li><li><div>      'before_widget' =&gt; '&lt;li id=&quot;%1$s&quot; class=&quot;widget %2$s&quot;&gt;', &nbsp;</div></li><li><div>      'after_widget' =&gt; '&lt;/li&gt;', &nbsp;</div></li><li><div>      'before_title' =&gt; '&lt;h3 class=&quot;widgettitle&quot;&gt;', &nbsp;</div></li><li><div>      'after_title' =&gt; '&lt;/h3&gt;', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Area 4, located in the footer. Empty by default.</span>&nbsp;</div></li><li><div>  register_sidebar( array(&nbsp;</div></li><li><div>      'name' =&gt; __( 'Third Footer Widget Area', 'buddypress' ), &nbsp;</div></li><li><div>      'id' =&gt; 'third-footer-widget-area', &nbsp;</div></li><li><div>      'description' =&gt; __( 'The third footer widget area', 'buddypress' ), &nbsp;</div></li><li><div>      'before_widget' =&gt; '&lt;li id=&quot;%1$s&quot; class=&quot;widget %2$s&quot;&gt;', &nbsp;</div></li><li><div>      'after_widget' =&gt; '&lt;/li&gt;', &nbsp;</div></li><li><div>      'before_title' =&gt; '&lt;h3 class=&quot;widgettitle&quot;&gt;', &nbsp;</div></li><li><div>      'after_title' =&gt; '&lt;/h3&gt;', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Area 5, located in the footer. Empty by default.</span>&nbsp;</div></li><li><div>  register_sidebar( array(&nbsp;</div></li><li><div>      'name' =&gt; __( 'Fourth Footer Widget Area', 'buddypress' ), &nbsp;</div></li><li><div>      'id' =&gt; 'fourth-footer-widget-area', &nbsp;</div></li><li><div>      'description' =&gt; __( 'The fourth footer widget area', 'buddypress' ), &nbsp;</div></li><li><div>      'before_widget' =&gt; '&lt;li id=&quot;%1$s&quot; class=&quot;widget %2$s&quot;&gt;', &nbsp;</div></li><li><div>      'after_widget' =&gt; '&lt;/li&gt;', &nbsp;</div></li><li><div>      'before_title' =&gt; '&lt;h3 class=&quot;widgettitle&quot;&gt;', &nbsp;</div></li><li><div>      'after_title' =&gt; '&lt;/h3&gt;', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action( 'widgets_init', 'bp_dtheme_widgets_init' );&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_blog_comments' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Template for comments and pingbacks.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * To override this walker in a child theme without modifying the comments template</span>&nbsp;</div></li><li><div><span class="comment"> * simply create your own bp_dtheme_blog_comments(), and that function will be used instead.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Used as a callback by wp_list_comments() for displaying the comments.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $comment Comment record from database</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments from wp_list_comments() call</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $depth Comment nesting level</span>&nbsp;</div></li><li><div><span class="comment"> * @see wp_list_comments()</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.2)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_blog_comments( $comment, $args, $depth ) {&nbsp;</div></li><li><div>  $GLOBALS['comment'] = $comment;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'pingback' == $comment-&gt;comment_type )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 1 == $depth )&nbsp;</div></li><li><div>      $avatar_size = 50;&nbsp;</div></li><li><div>  else&nbsp;</div></li><li><div>      $avatar_size = 25;&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;li &lt;?php comment_class(); ?&gt; id=&quot;comment-&lt;?php comment_ID(); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>      &lt;div class=&quot;comment-avatar-box&quot;&gt;&nbsp;</div></li><li><div>          &lt;div class=&quot;avb&quot;&gt;&nbsp;</div></li><li><div>              &lt;a href=&quot;&lt;?php echo get_comment_author_url(); ?&gt;&quot; rel=&quot;nofollow&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( $comment-&gt;user_id ) : ?&gt;&nbsp;</div></li><li><div>                      &lt;?php echo bp_core_fetch_avatar( array( 'item_id' =&gt; $comment-&gt;user_id, 'width' =&gt; $avatar_size, 'height' =&gt; $avatar_size, 'email' =&gt; $comment-&gt;comment_author_email ) ); ?&gt;&nbsp;</div></li><li><div>                  &lt;?php else : ?&gt;&nbsp;</div></li><li><div>                      &lt;?php echo get_avatar( $comment, $avatar_size ); ?&gt;&nbsp;</div></li><li><div>                  &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>              &lt;/a&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;div class=&quot;comment-content&quot;&gt;&nbsp;</div></li><li><div>          &lt;div class=&quot;comment-meta&quot;&gt;&nbsp;</div></li><li><div>              &lt;p&gt;&nbsp;</div></li><li><div>                  &lt;?php&nbsp;</div></li><li><div>                      <span class="comment">/** translators: 1: comment author url, 2: comment author name, 3: comment permalink, 4: comment date/timestamp*/</span>&nbsp;</div></li><li><div>                      printf( __( '&lt;a href=&quot;%1$s&quot; rel=&quot;nofollow&quot;&gt;%2$s&lt;/a&gt; said on &lt;a href=&quot;%3$s&quot;&gt;&lt;span class=&quot;time-since&quot;&gt;%4$s&lt;/span&gt;&lt;/a&gt;', 'buddypress' ), get_comment_author_url(), get_comment_author(), get_comment_link(), get_comment_date() );&nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>              &lt;/p&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;div class=&quot;comment-entry&quot;&gt;&nbsp;</div></li><li><div>              &lt;?php if ( $comment-&gt;comment_approved == '0' ) : ?&gt;&nbsp;</div></li><li><div>                   &lt;em class=&quot;moderate&quot;&gt;&lt;?php _e( 'Your comment is awaiting moderation.', 'buddypress' ); ?&gt;&lt;/em&gt;&nbsp;</div></li><li><div>              &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;?php comment_text(); ?&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;div class=&quot;comment-options&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( comments_open() ) : ?&gt;&nbsp;</div></li><li><div>                      &lt;?php comment_reply_link( array( 'depth' =&gt; $depth, 'max_depth' =&gt; $args['max_depth'] ) ); ?&gt;&nbsp;</div></li><li><div>                  &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;?php if ( current_user_can( 'edit_comment', $comment-&gt;comment_ID ) ) : ?&gt;&nbsp;</div></li><li><div>                      &lt;?php printf( '&lt;a class=&quot;button comment-edit-link bp-secondary-action&quot; href=&quot;%1$s&quot; title=&quot;%2$s&quot;&gt;%3$s&lt;/a&gt; ', get_edit_comment_link( $comment-&gt;comment_ID ), esc_attr__( 'Edit comment', 'buddypress' ), __( 'Edit', 'buddypress' ) ); ?&gt;&nbsp;</div></li><li><div>                  &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_page_on_front' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return the ID of a page set as the home page.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return int|bool ID of page set as the home page</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.2)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_page_on_front() {&nbsp;</div></li><li><div>  if ( 'page' != get_option( 'show_on_front' ) )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return apply_filters( 'bp_dtheme_page_on_front', get_option( 'page_on_front' ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_activity_secondary_avatars' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Add secondary avatar image to this activity stream's record, if supported.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $action The text of this activity</span>&nbsp;</div></li><li><div><span class="comment"> * @param BP_Activity_Activity $activity Activity object</span>&nbsp;</div></li><li><div><span class="comment"> * @package BuddyPress Theme</span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.2.6)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_activity_secondary_avatars( $action, $activity ) {&nbsp;</div></li><li><div>  switch ( $activity-&gt;component ) {&nbsp;</div></li><li><div>      case 'groups' :&nbsp;</div></li><li><div>      case 'friends' :&nbsp;</div></li><li><div>          <span class="comment">// Only insert avatar if one exists</span>&nbsp;</div></li><li><div>          if ( $secondary_avatar = bp_get_activity_secondary_avatar() ) {&nbsp;</div></li><li><div>              $reverse_content = strrev( $action );&nbsp;</div></li><li><div>              $position = strpos( $reverse_content, 'a&lt;' );&nbsp;</div></li><li><div>              $action = substr_replace( $action, $secondary_avatar, -$position - 2, 0 );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $action;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_filter( 'bp_get_activity_action_pre_meta', 'bp_dtheme_activity_secondary_avatars', 10, 2 );&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_show_notice' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Show a notice when the theme is activated - workaround by Ozh (http://old.nabble.com/Activation-hook-exist-for-themes--td25211004.html)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.2)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_show_notice() {&nbsp;</div></li><li><div>  global $pagenow;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Bail if bp-default theme was not just activated</span>&nbsp;</div></li><li><div>  if ( empty( $_GET['activated'] ) || ( 'themes.php' != $pagenow ) || !is_admin() )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;div id=&quot;message&quot; class=&quot;updated fade&quot;&gt;&nbsp;</div></li><li><div>      &lt;p&gt;&lt;?php printf( __( 'Theme activated! This theme contains &lt;a href=&quot;%s&quot;&gt;custom header image&lt;/a&gt; support and &lt;a href=&quot;%s&quot;&gt;sidebar widgets&lt;/a&gt;.', 'buddypress' ), admin_url( 'themes.php?page=custom-header' ), admin_url( 'widgets.php' ) ); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>  &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;style type=&quot;text/css&quot;&gt;#message2, #message0 { display: none; }&lt;/style&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action( 'admin_notices', 'bp_dtheme_show_notice' );&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_main_nav' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * wp_nav_menu() callback from the main navigation in header.php</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Used when the custom menus haven't been configured.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array Menu arguments from wp_nav_menu()</span>&nbsp;</div></li><li><div><span class="comment"> * @see wp_nav_menu()</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.5)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_main_nav( $args ) {&nbsp;</div></li><li><div>  $pages_args = array(&nbsp;</div></li><li><div>      'depth' =&gt; 0, &nbsp;</div></li><li><div>      'echo' =&gt; false, &nbsp;</div></li><li><div>      'exclude' =&gt; '', &nbsp;</div></li><li><div>      'title_li' =&gt; ''&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  $menu = wp_page_menu( $pages_args );&nbsp;</div></li><li><div>  $menu = str_replace( array( '&lt;div class=&quot;menu&quot;&gt;&lt;ul&gt;', '&lt;/ul&gt;&lt;/div&gt;' ), array( '&lt;ul id=&quot;nav&quot;&gt;', '&lt;/ul&gt;&lt;!-- #nav --&gt;' ), $menu );&nbsp;</div></li><li><div>  echo $menu;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  do_action( 'bp_nav_items' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_page_menu_args' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Get our wp_nav_menu() fallback, bp_dtheme_main_nav(), to show a home link.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Default values for wp_page_menu()</span>&nbsp;</div></li><li><div><span class="comment"> * @see wp_page_menu()</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.5)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_page_menu_args( $args ) {&nbsp;</div></li><li><div>  $args['show_home'] = true;&nbsp;</div></li><li><div>  return $args;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_filter( 'wp_page_menu_args', 'bp_dtheme_page_menu_args' );&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_comment_form' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Applies BuddyPress customisations to the post comment form.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $default_labels The default options for strings, fields etc in the form</span>&nbsp;</div></li><li><div><span class="comment"> * @see comment_form()</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.5)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_comment_form( $default_labels ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $commenter = wp_get_current_commenter();&nbsp;</div></li><li><div>  $req = get_option( 'require_name_email' );&nbsp;</div></li><li><div>  $aria_req = ( $req ? &quot; aria-required='true'&quot; : '' );&nbsp;</div></li><li><div>  $fields =  array(&nbsp;</div></li><li><div>      'author' =&gt; '&lt;p class=&quot;comment-form-author&quot;&gt;' . '&lt;label for=&quot;author&quot;&gt;' . __( 'Name', 'buddypress' ) . ( $req ? '&lt;span class=&quot;required&quot;&gt; *&lt;/span&gt;' : '' ) . '&lt;/label&gt; ' .&nbsp;</div></li><li><div>                  '&lt;input id=&quot;author&quot; name=&quot;author&quot; type=&quot;text&quot; value=&quot;' . esc_attr( $commenter['comment_author'] ) . '&quot; size=&quot;30&quot;' . $aria_req . ' /&gt;&lt;/p&gt;', &nbsp;</div></li><li><div>      'email' =&gt; '&lt;p class=&quot;comment-form-email&quot;&gt;&lt;label for=&quot;email&quot;&gt;' . __( 'Email', 'buddypress' ) . ( $req ? '&lt;span class=&quot;required&quot;&gt; *&lt;/span&gt;' : '' ) . '&lt;/label&gt; ' .&nbsp;</div></li><li><div>                  '&lt;input id=&quot;email&quot; name=&quot;email&quot; type=&quot;text&quot; value=&quot;' . esc_attr(  $commenter['comment_author_email'] ) . '&quot; size=&quot;30&quot;' . $aria_req . ' /&gt;&lt;/p&gt;', &nbsp;</div></li><li><div>      'url' =&gt; '&lt;p class=&quot;comment-form-url&quot;&gt;&lt;label for=&quot;url&quot;&gt;' . __( 'Website', 'buddypress' ) . '&lt;/label&gt;' .&nbsp;</div></li><li><div>                  '&lt;input id=&quot;url&quot; name=&quot;url&quot; type=&quot;text&quot; value=&quot;' . esc_attr( $commenter['comment_author_url'] ) . '&quot; size=&quot;30&quot; /&gt;&lt;/p&gt;', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $new_labels = array(&nbsp;</div></li><li><div>      'comment_field' =&gt; '&lt;p class=&quot;form-textarea&quot;&gt;&lt;textarea name=&quot;comment&quot; id=&quot;comment&quot; cols=&quot;60&quot; rows=&quot;10&quot; aria-required=&quot;true&quot;&gt;&lt;/textarea&gt;&lt;/p&gt;', &nbsp;</div></li><li><div>      'fields' =&gt; apply_filters( 'comment_form_default_fields', $fields ), &nbsp;</div></li><li><div>      'logged_in_as' =&gt; '', &nbsp;</div></li><li><div>      'must_log_in' =&gt; '&lt;p class=&quot;alert&quot;&gt;' . sprintf( __( 'You must be &lt;a href=&quot;%1$s&quot;&gt;logged in&lt;/a&gt; to post a comment.', 'buddypress' ), wp_login_url( get_permalink() ) )    . '&lt;/p&gt;', &nbsp;</div></li><li><div>      'title_reply' =&gt; __( 'Leave a reply', 'buddypress' )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return apply_filters( 'bp_dtheme_comment_form', array_merge( $default_labels, $new_labels ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_filter( 'comment_form_defaults', 'bp_dtheme_comment_form', 10 );&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_before_comment_form' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Adds the user's avatar before the comment form box.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The 'comment_form_top' action is used to insert our HTML within &lt;div id=&quot;reply&quot;&gt;</span>&nbsp;</div></li><li><div><span class="comment"> * so that the nested comments comment-reply javascript moves the entirety of the comment reply area.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see comment_form()</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.5)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_before_comment_form() {&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>  &lt;div class=&quot;comment-avatar-box&quot;&gt;&nbsp;</div></li><li><div>      &lt;div class=&quot;avb&quot;&gt;&nbsp;</div></li><li><div>          &lt;?php if ( bp_loggedin_user_id() ) : ?&gt;&nbsp;</div></li><li><div>              &lt;a href=&quot;&lt;?php echo bp_loggedin_user_domain(); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php echo get_avatar( bp_loggedin_user_id(), 50 ); ?&gt;&nbsp;</div></li><li><div>              &lt;/a&gt;&nbsp;</div></li><li><div>          &lt;?php else : ?&gt;&nbsp;</div></li><li><div>              &lt;?php echo get_avatar( 0, 50 ); ?&gt;&nbsp;</div></li><li><div>          &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>  &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;div class=&quot;comment-content standard-form&quot;&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action( 'comment_form_top', 'bp_dtheme_before_comment_form' );&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_after_comment_form' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Closes tags opened in bp_dtheme_before_comment_form().</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see bp_dtheme_before_comment_form()</span>&nbsp;</div></li><li><div><span class="comment"> * @see comment_form()</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.5)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_after_comment_form() {&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;/div&gt;&lt;!-- .comment-content standard-form --&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action( 'comment_form', 'bp_dtheme_after_comment_form' );&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_sidebar_login_redirect_to' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Adds a hidden &quot;redirect_to&quot; input field to the sidebar login form.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.5)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_sidebar_login_redirect_to() {&nbsp;</div></li><li><div>  $redirect_to = !empty( $_REQUEST['redirect_to'] ) ? $_REQUEST['redirect_to'] : '';&nbsp;</div></li><li><div>  $redirect_to = apply_filters( 'bp_no_access_redirect', $redirect_to ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;input type=&quot;hidden&quot; name=&quot;redirect_to&quot; value=&quot;&lt;?php echo esc_url( $redirect_to ); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action( 'bp_sidebar_login_form', 'bp_dtheme_sidebar_login_redirect_to' );&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists( 'bp_dtheme_content_nav' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Display navigation to next/previous pages when applicable</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Query $wp_query</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $nav_id DOM ID for this navigation</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.5)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_content_nav( $nav_id ) {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;max_num_pages ) && $wp_query-&gt;max_num_pages &gt; 1 ) : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;div id=&quot;&lt;?php echo $nav_id; ?&gt;&quot; class=&quot;navigation&quot;&gt;&nbsp;</div></li><li><div>          &lt;div class=&quot;alignleft&quot;&gt;&lt;?php next_posts_link( __( '&larr; Previous Entries', 'buddypress' ) ); ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>          &lt;div class=&quot;alignright&quot;&gt;&lt;?php previous_posts_link( __( 'Next Entries &rarr;', 'buddypress' ) ); ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&lt;!-- #&lt;?php echo $nav_id; ?&gt; --&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Adds the no-js class to the body tag.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This function ensures that the &lt;body&gt; element will have the 'no-js' class by default. If you're</span>&nbsp;</div></li><li><div><span class="comment"> * using JavaScript for some visual functionality in your theme, and you want to provide noscript</span>&nbsp;</div></li><li><div><span class="comment"> * support, apply those styles to body.no-js.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The no-js class is removed by the JavaScript created in bp_dtheme_remove_nojs_body_class().</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package BuddyPress</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.5).1</span>&nbsp;</div></li><li><div><span class="comment"> * @see bp_dtheme_remove_nojs_body_class()</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_add_nojs_body_class( $classes ) {&nbsp;</div></li><li><div>  $classes[] = 'no-js';&nbsp;</div></li><li><div>  return array_unique( $classes );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_filter( 'bp_get_the_body_class', 'bp_dtheme_add_nojs_body_class' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Dynamically removes the no-js class from the &lt;body&gt; element.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * By default, the no-js class is added to the body (see bp_dtheme_add_no_js_body_class()). The</span>&nbsp;</div></li><li><div><span class="comment"> * JavaScript in this function is loaded into the &lt;body&gt; element immediately after the &lt;body&gt; tag</span>&nbsp;</div></li><li><div><span class="comment"> * (note that it's hooked to bp_before_header), and uses JavaScript to switch the 'no-js' body class</span>&nbsp;</div></li><li><div><span class="comment"> * to 'js'. If your theme has styles that should only apply for JavaScript-enabled users, apply them</span>&nbsp;</div></li><li><div><span class="comment"> * to body.js.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This technique is borrowed from WordPress, wp-admin/admin-header.php.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package BuddyPress</span>&nbsp;</div></li><li><div><span class="comment"> * @since BuddyPress (1.5).1</span>&nbsp;</div></li><li><div><span class="comment"> * @see bp_dtheme_add_nojs_body_class()</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_remove_nojs_body_class() {&nbsp;</div></li><li><div>?&gt;&lt;script type=&quot;text/javascript&quot;&gt;<span class="comment">//&lt;![CDATA[</span>&nbsp;</div></li><li><div>(function() {var c=document.body.className;c=c.replace(/no-js/, 'js');document.body.className=c;})();&nbsp;</div></li><li><div><span class="comment">//]]&gt;&lt;/script&gt;</span>&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action( 'bp_before_header', 'bp_dtheme_remove_nojs_body_class' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Ensure that multiselect boxes have trailing brackets in their 'id' and 'name' attributes.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * These brackets are required for an array of values to be sent in the POST</span>&nbsp;</div></li><li><div><span class="comment"> * request. Previously, bp_get_the_profile_field_input_name() contained the</span>&nbsp;</div></li><li><div><span class="comment"> * necessary logic, but since BP 2.0 that logic has been moved into</span>&nbsp;</div></li><li><div><span class="comment"> * BP_XProfile_Field_Type_Multiselectbox. Since bp-default does not use the</span>&nbsp;</div></li><li><div><span class="comment"> * BP_XProfile_Field_Type classes to build its markup, it did not inherit</span>&nbsp;</div></li><li><div><span class="comment"> * the brackets from their new location. Thus this workaround.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bp_dtheme_add_brackets_to_multiselectbox_attributes( $name ) {&nbsp;</div></li><li><div>  global $field;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'multiselectbox' === $field-&gt;type ) {&nbsp;</div></li><li><div>      $name .= '[]';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $name;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_filter( 'bp_get_the_profile_field_input_name', 'bp_dtheme_add_brackets_to_multiselectbox_attributes' );&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>BuddyPress</li><li><span></span>2.8.2</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>