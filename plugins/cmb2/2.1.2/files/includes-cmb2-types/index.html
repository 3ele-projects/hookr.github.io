<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="2.1.2" data-slug="cmb2" data-type="file" data-id="64640"><head xmlns="http://www.w3.org/1999/xhtml"><title> includes-cmb2-types | file | Cmb2 | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, cmb2, 2.1.2" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=5e11584d516a3141e077a7370ce4812d' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/includes-cmb2-types/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fincludes-cmb2-types%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fincludes-cmb2-types%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-cmb2-2.1.2-file-includes-cmb2-types","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="includes-cmb2-types" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to cmb2." href="http://hookr.io/plugins/cmb2/" class="plugin"><span property="name">cmb2</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.1.2." href="http://hookr.io/plugins/cmb2/2.1.2/" class="H_VERSION"><span property="name">2.1.2</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/cmb2/2.1.2/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">includes-cmb2-types</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="98"><a href="http://hookr.io/plugins/cmb2/2.1.2/all/" title="All">All <span class="count badge">98</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/cmb2/2.1.2/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="48"><a href="http://hookr.io/plugins/cmb2/2.1.2/hooks/" title="Hooks">Hooks <span class="count badge">48</span></a></li><li class="" data-id="action" data-count="13"><a href="http://hookr.io/plugins/cmb2/2.1.2/actions/" title="Actions">Actions <span class="count badge">13</span></a></li><li class="" data-id="filter" data-count="35"><a href="http://hookr.io/plugins/cmb2/2.1.2/filters/" title="Filters">Filters <span class="count badge">35</span></a></li><li class="" data-id="class" data-count="21"><a href="http://hookr.io/plugins/cmb2/2.1.2/classes/" title="Classes">Classes <span class="count badge">21</span></a></li><li class="" data-id="constant" data-count="4"><a href="http://hookr.io/plugins/cmb2/2.1.2/constants/" title="Constants">Constants <span class="count badge">4</span></a></li><li class="" data-id="function" data-count="25"><a href="http://hookr.io/plugins/cmb2/2.1.2/functions/" title="Functions">Functions <span class="count badge">25</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/plugins/cmb2/2.1.2/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/includes/CMB2_Types.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * CMB field type objects</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @todo Date/Time fields should store date format as data attribute for JS</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @category  WordPress_Plugin</span>&nbsp;</div></li><li><div><span class="comment"> * @package   CMB2</span>&nbsp;</div></li><li><div><span class="comment"> * @author    WebDevStudios</span>&nbsp;</div></li><li><div><span class="comment"> * @license   GPL-2.0+</span>&nbsp;</div></li><li><div><span class="comment"> * @link      http://webdevstudios.com</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>class CMB2_Types {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * An iterator value for repeatable fields</span>&nbsp;</div></li><li><div><span class="comment">   * @var   integer</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public $iterator = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Current CMB2_Field field object</span>&nbsp;</div></li><li><div><span class="comment">   * @var   CMB2_Field object</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public $field;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function __construct( CMB2_Field $field ) {&nbsp;</div></li><li><div>      $this-&gt;field = $field;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Default fallback. Allows rendering fields via &quot;cmb2_render_$name&quot; hook</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $name      Non-existent method name</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $arguments All arguments passed to the method</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function __call( $name, $arguments ) {&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Pass non-existent field types through an action</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * The dynamic portion of the hook name, $name, refers to the field type.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array  $field              The passed in `CMB2_Field` object</span>&nbsp;</div></li><li><div><span class="comment">       * @param mixed  $escaped_value      The value of this field escaped.</span>&nbsp;</div></li><li><div><span class="comment">       *                                   It defaults to `sanitize_text_field`.</span>&nbsp;</div></li><li><div><span class="comment">       *                                   If you need the unescaped value, you can access it</span>&nbsp;</div></li><li><div><span class="comment">       *                                   via `$field-&gt;value()`</span>&nbsp;</div></li><li><div><span class="comment">       * @param int    $object_id          The ID of the current object</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $object_type        The type of object you are working with.</span>&nbsp;</div></li><li><div><span class="comment">       *                                   Most commonly, `post` (this applies to all post-types), </span>&nbsp;</div></li><li><div><span class="comment">       *                                   but could also be `comment`, `user` or `options-page`.</span>&nbsp;</div></li><li><div><span class="comment">       * @param object $field_type_object  This `CMB2_Types` object</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      do_action( &quot;cmb2_render_$name&quot;, $this-&gt;field, $this-&gt;field-&gt;escaped_value(), $this-&gt;field-&gt;object_id, $this-&gt;field-&gt;object_type, $this );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Render a field (and handle repeatable)</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function render() {&nbsp;</div></li><li><div>      if ( $this-&gt;field-&gt;args( 'repeatable' ) ) {&nbsp;</div></li><li><div>          $this-&gt;render_repeatable_field();&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $this-&gt;_render();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Render a field type</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  protected function _render() {&nbsp;</div></li><li><div>      $this-&gt;field-&gt;peform_param_callback( 'before_field' );&nbsp;</div></li><li><div>      echo $this-&gt;{$this-&gt;field-&gt;type()}();&nbsp;</div></li><li><div>      $this-&gt;field-&gt;peform_param_callback( 'after_field' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Checks if we can get a post object, and if so, uses `get_the_terms` which utilizes caching</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.2</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed Array of terms on success</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_object_terms() {&nbsp;</div></li><li><div>      $object_id = $this-&gt;field-&gt;object_id;&nbsp;</div></li><li><div>      $taxonomy = $this-&gt;field-&gt;args( 'taxonomy' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! $post = get_post( $object_id ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $cache_key = &quot;cmb-cache-{$taxonomy}-{$object_id}&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Check cache</span>&nbsp;</div></li><li><div>          $cached = get_transient( $cache_key );&nbsp;</div></li><li><div>          if ( $cached ) {&nbsp;</div></li><li><div>              return $cached;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $cached = wp_get_object_terms( $object_id, $taxonomy );&nbsp;</div></li><li><div>          <span class="comment">// Do our own (minimal) caching. Long enough for a page-load.</span>&nbsp;</div></li><li><div>          set_transient( $cache_key, $cached, 60 );&nbsp;</div></li><li><div>          return $cached;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// WP caches internally so it's better to use</span>&nbsp;</div></li><li><div>      return get_the_terms( $post, $taxonomy );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Retrieve text parameter from field's options array (if it has one), or use fallback text</span>&nbsp;</div></li><li><div><span class="comment">   * @since  2.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $option_key Key in field's options array</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $fallback   Fallback text</span>&nbsp;</div></li><li><div><span class="comment">   * @return string              Text</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function _text( $option_key, $fallback ) {&nbsp;</div></li><li><div>      $has_string_param = $this-&gt;field-&gt;options( $option_key );&nbsp;</div></li><li><div>      return $has_string_param ? $has_string_param : $fallback;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Determine a file's extension</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string       $file File url</span>&nbsp;</div></li><li><div><span class="comment">   * @return string|false       File extension or false</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_file_ext( $file ) {&nbsp;</div></li><li><div>      $parsed = @parse_url( $file, PHP_URL_PATH );&nbsp;</div></li><li><div>      return $parsed ? strtolower( pathinfo( $parsed, PATHINFO_EXTENSION ) ) : false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the file name from a url</span>&nbsp;</div></li><li><div><span class="comment">   * @since  2.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $value File url or path</span>&nbsp;</div></li><li><div><span class="comment">   * @return string        File name</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_file_name_from_path( $value ) {&nbsp;</div></li><li><div>      $parts = explode( '/', $value );&nbsp;</div></li><li><div>      return is_array( $parts ) ? end( $parts ) : $value;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Determines if a file has a valid image extension</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $file File url</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool         Whether file has a valid image extension</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function is_valid_img_ext( $file ) {&nbsp;</div></li><li><div>      $file_ext = $this-&gt;get_file_ext( $file );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $is_valid_types = apply_filters( 'cmb2_valid_img_types', array( 'jpg', 'jpeg', 'png', 'gif', 'ico', 'icon' ) );&nbsp;</div></li><li><div>      $is_valid = $file_ext && in_array( $file_ext, (array) $is_valid_types );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return (bool) apply_filters( 'cmb2_' . $this-&gt;field-&gt;id() . '_is_valid_img_ext', $is_valid, $file, $file_ext );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Handles parsing and filtering attributes while preserving any passed in via field config.</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $args     Override arguments</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $element  Element for filter</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $defaults Default arguments</span>&nbsp;</div></li><li><div><span class="comment">   * @return array            Parsed and filtered arguments</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function parse_args( $args, $element, $defaults ) {&nbsp;</div></li><li><div>      return wp_parse_args( apply_filters( &quot;cmb2_{$element}_attributes&quot;, $this-&gt;field-&gt;maybe_set_attributes( $args ), $defaults, $this-&gt;field, $this ), $defaults );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Combines attributes into a string for a form element</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $attrs        Attributes to concatenate</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $attr_exclude Attributes that should NOT be concatenated</span>&nbsp;</div></li><li><div><span class="comment">   * @return string               String of attributes for form element</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function concat_attrs( $attrs, $attr_exclude = array() ) {&nbsp;</div></li><li><div>      $attributes = '';&nbsp;</div></li><li><div>      foreach ( $attrs as $attr =&gt; $val ) {&nbsp;</div></li><li><div>          $excluded = in_array( $attr, (array) $attr_exclude, true );&nbsp;</div></li><li><div>          $empty = false === $val && 'value' !== $attr;&nbsp;</div></li><li><div>          if ( ! $excluded && ! $empty ) {&nbsp;</div></li><li><div>              <span class="comment">// if data attribute, use single quote wraps, else double</span>&nbsp;</div></li><li><div>              $quotes = false !== stripos( $attr, 'data-' ) ? &quot;'&quot; : '&quot;';&nbsp;</div></li><li><div>              $attributes .= sprintf( ' %1$s=%3$s%2$s%3$s', $attr, $val, $quotes );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return $attributes;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generates html for concatenated items</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array   $args Optional arguments</span>&nbsp;</div></li><li><div><span class="comment">   * @return string        Concatenated html items</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function concat_items( $args = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $method = isset( $args['method'] ) ? $args['method'] : 'select_option';&nbsp;</div></li><li><div>      unset( $args['method'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $value = $this-&gt;field-&gt;escaped_value()&nbsp;</div></li><li><div>          ? $this-&gt;field-&gt;escaped_value()&nbsp;</div></li><li><div>          : $this-&gt;field-&gt;args( 'default' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $concatenated_items = ''; $i = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $options = array();&nbsp;</div></li><li><div>      if ( $option_none = $this-&gt;field-&gt;args( 'show_option_none' ) ) {&nbsp;</div></li><li><div>          $options[ '' ] = $option_none;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $options = $options + (array) $this-&gt;field-&gt;options();&nbsp;</div></li><li><div>      foreach ( $options as $opt_value =&gt; $opt_label ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Clone args & modify for just this item</span>&nbsp;</div></li><li><div>          $a = $args;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $a['value'] = $opt_value;&nbsp;</div></li><li><div>          $a['label'] = $opt_label;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Check if this option is the value of the input</span>&nbsp;</div></li><li><div>          if ( $value == $opt_value ) {&nbsp;</div></li><li><div>              $a['checked'] = 'checked';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $concatenated_items .= $this-&gt;$method( $a, $i++ );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $concatenated_items;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generates html for an option element</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $args Arguments array containing value, label, and checked boolean</span>&nbsp;</div></li><li><div><span class="comment">   * @return string       Generated option element html</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function select_option( $args = array() ) {&nbsp;</div></li><li><div>      return sprintf( &quot;\t&quot; . '&lt;option value=&quot;%s&quot; %s&gt;%s&lt;/option&gt;', $args['value'], selected( isset( $args['checked'] ) && $args['checked'], true, false ), $args['label'] ) . &quot;\n&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generates html for list item with input</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $args Override arguments</span>&nbsp;</div></li><li><div><span class="comment">   * @param  int    $i    Iterator value</span>&nbsp;</div></li><li><div><span class="comment">   * @return string       Gnerated list item html</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function list_input( $args = array(), $i ) {&nbsp;</div></li><li><div>      $a = $this-&gt;parse_args( $args, 'list_input', array(&nbsp;</div></li><li><div>          'type' =&gt; 'radio', &nbsp;</div></li><li><div>          'class' =&gt; 'cmb2-option', &nbsp;</div></li><li><div>          'name' =&gt; $this-&gt;_name(), &nbsp;</div></li><li><div>          'id' =&gt; $this-&gt;_id( $i ), &nbsp;</div></li><li><div>          'value' =&gt; $this-&gt;field-&gt;escaped_value(), &nbsp;</div></li><li><div>          'label' =&gt; '', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return sprintf( &quot;\t&quot; . '&lt;li&gt;&lt;input%s/&gt; &lt;label for=&quot;%s&quot;&gt;%s&lt;/label&gt;&lt;/li&gt;' . &quot;\n&quot;, $this-&gt;concat_attrs( $a, array( 'label' ) ), $a['id'], $a['label'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generates html for list item with checkbox input</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $args Override arguments</span>&nbsp;</div></li><li><div><span class="comment">   * @param  int    $i    Iterator value</span>&nbsp;</div></li><li><div><span class="comment">   * @return string       Gnerated list item html</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function list_input_checkbox( $args, $i ) {&nbsp;</div></li><li><div>      $saved_value = $this-&gt;field-&gt;escaped_value();&nbsp;</div></li><li><div>      if ( is_array( $saved_value ) && in_array( $args['value'], $saved_value ) ) {&nbsp;</div></li><li><div>          $args['checked'] = 'checked';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $args['type'] = 'checkbox';&nbsp;</div></li><li><div>      return $this-&gt;list_input( $args, $i );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generates repeatable field table markup</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function render_repeatable_field() {&nbsp;</div></li><li><div>      $table_id = $this-&gt;field-&gt;id() . '_repeat';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;_desc( true, true, true );&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;div id=&quot;&lt;?php echo $table_id; ?&gt;&quot; class=&quot;cmb-repeat-table cmb-nested&quot;&gt;&nbsp;</div></li><li><div>          &lt;div class=&quot;cmb-tbody cmb-field-list&quot;&gt;&nbsp;</div></li><li><div>              &lt;?php $this-&gt;repeatable_rows(); ?&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>      &lt;p class=&quot;cmb-add-row&quot;&gt;&nbsp;</div></li><li><div>          &lt;button data-selector=&quot;&lt;?php echo $table_id; ?&gt;&quot; class=&quot;cmb-add-row-button button&quot;&gt;&lt;?php echo esc_html( $this-&gt;_text( 'add_row_text', __( 'Add Row', 'cmb2' ) ) ); ?&gt;&lt;/button&gt;&nbsp;</div></li><li><div>      &lt;/p&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      <span class="comment">// reset iterator</span>&nbsp;</div></li><li><div>      $this-&gt;iterator = 0;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generates repeatable field rows</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function repeatable_rows() {&nbsp;</div></li><li><div>      $meta_value = array_filter( (array) $this-&gt;field-&gt;escaped_value() );&nbsp;</div></li><li><div>      <span class="comment">// check for default content</span>&nbsp;</div></li><li><div>      $default = $this-&gt;field-&gt;args( 'default' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// check for saved data</span>&nbsp;</div></li><li><div>      if ( ! empty( $meta_value ) ) {&nbsp;</div></li><li><div>          $meta_value = is_array( $meta_value ) ? array_filter( $meta_value ) : $meta_value;&nbsp;</div></li><li><div>          $meta_value = ! empty( $meta_value ) ? $meta_value : $default;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $meta_value = $default;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Loop value array and add a row</span>&nbsp;</div></li><li><div>      if ( ! empty( $meta_value ) ) {&nbsp;</div></li><li><div>          $count = count( $meta_value );&nbsp;</div></li><li><div>          foreach ( (array) $meta_value as $val ) {&nbsp;</div></li><li><div>              $this-&gt;field-&gt;escaped_value = $val;&nbsp;</div></li><li><div>              $this-&gt;repeat_row( $count &lt; 2 );&nbsp;</div></li><li><div>              $this-&gt;iterator++;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          <span class="comment">// Otherwise add one row</span>&nbsp;</div></li><li><div>          $this-&gt;repeat_row( true );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Then add an empty row</span>&nbsp;</div></li><li><div>      $this-&gt;field-&gt;escaped_value = '';&nbsp;</div></li><li><div>      $this-&gt;iterator = $this-&gt;iterator ? $this-&gt;iterator : 1;&nbsp;</div></li><li><div>      $this-&gt;repeat_row( false, 'empty-row hidden' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generates a repeatable row's markup</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool   $disable_remover Whether remove button should be disabled</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $class Repeatable table row's class</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  protected function repeat_row( $disable_remover = false, $class = 'cmb-repeat-row' ) {&nbsp;</div></li><li><div>      $disabled = $disable_remover ? ' button-disabled' : '';&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;div class=&quot;cmb-row &lt;?php echo $class; ?&gt;&quot;&gt;&nbsp;</div></li><li><div>          &lt;div class=&quot;cmb-td&quot;&gt;&nbsp;</div></li><li><div>              &lt;?php $this-&gt;_render(); ?&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>          &lt;div class=&quot;cmb-td cmb-remove-row&quot;&gt;&nbsp;</div></li><li><div>              &lt;button class=&quot;button cmb-remove-row-button&lt;?php echo $disabled; ?&gt;&quot;&gt;&lt;?php echo esc_html( $this-&gt;_text( 'remove_row_text', __( 'Remove', 'cmb2' ) ) ); ?&gt;&lt;/button&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generates description markup</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  boolean $paragraph Paragraph tag or span</span>&nbsp;</div></li><li><div><span class="comment">   * @param  boolean $echo      Whether to echo description or only return it</span>&nbsp;</div></li><li><div><span class="comment">   * @return string             Field's description markup</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function _desc( $paragraph = false, $echo = false, $repeat_group = false ) {&nbsp;</div></li><li><div>      <span class="comment">// Prevent description from printing multiple times for repeatable fields</span>&nbsp;</div></li><li><div>      if ( ! $repeat_group && ( $this-&gt;field-&gt;args( 'repeatable' ) || $this-&gt;iterator &gt; 0 ) ) {&nbsp;</div></li><li><div>          return '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $desc = $this-&gt;field-&gt;args( 'description' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! $desc ) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $tag = $paragraph ? 'p' : 'span';&nbsp;</div></li><li><div>      $desc = sprintf( &quot;\n&quot; . '&lt;%1$s class=&quot;cmb2-metabox-description&quot;&gt;%2$s&lt;/%1$s&gt;' . &quot;\n&quot;, $tag, $desc );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $echo ) {&nbsp;</div></li><li><div>          echo $desc;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return $desc;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate field name attribute</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $suffix For multi-part fields</span>&nbsp;</div></li><li><div><span class="comment">   * @return string          Name attribute</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function _name( $suffix = '' ) {&nbsp;</div></li><li><div>      return $this-&gt;field-&gt;args( '_name' ) . ( $this-&gt;field-&gt;args( 'repeatable' ) ? '[' . $this-&gt;iterator . ']' : '' ) . $suffix;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate field id attribute</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $suffix For multi-part fields</span>&nbsp;</div></li><li><div><span class="comment">   * @return string          Id attribute</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function _id( $suffix = '' ) {&nbsp;</div></li><li><div>      return $this-&gt;field-&gt;id() . $suffix . ( $this-&gt;field-&gt;args( 'repeatable' ) ? '_' . $this-&gt;iterator . '&quot; data-iterator=&quot;' . $this-&gt;iterator : '' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Handles outputting an 'input' element</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $args Override arguments</span>&nbsp;</div></li><li><div><span class="comment">   * @return string       Form input element</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function input( $args = array() ) {&nbsp;</div></li><li><div>      $a = $this-&gt;parse_args( $args, 'input', array(&nbsp;</div></li><li><div>          'type' =&gt; 'text', &nbsp;</div></li><li><div>          'class' =&gt; 'regular-text', &nbsp;</div></li><li><div>          'name' =&gt; $this-&gt;_name(), &nbsp;</div></li><li><div>          'id' =&gt; $this-&gt;_id(), &nbsp;</div></li><li><div>          'value' =&gt; $this-&gt;field-&gt;escaped_value(), &nbsp;</div></li><li><div>          'desc' =&gt; $this-&gt;_desc( true ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return sprintf( '&lt;input%s/&gt;%s', $this-&gt;concat_attrs( $a, array( 'desc' ) ), $a['desc'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Handles outputting an 'textarea' element</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.1.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $args Override arguments</span>&nbsp;</div></li><li><div><span class="comment">   * @return string       Form textarea element</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function textarea( $args = array() ) {&nbsp;</div></li><li><div>      $a = $this-&gt;parse_args( $args, 'textarea', array(&nbsp;</div></li><li><div>          'class' =&gt; 'cmb2_textarea', &nbsp;</div></li><li><div>          'name' =&gt; $this-&gt;_name(), &nbsp;</div></li><li><div>          'id' =&gt; $this-&gt;_id(), &nbsp;</div></li><li><div>          'cols' =&gt; 60, &nbsp;</div></li><li><div>          'rows' =&gt; 10, &nbsp;</div></li><li><div>          'value' =&gt; $this-&gt;field-&gt;escaped_value( 'esc_textarea' ), &nbsp;</div></li><li><div>          'desc' =&gt; $this-&gt;_desc( true ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>      return sprintf( '&lt;textarea%s&gt;%s&lt;/textarea&gt;%s', $this-&gt;concat_attrs( $a, array( 'desc', 'value' ) ), $a['value'], $a['desc'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Begin Field Types</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function text() {&nbsp;</div></li><li><div>      return $this-&gt;input();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function hidden() {&nbsp;</div></li><li><div>      return $this-&gt;input( array( 'type' =&gt; 'hidden', 'desc' =&gt; '', 'class' =&gt; false ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function text_small() {&nbsp;</div></li><li><div>      return $this-&gt;input( array( 'class' =&gt; 'cmb2-text-small', 'desc' =&gt; $this-&gt;_desc() ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function text_medium() {&nbsp;</div></li><li><div>      return $this-&gt;input( array( 'class' =&gt; 'cmb2-text-medium', 'desc' =&gt; $this-&gt;_desc() ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function text_email() {&nbsp;</div></li><li><div>      return $this-&gt;input( array( 'class' =&gt; 'cmb2-text-email cmb2-text-medium', 'type' =&gt; 'email' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function text_url() {&nbsp;</div></li><li><div>      return $this-&gt;input( array( 'class' =&gt; 'cmb2-text-url cmb2-text-medium regular-text', 'value' =&gt; $this-&gt;field-&gt;escaped_value( 'esc_url' ) ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function text_money() {&nbsp;</div></li><li><div>      return ( ! $this-&gt;field-&gt;get_param_callback_result( 'before_field' ) ? '$ ' : ' ' ) . $this-&gt;input( array( 'class' =&gt; 'cmb2-text-money', 'desc' =&gt; $this-&gt;_desc() ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function textarea_small() {&nbsp;</div></li><li><div>      return $this-&gt;textarea( array( 'class' =&gt; 'cmb2-textarea-small', 'rows' =&gt; 4 ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function textarea_code() {&nbsp;</div></li><li><div>      return sprintf( '&lt;pre&gt;%s', $this-&gt;textarea( array( 'class' =&gt; 'cmb2-textarea-code', 'desc' =&gt; '&lt;/pre&gt;' . $this-&gt;_desc( true ) ) ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function wysiwyg( $args = array() ) {&nbsp;</div></li><li><div>      $a = $this-&gt;parse_args( $args, 'input', array(&nbsp;</div></li><li><div>          'id' =&gt; $this-&gt;_id(), &nbsp;</div></li><li><div>          'value' =&gt; $this-&gt;field-&gt;escaped_value( 'stripslashes' ), &nbsp;</div></li><li><div>          'desc' =&gt; $this-&gt;_desc( true ), &nbsp;</div></li><li><div>          'options' =&gt; $this-&gt;field-&gt;options(), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      wp_editor( $a['value'], $a['id'], $a['options'] );&nbsp;</div></li><li><div>      echo $a['desc'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function text_date( $args = array() ) {&nbsp;</div></li><li><div>      $args = wp_parse_args( $args, array(&nbsp;</div></li><li><div>          'class' =&gt; 'cmb2-text-small cmb2-datepicker', &nbsp;</div></li><li><div>          'value' =&gt; $this-&gt;field-&gt;get_timestamp_format(), &nbsp;</div></li><li><div>          'desc' =&gt; $this-&gt;_desc(), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      CMB2_JS::add_dependencies( array( 'jquery-ui-core', 'jquery-ui-datepicker' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $this-&gt;input( $args );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Alias for text_date</span>&nbsp;</div></li><li><div>  public function text_date_timestamp( $args = array() ) {&nbsp;</div></li><li><div>      return $this-&gt;text_date( $args );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function text_time( $args = array() ) {&nbsp;</div></li><li><div>      $args = wp_parse_args( $args, array(&nbsp;</div></li><li><div>          'class' =&gt; 'cmb2-timepicker text-time', &nbsp;</div></li><li><div>          'value' =&gt; $this-&gt;field-&gt;get_timestamp_format( 'time_format' ), &nbsp;</div></li><li><div>          'desc' =&gt; $this-&gt;_desc(), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      CMB2_JS::add_dependencies( array( 'jquery-ui-core', 'jquery-ui-datepicker', 'jquery-ui-datetimepicker' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $this-&gt;input( $args );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function text_datetime_timestamp( $args = array() ) {&nbsp;</div></li><li><div>      $args = wp_parse_args( $args, array(&nbsp;</div></li><li><div>          'value' =&gt; $this-&gt;field-&gt;escaped_value(), &nbsp;</div></li><li><div>          'desc' =&gt; $this-&gt;_desc(), &nbsp;</div></li><li><div>          'datepicker' =&gt; array(), &nbsp;</div></li><li><div>          'timepicker' =&gt; array(), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $args['value'] ) ) {&nbsp;</div></li><li><div>          $args['value'] = $this-&gt;field-&gt;escaped_value();&nbsp;</div></li><li><div>          <span class="comment">// This will be used if there is a select_timezone set for this field</span>&nbsp;</div></li><li><div>          $tz_offset = $this-&gt;field-&gt;field_timezone_offset();&nbsp;</div></li><li><div>          if ( ! empty( $tz_offset ) ) {&nbsp;</div></li><li><div>              $args['value'] -= $tz_offset;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $has_good_value = ! empty( $args['value'] ) && ! is_array( $args['value'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $date_args = wp_parse_args( $args['datepicker'], array(&nbsp;</div></li><li><div>          'class' =&gt; 'cmb2-text-small cmb2-datepicker', &nbsp;</div></li><li><div>          'name' =&gt; $this-&gt;_name( '[date]' ), &nbsp;</div></li><li><div>          'id' =&gt; $this-&gt;_id( '_date' ), &nbsp;</div></li><li><div>          'value' =&gt; $has_good_value ? $this-&gt;field-&gt;get_timestamp_format( 'date_format', $args['value'] ) : '', &nbsp;</div></li><li><div>          'desc' =&gt; '', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $time_args = wp_parse_args( $args['timepicker'], array(&nbsp;</div></li><li><div>          'class' =&gt; 'cmb2-timepicker text-time', &nbsp;</div></li><li><div>          'name' =&gt; $this-&gt;_name( '[time]' ), &nbsp;</div></li><li><div>          'id' =&gt; $this-&gt;_id( '_time' ), &nbsp;</div></li><li><div>          'value' =&gt; $has_good_value ? $this-&gt;field-&gt;get_timestamp_format( 'time_format', $args['value'] ) : '', &nbsp;</div></li><li><div>          'desc' =&gt; $args['desc'], &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      CMB2_JS::add_dependencies( array( 'jquery-ui-core', 'jquery-ui-datepicker', 'jquery-ui-datetimepicker' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $this-&gt;input( $date_args ) . &quot;\n&quot; . $this-&gt;input( $time_args );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function text_datetime_timestamp_timezone( $args = array() ) {&nbsp;</div></li><li><div>      $args = wp_parse_args( $args, array(&nbsp;</div></li><li><div>          'value' =&gt; $this-&gt;field-&gt;escaped_value(), &nbsp;</div></li><li><div>          'desc' =&gt; $this-&gt;_desc( true ), &nbsp;</div></li><li><div>          'text_datetime_timestamp' =&gt; array(), &nbsp;</div></li><li><div>          'select_timezone' =&gt; array(), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $args['value'] = $this-&gt;field-&gt;escaped_value();&nbsp;</div></li><li><div>      if ( is_array( $args['value'] ) ) {&nbsp;</div></li><li><div>          $args['value'] = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $datetime = unserialize( $args['value'] );&nbsp;</div></li><li><div>      $args['value'] = $tzstring = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $datetime && $datetime instanceof DateTime ) {&nbsp;</div></li><li><div>          $tz = $datetime-&gt;getTimezone();&nbsp;</div></li><li><div>          $tzstring = $tz-&gt;getName();&nbsp;</div></li><li><div>          $args['value'] = $datetime-&gt;getTimestamp() + $tz-&gt;getOffset( new DateTime( 'NOW' ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $timestamp_args = wp_parse_args( $args['text_datetime_timestamp'], array(&nbsp;</div></li><li><div>          'desc' =&gt; '', &nbsp;</div></li><li><div>          'value' =&gt; $args['value'], &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $timezone_args = wp_parse_args( $args['select_timezone'], array(&nbsp;</div></li><li><div>          'class' =&gt; 'cmb2_select cmb2-select-timezone', &nbsp;</div></li><li><div>          'name' =&gt; $this-&gt;_name( '[timezone]' ), &nbsp;</div></li><li><div>          'id' =&gt; $this-&gt;_id( '_timezone' ), &nbsp;</div></li><li><div>          'options' =&gt; wp_timezone_choice( $tzstring ), &nbsp;</div></li><li><div>          'desc' =&gt; $args['desc'], &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $this-&gt;text_datetime_timestamp( $timestamp_args ) . &quot;\n&quot; . $this-&gt;select( $timezone_args );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function select_timezone() {&nbsp;</div></li><li><div>      $this-&gt;field-&gt;args['default'] = $this-&gt;field-&gt;args( 'default' )&nbsp;</div></li><li><div>          ? $this-&gt;field-&gt;args( 'default' )&nbsp;</div></li><li><div>          : cmb2_utils()-&gt;timezone_string();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $this-&gt;select( array(&nbsp;</div></li><li><div>          'class' =&gt; 'cmb2_select cmb2-select-timezone', &nbsp;</div></li><li><div>          'options' =&gt; wp_timezone_choice( $this-&gt;field-&gt;escaped_value() ), &nbsp;</div></li><li><div>          'desc' =&gt; $this-&gt;_desc(), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function colorpicker() {&nbsp;</div></li><li><div>      $meta_value = $this-&gt;field-&gt;escaped_value();&nbsp;</div></li><li><div>      $hex_color = '(([a-fA-F0-9]) {3}) {1, 2}$';&nbsp;</div></li><li><div>      if ( preg_match( '/^' . $hex_color . '/i', $meta_value ) ) {&nbsp;</div></li><li><div>          <span class="comment">// Value is just 123abc, so prepend #</span>&nbsp;</div></li><li><div>          $meta_value = '#' . $meta_value;&nbsp;</div></li><li><div>      } elseif ( ! preg_match( '/^#' . $hex_color . '/i', $meta_value ) ) {&nbsp;</div></li><li><div>          <span class="comment">// Value doesn't match #123abc, so sanitize to just #</span>&nbsp;</div></li><li><div>          $meta_value = '#';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      wp_enqueue_style( 'wp-color-picker' );&nbsp;</div></li><li><div>      CMB2_JS::add_dependencies( array( 'wp-color-picker' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $this-&gt;input( array( 'class' =&gt; 'cmb2-colorpicker cmb2-text-small', 'value' =&gt; $meta_value ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function title( $args = array() ) {&nbsp;</div></li><li><div>      $a = $this-&gt;parse_args( $args, 'title', array(&nbsp;</div></li><li><div>          'tag' =&gt; $this-&gt;field-&gt;object_type == 'post' ? 'h5' : 'h3', &nbsp;</div></li><li><div>          'class' =&gt; 'cmb2-metabox-title', &nbsp;</div></li><li><div>          'name' =&gt; $this-&gt;field-&gt;args( 'name' ), &nbsp;</div></li><li><div>          'desc' =&gt; $this-&gt;_desc( true ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return sprintf( '&lt;%1$s class=&quot;%2$s&quot;&gt;%3$s&lt;/%1$s&gt;%4$s', $a['tag'], $a['class'], $a['name'], $a['desc'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function select( $args = array() ) {&nbsp;</div></li><li><div>      $a = $this-&gt;parse_args( $args, 'select', array(&nbsp;</div></li><li><div>          'class' =&gt; 'cmb2_select', &nbsp;</div></li><li><div>          'name' =&gt; $this-&gt;_name(), &nbsp;</div></li><li><div>          'id' =&gt; $this-&gt;_id(), &nbsp;</div></li><li><div>          'desc' =&gt; $this-&gt;_desc( true ), &nbsp;</div></li><li><div>          'options' =&gt; $this-&gt;concat_items(), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $attrs = $this-&gt;concat_attrs( $a, array( 'desc', 'options' ) );&nbsp;</div></li><li><div>      return sprintf( '&lt;select%s&gt;%s&lt;/select&gt;%s', $attrs, $a['options'], $a['desc'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function taxonomy_select() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $names = $this-&gt;get_object_terms();&nbsp;</div></li><li><div>      $saved_term = is_wp_error( $names ) || empty( $names ) ? $this-&gt;field-&gt;args( 'default' ) : $names[key( $names )]-&gt;slug;&nbsp;</div></li><li><div>      $terms = get_terms( $this-&gt;field-&gt;args( 'taxonomy' ), 'hide_empty=0' );&nbsp;</div></li><li><div>      $options = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $option_none = $this-&gt;field-&gt;args( 'show_option_none' );&nbsp;</div></li><li><div>      if ( ! empty( $option_none ) ) {&nbsp;</div></li><li><div>          $option_none_value = apply_filters( 'cmb2_taxonomy_select_default_value', '' );&nbsp;</div></li><li><div>          $option_none_value = apply_filters( &quot;cmb2_taxonomy_select_{$this-&gt;_id()}_default_value&quot;, $option_none_value );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $options .= $this-&gt;select_option( array(&nbsp;</div></li><li><div>              'label' =&gt; $option_none, &nbsp;</div></li><li><div>              'value' =&gt; $option_none_value, &nbsp;</div></li><li><div>              'checked' =&gt; $saved_term == $option_none_value, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $terms as $term ) {&nbsp;</div></li><li><div>          $options .= $this-&gt;select_option( array(&nbsp;</div></li><li><div>              'label' =&gt; $term-&gt;name, &nbsp;</div></li><li><div>              'value' =&gt; $term-&gt;slug, &nbsp;</div></li><li><div>              'checked' =&gt; $saved_term == $term-&gt;slug, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $this-&gt;select( array( 'options' =&gt; $options ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function radio( $args = array(), $type = 'radio' ) {&nbsp;</div></li><li><div>      $a = $this-&gt;parse_args( $args, $type, array(&nbsp;</div></li><li><div>          'class' =&gt; 'cmb2-radio-list cmb2-list', &nbsp;</div></li><li><div>          'options' =&gt; $this-&gt;concat_items( array( 'label' =&gt; 'test', 'method' =&gt; 'list_input' ) ), &nbsp;</div></li><li><div>          'desc' =&gt; $this-&gt;_desc( true ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return sprintf( '&lt;ul class=&quot;%s&quot;&gt;%s&lt;/ul&gt;%s', $a['class'], $a['options'], $a['desc'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function radio_inline() {&nbsp;</div></li><li><div>      return $this-&gt;radio( array(), 'radio_inline' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function multicheck( $type = 'checkbox' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $classes = false === $this-&gt;field-&gt;args( 'select_all_button' )&nbsp;</div></li><li><div>          ? 'cmb2-checkbox-list no-select-all cmb2-list'&nbsp;</div></li><li><div>          : 'cmb2-checkbox-list cmb2-list';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $this-&gt;radio( array( 'class' =&gt; $classes, 'options' =&gt; $this-&gt;concat_items( array( 'name' =&gt; $this-&gt;_name() . '[]', 'method' =&gt; 'list_input_checkbox' ) ) ), $type );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function multicheck_inline() {&nbsp;</div></li><li><div>      return $this-&gt;multicheck( 'multicheck_inline' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function checkbox( $args = array(), $is_checked = null ) {&nbsp;</div></li><li><div>      $defaults = array(&nbsp;</div></li><li><div>          'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>          'class' =&gt; 'cmb2-option cmb2-list', &nbsp;</div></li><li><div>          'value' =&gt; 'on', &nbsp;</div></li><li><div>          'desc' =&gt; '', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $meta_value = $this-&gt;field-&gt;escaped_value();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $is_checked = is_null( $is_checked )&nbsp;</div></li><li><div>          ? ! empty( $meta_value )&nbsp;</div></li><li><div>          : $is_checked;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $is_checked ) {&nbsp;</div></li><li><div>          $defaults['checked'] = 'checked';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $args = $this-&gt;parse_args( $args, 'checkbox', $defaults );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return sprintf( '%s &lt;label for=&quot;%s&quot;&gt;%s&lt;/label&gt;', $this-&gt;input( $args ), $this-&gt;_id(), $this-&gt;_desc() );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function taxonomy_radio() {&nbsp;</div></li><li><div>      $names = $this-&gt;get_object_terms();&nbsp;</div></li><li><div>      $saved_term = is_wp_error( $names ) || empty( $names ) ? $this-&gt;field-&gt;args( 'default' ) : $names[key( $names )]-&gt;slug;&nbsp;</div></li><li><div>      $terms = get_terms( $this-&gt;field-&gt;args( 'taxonomy' ), 'hide_empty=0' );&nbsp;</div></li><li><div>      $options = ''; $i = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! $terms ) {&nbsp;</div></li><li><div>          $options .= sprintf( '&lt;li&gt;&lt;label&gt;%s&lt;/label&gt;&lt;/li&gt;', esc_html( $this-&gt;_text( 'no_terms_text', __( 'No terms', 'cmb2' ) ) ) );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $option_none = $this-&gt;field-&gt;args( 'show_option_none' );&nbsp;</div></li><li><div>          if ( ! empty( $option_none ) ) {&nbsp;</div></li><li><div>              $option_none_value = apply_filters( &quot;cmb2_taxonomy_radio_{$this-&gt;_id()}_default_value&quot;, apply_filters( 'cmb2_taxonomy_radio_default_value', '' ) );&nbsp;</div></li><li><div>              $args = array(&nbsp;</div></li><li><div>                  'value' =&gt; $option_none_value, &nbsp;</div></li><li><div>                  'label' =&gt; $option_none, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              if ( $saved_term == $option_none_value ) {&nbsp;</div></li><li><div>                  $args['checked'] = 'checked';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $options .= $this-&gt;list_input( $args, $i );&nbsp;</div></li><li><div>              $i++;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $terms as $term ) {&nbsp;</div></li><li><div>              $args = array(&nbsp;</div></li><li><div>                  'value' =&gt; $term-&gt;slug, &nbsp;</div></li><li><div>                  'label' =&gt; $term-&gt;name, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $saved_term == $term-&gt;slug ) {&nbsp;</div></li><li><div>                  $args['checked'] = 'checked';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $options .= $this-&gt;list_input( $args, $i );&nbsp;</div></li><li><div>              $i++;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $this-&gt;radio( array( 'options' =&gt; $options ), 'taxonomy_radio' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function taxonomy_radio_inline() {&nbsp;</div></li><li><div>      return $this-&gt;taxonomy_radio();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function taxonomy_multicheck() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $names = $this-&gt;get_object_terms();&nbsp;</div></li><li><div>      $saved_terms = is_wp_error( $names ) || empty( $names )&nbsp;</div></li><li><div>          ? $this-&gt;field-&gt;args( 'default' )&nbsp;</div></li><li><div>          : wp_list_pluck( $names, 'slug' );&nbsp;</div></li><li><div>      $terms = get_terms( $this-&gt;field-&gt;args( 'taxonomy' ), 'hide_empty=0' );&nbsp;</div></li><li><div>      $name = $this-&gt;_name() . '[]';&nbsp;</div></li><li><div>      $options = ''; $i = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! $terms ) {&nbsp;</div></li><li><div>          $options .= sprintf( '&lt;li&gt;&lt;label&gt;%s&lt;/label&gt;&lt;/li&gt;', esc_html( $this-&gt;_text( 'no_terms_text', __( 'No terms', 'cmb2' ) ) ) );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $terms as $term ) {&nbsp;</div></li><li><div>              $args = array(&nbsp;</div></li><li><div>                  'value' =&gt; $term-&gt;slug, &nbsp;</div></li><li><div>                  'label' =&gt; $term-&gt;name, &nbsp;</div></li><li><div>                  'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                  'name' =&gt; $name, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( is_array( $saved_terms ) && in_array( $term-&gt;slug, $saved_terms ) ) {&nbsp;</div></li><li><div>                  $args['checked'] = 'checked';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $options .= $this-&gt;list_input( $args, $i );&nbsp;</div></li><li><div>              $i++;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $classes = false === $this-&gt;field-&gt;args( 'select_all_button' )&nbsp;</div></li><li><div>          ? 'cmb2-checkbox-list no-select-all cmb2-list'&nbsp;</div></li><li><div>          : 'cmb2-checkbox-list cmb2-list';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $this-&gt;radio( array( 'class' =&gt; $classes, 'options' =&gt; $options ), 'taxonomy_multicheck' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function taxonomy_multicheck_inline() {&nbsp;</div></li><li><div>      return $this-&gt;taxonomy_multicheck();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function oembed() {&nbsp;</div></li><li><div>      $meta_value = trim( $this-&gt;field-&gt;escaped_value() );&nbsp;</div></li><li><div>      $oembed = ! empty( $meta_value )&nbsp;</div></li><li><div>          ? cmb2_get_oembed( array(&nbsp;</div></li><li><div>              'url' =&gt; $this-&gt;field-&gt;escaped_value(), &nbsp;</div></li><li><div>              'object_id' =&gt; $this-&gt;field-&gt;object_id, &nbsp;</div></li><li><div>              'object_type' =&gt; $this-&gt;field-&gt;object_type, &nbsp;</div></li><li><div>              'oembed_args' =&gt; array( 'width' =&gt; '640' ), &nbsp;</div></li><li><div>              'field_id' =&gt; $this-&gt;_id(), &nbsp;</div></li><li><div> ) )&nbsp;</div></li><li><div>          : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $this-&gt;input( array(&nbsp;</div></li><li><div>          'class' =&gt; 'cmb2-oembed regular-text', &nbsp;</div></li><li><div>          'data-objectid' =&gt; $this-&gt;field-&gt;object_id, &nbsp;</div></li><li><div>          'data-objecttype' =&gt; $this-&gt;field-&gt;object_type, &nbsp;</div></li><li><div> ) ), &nbsp;</div></li><li><div>      '&lt;p class=&quot;cmb-spinner spinner&quot; style=&quot;display:none;&quot;&gt;&lt;/p&gt;', &nbsp;</div></li><li><div>      '&lt;div id=&quot;', $this-&gt;_id( '-status' ), '&quot; class=&quot;cmb2-media-status ui-helper-clearfix embed_wrap&quot;&gt;', $oembed, '&lt;/div&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function file_list() {&nbsp;</div></li><li><div>      $meta_value = $this-&gt;field-&gt;escaped_value();&nbsp;</div></li><li><div>      $name = $this-&gt;_name();&nbsp;</div></li><li><div>      $img_size = $this-&gt;field-&gt;args( 'preview_size' );&nbsp;</div></li><li><div>      $query_args = $this-&gt;field-&gt;args( 'query_args' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $this-&gt;input( array(&nbsp;</div></li><li><div>          'type' =&gt; 'hidden', &nbsp;</div></li><li><div>          'class' =&gt; 'cmb2-upload-file cmb2-upload-list', &nbsp;</div></li><li><div>          'size' =&gt; 45, 'desc' =&gt; '', 'value' =&gt; '', &nbsp;</div></li><li><div>          'data-previewsize' =&gt; is_array( $img_size ) ? sprintf( '[%s]', implode( ', ', $img_size ) ) : 50, &nbsp;</div></li><li><div>          'data-queryargs' =&gt; ! empty( $query_args ) ? json_encode( $query_args ) : '', &nbsp;</div></li><li><div> ) ), &nbsp;</div></li><li><div>      $this-&gt;input( array(&nbsp;</div></li><li><div>          'type' =&gt; 'button', &nbsp;</div></li><li><div>          'class' =&gt; 'cmb2-upload-button button cmb2-upload-list', &nbsp;</div></li><li><div>          'value' =&gt; esc_html( $this-&gt;_text( 'add_upload_files_text', __( 'Add or Upload Files', 'cmb2' ) ) ), &nbsp;</div></li><li><div>          'name' =&gt; '', 'id' =&gt; '', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo '&lt;ul id=&quot;', $this-&gt;_id( '-status' ), '&quot; class=&quot;cmb2-media-status cmb-attach-list&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $meta_value && is_array( $meta_value ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $meta_value as $id =&gt; $fullurl ) {&nbsp;</div></li><li><div>              $id_input = $this-&gt;input( array(&nbsp;</div></li><li><div>                  'type' =&gt; 'hidden', &nbsp;</div></li><li><div>                  'value' =&gt; $fullurl, &nbsp;</div></li><li><div>                  'name' =&gt; $name . '[' . $id . ']', &nbsp;</div></li><li><div>                  'id' =&gt; 'filelist-' . $id, &nbsp;</div></li><li><div>                  'data-id' =&gt; $id, &nbsp;</div></li><li><div>                  'desc' =&gt; '', &nbsp;</div></li><li><div>                  'class' =&gt; false, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $this-&gt;is_valid_img_ext( $fullurl ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;img_status_output( array(&nbsp;</div></li><li><div>                      'image' =&gt; wp_get_attachment_image( $id, $img_size ), &nbsp;</div></li><li><div>                      'tag' =&gt; 'li', &nbsp;</div></li><li><div>                      'id_input' =&gt; $id_input, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;file_status_output( array(&nbsp;</div></li><li><div>                      'value' =&gt; $fullurl, &nbsp;</div></li><li><div>                      'tag' =&gt; 'li', &nbsp;</div></li><li><div>                      'id_input' =&gt; $id_input, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo '&lt;/ul&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      CMB2_JS::add_dependencies( 'media-editor' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  public function file() {&nbsp;</div></li><li><div>      $meta_value = $this-&gt;field-&gt;escaped_value();&nbsp;</div></li><li><div>      $options = (array) $this-&gt;field-&gt;options();&nbsp;</div></li><li><div>      $img_size = $this-&gt;field-&gt;args( 'preview_size' );&nbsp;</div></li><li><div>      $query_args = $this-&gt;field-&gt;args( 'query_args' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// if options array and 'url' =&gt; false, then hide the url field</span>&nbsp;</div></li><li><div>      $input_type = array_key_exists( 'url', $options ) && false === $options['url'] ? 'hidden' : 'text';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $this-&gt;input( array(&nbsp;</div></li><li><div>          'type' =&gt; $input_type, &nbsp;</div></li><li><div>          'class' =&gt; 'cmb2-upload-file regular-text', &nbsp;</div></li><li><div>          'size' =&gt; 45, &nbsp;</div></li><li><div>          'desc' =&gt; '', &nbsp;</div></li><li><div>          'data-previewsize' =&gt; is_array( $img_size ) ? '[' . implode( ', ', $img_size ) . ']' : 350, &nbsp;</div></li><li><div>          'data-queryargs' =&gt; ! empty( $query_args ) ? json_encode( $query_args ) : '', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      printf( '&lt;input class=&quot;cmb2-upload-button button&quot; type=&quot;button&quot; value=&quot;%s&quot; /&gt;', esc_attr( $this-&gt;_text( 'add_upload_file_text', __( 'Add or Upload File', 'cmb2' ) ) ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;_desc( true, true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $cached_id = $this-&gt;_id();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Reset field args for attachment ID</span>&nbsp;</div></li><li><div>      $args = $this-&gt;field-&gt;args();&nbsp;</div></li><li><div>      <span class="comment">// If we're looking at a file in a group, we need to get the non-prefixed id</span>&nbsp;</div></li><li><div>      $args['id'] = ( $this-&gt;field-&gt;group ? $this-&gt;field-&gt;args( '_id' ) : $cached_id ) . '_id';&nbsp;</div></li><li><div>      unset( $args['_id'], $args['_name'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// And get new field object</span>&nbsp;</div></li><li><div>      $this-&gt;field = new CMB2_Field( array(&nbsp;</div></li><li><div>          'field_args' =&gt; $args, &nbsp;</div></li><li><div>          'group_field' =&gt; $this-&gt;field-&gt;group, &nbsp;</div></li><li><div>          'object_type' =&gt; $this-&gt;field-&gt;object_type, &nbsp;</div></li><li><div>          'object_id' =&gt; $this-&gt;field-&gt;object_id, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get ID value</span>&nbsp;</div></li><li><div>      $_id_value = $this-&gt;field-&gt;escaped_value( 'absint' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If there is no ID saved yet, try to get it from the url</span>&nbsp;</div></li><li><div>      if ( $meta_value && ! $_id_value ) {&nbsp;</div></li><li><div>          $_id_value = cmb2_utils()-&gt;image_id_from_url( esc_url_raw( $meta_value ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $this-&gt;input( array(&nbsp;</div></li><li><div>          'type' =&gt; 'hidden', &nbsp;</div></li><li><div>          'class' =&gt; 'cmb2-upload-file-id', &nbsp;</div></li><li><div>          'value' =&gt; $_id_value, &nbsp;</div></li><li><div>          'desc' =&gt; '', &nbsp;</div></li><li><div> ) ), &nbsp;</div></li><li><div>      '&lt;div id=&quot;', $this-&gt;_id( '-status' ), '&quot; class=&quot;cmb2-media-status&quot;&gt;';&nbsp;</div></li><li><div>          if ( ! empty( $meta_value ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $this-&gt;is_valid_img_ext( $meta_value ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $_id_value ) {&nbsp;</div></li><li><div>                      $image = wp_get_attachment_image( $_id_value, $img_size, null, array( 'class' =&gt; 'cmb-file-field-image' ) );&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $size = is_array( $img_size ) ? $img_size[0] : 350;&nbsp;</div></li><li><div>                      $image = '&lt;img style=&quot;max-width: ' . absint( $size ) . 'px; width: 100%; height: auto;&quot; src=&quot;' . $meta_value . '&quot; alt=&quot;&quot; /&gt;';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;img_status_output( array(&nbsp;</div></li><li><div>                      'image' =&gt; $image, &nbsp;</div></li><li><div>                      'tag' =&gt; 'div', &nbsp;</div></li><li><div>                      'cached_id' =&gt; $cached_id, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;file_status_output( array(&nbsp;</div></li><li><div>                      'value' =&gt; $meta_value, &nbsp;</div></li><li><div>                      'tag' =&gt; 'div', &nbsp;</div></li><li><div>                      'cached_id' =&gt; $cached_id, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      echo '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      CMB2_JS::add_dependencies( 'media-editor' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * file/file_list image wrap</span>&nbsp;</div></li><li><div><span class="comment">   * @since  2.0.2</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $args Array of arguments for output</span>&nbsp;</div></li><li><div><span class="comment">   * @return string       Image wrap output</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function img_status_output( $args ) {&nbsp;</div></li><li><div>      printf( '&lt;%1$s class=&quot;img-status&quot;&gt;%2$s&lt;p class=&quot;cmb2-remove-wrapper&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;cmb2-remove-file-button&quot;%3$s&gt;%4$s&lt;/a&gt;&lt;/p&gt;%5$s&lt;/%1$s&gt;', &nbsp;</div></li><li><div>          $args['tag'], &nbsp;</div></li><li><div>          $args['image'], &nbsp;</div></li><li><div>          isset( $args['cached_id'] ) ? ' rel=&quot;' . $args['cached_id'] . '&quot;' : '', &nbsp;</div></li><li><div>          esc_html( $this-&gt;_text( 'remove_image_text', __( 'Remove Image', 'cmb2' ) ) ), &nbsp;</div></li><li><div>          isset( $args['id_input'] ) ? $args['id_input'] : ''&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * file/file_list file wrap</span>&nbsp;</div></li><li><div><span class="comment">   * @since  2.0.2</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $args Array of arguments for output</span>&nbsp;</div></li><li><div><span class="comment">   * @return string       File wrap output</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function file_status_output( $args ) {&nbsp;</div></li><li><div>      printf( '&lt;%1$s class=&quot;file-status&quot;&gt;&lt;span&gt;%2$s &lt;strong&gt;%3$s&lt;/strong&gt;&lt;/span&gt;&nbsp;&nbsp; (&lt;a href=&quot;%4$s&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;%5$s&lt;/a&gt; / &lt;a href=&quot;#&quot; class=&quot;cmb2-remove-file-button&quot;%6$s&gt;%7$s&lt;/a&gt;)%8$s&lt;/%1$s&gt;', &nbsp;</div></li><li><div>          $args['tag'], &nbsp;</div></li><li><div>          esc_html( $this-&gt;_text( 'file_text', __( 'File:', 'cmb2' ) ) ), &nbsp;</div></li><li><div>          $this-&gt;get_file_name_from_path( $args['value'] ), &nbsp;</div></li><li><div>          $args['value'], &nbsp;</div></li><li><div>          esc_html( $this-&gt;_text( 'file_download_text', __( 'Download', 'cmb2' ) ) ), &nbsp;</div></li><li><div>          isset( $args['cached_id'] ) ? ' rel=&quot;' . $args['cached_id'] . '&quot;' : '', &nbsp;</div></li><li><div>          esc_html( $this-&gt;_text( 'remove_text', __( 'Remove', 'cmb2' ) ) ), &nbsp;</div></li><li><div>          isset( $args['id_input'] ) ? $args['id_input'] : ''&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>CMB2</li><li><span></span>2.2.3.beta</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>