<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="2.3.9.1" data-slug="all-in-one-seo-pack" data-type="class" data-id="63481"><head xmlns="http://www.w3.org/1999/xhtml"><title> all_in_one_seo_pack | class | All In One Seo Pack | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="All_in_One_SEO_Pack, class, plugin, all-in-one-seo-pack, 2.3.9.1" /><meta name="description" content="Class All_in_One_SEO_Pack" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.25"}};!function(e,n,t){var a;function i(e){var t=n.createElement("canvas"),a=t.getContext&&t.getContext("2d"),i=String.fromCharCode;return!(!a||!a.fillText)&&(a.textBaseline="top",a.font="600 32px Arial","flag"===e?(a.fillText(i(55356,56806,55356,56826),0,0),3e3<t.toDataURL().length):"diversity"===e?(a.fillText(i(55356,57221),0,0),t=a.getImageData(16,16,1,1).data,a.fillText(i(55356,57221,55356,57343),0,0),(t=a.getImageData(16,16,1,1).data)[0],t[1],t[2],t[3],!0):("simple"===e?a.fillText(i(55357,56835),0,0):a.fillText(i(55356,57135),0,0),0!==a.getImageData(16,16,1,1).data[0]))}function o(e){var t=n.createElement("script");t.src=e,t.type="text/javascript",n.getElementsByTagName("head")[0].appendChild(t)}t.supports={simple:i("simple"),flag:i("flag"),unicode8:i("unicode8"),diversity:i("diversity")},t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.simple&&t.supports.flag&&t.supports.unicode8&&t.supports.diversity||(a=function(){t.readyCallback()},n.addEventListener?(n.addEventListener("DOMContentLoaded",a,!1),e.addEventListener("load",a,!1)):(e.attachEvent("onload",a),n.attachEvent("onreadystatechange",function(){"complete"===n.readyState&&t.readyCallback()})),(a=t.source||{}).concatemoji?o(a.concatemoji):a.wpemoji&&a.twemoji&&(o(a.twemoji),o(a.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=995d0b82c4fd99003aad2034bfbc2256' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.25' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/all_in_one_seo_pack/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fall_in_one_seo_pack%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fall_in_one_seo_pack%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-all-in-one-seo-pack-2.3.9.1-class-all_in_one_seo_pack","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="all_in_one_seo_pack" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to all-in-one-seo-pack." href="http://hookr.io/plugins/all-in-one-seo-pack/" class="plugin"><span property="name">all-in-one-seo-pack</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.3.9.1." href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.1/" class="H_VERSION"><span property="name">2.3.9.1</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.1/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">all_in_one_seo_pack</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="221"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.1/all/" title="All">All <span class="count badge">221</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.1/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="104"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.1/hooks/" title="Hooks">Hooks <span class="count badge">104</span></a></li><li class="" data-id="action" data-count="19"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.1/actions/" title="Actions">Actions <span class="count badge">19</span></a></li><li class="" data-id="filter" data-count="85"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.1/filters/" title="Filters">Filters <span class="count badge">85</span></a></li><li class="active" data-id="class" data-count="31"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.1/classes/" title="Classes">Classes <span class="count badge">31</span></a></li><li class="" data-id="constant" data-count="22"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.1/constants/" title="Constants">Constants <span class="count badge">22</span></a></li><li class="" data-id="function" data-count="64"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.1/functions/" title="Functions">Functions <span class="count badge">64</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.1/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>All_in_One_SEO_Pack</strong></h1><p>Class All_in_One_SEO_Pack.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.1/files/aioseop-class/" class="file">/aioseop_class.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="17" class="block" start="17"><li><div>class All_in_One_SEO_Pack extends All_in_One_SEO_Pack_Module {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // Current version of the plugin.&nbsp;</div></li><li><div>    var $version = AIOSEOP_VERSION;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // Max numbers of chars in auto-generated description.&nbsp;</div></li><li><div>    var $maximum_description_length = 160;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // Minimum number of chars an excerpt should be so that it can be used as description.&nbsp;</div></li><li><div>    var $minimum_description_length = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // Whether output buffering is already being used during forced title rewrites.&nbsp;</div></li><li><div>    var $ob_start_detected = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // The start of the title text in the head section for forced title rewrites.&nbsp;</div></li><li><div>    var $title_start = - 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // The end of the title text in the head section for forced title rewrites.&nbsp;</div></li><li><div>    var $title_end = - 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // The title before rewriting.&nbsp;</div></li><li><div>    var $orig_title = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // Filename of log file.&nbsp;</div></li><li><div>    var $log_file;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // Flag whether there should be logging.&nbsp;</div></li><li><div>    var $do_log;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    var $token;&nbsp;</div></li><li><div>    var $secret;&nbsp;</div></li><li><div>    var $access_token;&nbsp;</div></li><li><div>    var $ga_token;&nbsp;</div></li><li><div>    var $account_cache;&nbsp;</div></li><li><div>    var $profile_id;&nbsp;</div></li><li><div>    var $meta_opts = false;&nbsp;</div></li><li><div>    var $is_front_page = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * All_in_One_SEO_Pack constructor.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function __construct() {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        $this-&gt;log_file = dirname( __FILE__ ) . '/all-in-one-seo-pack.log'; // PHP &lt;5.3 compatibility, once we drop support we can use __DIR___.&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options ) && isset( $aioseop_options['aiosp_do_log'] ) && $aioseop_options['aiosp_do_log'] ) {&nbsp;</div></li><li><div>            $this-&gt;do_log = true;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $this-&gt;do_log = false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;name = sprintf( __( '%s Plugin Options', 'all-in-one-seo-pack' ), AIOSEOP_PLUGIN_NAME );&nbsp;</div></li><li><div>        $this-&gt;menu_name = __( 'General Settings', 'all-in-one-seo-pack' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;prefix = 'aiosp_';                        // Option prefix.&nbsp;</div></li><li><div>        $this-&gt;option_name = 'aioseop_options';&nbsp;</div></li><li><div>        $this-&gt;store_option = true;&nbsp;</div></li><li><div>        $this-&gt;file = __FILE__;                                // The current file.&nbsp;</div></li><li><div>        $blog_name = esc_attr( get_bloginfo( 'name' ) );&nbsp;</div></li><li><div>        parent::__construct();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;help_text = array(&nbsp;</div></li><li><div>            'donate' =&gt; __( 'All donations support continued development of this free software.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'license_key' =&gt; __( 'This will be the license key received when the product was purchased. This is used for automatic upgrades.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'can' =&gt; __( &quot;This option will automatically generate Canonical URLs for your entire WordPress installation.  This will help to prevent duplicate content penalties by &lt;a href=\'http://googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html\' target=\'_blank\'&gt;Google&lt;/a&gt;.&quot;, 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'no_paged_canonical_links' =&gt; __( 'Checking this option will set the Canonical URL for all paginated content to the first page.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'customize_canonical_links' =&gt; __( 'Checking this option will allow you to customize Canonical URLs for specific posts.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'can_set_protocol' =&gt; __( 'Set protocol for canonical URLs.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'use_original_title' =&gt; __( 'Use wp_title to get the title used by the theme; this is disabled by default. If you use this option, set your title formats appropriately, as your theme might try to do its own title SEO as well.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'do_log' =&gt; __( 'Check this and All in One SEO Pack will create a log of important events (all-in-one-seo-pack.log) in its plugin directory which might help debugging. Make sure this directory is writable.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'home_title' =&gt; __( 'As the name implies, this will be the Meta Title of your homepage. This is independent of any other option. If not set, the default Site Title (found in WordPress under Settings, General, Site Title) will be used.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'home_description' =&gt; __( 'This will be the Meta Description for your homepage. This is independent of any other option. The default is no Meta Description at all if this is not set.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'home_keywords' =&gt; __( 'Enter a comma separated list of your most important keywords for your site that will be written as Meta Keywords on your homepage. Do not stuff everything in here.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'use_static_home_info' =&gt; __( 'Checking this option uses the title, description, and keywords set on your static Front Page.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'togglekeywords' =&gt; __( 'This option allows you to toggle the use of Meta Keywords throughout the whole of the site.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'use_categories' =&gt; __( 'Check this if you want your categories for a given post used as the Meta Keywords for this post (in addition to any keywords you specify on the Edit Post screen).', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'use_tags_as_keywords' =&gt; __( 'Check this if you want your tags for a given post used as the Meta Keywords for this post (in addition to any keywords you specify on the Edit Post screen).', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'dynamic_postspage_keywords' =&gt; __( 'Check this if you want your keywords on your Posts page (set in WordPress under Settings, Reading, Front Page Displays) and your archive pages to be dynamically generated from the keywords of the posts showing on that page.  If unchecked, it will use the keywords set in the edit page screen for the posts page.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'rewrite_titles' =&gt; __( &quot;Note that this is all about the title tag. This is what you see in your browser's window title bar. This is NOT visible on a page, only in the title bar and in the source code. If enabled, all page, post, category, search and archive page titles get rewritten. You can specify the format for most of them. For example: Using the default post title format below, Rewrite Titles will write all post titles as 'Post Title | Blog Name'. If you have manually defined a title using All in One SEO Pack, this will become the title of your post in the format string.&quot;, 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'cap_titles' =&gt; __( 'Check this and Search Page Titles and Tag Page Titles will have the first letter of each word capitalized.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'cap_cats' =&gt; __( 'Check this and Category Titles will have the first letter of each word capitalized.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'home_page_title_format' =&gt;&nbsp;</div></li><li><div>                __( 'This controls the format of the title tag for your Home Page.&lt;br /&gt;The following macros are supported:', 'all-in-one-seo-pack' )&nbsp;</div></li><li><div>                . '&lt;ul&gt;&lt;li&gt;' . __( '%blog_title% - Your blog title', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%blog_description% - Your blog description', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%page_title% - The original title of the page', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( &quot;%page_author_login% - This page's author' login&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( &quot;%page_author_nicename% - This page's author' nicename&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( &quot;%page_author_firstname% - This page's author' first name (capitalized)&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( &quot;%page_author_lastname% - This page's author' last name (capitalized)&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;/ul&gt;', &nbsp;</div></li><li><div>            'page_title_format' =&gt;&nbsp;</div></li><li><div>                __( 'This controls the format of the title tag for Pages.&lt;br /&gt;The following macros are supported:', 'all-in-one-seo-pack' )&nbsp;</div></li><li><div>                . '&lt;ul&gt;&lt;li&gt;' . __( '%blog_title% - Your blog title', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%blog_description% - Your blog description', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%page_title% - The original title of the page', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( &quot;%page_author_login% - This page's author' login&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( &quot;%page_author_nicename% - This page's author' nicename&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( &quot;%page_author_firstname% - This page's author' first name (capitalized)&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( &quot;%page_author_lastname% - This page's author' last name (capitalized)&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;/ul&gt;', &nbsp;</div></li><li><div>            'post_title_format' =&gt;&nbsp;</div></li><li><div>                __( 'This controls the format of the title tag for Posts.&lt;br /&gt;The following macros are supported:', 'all-in-one-seo-pack' )&nbsp;</div></li><li><div>                . '&lt;ul&gt;&lt;li&gt;' . __( '%blog_title% - Your blog title', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%blog_description% - Your blog description', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%post_title% - The original title of the post', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%category_title% - The (main) category of the post', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%category% - Alias for %category_title%', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( &quot;%post_author_login% - This post's author' login&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( &quot;%post_author_nicename% - This post's author' nicename&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( &quot;%post_author_firstname% - This post's author' first name (capitalized)&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( &quot;%post_author_lastname% - This post's author' last name (capitalized)&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;/ul&gt;', &nbsp;</div></li><li><div>            'category_title_format' =&gt;&nbsp;</div></li><li><div>                __( 'This controls the format of the title tag for Category Archives.&lt;br /&gt;The following macros are supported:', 'all-in-one-seo-pack' ) .&nbsp;</div></li><li><div>                '&lt;ul&gt;&lt;li&gt;' . __( '%blog_title% - Your blog title', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%blog_description% - Your blog description', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%category_title% - The original title of the category', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%category_description% - The description of the category', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;/ul&gt;', &nbsp;</div></li><li><div>            'archive_title_format' =&gt;&nbsp;</div></li><li><div>                __( 'This controls the format of the title tag for Custom Post Archives.&lt;br /&gt;The following macros are supported:', 'all-in-one-seo-pack' ) .&nbsp;</div></li><li><div>                '&lt;ul&gt;&lt;li&gt;' . __( '%blog_title% - Your blog title', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%blog_description% - Your blog description', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%archive_title - The original archive title given by wordpress', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;/ul&gt;', &nbsp;</div></li><li><div>            'date_title_format' =&gt;&nbsp;</div></li><li><div>                __( 'This controls the format of the title tag for Date Archives.&lt;br /&gt;The following macros are supported:', 'all-in-one-seo-pack' ) .&nbsp;</div></li><li><div>                '&lt;ul&gt;&lt;li&gt;' . __( '%blog_title% - Your blog title', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%blog_description% - Your blog description', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%date% - The original archive title given by wordpress, e.g. &quot;2007&quot; or &quot;2007 August&quot;', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%day% - The original archive day given by wordpress, e.g. &quot;17&quot;', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%month% - The original archive month given by wordpress, e.g. &quot;August&quot;', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%year% - The original archive year given by wordpress, e.g. &quot;2007&quot;', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;/ul&gt;', &nbsp;</div></li><li><div>            'author_title_format' =&gt;&nbsp;</div></li><li><div>                __( 'This controls the format of the title tag for Author Archives.&lt;br /&gt;The following macros are supported:', 'all-in-one-seo-pack' ) .&nbsp;</div></li><li><div>                '&lt;ul&gt;&lt;li&gt;' . __( '%blog_title% - Your blog title', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%blog_description% - Your blog description', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%author% - The original archive title given by wordpress, e.g. &quot;Steve&quot; or &quot;John Smith&quot;', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;/ul&gt;', &nbsp;</div></li><li><div>            'tag_title_format' =&gt;&nbsp;</div></li><li><div>                __( 'This controls the format of the title tag for Tag Archives.&lt;br /&gt;The following macros are supported:', 'all-in-one-seo-pack' ) .&nbsp;</div></li><li><div>                '&lt;ul&gt;&lt;li&gt;' . __( '%blog_title% - Your blog title', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%blog_description% - Your blog description', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%tag% - The name of the tag', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;/ul&gt;', &nbsp;</div></li><li><div>            'search_title_format' =&gt;&nbsp;</div></li><li><div>                __( 'This controls the format of the title tag for the Search page.&lt;br /&gt;The following macros are supported:', 'all-in-one-seo-pack' ) .&nbsp;</div></li><li><div>                '&lt;ul&gt;&lt;li&gt;' . __( '%blog_title% - Your blog title', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%blog_description% - Your blog description', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                __( '%search% - What was searched for', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;/ul&gt;', &nbsp;</div></li><li><div>            'description_format' =&gt; __( 'This controls the format of Meta Descriptions.The following macros are supported:', 'all-in-one-seo-pack' ) .&nbsp;</div></li><li><div>                                             '&lt;ul&gt;&lt;li&gt;' . __( '%blog_title% - Your blog title', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                                             __( '%blog_description% - Your blog description', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                                             __( '%description% - The original description as determined by the plugin, e.g. the excerpt if one is set or an auto-generated one if that option is set', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                                             __( '%post_title% - The original title of the post', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                                             __( '%wp_title% - The original wordpress title, e.g. post_title for posts', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;/ul&gt;', &nbsp;</div></li><li><div>            '404_title_format' =&gt; __( 'This controls the format of the title tag for the 404 page.&lt;br /&gt;The following macros are supported:', 'all-in-one-seo-pack' ) .&nbsp;</div></li><li><div>                                             '&lt;ul&gt;&lt;li&gt;' . __( '%blog_title% - Your blog title', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                                             __( '%blog_description% - Your blog description', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                                             __( '%request_url% - The original URL path, like &quot;/url-that-does-not-exist/&quot;', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                                             __( '%request_words% - The URL path in human readable form, like &quot;Url That Does Not Exist&quot;', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                                             __( '%404_title% - Additional 404 title input&quot;', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;/ul&gt;', &nbsp;</div></li><li><div>            'paged_format' =&gt; __( 'This string gets appended/prepended to titles of paged index pages (like home or archive pages).', 'all-in-one-seo-pack' )&nbsp;</div></li><li><div>                                             . __( 'The following macros are supported:', 'all-in-one-seo-pack' )&nbsp;</div></li><li><div>                                             . '&lt;ul&gt;&lt;li&gt;' . __( '%page% - The page number', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;/ul&gt;', &nbsp;</div></li><li><div>            'enablecpost' =&gt; __( 'Check this if you want to use All in One SEO Pack with any Custom Post Types on this site.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'cpostadvanced' =&gt; __( 'This will show or hide the advanced options for SEO for Custom Post Types.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'cpostactive' =&gt; __( 'Use these checkboxes to select which Post Types you want to use All in One SEO Pack with.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'taxactive' =&gt; __( 'Use these checkboxes to select which Taxonomies you want to use All in One SEO Pack with.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'cposttitles' =&gt; __( 'This allows you to set the title tags for each Custom Post Type.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'posttypecolumns' =&gt; __( 'This lets you select which screens display the SEO Title, SEO Keywords and SEO Description columns.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'admin_bar' =&gt; __( 'Check this to add All in One SEO Pack to the Admin Bar for easy access to your SEO settings.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'custom_menu_order' =&gt; __( 'Check this to move the All in One SEO Pack menu item to the top of your WordPress Dashboard menu.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'google_verify' =&gt; __( &quot;Enter your verification code here to verify your site with Google Webmaster Tools.&lt;br /&gt;&lt;a href='http://semperplugins.com/documentation/google-webmaster-tools-verification/' target='_blank'&gt;Click here for documentation on this setting&lt;/a&gt;&quot;, 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'bing_verify' =&gt; __( &quot;Enter your verification code here to verify your site with Bing Webmaster Tools.&lt;br /&gt;&lt;a href='http://semperplugins.com/documentation/bing-webmaster-verification/' target='_blank'&gt;Click here for documentation on this setting&lt;/a&gt;&quot;, 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'pinterest_verify' =&gt; __( &quot;Enter your verification code here to verify your site with Pinterest.&lt;br /&gt;&lt;a href='http://semperplugins.com/documentation/pinterest-site-verification/' target='_blank'&gt;Click here for documentation on this setting&lt;/a&gt;&quot;, 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'google_publisher' =&gt; __( 'Enter your Google+ Profile URL here to add the rel=*author* tag to your site for Google authorship. It is recommended that the URL you enter here should be your personal Google+ profile.  Use the Advanced Authorship Options below if you want greater control over the use of authorship.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'google_disable_profile' =&gt; __( 'Check this to remove the Google Plus field from the user profile screen.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'google_author_advanced' =&gt; __( 'Enable this to display advanced options for controlling Google Plus authorship information on your website.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'google_author_location' =&gt; __( 'This option allows you to control which types of pages you want to display rel=\&quot;author\&quot; on for Google authorship. The options include the Front Page (the homepage of your site), Posts, Pages, and any Custom Post Types. The Everywhere Else option includes 404, search, categories, tags, custom taxonomies, date archives, author archives and any other page template.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'google_enable_publisher' =&gt; __( 'This option allows you to control whether rel=\&quot;publisher\&quot; is displayed on the homepage of your site. Google recommends using this if the site is a business website.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'google_specify_publisher' =&gt; __( 'The Google+ profile you enter here will appear on your homepage only as the rel=\&quot;publisher\&quot; tag. It is recommended that the URL you enter here should be the Google+ profile for your business.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'google_sitelinks_search' =&gt; __( 'Add markup to display the Google Sitelinks Search Box next to your search results in Google.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'google_set_site_name' =&gt; __( 'Add markup to tell Google the preferred name for your website.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'google_connect' =&gt; __( 'Press the connect button to connect with Google Analytics; or if already connected, press the disconnect button to disable and remove any stored analytics credentials.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'google_analytics_id' =&gt; __( 'Enter your Google Analytics ID here to track visitor behavior on your site using Google Analytics.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'ga_use_universal_analytics' =&gt; __( 'Use the new Universal Analytics tracking code for Google Analytics.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'ga_advanced_options' =&gt; __( 'Check to use advanced Google Analytics options.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'ga_domain' =&gt; __( 'Enter your domain name without the http:// to set your cookie domain.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'ga_multi_domain' =&gt; __( 'Use this option to enable tracking of multiple or additional domains.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'ga_addl_domains' =&gt; __( 'Add a list of additional domains to track here.  Enter one domain name per line without the http://.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'ga_anonymize_ip' =&gt; __( 'This enables support for IP Anonymization in Google Analytics.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'ga_display_advertising' =&gt; __( 'This enables support for the Display Advertiser Features in Google Analytics.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'ga_exclude_users' =&gt; __( 'Exclude logged-in users from Google Analytics tracking by role.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'ga_track_outbound_links' =&gt; __( 'Check this if you want to track outbound links with Google Analytics.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'ga_link_attribution' =&gt; __( 'This enables support for the Enhanced Link Attribution in Google Analytics.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'ga_enhanced_ecommerce' =&gt; __( 'This enables support for the Enhanced Ecommerce in Google Analytics.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'cpostnoindex' =&gt; __( 'Set the default NOINDEX setting for each Post Type.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'cpostnofollow' =&gt; __( 'Set the default NOFOLLOW setting for each Post Type.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            'category_noindex' =&gt; __( 'Check this to ask search engines not to index Category Archives. Useful for avoiding duplicate content.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'archive_date_noindex' =&gt; __( 'Check this to ask search engines not to index Date Archives. Useful for avoiding duplicate content.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'archive_author_noindex' =&gt; __( 'Check this to ask search engines not to index Author Archives. Useful for avoiding duplicate content.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'tags_noindex' =&gt; __( 'Check this to ask search engines not to index Tag Archives. Useful for avoiding duplicate content.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'search_noindex' =&gt; __( 'Check this to ask search engines not to index the Search page. Useful for avoiding duplicate content.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            '404_noindex' =&gt; __( 'Check this to ask search engines not to index the 404 page.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'tax_noindex' =&gt; __( 'Check this to ask search engines not to index custom Taxonomy archive pages. Useful for avoiding duplicate content.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'paginated_noindex' =&gt; __( 'Check this to ask search engines not to index paginated pages/posts. Useful for avoiding duplicate content.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'paginated_nofollow' =&gt; __( 'Check this to ask search engines not to follow links from paginated pages/posts. Useful for avoiding duplicate content.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'noodp' =&gt; __( 'Check this box to ask search engines not to use descriptions from the Open Directory Project for your entire site.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'cpostnoodp' =&gt; __( 'Set the default noodp setting for each Post Type.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'noydir' =&gt; __( 'Check this box to ask Yahoo! not to use descriptions from the Yahoo! directory for your entire site.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'cpostnoydir' =&gt; __( 'Set the default noydir setting for each Post Type.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'skip_excerpt' =&gt; __( &quot;Check this and your Meta Descriptions won't be generated from the excerpt.&quot;, 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'generate_descriptions' =&gt; __( 'Check this and your Meta Descriptions will be auto-generated from your excerpt or content.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'run_shortcodes' =&gt; __( 'Check this and shortcodes will get executed for descriptions auto-generated from content.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'hide_paginated_descriptions' =&gt; __( 'Check this and your Meta Descriptions will be removed from page 2 or later of paginated content.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'dont_truncate_descriptions' =&gt; __( 'Check this to prevent your Description from being truncated regardless of its length.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'schema_markup' =&gt; __( 'Check this to support Schema.org markup, i.e., itemprop on supported metadata.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'unprotect_meta' =&gt; __( &quot;Check this to unprotect internal postmeta fields for use with XMLRPC. If you don't know what that is, leave it unchecked.&quot;, 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'redirect_attachement_parent' =&gt; __( 'Redirect attachment pages to post parent.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'ex_pages' =&gt; __( 'Enter a comma separated list of pages here to be excluded by All in One SEO Pack.  This is helpful when using plugins which generate their own non-WordPress dynamic pages.  Ex: &lt;em&gt;/forum/, /contact/&lt;/em&gt;  For instance, if you want to exclude the virtual pages generated by a forum plugin, all you have to do is add forum or /forum or /forum/ or and any URL with the word \&quot;forum\&quot; in it, such as http://mysite.com/forum or http://mysite.com/forum/someforumpage here and it will be excluded from All in One SEO Pack.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'post_meta_tags' =&gt; __( 'What you enter here will be copied verbatim to the header of all Posts. You can enter whatever additional headers you want here, even references to stylesheets.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'page_meta_tags' =&gt; __( 'What you enter here will be copied verbatim to the header of all Pages. You can enter whatever additional headers you want here, even references to stylesheets.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'front_meta_tags' =&gt; __( 'What you enter here will be copied verbatim to the header of the front page if you have set a static page in Settings, Reading, Front Page Displays. You can enter whatever additional headers you want here, even references to stylesheets. This will fall back to using Additional Page Headers if you have them set and nothing is entered here.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'home_meta_tags' =&gt; __( 'What you enter here will be copied verbatim to the header of the home page if you have Front page displays your latest posts selected in Settings, Reading. It will also be copied verbatim to the header on the Posts page if you have one set in Settings, Reading. You can enter whatever additional headers you want here, even references to stylesheets.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;help_anchors = array(&nbsp;</div></li><li><div>            'license_key' =&gt; '#license-key', &nbsp;</div></li><li><div>            'can' =&gt; '#canonical-urls', &nbsp;</div></li><li><div>            'no_paged_canonical_links' =&gt; '#no-pagination-for-canonical-urls', &nbsp;</div></li><li><div>            'customize_canonical_links' =&gt; '#enable-custom-canonical-urls', &nbsp;</div></li><li><div>            'can_set_protocol' =&gt; '#set-protocol-for-canonical-urls', &nbsp;</div></li><li><div>            'use_original_title' =&gt; '#use-original-title', &nbsp;</div></li><li><div>            'schema_markup' =&gt; '#use-schema-markup', &nbsp;</div></li><li><div>            'do_log' =&gt; '#log-important-events', &nbsp;</div></li><li><div>            'home_title' =&gt; '#home-title', &nbsp;</div></li><li><div>            'home_description' =&gt; '#home-description', &nbsp;</div></li><li><div>            'home_keywords' =&gt; '#home-keywords', &nbsp;</div></li><li><div>            'use_static_home_info' =&gt; '#use-static-front-page-instead', &nbsp;</div></li><li><div>            'togglekeywords' =&gt; '#use-keywords', &nbsp;</div></li><li><div>            'use_categories' =&gt; '#use-categories-for-meta-keywords', &nbsp;</div></li><li><div>            'use_tags_as_keywords' =&gt; '#use-tags-for-meta-keywords', &nbsp;</div></li><li><div>            'dynamic_postspage_keywords' =&gt; '#dynamically-generate-keywords-for-posts-page', &nbsp;</div></li><li><div>            'rewrite_titles' =&gt; '#rewrite-titles', &nbsp;</div></li><li><div>            'cap_titles' =&gt; '#capitalize-titles', &nbsp;</div></li><li><div>            'cap_cats' =&gt; '#capitalize-titles', &nbsp;</div></li><li><div>            'home_page_title_format' =&gt; '#title-format-fields', &nbsp;</div></li><li><div>            'page_title_format' =&gt; '#title-format-fields', &nbsp;</div></li><li><div>            'post_title_format' =&gt; '#title-format-fields', &nbsp;</div></li><li><div>            'category_title_format' =&gt; '#title-format-fields', &nbsp;</div></li><li><div>            'archive_title_format' =&gt; '#title-format-fields', &nbsp;</div></li><li><div>            'date_title_format' =&gt; '#title-format-fields', &nbsp;</div></li><li><div>            'author_title_format' =&gt; '#title-format-fields', &nbsp;</div></li><li><div>            'tag_title_format' =&gt; '#title-format-fields', &nbsp;</div></li><li><div>            'search_title_format' =&gt; '#title-format-fields', &nbsp;</div></li><li><div>            'description_format' =&gt; '#title-format-fields', &nbsp;</div></li><li><div>            '404_title_format' =&gt; '#title-format-fields', &nbsp;</div></li><li><div>            'paged_format' =&gt; '#title-format-fields', &nbsp;</div></li><li><div>            'enablecpost' =&gt; '#seo-for-custom-post-types', &nbsp;</div></li><li><div>            'cpostadvanced' =&gt; '#enable-advanced-options', &nbsp;</div></li><li><div>            'cpostactive' =&gt; '#seo-on-only-these-post-types', &nbsp;</div></li><li><div>            'taxactive' =&gt; '#seo-on-only-these-taxonomies', &nbsp;</div></li><li><div>            'cposttitles' =&gt; '#custom-titles', &nbsp;</div></li><li><div>            'posttypecolumns' =&gt; '#show-column-labels-for-custom-post-types', &nbsp;</div></li><li><div>            'admin_bar' =&gt; '#display-menu-in-admin-bar', &nbsp;</div></li><li><div>            'custom_menu_order' =&gt; '#display-menu-at-the-top', &nbsp;</div></li><li><div>            'google_verify' =&gt; '', &nbsp;</div></li><li><div>            'bing_verify' =&gt; '', &nbsp;</div></li><li><div>            'pinterest_verify' =&gt; '', &nbsp;</div></li><li><div>            'google_publisher' =&gt; '#google-plus-default-profile', &nbsp;</div></li><li><div>            'google_disable_profile' =&gt; '#disable-google-plus-profile', &nbsp;</div></li><li><div>            'google_sitelinks_search' =&gt; '#display-sitelinks-search-box', &nbsp;</div></li><li><div>            'google_set_site_name' =&gt; '#set-preferred-site-name', &nbsp;</div></li><li><div>            'google_author_advanced' =&gt; '#advanced-authorship-options', &nbsp;</div></li><li><div>            'google_author_location' =&gt; '#display-google-authorship', &nbsp;</div></li><li><div>            'google_enable_publisher' =&gt; '#display-publisher-meta-on-front-page', &nbsp;</div></li><li><div>            'google_specify_publisher' =&gt; '#specify-publisher-url', &nbsp;</div></li><li><div>            'google_analytics_id' =&gt; 'http://semperplugins.com/documentation/setting-up-google-analytics/', &nbsp;</div></li><li><div>            'ga_use_universal_analytics' =&gt; '#use-universal-analytics', &nbsp;</div></li><li><div>            'ga_domain' =&gt; '#tracking-domain', &nbsp;</div></li><li><div>            'ga_multi_domain' =&gt; '#track-multiple-domains-additional-domains', &nbsp;</div></li><li><div>            'ga_addl_domains' =&gt; '#track-multiple-domains-additional-domains', &nbsp;</div></li><li><div>            'ga_anonymize_ip' =&gt; '#anonymize-ip-addresses', &nbsp;</div></li><li><div>            'ga_display_advertising' =&gt; '#display-advertiser-tracking', &nbsp;</div></li><li><div>            'ga_exclude_users' =&gt; '#exclude-users-from-tracking', &nbsp;</div></li><li><div>            'ga_track_outbound_links' =&gt; '#track-outbound-links', &nbsp;</div></li><li><div>            'ga_link_attribution' =&gt; '#enhanced-link-attribution', &nbsp;</div></li><li><div>            'ga_enhanced_ecommerce' =&gt; '#enhanced-ecommerce', &nbsp;</div></li><li><div>            'cpostnoindex' =&gt; '#noindex', &nbsp;</div></li><li><div>            'cpostnofollow' =&gt; '#nofollow', &nbsp;</div></li><li><div>            'cpostnoodp' =&gt; '#noodp', &nbsp;</div></li><li><div>            'cpostnoydir' =&gt; '#noydir', &nbsp;</div></li><li><div>            'category_noindex' =&gt; '#noindex-settings', &nbsp;</div></li><li><div>            'archive_date_noindex' =&gt; '#noindex-settings', &nbsp;</div></li><li><div>            'archive_author_noindex' =&gt; '#noindex-settings', &nbsp;</div></li><li><div>            'tags_noindex' =&gt; '#noindex-settings', &nbsp;</div></li><li><div>            'search_noindex' =&gt; '#use-noindex-for-the-search-page', &nbsp;</div></li><li><div>            '404_noindex' =&gt; '#use-noindex-for-the-404-page', &nbsp;</div></li><li><div>            'tax_noindex' =&gt; '#use-noindex-for-the-taxonomy-archives', &nbsp;</div></li><li><div>            'paginated_noindex' =&gt; '#use-noindex-for-paginated-pages-posts', &nbsp;</div></li><li><div>            'paginated_nofollow' =&gt; '#use-nofollow-for-paginated-pages-posts', &nbsp;</div></li><li><div>            'noodp' =&gt; '#exclude-site-from-the-open-directory-project', &nbsp;</div></li><li><div>            'noydir' =&gt; '#exclude-site-from-yahoo-directory', &nbsp;</div></li><li><div>            'skip_excerpt' =&gt; '#avoid-using-the-excerpt-in-descriptions', &nbsp;</div></li><li><div>            'generate_descriptions' =&gt; '#autogenerate-descriptions', &nbsp;</div></li><li><div>            'run_shortcodes' =&gt; '#run-shortcodes-in-autogenerated-descriptions', &nbsp;</div></li><li><div>            'hide_paginated_descriptions' =&gt; '#remove-descriptions-for-paginated-pages', &nbsp;</div></li><li><div>            'dont_truncate_descriptions' =&gt; '#never-shorten-long-descriptions', &nbsp;</div></li><li><div>            'unprotect_meta' =&gt; '#unprotect-post-meta-fields', &nbsp;</div></li><li><div>            'redirect_attachement_parent' =&gt; '#redirect-attachments-to-post-parent', &nbsp;</div></li><li><div>            'ex_pages' =&gt; '#exclude-pages', &nbsp;</div></li><li><div>            'post_meta_tags' =&gt; '#additional-post-headers', &nbsp;</div></li><li><div>            'page_meta_tags' =&gt; '#additional-page-headers', &nbsp;</div></li><li><div>            'front_meta_tags' =&gt; '#additional-front-page-headers', &nbsp;</div></li><li><div>            'home_meta_tags' =&gt; '#additional-blog-page-headers', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $meta_help_text = array(&nbsp;</div></li><li><div>            'snippet' =&gt; __( 'A preview of what this page might look like in search engine results.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'title' =&gt; __( 'A custom title that shows up in the title tag for this page.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'description' =&gt; __( 'The META description for this page. This will override any autogenerated descriptions.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'keywords' =&gt; __( 'A comma separated list of your most important keywords for this page that will be written as META keywords.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'custom_link' =&gt; __( 'Override the canonical URLs for this post.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'noindex' =&gt; __( 'Check this box to ask search engines not to index this page.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'nofollow' =&gt; __( 'Check this box to ask search engines not to follow links from this page.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'noodp' =&gt; __( 'Check this box to ask search engines not to use descriptions from the Open Directory Project for this page.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'noydir' =&gt; __( 'Check this box to ask Yahoo! not to use descriptions from the Yahoo! directory for this page.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'titleatr' =&gt; __( 'Set the title attribute for menu links.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'menulabel' =&gt; __( 'Set the label for this page menu item.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'sitemap_exclude' =&gt; __( &quot;Don't display this page in the sitemap.&quot;, 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'disable' =&gt; __( 'Disable SEO on this page.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>            'disable_analytics' =&gt; __( 'Disable Google Analytics on this page.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;default_options = array(&nbsp;</div></li><li><div>            'license_key' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'License Key:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'donate' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'I enjoy this plugin and have made a donation:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'home_title' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Home Title:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; null, &nbsp;</div></li><li><div>                'type' =&gt; 'textarea', &nbsp;</div></li><li><div>                'sanitize' =&gt; 'text', &nbsp;</div></li><li><div>                'count' =&gt; true, &nbsp;</div></li><li><div>                'rows' =&gt; 1, &nbsp;</div></li><li><div>                'cols' =&gt; 60, &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_use_static_home_info' =&gt; 0 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'home_description' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Home Description:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; '', &nbsp;</div></li><li><div>                'type' =&gt; 'textarea', &nbsp;</div></li><li><div>                'sanitize' =&gt; 'text', &nbsp;</div></li><li><div>                'count' =&gt; true, &nbsp;</div></li><li><div>                'cols' =&gt; 80, &nbsp;</div></li><li><div>                'rows' =&gt; 2, &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_use_static_home_info' =&gt; 0 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'togglekeywords' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use Keywords:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 1, &nbsp;</div></li><li><div>                'type' =&gt; 'radio', &nbsp;</div></li><li><div>                'initial_options' =&gt; array(&nbsp;</div></li><li><div>                    0 =&gt; __( 'Enabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                    1 =&gt; __( 'Disabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'home_keywords' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Home Keywords (comma separated):', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; null, &nbsp;</div></li><li><div>                'type' =&gt; 'textarea', &nbsp;</div></li><li><div>                'sanitize' =&gt; 'text', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_togglekeywords' =&gt; 0, 'aiosp_use_static_home_info' =&gt; 0 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'use_static_home_info' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use Static Front Page Instead', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'type' =&gt; 'radio', &nbsp;</div></li><li><div>                'initial_options' =&gt; array(&nbsp;</div></li><li><div>                    1 =&gt; __( 'Enabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                    0 =&gt; __( 'Disabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'can' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Canonical URLs:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 1, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'no_paged_canonical_links' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'No Pagination for Canonical URLs:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_can' =&gt; 'on' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'customize_canonical_links' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Enable Custom Canonical URLs:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_can' =&gt; 'on' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'can_set_protocol' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Set Protocol For Canonical URLs:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'radio', &nbsp;</div></li><li><div>                'default' =&gt; 'auto', &nbsp;</div></li><li><div>                'initial_options' =&gt; array(&nbsp;</div></li><li><div>                    'auto' =&gt; __( 'Auto', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                    'http' =&gt; __( 'HTTP', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                    'https' =&gt; __( 'HTTPS', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_can' =&gt; 'on' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'rewrite_titles' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Rewrite Titles:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 1, &nbsp;</div></li><li><div>                'type' =&gt; 'radio', &nbsp;</div></li><li><div>                'initial_options' =&gt; array(&nbsp;</div></li><li><div>                    1 =&gt; __( 'Enabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                    0 =&gt; __( 'Disabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'force_rewrites' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Force Rewrites:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 1, &nbsp;</div></li><li><div>                'type' =&gt; 'hidden', &nbsp;</div></li><li><div>                'prefix' =&gt; $this-&gt;prefix, &nbsp;</div></li><li><div>                'initial_options' =&gt; array(&nbsp;</div></li><li><div>                    1 =&gt; __( 'Enabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                    0 =&gt; __( 'Disabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'use_original_title' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use Original Title:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'radio', &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'initial_options' =&gt; array(&nbsp;</div></li><li><div>                    1 =&gt; __( 'Enabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                    0 =&gt; __( 'Disabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'cap_titles' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Capitalize Tag and Search Titles:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 1, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'cap_cats' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Capitalize Category Titles:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 1, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'home_page_title_format' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Home Page Title Format:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'default' =&gt; '%page_title%', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_rewrite_titles' =&gt; 1 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'page_title_format' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Page Title Format:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'default' =&gt; '%page_title% | %blog_title%', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_rewrite_titles' =&gt; 1 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'post_title_format' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Post Title Format:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'default' =&gt; '%post_title% | %blog_title%', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_rewrite_titles' =&gt; 1 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'category_title_format' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Category Title Format:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'default' =&gt; '%category_title% | %blog_title%', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_rewrite_titles' =&gt; 1 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'archive_title_format' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Archive Title Format:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'default' =&gt; '%archive_title% | %blog_title%', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_rewrite_titles' =&gt; 1 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'date_title_format' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Date Archive Title Format:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'default' =&gt; '%date% | %blog_title%', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_rewrite_titles' =&gt; 1 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'author_title_format' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Author Archive Title Format:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'default' =&gt; '%author% | %blog_title%', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_rewrite_titles' =&gt; 1 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'tag_title_format' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Tag Title Format:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'default' =&gt; '%tag% | %blog_title%', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_rewrite_titles' =&gt; 1 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'search_title_format' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Search Title Format:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'default' =&gt; '%search% | %blog_title%', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_rewrite_titles' =&gt; 1 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'description_format' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Description Format', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'default' =&gt; '%description%', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_rewrite_titles' =&gt; 1 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            '404_title_format' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( '404 Title Format:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'default' =&gt; 'Nothing found for %request_words%', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_rewrite_titles' =&gt; 1 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'paged_format' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Paged Format:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'default' =&gt; ' - Part %page%', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_rewrite_titles' =&gt; 1 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'enablecpost' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'SEO for Custom Post Types:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 'on', &nbsp;</div></li><li><div>                'type' =&gt; 'radio', &nbsp;</div></li><li><div>                'initial_options' =&gt; array(&nbsp;</div></li><li><div>                    'on' =&gt; __( 'Enabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                    0 =&gt; __( 'Disabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'cpostactive' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'SEO on only these post types:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'multicheckbox', &nbsp;</div></li><li><div>                'default' =&gt; array( 'post', 'page' ), &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_enablecpost' =&gt; 'on' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'taxactive' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'SEO on only these taxonomies:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'multicheckbox', &nbsp;</div></li><li><div>                'default' =&gt; array( 'category', 'post_tag' ), &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_enablecpost' =&gt; 'on' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'cpostadvanced' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Enable Advanced Options:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'type' =&gt; 'radio', &nbsp;</div></li><li><div>                'initial_options' =&gt; array(&nbsp;</div></li><li><div>                    'on' =&gt; __( 'Enabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                    0 =&gt; __( 'Disabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                'label' =&gt; null, &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_enablecpost' =&gt; 'on' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'cpostnoindex' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Default to NOINDEX:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'multicheckbox', &nbsp;</div></li><li><div>                'default' =&gt; array(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'cpostnofollow' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Default to NOFOLLOW:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'multicheckbox', &nbsp;</div></li><li><div>                'default' =&gt; array(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'cpostnoodp' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Default to NOODP:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'multicheckbox', &nbsp;</div></li><li><div>                'default' =&gt; array(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'cpostnoydir' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Default to NOYDIR:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'multicheckbox', &nbsp;</div></li><li><div>                'default' =&gt; array(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'cposttitles' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Custom titles:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'condshow' =&gt; array(&nbsp;</div></li><li><div>                    'aiosp_rewrite_titles' =&gt; 1, &nbsp;</div></li><li><div>                    'aiosp_enablecpost' =&gt; 'on', &nbsp;</div></li><li><div>                    'aiosp_cpostadvanced' =&gt; 'on', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'posttypecolumns' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Show Column Labels for Custom Post Types:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'multicheckbox', &nbsp;</div></li><li><div>                'default' =&gt; array( 'post', 'page' ), &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_enablecpost' =&gt; 'on' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'admin_bar' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Display Menu In Admin Bar:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 'on', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'custom_menu_order' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Display Menu At The Top:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 'on', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'google_verify' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Google Webmaster Tools:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; '', &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'bing_verify' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Bing Webmaster Center:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; '', &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'pinterest_verify' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Pinterest Site Verification:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; '', &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'google_publisher' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Google Plus Default Profile:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; '', &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'google_disable_profile' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Disable Google Plus Profile:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'google_sitelinks_search' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Display Sitelinks Search Box:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'google_set_site_name' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Set Preferred Site Name:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'google_specify_site_name' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Specify A Preferred Name:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'placeholder' =&gt; $blog_name, &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_google_set_site_name' =&gt; 'on' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'google_author_advanced' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Advanced Authorship Options:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'type' =&gt; 'radio', &nbsp;</div></li><li><div>                'initial_options' =&gt; array(&nbsp;</div></li><li><div>                    'on' =&gt; __( 'Enabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                    0 =&gt; __( 'Disabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                'label' =&gt; null, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'google_author_location' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Display Google Authorship:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; array( 'all' ), &nbsp;</div></li><li><div>                'type' =&gt; 'multicheckbox', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_google_author_advanced' =&gt; 'on' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'google_enable_publisher' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Display Publisher Meta on Front Page:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 'on', &nbsp;</div></li><li><div>                'type' =&gt; 'radio', &nbsp;</div></li><li><div>                'initial_options' =&gt; array(&nbsp;</div></li><li><div>                    'on' =&gt; __( 'Enabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                    0 =&gt; __( 'Disabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_google_author_advanced' =&gt; 'on' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'google_specify_publisher' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Specify Publisher URL:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_google_author_advanced' =&gt; 'on', 'aiosp_google_enable_publisher' =&gt; 'on' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            // &quot;google_connect&quot;=&gt;array( 'name' =&gt; __( 'Connect With Google Analytics', 'all-in-one-seo-pack' ), ), &nbsp;</div></li><li><div>            'google_analytics_id' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Google Analytics ID:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; null, &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'placeholder' =&gt; 'UA-########-#', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'ga_use_universal_analytics' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use Universal Analytics:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'condshow' =&gt; array(&nbsp;</div></li><li><div>                    'aiosp_google_analytics_id' =&gt; array(&nbsp;</div></li><li><div>                        'lhs' =&gt; 'aiosp_google_analytics_id', &nbsp;</div></li><li><div>                        'op' =&gt; '!=', &nbsp;</div></li><li><div>                        'rhs' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'ga_advanced_options' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Advanced Analytics Options:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 'on', &nbsp;</div></li><li><div>                'type' =&gt; 'radio', &nbsp;</div></li><li><div>                'initial_options' =&gt; array(&nbsp;</div></li><li><div>                    'on' =&gt; __( 'Enabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                    0 =&gt; __( 'Disabled', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                'condshow' =&gt; array(&nbsp;</div></li><li><div>                    'aiosp_google_analytics_id' =&gt; array(&nbsp;</div></li><li><div>                        'lhs' =&gt; 'aiosp_google_analytics_id', &nbsp;</div></li><li><div>                        'op' =&gt; '!=', &nbsp;</div></li><li><div>                        'rhs' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'ga_domain' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Tracking Domain:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'text', &nbsp;</div></li><li><div>                'condshow' =&gt; array(&nbsp;</div></li><li><div>                    'aiosp_google_analytics_id' =&gt; array(&nbsp;</div></li><li><div>                        'lhs' =&gt; 'aiosp_google_analytics_id', &nbsp;</div></li><li><div>                        'op' =&gt; '!=', &nbsp;</div></li><li><div>                        'rhs' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'aiosp_ga_advanced_options' =&gt; 'on', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'ga_multi_domain' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Track Multiple Domains:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'condshow' =&gt; array(&nbsp;</div></li><li><div>                    'aiosp_google_analytics_id' =&gt; array(&nbsp;</div></li><li><div>                        'lhs' =&gt; 'aiosp_google_analytics_id', &nbsp;</div></li><li><div>                        'op' =&gt; '!=', &nbsp;</div></li><li><div>                        'rhs' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'aiosp_ga_advanced_options' =&gt; 'on', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'ga_addl_domains' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Additional Domains:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'textarea', &nbsp;</div></li><li><div>                'condshow' =&gt; array(&nbsp;</div></li><li><div>                    'aiosp_google_analytics_id' =&gt; array(&nbsp;</div></li><li><div>                        'lhs' =&gt; 'aiosp_google_analytics_id', &nbsp;</div></li><li><div>                        'op' =&gt; '!=', &nbsp;</div></li><li><div>                        'rhs' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'aiosp_ga_advanced_options' =&gt; 'on', &nbsp;</div></li><li><div>                    'aiosp_ga_multi_domain' =&gt; 'on', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'ga_anonymize_ip' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Anonymize IP Addresses:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                'condshow' =&gt; array(&nbsp;</div></li><li><div>                    'aiosp_google_analytics_id' =&gt; array(&nbsp;</div></li><li><div>                        'lhs' =&gt; 'aiosp_google_analytics_id', &nbsp;</div></li><li><div>                        'op' =&gt; '!=', &nbsp;</div></li><li><div>                        'rhs' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'aiosp_ga_advanced_options' =&gt; 'on', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'ga_display_advertising' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Display Advertiser Tracking:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                'condshow' =&gt; array(&nbsp;</div></li><li><div>                    'aiosp_google_analytics_id' =&gt; array(&nbsp;</div></li><li><div>                        'lhs' =&gt; 'aiosp_google_analytics_id', &nbsp;</div></li><li><div>                        'op' =&gt; '!=', &nbsp;</div></li><li><div>                        'rhs' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'aiosp_ga_advanced_options' =&gt; 'on', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'ga_exclude_users' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Exclude Users From Tracking:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'multicheckbox', &nbsp;</div></li><li><div>                'condshow' =&gt; array(&nbsp;</div></li><li><div>                    'aiosp_google_analytics_id' =&gt; array(&nbsp;</div></li><li><div>                        'lhs' =&gt; 'aiosp_google_analytics_id', &nbsp;</div></li><li><div>                        'op' =&gt; '!=', &nbsp;</div></li><li><div>                        'rhs' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'aiosp_ga_advanced_options' =&gt; 'on', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'ga_track_outbound_links' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Track Outbound Links:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'condshow' =&gt; array(&nbsp;</div></li><li><div>                    'aiosp_google_analytics_id' =&gt; array(&nbsp;</div></li><li><div>                        'lhs' =&gt; 'aiosp_google_analytics_id', &nbsp;</div></li><li><div>                        'op' =&gt; '!=', &nbsp;</div></li><li><div>                        'rhs' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'aiosp_ga_advanced_options' =&gt; 'on', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'ga_link_attribution' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Enhanced Link Attribution:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'condshow' =&gt; array(&nbsp;</div></li><li><div>                    'aiosp_google_analytics_id' =&gt; array(&nbsp;</div></li><li><div>                        'lhs' =&gt; 'aiosp_google_analytics_id', &nbsp;</div></li><li><div>                        'op' =&gt; '!=', &nbsp;</div></li><li><div>                        'rhs' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'aiosp_ga_advanced_options' =&gt; 'on', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'ga_enhanced_ecommerce' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Enhanced Ecommerce:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'condshow' =&gt; array(&nbsp;</div></li><li><div>                    'aiosp_google_analytics_id' =&gt; array(&nbsp;</div></li><li><div>                        'lhs' =&gt; 'aiosp_google_analytics_id', &nbsp;</div></li><li><div>                        'op' =&gt; '!=', &nbsp;</div></li><li><div>                        'rhs' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'aiosp_ga_use_universal_analytics' =&gt; 'on', &nbsp;</div></li><li><div>                    'aiosp_ga_advanced_options' =&gt; 'on', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'use_categories' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use Categories for META keywords:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_togglekeywords' =&gt; 0 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'use_tags_as_keywords' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use Tags for META keywords:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 1, &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_togglekeywords' =&gt; 0 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'dynamic_postspage_keywords' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Dynamically Generate Keywords for Posts Page/Archives:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 1, &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_togglekeywords' =&gt; 0 ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'category_noindex' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use noindex for Categories:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 1, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'archive_date_noindex' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use noindex for Date Archives:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 1, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'archive_author_noindex' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use noindex for Author Archives:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 1, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'tags_noindex' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use noindex for Tag Archives:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'search_noindex' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use noindex for the Search page:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            '404_noindex' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use noindex for the 404 page:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'tax_noindex' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use noindex for Taxonomy Archives:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'multicheckbox', &nbsp;</div></li><li><div>                'default' =&gt; array(), &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_enablecpost' =&gt; 'on', 'aiosp_cpostadvanced' =&gt; 'on' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'paginated_noindex' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use noindex for paginated pages/posts:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'paginated_nofollow' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use nofollow for paginated pages/posts:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'noodp' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Exclude site from the Open Directory Project:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'noydir' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Exclude site from Yahoo! Directory:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'skip_excerpt' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Avoid Using The Excerpt In Descriptions:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'generate_descriptions' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Autogenerate Descriptions:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 1, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'run_shortcodes' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Run Shortcodes In Autogenerated Descriptions:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div>                'condshow' =&gt; array( 'aiosp_generate_descriptions' =&gt; 'on' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'hide_paginated_descriptions' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Remove Descriptions For Paginated Pages:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'dont_truncate_descriptions' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Never Shorten Long Descriptions:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'schema_markup' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Use Schema.org Markup', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 1, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'unprotect_meta' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Unprotect Post Meta Fields:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'redirect_attachement_parent' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Redirect Attachments to Post Parent:', 'all-in-one-seo-pack'), &nbsp;</div></li><li><div>                'default' =&gt; 0, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'ex_pages' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Exclude Pages:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'textarea', &nbsp;</div></li><li><div>                'default' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'post_meta_tags' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Additional Post Headers:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'textarea', &nbsp;</div></li><li><div>                'default' =&gt; '', &nbsp;</div></li><li><div>                'sanitize' =&gt; 'default', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'page_meta_tags' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Additional Page Headers:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'textarea', &nbsp;</div></li><li><div>                'default' =&gt; '', &nbsp;</div></li><li><div>                'sanitize' =&gt; 'default', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'front_meta_tags' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Additional Front Page Headers:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'textarea', &nbsp;</div></li><li><div>                'default' =&gt; '', &nbsp;</div></li><li><div>                'sanitize' =&gt; 'default', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'home_meta_tags' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Additional Blog Page Headers:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'type' =&gt; 'textarea', &nbsp;</div></li><li><div>                'default' =&gt; '', &nbsp;</div></li><li><div>                'sanitize' =&gt; 'default', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'do_log' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Log important events:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'default' =&gt; null, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            unset( $this-&gt;default_options['donate'] );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            unset( $this-&gt;default_options['license_key'] );&nbsp;</div></li><li><div>            unset( $this-&gt;default_options['taxactive'] );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;locations = array(&nbsp;</div></li><li><div>            'default' =&gt; array( 'name' =&gt; $this-&gt;name, 'prefix' =&gt; 'aiosp_', 'type' =&gt; 'settings', 'options' =&gt; null ), &nbsp;</div></li><li><div>            'aiosp' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; $this-&gt;plugin_name, &nbsp;</div></li><li><div>                'type' =&gt; 'metabox', &nbsp;</div></li><li><div>                'prefix' =&gt; '', &nbsp;</div></li><li><div>                'help_link' =&gt; 'http://semperplugins.com/sections/postpage-settings/', &nbsp;</div></li><li><div>                'options' =&gt; array(&nbsp;</div></li><li><div>                    'edit', &nbsp;</div></li><li><div>                    'nonce-aioseop-edit', &nbsp;</div></li><li><div>                    AIOSEOPPRO ? 'support' : 'upgrade', &nbsp;</div></li><li><div>                    'snippet', &nbsp;</div></li><li><div>                    'title', &nbsp;</div></li><li><div>                    'description', &nbsp;</div></li><li><div>                    'keywords', &nbsp;</div></li><li><div>                    'custom_link', &nbsp;</div></li><li><div>                    'noindex', &nbsp;</div></li><li><div>                    'nofollow', &nbsp;</div></li><li><div>                    'noodp', &nbsp;</div></li><li><div>                    'noydir', &nbsp;</div></li><li><div>                    'titleatr', &nbsp;</div></li><li><div>                    'menulabel', &nbsp;</div></li><li><div>                    'sitemap_exclude', &nbsp;</div></li><li><div>                    'disable', &nbsp;</div></li><li><div>                    'disable_analytics', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                'default_options' =&gt; array(&nbsp;</div></li><li><div>                    'edit' =&gt; array(&nbsp;</div></li><li><div>                        'type' =&gt; 'hidden', &nbsp;</div></li><li><div>                        'default' =&gt; 'aiosp_edit', &nbsp;</div></li><li><div>                        'prefix' =&gt; true, &nbsp;</div></li><li><div>                        'nowrap' =&gt; 1, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'nonce-aioseop-edit' =&gt; array(&nbsp;</div></li><li><div>                        'type' =&gt; 'hidden', &nbsp;</div></li><li><div>                        'default' =&gt; null, &nbsp;</div></li><li><div>                        'prefix' =&gt; false, &nbsp;</div></li><li><div>                        'nowrap' =&gt; 1, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'upgrade' =&gt; array(&nbsp;</div></li><li><div>                        'type' =&gt; 'html', &nbsp;</div></li><li><div>                        'label' =&gt; 'none', &nbsp;</div></li><li><div>                        'default' =&gt; aiosp_common::get_upgrade_hyperlink( 'meta', __( 'Upgrade to All in One SEO Pack Pro Version', 'all-in-one-seo-pack' ), __( 'UPGRADE TO PRO VERSION', 'all-in-one-seo-pack' ), '_blank' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'support' =&gt; array(&nbsp;</div></li><li><div>                        'type' =&gt; 'html', &nbsp;</div></li><li><div>                        'label' =&gt; 'none', &nbsp;</div></li><li><div>                        'default' =&gt; '&lt;a target=&quot;_blank&quot; href=&quot;https://semperplugins.com/support/&quot;&gt;'&nbsp;</div></li><li><div>                                     . __( 'Support Forum', 'all-in-one-seo-pack' ) . '&lt;/a&gt;', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'snippet' =&gt; array(&nbsp;</div></li><li><div>                        'name' =&gt; __( 'Preview Snippet', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'type' =&gt; 'custom', &nbsp;</div></li><li><div>                        'label' =&gt; 'top', &nbsp;</div></li><li><div>                        'default' =&gt; '&nbsp;</div></li><li><div>                                                                                                    &lt;script&gt;&nbsp;</div></li><li><div>                                                                                                    jQuery(document).ready(function() {&nbsp;</div></li><li><div>                                                                                                        jQuery(&quot;#aiosp_title_wrapper&quot;).bind(&quot;input&quot;, function() {&nbsp;</div></li><li><div>                                                                                                            jQuery(&quot;#aiosp_snippet_title&quot;).text(jQuery(&quot;#aiosp_title_wrapper input&quot;).val().replace(/&lt;(?:.|\n)*?&gt;/gm, &quot;&quot;));&nbsp;</div></li><li><div>                                                                                                        });&nbsp;</div></li><li><div>                                                                                                        jQuery(&quot;#aiosp_description_wrapper&quot;).bind(&quot;input&quot;, function() {&nbsp;</div></li><li><div>                                                                                                            jQuery(&quot;#aioseop_snippet_description&quot;).text(jQuery(&quot;#aiosp_description_wrapper textarea&quot;).val().replace(/&lt;(?:.|\n)*?&gt;/gm, &quot;&quot;));&nbsp;</div></li><li><div>                                                                                                        });&nbsp;</div></li><li><div>                                                                                                    });&nbsp;</div></li><li><div>                                                                                                    &lt;/script&gt;&nbsp;</div></li><li><div>                                                                                                    &lt;div class=&quot;preview_snippet&quot;&gt;&lt;div id=&quot;aioseop_snippet&quot;&gt;&lt;h3&gt;&lt;a&gt;%s&lt;/a&gt;&lt;/h3&gt;&lt;div&gt;&lt;div&gt;&lt;cite id=&quot;aioseop_snippet_link&quot;&gt;%s&lt;/cite&gt;&lt;/div&gt;&lt;span id=&quot;aioseop_snippet_description&quot;&gt;%s&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'title' =&gt; array(&nbsp;</div></li><li><div>                        'name' =&gt; __( 'Title', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'type' =&gt; 'text', &nbsp;</div></li><li><div>                        'count' =&gt; true, &nbsp;</div></li><li><div>                        'size' =&gt; 60, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'description' =&gt; array(&nbsp;</div></li><li><div>                        'name' =&gt; __( 'Description', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'type' =&gt; 'textarea', &nbsp;</div></li><li><div>                        'count' =&gt; true, &nbsp;</div></li><li><div>                        'cols' =&gt; 80, &nbsp;</div></li><li><div>                        'rows' =&gt; 2, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    'keywords' =&gt; array(&nbsp;</div></li><li><div>                        'name' =&gt; __( 'Keywords (comma separated)', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'type' =&gt; 'text', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'custom_link' =&gt; array(&nbsp;</div></li><li><div>                        'name' =&gt; __( 'Custom Canonical URL', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'type' =&gt; 'text', &nbsp;</div></li><li><div>                        'size' =&gt; 60, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'noindex' =&gt; array(&nbsp;</div></li><li><div>                        'name' =&gt; __( 'Robots Meta NOINDEX', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'default' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'nofollow' =&gt; array(&nbsp;</div></li><li><div>                        'name' =&gt; __( 'Robots Meta NOFOLLOW', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'default' =&gt; '', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'noodp' =&gt; array( 'name' =&gt; __( 'Robots Meta NOODP', 'all-in-one-seo-pack' ) ), &nbsp;</div></li><li><div>                    'noydir' =&gt; array( 'name' =&gt; __( 'Robots Meta NOYDIR', 'all-in-one-seo-pack' ) ), &nbsp;</div></li><li><div>                    'titleatr' =&gt; array(&nbsp;</div></li><li><div>                        'name' =&gt; __( 'Title Attribute', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'type' =&gt; 'text', &nbsp;</div></li><li><div>                        'size' =&gt; 60, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'menulabel' =&gt; array(&nbsp;</div></li><li><div>                        'name' =&gt; __( 'Menu Label', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'type' =&gt; 'text', &nbsp;</div></li><li><div>                        'size' =&gt; 60, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    'sitemap_exclude' =&gt; array( 'name' =&gt; __( 'Exclude From Sitemap', 'all-in-one-seo-pack' ) ), &nbsp;</div></li><li><div>                    'disable' =&gt; array( 'name' =&gt; __( 'Disable on this page/post', 'all-in-one-seo-pack' ) ), &nbsp;</div></li><li><div>                    'disable_analytics' =&gt; array(&nbsp;</div></li><li><div>                        'name' =&gt; __( 'Disable Google Analytics', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'condshow' =&gt; array( 'aiosp_disable' =&gt; 'on' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                'display' =&gt; null, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $meta_help_text ) ) {&nbsp;</div></li><li><div>            foreach ( $meta_help_text as $k =&gt; $v ) {&nbsp;</div></li><li><div>                $this-&gt;locations['aiosp']['default_options'][ $k ]['help_text'] = $v;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;layout = array(&nbsp;</div></li><li><div>            'default' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'General Settings', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'help_link' =&gt; 'https://semperplugins.com/documentation/general-settings/', &nbsp;</div></li><li><div>                'options' =&gt; array(), // This is set below, to the remaining options -- pdb.&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'home' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Home Page Settings', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'help_link' =&gt; 'https://semperplugins.com/documentation/home-page-settings/', &nbsp;</div></li><li><div>                'options' =&gt; array( 'home_title', 'home_description', 'home_keywords', 'use_static_home_info' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'title' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Title Settings', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'help_link' =&gt; 'https://semperplugins.com/documentation/title-settings/', &nbsp;</div></li><li><div>                'options' =&gt; array(&nbsp;</div></li><li><div>                    'rewrite_titles', &nbsp;</div></li><li><div>                    'force_rewrites', &nbsp;</div></li><li><div>                    'cap_titles', &nbsp;</div></li><li><div>                    'cap_cats', &nbsp;</div></li><li><div>                    'home_page_title_format', &nbsp;</div></li><li><div>                    'page_title_format', &nbsp;</div></li><li><div>                    'post_title_format', &nbsp;</div></li><li><div>                    'category_title_format', &nbsp;</div></li><li><div>                    'archive_title_format', &nbsp;</div></li><li><div>                    'date_title_format', &nbsp;</div></li><li><div>                    'author_title_format', &nbsp;</div></li><li><div>                    'tag_title_format', &nbsp;</div></li><li><div>                    'search_title_format', &nbsp;</div></li><li><div>                    'description_format', &nbsp;</div></li><li><div>                    '404_title_format', &nbsp;</div></li><li><div>                    'paged_format', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'cpt' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Custom Post Type Settings', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'help_link' =&gt; 'http://semperplugins.com/documentation/custom-post-type-settings/', &nbsp;</div></li><li><div>                'options' =&gt; array( 'enablecpost', 'cpostadvanced', 'taxactive', 'cpostactive', 'cposttitles' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'display' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Display Settings', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'help_link' =&gt; 'http://semperplugins.com/documentation/display-settings/', &nbsp;</div></li><li><div>                'options' =&gt; array( 'posttypecolumns', 'admin_bar', 'custom_menu_order' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'webmaster' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Webmaster Verification', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'help_link' =&gt; 'http://semperplugins.com/sections/webmaster-verification/', &nbsp;</div></li><li><div>                'options' =&gt; array( 'google_verify', 'bing_verify', 'pinterest_verify' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'google' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Google Settings', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'help_link' =&gt; 'http://semperplugins.com/documentation/google-settings/', &nbsp;</div></li><li><div>                'options' =&gt; array(&nbsp;</div></li><li><div>                    'google_publisher', &nbsp;</div></li><li><div>                    'google_disable_profile', &nbsp;</div></li><li><div>                    'google_sitelinks_search', &nbsp;</div></li><li><div>                    'google_set_site_name', &nbsp;</div></li><li><div>                    'google_specify_site_name', &nbsp;</div></li><li><div>                    'google_author_advanced', &nbsp;</div></li><li><div>                    'google_author_location', &nbsp;</div></li><li><div>                    'google_enable_publisher', &nbsp;</div></li><li><div>                    'google_specify_publisher', &nbsp;</div></li><li><div>                    //    &quot;google_connect&quot;, &nbsp;</div></li><li><div>                    'google_analytics_id', &nbsp;</div></li><li><div>                    'ga_use_universal_analytics', &nbsp;</div></li><li><div>                    'ga_advanced_options', &nbsp;</div></li><li><div>                    'ga_domain', &nbsp;</div></li><li><div>                    'ga_multi_domain', &nbsp;</div></li><li><div>                    'ga_addl_domains', &nbsp;</div></li><li><div>                    'ga_anonymize_ip', &nbsp;</div></li><li><div>                    'ga_display_advertising', &nbsp;</div></li><li><div>                    'ga_exclude_users', &nbsp;</div></li><li><div>                    'ga_track_outbound_links', &nbsp;</div></li><li><div>                    'ga_link_attribution', &nbsp;</div></li><li><div>                    'ga_enhanced_ecommerce', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'noindex' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Noindex Settings', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'help_link' =&gt; 'http://semperplugins.com/documentation/noindex-settings/', &nbsp;</div></li><li><div>                'options' =&gt; array(&nbsp;</div></li><li><div>                    'cpostnoindex', &nbsp;</div></li><li><div>                    'cpostnofollow', &nbsp;</div></li><li><div>                    'cpostnoodp', &nbsp;</div></li><li><div>                    'cpostnoydir', &nbsp;</div></li><li><div>                    'category_noindex', &nbsp;</div></li><li><div>                    'archive_date_noindex', &nbsp;</div></li><li><div>                    'archive_author_noindex', &nbsp;</div></li><li><div>                    'tags_noindex', &nbsp;</div></li><li><div>                    'search_noindex', &nbsp;</div></li><li><div>                    '404_noindex', &nbsp;</div></li><li><div>                    'tax_noindex', &nbsp;</div></li><li><div>                    'paginated_noindex', &nbsp;</div></li><li><div>                    'paginated_nofollow', &nbsp;</div></li><li><div>                    'noodp', &nbsp;</div></li><li><div>                    'noydir', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'advanced' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Advanced Settings', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'help_link' =&gt; 'http://semperplugins.com/documentation/advanced-settings/', &nbsp;</div></li><li><div>                'options' =&gt; array(&nbsp;</div></li><li><div>                    'generate_descriptions', &nbsp;</div></li><li><div>                    'skip_excerpt', &nbsp;</div></li><li><div>                    'run_shortcodes', &nbsp;</div></li><li><div>                    'hide_paginated_descriptions', &nbsp;</div></li><li><div>                    'dont_truncate_descriptions', &nbsp;</div></li><li><div>                    'unprotect_meta', &nbsp;</div></li><li><div>                    'redirect_attachement_parent', &nbsp;</div></li><li><div>                    'ex_pages', &nbsp;</div></li><li><div>                    'post_meta_tags', &nbsp;</div></li><li><div>                    'page_meta_tags', &nbsp;</div></li><li><div>                    'front_meta_tags', &nbsp;</div></li><li><div>                    'home_meta_tags', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'keywords' =&gt; array(&nbsp;</div></li><li><div>                'name' =&gt; __( 'Keyword Settings', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'help_link' =&gt; 'http://semperplugins.com/documentation/keyword-settings/', &nbsp;</div></li><li><div>                'options' =&gt; array(&nbsp;</div></li><li><div>                    'togglekeywords', &nbsp;</div></li><li><div>                    'use_categories', &nbsp;</div></li><li><div>                    'use_tags_as_keywords', &nbsp;</div></li><li><div>                    'dynamic_postspage_keywords', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! AIOSEOPPRO ) {&nbsp;</div></li><li><div>            unset( $this-&gt;layout['cpt']['options']['2'] );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $other_options = array();&nbsp;</div></li><li><div>        foreach ( $this-&gt;layout as $k =&gt; $v ) {&nbsp;</div></li><li><div>            $other_options = array_merge( $other_options, $v['options'] );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;layout['default']['options'] = array_diff( array_keys( $this-&gt;default_options ), $other_options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_admin() ) {&nbsp;</div></li><li><div>            $this-&gt;add_help_text_links();&nbsp;</div></li><li><div>            add_action( 'aioseop_global_settings_header', array( $this, 'display_right_sidebar' ) );&nbsp;</div></li><li><div>            add_action( 'aioseop_global_settings_footer', array( $this, 'display_settings_footer' ) );&nbsp;</div></li><li><div>            add_action( 'output_option', array( $this, 'custom_output_option' ), 10, 2 );&nbsp;</div></li><li><div>            add_action( 'all_admin_notices', array( $this, 'visibility_warning' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( ! AIOSEOPPRO ) {&nbsp;</div></li><li><div>                //    add_action('all_admin_notices', array( $this, 'woo_upgrade_notice'));&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            add_action( 'split_shared_term', array( $this, 'split_shared_term' ), 10, 4 );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //good candidate for pro dir&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Use custom callback for outputting snippet&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param $buf&nbsp;</div></li><li><div>     * @param $args&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function custom_output_option( $buf, $args ) {&nbsp;</div></li><li><div>        if ( 'aiosp_snippet' === $args['name'] ) {&nbsp;</div></li><li><div>            $args['options']['type'] = 'html';&nbsp;</div></li><li><div>            $args['options']['nowrap'] = false;&nbsp;</div></li><li><div>            $args['options']['save'] = false;&nbsp;</div></li><li><div>            $info = $this-&gt;get_page_snippet_info();&nbsp;</div></li><li><div>            extract( $info );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            return '';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $this-&gt;strlen( $title ) &gt; 70 ) {&nbsp;</div></li><li><div>            $title = $this-&gt;trim_excerpt_without_filters( $title, 70 ) . '...';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $this-&gt;strlen( $description ) &gt; 156 ) {&nbsp;</div></li><li><div>            $description = $this-&gt;trim_excerpt_without_filters( $description, 156 ) . '...';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $extra_title_len = 0;&nbsp;</div></li><li><div>        if ( empty( $title_format ) ) {&nbsp;</div></li><li><div>            $title = '&lt;span id=&quot;' . $args['name'] . '_title&quot;&gt;' . esc_attr( wp_strip_all_tags( html_entity_decode( $title ) ) ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            if ( strpos( $title_format, '%blog_title%' ) !== false ) {&nbsp;</div></li><li><div>                $title_format = str_replace( '%blog_title%', get_bloginfo( 'name' ), $title_format );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $title_format = $this-&gt;apply_cf_fields( $title_format );&nbsp;</div></li><li><div>            $replace_title = '&lt;span id=&quot;' . $args['name'] . '_title&quot;&gt;' . esc_attr( wp_strip_all_tags( html_entity_decode( $title ) ) ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>            if ( strpos( $title_format, '%post_title%' ) !== false ) {&nbsp;</div></li><li><div>                $title_format = str_replace( '%post_title%', $replace_title, $title_format );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( strpos( $title_format, '%page_title%' ) !== false ) {&nbsp;</div></li><li><div>                $title_format = str_replace( '%page_title%', $replace_title, $title_format );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( $w-&gt;is_category || $w-&gt;is_tag || $w-&gt;is_tax ) {&nbsp;</div></li><li><div>                if ( AIOSEOPPRO && ! empty( $_GET ) && ! empty( $_GET['taxonomy'] ) && ! empty( $_GET['tag_ID'] ) && function_exists( 'wp_get_split_terms' ) ) {&nbsp;</div></li><li><div>                    $term_id = intval( $_GET['tag_ID'] );&nbsp;</div></li><li><div>                    $was_split = get_term_meta( $term_id, '_aioseop_term_was_split', true );&nbsp;</div></li><li><div>                    if ( ! $was_split ) {&nbsp;</div></li><li><div>                        $split_terms = wp_get_split_terms( $term_id, $_GET['taxonomy'] );&nbsp;</div></li><li><div>                        if ( ! empty( $split_terms ) ) {&nbsp;</div></li><li><div>                            foreach ( $split_terms as $new_tax =&gt; $new_term ) {&nbsp;</div></li><li><div>                                $this-&gt;split_shared_term( $term_id, $new_term );&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( strpos( $title_format, '%category_title%' ) !== false ) {&nbsp;</div></li><li><div>                    $title_format = str_replace( '%category_title%', $replace_title, $title_format );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( strpos( $title_format, '%taxonomy_title%' ) !== false ) {&nbsp;</div></li><li><div>                    $title_format = str_replace( '%taxonomy_title%', $replace_title, $title_format );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                if ( strpos( $title_format, '%category%' ) !== false ) {&nbsp;</div></li><li><div>                    $title_format = str_replace( '%category%', $category, $title_format );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( strpos( $title_format, '%category_title%' ) !== false ) {&nbsp;</div></li><li><div>                    $title_format = str_replace( '%category_title%', $category, $title_format );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( strpos( $title_format, '%taxonomy_title%' ) !== false ) {&nbsp;</div></li><li><div>                    $title_format = str_replace( '%taxonomy_title%', $category, $title_format );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>                    if ( strpos( $title_format, '%tax_' ) && ! empty( $p ) ) {&nbsp;</div></li><li><div>                        $taxes = get_object_taxonomies( $p, 'objects' );&nbsp;</div></li><li><div>                        if ( ! empty( $taxes ) ) {&nbsp;</div></li><li><div>                            foreach ( $taxes as $t ) {&nbsp;</div></li><li><div>                                if ( strpos( $title_format, &quot;%tax_{$t-&gt;name}%&quot; ) ) {&nbsp;</div></li><li><div>                                    $terms = $this-&gt;get_all_terms( $p-&gt;ID, $t-&gt;name );&nbsp;</div></li><li><div>                                    $term = '';&nbsp;</div></li><li><div>                                    if ( count( $terms ) &gt; 0 ) {&nbsp;</div></li><li><div>                                        $term = $terms[0];&nbsp;</div></li><li><div>                                    }&nbsp;</div></li><li><div>                                    $title_format = str_replace( &quot;%tax_{$t-&gt;name}%&quot;, $term, $title_format );&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( strpos( $title_format, '%taxonomy_description%' ) !== false ) {&nbsp;</div></li><li><div>                $title_format = str_replace( '%taxonomy_description%', $description, $title_format );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $title_format = preg_replace( '/%([^%]*?)%/', '', $title_format );&nbsp;</div></li><li><div>            $title = $title_format;&nbsp;</div></li><li><div>            $extra_title_len = strlen( str_replace( $replace_title, '', $title_format ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $args['value'] = sprintf( $args['value'], $title, esc_url( $url ), esc_attr( wp_strip_all_tags( $description ) ) );&nbsp;</div></li><li><div>        $extra_title_len = (int) $extra_title_len;&nbsp;</div></li><li><div>        $args['value'] .= &quot;&lt;script&gt;var aiosp_title_extra = {$extra_title_len};&lt;/script&gt;&quot;;&nbsp;</div></li><li><div>        $buf = $this-&gt;get_option_row( $args['name'], $args['options'], $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $buf;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>//good candidate for pro dir&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_page_snippet_info() {&nbsp;</div></li><li><div>        static $info = array();&nbsp;</div></li><li><div>        if ( ! empty( $info ) ) {&nbsp;</div></li><li><div>            return $info;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        global $post, $aioseop_options, $wp_query;&nbsp;</div></li><li><div>        $title = $url = $description = $term = $category = '';&nbsp;</div></li><li><div>        $p = $post;&nbsp;</div></li><li><div>        $w = $wp_query;&nbsp;</div></li><li><div>        if ( ! is_object( $post ) ) {&nbsp;</div></li><li><div>            $post = $this-&gt;get_queried_object();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( empty( $this-&gt;meta_opts ) ) {&nbsp;</div></li><li><div>            $this-&gt;meta_opts = $this-&gt;get_current_options( array(), 'aiosp' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( ! is_object( $post ) && is_admin() && ! empty( $_GET ) && ! empty( $_GET['post_type'] ) && ! empty( $_GET['taxonomy'] ) && ! empty( $_GET['tag_ID'] ) ) {&nbsp;</div></li><li><div>            $term = get_term_by( 'id', $_GET['tag_ID'], $_GET['taxonomy'] );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( is_object( $post ) ) {&nbsp;</div></li><li><div>            $opts = $this-&gt;meta_opts;&nbsp;</div></li><li><div>            $post_id = $p-&gt;ID;&nbsp;</div></li><li><div>            if ( empty( $post-&gt;post_modified_gmt ) ) {&nbsp;</div></li><li><div>                $wp_query = new WP_Query( array( 'p' =&gt; $post_id, 'post_type' =&gt; $post-&gt;post_type ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( 'page' === $post-&gt;post_type ) {&nbsp;</div></li><li><div>                $wp_query-&gt;is_page = true;&nbsp;</div></li><li><div>            } elseif ( 'attachment' === $post-&gt;post_type ) {&nbsp;</div></li><li><div>                $wp_query-&gt;is_attachment = true;&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $wp_query-&gt;is_single = true;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $this-&gt;is_front_page ) ) {&nbsp;</div></li><li><div>                $this-&gt;is_front_page = false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( 'page' === get_option( 'show_on_front' ) ) {&nbsp;</div></li><li><div>                if ( is_page() && $post-&gt;ID == get_option( 'page_on_front' ) ) {&nbsp;</div></li><li><div>                    $this-&gt;is_front_page = true;&nbsp;</div></li><li><div>                } elseif ( $post-&gt;ID == get_option( 'page_for_posts' ) ) {&nbsp;</div></li><li><div>                    $wp_query-&gt;is_home = true;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $wp_query-&gt;queried_object = $post;&nbsp;</div></li><li><div>            if ( ! empty( $post ) && ! $wp_query-&gt;is_home && ! $this-&gt;is_front_page ) {&nbsp;</div></li><li><div>                $title = $this-&gt;internationalize( get_post_meta( $post-&gt;ID, '_aioseop_title', true ) );&nbsp;</div></li><li><div>                if ( empty( $title ) ) {&nbsp;</div></li><li><div>                    $title = $post-&gt;post_title;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $title_format = '';&nbsp;</div></li><li><div>            if ( empty( $title ) ) {&nbsp;</div></li><li><div>                $title = $this-&gt;wp_title();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $description = $this-&gt;get_main_description( $post );&nbsp;</div></li><li><div>            if ( empty( $title_format ) ) {&nbsp;</div></li><li><div>                if ( is_page() ) {&nbsp;</div></li><li><div>                    $title_format = $aioseop_options['aiosp_page_title_format'];&nbsp;</div></li><li><div>                } elseif ( is_single() || is_attachment() ) {&nbsp;</div></li><li><div>                    $title_format = $this-&gt;get_post_title_format( 'post', $post );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $title_format ) ) {&nbsp;</div></li><li><div>                $title_format = '%post_title%';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $categories = $this-&gt;get_all_categories( $post_id );&nbsp;</div></li><li><div>            $category = '';&nbsp;</div></li><li><div>            if ( count( $categories ) &gt; 0 ) {&nbsp;</div></li><li><div>                $category = $categories[0];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else if ( is_object( $term ) ) {&nbsp;</div></li><li><div>            if ( 'category' === $_GET['taxonomy'] ) {&nbsp;</div></li><li><div>                query_posts( array( 'cat' =&gt; $_GET['tag_ID'] ) );&nbsp;</div></li><li><div>            } else if ( 'post_tag' === $_GET['taxonomy'] ) {&nbsp;</div></li><li><div>                query_posts( array( 'tag' =&gt; $term-&gt;slug ) );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                query_posts( array(&nbsp;</div></li><li><div>                    'page' =&gt; '', &nbsp;</div></li><li><div>                    $_GET['taxonomy'] =&gt; $term-&gt;slug, &nbsp;</div></li><li><div>                    'post_type' =&gt; $_GET['post_type'], &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $this-&gt;meta_opts ) ) {&nbsp;</div></li><li><div>                $this-&gt;meta_opts = $this-&gt;get_current_options( array(), 'aiosp' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $title = $this-&gt;get_tax_name( $_GET['taxonomy'] );&nbsp;</div></li><li><div>            $title_format = $this-&gt;get_tax_title_format();&nbsp;</div></li><li><div>            $opts = $this-&gt;meta_opts;&nbsp;</div></li><li><div>            if ( ! empty( $opts ) ) {&nbsp;</div></li><li><div>                $description = $opts['aiosp_description'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $description ) ) {&nbsp;</div></li><li><div>                $description = term_description();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $description = $this-&gt;internationalize( $description );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $show_page = true;&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_no_paged_canonical_links'] ) ) {&nbsp;</div></li><li><div>            $show_page = false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $aioseop_options['aiosp_can'] ) {&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_customize_canonical_links'] ) && ! empty( $opts['aiosp_custom_link'] ) ) {&nbsp;</div></li><li><div>                $url = $opts['aiosp_custom_link'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $url ) ) {&nbsp;</div></li><li><div>                $url = $this-&gt;aiosp_mrt_get_url( $wp_query, $show_page );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $url = apply_filters( 'aioseop_canonical_url', $url );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( ! $url ) {&nbsp;</div></li><li><div>            $url = get_permalink();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $title = $this-&gt;apply_cf_fields( $title );&nbsp;</div></li><li><div>        $description = $this-&gt;apply_cf_fields( $description );&nbsp;</div></li><li><div>        $description = apply_filters( 'aioseop_description', $description );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $keywords = $this-&gt;get_main_keywords();&nbsp;</div></li><li><div>        $keywords = $this-&gt;apply_cf_fields( $keywords );&nbsp;</div></li><li><div>        $keywords = apply_filters( 'aioseop_keywords', $keywords );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $info = array(&nbsp;</div></li><li><div>            'title' =&gt; $title, &nbsp;</div></li><li><div>            'description' =&gt; $description, &nbsp;</div></li><li><div>            'keywords' =&gt; $keywords, &nbsp;</div></li><li><div>            'url' =&gt; $url, &nbsp;</div></li><li><div>            'title_format' =&gt; $title_format, &nbsp;</div></li><li><div>            'category' =&gt; $category, &nbsp;</div></li><li><div>            'w' =&gt; $wp_query, &nbsp;</div></li><li><div>            'p' =&gt; $post, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        wp_reset_postdata();&nbsp;</div></li><li><div>        $wp_query = $w;&nbsp;</div></li><li><div>        $post = $p;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $info;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return null|object|WP_Post&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_queried_object() {&nbsp;</div></li><li><div>        static $p = null;&nbsp;</div></li><li><div>        global $wp_query, $post;&nbsp;</div></li><li><div>        if ( null !== $p ) {&nbsp;</div></li><li><div>            return $p;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( is_object( $post ) ) {&nbsp;</div></li><li><div>            $p = $post;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            if ( ! $wp_query ) {&nbsp;</div></li><li><div>                return null;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $p = $wp_query-&gt;get_queried_object();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $p;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param array $opts&nbsp;</div></li><li><div>     * @param null $location&nbsp;</div></li><li><div>     * @param null $defaults&nbsp;</div></li><li><div>     * @param null $post&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_current_options( $opts = array(), $location = null, $defaults = null, $post = null ) {&nbsp;</div></li><li><div>        if ( ( 'aiosp' === $location) && ( 'metabox' == $this-&gt;locations[ $location ]['type'] ) ) {&nbsp;</div></li><li><div>            if ( null === $post ) {&nbsp;</div></li><li><div>                global $post;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $post_id = $post;&nbsp;</div></li><li><div>            if ( is_object( $post_id ) ) {&nbsp;</div></li><li><div>                $post_id = $post_id-&gt;ID;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $get_opts = $this-&gt;default_options( $location );&nbsp;</div></li><li><div>            $optlist = array(&nbsp;</div></li><li><div>                'keywords', &nbsp;</div></li><li><div>                'description', &nbsp;</div></li><li><div>                'title', &nbsp;</div></li><li><div>                'custom_link', &nbsp;</div></li><li><div>                'sitemap_exclude', &nbsp;</div></li><li><div>                'disable', &nbsp;</div></li><li><div>                'disable_analytics', &nbsp;</div></li><li><div>                'noindex', &nbsp;</div></li><li><div>                'nofollow', &nbsp;</div></li><li><div>                'noodp', &nbsp;</div></li><li><div>                'noydir', &nbsp;</div></li><li><div>                'titleatr', &nbsp;</div></li><li><div>                'menulabel', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            if ( ! ( ! empty( $this-&gt;options['aiosp_can'] ) ) && ( ! empty( $this-&gt;options['aiosp_customize_canonical_links'] ) ) ) {&nbsp;</div></li><li><div>                unset( $optlist['custom_link'] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            foreach ( $optlist as $f ) {&nbsp;</div></li><li><div>                $meta = '';&nbsp;</div></li><li><div>                $field = &quot;aiosp_$f&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>                    if ( ( isset( $_GET['taxonomy'] ) && isset( $_GET['tag_ID'] ) ) || is_category() || is_tag() || is_tax() ) {&nbsp;</div></li><li><div>                        if ( is_admin() && isset( $_GET['tag_ID'] ) ) {&nbsp;</div></li><li><div>                            $meta = get_term_meta( $_GET['tag_ID'], '_aioseop_' . $f, true );&nbsp;</div></li><li><div>                        } else {&nbsp;</div></li><li><div>                            $queried_object = get_queried_object();&nbsp;</div></li><li><div>                            if ( ! empty( $queried_object ) && ! empty( $queried_object-&gt;term_id ) ) {&nbsp;</div></li><li><div>                                $meta = get_term_meta( $queried_object-&gt;term_id, '_aioseop_' . $f, true );&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $meta = get_post_meta( $post_id, '_aioseop_' . $f, true );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ( 'title' === $f || 'description' === $f ) {&nbsp;</div></li><li><div>                        $get_opts[ $field ] = htmlspecialchars( $meta );&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $get_opts[ $field ] = htmlspecialchars( stripslashes( $meta ) );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $field = &quot;aiosp_$f&quot;;&nbsp;</div></li><li><div>                    $meta = get_post_meta( $post_id, '_aioseop_' . $f, true );&nbsp;</div></li><li><div>                    if ( 'title' === $f || 'description' === $f ) {&nbsp;</div></li><li><div>                        $get_opts[ $field ] = htmlspecialchars( $meta );&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $get_opts[ $field ] = htmlspecialchars( stripslashes( $meta ) );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $opts = wp_parse_args( $opts, $get_opts );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return $opts;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $options = parent::get_current_options( $opts, $location, $defaults );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return $options;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $in&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed|void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function internationalize( $in ) {&nbsp;</div></li><li><div>        if ( function_exists( 'langswitch_filter_langs_with_message' ) ) {&nbsp;</div></li><li><div>            $in = langswitch_filter_langs_with_message( $in );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( function_exists( 'polyglot_filter' ) ) {&nbsp;</div></li><li><div>            $in = polyglot_filter( $in );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( function_exists( 'qtrans_useCurrentLanguageIfNotFoundUseDefaultLanguage' ) ) {&nbsp;</div></li><li><div>            $in = qtrans_useCurrentLanguageIfNotFoundUseDefaultLanguage( $in );&nbsp;</div></li><li><div>        } elseif ( function_exists( 'ppqtrans_useCurrentLanguageIfNotFoundUseDefaultLanguage' ) ) {&nbsp;</div></li><li><div>            $in = ppqtrans_useCurrentLanguageIfNotFoundUseDefaultLanguage( $in );&nbsp;</div></li><li><div>        } elseif ( function_exists( 'qtranxf_useCurrentLanguageIfNotFoundUseDefaultLanguage' ) ) {&nbsp;</div></li><li><div>            $in = qtranxf_useCurrentLanguageIfNotFoundUseDefaultLanguage( $in );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return apply_filters( 'localization', $in );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /*** Used to filter wp_title(), get our title. ***/&nbsp;</div></li><li><div>    function wp_title() {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        $title = false;&nbsp;</div></li><li><div>        $post = $this-&gt;get_queried_object();&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_rewrite_titles'] ) ) {&nbsp;</div></li><li><div>            $title = $this-&gt;get_aioseop_title( $post );&nbsp;</div></li><li><div>            $title = $this-&gt;apply_cf_fields( $title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( false === $title ) {&nbsp;</div></li><li><div>            $title = $this-&gt;get_original_title();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // If we're going to have this here, which seems logical, we should probably take it out of other places... do all titles pass through here?&nbsp;</div></li><li><div>        // The following lines have been commented out to fix an error with Capitalize Titles as reported in the WP forums&nbsp;</div></li><li><div>        // if ( !empty( $aioseop_options['aiosp_cap_titles'] ) )&nbsp;</div></li><li><div>        //    $title = $this-&gt;capitalize( $title );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return apply_filters( 'aioseop_title', $title );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Gets the title that will be used by AIOSEOP for title rewrites or returns false.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param $post&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return bool|string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_aioseop_title( $post ) {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        // the_search_query() is not suitable, it cannot just return.&nbsp;</div></li><li><div>        global $s, $STagging;&nbsp;</div></li><li><div>        $opts = $this-&gt;meta_opts;&nbsp;</div></li><li><div>        if ( is_front_page() ) {&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_use_static_home_info'] ) ) {&nbsp;</div></li><li><div>                global $post;&nbsp;</div></li><li><div>                if ( get_option( 'show_on_front' ) == 'page' && is_page() && $post-&gt;ID == get_option( 'page_on_front' ) ) {&nbsp;</div></li><li><div>                    $title = $this-&gt;internationalize( get_post_meta( $post-&gt;ID, '_aioseop_title', true ) );&nbsp;</div></li><li><div>                    if ( ! $title ) {&nbsp;</div></li><li><div>                        $title = $this-&gt;internationalize( $post-&gt;post_title );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ( ! $title ) {&nbsp;</div></li><li><div>                        $title = $this-&gt;internationalize( $this-&gt;get_original_title( '', false ) );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ( ! empty( $aioseop_options['aiosp_home_page_title_format'] ) ) {&nbsp;</div></li><li><div>                        $title = $this-&gt;apply_page_title_format( $title, $post, $aioseop_options['aiosp_home_page_title_format'] );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $title = $this-&gt;paged_title( $title );&nbsp;</div></li><li><div>                    $title = apply_filters( 'aioseop_home_page_title', $title );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $title = $this-&gt;internationalize( $aioseop_options['aiosp_home_title'] );&nbsp;</div></li><li><div>                if ( ! empty( $aioseop_options['aiosp_home_page_title_format'] ) ) {&nbsp;</div></li><li><div>                    $title = $this-&gt;apply_page_title_format( $title, null, $aioseop_options['aiosp_home_page_title_format'] );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $title ) ) {&nbsp;</div></li><li><div>                $title = $this-&gt;internationalize( get_option( 'blogname' ) ) . ' | ' . $this-&gt;internationalize( get_bloginfo( 'description' ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            global $post;&nbsp;</div></li><li><div>            $post_id = $post-&gt;ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( is_post_type_archive() && is_post_type_archive( 'product' ) && $post_id = woocommerce_get_page_id( 'shop' ) && $post = get_post( $post_id ) ) {&nbsp;</div></li><li><div>                $frontpage_id = get_option( 'page_on_front' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( woocommerce_get_page_id( 'shop' ) == get_option( 'page_on_front' ) && ! empty( $aioseop_options['aiosp_use_static_home_info'] ) ) {&nbsp;</div></li><li><div>                    $title = $this-&gt;internationalize( get_post_meta( $post-&gt;ID, '_aioseop_title', true ) );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                // $title = $this-&gt;internationalize( $aioseop_options['aiosp_home_title'] );&nbsp;</div></li><li><div>                if ( ! $title ) {&nbsp;</div></li><li><div>                    $title = $this-&gt;internationalize( get_post_meta( $frontpage_id, '_aioseop_title', true ) );&nbsp;</div></li><li><div>                } // This is/was causing the first product to come through.&nbsp;</div></li><li><div>                if ( ! $title ) {&nbsp;</div></li><li><div>                    $title = $this-&gt;internationalize( $post-&gt;post_title );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( ! $title ) {&nbsp;</div></li><li><div>                    $title = $this-&gt;internationalize( $this-&gt;get_original_title( '', false ) );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $title = $this-&gt;apply_page_title_format( $title, $post );&nbsp;</div></li><li><div>                $title = $this-&gt;paged_title( $title );&nbsp;</div></li><li><div>                $title = apply_filters( 'aioseop_title_page', $title );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                return $title;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return $this-&gt;paged_title( $title ); //this is returned for woo&nbsp;</div></li><li><div>        } else if ( is_attachment() ) {&nbsp;</div></li><li><div>            if ( null === $post ) {&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $title = get_post_meta( $post-&gt;ID, '_aioseop_title', true );&nbsp;</div></li><li><div>            if ( empty( $title ) ) {&nbsp;</div></li><li><div>                $title = $post-&gt;post_title;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $title ) ) {&nbsp;</div></li><li><div>                $title = $this-&gt;get_original_title( '', false );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $title ) ) {&nbsp;</div></li><li><div>                $title = get_the_title( $post-&gt;post_parent );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $title = apply_filters( 'aioseop_attachment_title', $this-&gt;internationalize( $this-&gt;apply_post_title_format( $title, '', $post ) ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return $title;&nbsp;</div></li><li><div>        } else if ( is_page() || $this-&gt;is_static_posts_page() || ( is_home() && ! $this-&gt;is_static_posts_page() ) ) {&nbsp;</div></li><li><div>            if ( null === $post ) {&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( $this-&gt;is_static_front_page() && ( $home_title = $this-&gt;internationalize( $aioseop_options['aiosp_home_title'] ) ) ) {&nbsp;</div></li><li><div>                if ( ! empty( $aioseop_options['aiosp_home_page_title_format'] ) ) {&nbsp;</div></li><li><div>                    $home_title = $this-&gt;apply_page_title_format( $home_title, $post, $aioseop_options['aiosp_home_page_title_format'] );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // Home title filter.&nbsp;</div></li><li><div>                return apply_filters( 'aioseop_home_page_title', $home_title );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $page_for_posts = '';&nbsp;</div></li><li><div>                if ( is_home() ) {&nbsp;</div></li><li><div>                    $page_for_posts = get_option( 'page_for_posts' );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( $page_for_posts ) {&nbsp;</div></li><li><div>                    $title = $this-&gt;internationalize( get_post_meta( $page_for_posts, '_aioseop_title', true ) );&nbsp;</div></li><li><div>                    if ( ! $title ) {&nbsp;</div></li><li><div>                        $post_page = get_post( $page_for_posts );&nbsp;</div></li><li><div>                        $title = $this-&gt;internationalize( $post_page-&gt;post_title );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $title = $this-&gt;internationalize( get_post_meta( $post-&gt;ID, '_aioseop_title', true ) );&nbsp;</div></li><li><div>                    if ( ! $title ) {&nbsp;</div></li><li><div>                        $title = $this-&gt;internationalize( $post-&gt;post_title );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( ! $title ) {&nbsp;</div></li><li><div>                    $title = $this-&gt;internationalize( $this-&gt;get_original_title( '', false ) );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $title = $this-&gt;apply_page_title_format( $title, $post );&nbsp;</div></li><li><div>                $title = $this-&gt;paged_title( $title );&nbsp;</div></li><li><div>                $title = apply_filters( 'aioseop_title_page', $title );&nbsp;</div></li><li><div>                if ( $this-&gt;is_static_posts_page() ) {&nbsp;</div></li><li><div>                    $title = apply_filters( 'single_post_title', $title );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                return $title;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else if ( function_exists( 'woocommerce_get_page_id' ) && is_post_type_archive( 'product' ) && ( $post_id = woocommerce_get_page_id( 'shop' ) ) && ( $post = get_post( $post_id ) ) ) {&nbsp;</div></li><li><div>            // Too far down? -mrt.&nbsp;</div></li><li><div>            $title = $this-&gt;internationalize( get_post_meta( $post-&gt;ID, '_aioseop_title', true ) );&nbsp;</div></li><li><div>            if ( ! $title ) {&nbsp;</div></li><li><div>                $title = $this-&gt;internationalize( $post-&gt;post_title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! $title ) {&nbsp;</div></li><li><div>                $title = $this-&gt;internationalize( $this-&gt;get_original_title( '', false ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $title = $this-&gt;apply_page_title_format( $title, $post );&nbsp;</div></li><li><div>            $title = $this-&gt;paged_title( $title );&nbsp;</div></li><li><div>            $title = apply_filters( 'aioseop_title_page', $title );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return $title;&nbsp;</div></li><li><div>        } else if ( is_single() ) {&nbsp;</div></li><li><div>            // We're not in the loop :(.&nbsp;</div></li><li><div>            if ( null === $post ) {&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $categories = $this-&gt;get_all_categories();&nbsp;</div></li><li><div>            $category = '';&nbsp;</div></li><li><div>            if ( count( $categories ) &gt; 0 ) {&nbsp;</div></li><li><div>                $category = $categories[0];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $title = $this-&gt;internationalize( get_post_meta( $post-&gt;ID, '_aioseop_title', true ) );&nbsp;</div></li><li><div>            if ( ! $title ) {&nbsp;</div></li><li><div>                $title = $this-&gt;internationalize( get_post_meta( $post-&gt;ID, 'title_tag', true ) );&nbsp;</div></li><li><div>                if ( ! $title ) {&nbsp;</div></li><li><div>                    $title = $this-&gt;internationalize( $this-&gt;get_original_title( '', false ) );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $title ) ) {&nbsp;</div></li><li><div>                $title = $post-&gt;post_title;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! empty( $title ) ) {&nbsp;</div></li><li><div>                $title = $this-&gt;apply_post_title_format( $title, $category, $post );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $title = $this-&gt;paged_title( $title );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return apply_filters( 'aioseop_title_single', $title );&nbsp;</div></li><li><div>        } else if ( is_search() && isset( $s ) && ! empty( $s ) ) {&nbsp;</div></li><li><div>            $search = esc_attr( stripslashes( $s ) );&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_cap_titles'] ) ) {&nbsp;</div></li><li><div>                $search = $this-&gt;capitalize( $search );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $title_format = $aioseop_options['aiosp_search_title_format'];&nbsp;</div></li><li><div>            $title = str_replace( '%blog_title%', $this-&gt;internationalize( get_bloginfo( 'name' ) ), $title_format );&nbsp;</div></li><li><div>            if ( strpos( $title, '%blog_description%' ) !== false ) {&nbsp;</div></li><li><div>                $title = str_replace( '%blog_description%', $this-&gt;internationalize( get_bloginfo( 'description' ) ), $title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( strpos( $title, '%search%' ) !== false ) {&nbsp;</div></li><li><div>                $title = str_replace( '%search%', $search, $title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $title = $this-&gt;paged_title( $title );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return $title;&nbsp;</div></li><li><div>        } else if ( is_tag() ) {&nbsp;</div></li><li><div>            global $utw;&nbsp;</div></li><li><div>            $tag = $tag_description = '';&nbsp;</div></li><li><div>            if ( $utw ) {&nbsp;</div></li><li><div>                $tags = $utw-&gt;GetCurrentTagSet();&nbsp;</div></li><li><div>                $tag = $tags[0]-&gt;tag;&nbsp;</div></li><li><div>                $tag = str_replace( '-', ' ', $tag );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>                    if ( ! empty( $opts ) && ! empty( $opts['aiosp_title'] ) ) {&nbsp;</div></li><li><div>                        $tag = $opts['aiosp_title'];&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ( ! empty( $opts ) ) {&nbsp;</div></li><li><div>                        if ( ! empty( $opts['aiosp_title'] ) ) {&nbsp;</div></li><li><div>                            $tag = $opts['aiosp_title'];&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        if ( ! empty( $opts['aiosp_description'] ) ) {&nbsp;</div></li><li><div>                            $tag_description = $opts['aiosp_description'];&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( empty( $tag ) ) {&nbsp;</div></li><li><div>                    $tag = $this-&gt;get_original_title( '', false );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( empty( $tag_description ) ) {&nbsp;</div></li><li><div>                    $tag_description = tag_description();&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $tag = $this-&gt;internationalize( $tag );&nbsp;</div></li><li><div>                $tag_description = $this-&gt;internationalize( $tag_description );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( $tag ) {&nbsp;</div></li><li><div>                if ( ! empty( $aioseop_options['aiosp_cap_titles'] ) ) {&nbsp;</div></li><li><div>                    $tag = $this-&gt;capitalize( $tag );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $title_format = $aioseop_options['aiosp_tag_title_format'];&nbsp;</div></li><li><div>                $title = str_replace( '%blog_title%', $this-&gt;internationalize( get_bloginfo( 'name' ) ), $title_format );&nbsp;</div></li><li><div>                if ( strpos( $title, '%blog_description%' ) !== false ) {&nbsp;</div></li><li><div>                    $title = str_replace( '%blog_description%', $this-&gt;internationalize( get_bloginfo( 'description' ) ), $title );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( strpos( $title, '%tag%' ) !== false ) {&nbsp;</div></li><li><div>                    $title = str_replace( '%tag%', $tag, $title );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( strpos( $title, '%tag_description%' ) !== false ) {&nbsp;</div></li><li><div>                    $title = str_replace( '%tag_description%', $tag_description, $title );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( strpos( $title, '%taxonomy_description%' ) !== false ) {&nbsp;</div></li><li><div>                    $title = str_replace( '%taxonomy_description%', $tag_description, $title );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $title = trim( wp_strip_all_tags( $title ) );&nbsp;</div></li><li><div>                $title = str_replace( array( '&quot;', &quot;\r\n&quot;, &quot;\n&quot; ), array( '&quot;', ' ', ' ' ), $title );&nbsp;</div></li><li><div>                $title = $this-&gt;paged_title( $title );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                return $title;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else if ( ( is_tax() || is_category() ) && ! is_feed() ) {&nbsp;</div></li><li><div>            return $this-&gt;get_tax_title();&nbsp;</div></li><li><div>        } else if ( isset( $STagging ) && $STagging-&gt;is_tag_view() ) { // Simple tagging support.&nbsp;</div></li><li><div>            $tag = $STagging-&gt;search_tag;&nbsp;</div></li><li><div>            if ( $tag ) {&nbsp;</div></li><li><div>                if ( ! empty( $aioseop_options['aiosp_cap_titles'] ) ) {&nbsp;</div></li><li><div>                    $tag = $this-&gt;capitalize( $tag );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $title_format = $aioseop_options['aiosp_tag_title_format'];&nbsp;</div></li><li><div>                $title = str_replace( '%blog_title%', $this-&gt;internationalize( get_bloginfo( 'name' ) ), $title_format );&nbsp;</div></li><li><div>                if ( strpos( $title, '%blog_description%' ) !== false ) {&nbsp;</div></li><li><div>                    $title = str_replace( '%blog_description%', $this-&gt;internationalize( get_bloginfo( 'description' ) ), $title );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( strpos( $title, '%tag%' ) !== false ) {&nbsp;</div></li><li><div>                    $title = str_replace( '%tag%', $tag, $title );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $title = $this-&gt;paged_title( $title );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                return $title;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else if ( is_archive() || is_post_type_archive() ) {&nbsp;</div></li><li><div>            if ( is_author() ) {&nbsp;</div></li><li><div>                $author = $this-&gt;internationalize( $this-&gt;get_original_title( '', false ) );&nbsp;</div></li><li><div>                $title_format = $aioseop_options['aiosp_author_title_format'];&nbsp;</div></li><li><div>                $new_title = str_replace( '%author%', $author, $title_format );&nbsp;</div></li><li><div>            } else if ( is_date() ) {&nbsp;</div></li><li><div>                global $wp_query;&nbsp;</div></li><li><div>                $date = $this-&gt;internationalize( $this-&gt;get_original_title( '', false ) );&nbsp;</div></li><li><div>                $title_format = $aioseop_options['aiosp_date_title_format'];&nbsp;</div></li><li><div>                $new_title = str_replace( '%date%', $date, $title_format );&nbsp;</div></li><li><div>                $day = get_query_var( 'day' );&nbsp;</div></li><li><div>                if ( empty( $day ) ) {&nbsp;</div></li><li><div>                    $day = '';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $new_title = str_replace( '%day%', $day, $new_title );&nbsp;</div></li><li><div>                $monthnum = get_query_var( 'monthnum' );&nbsp;</div></li><li><div>                $year = get_query_var( 'year' );&nbsp;</div></li><li><div>                if ( empty( $monthnum ) || is_year() ) {&nbsp;</div></li><li><div>                    $month = '';&nbsp;</div></li><li><div>                    $monthnum = 0;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $month = date( 'F', mktime( 0, 0, 0, (int) $monthnum, 1, (int) $year ) );&nbsp;</div></li><li><div>                $new_title = str_replace( '%monthnum%', $monthnum, $new_title );&nbsp;</div></li><li><div>                if ( strpos( $new_title, '%month%' ) !== false ) {&nbsp;</div></li><li><div>                    $new_title = str_replace( '%month%', $month, $new_title );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( strpos( $new_title, '%year%' ) !== false ) {&nbsp;</div></li><li><div>                    $new_title = str_replace( '%year%', get_query_var( 'year' ), $new_title );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } else if ( is_post_type_archive() ) {&nbsp;</div></li><li><div>                if ( empty( $title ) ) {&nbsp;</div></li><li><div>                    $title = $this-&gt;get_original_title( '', false );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $new_title = apply_filters( 'aioseop_archive_title', $this-&gt;apply_archive_title_format( $title ) );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $new_title = str_replace( '%blog_title%', $this-&gt;internationalize( get_bloginfo( 'name' ) ), $new_title );&nbsp;</div></li><li><div>            if ( strpos( $new_title, '%blog_description%' ) !== false ) {&nbsp;</div></li><li><div>                $new_title = str_replace( '%blog_description%', $this-&gt;internationalize( get_bloginfo( 'description' ) ), $new_title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $title = trim( $new_title );&nbsp;</div></li><li><div>            $title = $this-&gt;paged_title( $title );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return $title;&nbsp;</div></li><li><div>        } else if ( is_404() ) {&nbsp;</div></li><li><div>            $title_format = $aioseop_options['aiosp_404_title_format'];&nbsp;</div></li><li><div>            $new_title = str_replace( '%blog_title%', $this-&gt;internationalize( get_bloginfo( 'name' ) ), $title_format );&nbsp;</div></li><li><div>            if ( strpos( $new_title, '%blog_description%' ) !== false ) {&nbsp;</div></li><li><div>                $new_title = str_replace( '%blog_description%', $this-&gt;internationalize( get_bloginfo( 'description' ) ), $new_title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( strpos( $new_title, '%request_url%' ) !== false ) {&nbsp;</div></li><li><div>                $new_title = str_replace( '%request_url%', $_SERVER['REQUEST_URI'], $new_title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( strpos( $new_title, '%request_words%' ) !== false ) {&nbsp;</div></li><li><div>                $new_title = str_replace( '%request_words%', $this-&gt;request_as_words( $_SERVER['REQUEST_URI'] ), $new_title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( strpos( $new_title, '%404_title%' ) !== false ) {&nbsp;</div></li><li><div>                $new_title = str_replace( '%404_title%', $this-&gt;internationalize( $this-&gt;get_original_title( '', false ) ), $new_title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return $new_title;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param string $sep&nbsp;</div></li><li><div>     * @param bool $echo&nbsp;</div></li><li><div>     * @param string $seplocation&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return The original title as delivered by WP (well, in most cases).&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_original_title( $sep = '|', $echo = false, $seplocation = '' ) {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_use_original_title'] ) ) {&nbsp;</div></li><li><div>            $has_filter = has_filter( 'wp_title', array( $this, 'wp_title' ) );&nbsp;</div></li><li><div>            if ( false !== $has_filter ) {&nbsp;</div></li><li><div>                remove_filter( 'wp_title', array( $this, 'wp_title' ), $has_filter );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( current_theme_supports( 'title-tag' ) ) {&nbsp;</div></li><li><div>                $sep = '|';&nbsp;</div></li><li><div>                $echo = false;&nbsp;</div></li><li><div>                $seplocation = 'right';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $title = wp_title( $sep, $echo, $seplocation );&nbsp;</div></li><li><div>            if (  false !== $has_filter ) {&nbsp;</div></li><li><div>                add_filter( 'wp_title', array( $this, 'wp_title' ), $has_filter );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( $title && ( $title = trim( $title ) ) ) {&nbsp;</div></li><li><div>                return trim( $title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // the_search_query() is not suitable, it cannot just return.&nbsp;</div></li><li><div>        global $s;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $title = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_home() ) {&nbsp;</div></li><li><div>            $title = get_option( 'blogname' );&nbsp;</div></li><li><div>        } else if ( is_single() ) {&nbsp;</div></li><li><div>            $title = $this-&gt;internationalize( single_post_title( '', false ) );&nbsp;</div></li><li><div>        } else if ( is_search() && isset( $s ) && ! empty( $s ) ) {&nbsp;</div></li><li><div>            $search = esc_attr( stripslashes( $s ) );&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_cap_titles'] ) ) {&nbsp;</div></li><li><div>                $search = $this-&gt;capitalize( $search );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $title = $search;&nbsp;</div></li><li><div>        } else if ( ( is_tax() || is_category() ) && ! is_feed() ) {&nbsp;</div></li><li><div>            $category_name = $this-&gt;ucwords( $this-&gt;internationalize( single_cat_title( '', false ) ) );&nbsp;</div></li><li><div>            $title = $category_name;&nbsp;</div></li><li><div>        } else if ( is_page() ) {&nbsp;</div></li><li><div>            $title = $this-&gt;internationalize( single_post_title( '', false ) );&nbsp;</div></li><li><div>        } else if ( is_tag() ) {&nbsp;</div></li><li><div>            global $utw;&nbsp;</div></li><li><div>            if ( $utw ) {&nbsp;</div></li><li><div>                $tags = $utw-&gt;GetCurrentTagSet();&nbsp;</div></li><li><div>                $tag = $tags[0]-&gt;tag;&nbsp;</div></li><li><div>                $tag = str_replace( '-', ' ', $tag );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                // For WordPress &gt; 2.3.&nbsp;</div></li><li><div>                $tag = $this-&gt;internationalize( single_term_title( '', false ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( $tag ) {&nbsp;</div></li><li><div>                $title = $tag;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else if ( is_author() ) {&nbsp;</div></li><li><div>            $author = get_userdata( get_query_var( 'author' ) );&nbsp;</div></li><li><div>            if ( $author === false ) {&nbsp;</div></li><li><div>                global $wp_query;&nbsp;</div></li><li><div>                $author = $wp_query-&gt;get_queried_object();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( $author !== false ) {&nbsp;</div></li><li><div>                $title = $author-&gt;display_name;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else if ( is_day() ) {&nbsp;</div></li><li><div>            $title = get_the_date();&nbsp;</div></li><li><div>        } else if ( is_month() ) {&nbsp;</div></li><li><div>            $title = get_the_date( 'F, Y' );&nbsp;</div></li><li><div>        } else if ( is_year() ) {&nbsp;</div></li><li><div>            $title = get_the_date( 'Y' );&nbsp;</div></li><li><div>        } else if ( is_archive() ) {&nbsp;</div></li><li><div>            $title = $this-&gt;internationalize( post_type_archive_title( '', false ) );&nbsp;</div></li><li><div>        } else if ( is_404() ) {&nbsp;</div></li><li><div>            $title_format = $aioseop_options['aiosp_404_title_format'];&nbsp;</div></li><li><div>            $new_title = str_replace( '%blog_title%', $this-&gt;internationalize( get_bloginfo( 'name' ) ), $title_format );&nbsp;</div></li><li><div>            if ( strpos( $new_title, '%blog_description%' ) !== false ) {&nbsp;</div></li><li><div>                $new_title = str_replace( '%blog_description%', $this-&gt;internationalize( get_bloginfo( 'description' ) ), $new_title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( strpos( $new_title, '%request_url%' ) !== false ) {&nbsp;</div></li><li><div>                $new_title = str_replace( '%request_url%', $_SERVER['REQUEST_URI'], $new_title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( strpos( $new_title, '%request_words%' ) !== false ) {&nbsp;</div></li><li><div>                $new_title = str_replace( '%request_words%', $this-&gt;request_as_words( $_SERVER['REQUEST_URI'] ), $new_title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $title = $new_title;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return trim( $title );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $s&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function capitalize( $s ) {&nbsp;</div></li><li><div>        $s = trim( $s );&nbsp;</div></li><li><div>        $tokens = explode( ' ', $s );&nbsp;</div></li><li><div>        while ( list( $key, $val ) = each( $tokens ) ) {&nbsp;</div></li><li><div>            $tokens[ $key ] = trim( $tokens[ $key ] );&nbsp;</div></li><li><div>            $tokens[ $key ] = $this-&gt;strtoupper( $this-&gt;substr( $tokens[ $key ], 0, 1 ) ) . $this-&gt;substr( $tokens[ $key ], 1 );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $s = implode( ' ', $tokens );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $s;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $request&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return User -readable nice words for a given request.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function request_as_words( $request ) {&nbsp;</div></li><li><div>        $request = htmlspecialchars( $request );&nbsp;</div></li><li><div>        $request = str_replace( '.html', ' ', $request );&nbsp;</div></li><li><div>        $request = str_replace( '.htm', ' ', $request );&nbsp;</div></li><li><div>        $request = str_replace( '.', ' ', $request );&nbsp;</div></li><li><div>        $request = str_replace( '/', ' ', $request );&nbsp;</div></li><li><div>        $request = str_replace( '-', ' ', $request );&nbsp;</div></li><li><div>        $request_a = explode( ' ', $request );&nbsp;</div></li><li><div>        $request_new = array();&nbsp;</div></li><li><div>        foreach ( $request_a as $token ) {&nbsp;</div></li><li><div>            $request_new[] = $this-&gt;ucwords( trim( $token ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $request = implode( ' ', $request_new );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $request;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $title&nbsp;</div></li><li><div>     * @param null $p&nbsp;</div></li><li><div>     * @param string $title_format&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function apply_page_title_format( $title, $p = null, $title_format = '' ) {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        if ( $p === null ) {&nbsp;</div></li><li><div>            global $post;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $post = $p;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( empty( $title_format ) ) {&nbsp;</div></li><li><div>            $title_format = $aioseop_options['aiosp_page_title_format'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $this-&gt;title_placeholder_helper( $title, $post, 'page', $title_format );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $title&nbsp;</div></li><li><div>     * @param $post&nbsp;</div></li><li><div>     * @param string $type&nbsp;</div></li><li><div>     * @param string $title_format&nbsp;</div></li><li><div>     * @param string $category&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function title_placeholder_helper( $title, $post, $type = 'post', $title_format = '', $category = '' ) {&nbsp;</div></li><li><div>        if ( ! empty( $post ) ) {&nbsp;</div></li><li><div>            $authordata = get_userdata( $post-&gt;post_author );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $authordata = new WP_User();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $new_title = str_replace( '%blog_title%', $this-&gt;internationalize( get_bloginfo( 'name' ) ), $title_format );&nbsp;</div></li><li><div>        if ( strpos( $new_title, '%blog_description%' ) !== false ) {&nbsp;</div></li><li><div>            $new_title = str_replace( '%blog_description%', $this-&gt;internationalize( get_bloginfo( 'description' ) ), $new_title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( strpos( $new_title, &quot;%{$type}_title%&quot; ) !== false ) {&nbsp;</div></li><li><div>            $new_title = str_replace( &quot;%{$type}_title%&quot;, $title, $new_title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $type == 'post' ) {&nbsp;</div></li><li><div>            if ( strpos( $new_title, '%category%' ) !== false ) {&nbsp;</div></li><li><div>                $new_title = str_replace( '%category%', $category, $new_title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( strpos( $new_title, '%category_title%' ) !== false ) {&nbsp;</div></li><li><div>                $new_title = str_replace( '%category_title%', $category, $new_title );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( strpos( $new_title, '%tax_' ) && ! empty( $post ) ) {&nbsp;</div></li><li><div>                $taxes = get_object_taxonomies( $post, 'objects' );&nbsp;</div></li><li><div>                if ( ! empty( $taxes ) ) {&nbsp;</div></li><li><div>                    foreach ( $taxes as $t ) {&nbsp;</div></li><li><div>                        if ( strpos( $new_title, &quot;%tax_{$t-&gt;name}%&quot; ) ) {&nbsp;</div></li><li><div>                            $terms = $this-&gt;get_all_terms( $post-&gt;ID, $t-&gt;name );&nbsp;</div></li><li><div>                            $term = '';&nbsp;</div></li><li><div>                            if ( count( $terms ) &gt; 0 ) {&nbsp;</div></li><li><div>                                $term = $terms[0];&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                            $new_title = str_replace( &quot;%tax_{$t-&gt;name}%&quot;, $term, $new_title );&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( strpos( $new_title, &quot;%{$type}_author_login%&quot; ) !== false ) {&nbsp;</div></li><li><div>            $new_title = str_replace( &quot;%{$type}_author_login%&quot;, $authordata-&gt;user_login, $new_title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( strpos( $new_title, &quot;%{$type}_author_nicename%&quot; ) !== false ) {&nbsp;</div></li><li><div>            $new_title = str_replace( &quot;%{$type}_author_nicename%&quot;, $authordata-&gt;user_nicename, $new_title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( strpos( $new_title, &quot;%{$type}_author_firstname%&quot; ) !== false ) {&nbsp;</div></li><li><div>            $new_title = str_replace( &quot;%{$type}_author_firstname%&quot;, $this-&gt;ucwords( $authordata-&gt;first_name ), $new_title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( strpos( $new_title, &quot;%{$type}_author_lastname%&quot; ) !== false ) {&nbsp;</div></li><li><div>            $new_title = str_replace( &quot;%{$type}_author_lastname%&quot;, $this-&gt;ucwords( $authordata-&gt;last_name ), $new_title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $title = trim( $new_title );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $title;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $id&nbsp;</div></li><li><div>     * @param $taxonomy&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_all_terms( $id, $taxonomy ) {&nbsp;</div></li><li><div>        $keywords = array();&nbsp;</div></li><li><div>        $terms = get_the_terms( $id, $taxonomy );&nbsp;</div></li><li><div>        if ( ! empty( $terms ) ) {&nbsp;</div></li><li><div>            foreach ( $terms as $term ) {&nbsp;</div></li><li><div>                $keywords[] = $this-&gt;internationalize( $term-&gt;name );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $keywords;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $title&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function paged_title( $title ) {&nbsp;</div></li><li><div>        // The page number if paged.&nbsp;</div></li><li><div>        global $paged;&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        // Simple tagging support.&nbsp;</div></li><li><div>        global $STagging;&nbsp;</div></li><li><div>        $page = get_query_var( 'page' );&nbsp;</div></li><li><div>        if ( $paged &gt; $page ) {&nbsp;</div></li><li><div>            $page = $paged;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( is_paged() || ( isset( $STagging ) && $STagging-&gt;is_tag_view() && $paged ) || ( $page &gt; 1 ) ) {&nbsp;</div></li><li><div>            $part = $this-&gt;internationalize( $aioseop_options['aiosp_paged_format'] );&nbsp;</div></li><li><div>            if ( isset( $part ) || ! empty( $part ) ) {&nbsp;</div></li><li><div>                $part = ' ' . trim( $part );&nbsp;</div></li><li><div>                $part = str_replace( '%page%', $page, $part );&nbsp;</div></li><li><div>                $this-&gt;log( &quot;paged_title() [$title] [$part]&quot; );&nbsp;</div></li><li><div>                $title .= $part;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $title;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $message&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function log( $message ) {&nbsp;</div></li><li><div>        if ( $this-&gt;do_log ) {&nbsp;</div></li><li><div>            @error_log( date( 'Y-m-d H:i:s' ) . ' ' . $message . &quot;\n&quot;, 3, $this-&gt;log_file );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $title&nbsp;</div></li><li><div>     * @param string $category&nbsp;</div></li><li><div>     * @param null $p&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function apply_post_title_format( $title, $category = '', $p = null ) {&nbsp;</div></li><li><div>        if ( $p === null ) {&nbsp;</div></li><li><div>            global $post;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $post = $p;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $title_format = $this-&gt;get_post_title_format( 'post', $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $this-&gt;title_placeholder_helper( $title, $post, 'post', $title_format, $category );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param string $title_type&nbsp;</div></li><li><div>     * @param null $p&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return bool|string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_post_title_format( $title_type = 'post', $p = null ) {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        if ( ( $title_type != 'post' ) && ( $title_type != 'archive' ) ) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $title_format = &quot;%{$title_type}_title% | %blog_title%&quot;;&nbsp;</div></li><li><div>        if ( isset( $aioseop_options[&quot;aiosp_{$title_type}_title_format&quot;] ) ) {&nbsp;</div></li><li><div>            $title_format = $aioseop_options[&quot;aiosp_{$title_type}_title_format&quot;];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_enablecpost'] ) && ! empty( $aioseop_options['aiosp_cpostactive'] ) ) {&nbsp;</div></li><li><div>            $wp_post_types = $aioseop_options['aiosp_cpostactive'];&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_cposttitles'] ) ) {&nbsp;</div></li><li><div>                if ( ( ( $title_type == 'archive' ) && is_post_type_archive( $wp_post_types ) && $prefix = &quot;aiosp_{$title_type}_&quot; ) ||&nbsp;</div></li><li><div>                     ( ( $title_type == 'post' ) && $this-&gt;is_singular( $wp_post_types, $p ) && $prefix = 'aiosp_' )&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>                    $post_type = get_post_type( $p );&nbsp;</div></li><li><div>                    if ( ! empty( $aioseop_options[&quot;{$prefix}{$post_type}_title_format&quot;] ) ) {&nbsp;</div></li><li><div>                        $title_format = $aioseop_options[&quot;{$prefix}{$post_type}_title_format&quot;];&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $title_format;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param array $post_types&nbsp;</div></li><li><div>     * @param null $post&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return bool&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function is_singular( $post_types = array(), $post = null ) {&nbsp;</div></li><li><div>        if ( ! empty( $post_types ) && is_object( $post ) ) {&nbsp;</div></li><li><div>            return in_array( $post-&gt;post_type, (array) $post_types );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            return is_singular( $post_types );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return bool|null&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function is_static_posts_page() {&nbsp;</div></li><li><div>        static $is_posts_page = null;&nbsp;</div></li><li><div>        if ( $is_posts_page !== null ) {&nbsp;</div></li><li><div>            return $is_posts_page;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $post = $this-&gt;get_queried_object();&nbsp;</div></li><li><div>        $is_posts_page = ( get_option( 'show_on_front' ) == 'page' && is_home() && ! empty( $post ) && $post-&gt;ID == get_option( 'page_for_posts' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $is_posts_page;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return bool|null&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function is_static_front_page() {&nbsp;</div></li><li><div>        if ( isset( $this-&gt;is_front_page ) && $this-&gt;is_front_page !== null ) {&nbsp;</div></li><li><div>            return $this-&gt;is_front_page;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $post = $this-&gt;get_queried_object();&nbsp;</div></li><li><div>        $this-&gt;is_front_page = ( get_option( 'show_on_front' ) == 'page' && is_page() && ! empty( $post ) && $post-&gt;ID == get_option( 'page_on_front' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $this-&gt;is_front_page;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param int $id&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_all_categories( $id = 0 ) {&nbsp;</div></li><li><div>        $keywords = array();&nbsp;</div></li><li><div>        $categories = get_the_category( $id );&nbsp;</div></li><li><div>        if ( ! empty( $categories ) ) {&nbsp;</div></li><li><div>            foreach ( $categories as $category ) {&nbsp;</div></li><li><div>                $keywords[] = $this-&gt;internationalize( $category-&gt;cat_name );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $keywords;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param string $tax&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_tax_title( $tax = '' ) {&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            if ( empty( $this-&gt;meta_opts ) ) {&nbsp;</div></li><li><div>                $this-&gt;meta_opts = $this-&gt;get_current_options( array(), 'aiosp' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( empty( $tax ) ) {&nbsp;</div></li><li><div>            if ( is_category() ) {&nbsp;</div></li><li><div>                $tax = 'category';&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $tax = get_query_var( 'taxonomy' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $name = $this-&gt;get_tax_name( $tax );&nbsp;</div></li><li><div>        $desc = $this-&gt;get_tax_desc( $tax );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $this-&gt;apply_tax_title_format( $name, $desc, $tax );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // Handle prev / next links.&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $tax&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed|void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_tax_name( $tax ) {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            $opts = $this-&gt;meta_opts;&nbsp;</div></li><li><div>            if ( ! empty( $opts ) ) {&nbsp;</div></li><li><div>                $name = $opts['aiosp_title'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $name = '';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( empty( $name ) ) {&nbsp;</div></li><li><div>            $name = single_term_title( '', false );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // Apparently we're already ucwordsing this elsewhere, and doing it a second time messes it up... why aren't we just doing this at the end?&nbsp;</div></li><li><div>        //        if ( ( $tax == 'category' ) && ( !empty( $aioseop_options['aiosp_cap_cats'] ) ) )&nbsp;</div></li><li><div>        //                $name = $this-&gt;ucwords( $name );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $this-&gt;internationalize( $name );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $tax&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed|void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_tax_desc( $tax ) {&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            $opts = $this-&gt;meta_opts;&nbsp;</div></li><li><div>            if ( ! empty( $opts ) ) {&nbsp;</div></li><li><div>                $desc = $opts['aiosp_description'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $desc = '';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( empty( $desc ) ) {&nbsp;</div></li><li><div>            $desc = term_description( '', $tax );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $this-&gt;internationalize( $desc );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $category_name&nbsp;</div></li><li><div>     * @param $category_description&nbsp;</div></li><li><div>     * @param string $tax&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function apply_tax_title_format( $category_name, $category_description, $tax = '' ) {&nbsp;</div></li><li><div>        if ( empty( $tax ) ) {&nbsp;</div></li><li><div>            $tax = get_query_var( 'taxonomy' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $title_format = $this-&gt;get_tax_title_format( $tax );&nbsp;</div></li><li><div>        $title = str_replace( '%taxonomy_title%', $category_name, $title_format );&nbsp;</div></li><li><div>        if ( strpos( $title, '%taxonomy_description%' ) !== false ) {&nbsp;</div></li><li><div>            $title = str_replace( '%taxonomy_description%', $category_description, $title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( strpos( $title, '%category_title%' ) !== false ) {&nbsp;</div></li><li><div>            $title = str_replace( '%category_title%', $category_name, $title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( strpos( $title, '%category_description%' ) !== false ) {&nbsp;</div></li><li><div>            $title = str_replace( '%category_description%', $category_description, $title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( strpos( $title, '%blog_title%' ) !== false ) {&nbsp;</div></li><li><div>            $title = str_replace( '%blog_title%', $this-&gt;internationalize( get_bloginfo( 'name' ) ), $title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( strpos( $title, '%blog_description%' ) !== false ) {&nbsp;</div></li><li><div>            $title = str_replace( '%blog_description%', $this-&gt;internationalize( get_bloginfo( 'description' ) ), $title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $title = wp_strip_all_tags( $title );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $this-&gt;paged_title( $title );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param string $tax&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_tax_title_format( $tax = '' ) {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            $title_format = '%taxonomy_title% | %blog_title%';&nbsp;</div></li><li><div>            if ( is_category() ) {&nbsp;</div></li><li><div>                $title_format = $aioseop_options['aiosp_category_title_format'];&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $taxes = $aioseop_options['aiosp_taxactive'];&nbsp;</div></li><li><div>                if ( empty( $tax ) ) {&nbsp;</div></li><li><div>                    $tax = get_query_var( 'taxonomy' );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( ! empty( $aioseop_options[&quot;aiosp_{$tax}_tax_title_format&quot;] ) ) {&nbsp;</div></li><li><div>                    $title_format = $aioseop_options[&quot;aiosp_{$tax}_tax_title_format&quot;];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $title_format ) ) {&nbsp;</div></li><li><div>                $title_format = '%category_title% | %blog_title%';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $title_format = '%category_title% | %blog_title%';&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_category_title_format'] ) ) {&nbsp;</div></li><li><div>                $title_format = $aioseop_options['aiosp_category_title_format'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return $title_format;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $title_format;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $title&nbsp;</div></li><li><div>     * @param string $category&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function apply_archive_title_format( $title, $category = '' ) {&nbsp;</div></li><li><div>        $title_format = $this-&gt;get_archive_title_format();&nbsp;</div></li><li><div>        $r_title = array( '%blog_title%', '%blog_description%', '%archive_title%' );&nbsp;</div></li><li><div>        $d_title = array(&nbsp;</div></li><li><div>            $this-&gt;internationalize( get_bloginfo( 'name' ) ), &nbsp;</div></li><li><div>            $this-&gt;internationalize( get_bloginfo( 'description' ) ), &nbsp;</div></li><li><div>            post_type_archive_title( '', false ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        $title = trim( str_replace( $r_title, $d_title, $title_format ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $title;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return bool|string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_archive_title_format() {&nbsp;</div></li><li><div>        return $this-&gt;get_post_title_format( 'archive' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param null $post&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed|string|void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_main_description( $post = null ) {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        $opts = $this-&gt;meta_opts;&nbsp;</div></li><li><div>        $description = '';&nbsp;</div></li><li><div>        if ( is_author() && $this-&gt;show_page_description() ) {&nbsp;</div></li><li><div>            $description = $this-&gt;internationalize( get_the_author_meta( 'description' ) );&nbsp;</div></li><li><div>        } else if ( function_exists( 'woocommerce_get_page_id' ) && is_post_type_archive( 'product' ) && ( $post_id = woocommerce_get_page_id( 'shop' ) ) && ( $post = get_post( $post_id ) ) ) {&nbsp;</div></li><li><div>            // $description = $this-&gt;get_post_description( $post );&nbsp;</div></li><li><div>            // $description = $this-&gt;apply_cf_fields( $description );&nbsp;</div></li><li><div>            if ( ! ( woocommerce_get_page_id( 'shop' ) == get_option( 'page_on_front' ) ) ) {&nbsp;</div></li><li><div>                $description = trim( $this-&gt;internationalize( get_post_meta( $post-&gt;ID, '_aioseop_description', true ) ) );&nbsp;</div></li><li><div>            } else if ( woocommerce_get_page_id( 'shop' ) == get_option( 'page_on_front' ) && ! empty( $aioseop_options['aiosp_use_static_home_info'] ) ) {&nbsp;</div></li><li><div>                // $description = $this-&gt;get_aioseop_description( $post );&nbsp;</div></li><li><div>                $description = trim( $this-&gt;internationalize( get_post_meta( $post-&gt;ID, '_aioseop_description', true ) ) );&nbsp;</div></li><li><div>            } else if ( woocommerce_get_page_id( 'shop' ) == get_option( 'page_on_front' ) && empty( $aioseop_options['aiosp_use_static_home_info'] ) ) {&nbsp;</div></li><li><div>                $description = $this-&gt;get_aioseop_description( $post );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else if ( is_front_page() ) {&nbsp;</div></li><li><div>            $description = $this-&gt;get_aioseop_description( $post );&nbsp;</div></li><li><div>        } else if ( is_single() || is_page() || is_attachment() || is_home() || $this-&gt;is_static_posts_page() ) {&nbsp;</div></li><li><div>            $description = $this-&gt;get_aioseop_description( $post );&nbsp;</div></li><li><div>        } else if ( ( is_category() || is_tag() || is_tax() ) && $this-&gt;show_page_description() ) {&nbsp;</div></li><li><div>            if ( ! empty( $opts ) && AIOSEOPPRO ) {&nbsp;</div></li><li><div>                $description = $opts['aiosp_description'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $description ) ) {&nbsp;</div></li><li><div>                $description = term_description();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $description = $this-&gt;internationalize( $description );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( empty( $aioseop_options['aiosp_dont_truncate_descriptions'] ) ) {&nbsp;</div></li><li><div>            $description = $this-&gt;trim_excerpt_without_filters( $description );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $description;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return bool&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function show_page_description() {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_hide_paginated_descriptions'] ) ) {&nbsp;</div></li><li><div>            $page = $this-&gt;get_page_number();&nbsp;</div></li><li><div>            if ( ! empty( $page ) && ( $page &gt; 1 ) ) {&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return true;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_page_number() {&nbsp;</div></li><li><div>        $page = get_query_var( 'page' );&nbsp;</div></li><li><div>        if ( empty( $page ) ) {&nbsp;</div></li><li><div>            $page = get_query_var( 'paged' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $page;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param null $post&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed|string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_aioseop_description( $post = null ) {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        if ( null === $post ) {&nbsp;</div></li><li><div>            $post = $GLOBALS['post'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $blog_page = aiosp_common::get_blog_page();&nbsp;</div></li><li><div>        $description = '';&nbsp;</div></li><li><div>        if ( is_front_page() && empty( $aioseop_options['aiosp_use_static_home_info'] ) ) {&nbsp;</div></li><li><div>            $description = trim( $this-&gt;internationalize( $aioseop_options['aiosp_home_description'] ) );&nbsp;</div></li><li><div>        } elseif ( ! empty( $blog_page ) ) {&nbsp;</div></li><li><div>            $description = $this-&gt;get_post_description( $blog_page );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( empty( $description ) && is_object( $post ) && ! is_archive() && empty( $blog_page ) ) {&nbsp;</div></li><li><div>            $description = $this-&gt;get_post_description( $post );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $description = $this-&gt;apply_cf_fields( $description );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $description;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $post&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed|string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_post_description( $post ) {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        $description = '';&nbsp;</div></li><li><div>        if ( ! $this-&gt;show_page_description() ) {&nbsp;</div></li><li><div>            return '';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $description = trim( $this-&gt;internationalize( get_post_meta( $post-&gt;ID, '_aioseop_description', true ) ) );&nbsp;</div></li><li><div>        if ( ! empty( $post ) && post_password_required( $post ) ) {&nbsp;</div></li><li><div>            return $description;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( ! $description ) {&nbsp;</div></li><li><div>            if ( empty( $aioseop_options['aiosp_skip_excerpt'] ) ) {&nbsp;</div></li><li><div>                $description = $this-&gt;trim_excerpt_without_filters_full_length( $this-&gt;internationalize( $post-&gt;post_excerpt ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! $description && isset( $aioseop_options['aiosp_generate_descriptions'] ) && $aioseop_options['aiosp_generate_descriptions'] ) {&nbsp;</div></li><li><div>                $content = $post-&gt;post_content;&nbsp;</div></li><li><div>                if ( ! empty( $aioseop_options['aiosp_run_shortcodes'] ) ) {&nbsp;</div></li><li><div>                    $content = do_shortcode( $content );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $content = wp_strip_all_tags( $content );&nbsp;</div></li><li><div>                $description = $this-&gt;trim_excerpt_without_filters( $this-&gt;internationalize( $content ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Internal whitespace trim.&nbsp;</div></li><li><div>        $description = preg_replace( '/\s\s+/u', ' ', $description );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $description;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $text&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function trim_excerpt_without_filters_full_length( $text ) {&nbsp;</div></li><li><div>        $text = str_replace( ']]&gt;', ']]&gt;', $text );&nbsp;</div></li><li><div>        $text = preg_replace( '|\[(.+?)\](.+?\[/\\1\])?|s', '', $text );&nbsp;</div></li><li><div>        $text = wp_strip_all_tags( $text );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return trim( $text );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $text&nbsp;</div></li><li><div>     * @param int $max&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function trim_excerpt_without_filters( $text, $max = 0 ) {&nbsp;</div></li><li><div>        $text = str_replace( ']]&gt;', ']]&gt;', $text );&nbsp;</div></li><li><div>        $text = preg_replace( '|\[(.+?)\](.+?\[/\\1\])?|s', '', $text );&nbsp;</div></li><li><div>        $text = wp_strip_all_tags( $text );&nbsp;</div></li><li><div>        // Treat other common word-break characters like a space.&nbsp;</div></li><li><div>        $text2 = preg_replace( '/[, ._\-=+&!\?;:*]/s', ' ', $text );&nbsp;</div></li><li><div>        if ( ! $max ) {&nbsp;</div></li><li><div>            $max = $this-&gt;maximum_description_length;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $max_orig = $max;&nbsp;</div></li><li><div>        $len = $this-&gt;strlen( $text2 );&nbsp;</div></li><li><div>        if ( $max &lt; $len ) {&nbsp;</div></li><li><div>            if ( function_exists( 'mb_strrpos' ) ) {&nbsp;</div></li><li><div>                $pos = mb_strrpos( $text2, ' ', - ( $len - $max ) );&nbsp;</div></li><li><div>                if ( false === $pos ) {&nbsp;</div></li><li><div>                    $pos = $max;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( $pos &gt; $this-&gt;minimum_description_length ) {&nbsp;</div></li><li><div>                    $max = $pos;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $max = $this-&gt;minimum_description_length;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                while ( ' ' != $text2[ $max ] && $max &gt; $this-&gt;minimum_description_length ) {&nbsp;</div></li><li><div>                    $max --;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Probably no valid chars to break on?&nbsp;</div></li><li><div>            if ( $len &gt; $max_orig && $max &lt; intval( $max_orig / 2 ) ) {&nbsp;</div></li><li><div>                $max = $max_orig;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $text = $this-&gt;substr( $text, 0, $max );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return trim( $text );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $query&nbsp;</div></li><li><div>     * @param bool $show_page&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return bool|false|string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function aiosp_mrt_get_url( $query, $show_page = true ) {&nbsp;</div></li><li><div>        if ( $query-&gt;is_404 || $query-&gt;is_search ) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $link = '';&nbsp;</div></li><li><div>        $haspost = count( $query-&gt;posts ) &gt; 0;&nbsp;</div></li><li><div>        if ( get_query_var( 'm' ) ) {&nbsp;</div></li><li><div>            $m = preg_replace( '/[^0-9]/', '', get_query_var( 'm' ) );&nbsp;</div></li><li><div>            switch ( $this-&gt;strlen( $m ) ) {&nbsp;</div></li><li><div>                case 4:&nbsp;</div></li><li><div>                    $link = get_year_link( $m );&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 6:&nbsp;</div></li><li><div>                    $link = get_month_link( $this-&gt;substr( $m, 0, 4 ), $this-&gt;substr( $m, 4, 2 ) );&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 8:&nbsp;</div></li><li><div>                    $link = get_day_link( $this-&gt;substr( $m, 0, 4 ), $this-&gt;substr( $m, 4, 2 ), $this-&gt;substr( $m, 6, 2 ) );&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                default:&nbsp;</div></li><li><div>                    return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } elseif ( $query-&gt;is_home && ( get_option( 'show_on_front' ) == 'page' ) && ( $pageid = get_option( 'page_for_posts' ) ) ) {&nbsp;</div></li><li><div>            $link = get_permalink( $pageid );&nbsp;</div></li><li><div>        } elseif ( is_front_page() || ( $query-&gt;is_home && ( get_option( 'show_on_front' ) != 'page' || ! get_option( 'page_for_posts' ) ) ) ) {&nbsp;</div></li><li><div>            if ( function_exists( 'icl_get_home_url' ) ) {&nbsp;</div></li><li><div>                $link = icl_get_home_url();&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $link = trailingslashit( home_url() );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } elseif ( ( $query-&gt;is_single || $query-&gt;is_page ) && $haspost ) {&nbsp;</div></li><li><div>            $post = $query-&gt;posts[0];&nbsp;</div></li><li><div>            $link = get_permalink( $post-&gt;ID );&nbsp;</div></li><li><div>        } elseif ( $query-&gt;is_author && $haspost ) {&nbsp;</div></li><li><div>            $author = get_userdata( get_query_var( 'author' ) );&nbsp;</div></li><li><div>            if ( false === $author ) {&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $link = get_author_posts_url( $author-&gt;ID, $author-&gt;user_nicename );&nbsp;</div></li><li><div>        } elseif ( $query-&gt;is_category && $haspost ) {&nbsp;</div></li><li><div>            $link = get_category_link( get_query_var( 'cat' ) );&nbsp;</div></li><li><div>        } elseif ( $query-&gt;is_tag && $haspost ) {&nbsp;</div></li><li><div>            $tag = get_term_by( 'slug', get_query_var( 'tag' ), 'post_tag' );&nbsp;</div></li><li><div>            if ( ! empty( $tag-&gt;term_id ) ) {&nbsp;</div></li><li><div>                $link = get_tag_link( $tag-&gt;term_id );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } elseif ( $query-&gt;is_day && $haspost ) {&nbsp;</div></li><li><div>            $link = get_day_link( get_query_var( 'year' ), &nbsp;</div></li><li><div>                get_query_var( 'monthnum' ), &nbsp;</div></li><li><div>                get_query_var( 'day' ) );&nbsp;</div></li><li><div>        } elseif ( $query-&gt;is_month && $haspost ) {&nbsp;</div></li><li><div>            $link = get_month_link( get_query_var( 'year' ), &nbsp;</div></li><li><div>                get_query_var( 'monthnum' ) );&nbsp;</div></li><li><div>        } elseif ( $query-&gt;is_year && $haspost ) {&nbsp;</div></li><li><div>            $link = get_year_link( get_query_var( 'year' ) );&nbsp;</div></li><li><div>        } elseif ( $query-&gt;is_tax && $haspost ) {&nbsp;</div></li><li><div>            $taxonomy = get_query_var( 'taxonomy' );&nbsp;</div></li><li><div>            $term = get_query_var( 'term' );&nbsp;</div></li><li><div>            if ( ! empty( $term ) ) {&nbsp;</div></li><li><div>                $link = get_term_link( $term, $taxonomy );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } elseif ( $query-&gt;is_archive && function_exists( 'get_post_type_archive_link' ) && ( $post_type = get_query_var( 'post_type' ) ) ) {&nbsp;</div></li><li><div>            if ( is_array( $post_type ) ) {&nbsp;</div></li><li><div>                $post_type = reset( $post_type );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $link = get_post_type_archive_link( $post_type );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( empty( $link ) || ! is_string( $link ) ) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( apply_filters( 'aioseop_canonical_url_pagination', $show_page ) ) {&nbsp;</div></li><li><div>            $link = $this-&gt;get_paged( $link );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( ! empty( $link ) ) {&nbsp;</div></li><li><div>            global $aioseop_options;&nbsp;</div></li><li><div>            if ( isset( $aioseop_options['aiosp_can_set_protocol'] ) && ( 'auto' !== $aioseop_options['aiosp_can_set_protocol'] ) ) {&nbsp;</div></li><li><div>                if ( 'http' === $aioseop_options['aiosp_can_set_protocol'] ) {&nbsp;</div></li><li><div>                    $link = preg_replace( '/^https:/i', 'http:', $link );&nbsp;</div></li><li><div>                } elseif ( 'https' === $aioseop_options['aiosp_can_set_protocol'] ) {&nbsp;</div></li><li><div>                    $link = preg_replace( '/^http:/i', 'https:', $link );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $link;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $link&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_paged( $link ) {&nbsp;</div></li><li><div>        global $wp_rewrite;&nbsp;</div></li><li><div>        $page = $this-&gt;get_page_number();&nbsp;</div></li><li><div>        $page_name = 'page';&nbsp;</div></li><li><div>        if ( ! empty( $wp_rewrite ) && ! empty( $wp_rewrite-&gt;pagination_base ) ) {&nbsp;</div></li><li><div>            $page_name = $wp_rewrite-&gt;pagination_base;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( ! empty( $page ) && $page &gt; 1 ) {&nbsp;</div></li><li><div>            if ( $page == get_query_var( 'page' ) ) {&nbsp;</div></li><li><div>                $link = trailingslashit( $link ) . &quot;$page&quot;;&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $link = trailingslashit( $link ) . trailingslashit( $page_name ) . $page;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $link = user_trailingslashit( $link, 'paged' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $link;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return comma|string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_main_keywords() {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        global $aioseop_keywords;&nbsp;</div></li><li><div>        global $post;&nbsp;</div></li><li><div>        $opts = $this-&gt;meta_opts;&nbsp;</div></li><li><div>        if ( ( is_front_page() && $aioseop_options['aiosp_home_keywords'] && ! $this-&gt;is_static_posts_page() ) || $this-&gt;is_static_front_page() ) {&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_use_static_home_info'] ) ) {&nbsp;</div></li><li><div>                $keywords = $this-&gt;get_all_keywords();&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $keywords = trim( $this-&gt;internationalize( $aioseop_options['aiosp_home_keywords'] ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } elseif ( empty( $aioseop_options['aiosp_dynamic_postspage_keywords'] ) && $this-&gt;is_static_posts_page() ) {&nbsp;</div></li><li><div>            $keywords = stripslashes( $this-&gt;internationalize( $opts['aiosp_keywords'] ) ); // And if option = use page set keywords instead of keywords from recent posts.&nbsp;</div></li><li><div>        } elseif ( ( $blog_page = aiosp_common::get_blog_page( $post ) ) && empty( $aioseop_options['aiosp_dynamic_postspage_keywords'] ) ) {&nbsp;</div></li><li><div>            $keywords = stripslashes( $this-&gt;internationalize( get_post_meta( $blog_page-&gt;ID, '_aioseop_keywords', true ) ) );&nbsp;</div></li><li><div>        } elseif ( empty( $aioseop_options['aiosp_dynamic_postspage_keywords'] ) && ( is_archive() || is_post_type_archive() ) ) {&nbsp;</div></li><li><div>            $keywords = '';&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $keywords = $this-&gt;get_all_keywords();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $keywords;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return comma-separated list of unique keywords&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_all_keywords() {&nbsp;</div></li><li><div>        global $posts;&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        if ( is_404() ) {&nbsp;</div></li><li><div>            return null;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // If we are on synthetic pages.&nbsp;</div></li><li><div>        if ( ! is_home() && ! is_page() && ! is_single() && ! $this-&gt;is_static_front_page() && ! $this-&gt;is_static_posts_page() && ! is_archive() && ! is_post_type_archive() && ! is_category() && ! is_tag() && ! is_tax() ) {&nbsp;</div></li><li><div>            return null;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $keywords = array();&nbsp;</div></li><li><div>        $opts = $this-&gt;meta_opts;&nbsp;</div></li><li><div>        if ( ! empty( $opts['aiosp_keywords'] ) ) {&nbsp;</div></li><li><div>            $traverse = $this-&gt;keyword_string_to_list( $this-&gt;internationalize( $opts['aiosp_keywords'] ) );&nbsp;</div></li><li><div>            if ( ! empty( $traverse ) ) {&nbsp;</div></li><li><div>                foreach ( $traverse as $keyword ) {&nbsp;</div></li><li><div>                    $keywords[] = $keyword;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( empty( $posts ) ) {&nbsp;</div></li><li><div>            global $post;&nbsp;</div></li><li><div>            $post_arr = array( $post );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $post_arr = $posts;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( is_array( $post_arr ) ) {&nbsp;</div></li><li><div>            $postcount = count( $post_arr );&nbsp;</div></li><li><div>            foreach ( $post_arr as $p ) {&nbsp;</div></li><li><div>                if ( $p ) {&nbsp;</div></li><li><div>                    $id = $p-&gt;ID;&nbsp;</div></li><li><div>                    if ( 1 == $postcount || ! empty( $aioseop_options['aiosp_dynamic_postspage_keywords'] ) ) {&nbsp;</div></li><li><div>                        // Custom field keywords.&nbsp;</div></li><li><div>                        $keywords_i = null;&nbsp;</div></li><li><div>                        $keywords_i = stripslashes( $this-&gt;internationalize( get_post_meta( $id, '_aioseop_keywords', true ) ) );&nbsp;</div></li><li><div>                        if ( is_attachment() ) {&nbsp;</div></li><li><div>                            $id = $p-&gt;post_parent;&nbsp;</div></li><li><div>                            if ( empty( $keywords_i ) ) {&nbsp;</div></li><li><div>                                $keywords_i = stripslashes( $this-&gt;internationalize( get_post_meta( $id, '_aioseop_keywords', true ) ) );&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        $traverse = $this-&gt;keyword_string_to_list( $keywords_i );&nbsp;</div></li><li><div>                        if ( ! empty( $traverse ) ) {&nbsp;</div></li><li><div>                            foreach ( $traverse as $keyword ) {&nbsp;</div></li><li><div>                                $keywords[] = $keyword;&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( ! empty( $aioseop_options['aiosp_use_tags_as_keywords'] ) ) {&nbsp;</div></li><li><div>                        $keywords = array_merge( $keywords, $this-&gt;get_all_tags( $id ) );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    // Autometa.&nbsp;</div></li><li><div>                    $autometa = stripslashes( get_post_meta( $id, 'autometa', true ) );&nbsp;</div></li><li><div>                    if ( isset( $autometa ) && ! empty( $autometa ) ) {&nbsp;</div></li><li><div>                        $autometa_array = explode( ' ', $autometa );&nbsp;</div></li><li><div>                        foreach ( $autometa_array as $e ) {&nbsp;</div></li><li><div>                            $keywords[] = $e;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( isset( $aioseop_options['aiosp_use_categories'] ) && $aioseop_options['aiosp_use_categories'] && ! is_page() ) {&nbsp;</div></li><li><div>                        $keywords = array_merge( $keywords, $this-&gt;get_all_categories( $id ) );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $this-&gt;get_unique_keywords( $keywords );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $keywords&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function keyword_string_to_list( $keywords ) {&nbsp;</div></li><li><div>        $traverse = array();&nbsp;</div></li><li><div>        $keywords_i = str_replace( '&quot;', '', $keywords );&nbsp;</div></li><li><div>        if ( isset( $keywords_i ) && ! empty( $keywords_i ) ) {&nbsp;</div></li><li><div>            $traverse = explode( ', ', $keywords_i );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $traverse;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param int $id&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_all_tags( $id = 0 ) {&nbsp;</div></li><li><div>        $keywords = array();&nbsp;</div></li><li><div>        $tags = get_the_tags( $id );&nbsp;</div></li><li><div>        if ( ! empty( $tags ) && is_array( $tags ) ) {&nbsp;</div></li><li><div>            foreach ( $tags as $tag ) {&nbsp;</div></li><li><div>                $keywords[] = $this-&gt;internationalize( $tag-&gt;name );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // Ultimate Tag Warrior integration.&nbsp;</div></li><li><div>        global $utw;&nbsp;</div></li><li><div>        if ( $utw ) {&nbsp;</div></li><li><div>            $tags = $utw-&gt;GetTagsForPost( $p );&nbsp;</div></li><li><div>            if ( is_array( $tags ) ) {&nbsp;</div></li><li><div>                foreach ( $tags as $tag ) {&nbsp;</div></li><li><div>                    $tag = $tag-&gt;tag;&nbsp;</div></li><li><div>                    $tag = str_replace( '_', ' ', $tag );&nbsp;</div></li><li><div>                    $tag = str_replace( '-', ' ', $tag );&nbsp;</div></li><li><div>                    $tag = stripslashes( $tag );&nbsp;</div></li><li><div>                    $keywords[] = $tag;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $keywords;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $keywords&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_unique_keywords( $keywords ) {&nbsp;</div></li><li><div>        return implode( ', ', $this-&gt;clean_keyword_list( $keywords ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $keywords&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function clean_keyword_list( $keywords ) {&nbsp;</div></li><li><div>        $small_keywords = array();&nbsp;</div></li><li><div>        if ( ! is_array( $keywords ) ) {&nbsp;</div></li><li><div>            $keywords = $this-&gt;keyword_string_to_list( $keywords );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( ! empty( $keywords ) ) {&nbsp;</div></li><li><div>            foreach ( $keywords as $word ) {&nbsp;</div></li><li><div>                $small_keywords[] = trim( $this-&gt;strtolower( $word ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return array_unique( $small_keywords );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $term_id&nbsp;</div></li><li><div>     * @param $new_term_id&nbsp;</div></li><li><div>     * @param string $term_taxonomy_id&nbsp;</div></li><li><div>     * @param string $taxonomy&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function split_shared_term( $term_id, $new_term_id, $term_taxonomy_id = '', $taxonomy = '' ) {&nbsp;</div></li><li><div>        $terms = $this-&gt;get_all_term_data( $term_id );&nbsp;</div></li><li><div>        if ( ! empty( $terms ) ) {&nbsp;</div></li><li><div>            $new_terms = $this-&gt;get_all_term_data( $new_term_id );&nbsp;</div></li><li><div>            if ( empty( $new_terms ) ) {&nbsp;</div></li><li><div>                foreach ( $terms as $k =&gt; $v ) {&nbsp;</div></li><li><div>                    add_term_meta( $new_term_id, $k, $v, true );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                add_term_meta( $term_id, '_aioseop_term_was_split', true, true );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $term_id&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_all_term_data( $term_id ) {&nbsp;</div></li><li><div>        $terms = array();&nbsp;</div></li><li><div>        $optlist = array(&nbsp;</div></li><li><div>            'keywords', &nbsp;</div></li><li><div>            'description', &nbsp;</div></li><li><div>            'title', &nbsp;</div></li><li><div>            'custom_link', &nbsp;</div></li><li><div>            'sitemap_exclude', &nbsp;</div></li><li><div>            'disable', &nbsp;</div></li><li><div>            'disable_analytics', &nbsp;</div></li><li><div>            'noindex', &nbsp;</div></li><li><div>            'nofollow', &nbsp;</div></li><li><div>            'noodp', &nbsp;</div></li><li><div>            'noydir', &nbsp;</div></li><li><div>            'titleatr', &nbsp;</div></li><li><div>            'menulabel', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        foreach ( $optlist as $f ) {&nbsp;</div></li><li><div>            $meta = get_term_meta( $term_id, '_aioseop_' . $f, true );&nbsp;</div></li><li><div>            if ( ! empty( $meta ) ) {&nbsp;</div></li><li><div>                $terms[ '_aioseop_' . $f ] = $meta;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $terms;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function add_page_icon() {&nbsp;</div></li><li><div>        wp_enqueue_script( 'wp-pointer', false, array( 'jquery' ) );&nbsp;</div></li><li><div>        wp_enqueue_style( 'wp-pointer' );&nbsp;</div></li><li><div>        $this-&gt;add_admin_pointers();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        wp_enqueue_style( 'aiosp_admin_style', AIOSEOP_PLUGIN_URL . 'css/aiosp_admin.css' );&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;script&gt;&nbsp;</div></li><li><div>            function aioseop_show_pointer(handle, value) {&nbsp;</div></li><li><div>                if (typeof( jQuery ) != 'undefined') {&nbsp;</div></li><li><div>                    var p_edge = 'bottom';&nbsp;</div></li><li><div>                    var p_align = 'center';&nbsp;</div></li><li><div>                    if (typeof( jQuery(value.pointer_target).pointer) != 'undefined') {&nbsp;</div></li><li><div>                        if (typeof( value.pointer_edge ) != 'undefined') p_edge = value.pointer_edge;&nbsp;</div></li><li><div>                        if (typeof( value.pointer_align ) != 'undefined') p_align = value.pointer_align;&nbsp;</div></li><li><div>                        jQuery(value.pointer_target).pointer({&nbsp;</div></li><li><div>                            content: value.pointer_text, &nbsp;</div></li><li><div>                            position: {&nbsp;</div></li><li><div>                                edge: p_edge, &nbsp;</div></li><li><div>                                align: p_align&nbsp;</div></li><li><div>                            }, &nbsp;</div></li><li><div>                            close: function () {&nbsp;</div></li><li><div>                                jQuery.post(ajaxurl, {&nbsp;</div></li><li><div>                                    pointer: handle, &nbsp;</div></li><li><div>                                    action: 'dismiss-wp-pointer'&nbsp;</div></li><li><div>                                });&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }).pointer('open');&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>            if ( ! empty( $this-&gt;pointers ) ) {&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>            if (typeof( jQuery ) != 'undefined') {&nbsp;</div></li><li><div>                jQuery(document).ready(function () {&nbsp;</div></li><li><div>                    var admin_pointer;&nbsp;</div></li><li><div>                    var admin_index;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    foreach ( $this-&gt;pointers as $k =&gt; $p )&nbsp;</div></li><li><div>                        {if ( ! empty( $p['pointer_scope'] ) && ( 'global' === $p['pointer_scope'] ) ) {&nbsp;</div></li><li><div>                        ?&gt;admin_index = &quot;&lt;?php echo esc_attr( $k ); ?&gt;&quot;;&nbsp;</div></li><li><div>                    admin_pointer = &lt;?php echo json_encode( $p ); ?&gt;;&nbsp;</div></li><li><div>                    aioseop_show_pointer(admin_index, admin_pointer);&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    }    ?&gt;&nbsp;</div></li><li><div>                });&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            &lt;?php    }    ?&gt;&nbsp;</div></li><li><div>        &lt;/script&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function add_admin_pointers() {&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            $this-&gt;pointers['aioseop_menu_236'] = array(&nbsp;</div></li><li><div>                'pointer_target' =&gt; '#toplevel_page_all-in-one-seo-pack-pro-aioseop_class', &nbsp;</div></li><li><div>                'pointer_text' =&gt; '&lt;h3&gt;' . sprintf( __( 'Welcome to Version %s!', 'all-in-one-seo-pack' ), AIOSEOP_VERSION )&nbsp;</div></li><li><div>                                    . '&lt;/h3&gt;&lt;p&gt;' . __( 'Thank you for running the latest and greatest All in One SEO Pack Pro ever! Please review your settings, as we\'re always adding new features for you!', 'all-in-one-seo-pack' ) . '&lt;/p&gt;', &nbsp;</div></li><li><div>                'pointer_edge' =&gt; 'top', &nbsp;</div></li><li><div>                'pointer_align' =&gt; 'left', &nbsp;</div></li><li><div>                'pointer_scope' =&gt; 'global', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            $this-&gt;pointers['aioseop_welcome_230'] = array(&nbsp;</div></li><li><div>                'pointer_target' =&gt; '#aioseop_top_button', &nbsp;</div></li><li><div>                'pointer_text' =&gt; '&lt;h3&gt;' . sprintf( __( 'Review Your Settings', 'all-in-one-seo-pack' ), AIOSEOP_VERSION )&nbsp;</div></li><li><div>                                    . '&lt;/h3&gt;&lt;p&gt;' . __( 'New in 2.4: Improved support for taxonomies, Woocommerce and massive performance improvements under the hood! Please review your settings on each options page!', 'all-in-one-seo-pack' ) . '&lt;/p&gt;', &nbsp;</div></li><li><div>                'pointer_edge' =&gt; 'bottom', &nbsp;</div></li><li><div>                'pointer_align' =&gt; 'left', &nbsp;</div></li><li><div>                'pointer_scope' =&gt; 'local', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            $this-&gt;filter_pointers();&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $this-&gt;pointers['aioseop_menu_220'] = array(&nbsp;</div></li><li><div>                'pointer_target' =&gt; '#toplevel_page_all-in-one-seo-pack-aioseop_class', &nbsp;</div></li><li><div>                'pointer_text' =&gt; '&lt;h3&gt;' . sprintf( __( 'Welcome to Version %s!', 'all-in-one-seo-pack' ), AIOSEOP_VERSION )&nbsp;</div></li><li><div>                                    . '&lt;/h3&gt;&lt;p&gt;' . __( 'Thank you for running the latest and greatest All in One SEO Pack ever! Please review your settings, as we\'re always adding new features for you!', 'all-in-one-seo-pack' ) . '&lt;/p&gt;', &nbsp;</div></li><li><div>                'pointer_edge' =&gt; 'top', &nbsp;</div></li><li><div>                'pointer_align' =&gt; 'left', &nbsp;</div></li><li><div>                'pointer_scope' =&gt; 'global', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            $this-&gt;pointers['aioseop_welcome_220'] = array(&nbsp;</div></li><li><div>                'pointer_target' =&gt; '#aioseop_top_button', &nbsp;</div></li><li><div>                'pointer_text' =&gt; '&lt;h3&gt;' . sprintf( __( 'Review Your Settings', 'all-in-one-seo-pack' ), AIOSEOP_VERSION )&nbsp;</div></li><li><div>                                    . '&lt;/h3&gt;&lt;p&gt;' . __( 'Thank you for running the latest and greatest All in One SEO Pack ever! New since 2.2: Control who accesses your site with the new Robots.txt Editor and File Editor modules!  Enable them from the Feature Manager.  Remember to review your settings, we have added some new ones!', 'all-in-one-seo-pack' ) . '&lt;/p&gt;', &nbsp;</div></li><li><div>                'pointer_edge' =&gt; 'bottom', &nbsp;</div></li><li><div>                'pointer_align' =&gt; 'left', &nbsp;</div></li><li><div>                'pointer_scope' =&gt; 'local', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            $this-&gt;filter_pointers();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function add_page_hooks() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $post_objs = get_post_types( '', 'objects' );&nbsp;</div></li><li><div>        $pt = array_keys( $post_objs );&nbsp;</div></li><li><div>        $rempost = array( 'revision', 'nav_menu_item' );&nbsp;</div></li><li><div>        $pt = array_diff( $pt, $rempost );&nbsp;</div></li><li><div>        $post_types = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $aiosp_enablecpost = '';&nbsp;</div></li><li><div>        if ( isset( $_REQUEST['aiosp_enablecpost'] ) ) {&nbsp;</div></li><li><div>            $aiosp_enablecpost = $_REQUEST['aiosp_enablecpost'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $pt as $p ) {&nbsp;</div></li><li><div>            if ( ! empty( $post_objs[ $p ]-&gt;label ) ) {&nbsp;</div></li><li><div>                if ( $post_objs[ $p ]-&gt;_builtin && empty( $aioseop_options['aiosp_enablecpost'] ) ) {&nbsp;</div></li><li><div>                    $post_types[ $p ] = $post_objs[ $p ]-&gt;label;&nbsp;</div></li><li><div>                } elseif ( ! empty( $aioseop_options['aiosp_enablecpost'] ) || $aiosp_enablecpost == 'on' ) {&nbsp;</div></li><li><div>                    $post_types[ $p ] = $post_objs[ $p ]-&gt;label;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $post_types[ $p ] = $p;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $pt as $p ) {&nbsp;</div></li><li><div>            if ( ! empty( $post_objs[ $p ]-&gt;label ) ) {&nbsp;</div></li><li><div>                $all_post_types[ $p ] = $post_objs[ $p ]-&gt;label;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $taxes = get_taxonomies( '', 'objects' );&nbsp;</div></li><li><div>        $tx = array_keys( $taxes );&nbsp;</div></li><li><div>        $remtax = array( 'nav_menu', 'link_category', 'post_format' );&nbsp;</div></li><li><div>        $tx = array_diff( $tx, $remtax );&nbsp;</div></li><li><div>        $tax_types = array();&nbsp;</div></li><li><div>        foreach ( $tx as $t ) {&nbsp;</div></li><li><div>            if ( ! empty( $taxes[ $t ]-&gt;label ) ) {&nbsp;</div></li><li><div>                $tax_types[ $t ] = $taxes[ $t ]-&gt;label;&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $taxes[ $t ] = $t;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $this-&gt;default_options['posttypecolumns']['initial_options'] = $post_types;&nbsp;</div></li><li><div>        $this-&gt;default_options['cpostactive']['initial_options'] = $all_post_types;&nbsp;</div></li><li><div>        $this-&gt;default_options['cpostnoindex']['initial_options'] = $post_types;&nbsp;</div></li><li><div>        $this-&gt;default_options['cpostnofollow']['initial_options'] = $post_types;&nbsp;</div></li><li><div>        $this-&gt;default_options['cpostnoodp']['initial_options'] = $post_types;&nbsp;</div></li><li><div>        $this-&gt;default_options['cpostnoydir']['initial_options'] = $post_types;&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            $this-&gt;default_options['taxactive']['initial_options'] = $tax_types;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $this-&gt;default_options['google_author_location']['initial_options'] = $post_types;&nbsp;</div></li><li><div>        $this-&gt;default_options['google_author_location']['initial_options'] = array_merge( array( 'front' =&gt; __( 'Front Page', 'all-in-one-seo-pack' ) ), $post_types, array( 'all' =&gt; __( 'Everywhere Else', 'all-in-one-seo-pack' ) ) );&nbsp;</div></li><li><div>        $this-&gt;default_options['google_author_location']['default'] = array_keys( $this-&gt;default_options['google_author_location']['initial_options'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $post_types as $p =&gt; $pt ) {&nbsp;</div></li><li><div>            $field = $p . '_title_format';&nbsp;</div></li><li><div>            $name = $post_objs[ $p ]-&gt;labels-&gt;singular_name;&nbsp;</div></li><li><div>            if ( ! isset( $this-&gt;default_options[ $field ] ) ) {&nbsp;</div></li><li><div>                $this-&gt;default_options[ $field ] = array(&nbsp;</div></li><li><div>                    'name' =&gt; &quot;$name &quot; . __( 'Title Format:', 'all-in-one-seo-pack' ) . &quot;&lt;br /&gt;($p)&quot;, &nbsp;</div></li><li><div>                    'type' =&gt; 'text', &nbsp;</div></li><li><div>                    'default' =&gt; '%post_title% | %blog_title%', &nbsp;</div></li><li><div>                    'condshow' =&gt; array(&nbsp;</div></li><li><div>                        'aiosp_rewrite_titles' =&gt; 1, &nbsp;</div></li><li><div>                        'aiosp_enablecpost' =&gt; 'on', &nbsp;</div></li><li><div>                        'aiosp_cpostadvanced' =&gt; 'on', &nbsp;</div></li><li><div>                        'aiosp_cposttitles' =&gt; 'on', &nbsp;</div></li><li><div>                        'aiosp_cpostactive\[\]' =&gt; $p, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                $this-&gt;help_text[ $field ]       = __( 'The following macros are supported:', 'all-in-one-seo-pack' )&nbsp;</div></li><li><div>                                                   . '&lt;ul&gt;&lt;li&gt;' . __( '%blog_title% - Your blog title', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                                                   __( '%blog_description% - Your blog description', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                                                   __( '%post_title% - The original title of the post.', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;';&nbsp;</div></li><li><div>                $taxes = get_object_taxonomies( $p, 'objects' );&nbsp;</div></li><li><div>                if ( ! empty( $taxes ) ) {&nbsp;</div></li><li><div>                    foreach ( $taxes as $n =&gt; $t ) {&nbsp;</div></li><li><div>                        $this-&gt;help_text[ $field ] .= sprintf( __( &quot;%%tax_%s%% - This post's associated %s taxonomy title&quot;, 'all-in-one-seo-pack' ), $n, $t-&gt;label ) . '&lt;/li&gt;&lt;li&gt;';&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $this-&gt;help_text[ $field ] .=&nbsp;</div></li><li><div>                    __( &quot;%post_author_login% - This post's author' login&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                    __( &quot;%post_author_nicename% - This post's author' nicename&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                    __( &quot;%post_author_firstname% - This post's author' first name (capitalized)&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                    __( &quot;%post_author_lastname% - This post's author' last name (capitalized)&quot;, 'all-in-one-seo-pack' ) . '&lt;/li&gt;' .&nbsp;</div></li><li><div>                    '&lt;/ul&gt;';&nbsp;</div></li><li><div>                $this-&gt;help_anchors[ $field ]     = '#custom-titles';&nbsp;</div></li><li><div>                $this-&gt;layout['cpt']['options'][] = $field;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        global $wp_roles;&nbsp;</div></li><li><div>        if ( ! isset( $wp_roles ) ) {&nbsp;</div></li><li><div>            $wp_roles = new WP_Roles();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $role_names = $wp_roles-&gt;get_names();&nbsp;</div></li><li><div>        ksort( $role_names );&nbsp;</div></li><li><div>        $this-&gt;default_options['ga_exclude_users']['initial_options'] = $role_names;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        unset( $tax_types['category'] );&nbsp;</div></li><li><div>        unset( $tax_types['post_tag'] );&nbsp;</div></li><li><div>        $this-&gt;default_options['tax_noindex']['initial_options'] = $tax_types;&nbsp;</div></li><li><div>        if ( empty( $tax_types ) ) {&nbsp;</div></li><li><div>            unset( $this-&gt;default_options['tax_noindex'] );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            foreach ( $tax_types as $p =&gt; $pt ) {&nbsp;</div></li><li><div>                $field = $p . '_tax_title_format';&nbsp;</div></li><li><div>                $name = $pt;&nbsp;</div></li><li><div>                if ( ! isset( $this-&gt;default_options[ $field ] ) ) {&nbsp;</div></li><li><div>                    $this-&gt;default_options[ $field ]  = array(&nbsp;</div></li><li><div>                        'name' =&gt; &quot;$name &quot; . __( 'Taxonomy Title Format:', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'type' =&gt; 'text', &nbsp;</div></li><li><div>                        'default' =&gt; '%taxonomy_title% | %blog_title%', &nbsp;</div></li><li><div>                        'condshow' =&gt; array(&nbsp;</div></li><li><div>                            'aiosp_rewrite_titles' =&gt; 1, &nbsp;</div></li><li><div>                            'aiosp_enablecpost' =&gt; 'on', &nbsp;</div></li><li><div>                            'aiosp_cpostadvanced' =&gt; 'on', &nbsp;</div></li><li><div>                            'aiosp_cposttitles' =&gt; 'on', &nbsp;</div></li><li><div>                            'aiosp_taxactive\[\]' =&gt; $p, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                    $this-&gt;help_text[ $field ]        = __( 'The following macros are supported:', 'all-in-one-seo-pack' ) .&nbsp;</div></li><li><div>                                                        '&lt;ul&gt;&lt;li&gt;' . __( '%blog_title% - Your blog title', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                                                        __( '%blog_description% - Your blog description', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                                                        __( '%taxonomy_title% - The original title of the taxonomy', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;li&gt;' .&nbsp;</div></li><li><div>                                                        __( '%taxonomy_description% - The description of the taxonomy', 'all-in-one-seo-pack' ) . '&lt;/li&gt;&lt;/ul&gt;';&nbsp;</div></li><li><div>                    $this-&gt;help_anchors[ $field ]     = '#custom-titles';&nbsp;</div></li><li><div>                    $this-&gt;layout['cpt']['options'][] = $field;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $this-&gt;setting_options();&nbsp;</div></li><li><div>        $this-&gt;add_help_text_links();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            global $aioseop_update_checker;&nbsp;</div></li><li><div>            add_action( &quot;{$this-&gt;prefix}update_options&quot;, array(&nbsp;</div></li><li><div>                $aioseop_update_checker, &nbsp;</div></li><li><div>                'license_change_check', &nbsp;</div></li><li><div> ), 10, 2 );&nbsp;</div></li><li><div>            add_action( &quot;{$this-&gt;prefix}settings_update&quot;, array( $aioseop_update_checker, 'update_check' ), 10, 2 );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_filter( &quot;{$this-&gt;prefix}display_options&quot;, array( $this, 'filter_options' ), 10, 2 );&nbsp;</div></li><li><div>        parent::add_page_hooks();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function settings_page_init() {&nbsp;</div></li><li><div>        add_filter( &quot;{$this-&gt;prefix}submit_options&quot;, array( $this, 'filter_submit' ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function enqueue_scripts() {&nbsp;</div></li><li><div>        add_filter( &quot;{$this-&gt;prefix}display_settings&quot;, array( $this, 'filter_settings' ), 10, 3 );&nbsp;</div></li><li><div>        add_filter( &quot;{$this-&gt;prefix}display_options&quot;, array( $this, 'filter_options' ), 10, 2 );&nbsp;</div></li><li><div>        parent::enqueue_scripts();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $submit&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function filter_submit( $submit ) {&nbsp;</div></li><li><div>        $submit['Submit_Default']['value'] = __( 'Reset General Settings to Defaults', 'all-in-one-seo-pack' ) . ' &raquo;';&nbsp;</div></li><li><div>        $submit['Submit_All_Default'] = array(&nbsp;</div></li><li><div>            'type' =&gt; 'submit', &nbsp;</div></li><li><div>            'class' =&gt; 'button-secondary', &nbsp;</div></li><li><div>            'value' =&gt; __( 'Reset ALL Settings to Defaults', 'all-in-one-seo-pack' ) . ' &raquo;', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $submit;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Handle resetting options to defaults, but preserve the license key if pro.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param null $location&nbsp;</div></li><li><div>     * @param bool $delete&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function reset_options( $location = null, $delete = false ) {&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            global $aioseop_update_checker;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $delete === true ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>                $license_key = '';&nbsp;</div></li><li><div>                if ( isset( $this-&gt;options ) && isset( $this-&gt;options['aiosp_license_key'] ) ) {&nbsp;</div></li><li><div>                    $license_key = $this-&gt;options['aiosp_license_key'];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $this-&gt;delete_class_option( $delete );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>                $this-&gt;options = array( 'aiosp_license_key' =&gt; $license_key );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $this-&gt;options = array();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $default_options = $this-&gt;default_options( $location );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            foreach ( $default_options as $k =&gt; $v ) {&nbsp;</div></li><li><div>                if ( $k != 'aiosp_license_key' ) {&nbsp;</div></li><li><div>                    $this-&gt;options[ $k ] = $v;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $aioseop_update_checker-&gt;license_key = $this-&gt;options['aiosp_license_key'];&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            foreach ( $default_options as $k =&gt; $v ) {&nbsp;</div></li><li><div>                $this-&gt;options[ $k ] = $v;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $this-&gt;update_class_option( $this-&gt;options );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $settings&nbsp;</div></li><li><div>     * @param $location&nbsp;</div></li><li><div>     * @param $current&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function filter_settings( $settings, $location, $current ) {&nbsp;</div></li><li><div>        if ( $location == null ) {&nbsp;</div></li><li><div>            $prefix = $this-&gt;prefix;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( array( 'seopostcol', 'seocustptcol', 'debug_info', 'max_words_excerpt' ) as $opt ) {&nbsp;</div></li><li><div>                unset( $settings[&quot;{$prefix}$opt&quot;] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( ! class_exists( 'DOMDocument' ) ) {&nbsp;</div></li><li><div>                unset( $settings['{prefix}google_connect'] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>                if ( ! empty( $this-&gt;options['aiosp_license_key'] ) ) {&nbsp;</div></li><li><div>                    $settings['aiosp_license_key']['type'] = 'password';&nbsp;</div></li><li><div>                    $settings['aiosp_license_key']['size'] = 38;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } elseif ( $location == 'aiosp' ) {&nbsp;</div></li><li><div>            global $post, $aioseop_sitemap;&nbsp;</div></li><li><div>            $prefix = $this-&gt;get_prefix( $location ) . $location . '_';&nbsp;</div></li><li><div>            if ( ! empty( $post ) ) {&nbsp;</div></li><li><div>                $post_type = get_post_type( $post );&nbsp;</div></li><li><div>                if ( ! empty( $this-&gt;options['aiosp_cpostnoindex'] ) && in_array( $post_type, $this-&gt;options['aiosp_cpostnoindex'] ) ) {&nbsp;</div></li><li><div>                    $settings[&quot;{$prefix}noindex&quot;]['type'] = 'select';&nbsp;</div></li><li><div>                    $settings[&quot;{$prefix}noindex&quot;]['initial_options'] = array(&nbsp;</div></li><li><div>                        '' =&gt; __( 'Default - noindex', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'off' =&gt; __( 'index', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'on' =&gt; __( 'noindex', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( ! empty( $this-&gt;options['aiosp_cpostnofollow'] ) && in_array( $post_type, $this-&gt;options['aiosp_cpostnofollow'] ) ) {&nbsp;</div></li><li><div>                    $settings[&quot;{$prefix}nofollow&quot;]['type'] = 'select';&nbsp;</div></li><li><div>                    $settings[&quot;{$prefix}nofollow&quot;]['initial_options'] = array(&nbsp;</div></li><li><div>                        '' =&gt; __( 'Default - nofollow', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'off' =&gt; __( 'follow', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'on' =&gt; __( 'nofollow', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( ! empty( $this-&gt;options['aiosp_cpostnoodp'] ) && in_array( $post_type, $this-&gt;options['aiosp_cpostnoodp'] ) ) {&nbsp;</div></li><li><div>                    $settings[&quot;{$prefix}noodp&quot;]['type'] = 'select';&nbsp;</div></li><li><div>                    $settings[&quot;{$prefix}noodp&quot;]['initial_options'] = array(&nbsp;</div></li><li><div>                        '' =&gt; __( 'Default - noodp', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'off' =&gt; __( 'odp', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'on' =&gt; __( 'noodp', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( ! empty( $this-&gt;options['aiosp_cpostnoydir'] ) && in_array( $post_type, $this-&gt;options['aiosp_cpostnoydir'] ) ) {&nbsp;</div></li><li><div>                    $settings[&quot;{$prefix}noydir&quot;]['type'] = 'select';&nbsp;</div></li><li><div>                    $settings[&quot;{$prefix}noydir&quot;]['initial_options'] = array(&nbsp;</div></li><li><div>                        '' =&gt; __( 'Default - noydir', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'off' =&gt; __( 'ydir', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                        'on' =&gt; __( 'noydir', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                global $post;&nbsp;</div></li><li><div>                $info = $this-&gt;get_page_snippet_info();&nbsp;</div></li><li><div>                extract( $info );&nbsp;</div></li><li><div>                $settings[&quot;{$prefix}title&quot;]['placeholder'] = $title;&nbsp;</div></li><li><div>                $settings[&quot;{$prefix}description&quot;]['placeholder'] = $description;&nbsp;</div></li><li><div>                $settings[&quot;{$prefix}keywords&quot;]['placeholder'] = $keywords;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( ! AIOSEOPPRO ) {&nbsp;</div></li><li><div>                if ( ! current_user_can( 'update_plugins' ) ) {&nbsp;</div></li><li><div>                    unset( $settings[&quot;{$prefix}upgrade&quot;] );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( ! is_object( $aioseop_sitemap ) ) {&nbsp;</div></li><li><div>                unset( $settings['aiosp_sitemap_exclude'] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( is_object( $post ) ) {&nbsp;</div></li><li><div>                if ( $post-&gt;post_type != 'page' ) {&nbsp;</div></li><li><div>                    unset( $settings[&quot;{$prefix}titleatr&quot;] );&nbsp;</div></li><li><div>                    unset( $settings[&quot;{$prefix}menulabel&quot;] );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! empty( $this-&gt;options[ $this-&gt;prefix . 'togglekeywords' ] ) ) {&nbsp;</div></li><li><div>                unset( $settings[&quot;{$prefix}keywords&quot;] );&nbsp;</div></li><li><div>                unset( $settings[&quot;{$prefix}togglekeywords&quot;] );&nbsp;</div></li><li><div>            } elseif ( ! empty( $current[&quot;{$prefix}togglekeywords&quot;] ) ) {&nbsp;</div></li><li><div>                unset( $settings[&quot;{$prefix}keywords&quot;] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $this-&gt;options['aiosp_can'] ) || empty( $this-&gt;options['aiosp_customize_canonical_links'] ) ) {&nbsp;</div></li><li><div>                unset( $settings[&quot;{$prefix}custom_link&quot;] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $settings;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $options&nbsp;</div></li><li><div>     * @param $location&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function filter_options( $options, $location ) {&nbsp;</div></li><li><div>        if ( $location == 'aiosp' ) {&nbsp;</div></li><li><div>            global $post;&nbsp;</div></li><li><div>            if ( ! empty( $post ) ) {&nbsp;</div></li><li><div>                $prefix = $this-&gt;prefix;&nbsp;</div></li><li><div>                $post_type = get_post_type( $post );&nbsp;</div></li><li><div>                foreach ( array( 'noindex', 'nofollow', 'noodp', 'noydir' ) as $no ) {&nbsp;</div></li><li><div>                    if ( empty( $this-&gt;options[ 'aiosp_cpost' . $no ] ) || ( ! in_array( $post_type, $this-&gt;options[ 'aiosp_cpost' . $no ] ) ) ) {&nbsp;</div></li><li><div>                        if ( isset( $options[&quot;{$prefix}{$no}&quot;] ) && ( $options[&quot;{$prefix}{$no}&quot;] != 'on' ) ) {&nbsp;</div></li><li><div>                            unset( $options[&quot;{$prefix}{$no}&quot;] );&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $location == null ) {&nbsp;</div></li><li><div>            $prefix = $this-&gt;prefix;&nbsp;</div></li><li><div>            if ( isset( $options[&quot;{$prefix}rewrite_titles&quot;] ) && ( ! empty( $options[&quot;{$prefix}rewrite_titles&quot;] ) ) ) {&nbsp;</div></li><li><div>                $options[&quot;{$prefix}rewrite_titles&quot;] = 1;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( isset( $options[&quot;{$prefix}enablecpost&quot;] ) && ( $options[&quot;{$prefix}enablecpost&quot;] === '' ) ) {&nbsp;</div></li><li><div>                $options[&quot;{$prefix}enablecpost&quot;] = 0;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( isset( $options[&quot;{$prefix}use_original_title&quot;] ) && ( $options[&quot;{$prefix}use_original_title&quot;] === '' ) ) {&nbsp;</div></li><li><div>                $options[&quot;{$prefix}use_original_title&quot;] = 0;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $options;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function template_redirect() {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $post = $this-&gt;get_queried_object();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! $this-&gt;is_page_included() ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_rewrite_titles'] ) ) {&nbsp;</div></li><li><div>            $force_rewrites = 1;&nbsp;</div></li><li><div>            if ( isset( $aioseop_options['aiosp_force_rewrites'] ) ) {&nbsp;</div></li><li><div>                $force_rewrites = $aioseop_options['aiosp_force_rewrites'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( $force_rewrites ) {&nbsp;</div></li><li><div>                ob_start( array( $this, 'output_callback_for_title' ) );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                add_filter( 'wp_title', array( $this, 'wp_title' ), 20 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return bool&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function is_page_included() {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        if ( is_feed() ) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( aioseop_mrt_exclude_this_page() ) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $post = $this-&gt;get_queried_object();&nbsp;</div></li><li><div>        $post_type = '';&nbsp;</div></li><li><div>        if ( ! empty( $post ) && ! empty( $post-&gt;post_type ) ) {&nbsp;</div></li><li><div>            $post_type = $post-&gt;post_type;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( empty( $aioseop_options['aiosp_enablecpost'] ) ) {&nbsp;</div></li><li><div>            $wp_post_types = get_post_types( array( '_builtin' =&gt; true ) ); // Don't display meta if SEO isn't enabled on custom post types -- pdb.&nbsp;</div></li><li><div>            if ( is_singular() && ! in_array( $post_type, $wp_post_types ) && ! is_front_page() ) {&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $wp_post_types = $aioseop_options['aiosp_cpostactive'];&nbsp;</div></li><li><div>            if ( empty( $wp_post_types ) ) {&nbsp;</div></li><li><div>                $wp_post_types = array();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>                if ( is_tax() ) {&nbsp;</div></li><li><div>                    if ( empty( $aioseop_options['aiosp_taxactive'] ) || ! is_tax( $aioseop_options['aiosp_taxactive'] ) ) {&nbsp;</div></li><li><div>                        return false;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                } elseif ( is_category() ) {&nbsp;</div></li><li><div>                    if ( empty( $aioseop_options['aiosp_taxactive'] ) || ! in_array( 'category', $aioseop_options['aiosp_taxactive'] ) ) {&nbsp;</div></li><li><div>                        return false;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                } elseif ( is_tag() ) {&nbsp;</div></li><li><div>                    if ( empty( $aioseop_options['aiosp_taxactive'] ) || ! in_array( 'post_tag', $aioseop_options['aiosp_taxactive'] ) ) {&nbsp;</div></li><li><div>                        return false;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                } else if ( ! in_array( $post_type, $wp_post_types ) && ! is_front_page() && ! is_post_type_archive( $wp_post_types ) && ! is_404() ) {&nbsp;</div></li><li><div>                    return false;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                if ( is_singular() && ! in_array( $post_type, $wp_post_types ) && ! is_front_page() ) {&nbsp;</div></li><li><div>                    return false;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( is_post_type_archive() && ! is_post_type_archive( $wp_post_types ) ) {&nbsp;</div></li><li><div>                    return false;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;meta_opts = $this-&gt;get_current_options( array(), 'aiosp' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $aiosp_disable = $aiosp_disable_analytics = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $this-&gt;meta_opts ) ) {&nbsp;</div></li><li><div>            if ( isset( $this-&gt;meta_opts['aiosp_disable'] ) ) {&nbsp;</div></li><li><div>                $aiosp_disable = $this-&gt;meta_opts['aiosp_disable'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( isset( $this-&gt;meta_opts['aiosp_disable_analytics'] ) ) {&nbsp;</div></li><li><div>                $aiosp_disable_analytics = $this-&gt;meta_opts['aiosp_disable_analytics'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $aiosp_disable ) {&nbsp;</div></li><li><div>            if ( ! $aiosp_disable_analytics ) {&nbsp;</div></li><li><div>                if ( aioseop_option_isset( 'aiosp_google_analytics_id' ) ) {&nbsp;</div></li><li><div>                    remove_action( 'aioseop_modules_wp_head', array( $this, 'aiosp_google_analytics' ) );&nbsp;</div></li><li><div>                    add_action( 'wp_head', array( $this, 'aiosp_google_analytics' ) );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $this-&gt;meta_opts ) && $this-&gt;meta_opts['aiosp_disable'] == true ) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return true;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $content&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed|string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function output_callback_for_title( $content ) {&nbsp;</div></li><li><div>        return $this-&gt;rewrite_title( $content );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Used for forcing title rewrites.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param $header&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed|string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function rewrite_title( $header ) {&nbsp;</div></li><li><div>        global $wp_query;&nbsp;</div></li><li><div>        if ( ! $wp_query ) {&nbsp;</div></li><li><div>            $header .= &quot;&lt;!-- no wp_query found! --&gt;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return $header;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $title = $this-&gt;wp_title();&nbsp;</div></li><li><div>        if ( ! empty( $title ) ) {&nbsp;</div></li><li><div>            $header = $this-&gt;replace_title( $header, $title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $header;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $content&nbsp;</div></li><li><div>     * @param $title&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function replace_title( $content, $title ) {&nbsp;</div></li><li><div>        // We can probably improve this... I'm not sure half of this is even being used.&nbsp;</div></li><li><div>        $title = trim( strip_tags( $title ) );&nbsp;</div></li><li><div>        $title_tag_start = '&lt;title';&nbsp;</div></li><li><div>        $title_tag_end = '&lt;/title';&nbsp;</div></li><li><div>        $start = $this-&gt;strpos( $content, $title_tag_start );&nbsp;</div></li><li><div>        $end = $this-&gt;strpos( $content, $title_tag_end );&nbsp;</div></li><li><div>        $this-&gt;title_start = $start;&nbsp;</div></li><li><div>        $this-&gt;title_end = $end;&nbsp;</div></li><li><div>        $this-&gt;orig_title = $title;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return preg_replace( '/&lt;title([^&gt;]*?)\s*&gt;([^&lt;]*?)&lt;\/title\s*&gt;/is', '&lt;title\\1&gt;' . preg_replace( '/(\$|\\\\)(?=\d)/', '\\\\\1', strip_tags( $title ) ) . '&lt;/title&gt;', $content, 1 );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function add_hooks() {&nbsp;</div></li><li><div>        global $aioseop_options, $aioseop_update_checker;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // MOVED TO MAIN PLUGIN FILE IN ORDER TO FIRE SOONS&nbsp;</div></li><li><div>        //$role = get_role( 'administrator' );&nbsp;</div></li><li><div>        //if ( is_object( $role ) ) {&nbsp;</div></li><li><div>        //    $role-&gt;add_cap( 'aiosp_manage_seo' );&nbsp;</div></li><li><div>        //}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        aioseop_update_settings_check();&nbsp;</div></li><li><div>        add_filter( 'user_contactmethods', 'aioseop_add_contactmethods' );&nbsp;</div></li><li><div>        if ( is_user_logged_in() && function_exists( 'is_admin_bar_showing' ) && is_admin_bar_showing() && current_user_can( 'aiosp_manage_seo' ) ) {&nbsp;</div></li><li><div>            add_action( 'admin_bar_menu', array( $this, 'admin_bar_menu' ), 1000 );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_admin() ) {&nbsp;</div></li><li><div>            add_action( 'admin_menu', array( $this, 'admin_menu' ) );&nbsp;</div></li><li><div>            add_action( 'admin_head', array( $this, 'add_page_icon' ) );&nbsp;</div></li><li><div>            add_action( 'admin_init', 'aioseop_addmycolumns', 1 );&nbsp;</div></li><li><div>            add_action( 'admin_init', 'aioseop_handle_ignore_notice' );&nbsp;</div></li><li><div>            if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>                if ( current_user_can( 'update_plugins' ) ) {&nbsp;</div></li><li><div>                    add_action( 'admin_notices', array( $aioseop_update_checker, 'key_warning' ) );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                add_action( 'after_plugin_row_' . AIOSEOP_PLUGIN_BASENAME, array(&nbsp;</div></li><li><div>                    $aioseop_update_checker, &nbsp;</div></li><li><div>                    'add_plugin_row', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            if ( $aioseop_options['aiosp_can'] == '1' || $aioseop_options['aiosp_can'] == 'on' ) {&nbsp;</div></li><li><div>                remove_action( 'wp_head', 'rel_canonical' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            // Analytics.&nbsp;</div></li><li><div>            if ( aioseop_option_isset( 'aiosp_google_analytics_id' ) ) {&nbsp;</div></li><li><div>                add_action( 'aioseop_modules_wp_head', array( $this, 'aiosp_google_analytics' ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            add_filter( 'wp_list_pages', 'aioseop_list_pages' );&nbsp;</div></li><li><div>            add_action( 'wp_head', array( $this, 'wp_head' ), apply_filters( 'aioseop_wp_head_priority', 1 ) );&nbsp;</div></li><li><div>            add_action( 'template_redirect', array( $this, 'template_redirect' ), 0 );&nbsp;</div></li><li><div>            add_filter( 'wp_list_pages_excludes', 'aioseop_get_pages_start' );&nbsp;</div></li><li><div>            add_filter( 'get_pages', 'aioseop_get_pages' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function visibility_warning() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $aioseop_visibility_notice_dismissed = get_user_meta( get_current_user_id(), 'aioseop_visibility_notice_dismissed', true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( '0' == get_option( 'blog_public' ) && empty( $aioseop_visibility_notice_dismissed ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            printf( '&nbsp;</div></li><li><div>            &lt;div id=&quot;message&quot; class=&quot;error notice is-dismissible aioseop-notice visibility-notice&quot;&gt;&nbsp;</div></li><li><div>                &lt;p&gt;&nbsp;</div></li><li><div>                    &lt;strong&gt;%1$s&lt;/strong&gt;&nbsp;</div></li><li><div>                    %2$s&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;/p&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;', &nbsp;</div></li><li><div>                __( 'Warning: You\'re blocking access to search engines.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                sprintf( __( 'You can %s click here%s to go to your reading settings and toggle your blog visibility.', 'all-in-one-seo-pack' ), sprintf( '&lt;a href=&quot;%s&quot;&gt;', esc_url( admin_url( 'options-reading.php' ) ) ), '&lt;/a&gt;' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        } elseif ( '1' == get_option( 'blog_public' ) && ! empty( $aioseop_visibility_notice_dismissed ) ) {&nbsp;</div></li><li><div>            delete_user_meta( get_current_user_id(), 'aioseop_visibility_notice_dismissed' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function woo_upgrade_notice() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $aioseop_woo_upgrade_notice_dismissed = get_user_meta( get_current_user_id(), 'aioseop_woo_upgrade_notice_dismissed', true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( class_exists( 'WooCommerce' ) && empty( $aioseop_woo_upgrade_notice_dismissed ) && current_user_can( 'manage_options' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            printf( '&nbsp;</div></li><li><div>            &lt;div id=&quot;message&quot; class=&quot;notice-info notice is-dismissible aioseop-notice woo-upgrade-notice&quot;&gt;&nbsp;</div></li><li><div>                &lt;p&gt;&nbsp;</div></li><li><div>                    &lt;strong&gt;%1$s&lt;/strong&gt;&nbsp;</div></li><li><div>                    %2$s&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;/p&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;', &nbsp;</div></li><li><div>                __( 'We\'ve detected you\'re running WooCommerce.', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                sprintf( __( '%s Upgrade%s to All in One SEO Pack Pro for increased SEO compatibility for your products.', 'all-in-one-seo-pack' ), sprintf( '&lt;a target=&quot;_blank&quot; href=&quot;%s&quot;&gt;', esc_url( 'http://semperplugins.com/plugins/all-in-one-seo-pack-pro-version/?loc=woo' ) ), '&lt;/a&gt;' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        } elseif ( ! class_exists( 'WooCommerce' ) && ! empty( $aioseop_woo_upgrade_notice_dismissed ) ) {&nbsp;</div></li><li><div>            delete_user_meta( get_current_user_id(), 'aioseop_woo_upgrade_notice_dismissed' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $description&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function make_unique_att_desc( $description ) {&nbsp;</div></li><li><div>        global $wp_query;&nbsp;</div></li><li><div>        if ( is_attachment() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $url = $this-&gt;aiosp_mrt_get_url( $wp_query );&nbsp;</div></li><li><div>            if ( $url ) {&nbsp;</div></li><li><div>                $matches = array();&nbsp;</div></li><li><div>                preg_match_all( '/(\d+)/', $url, $matches );&nbsp;</div></li><li><div>                if ( is_array( $matches ) ) {&nbsp;</div></li><li><div>                    $uniqueDesc = join( '', $matches[0] );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $description .= ' ' . $uniqueDesc;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $description;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function wp_head() {&nbsp;</div></li><li><div>        if ( ! $this-&gt;is_page_included() ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $opts = $this-&gt;meta_opts;&nbsp;</div></li><li><div>        global $aioseop_update_checker, $wp_query, $aioseop_options, $posts;&nbsp;</div></li><li><div>        static $aioseop_dup_counter = 0;&nbsp;</div></li><li><div>        $aioseop_dup_counter ++;&nbsp;</div></li><li><div>        if ( $aioseop_dup_counter &gt; 1 ) {&nbsp;</div></li><li><div>            echo &quot;\n&lt;!-- &quot; . sprintf( __( 'Debug Warning: All in One SEO Pack meta data was included again from %s filter. Called %s times!', 'all-in-one-seo-pack' ), current_filter(), $aioseop_dup_counter ) . &quot; --&gt;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( is_home() && ! is_front_page() ) {&nbsp;</div></li><li><div>            $post = aiosp_common::get_blog_page();&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $post = $this-&gt;get_queried_object();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $meta_string = null;&nbsp;</div></li><li><div>        $description = '';&nbsp;</div></li><li><div>        // Logging - rewrite handler check for output buffering.&nbsp;</div></li><li><div>        $this-&gt;check_rewrite_handler();&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            echo &quot;\n&lt;!-- All in One SEO Pack Pro $this-&gt;version by Michael Torbert of Semper Fi Web Design&quot;;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            echo &quot;\n&lt;!-- All in One SEO Pack $this-&gt;version by Michael Torbert of Semper Fi Web Design&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $this-&gt;ob_start_detected ) {&nbsp;</div></li><li><div>            echo 'ob_start_detected ';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        echo &quot;[$this-&gt;title_start, $this-&gt;title_end] &quot;;&nbsp;</div></li><li><div>        echo &quot;--&gt;\n&quot;;&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            echo '&lt;!-- ' . __( 'Debug String', 'all-in-one-seo-pack' ) . ': ' . $aioseop_update_checker-&gt;get_verification_code() . &quot; --&gt;\n&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $blog_page = aiosp_common::get_blog_page( $post );&nbsp;</div></li><li><div>        $save_posts = $posts;&nbsp;</div></li><li><div>        if ( function_exists( 'woocommerce_get_page_id' ) && is_post_type_archive( 'product' ) && ( $post_id = woocommerce_get_page_id( 'shop' ) ) && ( $post = get_post( $post_id ) ) ) {&nbsp;</div></li><li><div>            global $posts;&nbsp;</div></li><li><div>            $opts = $this-&gt;meta_opts = $this-&gt;get_current_options( array(), 'aiosp', null, $post );&nbsp;</div></li><li><div>            $posts = array();&nbsp;</div></li><li><div>            $posts[] = $post;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $posts = $save_posts;&nbsp;</div></li><li><div>        $description = apply_filters( 'aioseop_description', $this-&gt;get_main_description( $post ) );    // Get the description.&nbsp;</div></li><li><div>        // Handle the description format.&nbsp;</div></li><li><div>        if ( isset( $description ) && ( $this-&gt;strlen( $description ) &gt; $this-&gt;minimum_description_length ) && ! ( is_front_page() && is_paged() ) ) {&nbsp;</div></li><li><div>            $description = $this-&gt;trim_description( $description );&nbsp;</div></li><li><div>            if ( ! isset( $meta_string ) ) {&nbsp;</div></li><li><div>                $meta_string = '';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            // Description format.&nbsp;</div></li><li><div>            $description = apply_filters( 'aioseop_description_full', $this-&gt;apply_description_format( $description, $post ) );&nbsp;</div></li><li><div>            $desc_attr = '';&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_schema_markup'] ) ) {&nbsp;</div></li><li><div>                $desc_attr = 'itemprop=&quot;description&quot;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $desc_attr = apply_filters( 'aioseop_description_attributes', $desc_attr );&nbsp;</div></li><li><div>            $meta_string .= sprintf( &quot;&lt;meta name=\&quot;description\&quot; %s content=\&quot;%s\&quot; /&gt;\n&quot;, $desc_attr, $description );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // Get the keywords.&nbsp;</div></li><li><div>        $togglekeywords = 0;&nbsp;</div></li><li><div>        if ( isset( $aioseop_options['aiosp_togglekeywords'] ) ) {&nbsp;</div></li><li><div>            $togglekeywords = $aioseop_options['aiosp_togglekeywords'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $togglekeywords == 0 && ! ( is_front_page() && is_paged() ) ) {&nbsp;</div></li><li><div>            $keywords = $this-&gt;get_main_keywords();&nbsp;</div></li><li><div>            $keywords = $this-&gt;apply_cf_fields( $keywords );&nbsp;</div></li><li><div>            $keywords = apply_filters( 'aioseop_keywords', $keywords );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( isset( $keywords ) && ! empty( $keywords ) ) {&nbsp;</div></li><li><div>                if ( isset( $meta_string ) ) {&nbsp;</div></li><li><div>                    $meta_string .= &quot;\n&quot;;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $keywords = wp_filter_nohtml_kses( str_replace( '&quot;', '', $keywords ) );&nbsp;</div></li><li><div>                $key_attr = '';&nbsp;</div></li><li><div>                if ( ! empty( $aioseop_options['aiosp_schema_markup'] ) ) {&nbsp;</div></li><li><div>                    $key_attr = 'itemprop=&quot;keywords&quot;';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $key_attr = apply_filters( 'aioseop_keywords_attributes', $key_attr );&nbsp;</div></li><li><div>                $meta_string .= sprintf( &quot;&lt;meta name=\&quot;keywords\&quot; %s content=\&quot;%s\&quot; /&gt;\n&quot;, $key_attr, $keywords );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // Handle noindex, nofollow - robots meta.&nbsp;</div></li><li><div>        $robots_meta = apply_filters( 'aioseop_robots_meta', $this-&gt;get_robots_meta() );&nbsp;</div></li><li><div>        if ( ! empty( $robots_meta ) ) {&nbsp;</div></li><li><div>            $meta_string .= '&lt;meta name=&quot;robots&quot; content=&quot;' . esc_attr( $robots_meta ) . '&quot; /&gt;' . &quot;\n&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // Handle site verification.&nbsp;</div></li><li><div>        if ( is_front_page() ) {&nbsp;</div></li><li><div>            foreach (&nbsp;</div></li><li><div>                array(&nbsp;</div></li><li><div>                    'google' =&gt; 'google-site-verification', &nbsp;</div></li><li><div>                    'bing' =&gt; 'msvalidate.01', &nbsp;</div></li><li><div>                    'pinterest' =&gt; 'p:domain_verify', &nbsp;</div></li><li><div> ) as $k =&gt; $v&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>                if ( ! empty( $aioseop_options[&quot;aiosp_{$k}_verify&quot;] ) ) {&nbsp;</div></li><li><div>                    $meta_string .= '&lt;meta name=&quot;' . $v . '&quot; content=&quot;' . trim( strip_tags( $aioseop_options[&quot;aiosp_{$k}_verify&quot;] ) ) . '&quot; /&gt;' . &quot;\n&quot;;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Sitelinks search.&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_google_sitelinks_search'] ) || ! empty( $aioseop_options['aiosp_google_set_site_name'] ) ) {&nbsp;</div></li><li><div>                $meta_string .= $this-&gt;sitelinks_search_box() . &quot;\n&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // Handle extra meta fields.&nbsp;</div></li><li><div>        foreach ( array( 'page_meta', 'post_meta', 'home_meta', 'front_meta' ) as $meta ) {&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options[&quot;aiosp_{$meta}_tags&quot;] ) ) {&nbsp;</div></li><li><div>                $$meta = html_entity_decode( stripslashes( $aioseop_options[&quot;aiosp_{$meta}_tags&quot;] ), ENT_QUOTES );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $$meta = '';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( is_page() && isset( $page_meta ) && ! empty( $page_meta ) && ( ! is_front_page() || empty( $front_meta ) ) ) {&nbsp;</div></li><li><div>            if ( isset( $meta_string ) ) {&nbsp;</div></li><li><div>                $meta_string .= &quot;\n&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $meta_string .= $page_meta;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( is_single() && isset( $post_meta ) && ! empty( $post_meta ) ) {&nbsp;</div></li><li><div>            if ( isset( $meta_string ) ) {&nbsp;</div></li><li><div>                $meta_string .= &quot;\n&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $meta_string .= $post_meta;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // Handle authorship.&nbsp;</div></li><li><div>        $authorship = $this-&gt;get_google_authorship( $post );&nbsp;</div></li><li><div>        $publisher = apply_filters( 'aioseop_google_publisher', $authorship['publisher'] );&nbsp;</div></li><li><div>        if ( ! empty( $publisher ) ) {&nbsp;</div></li><li><div>            $meta_string = '&lt;link rel=&quot;publisher&quot; href=&quot;' . esc_url( $publisher ) . '&quot; /&gt;' . &quot;\n&quot; . $meta_string;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $author = apply_filters( 'aioseop_google_author', $authorship['author'] );&nbsp;</div></li><li><div>        if ( ! empty( $author ) ) {&nbsp;</div></li><li><div>            $meta_string = '&lt;link rel=&quot;author&quot; href=&quot;' . esc_url( $author ) . '&quot; /&gt;' . &quot;\n&quot; . $meta_string;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_front_page() && ! empty( $front_meta ) ) {&nbsp;</div></li><li><div>            if ( isset( $meta_string ) ) {&nbsp;</div></li><li><div>                $meta_string .= &quot;\n&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $meta_string .= $front_meta;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            if ( is_home() && ! empty( $home_meta ) ) {&nbsp;</div></li><li><div>                if ( isset( $meta_string ) ) {&nbsp;</div></li><li><div>                    $meta_string .= &quot;\n&quot;;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $meta_string .= $home_meta;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $prev_next = $this-&gt;get_prev_next_links( $post );&nbsp;</div></li><li><div>        $prev = apply_filters( 'aioseop_prev_link', $prev_next['prev'] );&nbsp;</div></li><li><div>        $next = apply_filters( 'aioseop_next_link', $prev_next['next'] );&nbsp;</div></li><li><div>        if ( ! empty( $prev ) ) {&nbsp;</div></li><li><div>            $meta_string .= &quot;&lt;link rel='prev' href='&quot; . esc_url( $prev ) . &quot;' /&gt;\n&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( ! empty( $next ) ) {&nbsp;</div></li><li><div>            $meta_string .= &quot;&lt;link rel='next' href='&quot; . esc_url( $next ) . &quot;' /&gt;\n&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $meta_string != null ) {&nbsp;</div></li><li><div>            echo &quot;$meta_string\n&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Handle canonical links.&nbsp;</div></li><li><div>        $show_page = true;&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_no_paged_canonical_links'] ) ) {&nbsp;</div></li><li><div>            $show_page = false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $aioseop_options['aiosp_can'] ) {&nbsp;</div></li><li><div>            $url = '';&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_customize_canonical_links'] ) && ! empty( $opts['aiosp_custom_link'] ) ) {&nbsp;</div></li><li><div>                $url = $opts['aiosp_custom_link'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $url ) ) {&nbsp;</div></li><li><div>                $url = $this-&gt;aiosp_mrt_get_url( $wp_query, $show_page );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $url = $this-&gt;validate_url_scheme( $url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $url = apply_filters( 'aioseop_canonical_url', $url );&nbsp;</div></li><li><div>            if ( ! empty( $url ) ) {&nbsp;</div></li><li><div>                echo '&lt;link rel=&quot;canonical&quot; href=&quot;' . esc_url( $url ) . '&quot; /&gt;' . &quot;\n&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        do_action( 'aioseop_modules_wp_head' );&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            echo &quot;&lt;!-- /all in one seo pack pro --&gt;\n&quot;;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            echo &quot;&lt;!-- /all in one seo pack --&gt;\n&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Check rewrite handler.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function check_rewrite_handler() {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $force_rewrites = 1;&nbsp;</div></li><li><div>        if ( isset( $aioseop_options['aiosp_force_rewrites'] ) ) {&nbsp;</div></li><li><div>            $force_rewrites = $aioseop_options['aiosp_force_rewrites'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_rewrite_titles'] ) && $force_rewrites ) {&nbsp;</div></li><li><div>            // Make the title rewrite as short as possible.&nbsp;</div></li><li><div>            if ( function_exists( 'ob_list_handlers' ) ) {&nbsp;</div></li><li><div>                $active_handlers = ob_list_handlers();&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $active_handlers = array();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( sizeof( $active_handlers ) &gt; 0 &&&nbsp;</div></li><li><div>                 $this-&gt;strtolower( $active_handlers[ sizeof( $active_handlers ) - 1 ] ) ==&nbsp;</div></li><li><div>                 $this-&gt;strtolower( 'All_in_One_SEO_Pack::output_callback_for_title' )&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>                ob_end_flush();&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $this-&gt;log( 'another plugin interfering?' );&nbsp;</div></li><li><div>                // If we get here there *could* be trouble with another plugin :(.&nbsp;</div></li><li><div>                $this-&gt;ob_start_detected = true;&nbsp;</div></li><li><div>                if ( $this-&gt;option_isset( 'rewrite_titles' ) ) { // Try alternate method -- pdb.&nbsp;</div></li><li><div>                    $aioseop_options['aiosp_rewrite_titles'] = 0;&nbsp;</div></li><li><div>                    $force_rewrites = 0;&nbsp;</div></li><li><div>                    add_filter( 'wp_title', array( $this, 'wp_title' ), 20 );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( function_exists( 'ob_list_handlers' ) ) {&nbsp;</div></li><li><div>                    foreach ( ob_list_handlers() as $handler ) {&nbsp;</div></li><li><div>                        $this-&gt;log( &quot;detected output handler $handler&quot; );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $description&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed|string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function trim_description( $description ) {&nbsp;</div></li><li><div>        $description = trim( wp_strip_all_tags( $description ) );&nbsp;</div></li><li><div>        $description = str_replace( '&quot;', '&quot;', $description );&nbsp;</div></li><li><div>        $description = str_replace( &quot;\r\n&quot;, ' ', $description );&nbsp;</div></li><li><div>        $description = str_replace( &quot;\n&quot;, ' ', $description );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $description;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $description&nbsp;</div></li><li><div>     * @param null $post&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function apply_description_format( $description, $post = null ) {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        $description_format = $aioseop_options['aiosp_description_format'];&nbsp;</div></li><li><div>        if ( ! isset( $description_format ) || empty( $description_format ) ) {&nbsp;</div></li><li><div>            $description_format = '%description%';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $description = str_replace( '%description%', apply_filters( 'aioseop_description_override', $description ), $description_format );&nbsp;</div></li><li><div>        if ( strpos( $description, '%blog_title%' ) !== false ) {&nbsp;</div></li><li><div>            $description = str_replace( '%blog_title%', get_bloginfo( 'name' ), $description );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( strpos( $description, '%blog_description%' ) !== false ) {&nbsp;</div></li><li><div>            $description = str_replace( '%blog_description%', get_bloginfo( 'description' ), $description );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( strpos( $description, '%wp_title%' ) !== false ) {&nbsp;</div></li><li><div>            $description = str_replace( '%wp_title%', $this-&gt;get_original_title(), $description );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( strpos( $description, '%post_title%' ) !== false ) {&nbsp;</div></li><li><div>            $description = str_replace( '%post_title%', $this-&gt;get_aioseop_title( $post ), $description );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**this was intended to make attachment descriptions unique if pulling from the parent... let's remove it and see if there are any problems&nbsp;</div></li><li><div>        *on the roadmap is to have a better hierarchy for attachment description pulling&nbsp;</div></li><li><div>        * if ($aioseop_options['aiosp_can']) $description = $this-&gt;make_unique_att_desc($description);&nbsp;</div></li><li><div>        */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $description;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_robots_meta() {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        $opts = $this-&gt;meta_opts;&nbsp;</div></li><li><div>        $page = $this-&gt;get_page_number();&nbsp;</div></li><li><div>        $robots_meta = $tax_noindex = '';&nbsp;</div></li><li><div>        if ( isset( $aioseop_options['aiosp_tax_noindex'] ) ) {&nbsp;</div></li><li><div>            $tax_noindex = $aioseop_options['aiosp_tax_noindex'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $tax_noindex ) || ! is_array( $tax_noindex ) ) {&nbsp;</div></li><li><div>            $tax_noindex = array();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $aiosp_noindex = $aiosp_nofollow = $aiosp_noodp = $aiosp_noydir = '';&nbsp;</div></li><li><div>        $noindex = 'index';&nbsp;</div></li><li><div>        $nofollow = 'follow';&nbsp;</div></li><li><div>        if ( ( is_category() && ! empty( $aioseop_options['aiosp_category_noindex'] ) ) || ( ! is_category() && is_archive() && ! is_tag() && ! is_tax()&nbsp;</div></li><li><div>                                                                                             && ( ( is_date() && ! empty( $aioseop_options['aiosp_archive_date_noindex'] ) ) || ( is_author() && ! empty( $aioseop_options['aiosp_archive_author_noindex'] ) ) ) )&nbsp;</div></li><li><div>             || ( is_tag() && ! empty( $aioseop_options['aiosp_tags_noindex'] ) )&nbsp;</div></li><li><div>             || ( is_search() && ! empty( $aioseop_options['aiosp_search_noindex'] ) )&nbsp;</div></li><li><div>             || ( is_404() && ! empty( $aioseop_options['aiosp_404_noindex'] ) )&nbsp;</div></li><li><div>             || ( is_tax() && in_array( get_query_var( 'taxonomy' ), $tax_noindex ) )&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>            $noindex = 'noindex';&nbsp;</div></li><li><div>        } elseif ( is_single() || is_page() || $this-&gt;is_static_posts_page() || is_attachment() || is_category() || is_tag() || is_tax() || ( $page &gt; 1 ) ) {&nbsp;</div></li><li><div>            $post_type = get_post_type();&nbsp;</div></li><li><div>            if ( ! empty( $opts ) ) {&nbsp;</div></li><li><div>                $aiosp_noindex = htmlspecialchars( stripslashes( $opts['aiosp_noindex'] ) );&nbsp;</div></li><li><div>                $aiosp_nofollow = htmlspecialchars( stripslashes( $opts['aiosp_nofollow'] ) );&nbsp;</div></li><li><div>                $aiosp_noodp = htmlspecialchars( stripslashes( $opts['aiosp_noodp'] ) );&nbsp;</div></li><li><div>                $aiosp_noydir = htmlspecialchars( stripslashes( $opts['aiosp_noydir'] ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( $aiosp_noindex || $aiosp_nofollow || $aiosp_noodp || $aiosp_noydir || ! empty( $aioseop_options['aiosp_cpostnoindex'] )&nbsp;</div></li><li><div>                 || ! empty( $aioseop_options['aiosp_cpostnofollow'] ) || ! empty( $aioseop_options['aiosp_cpostnoodp'] ) || ! empty( $aioseop_options['aiosp_cpostnoydir'] )&nbsp;</div></li><li><div>                 || ! empty( $aioseop_options['aiosp_paginated_noindex'] ) || ! empty( $aioseop_options['aiosp_paginated_nofollow'] )&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>                if ( ( $aiosp_noindex == 'on' ) || ( ( ! empty( $aioseop_options['aiosp_paginated_noindex'] ) ) && $page &gt; 1 ) ||&nbsp;</div></li><li><div>                     ( ( $aiosp_noindex == '' ) && ( ! empty( $aioseop_options['aiosp_cpostnoindex'] ) ) && in_array( $post_type, $aioseop_options['aiosp_cpostnoindex'] ) )&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>                    $noindex = 'noindex';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( ( $aiosp_nofollow == 'on' ) || ( ( ! empty( $aioseop_options['aiosp_paginated_nofollow'] ) ) && $page &gt; 1 ) ||&nbsp;</div></li><li><div>                     ( ( $aiosp_nofollow == '' ) && ( ! empty( $aioseop_options['aiosp_cpostnofollow'] ) ) && in_array( $post_type, $aioseop_options['aiosp_cpostnofollow'] ) )&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>                    $nofollow = 'nofollow';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( ( $aiosp_noodp == 'on' ) || ( empty( $aiosp_noodp ) && ( ! empty( $aioseop_options['aiosp_cpostnoodp'] ) && in_array( $post_type, $aioseop_options['aiosp_cpostnoodp'] ) ) ) ) {&nbsp;</div></li><li><div>                    $aiosp_noodp = true;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $aiosp_noodp = false;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( ( $aiosp_noydir == 'on' ) || ( empty( $aiosp_noydir ) && ( ! empty( $aioseop_options['aiosp_cpostnoydir'] ) && in_array( $post_type, $aioseop_options['aiosp_cpostnoydir'] ) ) ) ) {&nbsp;</div></li><li><div>                    $aiosp_noydir = true;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $aiosp_noydir = false;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_noodp'] ) && $aioseop_options['aiosp_noodp'] ) {&nbsp;</div></li><li><div>            $aiosp_noodp = true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_noydir'] ) && $aioseop_options['aiosp_noydir'] ) {&nbsp;</div></li><li><div>            $aiosp_noydir = true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $aiosp_noodp ) {&nbsp;</div></li><li><div>            $nofollow .= ', noodp';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $aiosp_noydir ) {&nbsp;</div></li><li><div>            $nofollow .= ', noydir';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $robots_meta = $noindex . ', ' . $nofollow;&nbsp;</div></li><li><div>        if ( $robots_meta == 'index, follow' ) {&nbsp;</div></li><li><div>            $robots_meta = '';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $robots_meta;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed|void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function sitelinks_search_box() {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        $home_url = esc_url( get_home_url() );&nbsp;</div></li><li><div>        $name_block = $search_block = '';&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_google_set_site_name'] ) ) {&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_google_specify_site_name'] ) ) {&nbsp;</div></li><li><div>                $blog_name = $aioseop_options['aiosp_google_specify_site_name'];&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $blog_name = get_bloginfo( 'name' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $blog_name = esc_attr( $blog_name );&nbsp;</div></li><li><div>            $name_block = &lt;&lt;&lt;EOF&nbsp;</div></li><li><div>          &quot;name&quot;: &quot;{$blog_name}&quot;, &nbsp;</div></li><li><div>EOF;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_google_sitelinks_search'] ) ) {&nbsp;</div></li><li><div>            $search_block = &lt;&lt;&lt;EOF&nbsp;</div></li><li><div>        &quot;potentialAction&quot;: {&nbsp;</div></li><li><div>          &quot;@type&quot;: &quot;SearchAction&quot;, &nbsp;</div></li><li><div>          &quot;target&quot;: &quot;{$home_url}/?s={search_term}&quot;, &nbsp;</div></li><li><div>          &quot;query-input&quot;: &quot;required name=search_term&quot;&nbsp;</div></li><li><div>        }, &nbsp;</div></li><li><div>EOF;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $search_box = &lt;&lt;&lt;EOF&nbsp;</div></li><li><div>&lt;script type=&quot;application/ld+json&quot;&gt;&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>          &quot;@context&quot;: &quot;http://schema.org&quot;, &nbsp;</div></li><li><div>          &quot;@type&quot;: &quot;WebSite&quot;, &nbsp;</div></li><li><div>EOF;&nbsp;</div></li><li><div>        if ( ! empty( $name_block ) ) {&nbsp;</div></li><li><div>            $search_box .= $name_block;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( ! empty( $search_block ) ) {&nbsp;</div></li><li><div>            $search_box .= $search_block;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $search_box .= &lt;&lt;&lt;EOF&nbsp;</div></li><li><div>          &quot;url&quot;: &quot;{$home_url}/&quot;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&lt;/script&gt;&nbsp;</div></li><li><div>EOF;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return apply_filters( 'aiosp_sitelinks_search_box', $search_box );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $post&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_google_authorship( $post ) {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        $page = $this-&gt;get_page_number();&nbsp;</div></li><li><div>        // Handle authorship.&nbsp;</div></li><li><div>        $googleplus = $publisher = $author = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $post ) && isset( $post-&gt;post_author ) && empty( $aioseop_options['aiosp_google_disable_profile'] ) ) {&nbsp;</div></li><li><div>            $googleplus = get_the_author_meta( 'googleplus', $post-&gt;post_author );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $googleplus ) && ! empty( $aioseop_options['aiosp_google_publisher'] ) ) {&nbsp;</div></li><li><div>            $googleplus = $aioseop_options['aiosp_google_publisher'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_front_page() && ( $page &lt; 2 ) ) {&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_google_publisher'] ) ) {&nbsp;</div></li><li><div>                $publisher = $aioseop_options['aiosp_google_publisher'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_google_author_advanced'] ) ) {&nbsp;</div></li><li><div>                if ( empty( $aioseop_options['aiosp_google_enable_publisher'] ) ) {&nbsp;</div></li><li><div>                    $publisher = '';&nbsp;</div></li><li><div>                } elseif ( ! empty( $aioseop_options['aiosp_google_specify_publisher'] ) ) {&nbsp;</div></li><li><div>                    $publisher = $aioseop_options['aiosp_google_specify_publisher'];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( is_singular() && ( ! empty( $googleplus ) ) ) {&nbsp;</div></li><li><div>            $author = $googleplus;&nbsp;</div></li><li><div>        } else if ( ! empty( $aioseop_options['aiosp_google_publisher'] ) ) {&nbsp;</div></li><li><div>            $author = $aioseop_options['aiosp_google_publisher'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_google_author_advanced'] ) && isset( $aioseop_options['aiosp_google_author_location'] ) ) {&nbsp;</div></li><li><div>            if ( empty( $aioseop_options['aiosp_google_author_location'] ) ) {&nbsp;</div></li><li><div>                $aioseop_options['aiosp_google_author_location'] = array();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( is_front_page() && ! in_array( 'front', $aioseop_options['aiosp_google_author_location'] ) ) {&nbsp;</div></li><li><div>                $author = '';&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                if ( in_array( 'all', $aioseop_options['aiosp_google_author_location'] ) ) {&nbsp;</div></li><li><div>                    if ( is_singular() && ! is_singular( $aioseop_options['aiosp_google_author_location'] ) ) {&nbsp;</div></li><li><div>                        $author = '';&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    if ( ! is_singular( $aioseop_options['aiosp_google_author_location'] ) ) {&nbsp;</div></li><li><div>                        $author = '';&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return array( 'publisher' =&gt; $publisher, 'author' =&gt; $author );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param null $post&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_prev_next_links( $post = null ) {&nbsp;</div></li><li><div>        $prev = $next = '';&nbsp;</div></li><li><div>        $page = $this-&gt;get_page_number();&nbsp;</div></li><li><div>        if ( is_home() || is_archive() || is_paged() ) {&nbsp;</div></li><li><div>            global $wp_query;&nbsp;</div></li><li><div>            $max_page = $wp_query-&gt;max_num_pages;&nbsp;</div></li><li><div>            if ( $page &gt; 1 ) {&nbsp;</div></li><li><div>                $prev = get_previous_posts_page_link();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( $page &lt; $max_page ) {&nbsp;</div></li><li><div>                $paged = $GLOBALS['paged'];&nbsp;</div></li><li><div>                if ( ! is_single() ) {&nbsp;</div></li><li><div>                    if ( ! $paged ) {&nbsp;</div></li><li><div>                        $paged = 1;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $nextpage = intval( $paged ) + 1;&nbsp;</div></li><li><div>                    if ( ! $max_page || $max_page &gt;= $nextpage ) {&nbsp;</div></li><li><div>                        $next = get_pagenum_link( $nextpage );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else if ( is_page() || is_single() ) {&nbsp;</div></li><li><div>            $numpages = 1;&nbsp;</div></li><li><div>            $multipage = 0;&nbsp;</div></li><li><div>            $page = get_query_var( 'page' );&nbsp;</div></li><li><div>            if ( ! $page ) {&nbsp;</div></li><li><div>                $page = 1;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( is_single() || is_page() || is_feed() ) {&nbsp;</div></li><li><div>                $more = 1;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $content = $post-&gt;post_content;&nbsp;</div></li><li><div>            if ( false !== strpos( $content, '&lt;!--nextpage--&gt;' ) ) {&nbsp;</div></li><li><div>                if ( $page &gt; 1 ) {&nbsp;</div></li><li><div>                    $more = 1;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $content = str_replace( &quot;\n&lt;!--nextpage--&gt;\n&quot;, '&lt;!--nextpage--&gt;', $content );&nbsp;</div></li><li><div>                $content = str_replace( &quot;\n&lt;!--nextpage--&gt;&quot;, '&lt;!--nextpage--&gt;', $content );&nbsp;</div></li><li><div>                $content = str_replace( &quot;&lt;!--nextpage--&gt;\n&quot;, '&lt;!--nextpage--&gt;', $content );&nbsp;</div></li><li><div>                // Ignore nextpage at the beginning of the content.&nbsp;</div></li><li><div>                if ( 0 === strpos( $content, '&lt;!--nextpage--&gt;' ) ) {&nbsp;</div></li><li><div>                    $content = substr( $content, 15 );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $pages = explode( '&lt;!--nextpage--&gt;', $content );&nbsp;</div></li><li><div>                $numpages = count( $pages );&nbsp;</div></li><li><div>                if ( $numpages &gt; 1 ) {&nbsp;</div></li><li><div>                    $multipage = 1;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! empty( $page ) ) {&nbsp;</div></li><li><div>                if ( $page &gt; 1 ) {&nbsp;</div></li><li><div>                    $prev = _wp_link_page( $page - 1 );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( $page + 1 &lt;= $numpages ) {&nbsp;</div></li><li><div>                    $next = _wp_link_page( $page + 1 );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! empty( $prev ) ) {&nbsp;</div></li><li><div>                $prev = $this-&gt;substr( $prev, 9, - 2 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! empty( $next ) ) {&nbsp;</div></li><li><div>                $next = $this-&gt;substr( $next, 9, - 2 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return array( 'prev' =&gt; $prev, 'next' =&gt; $next );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Validates whether the url should be https or http.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Mainly we're just using this for canonical URLS, but eventually it may be useful for other things&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param $url&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string $url&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 2.3.5&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function validate_url_scheme( $url ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // TODO we should check for the site setting in the case of auto.&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( ! isset( $aioseop_options['aiosp_can_set_protocol'] ) ) {&nbsp;</div></li><li><div>            return $url; // Just send the url back if there's nothing there.&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $aioseop_options['aiosp_can_set_protocol'] == 'http' ) {&nbsp;</div></li><li><div>            $url = preg_replace( '/^https:/i', 'http:', $url );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $aioseop_options['aiosp_can_set_protocol'] == 'https' ) {&nbsp;</div></li><li><div>            $url = preg_replace( '/^http:/i', 'https:', $url );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $url;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $options&nbsp;</div></li><li><div>     * @param $location&nbsp;</div></li><li><div>     * @param $settings&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function override_options( $options, $location, $settings ) {&nbsp;</div></li><li><div>        if ( class_exists( 'DOMDocument' ) ) {&nbsp;</div></li><li><div>            $options['aiosp_google_connect'] = $settings['aiosp_google_connect']['default'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $options;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function aiosp_google_analytics() {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        $analytics = '';&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_ga_advanced_options'] ) && ! empty( $aioseop_options['aiosp_ga_exclude_users'] ) ) {&nbsp;</div></li><li><div>            if ( is_user_logged_in() ) {&nbsp;</div></li><li><div>                global $current_user;&nbsp;</div></li><li><div>                if ( empty( $current_user ) ) {&nbsp;</div></li><li><div>                    wp_get_current_user();&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( ! empty( $current_user ) ) {&nbsp;</div></li><li><div>                    $intersect = array_intersect( $aioseop_options['aiosp_ga_exclude_users'], $current_user-&gt;roles );&nbsp;</div></li><li><div>                    if ( ! empty( $intersect ) ) {&nbsp;</div></li><li><div>                        return;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_google_analytics_id'] ) ) {&nbsp;</div></li><li><div>            ob_start();&nbsp;</div></li><li><div>            $analytics = $this-&gt;universal_analytics();&nbsp;</div></li><li><div>            echo $analytics;&nbsp;</div></li><li><div>            if ( empty( $analytics ) ) {&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>                    var _gaq = _gaq || [];&nbsp;</div></li><li><div>                    &lt;?php if ( ! empty( $aioseop_options['aiosp_ga_advanced_options'] ) && ! empty( $aioseop_options['aiosp_ga_link_attribution'] ) ) {&nbsp;</div></li><li><div>                    ?&gt;        var pluginUrl =&nbsp;</div></li><li><div>                        '//www.google-analytics.com/plugins/ga/inpage_linkid.js';&nbsp;</div></li><li><div>                    _gaq.push(['_require', 'inpage_linkid', pluginUrl]);&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    ?&gt;          _gaq.push(['_setAccount', '&lt;?php&nbsp;</div></li><li><div>                        echo $aioseop_options['aiosp_google_analytics_id'];&nbsp;</div></li><li><div>                        ?&gt;']);&nbsp;</div></li><li><div>                    &lt;?php if ( ! empty( $aioseop_options['aiosp_ga_advanced_options'] ) && ! empty( $aioseop_options['aiosp_ga_anonymize_ip'] ) ) {&nbsp;</div></li><li><div>                    ?&gt;          _gaq.push(['_gat._anonymizeIp']);&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                    &lt;?php if ( ! empty( $aioseop_options['aiosp_ga_advanced_options'] ) && ! empty( $aioseop_options['aiosp_ga_multi_domain'] ) ) {&nbsp;</div></li><li><div>                    ?&gt;          _gaq.push(['_setAllowLinker', true]);&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                    &lt;?php if ( ! empty( $aioseop_options['aiosp_ga_advanced_options'] ) && ! empty( $aioseop_options['aiosp_ga_domain'] ) ) {&nbsp;</div></li><li><div>                    $domain = $this-&gt;get_analytics_domain();&nbsp;</div></li><li><div>                    ?&gt;          _gaq.push(['_setDomainName', '&lt;?php echo $domain; ?&gt;']);&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    ?&gt;          _gaq.push(['_trackPageview']);&nbsp;</div></li><li><div>                    (function () {&nbsp;</div></li><li><div>                        var ga = document.createElement('script');&nbsp;</div></li><li><div>                        ga.type = 'text/javascript';&nbsp;</div></li><li><div>                        ga.async = true;&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                        if ( ! empty( $aioseop_options['aiosp_ga_advanced_options'] ) && ! empty( $aioseop_options['aiosp_ga_display_advertising'] ) ) {&nbsp;</div></li><li><div>                        ?&gt;            ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                        } else {&nbsp;</div></li><li><div>                        ?&gt;            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        ?&gt;            var s = document.getElementsByTagName('script')[0];&nbsp;</div></li><li><div>                        s.parentNode.insertBefore(ga, s);&nbsp;</div></li><li><div>                    })();&nbsp;</div></li><li><div>                &lt;/script&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_ga_advanced_options'] ) && $aioseop_options['aiosp_ga_track_outbound_links'] ) { ?&gt;&nbsp;</div></li><li><div>                &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>                    function recordOutboundLink(link, category, action) {&nbsp;</div></li><li><div>                        &lt;?php if ( ! empty( $aioseop_options['aiosp_ga_use_universal_analytics'] ) ) { ?&gt;&nbsp;</div></li><li><div>                        ga('send', 'event', category, action);&nbsp;</div></li><li><div>                        &lt;?php }&nbsp;</div></li><li><div>                        if ( empty( $aioseop_options['aiosp_ga_use_universal_analytics'] ) ) {    ?&gt;&nbsp;</div></li><li><div>                        _gat._getTrackerByName()._trackEvent(category, action);&nbsp;</div></li><li><div>                        &lt;?php } ?&gt;&nbsp;</div></li><li><div>                        if (link.target == '_blank') return true;&nbsp;</div></li><li><div>                        setTimeout('document.location = &quot;' + link.href + '&quot;', 100);&nbsp;</div></li><li><div>                        return false;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    /* use regular Javascript for this */&nbsp;</div></li><li><div>                    function getAttr(ele, attr) {&nbsp;</div></li><li><div>                        var result = (ele.getAttribute && ele.getAttribute(attr)) || null;&nbsp;</div></li><li><div>                        if (!result) {&nbsp;</div></li><li><div>                            var attrs = ele.attributes;&nbsp;</div></li><li><div>                            var length = attrs.length;&nbsp;</div></li><li><div>                            for (var i = 0; i &lt; length; i++)&nbsp;</div></li><li><div>                                if (attr[i].nodeName === attr) result = attr[i].nodeValue;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        return result;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    function aiosp_addLoadEvent(func) {&nbsp;</div></li><li><div>                        var oldonload = window.onload;&nbsp;</div></li><li><div>                        if (typeof window.onload != 'function') {&nbsp;</div></li><li><div>                            window.onload = func;&nbsp;</div></li><li><div>                        } else {&nbsp;</div></li><li><div>                            window.onload = function () {&nbsp;</div></li><li><div>                                if (oldonload) {&nbsp;</div></li><li><div>                                    oldonload();&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>                                func();&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    function aiosp_addEvent(element, evnt, funct) {&nbsp;</div></li><li><div>                        if (element.attachEvent)&nbsp;</div></li><li><div>                            return element.attachEvent('on' + evnt, funct);&nbsp;</div></li><li><div>                        else&nbsp;</div></li><li><div>                            return element.addEventListener(evnt, funct, false);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    aiosp_addLoadEvent(function () {&nbsp;</div></li><li><div>                        var links = document.getElementsByTagName('a');&nbsp;</div></li><li><div>                        for (var x = 0; x &lt; links.length; x++) {&nbsp;</div></li><li><div>                            if (typeof links[x] == 'undefined') continue;&nbsp;</div></li><li><div>                            aiosp_addEvent(links[x], 'onclick', function () {&nbsp;</div></li><li><div>                                var mydomain = new RegExp(document.domain, 'i');&nbsp;</div></li><li><div>                                href = getAttr(this, 'href');&nbsp;</div></li><li><div>                                if (href && href.toLowerCase().indexOf('http') === 0 && !mydomain.test(href)) {&nbsp;</div></li><li><div>                                    recordOutboundLink(this, 'Outbound Links', href);&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>                            });&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    });&nbsp;</div></li><li><div>                &lt;/script&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $analytics = ob_get_clean();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        echo apply_filters( 'aiosp_google_analytics', $analytics );&nbsp;</div></li><li><div>        do_action( 'after_aiosp_google_analytics' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function universal_analytics() {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        $analytics = '';&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_ga_use_universal_analytics'] ) ) {&nbsp;</div></li><li><div>            $allow_linker = $cookie_domain = $domain = $addl_domains = $domain_list = '';&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_ga_advanced_options'] ) ) {&nbsp;</div></li><li><div>                $cookie_domain = $this-&gt;get_analytics_domain();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! empty( $cookie_domain ) ) {&nbsp;</div></li><li><div>                $cookie_domain = esc_js( $cookie_domain );&nbsp;</div></li><li><div>                $cookie_domain = &quot;'cookieDomain': '{$cookie_domain}'&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $cookie_domain ) ) {&nbsp;</div></li><li><div>                $domain = &quot;, 'auto'&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_ga_advanced_options'] ) && ! empty( $aioseop_options['aiosp_ga_multi_domain'] ) ) {&nbsp;</div></li><li><div>                $allow_linker = &quot;'allowLinker': true&quot;;&nbsp;</div></li><li><div>                if ( ! empty( $aioseop_options['aiosp_ga_addl_domains'] ) ) {&nbsp;</div></li><li><div>                    $addl_domains = trim( $aioseop_options['aiosp_ga_addl_domains'] );&nbsp;</div></li><li><div>                    $addl_domains = preg_split( '/[\s, ]+/', $addl_domains );&nbsp;</div></li><li><div>                    if ( ! empty( $addl_domains ) ) {&nbsp;</div></li><li><div>                        foreach ( $addl_domains as $d ) {&nbsp;</div></li><li><div>                            $d = $this-&gt;sanitize_domain( $d );&nbsp;</div></li><li><div>                            if ( ! empty( $d ) ) {&nbsp;</div></li><li><div>                                if ( ! empty( $domain_list ) ) {&nbsp;</div></li><li><div>                                    $domain_list .= ', ';&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>                                $domain_list .= &quot;'&quot; . $d . &quot;'&quot;;&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $extra_options = '';&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_ga_advanced_options'] ) && ! empty( $aioseop_options['aiosp_ga_display_advertising'] ) ) {&nbsp;</div></li><li><div>                $extra_options .= &quot;ga('require', 'displayfeatures');&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_ga_advanced_options'] ) && ! empty( $aioseop_options['aiosp_ga_enhanced_ecommerce'] ) ) {&nbsp;</div></li><li><div>                if ( ! empty( $extra_options ) ) {&nbsp;</div></li><li><div>                    $extra_options .= &quot;\n\t\t\t&quot;;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $extra_options .= &quot;ga('require', 'ec');&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! empty( $domain_list ) ) {&nbsp;</div></li><li><div>                if ( ! empty( $extra_options ) ) {&nbsp;</div></li><li><div>                    $extra_options .= &quot;\n\t\t\t&quot;;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $extra_options .= &quot;ga('require', 'linker');\n\t\t\tga('linker:autoLink', [{$domain_list}] );&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_ga_advanced_options'] ) && ! empty( $aioseop_options['aiosp_ga_link_attribution'] ) ) {&nbsp;</div></li><li><div>                if ( ! empty( $extra_options ) ) {&nbsp;</div></li><li><div>                    $extra_options .= &quot;\n\t\t\t&quot;;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $extra_options .= &quot;ga('require', 'linkid', 'linkid.js');&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( ! empty( $aioseop_options['aiosp_ga_advanced_options'] ) && ! empty( $aioseop_options['aiosp_ga_anonymize_ip'] ) ) {&nbsp;</div></li><li><div>                if ( ! empty( $extra_options ) ) {&nbsp;</div></li><li><div>                    $extra_options .= &quot;\n\t\t\t&quot;;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $extra_options .= &quot;ga('set', 'anonymizeIp', true);&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $js_options = array();&nbsp;</div></li><li><div>            foreach ( array( 'cookie_domain', 'allow_linker' ) as $opts ) {&nbsp;</div></li><li><div>                if ( ! empty( $$opts ) ) {&nbsp;</div></li><li><div>                    $js_options[] = $$opts;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! empty( $js_options ) ) {&nbsp;</div></li><li><div>                $js_options = join( ', ', $js_options );&nbsp;</div></li><li><div>                $js_options = ', { ' . $js_options . ' } ';&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $js_options = '';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $analytics_id = esc_js( $aioseop_options['aiosp_google_analytics_id'] );&nbsp;</div></li><li><div>            $analytics = &lt;&lt;&lt;EOF&nbsp;</div></li><li><div>            &lt;script&gt;&nbsp;</div></li><li><div>            (function(i, s, o, g, r, a, m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {&nbsp;</div></li><li><div>            (i[r].q=i[r].q||[]).push(arguments)}, i[r].l=1*new Date();a=s.createElement(o), &nbsp;</div></li><li><div>            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a, m)&nbsp;</div></li><li><div>            })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            ga('create', '{$analytics_id}'{$domain}{$js_options});&nbsp;</div></li><li><div>            {$extra_options}&nbsp;</div></li><li><div>            ga('send', 'pageview');&nbsp;</div></li><li><div>            &lt;/script&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>EOF;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $analytics;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed|string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_analytics_domain() {&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_ga_domain'] ) ) {&nbsp;</div></li><li><div>            return $this-&gt;sanitize_domain( $aioseop_options['aiosp_ga_domain'] );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return '';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $id&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return bool&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function save_post_data( $id ) {&nbsp;</div></li><li><div>        $awmp_edit = $nonce = null;&nbsp;</div></li><li><div>        if ( empty( $_POST ) ) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( isset( $_POST['aiosp_edit'] ) ) {&nbsp;</div></li><li><div>            $awmp_edit = $_POST['aiosp_edit'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( isset( $_POST['nonce-aioseop-edit'] ) ) {&nbsp;</div></li><li><div>            $nonce = $_POST['nonce-aioseop-edit'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( isset( $awmp_edit ) && ! empty( $awmp_edit ) && wp_verify_nonce( $nonce, 'edit-aioseop-nonce' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $optlist = array(&nbsp;</div></li><li><div>                'keywords', &nbsp;</div></li><li><div>                'description', &nbsp;</div></li><li><div>                'title', &nbsp;</div></li><li><div>                'custom_link', &nbsp;</div></li><li><div>                'sitemap_exclude', &nbsp;</div></li><li><div>                'disable', &nbsp;</div></li><li><div>                'disable_analytics', &nbsp;</div></li><li><div>                'noindex', &nbsp;</div></li><li><div>                'nofollow', &nbsp;</div></li><li><div>                'noodp', &nbsp;</div></li><li><div>                'noydir', &nbsp;</div></li><li><div>                'titleatr', &nbsp;</div></li><li><div>                'menulabel', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            if ( ! ( ! empty( $this-&gt;options['aiosp_can'] ) ) && ( ! empty( $this-&gt;options['aiosp_customize_canonical_links'] ) ) ) {&nbsp;</div></li><li><div>                unset( $optlist['custom_link'] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            foreach ( $optlist as $f ) {&nbsp;</div></li><li><div>                $field = &quot;aiosp_$f&quot;;&nbsp;</div></li><li><div>                if ( isset( $_POST[ $field ] ) ) {&nbsp;</div></li><li><div>                    $$field = $_POST[ $field ];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $optlist = array(&nbsp;</div></li><li><div>                'keywords', &nbsp;</div></li><li><div>                'description', &nbsp;</div></li><li><div>                'title', &nbsp;</div></li><li><div>                'custom_link', &nbsp;</div></li><li><div>                'noindex', &nbsp;</div></li><li><div>                'nofollow', &nbsp;</div></li><li><div>                'noodp', &nbsp;</div></li><li><div>                'noydir', &nbsp;</div></li><li><div>                'titleatr', &nbsp;</div></li><li><div>                'menulabel', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            if ( ! ( ! empty( $this-&gt;options['aiosp_can'] ) ) && ( ! empty( $this-&gt;options['aiosp_customize_canonical_links'] ) ) ) {&nbsp;</div></li><li><div>                unset( $optlist['custom_link'] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            foreach ( $optlist as $f ) {&nbsp;</div></li><li><div>                delete_post_meta( $id, &quot;_aioseop_{$f}&quot; );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $this-&gt;is_admin() ) {&nbsp;</div></li><li><div>                delete_post_meta( $id, '_aioseop_sitemap_exclude' );&nbsp;</div></li><li><div>                delete_post_meta( $id, '_aioseop_disable' );&nbsp;</div></li><li><div>                delete_post_meta( $id, '_aioseop_disable_analytics' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $optlist as $f ) {&nbsp;</div></li><li><div>                $var = &quot;aiosp_$f&quot;;&nbsp;</div></li><li><div>                $field = &quot;_aioseop_$f&quot;;&nbsp;</div></li><li><div>                if ( isset( $$var ) && ! empty( $$var ) ) {&nbsp;</div></li><li><div>                    add_post_meta( $id, $field, $$var );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( isset( $aiosp_sitemap_exclude ) && ! empty( $aiosp_sitemap_exclude ) && $this-&gt;is_admin() ) {&nbsp;</div></li><li><div>                add_post_meta( $id, '_aioseop_sitemap_exclude', $aiosp_sitemap_exclude );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( isset( $aiosp_disable ) && ! empty( $aiosp_disable ) && $this-&gt;is_admin() ) {&nbsp;</div></li><li><div>                add_post_meta( $id, '_aioseop_disable', $aiosp_disable );&nbsp;</div></li><li><div>                if ( isset( $aiosp_disable_analytics ) && ! empty( $aiosp_disable_analytics ) ) {&nbsp;</div></li><li><div>                    add_post_meta( $id, '_aioseop_disable_analytics', $aiosp_disable_analytics );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $post&nbsp;</div></li><li><div>     * @param $metabox&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function display_tabbed_metabox( $post, $metabox ) {&nbsp;</div></li><li><div>        $tabs = $metabox['args'];&nbsp;</div></li><li><div>        echo '&lt;div class=&quot;aioseop_tabs&quot;&gt;';&nbsp;</div></li><li><div>        $header = $this-&gt;get_metabox_header( $tabs );&nbsp;</div></li><li><div>        echo $header;&nbsp;</div></li><li><div>        $active = '';&nbsp;</div></li><li><div>        foreach ( $tabs as $m ) {&nbsp;</div></li><li><div>            echo '&lt;div id=&quot;' . $m['id'] . '&quot; class=&quot;aioseop_tab&quot;' . $active . '&gt;';&nbsp;</div></li><li><div>            if ( ! $active ) {&nbsp;</div></li><li><div>                $active = ' style=&quot;display:none;&quot;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $m['args'] = $m['callback_args'];&nbsp;</div></li><li><div>            $m['callback'][0]-&gt;{$m['callback'][1]}( $post, $m );&nbsp;</div></li><li><div>            echo '&lt;/div&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        echo '&lt;/div&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $tabs&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_metabox_header( $tabs ) {&nbsp;</div></li><li><div>        $header = '&lt;ul class=&quot;aioseop_header_tabs hide&quot;&gt;';&nbsp;</div></li><li><div>        $active = ' active';&nbsp;</div></li><li><div>        foreach ( $tabs as $t ) {&nbsp;</div></li><li><div>            if ( $active ) {&nbsp;</div></li><li><div>                $title = __( 'Main Settings', 'all-in-one-seo-pack' );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $title = $t['title'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $header .= '&lt;li&gt;&lt;label class=&quot;aioseop_header_nav&quot;&gt;&lt;a class=&quot;aioseop_header_tab' . $active . '&quot; href=&quot;#' . $t['id'] . '&quot;&gt;' . $title . '&lt;/a&gt;&lt;/label&gt;&lt;/li&gt;';&nbsp;</div></li><li><div>            $active = '';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $header .= '&lt;/ul&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $header;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function admin_bar_menu() {&nbsp;</div></li><li><div>        global $wp_admin_bar, $aioseop_admin_menu, $aioseop_options, $post;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $toggle = '';&nbsp;</div></li><li><div>        if ( isset( $_POST['aiosp_use_original_title'] ) && isset( $_POST['aiosp_admin_bar'] ) ) {&nbsp;</div></li><li><div>            $toggle = 'on';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( isset( $_POST['aiosp_use_original_title'] ) && ! isset( $_POST['aiosp_admin_bar'] ) ) {&nbsp;</div></li><li><div>            $toggle = 'off';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $aioseop_options['aiosp_admin_bar'] ) && $toggle != 'off' || isset( $_POST['aiosp_admin_bar'] ) ) {&nbsp;</div></li><li><div>            $menu_slug = plugin_basename( __FILE__ );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $url = '';&nbsp;</div></li><li><div>            if ( function_exists( 'menu_page_url' ) ) {&nbsp;</div></li><li><div>                $url = menu_page_url( $menu_slug, 0 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( empty( $url ) ) {&nbsp;</div></li><li><div>                $url = esc_url( admin_url( 'admin.php?page=' . $menu_slug ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $wp_admin_bar-&gt;add_menu( array(&nbsp;</div></li><li><div>                'id' =&gt; AIOSEOP_PLUGIN_DIRNAME, &nbsp;</div></li><li><div>                'title' =&gt; __( 'SEO', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                'href' =&gt; $url, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( current_user_can( 'update_plugins' ) && ! AIOSEOPPRO ) {&nbsp;</div></li><li><div>                $wp_admin_bar-&gt;add_menu( array(&nbsp;</div></li><li><div>                    'parent' =&gt; AIOSEOP_PLUGIN_DIRNAME, &nbsp;</div></li><li><div>                    'title' =&gt; __( 'Upgrade To Pro', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                    'id' =&gt; 'aioseop-pro-upgrade', &nbsp;</div></li><li><div>                    'href' =&gt; 'http://semperplugins.com/plugins/all-in-one-seo-pack-pro-version/?loc=menu', &nbsp;</div></li><li><div>                    'meta' =&gt; array( 'target' =&gt; '_blank' ), &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>                // add_action( 'admin_bar_menu', array( $this, 'admin_bar_upgrade_menu' ), 1101 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $aioseop_admin_menu = 1;&nbsp;</div></li><li><div>            if ( ! is_admin() && ! empty( $post ) ) {&nbsp;</div></li><li><div>                $blog_page = aiosp_common::get_blog_page( $post );&nbsp;</div></li><li><div>                if ( ! empty( $blog_page ) ) {&nbsp;</div></li><li><div>                    $post = $blog_page;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $wp_admin_bar-&gt;add_menu( array(&nbsp;</div></li><li><div>                    'id' =&gt; 'aiosp_edit_' . $post-&gt;ID, &nbsp;</div></li><li><div>                    'parent' =&gt; AIOSEOP_PLUGIN_DIRNAME, &nbsp;</div></li><li><div>                    'title' =&gt; __( 'Edit SEO', 'all-in-one-seo-pack' ), &nbsp;</div></li><li><div>                    'href' =&gt; get_edit_post_link( $post-&gt;ID ) . '#aiosp', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Order for adding the menus for the aioseop_modules_add_menus hook.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function menu_order() {&nbsp;</div></li><li><div>        return 5;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $tax&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function display_category_metaboxes( $tax ) {&nbsp;</div></li><li><div>        $screen = 'edit-' . $tax-&gt;taxonomy;&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;div id=&quot;poststuff&quot;&gt;&nbsp;</div></li><li><div>            &lt;?php do_meta_boxes( '', 'advanced', $tax ); ?&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $id&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function save_category_metaboxes( $id ) {&nbsp;</div></li><li><div>        $awmp_edit = $nonce = null;&nbsp;</div></li><li><div>        if ( isset( $_POST['aiosp_edit'] ) ) {&nbsp;</div></li><li><div>            $awmp_edit = $_POST['aiosp_edit'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( isset( $_POST['nonce-aioseop-edit'] ) ) {&nbsp;</div></li><li><div>            $nonce = $_POST['nonce-aioseop-edit'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( isset( $awmp_edit ) && ! empty( $awmp_edit ) && wp_verify_nonce( $nonce, 'edit-aioseop-nonce' ) ) {&nbsp;</div></li><li><div>            $optlist = array(&nbsp;</div></li><li><div>                'keywords', &nbsp;</div></li><li><div>                'description', &nbsp;</div></li><li><div>                'title', &nbsp;</div></li><li><div>                'custom_link', &nbsp;</div></li><li><div>                'sitemap_exclude', &nbsp;</div></li><li><div>                'disable', &nbsp;</div></li><li><div>                'disable_analytics', &nbsp;</div></li><li><div>                'noindex', &nbsp;</div></li><li><div>                'nofollow', &nbsp;</div></li><li><div>                'noodp', &nbsp;</div></li><li><div>                'noydir', &nbsp;</div></li><li><div>                'titleatr', &nbsp;</div></li><li><div>                'menulabel', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            foreach ( $optlist as $f ) {&nbsp;</div></li><li><div>                $field = &quot;aiosp_$f&quot;;&nbsp;</div></li><li><div>                if ( isset( $_POST[ $field ] ) ) {&nbsp;</div></li><li><div>                    $$field = $_POST[ $field ];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $optlist = array(&nbsp;</div></li><li><div>                'keywords', &nbsp;</div></li><li><div>                'description', &nbsp;</div></li><li><div>                'title', &nbsp;</div></li><li><div>                'custom_link', &nbsp;</div></li><li><div>                'noindex', &nbsp;</div></li><li><div>                'nofollow', &nbsp;</div></li><li><div>                'noodp', &nbsp;</div></li><li><div>                'noydir', &nbsp;</div></li><li><div>                'titleatr', &nbsp;</div></li><li><div>                'menulabel', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            if ( ! ( ! empty( $this-&gt;options['aiosp_can'] ) ) && ( ! empty( $this-&gt;options['aiosp_customize_canonical_links'] ) ) ) {&nbsp;</div></li><li><div>                unset( $optlist['custom_link'] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            foreach ( $optlist as $f ) {&nbsp;</div></li><li><div>                delete_term_meta( $id, &quot;_aioseop_{$f}&quot; );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $this-&gt;is_admin() ) {&nbsp;</div></li><li><div>                delete_term_meta( $id, '_aioseop_sitemap_exclude' );&nbsp;</div></li><li><div>                delete_term_meta( $id, '_aioseop_disable' );&nbsp;</div></li><li><div>                delete_term_meta( $id, '_aioseop_disable_analytics' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $optlist as $f ) {&nbsp;</div></li><li><div>                $var = &quot;aiosp_$f&quot;;&nbsp;</div></li><li><div>                $field = &quot;_aioseop_$f&quot;;&nbsp;</div></li><li><div>                if ( isset( $$var ) && ! empty( $$var ) ) {&nbsp;</div></li><li><div>                    add_term_meta( $id, $field, $$var );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( isset( $aiosp_sitemap_exclude ) && ! empty( $aiosp_sitemap_exclude ) && $this-&gt;is_admin() ) {&nbsp;</div></li><li><div>                add_term_meta( $id, '_aioseop_sitemap_exclude', $aiosp_sitemap_exclude );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( isset( $aiosp_disable ) && ! empty( $aiosp_disable ) && $this-&gt;is_admin() ) {&nbsp;</div></li><li><div>                add_term_meta( $id, '_aioseop_disable', $aiosp_disable );&nbsp;</div></li><li><div>                if ( isset( $aiosp_disable_analytics ) && ! empty( $aiosp_disable_analytics ) ) {&nbsp;</div></li><li><div>                    add_term_meta( $id, '_aioseop_disable_analytics', $aiosp_disable_analytics );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function admin_menu() {&nbsp;</div></li><li><div>        $file = plugin_basename( __FILE__ );&nbsp;</div></li><li><div>        $menu_name = __( 'All in One SEO', 'all-in-one-seo-pack' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;locations['aiosp']['default_options']['nonce-aioseop-edit']['default'] = wp_create_nonce( 'edit-aioseop-nonce' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $custom_menu_order = false;&nbsp;</div></li><li><div>        global $aioseop_options;&nbsp;</div></li><li><div>        if ( ! isset( $aioseop_options['custom_menu_order'] ) ) {&nbsp;</div></li><li><div>            $custom_menu_order = true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;update_options();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;add_admin_pointers();&nbsp;</div></li><li><div>        if ( ! empty( $this-&gt;pointers ) ) {&nbsp;</div></li><li><div>            foreach ( $this-&gt;pointers as $k =&gt; $p ) {&nbsp;</div></li><li><div>                if ( ! empty( $p['pointer_scope'] ) && ( $p['pointer_scope'] == 'global' ) ) {&nbsp;</div></li><li><div>                    unset( $this-&gt;pointers[ $k ] );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $donated = false;&nbsp;</div></li><li><div>        if ( isset( $_POST ) && isset( $_POST['module'] ) && isset( $_POST['nonce-aioseop'] ) && ( $_POST['module'] == 'All_in_One_SEO_Pack' ) && wp_verify_nonce( $_POST['nonce-aioseop'], 'aioseop-nonce' ) ) {&nbsp;</div></li><li><div>            if ( isset( $_POST['aiosp_donate'] ) ) {&nbsp;</div></li><li><div>                $donated = $_POST['aiosp_donate'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( isset( $_POST['Submit'] ) ) {&nbsp;</div></li><li><div>                if ( isset( $_POST['aiosp_custom_menu_order'] ) ) {&nbsp;</div></li><li><div>                    $custom_menu_order = $_POST['aiosp_custom_menu_order'];&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $custom_menu_order = false;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } else if ( isset( $_POST['Submit_Default'] ) || isset( $_POST['Submit_All_Default'] ) ) {&nbsp;</div></li><li><div>                $custom_menu_order = true;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            if ( isset( $this-&gt;options['aiosp_donate'] ) ) {&nbsp;</div></li><li><div>                $donated = $this-&gt;options['aiosp_donate'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( isset( $this-&gt;options['aiosp_custom_menu_order'] ) ) {&nbsp;</div></li><li><div>                $custom_menu_order = $this-&gt;options['aiosp_custom_menu_order'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $custom_menu_order ) {&nbsp;</div></li><li><div>            add_filter( 'custom_menu_order', '__return_true' );&nbsp;</div></li><li><div>            add_filter( 'menu_order', array( $this, 'set_menu_order' ), 11 );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $donated ) {&nbsp;</div></li><li><div>            // Thank you for your donation.&nbsp;</div></li><li><div>            $this-&gt;pointers['aioseop_donate'] = array(&nbsp;</div></li><li><div>                'pointer_target' =&gt; '#aiosp_donate_wrapper', &nbsp;</div></li><li><div>                'pointer_text' =&gt; '&lt;h3&gt;' . __( 'Thank you!', 'all-in-one-seo-pack' )&nbsp;</div></li><li><div>                                    . '&lt;/h3&gt;&lt;p&gt;' . __( 'Thank you for your donation, it helps keep this plugin free and actively developed!', 'all-in-one-seo-pack' ) . '&lt;/p&gt;', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! AIOSEOPPRO ) {&nbsp;</div></li><li><div>            if ( ! empty( $this-&gt;pointers ) ) {&nbsp;</div></li><li><div>                foreach ( $this-&gt;pointers as $k =&gt; $p ) {&nbsp;</div></li><li><div>                    if ( ! empty( $p['pointer_scope'] ) && ( $p['pointer_scope'] == 'global' ) ) {&nbsp;</div></li><li><div>                        unset( $this-&gt;pointers[ $k ] );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $this-&gt;filter_pointers();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $this-&gt;options['aiosp_enablecpost'] ) && $this-&gt;options['aiosp_enablecpost'] ) {&nbsp;</div></li><li><div>            if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>                $this-&gt;locations['aiosp']['display'] = $this-&gt;options['aiosp_cpostactive'];&nbsp;</div></li><li><div>                if ( ! empty( $this-&gt;options['aiosp_taxactive'] ) ) {&nbsp;</div></li><li><div>                    foreach ( $this-&gt;options['aiosp_taxactive'] as $tax ) {&nbsp;</div></li><li><div>                        $this-&gt;locations['aiosp']['display'][] = 'edit-' . $tax;&nbsp;</div></li><li><div>                        add_action( &quot;{$tax}_edit_form&quot;, array( $this, 'display_category_metaboxes' ) );&nbsp;</div></li><li><div>                        add_action( &quot;edited_{$tax}&quot;, array( $this, 'save_category_metaboxes' ) );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                if ( ! empty( $this-&gt;options['aiosp_cpostactive'] ) ) {&nbsp;</div></li><li><div>                    $this-&gt;locations['aiosp']['display'] = $this-&gt;options['aiosp_cpostactive'];&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $this-&gt;locations['aiosp']['display'] = array();&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $this-&gt;locations['aiosp']['display'] = array( 'post', 'page' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_menu_page( $menu_name, $menu_name, apply_filters( 'manage_aiosp', 'aiosp_manage_seo' ), $file, array(&nbsp;</div></li><li><div>            $this, &nbsp;</div></li><li><div>            'display_settings_page', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_meta_box( 'aioseop-list', __( 'Join Our Mailing List', 'all-in-one-seo-pack' ), array(&nbsp;</div></li><li><div>            'aiosp_metaboxes', &nbsp;</div></li><li><div>            'display_extra_metaboxes', &nbsp;</div></li><li><div> ), 'aioseop_metaboxes', 'normal', 'core' );&nbsp;</div></li><li><div>        if ( AIOSEOPPRO ) {&nbsp;</div></li><li><div>            add_meta_box( 'aioseop-about', __( 'About', 'all-in-one-seo-pack' ), array(&nbsp;</div></li><li><div>                'aiosp_metaboxes', &nbsp;</div></li><li><div>                'display_extra_metaboxes', &nbsp;</div></li><li><div> ), 'aioseop_metaboxes', 'side', 'core' );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            add_meta_box( 'aioseop-about', &quot;About &lt;span class='Taha' style='float:right;'&gt;Version &lt;b&gt;&quot; . AIOSEOP_VERSION . '&lt;/b&gt;&lt;/span&gt;', array(&nbsp;</div></li><li><div>                'aiosp_metaboxes', &nbsp;</div></li><li><div>                'display_extra_metaboxes', &nbsp;</div></li><li><div> ), 'aioseop_metaboxes', 'side', 'core' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        add_meta_box( 'aioseop-support', __( 'Support', 'all-in-one-seo-pack' ) . &quot; &lt;span  class='Taha' style='float:right;'&gt;&quot; . __( 'Version', 'all-in-one-seo-pack' ) . ' &lt;b&gt;' . AIOSEOP_VERSION . '&lt;/b&gt;&lt;/span&gt;', array(&nbsp;</div></li><li><div>            'aiosp_metaboxes', &nbsp;</div></li><li><div>            'display_extra_metaboxes', &nbsp;</div></li><li><div> ), 'aioseop_metaboxes', 'side', 'core' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_action( 'aioseop_modules_add_menus', array( $this, 'add_menu' ), 5 );&nbsp;</div></li><li><div>        do_action( 'aioseop_modules_add_menus', $file );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $metaboxes = apply_filters( 'aioseop_add_post_metabox', array() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $metaboxes ) ) {&nbsp;</div></li><li><div>            if ( $this-&gt;tabbed_metaboxes ) {&nbsp;</div></li><li><div>                $tabs = array();&nbsp;</div></li><li><div>                $tab_num = 0;&nbsp;</div></li><li><div>                foreach ( $metaboxes as $m ) {&nbsp;</div></li><li><div>                    if ( ! isset( $tabs[ $m['post_type'] ] ) ) {&nbsp;</div></li><li><div>                        $tabs[ $m['post_type'] ] = array();&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $tabs[ $m['post_type'] ][] = $m;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( ! empty( $tabs ) ) {&nbsp;</div></li><li><div>                    foreach ( $tabs as $p =&gt; $m ) {&nbsp;</div></li><li><div>                        $tab_num = count( $m );&nbsp;</div></li><li><div>                        $title = $m[0]['title'];&nbsp;</div></li><li><div>                        if ( $title != $this-&gt;plugin_name ) {&nbsp;</div></li><li><div>                            $title = $this-&gt;plugin_name . ' - ' . $title;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        if ( $tab_num &lt;= 1 ) {&nbsp;</div></li><li><div>                            if ( ! empty( $m[0]['callback_args']['help_link'] ) ) {&nbsp;</div></li><li><div>                                $title .= &quot;&lt;a class='aioseop_help_text_link aioseop_meta_box_help' target='_blank' href='&quot; . $m[0]['callback_args']['help_link'] . &quot;'&gt;&lt;span&gt;&quot; . __( 'Help', 'all-in-one-seo-pack' ) . '&lt;/span&gt;&lt;/a&gt;';&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                            add_meta_box( $m[0]['id'], $title, $m[0]['callback'], $m[0]['post_type'], $m[0]['context'], $m[0]['priority'], $m[0]['callback_args'] );&nbsp;</div></li><li><div>                        } elseif ( $tab_num &gt; 1 ) {&nbsp;</div></li><li><div>                            add_meta_box( $m[0]['id'] . '_tabbed', $title, array(&nbsp;</div></li><li><div>                                $this, &nbsp;</div></li><li><div>                                'display_tabbed_metabox', &nbsp;</div></li><li><div> ), $m[0]['post_type'], $m[0]['context'], $m[0]['priority'], $m );&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                foreach ( $metaboxes as $m ) {&nbsp;</div></li><li><div>                    $title = $m['title'];&nbsp;</div></li><li><div>                    if ( $title != $this-&gt;plugin_name ) {&nbsp;</div></li><li><div>                        $title = $this-&gt;plugin_name . ' - ' . $title;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ( ! empty( $m['help_link'] ) ) {&nbsp;</div></li><li><div>                        $title .= &quot;&lt;a class='aioseop_help_text_link aioseop_meta_box_help' target='_blank' href='&quot; . $m['help_link'] . &quot;'&gt;&lt;span&gt;&quot; . __( 'Help', 'all-in-one-seo-pack' ) . '&lt;/span&gt;&lt;/a&gt;';&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    add_meta_box( $m['id'], $title, $m['callback'], $m['post_type'], $m['context'], $m['priority'], $m['callback_args'] );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $menu_order&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function set_menu_order( $menu_order ) {&nbsp;</div></li><li><div>        $order = array();&nbsp;</div></li><li><div>        $file = plugin_basename( __FILE__ );&nbsp;</div></li><li><div>        foreach ( $menu_order as $index =&gt; $item ) {&nbsp;</div></li><li><div>            if ( $item != $file ) {&nbsp;</div></li><li><div>                $order[] = $item;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( $index == 0 ) {&nbsp;</div></li><li><div>                $order[] = $file;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $order;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function display_settings_header() {&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function display_settings_footer() {&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function display_right_sidebar() {&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! get_option( 'aioseop_options' ) ) {&nbsp;</div></li><li><div>            $msg = &quot;&lt;div style='text-align:center;'&gt;&lt;p&gt;&lt;strong&gt;Your database options need to be updated.&lt;/strong&gt;&lt;em&gt;(Back up your database before updating.)&lt;/em&gt;&nbsp;</div></li><li><div>                &lt;FORM action='' method='post' name='aioseop-migrate-options'&gt;&nbsp;</div></li><li><div>                    &lt;input type='hidden' name='nonce-aioseop-migrate-options' value='&quot; . wp_create_nonce( 'aioseop-migrate-nonce-options' ) . &quot;' /&gt;&nbsp;</div></li><li><div>                    &lt;input type='submit' name='aioseop_migrate_options' class='button-primary' value='Update Database Options'&gt;&nbsp;</div></li><li><div>                 &lt;/FORM&gt;&nbsp;</div></li><li><div>            &lt;/p&gt;&lt;/div&gt;&quot;;&nbsp;</div></li><li><div>            aioseop_output_dismissable_notice( $msg, '', 'error' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;aioseop_top&quot;&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;aioseop_top_sidebar aioseop_options_wrapper&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php do_meta_boxes( 'aioseop_metaboxes', 'normal', array( 'test' ) ); ?&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;style&gt;&nbsp;</div></li><li><div>            #wpbody-content {&nbsp;</div></li><li><div>                min-width: 900px;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        &lt;/style&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;aioseop_right_sidebar aioseop_options_wrapper&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;div class=&quot;aioseop_sidebar&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                do_meta_boxes( 'aioseop_metaboxes', 'side', array( 'test' ) );&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>                    //&lt;![CDATA[&nbsp;</div></li><li><div>                    jQuery(document).ready(function ($) {&nbsp;</div></li><li><div>                        // Close postboxes that should be closed.&nbsp;</div></li><li><div>                        $('.if-js-closed').removeClass('if-js-closed').addClass('closed');&nbsp;</div></li><li><div>                        // Postboxes setup.&nbsp;</div></li><li><div>                        if (typeof postboxes !== 'undefined')&nbsp;</div></li><li><div>                            postboxes.add_postbox_toggles('&lt;?php echo $this-&gt;pagehook; ?&gt;');&nbsp;</div></li><li><div>                    });&nbsp;</div></li><li><div>                    //]]&gt;&nbsp;</div></li><li><div>                &lt;/script&gt;&nbsp;</div></li><li><div>                &lt;?php if ( ! AIOSEOPPRO ) { ?&gt;&nbsp;</div></li><li><div>                    &lt;div class=&quot;aioseop_advert aioseop_nopad_all&quot;&gt;&nbsp;</div></li><li><div>                        &lt;?php $adid = mt_rand( 21, 23 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        if ( $adid == 23 ) { ?&gt;&nbsp;</div></li><li><div>                            &lt;div&nbsp;</div></li><li><div>                                style=&quot;height: 220px; background-image: url('https://www.wincher.com/Content/Images/plugin/wp/banner30.jpg')&quot;&gt;&nbsp;</div></li><li><div>                                &lt;form style=&quot;position: relative; top: 170px; left: 40px;&quot;&nbsp;</div></li><li><div>                                      action=&quot;https://www.wincher.com/FastReg&quot; method=&quot;post&quot; target=&quot;_blank&quot;&gt;&nbsp;</div></li><li><div>                                    &lt;input type=&quot;hidden&quot; name=&quot;adreferer&quot; value=&quot;banner&lt;?php echo $adid; ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                                    &lt;input type=&quot;hidden&quot; name=&quot;referer&quot; value=&quot;all-in-one-seo-pack&quot;/&gt;&nbsp;</div></li><li><div>                                    &lt;input type=&quot;text&quot; name=&quot;email&quot; placeholder=&quot;Email&quot;&nbsp;</div></li><li><div>                                           style=&quot;padding-left: 7px; height: 30px; width: 290px; border: solid 1px #DDD;&quot;/&gt;&nbsp;</div></li><li><div>                                    &lt;input type=&quot;submit&quot; name=&quot;sub&quot; value=&quot;Sign up!&quot;&nbsp;</div></li><li><div>                                           style=&quot;height: 30px; width: 90px; background-color: #42DA76; color: #FFF; font-weight: bold; border:none; margin-left:5px;&quot;/&gt;&nbsp;</div></li><li><div>                                &lt;/form&gt;&nbsp;</div></li><li><div>                            &lt;/div&gt;&nbsp;</div></li><li><div>                            &lt;?&nbsp;</div></li><li><div>                        } else {&nbsp;</div></li><li><div>                            ?&gt;&nbsp;</div></li><li><div>                            &lt;a href=&quot;https://www.wincher.com/?referer=all-in-one-seo-pack&adreferer=banner&lt;?php echo $adid; ?&gt;&quot;&nbsp;</div></li><li><div>                               target=&quot;_blank&quot;&gt;&nbsp;</div></li><li><div>                                &lt;div class=wincherad id=wincher&lt;?php echo $adid; ?&gt;&gt;&nbsp;</div></li><li><div>                                &lt;/div&gt;&nbsp;</div></li><li><div>                            &lt;/a&gt;&nbsp;</div></li><li><div>                        &lt;?php } ?&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;div class=&quot;aioseop_advert headwaythemes&quot;&gt;&nbsp;</div></li><li><div>                        &lt;div&gt;&nbsp;</div></li><li><div>                            &lt;h3&gt;Drag and Drop WordPress Design&lt;/h3&gt;&nbsp;</div></li><li><div>                            &lt;p&gt;&lt;a href=&quot;http://semperfiwebdesign.com/headwayaio/&quot; target=&quot;_blank&quot;&gt;Headway Themes&lt;/a&gt;&nbsp;</div></li><li><div>                                allows you to easily create your own stunning website designs! Stop using premade themes&nbsp;</div></li><li><div>                                start making your own design with Headway's easy to use Drag and Drop interface. All in&nbsp;</div></li><li><div>                                One SEO Pack users have an exclusive discount by using coupon code&nbsp;</div></li><li><div>                                &lt;strong&gt;SEMPERFI30&lt;/strong&gt; at checkout.&lt;/p&gt;&nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>                        &lt;a href=&quot;http://semperfiwebdesign.com/headwayaio/&quot; target=&quot;_blank&quot;&gt;&lt;img&nbsp;</div></li><li><div>                                src=&quot;&lt;?php echo AIOSEOP_PLUGIN_IMAGES_URL; ?&gt;headwaybanner.png&quot;&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;?php } ?&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 2.3.7</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.2/classes/all_in_one_seo_pack/" class="">2.3.9.2</a></li><li><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.1/classes/all_in_one_seo_pack/" class="active">2.3.9.1</a></li><li><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9/classes/all_in_one_seo_pack/" class="">2.3.9</a></li><li><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.8/classes/all_in_one_seo_pack/" class="">2.3.8</a></li><li><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.7/classes/all_in_one_seo_pack/" class="">2.3.7</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>All_in_One_SEO_Pack</li><li><span></span>All In One SEO Pack</li><li><span></span>2.3.9.2</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2021 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>