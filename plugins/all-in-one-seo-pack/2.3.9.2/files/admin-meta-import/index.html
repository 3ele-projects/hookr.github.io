<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="2.3.9.2" data-slug="all-in-one-seo-pack" data-type="file" data-id="63359"><head xmlns="http://www.w3.org/1999/xhtml"><title> admin-meta-import | file | All In One Seo Pack | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, all-in-one-seo-pack, 2.3.9.2" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.17"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=2f52fe1a880d91d9fc6ab5ff8948bae5' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.17' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/admin-meta-import/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fadmin-meta-import%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fadmin-meta-import%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-all-in-one-seo-pack-2.3.9.2-file-admin-meta-import","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="admin-meta-import" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to all-in-one-seo-pack." href="http://hookr.io/plugins/all-in-one-seo-pack/" class="plugin"><span property="name">all-in-one-seo-pack</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.3.9.2." href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.2/" class="H_VERSION"><span property="name">2.3.9.2</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.2/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">admin-meta-import</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="218"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.2/all/" title="All">All <span class="count badge">218</span></a></li><li class="" data-id="new" data-count="6"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.2/new/" title="New">New <span class="count badge">6</span></a></li><li class="" data-id="hooks" data-count="108"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.2/hooks/" title="Hooks">Hooks <span class="count badge">108</span></a></li><li class="" data-id="action" data-count="19"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.2/actions/" title="Actions">Actions <span class="count badge">19</span></a></li><li class="" data-id="filter" data-count="89"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.2/filters/" title="Filters">Filters <span class="count badge">89</span></a></li><li class="" data-id="class" data-count="33"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.2/classes/" title="Classes">Classes <span class="count badge">33</span></a></li><li class="" data-id="constant" data-count="15"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.2/constants/" title="Constants">Constants <span class="count badge">15</span></a></li><li class="" data-id="function" data-count="62"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.2/functions/" title="Functions">Functions <span class="count badge">62</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/plugins/all-in-one-seo-pack/2.3.9.2/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/admin/meta_import.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( class_exists( 'WPSEO_Import_Hooks' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Class WPSEO_Import_AIOSEO_Hooks</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @TODO Move this elsewhere.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  class WPSEO_Import_AIOSEO_Hooks extends WPSEO_Import_Hooks {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected $plugin_file = 'all-in-one-seo-pack/all_in_one_seo_pack.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected $deactivation_listener = 'deactivate_aioseo';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Show notice the old plugin is installed and offer to import its data.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function show_import_settings_notice() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $yoasturl = add_query_arg( array( '_wpnonce' =&gt; wp_create_nonce( 'wpseo-import' ) ), admin_url( 'admin.php?page=wpseo_tools&tool=import-export&import=1&importaioseo=1#top#import-seo' ) );&nbsp;</div></li><li><div>          $aiourl = add_query_arg( array( '_wpnonce' =&gt; wp_create_nonce( 'aiosp-import' ) ), admin_url( 'tools.php?page=aiosp_import' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $aioseop_yst_detected_notice_dismissed = get_user_meta( get_current_user_id(), 'aioseop_yst_detected_notice_dismissed', true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( $aioseop_yst_detected_notice_dismissed ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              echo '&lt;div class=&quot;notice notice-warning row-title is-dismissible yst_notice&quot;&gt;&lt;p&gt;', sprintf( esc_html__( 'The plugin Yoast SEO has been detected. Do you want to %simport its settings%s into All in One SEO Pack?', 'all-in-one-seo-pack' ), sprintf( '&lt;a href=&quot;%s&quot;&gt;', esc_url( $aiourl ) ), '&lt;/a&gt;' ), '&lt;/p&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo '&lt;div class=&quot;error&quot;&gt;&lt;p&gt;', sprintf( esc_html__( 'The plugin All-In-One-SEO has been detected. Do you want to %simport its settings%s?', 'wordpress-seo' ), sprintf( '&lt;a href=&quot;%s&quot;&gt;', esc_url( $yoasturl ) ), '&lt;/a&gt;' ), '&lt;/p&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function show_deactivate_notice() {&nbsp;</div></li><li><div>          echo '&lt;div class=&quot;updated&quot;&gt;&lt;p&gt;', esc_html__( 'All in One SEO has been deactivated', 'all-in-one-seo-pack' ), '&lt;/p&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  add_action( 'init', 'mi_aioseop_yst_detected_notice_dismissed' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Deletes the stored dismissal of the notice.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This should only happen after reactivating after being deactivated.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function mi_aioseop_yst_detected_notice_dismissed() {&nbsp;</div></li><li><div>  delete_user_meta( get_current_user_id(), 'aioseop_yst_detected_notice_dismissed' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Init for settings import class.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * At the moment we just register the admin menu page.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function aiosp_seometa_settings_init() {&nbsp;</div></li><li><div>  global $_aiosp_seometa_admin_pagehook;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// TODO Put this in with the rest of the import/export stuff.</span>&nbsp;</div></li><li><div>  $_aiosp_seometa_admin_pagehook = add_submenu_page( 'tools.php', __( 'Import SEO Data', 'all-in-one-seo-pack' ), __( 'SEO Data Import', 'all-in-one-seo-pack' ), 'manage_options', 'aiosp_import', 'aiosp_seometa_admin' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action( 'admin_menu', 'aiosp_seometa_settings_init' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Intercept POST data from the form submission.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Use the intercepted data to convert values in the postmeta table from one platform to another.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function aiosp_seometa_action() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $_REQUEST['_wpnonce'] ) ) {&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $_REQUEST['platform_old'] ) ) {&nbsp;</div></li><li><div>      printf( '&lt;div class=&quot;error&quot;&gt;&lt;p&gt;%s&lt;/p&gt;&lt;/div&gt;', __( 'Sorry, you can\'t do that. Please choose a platform and then click Analyze or Convert.' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( 'All in One SEO Pack' === $_REQUEST['platform_old'] ) {&nbsp;</div></li><li><div>      printf( '&lt;div class=&quot;error&quot;&gt;&lt;p&gt;%s&lt;/p&gt;&lt;/div&gt;', __( 'Sorry, you can\'t do that. Please choose a platform and then click Analyze or Convert.' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  check_admin_referer( 'aiosp_nonce' ); <span class="comment">// Verify nonce. TODO We should make this better.</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $_REQUEST['analyze'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      printf( '&lt;h3&gt;%s&lt;/h3&gt;', __( 'Analysis Results', 'all-in-one-seo-pack' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $response = aiosp_seometa_post_meta_analyze( $_REQUEST['platform_old'], 'All in One SEO Pack' );&nbsp;</div></li><li><div>      if ( is_wp_error( $response ) ) {&nbsp;</div></li><li><div>          printf( '&lt;div class=&quot;error&quot;&gt;&lt;p&gt;%s&lt;/p&gt;&lt;/div&gt;', __( 'Sorry, something went wrong. Please try again' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      printf( __( '&lt;p&gt;Analyzing records in a %s to %s conversion&hellip;', 'all-in-one-seo-pack' ), esc_html( $_POST['platform_old'] ), 'All in One SEO Pack' );&nbsp;</div></li><li><div>      printf( '&lt;p&gt;&lt;b&gt;%d&lt;/b&gt; Compatible Records were identified&lt;/p&gt;', $response-&gt;update );&nbsp;</div></li><li><div>      <span class="comment">//    printf( '&lt;p&gt;%d Compatible Records will be ignored&lt;/p&gt;', $response-&gt;ignore );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      printf( '&lt;p&gt;&lt;b&gt;%s&lt;/b&gt;&lt;/p&gt;', __( 'Compatible data:', 'all-in-one-seo-pack' ) );&nbsp;</div></li><li><div>      echo '&lt;ol&gt;';&nbsp;</div></li><li><div>      foreach ( (array) $response-&gt;elements as $element ) {&nbsp;</div></li><li><div>          printf( '&lt;li&gt;%s&lt;/li&gt;', $element );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      echo '&lt;/ol&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  printf( '&lt;h3&gt;%s&lt;/h3&gt;', __( 'Conversion Results', 'all-in-one-seo-pack' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $result = aiosp_seometa_post_meta_convert( stripslashes( $_REQUEST['platform_old'] ), 'All in One SEO Pack' );&nbsp;</div></li><li><div>  if ( is_wp_error( $result ) ) {&nbsp;</div></li><li><div>      printf( '&lt;p&gt;%s&lt;/p&gt;', __( 'Sorry, something went wrong. Please try again' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  printf( '&lt;p&gt;&lt;b&gt;%d&lt;/b&gt; Records were updated&lt;/p&gt;', isset( $result-&gt;updated ) ? $result-&gt;updated : 0 );&nbsp;</div></li><li><div>  printf( '&lt;p&gt;&lt;b&gt;%d&lt;/b&gt; Records were ignored&lt;/p&gt;', isset( $result-&gt;ignored ) ? $result-&gt;ignored : 0 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * This function displays feedback to the user about compatible conversion</span>&nbsp;</div></li><li><div><span class="comment"> * elements and the conversion process via the admin_alert hook.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * The admin page output</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function aiosp_seometa_admin() {&nbsp;</div></li><li><div>  global $_aiosp_seometa_themes, $_aiosp_seometa_plugins, $_aiosp_seometa_platforms;&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;div class=&quot;wrap&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;h2&gt;&lt;?php _e( 'Import SEO Settings', 'all-in-one-seo-pack' ); ?&gt;&lt;/h2&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;p&gt;&lt;span&nbsp;</div></li><li><div>              class=&quot;description&quot;&gt;&lt;?php printf( __( 'Use the drop down below to choose which plugin or theme you wish to import SEO data from.', 'all-in-one-seo-pack' ) ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>      &lt;/p&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;p&gt;&lt;span&nbsp;</div></li><li><div>              class=&quot;description&quot;&gt;&lt;?php printf( __( 'Click &quot;Analyze&quot; for a list of SEO data that can be imported into All in One SEO Pack, along with the number of records that will be imported.', 'all-in-one-seo-pack' ) ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>      &lt;/p&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;p&gt;&lt;span&nbsp;</div></li><li><div>              class=&quot;description&quot;&gt;&lt;strong&gt;&lt;?php printf( __( 'Please Note: ' ) ); ?&gt;&lt;/strong&gt;&lt;?php printf( __( 'Some plugins and themes do not share similar data, or they store data in a non-standard way. If we cannot import this data, it will remain unchanged in your database. Any compatible SEO data will be displayed for you to review. If a post or page already has SEO data in All in One SEO Pack, we will not import data from another plugin/theme.', 'all-in-one-seo-pack' ) ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>      &lt;/p&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;p&gt;&lt;span&nbsp;</div></li><li><div>              class=&quot;description&quot;&gt;&lt;?php printf( __( 'Click &quot;Convert&quot; to perform the import. After the import has completed, you will be alerted to how many records were imported, and how many records had to be ignored, based on the criteria above.', 'all-in-one-seo-pack' ) ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>      &lt;/p&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;p&gt;&lt;span&nbsp;</div></li><li><div>              class=&quot;row-title&quot;&gt;&lt;?php printf( esc_html__( 'Before performing an import, we strongly recommend that you make a backup of your site. We use and recommend %s BackupBuddy %s for backups.', 'all-in-one-seo-pack' ), sprintf( '&lt;a target=&quot;_blank&quot; href=&quot;%s&quot;&gt;', esc_url( 'http:<span class="comment">//semperfiwebdesign.com/backupbuddy/' ) ), '&lt;/a&gt;' ); ?&gt;&lt;/span&gt;</span>&nbsp;</div></li><li><div>      &lt;/p&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;form action=&quot;&lt;?php echo admin_url( 'tools.php?page=aiosp_import' ); ?&gt;&quot; method=&quot;post&quot;&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>          wp_nonce_field( 'aiosp_nonce' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $platform_old = ( ! isset( $_POST['platform_old'] ) ) ? '' : $_POST['platform_old'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          _e( 'Import SEO data from:', 'all-in-one-seo-pack' );&nbsp;</div></li><li><div>          echo '&lt;select name=&quot;platform_old&quot;&gt;';&nbsp;</div></li><li><div>          printf( '&lt;option value=&quot;&quot;&gt;%s&lt;/option&gt;', __( 'Choose platform:', 'all-in-one-seo-pack' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          printf( '&lt;optgroup label=&quot;%s&quot;&gt;', __( 'Plugins', 'all-in-one-seo-pack' ) );&nbsp;</div></li><li><div>          foreach ( $_aiosp_seometa_plugins as $platform =&gt; $data ) {&nbsp;</div></li><li><div>              if ( 'All in One SEO Pack' !== $platform ) {&nbsp;</div></li><li><div>                  printf( '&lt;option value=&quot;%s&quot; %s&gt;%s&lt;/option&gt;', $platform, selected( $platform, $platform_old, 0 ), $platform );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          printf( '&lt;/optgroup&gt;' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          printf( '&lt;optgroup label=&quot;%s&quot;&gt;', __( 'Themes', 'all-in-one-seo-pack' ) );&nbsp;</div></li><li><div>          foreach ( $_aiosp_seometa_themes as $platform =&gt; $data ) {&nbsp;</div></li><li><div>              printf( '&lt;option value=&quot;%s&quot; %s&gt;%s&lt;/option&gt;', $platform, selected( $platform, $platform_old, 0 ), $platform );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          printf( '&lt;/optgroup&gt;' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo '&lt;/select&gt;' . &quot;\n\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;input type=&quot;submit&quot; class=&quot;button-highlighted&quot; name=&quot;analyze&quot;&nbsp;</div></li><li><div>                 value=&quot;&lt;?php _e( 'Analyze', 'genesis' ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>          &lt;input type=&quot;submit&quot; class=&quot;button-primary&quot; value=&quot;&lt;?php _e( 'Convert', 'genesis' ) ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;/form&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php aiosp_seometa_action(); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Convert old meta_key entries in the post meta table into new entries.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * First check to see what records for $new already exist, storing the corresponding post_id values in an array.</span>&nbsp;</div></li><li><div><span class="comment"> * When the conversion happens, ignore rows that contain a post_id, to avoid duplicate entries.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $old Old meta_key entries.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $new New meta_key entries.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $delete_old Whether to delete the old entries.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return stdClass Object for error detection, and the number of affected rows.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function aiosp_seometa_meta_key_convert( $old = '', $new = '', $delete_old = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  do_action( 'pre_aiosp_seometa_meta_key_convert_before', $old, $new, $delete_old );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $output = new stdClass;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! $old || ! $new ) {&nbsp;</div></li><li><div>      $output-&gt;WP_Error = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $output;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">//     See which records we need to ignore, if any.</span>&nbsp;</div></li><li><div>  $exclude = $wpdb-&gt;get_results( $wpdb-&gt;prepare( &quot;SELECT post_id FROM $wpdb-&gt;postmeta WHERE meta_key = %s&quot;, $new ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">//    If no records to ignore, we'll do a basic UPDATE and DELETE.</span>&nbsp;</div></li><li><div>  if ( ! $exclude ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $output-&gt;updated = $wpdb-&gt;update( $wpdb-&gt;postmeta, array( 'meta_key' =&gt; $new ), array( 'meta_key' =&gt; $old ) );&nbsp;</div></li><li><div>      $output-&gt;deleted = $delete_old ? $wpdb-&gt;query( $wpdb-&gt;prepare( &quot;DELETE FROM $wpdb-&gt;postmeta WHERE meta_key = %s&quot;, $old ) ) : 0;&nbsp;</div></li><li><div>      $output-&gt;ignored = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } <span class="comment">// Else, do a more complex UPDATE and DELETE.</span>&nbsp;</div></li><li><div>  else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( (array) $exclude as $key =&gt; $value ) {&nbsp;</div></li><li><div>          $not_in[] = $value-&gt;post_id;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $not_in = implode( ', ', (array) $not_in );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $output-&gt;updated = $wpdb-&gt;query( $wpdb-&gt;prepare( &quot;UPDATE $wpdb-&gt;postmeta SET meta_key = %s WHERE meta_key = %s AND post_id NOT IN ($not_in)&quot;, $new, $old ) );&nbsp;</div></li><li><div>      $output-&gt;deleted = $delete_old ? $wpdb-&gt;query( $wpdb-&gt;prepare( &quot;DELETE FROM $wpdb-&gt;postmeta WHERE meta_key = %s&quot;, $old ) ) : 0;&nbsp;</div></li><li><div>      $output-&gt;ignored = count( $exclude );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  do_action( 'aiosp_seometa_meta_key_convert', $output, $old, $new, $delete_old );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $output;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Convert old to new postmeta.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Cycle through all compatible SEO entries of two platforms and aiosp_seometa_meta_key_convert conversion for each key.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $old_platform</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $new_platform</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $delete_old</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return stdClass Results object.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function aiosp_seometa_post_meta_convert( $old_platform = '', $new_platform = 'All in One SEO Pack', $delete_old = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  do_action( 'pre_aiosp_seometa_post_meta_convert', $old_platform, $new_platform, $delete_old );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $_aiosp_seometa_platforms;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $output = new stdClass;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $_aiosp_seometa_platforms[ $old_platform ] ) || empty( $_aiosp_seometa_platforms[ $new_platform ] ) ) {&nbsp;</div></li><li><div>      $output-&gt;WP_Error = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $output;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $output-&gt;updated = 0;&nbsp;</div></li><li><div>  $output-&gt;deleted = 0;&nbsp;</div></li><li><div>  $output-&gt;ignored = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( (array) $_aiosp_seometa_platforms[ $old_platform ] as $label =&gt; $meta_key ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Skip iterations where no $new analog exists.</span></span>&nbsp;</div></li><li><div>      if ( empty( $_aiosp_seometa_platforms[ $new_platform ][ $label ] ) ) {&nbsp;</div></li><li><div>          continue;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set $old and $new meta_key values.</span>&nbsp;</div></li><li><div>      $old = $_aiosp_seometa_platforms[ $old_platform ][ $label ];&nbsp;</div></li><li><div>      $new = $_aiosp_seometa_platforms[ $new_platform ][ $label ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Convert.</span>&nbsp;</div></li><li><div>      $result = aiosp_seometa_meta_key_convert( $old, $new, $delete_old );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Error check.</span>&nbsp;</div></li><li><div>      if ( is_wp_error( $result ) ) {&nbsp;</div></li><li><div>          continue;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Update total updated/ignored count.</span>&nbsp;</div></li><li><div>      $output-&gt;updated += (int) $result-&gt;updated;&nbsp;</div></li><li><div>      $output-&gt;ignored += (int) $result-&gt;ignored;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  do_action( 'aiosp_seometa_post_meta_convert', $output, $old_platform, $new_platform, $delete_old );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $output;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Analyze two platforms to find shared and compatible elements.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * See what data can be converted from one to the other.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $old_platform</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $new_platform</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return stdClass</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function aiosp_seometa_post_meta_analyze( $old_platform = '', $new_platform = 'All in One SEO Pack' ) {&nbsp;</div></li><li><div>  <span class="comment">// TODO Figure out which elements to ignore.</span>&nbsp;</div></li><li><div>  do_action( 'pre_aiosp_seometa_post_meta_analyze', $old_platform, $new_platform );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $wpdb, $_aiosp_seometa_platforms;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $output = new stdClass;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $_aiosp_seometa_platforms[ $old_platform ] ) || empty( $_aiosp_seometa_platforms[ $new_platform ] ) ) {&nbsp;</div></li><li><div>      $output-&gt;WP_Error = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $output;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $output-&gt;update = 0;&nbsp;</div></li><li><div>  $output-&gt;ignore = 0;&nbsp;</div></li><li><div>  $output-&gt;elements = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( (array) $_aiosp_seometa_platforms[ $old_platform ] as $label =&gt; $meta_key ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Skip iterations where no $new analog exists.</span></span>&nbsp;</div></li><li><div>      if ( empty( $_aiosp_seometa_platforms[ $new_platform ][ $label ] ) ) {&nbsp;</div></li><li><div>          continue;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $elements[] = $label;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// See which records to ignore, if any.</span>&nbsp;</div></li><li><div>      $ignore = 0;&nbsp;</div></li><li><div>      <span class="comment">//    $ignore = $wpdb-&gt;get_results( $wpdb-&gt;prepare( &quot;SELECT post_id FROM $wpdb-&gt;postmeta WHERE meta_key = %s&quot;, $meta_key ) );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// See which records to update, if any.</span>&nbsp;</div></li><li><div>      $update = $wpdb-&gt;get_results( $wpdb-&gt;prepare( &quot;SELECT post_id FROM $wpdb-&gt;postmeta WHERE meta_key = %s&quot;, $meta_key ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Count items in returned arrays.</span>&nbsp;</div></li><li><div>      <span class="comment">// $ignore = count( (array)$ignore );</span>&nbsp;</div></li><li><div>      $update = count( (array) $update );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Calculate update/ignore by comparison.</span>&nbsp;</div></li><li><div>      <span class="comment">// $update = ( (int)$update &gt; (int)$ignore ) ? ( (int)$update - (int)$ignore ) : 0;</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// update output numbers</span>&nbsp;</div></li><li><div>      $output-&gt;update += (int) $update;&nbsp;</div></li><li><div>      $output-&gt;ignore += (int) $ignore;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $output-&gt;elements = $elements;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  do_action( 'aiosp_seometa_post_meta_analyze', $output, $old_platform, $new_platform );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $output;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//    define('aiosp_seometa_PLUGIN_DIR', dirname(__FILE__));</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//add_action( 'plugins_loaded', 'aiosp_seometa_import' );</span>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Initialize the SEO Data Transporter plugin</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function aiosp_seometa_import() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $_aiosp_seometa_themes, $_aiosp_seometa_plugins, $_aiosp_seometa_platforms;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * The associative array of supported themes.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $_aiosp_seometa_themes = array(&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// alphabatized</span></span>&nbsp;</div></li><li><div>      'Builder' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; '_builder_seo_title', &nbsp;</div></li><li><div>          'META Description' =&gt; '_builder_seo_description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; '_builder_seo_keywords', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'Catalyst' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; '_catalyst_title', &nbsp;</div></li><li><div>          'META Description' =&gt; '_catalyst_description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; '_catalyst_keywords', &nbsp;</div></li><li><div>          'noindex' =&gt; '_catalyst_noindex', &nbsp;</div></li><li><div>          'nofollow' =&gt; '_catalyst_nofollow', &nbsp;</div></li><li><div>          'noarchive' =&gt; '_catalyst_noarchive', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'Frugal' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; '_title', &nbsp;</div></li><li><div>          'META Description' =&gt; '_description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; '_keywords', &nbsp;</div></li><li><div>          'noindex' =&gt; '_noindex', &nbsp;</div></li><li><div>          'nofollow' =&gt; '_nofollow', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'Genesis' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; '_genesis_title', &nbsp;</div></li><li><div>          'META Description' =&gt; '_genesis_description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; '_genesis_keywords', &nbsp;</div></li><li><div>          'noindex' =&gt; '_genesis_noindex', &nbsp;</div></li><li><div>          'nofollow' =&gt; '_genesis_nofollow', &nbsp;</div></li><li><div>          'noarchive' =&gt; '_genesis_noarchive', &nbsp;</div></li><li><div>          'Canonical URI' =&gt; '_genesis_canonical_uri', &nbsp;</div></li><li><div>          'Custom Scripts' =&gt; '_genesis_scripts', &nbsp;</div></li><li><div>          'Redirect URI' =&gt; 'redirect', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'Headway' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; '_title', &nbsp;</div></li><li><div>          'META Description' =&gt; '_description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; '_keywords', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'Hybrid' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; 'Title', &nbsp;</div></li><li><div>          'META Description' =&gt; 'Description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; 'Keywords', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'Thesis 1.x' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; 'thesis_title', &nbsp;</div></li><li><div>          'META Description' =&gt; 'thesis_description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; 'thesis_keywords', &nbsp;</div></li><li><div>          'Custom Scripts' =&gt; 'thesis_javascript_scripts', &nbsp;</div></li><li><div>          'Redirect URI' =&gt; 'thesis_redirect', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">      'Thesis 2.x' =&gt; array(</span>&nbsp;</div></li><li><div><span class="comment">          'Custom Doctitle' =&gt; '_thesis_title_tag', </span>&nbsp;</div></li><li><div><span class="comment">          'META Description' =&gt; '_thesis_meta_description', </span>&nbsp;</div></li><li><div><span class="comment">          'META Keywords' =&gt; '_thesis_meta_keywords', </span>&nbsp;</div></li><li><div><span class="comment">          'Custom Scripts' =&gt; '_thesis_javascript_scripts', </span>&nbsp;</div></li><li><div><span class="comment">          'Canonical URI' =&gt; '_thesis_canonical_link', </span>&nbsp;</div></li><li><div><span class="comment">          'Redirect URI' =&gt; '_thesis_redirect', </span>&nbsp;</div></li><li><div><span class="comment"> ), </span>&nbsp;</div></li><li><div><span class="comment">      */</span>&nbsp;</div></li><li><div>      'WooFramework' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; 'seo_title', &nbsp;</div></li><li><div>          'META Description' =&gt; 'seo_description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; 'seo_keywords', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * The associative array of supported plugins.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $_aiosp_seometa_plugins = array(&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// alphabatized</span></span>&nbsp;</div></li><li><div>      'Add Meta Tags' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; '_amt_title', &nbsp;</div></li><li><div>          'META Description' =&gt; '_amt_description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; '_amt_keywords', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'All in One SEO Pack' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; '_aioseop_title', &nbsp;</div></li><li><div>          'META Description' =&gt; '_aioseop_description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; '_aioseop_keywords', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'Greg\'s High Performance SEO' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; '_ghpseo_secondary_title', &nbsp;</div></li><li><div>          'META Description' =&gt; '_ghpseo_alternative_description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; '_ghpseo_keywords', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'Headspace2' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; '_headspace_page_title', &nbsp;</div></li><li><div>          'META Description' =&gt; '_headspace_description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; '_headspace_keywords', &nbsp;</div></li><li><div>          'Custom Scripts' =&gt; '_headspace_scripts', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'Infinite SEO' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; '_wds_title', &nbsp;</div></li><li><div>          'META Description' =&gt; '_wds_metadesc', &nbsp;</div></li><li><div>          'META Keywords' =&gt; '_wds_keywords', &nbsp;</div></li><li><div>          'noindex' =&gt; '_wds_meta-robots-noindex', &nbsp;</div></li><li><div>          'nofollow' =&gt; '_wds_meta-robots-nofollow', &nbsp;</div></li><li><div>          'Canonical URI' =&gt; '_wds_canonical', &nbsp;</div></li><li><div>          'Redirect URI' =&gt; '_wds_redirect', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'Meta SEO Pack' =&gt; array(&nbsp;</div></li><li><div>          'META Description' =&gt; '_msp_description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; '_msp_keywords', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'Platinum SEO' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; 'title', &nbsp;</div></li><li><div>          'META Description' =&gt; 'description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; 'keywords', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'SEO Title Tag' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; 'title_tag', &nbsp;</div></li><li><div>          'META Description' =&gt; 'meta_description', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'SEO Ultimate' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; '_su_title', &nbsp;</div></li><li><div>          'META Description' =&gt; '_su_description', &nbsp;</div></li><li><div>          'META Keywords' =&gt; '_su_keywords', &nbsp;</div></li><li><div>          'noindex' =&gt; '_su_meta_robots_noindex', &nbsp;</div></li><li><div>          'nofollow' =&gt; '_su_meta_robots_nofollow', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'Yoast SEO' =&gt; array(&nbsp;</div></li><li><div>          'Custom Doctitle' =&gt; '_yoast_wpseo_title', &nbsp;</div></li><li><div>          'META Description' =&gt; '_yoast_wpseo_metadesc', &nbsp;</div></li><li><div>          'META Keywords' =&gt; '_yoast_wpseo_metakeywords', &nbsp;</div></li><li><div>          'noindex' =&gt; '_yoast_wpseo_meta-robots-noindex', &nbsp;</div></li><li><div>          'nofollow' =&gt; '_yoast_wpseo_meta-robots-nofollow', &nbsp;</div></li><li><div>          'Canonical URI' =&gt; '_yoast_wpseo_canonical', &nbsp;</div></li><li><div>          'Redirect URI' =&gt; '_yoast_wpseo_redirect', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * The combined array of supported platforms.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $_aiosp_seometa_platforms = array_merge( $_aiosp_seometa_themes, $_aiosp_seometa_plugins );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Include the other elements of the plugin.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  <span class="comment">//    require_once( aiosp_seometa_PLUGIN_DIR . '/admin.php' );</span>&nbsp;</div></li><li><div>  <span class="comment">// require_once( aiosp_seometa_PLUGIN_DIR . '/functions.php' );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Init hook.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Hook fires after plugin functions are loaded.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 0.9.10</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  do_action( 'aiosp_seometa_import' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Activation Hook</span>&nbsp;</div></li><li><div><span class="comment"> * @since 0.9.4</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>register_activation_hook( __FILE__, 'aiosp_seometa_activation_hook' );&nbsp;</div></li><li><div>function aiosp_seometa_activation_hook() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">//    require_once( aiosp_seometa_PLUGIN_DIR . '/functions.php' );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  aiosp_seometa_meta_key_convert( '_yoast_seo_title', 'yoast_wpseo_title', true );&nbsp;</div></li><li><div>  aiosp_seometa_meta_key_convert( '_yoast_seo_metadesc', 'yoast_wpseo_metadesc', true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Manual conversion test</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">$aiosp_seometa_convert = aiosp_seometa_post_meta_convert( 'All in One SEO Pack', 'Genesis', false );</span>&nbsp;</div></li><li><div><span class="comment">printf( '%d records were updated', $aiosp_seometa_convert-&gt;updated );</span>&nbsp;</div></li><li><div><span class="comment">/**/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Manual analysis test</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">$aiosp_seometa_analyze = aiosp_seometa_post_meta_analyze( 'All in One SEO Pack', 'Genesis' );</span>&nbsp;</div></li><li><div><span class="comment">printf( '&lt;p&gt;&lt;b&gt;%d&lt;/b&gt; Compatible Records were identified&lt;/p&gt;', $aiosp_seometa_analyze-&gt;update );</span>&nbsp;</div></li><li><div><span class="comment">/**/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Delete all SEO data, from every platform</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">foreach ( $_aiosp_seometa_platforms as $platform =&gt; $data ) {</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">  foreach ( $data as $field ) {</span>&nbsp;</div></li><li><div><span class="comment">      $deleted = $wpdb-&gt;query( $wpdb-&gt;prepare( &quot;DELETE FROM $wpdb-&gt;postmeta WHERE meta_key = %s&quot;, $field ) );</span>&nbsp;</div></li><li><div><span class="comment">      printf( '%d %s records deleted&lt;br /&gt;', $deleted, $field );</span>&nbsp;</div></li><li><div><span class="comment">  }</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">}</span>&nbsp;</div></li><li><div><span class="comment">/**/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Query all SEO data to find the number of records to change</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>All In One SEO Pack</li><li><span></span>2.3.9.2</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>