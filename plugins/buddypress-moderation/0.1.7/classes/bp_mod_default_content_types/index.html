<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="0.1.7" data-slug="buddypress-moderation" data-type="class" data-id="97862"><head xmlns="http://www.w3.org/1999/xhtml"><title> bpmoddefaultcontenttypes | class | Buddypress Moderation | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="bpModDefaultContentTypes, class, plugin, buddypress-moderation, 0.1.7" /><meta name="description" content="Wrap the functions for all WP/BP core types" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=70cf87b131d7220b87b9918a73f9afed' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/bp_mod_default_content_types/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fbp_mod_default_content_types%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fbp_mod_default_content_types%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-buddypress-moderation-0.1.7-class-bp_mod_default_content_types","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="bp_mod_default_content_types" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to buddypress-moderation." href="http://hookr.io/plugins/buddypress-moderation/" class="plugin"><span property="name">buddypress-moderation</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 0.1.7." href="http://hookr.io/plugins/buddypress-moderation/0.1.7/" class="H_VERSION"><span property="name">0.1.7</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/buddypress-moderation/0.1.7/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">bp_mod_default_content_types</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="37"><a href="http://hookr.io/plugins/buddypress-moderation/0.1.7/all/" title="All">All <span class="count badge">37</span></a></li><li class="" data-id="new" data-count="2"><a href="http://hookr.io/plugins/buddypress-moderation/0.1.7/new/" title="New">New <span class="count badge">2</span></a></li><li class="" data-id="hooks" data-count="24"><a href="http://hookr.io/plugins/buddypress-moderation/0.1.7/hooks/" title="Hooks">Hooks <span class="count badge">24</span></a></li><li class="" data-id="action" data-count="15"><a href="http://hookr.io/plugins/buddypress-moderation/0.1.7/actions/" title="Actions">Actions <span class="count badge">15</span></a></li><li class="" data-id="filter" data-count="9"><a href="http://hookr.io/plugins/buddypress-moderation/0.1.7/filters/" title="Filters">Filters <span class="count badge">9</span></a></li><li class="active" data-id="class" data-count="13"><a href="http://hookr.io/plugins/buddypress-moderation/0.1.7/classes/" title="Classes">Classes <span class="count badge">13</span></a></li><li class="" data-id="constant" data-count="0"><a href="http://hookr.io/plugins/buddypress-moderation/0.1.7/constants/" title="Constants">Constants <span class="count badge">0</span></a></li><li class="" data-id="function" data-count="0"><a href="http://hookr.io/plugins/buddypress-moderation/0.1.7/functions/" title="Functions">Functions <span class="count badge">0</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/plugins/buddypress-moderation/0.1.7/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>bpModDefaultContentTypes</strong></h1><p>Wrap the functions for all WP/BP core types.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/buddypress-moderation/0.1.7/files/classes-bpmoddefaultcontenttypes/" class="file">/classes/bpModDefaultContentTypes.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="10" class="block" start="10"><li><div>class bpModDefaultContentTypes&nbsp;</div></li><li><div>{&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * hardcode default modules in bpModeration istance&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param bpModeration $bpmod main plugin instance&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function init(&$bpmod)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //init only if in frontend and only for choosen type&nbsp;</div></li><li><div>        if (is_a($bpmod, 'bpModFrontend')) {&nbsp;</div></li><li><div>            $init_types =& $bpmod-&gt;options['active_types'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // TODO: check if corrisponding bp components are active before adding useless data&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //  status updates&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['status_update'] = new stdClass();&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['status_update']-&gt;label = __('Status update', 'bp-moderation');&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['status_update']-&gt;callbacks = array(&nbsp;</div></li><li><div>            'info' =&gt; array(__CLASS__, 'activity_info'), &nbsp;</div></li><li><div>            'delete' =&gt; array(__CLASS__, 'activity_delete')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($init_types['status_update'])) {&nbsp;</div></li><li><div>            $bpmod-&gt;types_map['activity_update'] = 'status_update';&nbsp;</div></li><li><div>            add_filter('bp_moderation_activity_loop_link_args_activity_update', array(__CLASS__, 'activity_correct_ids'));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //  status comments&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['activity_comment'] = new stdClass();&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['activity_comment']-&gt;label = __('Activity comment', 'bp-moderation');&nbsp;</div></li><li><div>        //callbacks are the same of status updates because both content types stay in the activity table&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['activity_comment']-&gt;callbacks = array(&nbsp;</div></li><li><div>            'info' =&gt; array(__CLASS__, 'activity_info'), &nbsp;</div></li><li><div>            'delete' =&gt; array(__CLASS__, 'activity_delete')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($init_types['activity_comment'])) {&nbsp;</div></li><li><div>            $bpmod-&gt;types_map['activity_comment'] = 'activity_comment';&nbsp;</div></li><li><div>            add_filter('bp_moderation_activity_loop_link_args_activity_comment', array(__CLASS__, 'activity_correct_ids'));&nbsp;</div></li><li><div>            add_action('bp_activity_comment_options', array(__CLASS__, 'activity_comments_print_link'));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //  blog posts&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['blog_post'] = new stdClass();&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['blog_post']-&gt;label = __('Blog post', 'bp-moderation');&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['blog_post']-&gt;callbacks = array(&nbsp;</div></li><li><div>            'info' =&gt; array(__CLASS__, 'blog_post_info'), &nbsp;</div></li><li><div>            'edit' =&gt; array(__CLASS__, 'blog_post_edit'), &nbsp;</div></li><li><div>            'delete' =&gt; array(__CLASS__, 'blog_post_delete')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($init_types['blog_post'])) {&nbsp;</div></li><li><div>            $bpmod-&gt;types_map['new_blog_post'] = 'blog_post';&nbsp;</div></li><li><div>            add_filter('the_content', array(__CLASS__, 'blog_post_append_link'));&nbsp;</div></li><li><div>            add_filter('the_excerpt', array(__CLASS__, 'blog_post_append_link'));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //  blog page&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['blog_page'] = new stdClass();&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['blog_page']-&gt;label = __('Blog page', 'bp-moderation');&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['blog_page']-&gt;callbacks = array(&nbsp;</div></li><li><div>            'info' =&gt; array(__CLASS__, 'blog_post_info'), &nbsp;</div></li><li><div>            'edit' =&gt; array(__CLASS__, 'blog_post_edit'), &nbsp;</div></li><li><div>            'delete' =&gt; array(__CLASS__, 'blog_post_delete')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($init_types['blog_page'])) {&nbsp;</div></li><li><div>            add_filter('the_content', array(__CLASS__, 'blog_page_append_link'));&nbsp;</div></li><li><div>            add_filter('the_excerpt', array(__CLASS__, 'blog_page_append_link'));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //  blog comments&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['blog_comment'] = new stdClass();&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['blog_comment']-&gt;label = __('Blog comment', 'bp-moderation');&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['blog_comment']-&gt;callbacks = array(&nbsp;</div></li><li><div>            'info' =&gt; array(__CLASS__, 'blog_comment_info'), &nbsp;</div></li><li><div>            'edit' =&gt; array(__CLASS__, 'blog_comment_edit'), &nbsp;</div></li><li><div>            'delete' =&gt; array(__CLASS__, 'blog_comment_delete')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        add_filter('bp_moderation_author_details_for_blog_comment', array(__CLASS__, 'blog_comment_author_details'), 10, 2);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($init_types['blog_comment'])) {&nbsp;</div></li><li><div>            $bpmod-&gt;types_map['new_blog_comment'] = 'blog_comment';&nbsp;</div></li><li><div>            add_filter('get_comment_text', array(__CLASS__, 'blog_comment_append_link'));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //  profiles&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['member'] = new stdClass();&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['member']-&gt;label = __('Member', 'bp-moderation');&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['member']-&gt;callbacks = array(&nbsp;</div></li><li><div>            'info' =&gt; array(__CLASS__, 'member_info'), &nbsp;</div></li><li><div>            'edit' =&gt; array(__CLASS__, 'member_edit'), &nbsp;</div></li><li><div>            'delete' =&gt; array(__CLASS__, 'member_delete')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($init_types['member'])) {&nbsp;</div></li><li><div>            add_action('bp_after_member_home_content', array(__CLASS__, 'member_print_link'));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //  groups&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['group'] = new stdClass();&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['group']-&gt;label = __('Group', 'bp-moderation');&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['group']-&gt;callbacks = array(&nbsp;</div></li><li><div>            'info' =&gt; array(__CLASS__, 'group_info'), &nbsp;</div></li><li><div>            'edit' =&gt; array(__CLASS__, 'group_edit'), &nbsp;</div></li><li><div>            'delete' =&gt; array(__CLASS__, 'group_delete')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($init_types['group'])) {&nbsp;</div></li><li><div>            add_action('bp_after_group_home_content', array(__CLASS__, 'group_print_link'));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //  forum topic&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['forum_topic'] = new stdClass();&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['forum_topic']-&gt;label = __('Legacy Forum topic', 'bp-moderation');&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['forum_topic']-&gt;callbacks = array(&nbsp;</div></li><li><div>            'info' =&gt; array(__CLASS__, 'forum_topic_info'), &nbsp;</div></li><li><div>            'edit' =&gt; array(__CLASS__, 'forum_topic_edit'), &nbsp;</div></li><li><div>            'delete' =&gt; array(__CLASS__, 'forum_topic_delete')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($init_types['forum_topic'])) {&nbsp;</div></li><li><div>            add_action('bp_group_forum_topic_meta', array(__CLASS__, 'forum_topic_print_link'));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //  forum post&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['forum_post'] = new stdClass();&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['forum_post']-&gt;label = __('Legacy Forum post', 'bp-moderation');&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['forum_post']-&gt;callbacks = array(&nbsp;</div></li><li><div>            'info' =&gt; array(__CLASS__, 'forum_post_info'), &nbsp;</div></li><li><div>            'edit' =&gt; array(__CLASS__, 'forum_post_edit'), &nbsp;</div></li><li><div>            'delete' =&gt; array(__CLASS__, 'forum_post_delete')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset ($init_types['forum_post'])) {&nbsp;</div></li><li><div>            $bpmod-&gt;types_map['new_forum_post'] = 'forum_post';&nbsp;</div></li><li><div>            $bpmod-&gt;types_map['new_forum_topic'] = 'forum_post';&nbsp;</div></li><li><div>            add_filter('bp_moderation_activity_loop_link_args_new_forum_topic', array(__CLASS__, 'forum_post_convert_activity_args'));&nbsp;</div></li><li><div>            add_action('bp_group_forum_post_meta', array(__CLASS__, 'forum_post_print_link'));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>                &nbsp;</div></li><li><div>        //  private message sender&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['private_message_sender'] = new stdClass();&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['private_message_sender']-&gt;label = __('Private message sender', 'bp-moderation');&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['private_message_sender']-&gt;callbacks = array(&nbsp;</div></li><li><div>            'info' =&gt; array(__CLASS__, 'member_info'), &nbsp;</div></li><li><div>            'edit' =&gt; array(__CLASS__, 'member_edit'), &nbsp;</div></li><li><div>            'delete' =&gt; array(__CLASS__, 'member_delete')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        if (isset ($init_types['private_message_sender'])) {&nbsp;</div></li><li><div>            add_action('bp_after_message_thread_list', array(__CLASS__, 'private_message_sender_print_links'));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        //  private message&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['private_message'] = new stdClass();&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['private_message']-&gt;label = __('Private message', 'bp-moderation');&nbsp;</div></li><li><div>        $bpmod-&gt;content_types['private_message']-&gt;callbacks = array(&nbsp;</div></li><li><div>            'info' =&gt; array(__CLASS__, 'private_message_info'), &nbsp;</div></li><li><div>            'delete' =&gt; array(__CLASS__, 'private_message_delete')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        if (isset ($init_types['private_message'])) {&nbsp;</div></li><li><div>            add_action('bp_after_message_thread_list', array(__CLASS__, 'private_message_print_links'));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        add_filter('bp_moderation_filter_content_backend_for_private_message', array(__CLASS__, 'private_message_view_link_override'));&nbsp;</div></li><li><div>        add_action('messages_action_view_message', array(__CLASS__, 'private_message_super_admin_override'));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //  load custom content types&nbsp;</div></li><li><div>        if (defined('BPMOD_LOAD_CUSTOM_CONTENT_TYPES') && BPMOD_LOAD_CUSTOM_CONTENT_TYPES) {&nbsp;</div></li><li><div>            $custom_content_types = glob(WP_PLUGIN_DIR . '/bp-moderation-content-types/*.php');&nbsp;</div></li><li><div>&nbsp;&nbsp;</div></li><li><div>            foreach ($custom_content_types as $ct)&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                include_once ($ct);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;&nbsp;</div></li><li><div>    /*******************************************************************************&nbsp;</div></li><li><div>     * status_update & activity_comment&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function activity_info($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $act = new BP_Activity_Activity($id);&nbsp;</div></li><li><div>        if (empty($act-&gt;user_id)) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $url = bp_core_get_root_domain() . '/' . BP_ACTIVITY_SLUG . '/p/' . $id . '/';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return array('author' =&gt; $act-&gt;user_id, 'url' =&gt; $url, 'date' =&gt; $act-&gt;date_recorded);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function activity_delete($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $act = new BP_Activity_Activity($id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (empty($act-&gt;user_id)) {&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        } //was already deleted&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return bp_activity_delete(array('id' =&gt; $id, 'user_id' =&gt; $act-&gt;user_id));&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function activity_correct_ids($args)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $args['id'] = bp_get_activity_id();&nbsp;</div></li><li><div>        $args['id2'] = bp_get_activity_item_id();&nbsp;</div></li><li><div>        return $args;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function activity_comments_print_link()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $link = bpModFrontend::get_link(array(&nbsp;</div></li><li><div>                                             'type' =&gt; 'activity_comment', &nbsp;</div></li><li><div>                                             'author_id' =&gt; bp_get_activity_comment_user_id(), &nbsp;</div></li><li><div>                                             'id' =&gt; bp_get_activity_comment_id(), &nbsp;</div></li><li><div>                                             'id2' =&gt; bp_get_activity_id(), &nbsp;</div></li><li><div>                                             'custom_class' =&gt; 'bpm-no-images bp-secondary-action'&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>        echo $link;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /*******************************************************************************&nbsp;</div></li><li><div>     * blog_post&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function blog_post_info($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        switch_to_blog($id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (!$post = get_post($id2)) {&nbsp;</div></li><li><div>            return restore_current_blog() && false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $url = home_url(&quot;?p=$id2&quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        restore_current_blog();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return array('author' =&gt; $post-&gt;post_author, 'url' =&gt; $url, 'date' =&gt; $post-&gt;post_date_gmt);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function blog_post_edit($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        switch_to_blog($id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $url = admin_url(&quot;post.php?post=$id2&action=edit&quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        restore_current_blog();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $url;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function blog_post_delete($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        switch_to_blog($id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $r = !get_post($id2) || wp_delete_post($id2);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        restore_current_blog();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $r;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function blog_post_append_link($content)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        global $wpdb, $post;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ('post' != $post-&gt;post_type) {&nbsp;</div></li><li><div>            return $content;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $link = bpModFrontend::get_link(array(&nbsp;</div></li><li><div>                                             'type' =&gt; 'blog_post', &nbsp;</div></li><li><div>                                             'author_id' =&gt; $post-&gt;post_author, &nbsp;</div></li><li><div>                                             'id' =&gt; $wpdb-&gt;blogid, &nbsp;</div></li><li><div>                                             'id2' =&gt; $post-&gt;ID, &nbsp;</div></li><li><div>                                             'unflagged_text' =&gt; __('Flag this post as inappropriate', 'bp-moderation')&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return &quot;$content\n\n$link&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function blog_page_append_link($content)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        global $wpdb, $post;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ('page' != $post-&gt;post_type) {&nbsp;</div></li><li><div>            return $content;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $link = bpModFrontend::get_link(array(&nbsp;</div></li><li><div>                                             'type' =&gt; 'blog_page', &nbsp;</div></li><li><div>                                             'author_id' =&gt; $post-&gt;post_author, &nbsp;</div></li><li><div>                                             'id' =&gt; $wpdb-&gt;blogid, &nbsp;</div></li><li><div>                                             'id2' =&gt; $post-&gt;ID, &nbsp;</div></li><li><div>                                             'unflagged_text' =&gt; __('Flag this page as inappropriate', 'bp-moderation')&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return &quot;$content\n\n$link&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /*******************************************************************************&nbsp;</div></li><li><div>     * blog_comment&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function blog_comment_info($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        switch_to_blog($id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (!$comment = get_comment($id2)) {&nbsp;</div></li><li><div>            return restore_current_blog() && false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $url = home_url(&quot;?p=$comment-&gt;comment_post_ID#comment-$id2&quot;);&nbsp;</div></li><li><div>        $user = get_user_by_email($comment-&gt;comment_author_email);&nbsp;</div></li><li><div>        $author = (int)$user-&gt;ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        restore_current_blog();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return array('author' =&gt; $author, 'url' =&gt; $url, 'date' =&gt; $comment-&gt;comment_date_gmt);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function blog_comment_edit($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        switch_to_blog($id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $url = admin_url(&quot;comment.php?action=editcomment&c=$id2&quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        restore_current_blog();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $url;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function blog_comment_delete($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        switch_to_blog($id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $r = !get_comment($id2) || wp_delete_comment($id2);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        restore_current_blog();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $r;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function blog_comment_author_details($details, $cont)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        switch_to_blog($cont-&gt;item_id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $email = get_comment_author_email($cont-&gt;item_id2);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $details = array(&nbsp;</div></li><li><div>            'avatar_img' =&gt; get_avatar($email, 32), &nbsp;</div></li><li><div>            'user_link' =&gt; get_comment_author_link($cont-&gt;item_id2), &nbsp;</div></li><li><div>            'contact_link' =&gt; $email&nbsp;</div></li><li><div>                ? &quot;&lt;a class='vim-c' href='mailto:$email' title='&quot; . __('Send an email to the author of this content', 'bp-moderation') . &quot;' &gt;&quot; . __('Send email', 'bp-moderation') . &quot;&lt;/a&gt;&quot;&nbsp;</div></li><li><div>                : ''&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        restore_current_blog();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $details;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function blog_comment_append_link($comment_text)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        global $wpdb, $comment;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $link = bpModFrontend::get_link(array(&nbsp;</div></li><li><div>                                             'type' =&gt; 'blog_comment', &nbsp;</div></li><li><div>                                             'author_id' =&gt; $comment-&gt;user_id, &nbsp;</div></li><li><div>                                             'id' =&gt; $wpdb-&gt;blogid, &nbsp;</div></li><li><div>                                             'id2' =&gt; $comment-&gt;comment_ID, &nbsp;</div></li><li><div>                                             'unflagged_text' =&gt; __('Flag this comment as inappropriate', 'bp-moderation')&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $comment_text . &quot;\n\n$link&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /*******************************************************************************&nbsp;</div></li><li><div>     * member&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function member_info($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if (!$user = get_userdata($id)) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return array('author' =&gt; $id, 'url' =&gt; bp_core_get_user_domain($id), 'date' =&gt; $user-&gt;user_registered);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function member_edit($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if (bp_is_active('x-profile')) {&nbsp;</div></li><li><div>            return bp_core_get_user_domain($id) . $GLOBALS['bp']-&gt;profile-&gt;slug . '/edit/';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            return admin_url(&quot;user-edit.php?user_id=$id&quot;);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function member_delete($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if (!$user = get_userdata($id)) {&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if (is_super_admin($id) || bp_loggedin_user_id() == $id) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //let admins delete members also if account deletion disabled&nbsp;</div></li><li><div>        $disable_deletion = get_site_option('bp-disable-account-deletion');&nbsp;</div></li><li><div>        if ($disable_deletion) {&nbsp;</div></li><li><div>            delete_site_option('bp-disable-account-deletion');&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $r = bp_core_delete_account($id);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ($disable_deletion) {&nbsp;</div></li><li><div>            add_site_option('bp-disable-account-deletion', $disable_deletion);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $r;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function member_print_link()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $link = bpModFrontend::get_link(array(&nbsp;</div></li><li><div>                                             'type' =&gt; 'member', &nbsp;</div></li><li><div>                                             'author_id' =&gt; bp_displayed_user_id(), &nbsp;</div></li><li><div>                                             'id' =&gt; bp_displayed_user_id(), &nbsp;</div></li><li><div>                                             'unflagged_text' =&gt; __('Flag this member as inappropriate', 'bp-moderation')&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo &quot;&lt;div class='bpm-right-link bpm-bottom-link'&gt;$link&lt;/div&gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /*******************************************************************************&nbsp;</div></li><li><div>     * group&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function group_info($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if (!$group = groups_get_group(array('group_id' =&gt; $id))) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return array('author' =&gt; $group-&gt;creator_id, 'url' =&gt; bp_get_group_permalink($group), 'date' =&gt; $group-&gt;date_created);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function group_edit($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return bp_get_group_permalink($id) . 'admin/edit-details/';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function group_delete($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return !groups_get_group(array('group_id' =&gt; $id)) || groups_delete_group($id);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function group_print_link()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $group = $GLOBALS['bp']-&gt;groups-&gt;current_group;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $is_author = $group-&gt;creator_id == bp_loggedin_user_id();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (!$is_author && !empty($group-&gt;admins)) {&nbsp;</div></li><li><div>            foreach ($group-&gt;admins as $admin) {&nbsp;</div></li><li><div>                if ($admin-&gt;user_id == bp_loggedin_user_id()) {&nbsp;</div></li><li><div>                    $is_author = true;&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $link = bpModFrontend::get_link(array(&nbsp;</div></li><li><div>                                             'type' =&gt; 'group', &nbsp;</div></li><li><div>                                             'is_author' =&gt; $is_author, &nbsp;</div></li><li><div>                                             'id' =&gt; $group-&gt;id, &nbsp;</div></li><li><div>                                             'id2' =&gt; 0, &nbsp;</div></li><li><div>                                             'unflagged_text' =&gt; __('Flag this group as inappropriate', 'bp-moderation')&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo &quot;&lt;div class='bpm-right-link bpm-bottom-link'&gt;$link&lt;/div&gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /*******************************************************************************&nbsp;</div></li><li><div>     * forum_topic&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function forum_topic_info($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if (!$topic = bp_forums_get_topic_details($id2)) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $url = bp_core_get_root_domain() . '/' . BP_GROUPS_SLUG . '/' . $topic-&gt;object_slug . '/forum/topic/' . $topic-&gt;topic_slug . '/';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return array('author' =&gt; $topic-&gt;topic_poster, 'url' =&gt; $url, 'date' =&gt; $topic-&gt;topic_start_time);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function forum_topic_edit($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if (!$topic = bp_forums_get_topic_details($id2)) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $url = bp_core_get_root_domain() . '/' . BP_GROUPS_SLUG . '/' . $topic-&gt;object_slug . '/forum/topic/' . $topic-&gt;topic_slug . '/edit/';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return wp_nonce_url($url, 'bp_forums_edit_topic');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function forum_topic_delete($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return !bp_forums_get_topic_details($id2) || groups_delete_group_forum_topic($id2);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function forum_topic_print_link()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $link = bpModFrontend::get_link(array(&nbsp;</div></li><li><div>                                             'type' =&gt; 'forum_topic', &nbsp;</div></li><li><div>                                             'author_id' =&gt; 0, &nbsp;</div></li><li><div>                                             'id' =&gt; $GLOBALS['bp']-&gt;groups-&gt;current_group-&gt;id, &nbsp;</div></li><li><div>                                             'id2' =&gt; bp_get_the_topic_id(), &nbsp;</div></li><li><div>                                             'unflagged_text' =&gt; __('Flag Whole Topic', 'bp-moderation'), &nbsp;</div></li><li><div>                                             'custom_class' =&gt; 'bpm-no-images'&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>        echo &quot;&lt;span class='links-separator'&gt; | &lt;/span&gt;$link&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /*******************************************************************************&nbsp;</div></li><li><div>     * forum_post&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function forum_post_info($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if (!$post = bp_forums_get_post($id2)) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $topic = bp_forums_get_topic_details($post-&gt;topic_id);&nbsp;</div></li><li><div>        $url = bp_core_get_root_domain() . '/' . BP_GROUPS_SLUG . '/' . $topic-&gt;object_slug . '/forum/topic/' . $topic-&gt;topic_slug . '/#post-' . $post-&gt;post_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return array('author' =&gt; $post-&gt;poster_id, 'url' =&gt; $url, 'date' =&gt; $post-&gt;post_time);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function forum_post_edit($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if (!$post = bp_forums_get_post($id2)) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $topic = bp_forums_get_topic_details($post-&gt;topic_id);&nbsp;</div></li><li><div>        $url = bp_core_get_root_domain() . '/' . BP_GROUPS_SLUG . '/' . $topic-&gt;object_slug . '/forum/topic/' . $topic-&gt;topic_slug . '/edit/post/' . $post-&gt;post_id . '/';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return wp_nonce_url($url, 'bp_forums_edit_post');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function forum_post_delete($id, $id2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if (!$post = bp_forums_get_post($id2)) {&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // deleting a post don't remove it from db, it just set its status to 1&nbsp;</div></li><li><div>        if (1 == (int)$post-&gt;post_status) {&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (!groups_delete_group_forum_post($id2, $post-&gt;topic_id)) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //if it was the first post (topic), then the activity doesn't get delete by bp because is new_forum_topic, instead of new_forum_post&nbsp;</div></li><li><div>        //so we check if it is the first post and then delete the activity&nbsp;</div></li><li><div>        if (function_exists('bp_activity_delete')) {&nbsp;</div></li><li><div>            $first_post = bp_forums_get_topic_posts(array('topic_id' =&gt; $post-&gt;topic_id, 'post_status' =&gt; 'all', 'page' =&gt; 1, 'per_page' =&gt; 1));&nbsp;</div></li><li><div>            if ($first_post[0]-&gt;post_id == $post-&gt;post_id) {&nbsp;</div></li><li><div>                bp_activity_delete(array('item_id' =&gt; $id, 'secondary_item_id' =&gt; $post-&gt;topic_id, 'component' =&gt; $GLOBALS['bp']-&gt;groups-&gt;id, 'type' =&gt; 'new_forum_topic'));&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return true;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function forum_post_convert_activity_args($args)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //in the 'new topic' activity we want to flag only the first post, not the whole topic&nbsp;</div></li><li><div>        $first_post = bp_forums_get_topic_posts(array('topic_id' =&gt; $args['id2'], 'post_status' =&gt; 'all', 'page' =&gt; 1, 'per_page' =&gt; 1));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $args['id2'] = $first_post[0]-&gt;post_id;&nbsp;</div></li><li><div>        return $args;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function forum_post_print_link()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        global $topic_template, $bp;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $link = bpModFrontend::get_link(array(&nbsp;</div></li><li><div>                                             'type' =&gt; 'forum_post', &nbsp;</div></li><li><div>                                             'author_id' =&gt; $topic_template-&gt;post-&gt;poster_id, &nbsp;</div></li><li><div>                                             'id' =&gt; $bp-&gt;groups-&gt;current_group-&gt;id, &nbsp;</div></li><li><div>                                             'id2' =&gt; $topic_template-&gt;post-&gt;post_id, &nbsp;</div></li><li><div>                                             'unflagged_text' =&gt; __('Flag', 'bp-moderation'), &nbsp;</div></li><li><div>                                             'custom_class' =&gt; 'bpm-no-images'&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo &quot;&lt;span class='links-separator'&gt; | &lt;/span&gt;$link&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>/*******************************************************************************&nbsp;</div></li><li><div> * Private message sender&nbsp;</div></li><li><div> */&nbsp;</div></li><li><div>    function private_message_sender_print_links()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $report_links = array();&nbsp;</div></li><li><div>        foreach((array)$GLOBALS['thread_template']-&gt;thread-&gt;sender_ids as $sender_id) {&nbsp;</div></li><li><div>            if ($sender_id != bp_loggedin_user_id()) {&nbsp;</div></li><li><div>                $report_links[] = bpModFrontend::get_link(array(&nbsp;</div></li><li><div>                                        'type' =&gt; 'member', &nbsp;</div></li><li><div>                                        'id' =&gt; $sender_id, &nbsp;</div></li><li><div>                                        'unflagged_text' =&gt; bp_core_get_user_displayname($sender_id), &nbsp;</div></li><li><div>                                        'flagged_text' =&gt; bp_core_get_user_displayname($sender_id), &nbsp;</div></li><li><div>                                        'custom_class' =&gt; 'button'&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        if (!count($report_links)) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        echo '&lt;p class=&quot;bp-mod-pm-thread-links&quot;&gt;';&nbsp;</div></li><li><div>        printf(__('Flag sender as inappropriate: %s', 'bp-moderation'), join(' ', $report_links));&nbsp;</div></li><li><div>        echo '&lt;/p&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>/*******************************************************************************&nbsp;</div></li><li><div> * Private message&nbsp;</div></li><li><div> */&nbsp;</div></li><li><div>    function private_message_info($thread_id, $sender_id)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $thread = new BP_Messages_Thread($thread_id, 'DESC');&nbsp;</div></li><li><div>        if (!in_array($sender_id, $thread-&gt;sender_ids)) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $url = bp_core_get_user_domain($sender_id) . bp_get_messages_slug() . '/view/' . $thread_id;&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        foreach ((array) $thread-&gt;messages as $msg) {&nbsp;</div></li><li><div>            if ($sender_id == $msg-&gt;sender_id) {&nbsp;</div></li><li><div>                return array('author' =&gt; $sender_id, 'url' =&gt; $url, 'date' =&gt; $msg-&gt;date_sent);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function private_message_delete($thread_id, $sender_id)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        global $wpdb, $bp;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $delete_for_user = $wpdb-&gt;query( $wpdb-&gt;prepare( &quot;UPDATE {$bp-&gt;messages-&gt;table_name_recipients} SET is_deleted = 1 WHERE thread_id = %d AND user_id = %d&quot;, $thread_id, $sender_id) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Check to see if any more recipients remain for this message&nbsp;</div></li><li><div>        // if not, then delete the message from the database.&nbsp;</div></li><li><div>        $recipients = $wpdb-&gt;get_results( $wpdb-&gt;prepare( &quot;SELECT id FROM {$bp-&gt;messages-&gt;table_name_recipients} WHERE thread_id = %d AND is_deleted = 0&quot;, $thread_id ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $recipients ) ) {&nbsp;</div></li><li><div>            // Delete all the messages&nbsp;</div></li><li><div>            $wpdb-&gt;query( $wpdb-&gt;prepare( &quot;DELETE FROM {$bp-&gt;messages-&gt;table_name_messages} WHERE thread_id = %d&quot;, $thread_id ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Delete all the recipients&nbsp;</div></li><li><div>            $wpdb-&gt;query( $wpdb-&gt;prepare( &quot;DELETE FROM {$bp-&gt;messages-&gt;table_name_recipients} WHERE thread_id = %d&quot;, $thread_id ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return true;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function private_message_print_links()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $report_links = array();&nbsp;</div></li><li><div>        foreach((array)$GLOBALS['thread_template']-&gt;thread-&gt;sender_ids as $sender_id) {&nbsp;</div></li><li><div>            if ($sender_id != bp_loggedin_user_id()) {&nbsp;</div></li><li><div>                $report_links[] = bpModFrontend::get_link(array(&nbsp;</div></li><li><div>                                        'type' =&gt; 'private_message', &nbsp;</div></li><li><div>                                        'id' =&gt; bp_get_the_thread_id(), &nbsp;</div></li><li><div>                                        'id2' =&gt; $sender_id, &nbsp;</div></li><li><div>                                        'unflagged_text' =&gt; bp_core_get_user_displayname($sender_id), &nbsp;</div></li><li><div>                                        'flagged_text' =&gt; bp_core_get_user_displayname($sender_id), &nbsp;</div></li><li><div>                                        'custom_class' =&gt; 'button'&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        if (!count($report_links)) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        echo '&lt;p class=&quot;bp-mod-pm-thread-links&quot;&gt;';&nbsp;</div></li><li><div>        printf(__('Flag as inappropriate messages by: %s', 'bp-moderation'), join(' ', $report_links));&nbsp;</div></li><li><div>        echo '&lt;/p&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    function private_message_view_link_override($content) {&nbsp;</div></li><li><div>        $content-&gt;item_url = wp_nonce_url($content-&gt;item_url.'?bpmSuperAdminOverridePrivateMessage', 'bpmSuperAdminOverridePrivateMessage');&nbsp;</div></li><li><div>        return $content;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    function private_message_super_admin_override() {&nbsp;</div></li><li><div>        if(!isset($_GET['bpmSuperAdminOverridePrivateMessage']) || !is_super_admin()) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        check_admin_referer('bpmSuperAdminOverridePrivateMessage');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $thread_id = (int)bp_action_variable( 0 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        bp_core_new_subnav_item( array(&nbsp;</div></li><li><div>            'name' =&gt; sprintf( __( 'Review message by %s', 'bp-moderation' ), bp_get_displayed_user_username() ), &nbsp;</div></li><li><div>            'slug' =&gt; 'view', &nbsp;</div></li><li><div>            'parent_url' =&gt; trailingslashit( bp_displayed_user_domain() . bp_get_messages_slug() ), &nbsp;</div></li><li><div>            'parent_slug' =&gt; bp_get_messages_slug(), &nbsp;</div></li><li><div>            'screen_function' =&gt; true, &nbsp;</div></li><li><div>            'position' =&gt; 40, &nbsp;</div></li><li><div>            'user_has_access' =&gt; is_super_admin(), &nbsp;</div></li><li><div>            'link' =&gt; bp_displayed_user_domain() . bp_get_messages_slug() . '/view/' . (int) $thread_id&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        bp_core_load_template( apply_filters( 'messages_template_view_message', 'members/single/home' ) );&nbsp;</div></li><li><div>        die();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 0.1.3</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/buddypress-moderation/0.1.7/classes/bp_mod_default_content_types/" class="active">0.1.7</a></li><li><a href="http://hookr.io/plugins/buddypress-moderation/0.1.6/classes/bp_mod_default_content_types/" class="">0.1.6</a></li><li><a href="http://hookr.io/plugins/buddypress-moderation/0.1.5/classes/bp_mod_default_content_types/" class="">0.1.5</a></li><li><a href="http://hookr.io/plugins/buddypress-moderation/0.1.4/classes/bp_mod_default_content_types/" class="">0.1.4</a></li><li><a href="http://hookr.io/plugins/buddypress-moderation/0.1.3/classes/bp_mod_default_content_types/" class="">0.1.3</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>bpModDefaultContentTypes</li><li><span></span>BuddyPress Moderation</li><li><span></span>0.1.7</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>