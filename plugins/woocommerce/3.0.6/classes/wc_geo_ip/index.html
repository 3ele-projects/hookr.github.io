<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="3.0.6" data-slug="woocommerce" data-type="class" data-id="41271"><head xmlns="http://www.w3.org/1999/xhtml"><title> wc_geo_ip | class | Woocommerce | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="WC_Geo_IP, class, plugin, woocommerce, 3.0.6" /><meta name="description" content="WC_Geo_IP Class." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.25"}};!function(e,n,t){var a;function i(e){var t=n.createElement("canvas"),a=t.getContext&&t.getContext("2d"),i=String.fromCharCode;return!(!a||!a.fillText)&&(a.textBaseline="top",a.font="600 32px Arial","flag"===e?(a.fillText(i(55356,56806,55356,56826),0,0),3e3<t.toDataURL().length):"diversity"===e?(a.fillText(i(55356,57221),0,0),t=a.getImageData(16,16,1,1).data,a.fillText(i(55356,57221,55356,57343),0,0),(t=a.getImageData(16,16,1,1).data)[0],t[1],t[2],t[3],!0):("simple"===e?a.fillText(i(55357,56835),0,0):a.fillText(i(55356,57135),0,0),0!==a.getImageData(16,16,1,1).data[0]))}function o(e){var t=n.createElement("script");t.src=e,t.type="text/javascript",n.getElementsByTagName("head")[0].appendChild(t)}t.supports={simple:i("simple"),flag:i("flag"),unicode8:i("unicode8"),diversity:i("diversity")},t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.simple&&t.supports.flag&&t.supports.unicode8&&t.supports.diversity||(a=function(){t.readyCallback()},n.addEventListener?(n.addEventListener("DOMContentLoaded",a,!1),e.addEventListener("load",a,!1)):(e.attachEvent("onload",a),n.attachEvent("onreadystatechange",function(){"complete"===n.readyState&&t.readyCallback()})),(a=t.source||{}).concatemoji?o(a.concatemoji):a.wpemoji&&a.twemoji&&(o(a.twemoji),o(a.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=e7f252627de548c81e2649772c118c27' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.25' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/wc_geo_ip/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fwc_geo_ip%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fwc_geo_ip%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-woocommerce-3.0.6-class-wc_geo_ip","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wc_geo_ip" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to woocommerce." href="http://hookr.io/plugins/woocommerce/" class="plugin"><span property="name">woocommerce</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 3.0.6." href="http://hookr.io/plugins/woocommerce/3.0.6/" class="H_VERSION"><span property="name">3.0.6</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/woocommerce/3.0.6/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wc_geo_ip</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="3119"><a href="http://hookr.io/plugins/woocommerce/3.0.6/all/" title="All">All <span class="count badge">3119</span></a></li><li class="" data-id="new" data-count="3"><a href="http://hookr.io/plugins/woocommerce/3.0.6/new/" title="New">New <span class="count badge">3</span></a></li><li class="" data-id="hooks" data-count="2110"><a href="http://hookr.io/plugins/woocommerce/3.0.6/hooks/" title="Hooks">Hooks <span class="count badge">2110</span></a></li><li class="" data-id="action" data-count="774"><a href="http://hookr.io/plugins/woocommerce/3.0.6/actions/" title="Actions">Actions <span class="count badge">774</span></a></li><li class="" data-id="filter" data-count="1336"><a href="http://hookr.io/plugins/woocommerce/3.0.6/filters/" title="Filters">Filters <span class="count badge">1336</span></a></li><li class="active" data-id="class" data-count="365"><a href="http://hookr.io/plugins/woocommerce/3.0.6/classes/" title="Classes">Classes <span class="count badge">365</span></a></li><li class="" data-id="constant" data-count="14"><a href="http://hookr.io/plugins/woocommerce/3.0.6/constants/" title="Constants">Constants <span class="count badge">14</span></a></li><li class="" data-id="function" data-count="626"><a href="http://hookr.io/plugins/woocommerce/3.0.6/functions/" title="Functions">Functions <span class="count badge">626</span></a></li><li class="" data-id="shortcode" data-count="4"><a href="http://hookr.io/plugins/woocommerce/3.0.6/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">4</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>WC_Geo_IP</strong></h1><p>WC_Geo_IP Class.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/woocommerce/3.0.6/files/includes-class-wc-geo-ip/" class="file">/includes/class-wc-geo-ip.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="20" class="block" start="20"><li><div>class WC_Geo_IP {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    const GEOIP_COUNTRY_BEGIN = 16776960;&nbsp;</div></li><li><div>    const GEOIP_STATE_BEGIN_REV0 = 16700000;&nbsp;</div></li><li><div>    const GEOIP_STATE_BEGIN_REV1 = 16000000;&nbsp;</div></li><li><div>    const GEOIP_MEMORY_CACHE = 1;&nbsp;</div></li><li><div>    const GEOIP_SHARED_MEMORY = 2;&nbsp;</div></li><li><div>    const STRUCTURE_INFO_MAX_SIZE = 20;&nbsp;</div></li><li><div>    const GEOIP_COUNTRY_EDITION = 1;&nbsp;</div></li><li><div>    const GEOIP_PROXY_EDITION = 8;&nbsp;</div></li><li><div>    const GEOIP_ASNUM_EDITION = 9;&nbsp;</div></li><li><div>    const GEOIP_NETSPEED_EDITION = 10;&nbsp;</div></li><li><div>    const GEOIP_REGION_EDITION_REV0 = 7;&nbsp;</div></li><li><div>    const GEOIP_REGION_EDITION_REV1 = 3;&nbsp;</div></li><li><div>    const GEOIP_CITY_EDITION_REV0 = 6;&nbsp;</div></li><li><div>    const GEOIP_CITY_EDITION_REV1 = 2;&nbsp;</div></li><li><div>    const GEOIP_ORG_EDITION = 5;&nbsp;</div></li><li><div>    const GEOIP_ISP_EDITION = 4;&nbsp;</div></li><li><div>    const SEGMENT_RECORD_LENGTH = 3;&nbsp;</div></li><li><div>    const STANDARD_RECORD_LENGTH = 3;&nbsp;</div></li><li><div>    const ORG_RECORD_LENGTH = 4;&nbsp;</div></li><li><div>    const GEOIP_SHM_KEY = 0x4f415401;&nbsp;</div></li><li><div>    const GEOIP_DOMAIN_EDITION = 11;&nbsp;</div></li><li><div>    const GEOIP_COUNTRY_EDITION_V6 = 12;&nbsp;</div></li><li><div>    const GEOIP_LOCATIONA_EDITION = 13;&nbsp;</div></li><li><div>    const GEOIP_ACCURACYRADIUS_EDITION = 14;&nbsp;</div></li><li><div>    const GEOIP_CITY_EDITION_REV1_V6 = 30;&nbsp;</div></li><li><div>    const GEOIP_CITY_EDITION_REV0_V6 = 31;&nbsp;</div></li><li><div>    const GEOIP_NETSPEED_EDITION_REV1 = 32;&nbsp;</div></li><li><div>    const GEOIP_NETSPEED_EDITION_REV1_V6 = 33;&nbsp;</div></li><li><div>    const GEOIP_USERTYPE_EDITION = 28;&nbsp;</div></li><li><div>    const GEOIP_USERTYPE_EDITION_V6 = 29;&nbsp;</div></li><li><div>    const GEOIP_ASNUM_EDITION_V6 = 21;&nbsp;</div></li><li><div>    const GEOIP_ISP_EDITION_V6 = 22;&nbsp;</div></li><li><div>    const GEOIP_ORG_EDITION_V6 = 23;&nbsp;</div></li><li><div>    const GEOIP_DOMAIN_EDITION_V6 = 24;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Flags.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @var int&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public $flags;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * File handler.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @var resource&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public $filehandle;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Memory buffer.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @var string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public $memory_buffer;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Database type.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @var int&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public $databaseType;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Database segments.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @var int&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public $databaseSegments;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Record length.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @var int&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public $record_length;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Shmid.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @var string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public $shmid;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Two letters country codes.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public $GEOIP_COUNTRY_CODES = array(&nbsp;</div></li><li><div>        '', &nbsp;</div></li><li><div>        'AP', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AD', &nbsp;</div></li><li><div>        'AE', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AG', &nbsp;</div></li><li><div>        'AI', &nbsp;</div></li><li><div>        'AL', &nbsp;</div></li><li><div>        'AM', &nbsp;</div></li><li><div>        'CW', &nbsp;</div></li><li><div>        'AO', &nbsp;</div></li><li><div>        'AQ', &nbsp;</div></li><li><div>        'AR', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AT', &nbsp;</div></li><li><div>        'AU', &nbsp;</div></li><li><div>        'AW', &nbsp;</div></li><li><div>        'AZ', &nbsp;</div></li><li><div>        'BA', &nbsp;</div></li><li><div>        'BB', &nbsp;</div></li><li><div>        'BD', &nbsp;</div></li><li><div>        'BE', &nbsp;</div></li><li><div>        'BF', &nbsp;</div></li><li><div>        'BG', &nbsp;</div></li><li><div>        'BH', &nbsp;</div></li><li><div>        'BI', &nbsp;</div></li><li><div>        'BJ', &nbsp;</div></li><li><div>        'BM', &nbsp;</div></li><li><div>        'BN', &nbsp;</div></li><li><div>        'BO', &nbsp;</div></li><li><div>        'BR', &nbsp;</div></li><li><div>        'BS', &nbsp;</div></li><li><div>        'BT', &nbsp;</div></li><li><div>        'BV', &nbsp;</div></li><li><div>        'BW', &nbsp;</div></li><li><div>        'BY', &nbsp;</div></li><li><div>        'BZ', &nbsp;</div></li><li><div>        'CA', &nbsp;</div></li><li><div>        'CC', &nbsp;</div></li><li><div>        'CD', &nbsp;</div></li><li><div>        'CF', &nbsp;</div></li><li><div>        'CG', &nbsp;</div></li><li><div>        'CH', &nbsp;</div></li><li><div>        'CI', &nbsp;</div></li><li><div>        'CK', &nbsp;</div></li><li><div>        'CL', &nbsp;</div></li><li><div>        'CM', &nbsp;</div></li><li><div>        'CN', &nbsp;</div></li><li><div>        'CO', &nbsp;</div></li><li><div>        'CR', &nbsp;</div></li><li><div>        'CU', &nbsp;</div></li><li><div>        'CV', &nbsp;</div></li><li><div>        'CX', &nbsp;</div></li><li><div>        'CY', &nbsp;</div></li><li><div>        'CZ', &nbsp;</div></li><li><div>        'DE', &nbsp;</div></li><li><div>        'DJ', &nbsp;</div></li><li><div>        'DK', &nbsp;</div></li><li><div>        'DM', &nbsp;</div></li><li><div>        'DO', &nbsp;</div></li><li><div>        'DZ', &nbsp;</div></li><li><div>        'EC', &nbsp;</div></li><li><div>        'EE', &nbsp;</div></li><li><div>        'EG', &nbsp;</div></li><li><div>        'EH', &nbsp;</div></li><li><div>        'ER', &nbsp;</div></li><li><div>        'ES', &nbsp;</div></li><li><div>        'ET', &nbsp;</div></li><li><div>        'FI', &nbsp;</div></li><li><div>        'FJ', &nbsp;</div></li><li><div>        'FK', &nbsp;</div></li><li><div>        'FM', &nbsp;</div></li><li><div>        'FO', &nbsp;</div></li><li><div>        'FR', &nbsp;</div></li><li><div>        'SX', &nbsp;</div></li><li><div>        'GA', &nbsp;</div></li><li><div>        'GB', &nbsp;</div></li><li><div>        'GD', &nbsp;</div></li><li><div>        'GE', &nbsp;</div></li><li><div>        'GF', &nbsp;</div></li><li><div>        'GH', &nbsp;</div></li><li><div>        'GI', &nbsp;</div></li><li><div>        'GL', &nbsp;</div></li><li><div>        'GM', &nbsp;</div></li><li><div>        'GN', &nbsp;</div></li><li><div>        'GP', &nbsp;</div></li><li><div>        'GQ', &nbsp;</div></li><li><div>        'GR', &nbsp;</div></li><li><div>        'GS', &nbsp;</div></li><li><div>        'GT', &nbsp;</div></li><li><div>        'GU', &nbsp;</div></li><li><div>        'GW', &nbsp;</div></li><li><div>        'GY', &nbsp;</div></li><li><div>        'HK', &nbsp;</div></li><li><div>        'HM', &nbsp;</div></li><li><div>        'HN', &nbsp;</div></li><li><div>        'HR', &nbsp;</div></li><li><div>        'HT', &nbsp;</div></li><li><div>        'HU', &nbsp;</div></li><li><div>        'ID', &nbsp;</div></li><li><div>        'IE', &nbsp;</div></li><li><div>        'IL', &nbsp;</div></li><li><div>        'IN', &nbsp;</div></li><li><div>        'IO', &nbsp;</div></li><li><div>        'IQ', &nbsp;</div></li><li><div>        'IR', &nbsp;</div></li><li><div>        'IS', &nbsp;</div></li><li><div>        'IT', &nbsp;</div></li><li><div>        'JM', &nbsp;</div></li><li><div>        'JO', &nbsp;</div></li><li><div>        'JP', &nbsp;</div></li><li><div>        'KE', &nbsp;</div></li><li><div>        'KG', &nbsp;</div></li><li><div>        'KH', &nbsp;</div></li><li><div>        'KI', &nbsp;</div></li><li><div>        'KM', &nbsp;</div></li><li><div>        'KN', &nbsp;</div></li><li><div>        'KP', &nbsp;</div></li><li><div>        'KR', &nbsp;</div></li><li><div>        'KW', &nbsp;</div></li><li><div>        'KY', &nbsp;</div></li><li><div>        'KZ', &nbsp;</div></li><li><div>        'LA', &nbsp;</div></li><li><div>        'LB', &nbsp;</div></li><li><div>        'LC', &nbsp;</div></li><li><div>        'LI', &nbsp;</div></li><li><div>        'LK', &nbsp;</div></li><li><div>        'LR', &nbsp;</div></li><li><div>        'LS', &nbsp;</div></li><li><div>        'LT', &nbsp;</div></li><li><div>        'LU', &nbsp;</div></li><li><div>        'LV', &nbsp;</div></li><li><div>        'LY', &nbsp;</div></li><li><div>        'MA', &nbsp;</div></li><li><div>        'MC', &nbsp;</div></li><li><div>        'MD', &nbsp;</div></li><li><div>        'MG', &nbsp;</div></li><li><div>        'MH', &nbsp;</div></li><li><div>        'MK', &nbsp;</div></li><li><div>        'ML', &nbsp;</div></li><li><div>        'MM', &nbsp;</div></li><li><div>        'MN', &nbsp;</div></li><li><div>        'MO', &nbsp;</div></li><li><div>        'MP', &nbsp;</div></li><li><div>        'MQ', &nbsp;</div></li><li><div>        'MR', &nbsp;</div></li><li><div>        'MS', &nbsp;</div></li><li><div>        'MT', &nbsp;</div></li><li><div>        'MU', &nbsp;</div></li><li><div>        'MV', &nbsp;</div></li><li><div>        'MW', &nbsp;</div></li><li><div>        'MX', &nbsp;</div></li><li><div>        'MY', &nbsp;</div></li><li><div>        'MZ', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'NC', &nbsp;</div></li><li><div>        'NE', &nbsp;</div></li><li><div>        'NF', &nbsp;</div></li><li><div>        'NG', &nbsp;</div></li><li><div>        'NI', &nbsp;</div></li><li><div>        'NL', &nbsp;</div></li><li><div>        'NO', &nbsp;</div></li><li><div>        'NP', &nbsp;</div></li><li><div>        'NR', &nbsp;</div></li><li><div>        'NU', &nbsp;</div></li><li><div>        'NZ', &nbsp;</div></li><li><div>        'OM', &nbsp;</div></li><li><div>        'PA', &nbsp;</div></li><li><div>        'PE', &nbsp;</div></li><li><div>        'PF', &nbsp;</div></li><li><div>        'PG', &nbsp;</div></li><li><div>        'PH', &nbsp;</div></li><li><div>        'PK', &nbsp;</div></li><li><div>        'PL', &nbsp;</div></li><li><div>        'PM', &nbsp;</div></li><li><div>        'PN', &nbsp;</div></li><li><div>        'PR', &nbsp;</div></li><li><div>        'PS', &nbsp;</div></li><li><div>        'PT', &nbsp;</div></li><li><div>        'PW', &nbsp;</div></li><li><div>        'PY', &nbsp;</div></li><li><div>        'QA', &nbsp;</div></li><li><div>        'RE', &nbsp;</div></li><li><div>        'RO', &nbsp;</div></li><li><div>        'RU', &nbsp;</div></li><li><div>        'RW', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'SB', &nbsp;</div></li><li><div>        'SC', &nbsp;</div></li><li><div>        'SD', &nbsp;</div></li><li><div>        'SE', &nbsp;</div></li><li><div>        'SG', &nbsp;</div></li><li><div>        'SH', &nbsp;</div></li><li><div>        'SI', &nbsp;</div></li><li><div>        'SJ', &nbsp;</div></li><li><div>        'SK', &nbsp;</div></li><li><div>        'SL', &nbsp;</div></li><li><div>        'SM', &nbsp;</div></li><li><div>        'SN', &nbsp;</div></li><li><div>        'SO', &nbsp;</div></li><li><div>        'SR', &nbsp;</div></li><li><div>        'ST', &nbsp;</div></li><li><div>        'SV', &nbsp;</div></li><li><div>        'SY', &nbsp;</div></li><li><div>        'SZ', &nbsp;</div></li><li><div>        'TC', &nbsp;</div></li><li><div>        'TD', &nbsp;</div></li><li><div>        'TF', &nbsp;</div></li><li><div>        'TG', &nbsp;</div></li><li><div>        'TH', &nbsp;</div></li><li><div>        'TJ', &nbsp;</div></li><li><div>        'TK', &nbsp;</div></li><li><div>        'TM', &nbsp;</div></li><li><div>        'TN', &nbsp;</div></li><li><div>        'TO', &nbsp;</div></li><li><div>        'TL', &nbsp;</div></li><li><div>        'TR', &nbsp;</div></li><li><div>        'TT', &nbsp;</div></li><li><div>        'TV', &nbsp;</div></li><li><div>        'TW', &nbsp;</div></li><li><div>        'TZ', &nbsp;</div></li><li><div>        'UA', &nbsp;</div></li><li><div>        'UG', &nbsp;</div></li><li><div>        'UM', &nbsp;</div></li><li><div>        'US', &nbsp;</div></li><li><div>        'UY', &nbsp;</div></li><li><div>        'UZ', &nbsp;</div></li><li><div>        'VA', &nbsp;</div></li><li><div>        'VC', &nbsp;</div></li><li><div>        'VE', &nbsp;</div></li><li><div>        'VG', &nbsp;</div></li><li><div>        'VI', &nbsp;</div></li><li><div>        'VN', &nbsp;</div></li><li><div>        'VU', &nbsp;</div></li><li><div>        'WF', &nbsp;</div></li><li><div>        'WS', &nbsp;</div></li><li><div>        'YE', &nbsp;</div></li><li><div>        'YT', &nbsp;</div></li><li><div>        'RS', &nbsp;</div></li><li><div>        'ZA', &nbsp;</div></li><li><div>        'ZM', &nbsp;</div></li><li><div>        'ME', &nbsp;</div></li><li><div>        'ZW', &nbsp;</div></li><li><div>        'A1', &nbsp;</div></li><li><div>        'A2', &nbsp;</div></li><li><div>        'O1', &nbsp;</div></li><li><div>        'AX', &nbsp;</div></li><li><div>        'GG', &nbsp;</div></li><li><div>        'IM', &nbsp;</div></li><li><div>        'JE', &nbsp;</div></li><li><div>        'BL', &nbsp;</div></li><li><div>        'MF', &nbsp;</div></li><li><div>        'BQ', &nbsp;</div></li><li><div>        'SS', &nbsp;</div></li><li><div>        'O1', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * 3 letters country codes.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public $GEOIP_COUNTRY_CODES3 = array(&nbsp;</div></li><li><div>        '', &nbsp;</div></li><li><div>        'AP', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AND', &nbsp;</div></li><li><div>        'ARE', &nbsp;</div></li><li><div>        'AFG', &nbsp;</div></li><li><div>        'ATG', &nbsp;</div></li><li><div>        'AIA', &nbsp;</div></li><li><div>        'ALB', &nbsp;</div></li><li><div>        'ARM', &nbsp;</div></li><li><div>        'CUW', &nbsp;</div></li><li><div>        'AGO', &nbsp;</div></li><li><div>        'ATA', &nbsp;</div></li><li><div>        'ARG', &nbsp;</div></li><li><div>        'ASM', &nbsp;</div></li><li><div>        'AUT', &nbsp;</div></li><li><div>        'AUS', &nbsp;</div></li><li><div>        'ABW', &nbsp;</div></li><li><div>        'AZE', &nbsp;</div></li><li><div>        'BIH', &nbsp;</div></li><li><div>        'BRB', &nbsp;</div></li><li><div>        'BGD', &nbsp;</div></li><li><div>        'BEL', &nbsp;</div></li><li><div>        'BFA', &nbsp;</div></li><li><div>        'BGR', &nbsp;</div></li><li><div>        'BHR', &nbsp;</div></li><li><div>        'BDI', &nbsp;</div></li><li><div>        'BEN', &nbsp;</div></li><li><div>        'BMU', &nbsp;</div></li><li><div>        'BRN', &nbsp;</div></li><li><div>        'BOL', &nbsp;</div></li><li><div>        'BRA', &nbsp;</div></li><li><div>        'BHS', &nbsp;</div></li><li><div>        'BTN', &nbsp;</div></li><li><div>        'BVT', &nbsp;</div></li><li><div>        'BWA', &nbsp;</div></li><li><div>        'BLR', &nbsp;</div></li><li><div>        'BLZ', &nbsp;</div></li><li><div>        'CAN', &nbsp;</div></li><li><div>        'CCK', &nbsp;</div></li><li><div>        'COD', &nbsp;</div></li><li><div>        'CAF', &nbsp;</div></li><li><div>        'COG', &nbsp;</div></li><li><div>        'CHE', &nbsp;</div></li><li><div>        'CIV', &nbsp;</div></li><li><div>        'COK', &nbsp;</div></li><li><div>        'CHL', &nbsp;</div></li><li><div>        'CMR', &nbsp;</div></li><li><div>        'CHN', &nbsp;</div></li><li><div>        'COL', &nbsp;</div></li><li><div>        'CRI', &nbsp;</div></li><li><div>        'CUB', &nbsp;</div></li><li><div>        'CPV', &nbsp;</div></li><li><div>        'CXR', &nbsp;</div></li><li><div>        'CYP', &nbsp;</div></li><li><div>        'CZE', &nbsp;</div></li><li><div>        'DEU', &nbsp;</div></li><li><div>        'DJI', &nbsp;</div></li><li><div>        'DNK', &nbsp;</div></li><li><div>        'DMA', &nbsp;</div></li><li><div>        'DOM', &nbsp;</div></li><li><div>        'DZA', &nbsp;</div></li><li><div>        'ECU', &nbsp;</div></li><li><div>        'EST', &nbsp;</div></li><li><div>        'EGY', &nbsp;</div></li><li><div>        'ESH', &nbsp;</div></li><li><div>        'ERI', &nbsp;</div></li><li><div>        'ESP', &nbsp;</div></li><li><div>        'ETH', &nbsp;</div></li><li><div>        'FIN', &nbsp;</div></li><li><div>        'FJI', &nbsp;</div></li><li><div>        'FLK', &nbsp;</div></li><li><div>        'FSM', &nbsp;</div></li><li><div>        'FRO', &nbsp;</div></li><li><div>        'FRA', &nbsp;</div></li><li><div>        'SXM', &nbsp;</div></li><li><div>        'GAB', &nbsp;</div></li><li><div>        'GBR', &nbsp;</div></li><li><div>        'GRD', &nbsp;</div></li><li><div>        'GEO', &nbsp;</div></li><li><div>        'GUF', &nbsp;</div></li><li><div>        'GHA', &nbsp;</div></li><li><div>        'GIB', &nbsp;</div></li><li><div>        'GRL', &nbsp;</div></li><li><div>        'GMB', &nbsp;</div></li><li><div>        'GIN', &nbsp;</div></li><li><div>        'GLP', &nbsp;</div></li><li><div>        'GNQ', &nbsp;</div></li><li><div>        'GRC', &nbsp;</div></li><li><div>        'SGS', &nbsp;</div></li><li><div>        'GTM', &nbsp;</div></li><li><div>        'GUM', &nbsp;</div></li><li><div>        'GNB', &nbsp;</div></li><li><div>        'GUY', &nbsp;</div></li><li><div>        'HKG', &nbsp;</div></li><li><div>        'HMD', &nbsp;</div></li><li><div>        'HND', &nbsp;</div></li><li><div>        'HRV', &nbsp;</div></li><li><div>        'HTI', &nbsp;</div></li><li><div>        'HUN', &nbsp;</div></li><li><div>        'IDN', &nbsp;</div></li><li><div>        'IRL', &nbsp;</div></li><li><div>        'ISR', &nbsp;</div></li><li><div>        'IND', &nbsp;</div></li><li><div>        'IOT', &nbsp;</div></li><li><div>        'IRQ', &nbsp;</div></li><li><div>        'IRN', &nbsp;</div></li><li><div>        'ISL', &nbsp;</div></li><li><div>        'ITA', &nbsp;</div></li><li><div>        'JAM', &nbsp;</div></li><li><div>        'JOR', &nbsp;</div></li><li><div>        'JPN', &nbsp;</div></li><li><div>        'KEN', &nbsp;</div></li><li><div>        'KGZ', &nbsp;</div></li><li><div>        'KHM', &nbsp;</div></li><li><div>        'KIR', &nbsp;</div></li><li><div>        'COM', &nbsp;</div></li><li><div>        'KNA', &nbsp;</div></li><li><div>        'PRK', &nbsp;</div></li><li><div>        'KOR', &nbsp;</div></li><li><div>        'KWT', &nbsp;</div></li><li><div>        'CYM', &nbsp;</div></li><li><div>        'KAZ', &nbsp;</div></li><li><div>        'LAO', &nbsp;</div></li><li><div>        'LBN', &nbsp;</div></li><li><div>        'LCA', &nbsp;</div></li><li><div>        'LIE', &nbsp;</div></li><li><div>        'LKA', &nbsp;</div></li><li><div>        'LBR', &nbsp;</div></li><li><div>        'LSO', &nbsp;</div></li><li><div>        'LTU', &nbsp;</div></li><li><div>        'LUX', &nbsp;</div></li><li><div>        'LVA', &nbsp;</div></li><li><div>        'LBY', &nbsp;</div></li><li><div>        'MAR', &nbsp;</div></li><li><div>        'MCO', &nbsp;</div></li><li><div>        'MDA', &nbsp;</div></li><li><div>        'MDG', &nbsp;</div></li><li><div>        'MHL', &nbsp;</div></li><li><div>        'MKD', &nbsp;</div></li><li><div>        'MLI', &nbsp;</div></li><li><div>        'MMR', &nbsp;</div></li><li><div>        'MNG', &nbsp;</div></li><li><div>        'MAC', &nbsp;</div></li><li><div>        'MNP', &nbsp;</div></li><li><div>        'MTQ', &nbsp;</div></li><li><div>        'MRT', &nbsp;</div></li><li><div>        'MSR', &nbsp;</div></li><li><div>        'MLT', &nbsp;</div></li><li><div>        'MUS', &nbsp;</div></li><li><div>        'MDV', &nbsp;</div></li><li><div>        'MWI', &nbsp;</div></li><li><div>        'MEX', &nbsp;</div></li><li><div>        'MYS', &nbsp;</div></li><li><div>        'MOZ', &nbsp;</div></li><li><div>        'NAM', &nbsp;</div></li><li><div>        'NCL', &nbsp;</div></li><li><div>        'NER', &nbsp;</div></li><li><div>        'NFK', &nbsp;</div></li><li><div>        'NGA', &nbsp;</div></li><li><div>        'NIC', &nbsp;</div></li><li><div>        'NLD', &nbsp;</div></li><li><div>        'NOR', &nbsp;</div></li><li><div>        'NPL', &nbsp;</div></li><li><div>        'NRU', &nbsp;</div></li><li><div>        'NIU', &nbsp;</div></li><li><div>        'NZL', &nbsp;</div></li><li><div>        'OMN', &nbsp;</div></li><li><div>        'PAN', &nbsp;</div></li><li><div>        'PER', &nbsp;</div></li><li><div>        'PYF', &nbsp;</div></li><li><div>        'PNG', &nbsp;</div></li><li><div>        'PHL', &nbsp;</div></li><li><div>        'PAK', &nbsp;</div></li><li><div>        'POL', &nbsp;</div></li><li><div>        'SPM', &nbsp;</div></li><li><div>        'PCN', &nbsp;</div></li><li><div>        'PRI', &nbsp;</div></li><li><div>        'PSE', &nbsp;</div></li><li><div>        'PRT', &nbsp;</div></li><li><div>        'PLW', &nbsp;</div></li><li><div>        'PRY', &nbsp;</div></li><li><div>        'QAT', &nbsp;</div></li><li><div>        'REU', &nbsp;</div></li><li><div>        'ROU', &nbsp;</div></li><li><div>        'RUS', &nbsp;</div></li><li><div>        'RWA', &nbsp;</div></li><li><div>        'SAU', &nbsp;</div></li><li><div>        'SLB', &nbsp;</div></li><li><div>        'SYC', &nbsp;</div></li><li><div>        'SDN', &nbsp;</div></li><li><div>        'SWE', &nbsp;</div></li><li><div>        'SGP', &nbsp;</div></li><li><div>        'SHN', &nbsp;</div></li><li><div>        'SVN', &nbsp;</div></li><li><div>        'SJM', &nbsp;</div></li><li><div>        'SVK', &nbsp;</div></li><li><div>        'SLE', &nbsp;</div></li><li><div>        'SMR', &nbsp;</div></li><li><div>        'SEN', &nbsp;</div></li><li><div>        'SOM', &nbsp;</div></li><li><div>        'SUR', &nbsp;</div></li><li><div>        'STP', &nbsp;</div></li><li><div>        'SLV', &nbsp;</div></li><li><div>        'SYR', &nbsp;</div></li><li><div>        'SWZ', &nbsp;</div></li><li><div>        'TCA', &nbsp;</div></li><li><div>        'TCD', &nbsp;</div></li><li><div>        'ATF', &nbsp;</div></li><li><div>        'TGO', &nbsp;</div></li><li><div>        'THA', &nbsp;</div></li><li><div>        'TJK', &nbsp;</div></li><li><div>        'TKL', &nbsp;</div></li><li><div>        'TKM', &nbsp;</div></li><li><div>        'TUN', &nbsp;</div></li><li><div>        'TON', &nbsp;</div></li><li><div>        'TLS', &nbsp;</div></li><li><div>        'TUR', &nbsp;</div></li><li><div>        'TTO', &nbsp;</div></li><li><div>        'TUV', &nbsp;</div></li><li><div>        'TWN', &nbsp;</div></li><li><div>        'TZA', &nbsp;</div></li><li><div>        'UKR', &nbsp;</div></li><li><div>        'UGA', &nbsp;</div></li><li><div>        'UMI', &nbsp;</div></li><li><div>        'USA', &nbsp;</div></li><li><div>        'URY', &nbsp;</div></li><li><div>        'UZB', &nbsp;</div></li><li><div>        'VAT', &nbsp;</div></li><li><div>        'VCT', &nbsp;</div></li><li><div>        'VEN', &nbsp;</div></li><li><div>        'VGB', &nbsp;</div></li><li><div>        'VIR', &nbsp;</div></li><li><div>        'VNM', &nbsp;</div></li><li><div>        'VUT', &nbsp;</div></li><li><div>        'WLF', &nbsp;</div></li><li><div>        'WSM', &nbsp;</div></li><li><div>        'YEM', &nbsp;</div></li><li><div>        'MYT', &nbsp;</div></li><li><div>        'SRB', &nbsp;</div></li><li><div>        'ZAF', &nbsp;</div></li><li><div>        'ZMB', &nbsp;</div></li><li><div>        'MNE', &nbsp;</div></li><li><div>        'ZWE', &nbsp;</div></li><li><div>        'A1', &nbsp;</div></li><li><div>        'A2', &nbsp;</div></li><li><div>        'O1', &nbsp;</div></li><li><div>        'ALA', &nbsp;</div></li><li><div>        'GGY', &nbsp;</div></li><li><div>        'IMN', &nbsp;</div></li><li><div>        'JEY', &nbsp;</div></li><li><div>        'BLM', &nbsp;</div></li><li><div>        'MAF', &nbsp;</div></li><li><div>        'BES', &nbsp;</div></li><li><div>        'SSD', &nbsp;</div></li><li><div>        'O1', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Contry names.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public $GEOIP_COUNTRY_NAMES = array(&nbsp;</div></li><li><div>        '', &nbsp;</div></li><li><div>        'Asia/Pacific Region', &nbsp;</div></li><li><div>        'Europe', &nbsp;</div></li><li><div>        'Andorra', &nbsp;</div></li><li><div>        'United Arab Emirates', &nbsp;</div></li><li><div>        'Afghanistan', &nbsp;</div></li><li><div>        'Antigua and Barbuda', &nbsp;</div></li><li><div>        'Anguilla', &nbsp;</div></li><li><div>        'Albania', &nbsp;</div></li><li><div>        'Armenia', &nbsp;</div></li><li><div>        'Curacao', &nbsp;</div></li><li><div>        'Angola', &nbsp;</div></li><li><div>        'Antarctica', &nbsp;</div></li><li><div>        'Argentina', &nbsp;</div></li><li><div>        'American Samoa', &nbsp;</div></li><li><div>        'Austria', &nbsp;</div></li><li><div>        'Australia', &nbsp;</div></li><li><div>        'Aruba', &nbsp;</div></li><li><div>        'Azerbaijan', &nbsp;</div></li><li><div>        'Bosnia and Herzegovina', &nbsp;</div></li><li><div>        'Barbados', &nbsp;</div></li><li><div>        'Bangladesh', &nbsp;</div></li><li><div>        'Belgium', &nbsp;</div></li><li><div>        'Burkina Faso', &nbsp;</div></li><li><div>        'Bulgaria', &nbsp;</div></li><li><div>        'Bahrain', &nbsp;</div></li><li><div>        'Burundi', &nbsp;</div></li><li><div>        'Benin', &nbsp;</div></li><li><div>        'Bermuda', &nbsp;</div></li><li><div>        'Brunei Darussalam', &nbsp;</div></li><li><div>        'Bolivia', &nbsp;</div></li><li><div>        'Brazil', &nbsp;</div></li><li><div>        'Bahamas', &nbsp;</div></li><li><div>        'Bhutan', &nbsp;</div></li><li><div>        'Bouvet Island', &nbsp;</div></li><li><div>        'Botswana', &nbsp;</div></li><li><div>        'Belarus', &nbsp;</div></li><li><div>        'Belize', &nbsp;</div></li><li><div>        'Canada', &nbsp;</div></li><li><div>        'Cocos (Keeling) Islands', &nbsp;</div></li><li><div>        'Congo, The Democratic Republic of the', &nbsp;</div></li><li><div>        'Central African Republic', &nbsp;</div></li><li><div>        'Congo', &nbsp;</div></li><li><div>        'Switzerland', &nbsp;</div></li><li><div>        &quot;Cote D'Ivoire&quot;, &nbsp;</div></li><li><div>        'Cook Islands', &nbsp;</div></li><li><div>        'Chile', &nbsp;</div></li><li><div>        'Cameroon', &nbsp;</div></li><li><div>        'China', &nbsp;</div></li><li><div>        'Colombia', &nbsp;</div></li><li><div>        'Costa Rica', &nbsp;</div></li><li><div>        'Cuba', &nbsp;</div></li><li><div>        'Cape Verde', &nbsp;</div></li><li><div>        'Christmas Island', &nbsp;</div></li><li><div>        'Cyprus', &nbsp;</div></li><li><div>        'Czech Republic', &nbsp;</div></li><li><div>        'Germany', &nbsp;</div></li><li><div>        'Djibouti', &nbsp;</div></li><li><div>        'Denmark', &nbsp;</div></li><li><div>        'Dominica', &nbsp;</div></li><li><div>        'Dominican Republic', &nbsp;</div></li><li><div>        'Algeria', &nbsp;</div></li><li><div>        'Ecuador', &nbsp;</div></li><li><div>        'Estonia', &nbsp;</div></li><li><div>        'Egypt', &nbsp;</div></li><li><div>        'Western Sahara', &nbsp;</div></li><li><div>        'Eritrea', &nbsp;</div></li><li><div>        'Spain', &nbsp;</div></li><li><div>        'Ethiopia', &nbsp;</div></li><li><div>        'Finland', &nbsp;</div></li><li><div>        'Fiji', &nbsp;</div></li><li><div>        'Falkland Islands (Malvinas)', &nbsp;</div></li><li><div>        'Micronesia, Federated States of', &nbsp;</div></li><li><div>        'Faroe Islands', &nbsp;</div></li><li><div>        'France', &nbsp;</div></li><li><div>        'Sint Maarten (Dutch part)', &nbsp;</div></li><li><div>        'Gabon', &nbsp;</div></li><li><div>        'United Kingdom', &nbsp;</div></li><li><div>        'Grenada', &nbsp;</div></li><li><div>        'Georgia', &nbsp;</div></li><li><div>        'French Guiana', &nbsp;</div></li><li><div>        'Ghana', &nbsp;</div></li><li><div>        'Gibraltar', &nbsp;</div></li><li><div>        'Greenland', &nbsp;</div></li><li><div>        'Gambia', &nbsp;</div></li><li><div>        'Guinea', &nbsp;</div></li><li><div>        'Guadeloupe', &nbsp;</div></li><li><div>        'Equatorial Guinea', &nbsp;</div></li><li><div>        'Greece', &nbsp;</div></li><li><div>        'South Georgia and the South Sandwich Islands', &nbsp;</div></li><li><div>        'Guatemala', &nbsp;</div></li><li><div>        'Guam', &nbsp;</div></li><li><div>        'Guinea-Bissau', &nbsp;</div></li><li><div>        'Guyana', &nbsp;</div></li><li><div>        'Hong Kong', &nbsp;</div></li><li><div>        'Heard Island and McDonald Islands', &nbsp;</div></li><li><div>        'Honduras', &nbsp;</div></li><li><div>        'Croatia', &nbsp;</div></li><li><div>        'Haiti', &nbsp;</div></li><li><div>        'Hungary', &nbsp;</div></li><li><div>        'Indonesia', &nbsp;</div></li><li><div>        'Ireland', &nbsp;</div></li><li><div>        'Israel', &nbsp;</div></li><li><div>        'India', &nbsp;</div></li><li><div>        'British Indian Ocean Territory', &nbsp;</div></li><li><div>        'Iraq', &nbsp;</div></li><li><div>        'Iran, Islamic Republic of', &nbsp;</div></li><li><div>        'Iceland', &nbsp;</div></li><li><div>        'Italy', &nbsp;</div></li><li><div>        'Jamaica', &nbsp;</div></li><li><div>        'Jordan', &nbsp;</div></li><li><div>        'Japan', &nbsp;</div></li><li><div>        'Kenya', &nbsp;</div></li><li><div>        'Kyrgyzstan', &nbsp;</div></li><li><div>        'Cambodia', &nbsp;</div></li><li><div>        'Kiribati', &nbsp;</div></li><li><div>        'Comoros', &nbsp;</div></li><li><div>        'Saint Kitts and Nevis', &nbsp;</div></li><li><div>        &quot;Korea, Democratic People's Republic of&quot;, &nbsp;</div></li><li><div>        'Korea, Republic of', &nbsp;</div></li><li><div>        'Kuwait', &nbsp;</div></li><li><div>        'Cayman Islands', &nbsp;</div></li><li><div>        'Kazakhstan', &nbsp;</div></li><li><div>        &quot;Lao People's Democratic Republic&quot;, &nbsp;</div></li><li><div>        'Lebanon', &nbsp;</div></li><li><div>        'Saint Lucia', &nbsp;</div></li><li><div>        'Liechtenstein', &nbsp;</div></li><li><div>        'Sri Lanka', &nbsp;</div></li><li><div>        'Liberia', &nbsp;</div></li><li><div>        'Lesotho', &nbsp;</div></li><li><div>        'Lithuania', &nbsp;</div></li><li><div>        'Luxembourg', &nbsp;</div></li><li><div>        'Latvia', &nbsp;</div></li><li><div>        'Libya', &nbsp;</div></li><li><div>        'Morocco', &nbsp;</div></li><li><div>        'Monaco', &nbsp;</div></li><li><div>        'Moldova, Republic of', &nbsp;</div></li><li><div>        'Madagascar', &nbsp;</div></li><li><div>        'Marshall Islands', &nbsp;</div></li><li><div>        'Macedonia', &nbsp;</div></li><li><div>        'Mali', &nbsp;</div></li><li><div>        'Myanmar', &nbsp;</div></li><li><div>        'Mongolia', &nbsp;</div></li><li><div>        'Macau', &nbsp;</div></li><li><div>        'Northern Mariana Islands', &nbsp;</div></li><li><div>        'Martinique', &nbsp;</div></li><li><div>        'Mauritania', &nbsp;</div></li><li><div>        'Montserrat', &nbsp;</div></li><li><div>        'Malta', &nbsp;</div></li><li><div>        'Mauritius', &nbsp;</div></li><li><div>        'Maldives', &nbsp;</div></li><li><div>        'Malawi', &nbsp;</div></li><li><div>        'Mexico', &nbsp;</div></li><li><div>        'Malaysia', &nbsp;</div></li><li><div>        'Mozambique', &nbsp;</div></li><li><div>        'Namibia', &nbsp;</div></li><li><div>        'New Caledonia', &nbsp;</div></li><li><div>        'Niger', &nbsp;</div></li><li><div>        'Norfolk Island', &nbsp;</div></li><li><div>        'Nigeria', &nbsp;</div></li><li><div>        'Nicaragua', &nbsp;</div></li><li><div>        'Netherlands', &nbsp;</div></li><li><div>        'Norway', &nbsp;</div></li><li><div>        'Nepal', &nbsp;</div></li><li><div>        'Nauru', &nbsp;</div></li><li><div>        'Niue', &nbsp;</div></li><li><div>        'New Zealand', &nbsp;</div></li><li><div>        'Oman', &nbsp;</div></li><li><div>        'Panama', &nbsp;</div></li><li><div>        'Peru', &nbsp;</div></li><li><div>        'French Polynesia', &nbsp;</div></li><li><div>        'Papua New Guinea', &nbsp;</div></li><li><div>        'Philippines', &nbsp;</div></li><li><div>        'Pakistan', &nbsp;</div></li><li><div>        'Poland', &nbsp;</div></li><li><div>        'Saint Pierre and Miquelon', &nbsp;</div></li><li><div>        'Pitcairn Islands', &nbsp;</div></li><li><div>        'Puerto Rico', &nbsp;</div></li><li><div>        'Palestinian Territory', &nbsp;</div></li><li><div>        'Portugal', &nbsp;</div></li><li><div>        'Palau', &nbsp;</div></li><li><div>        'Paraguay', &nbsp;</div></li><li><div>        'Qatar', &nbsp;</div></li><li><div>        'Reunion', &nbsp;</div></li><li><div>        'Romania', &nbsp;</div></li><li><div>        'Russian Federation', &nbsp;</div></li><li><div>        'Rwanda', &nbsp;</div></li><li><div>        'Saudi Arabia', &nbsp;</div></li><li><div>        'Solomon Islands', &nbsp;</div></li><li><div>        'Seychelles', &nbsp;</div></li><li><div>        'Sudan', &nbsp;</div></li><li><div>        'Sweden', &nbsp;</div></li><li><div>        'Singapore', &nbsp;</div></li><li><div>        'Saint Helena', &nbsp;</div></li><li><div>        'Slovenia', &nbsp;</div></li><li><div>        'Svalbard and Jan Mayen', &nbsp;</div></li><li><div>        'Slovakia', &nbsp;</div></li><li><div>        'Sierra Leone', &nbsp;</div></li><li><div>        'San Marino', &nbsp;</div></li><li><div>        'Senegal', &nbsp;</div></li><li><div>        'Somalia', &nbsp;</div></li><li><div>        'Suriname', &nbsp;</div></li><li><div>        'Sao Tome and Principe', &nbsp;</div></li><li><div>        'El Salvador', &nbsp;</div></li><li><div>        'Syrian Arab Republic', &nbsp;</div></li><li><div>        'Swaziland', &nbsp;</div></li><li><div>        'Turks and Caicos Islands', &nbsp;</div></li><li><div>        'Chad', &nbsp;</div></li><li><div>        'French Southern Territories', &nbsp;</div></li><li><div>        'Togo', &nbsp;</div></li><li><div>        'Thailand', &nbsp;</div></li><li><div>        'Tajikistan', &nbsp;</div></li><li><div>        'Tokelau', &nbsp;</div></li><li><div>        'Turkmenistan', &nbsp;</div></li><li><div>        'Tunisia', &nbsp;</div></li><li><div>        'Tonga', &nbsp;</div></li><li><div>        'Timor-Leste', &nbsp;</div></li><li><div>        'Turkey', &nbsp;</div></li><li><div>        'Trinidad and Tobago', &nbsp;</div></li><li><div>        'Tuvalu', &nbsp;</div></li><li><div>        'Taiwan', &nbsp;</div></li><li><div>        'Tanzania, United Republic of', &nbsp;</div></li><li><div>        'Ukraine', &nbsp;</div></li><li><div>        'Uganda', &nbsp;</div></li><li><div>        'United States Minor Outlying Islands', &nbsp;</div></li><li><div>        'United States', &nbsp;</div></li><li><div>        'Uruguay', &nbsp;</div></li><li><div>        'Uzbekistan', &nbsp;</div></li><li><div>        'Holy See (Vatican City State)', &nbsp;</div></li><li><div>        'Saint Vincent and the Grenadines', &nbsp;</div></li><li><div>        'Venezuela', &nbsp;</div></li><li><div>        'Virgin Islands, British', &nbsp;</div></li><li><div>        'Virgin Islands, U.S.', &nbsp;</div></li><li><div>        'Vietnam', &nbsp;</div></li><li><div>        'Vanuatu', &nbsp;</div></li><li><div>        'Wallis and Futuna', &nbsp;</div></li><li><div>        'Samoa', &nbsp;</div></li><li><div>        'Yemen', &nbsp;</div></li><li><div>        'Mayotte', &nbsp;</div></li><li><div>        'Serbia', &nbsp;</div></li><li><div>        'South Africa', &nbsp;</div></li><li><div>        'Zambia', &nbsp;</div></li><li><div>        'Montenegro', &nbsp;</div></li><li><div>        'Zimbabwe', &nbsp;</div></li><li><div>        'Anonymous Proxy', &nbsp;</div></li><li><div>        'Satellite Provider', &nbsp;</div></li><li><div>        'Other', &nbsp;</div></li><li><div>        'Aland Islands', &nbsp;</div></li><li><div>        'Guernsey', &nbsp;</div></li><li><div>        'Isle of Man', &nbsp;</div></li><li><div>        'Jersey', &nbsp;</div></li><li><div>        'Saint Barthelemy', &nbsp;</div></li><li><div>        'Saint Martin', &nbsp;</div></li><li><div>        'Bonaire, Saint Eustatius and Saba', &nbsp;</div></li><li><div>        'South Sudan', &nbsp;</div></li><li><div>        'Other', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * 2 letters continent codes.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public $GEOIP_CONTINENT_CODES = array(&nbsp;</div></li><li><div>        '--', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AN', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AN', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AN', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AN', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AN', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'SA', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'OC', &nbsp;</div></li><li><div>        'AS', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        '--', &nbsp;</div></li><li><div>        '--', &nbsp;</div></li><li><div>        '--', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'EU', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'NA', &nbsp;</div></li><li><div>        'AF', &nbsp;</div></li><li><div>        '--', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /** @var WC_Logger Logger instance */&nbsp;</div></li><li><div>    public static $log = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Logging method.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param string $message Log message.&nbsp;</div></li><li><div>     * @param string $level   Optional. Default 'info'.&nbsp;</div></li><li><div>     *     emergency|alert|critical|error|warning|notice|info|debug&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function log( $message, $level = 'info' ) {&nbsp;</div></li><li><div>        if ( empty( self::$log ) ) {&nbsp;</div></li><li><div>            self::$log = wc_get_logger();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        self::$log-&gt;log( $level, $message, array( 'source' =&gt; 'geoip' ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Open geoip file.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param string $filename&nbsp;</div></li><li><div>     * @param int    $flags&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function geoip_open( $filename, $flags ) {&nbsp;</div></li><li><div>        $this-&gt;flags = $flags;&nbsp;</div></li><li><div>        if ( $this-&gt;flags & self::GEOIP_SHARED_MEMORY ) {&nbsp;</div></li><li><div>            $this-&gt;shmid = @shmop_open( self::GEOIP_SHM_KEY, 'a', 0, 0 );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            if ( $this-&gt;filehandle = fopen( $filename, 'rb' ) ) {&nbsp;</div></li><li><div>                if ( $this-&gt;flags & self::GEOIP_MEMORY_CACHE ) {&nbsp;</div></li><li><div>                    $s_array = fstat( $this-&gt;filehandle );&nbsp;</div></li><li><div>                    $this-&gt;memory_buffer = fread( $this-&gt;filehandle, $s_array['size'] );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $this-&gt;log( 'GeoIP API: Can not open ' . $filename, 'error' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;_setup_segments();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Setup segments.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return WC_Geo_IP instance&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function _setup_segments() {&nbsp;</div></li><li><div>        $this-&gt;databaseType = self::GEOIP_COUNTRY_EDITION;&nbsp;</div></li><li><div>        $this-&gt;record_length = self::STANDARD_RECORD_LENGTH;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $this-&gt;flags & self::GEOIP_SHARED_MEMORY ) {&nbsp;</div></li><li><div>            $offset = @shmop_size( $this-&gt;shmid ) - 3;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            for ( $i = 0; $i &lt; self::STRUCTURE_INFO_MAX_SIZE; $i++ ) {&nbsp;</div></li><li><div>                $delim = @shmop_read( $this-&gt;shmid, $offset, 3 );&nbsp;</div></li><li><div>                $offset += 3;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( ( chr( 255 ) . chr( 255 ) . chr( 255 ) ) == $delim ) {&nbsp;</div></li><li><div>                    $this-&gt;databaseType = ord( @shmop_read( $this-&gt;shmid, $offset, 1 ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( $this-&gt;databaseType &gt;= 106 ) {&nbsp;</div></li><li><div>                        $this-&gt;databaseType -= 105;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $offset++;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( self::GEOIP_REGION_EDITION_REV0 == $this-&gt;databaseType ) {&nbsp;</div></li><li><div>                        $this-&gt;databaseSegments = self::GEOIP_STATE_BEGIN_REV0;&nbsp;</div></li><li><div>                    } elseif ( self::GEOIP_REGION_EDITION_REV1 == $this-&gt;databaseType ) {&nbsp;</div></li><li><div>                        $this-&gt;databaseSegments = self::GEOIP_STATE_BEGIN_REV1;&nbsp;</div></li><li><div>                    } elseif ( ( self::GEOIP_CITY_EDITION_REV0 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_CITY_EDITION_REV1 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_ORG_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_ORG_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_DOMAIN_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_DOMAIN_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_ISP_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_ISP_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_USERTYPE_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_USERTYPE_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_LOCATIONA_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_ACCURACYRADIUS_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_CITY_EDITION_REV0_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_CITY_EDITION_REV1_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_NETSPEED_EDITION_REV1 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_NETSPEED_EDITION_REV1_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_ASNUM_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_ASNUM_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>                        $this-&gt;databaseSegments = 0;&nbsp;</div></li><li><div>                        $buf = @shmop_read( $this-&gt;shmid, $offset, self::SEGMENT_RECORD_LENGTH );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        for ( $j = 0; $j &lt; self::SEGMENT_RECORD_LENGTH; $j++ ) {&nbsp;</div></li><li><div>                            $this-&gt;databaseSegments += ( ord( $buf[ $j ] ) &lt;&lt; ( $j * 8 ) );&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        if ( ( self::GEOIP_ORG_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                            || ( self::GEOIP_ORG_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                            || ( self::GEOIP_DOMAIN_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                            || ( self::GEOIP_DOMAIN_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                            || ( self::GEOIP_ISP_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                            || ( self::GEOIP_ISP_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>                            $this-&gt;record_length = self::ORG_RECORD_LENGTH;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $offset -= 4;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ( self::GEOIP_COUNTRY_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                || ( self::GEOIP_COUNTRY_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                || ( self::GEOIP_PROXY_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                || ( self::GEOIP_NETSPEED_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>                $this-&gt;databaseSegments = self::GEOIP_COUNTRY_BEGIN;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $filepos = ftell( $this-&gt;filehandle );&nbsp;</div></li><li><div>            fseek( $this-&gt;filehandle, -3, SEEK_END );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            for ( $i = 0; $i &lt; self::STRUCTURE_INFO_MAX_SIZE; $i++ ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $delim = fread( $this-&gt;filehandle, 3 );&nbsp;</div></li><li><div>                if ( ( chr( 255 ) . chr( 255 ) . chr( 255 ) ) == $delim ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $this-&gt;databaseType = ord( fread( $this-&gt;filehandle, 1 ) );&nbsp;</div></li><li><div>                    if ( $this-&gt;databaseType &gt;= 106 ) {&nbsp;</div></li><li><div>                        $this-&gt;databaseType -= 105;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( self::GEOIP_REGION_EDITION_REV0 == $this-&gt;databaseType ) {&nbsp;</div></li><li><div>                        $this-&gt;databaseSegments = self::GEOIP_STATE_BEGIN_REV0;&nbsp;</div></li><li><div>                    } elseif ( self::GEOIP_REGION_EDITION_REV1 == $this-&gt;databaseType ) {&nbsp;</div></li><li><div>                        $this-&gt;databaseSegments = self::GEOIP_STATE_BEGIN_REV1;&nbsp;</div></li><li><div>                    } elseif ( ( self::GEOIP_CITY_EDITION_REV0 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_CITY_EDITION_REV1 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_CITY_EDITION_REV0_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_CITY_EDITION_REV1_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_ORG_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_DOMAIN_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_ISP_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_ORG_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_DOMAIN_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_ISP_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_LOCATIONA_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_ACCURACYRADIUS_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_NETSPEED_EDITION_REV1 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_NETSPEED_EDITION_REV1_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_USERTYPE_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_USERTYPE_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_ASNUM_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                        || ( self::GEOIP_ASNUM_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>                        $this-&gt;databaseSegments = 0;&nbsp;</div></li><li><div>                        $buf = fread( $this-&gt;filehandle, self::SEGMENT_RECORD_LENGTH );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        for ( $j = 0; $j &lt; self::SEGMENT_RECORD_LENGTH; $j++ ) {&nbsp;</div></li><li><div>                            $this-&gt;databaseSegments += ( ord( $buf[ $j ] ) &lt;&lt; ( $j * 8 ) );&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        if ( ( self::GEOIP_ORG_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                            || ( self::GEOIP_DOMAIN_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                            || ( self::GEOIP_ISP_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                            || ( self::GEOIP_ORG_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                            || ( self::GEOIP_DOMAIN_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                            || ( self::GEOIP_ISP_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>                            $this-&gt;record_length = self::ORG_RECORD_LENGTH;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    fseek( $this-&gt;filehandle, -4, SEEK_CUR );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( ( self::GEOIP_COUNTRY_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                || ( self::GEOIP_COUNTRY_EDITION_V6 == $this-&gt;databaseType )&nbsp;</div></li><li><div>                || ( self::GEOIP_PROXY_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div>                || ( self::GEOIP_NETSPEED_EDITION == $this-&gt;databaseType )&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>                $this-&gt;databaseSegments = self::GEOIP_COUNTRY_BEGIN;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            fseek( $this-&gt;filehandle, $filepos, SEEK_SET );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $this;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Close geoip file.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return bool&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function geoip_close() {&nbsp;</div></li><li><div>        if ( $this-&gt;flags & self::GEOIP_SHARED_MEMORY ) {&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return fclose( $this-&gt;filehandle );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Common get record.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param  string $seek_country&nbsp;</div></li><li><div>     * @return WC_Geo_IP_Record instance&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function _common_get_record( $seek_country ) {&nbsp;</div></li><li><div>        // workaround php's broken substr, strpos, etc handling with&nbsp;</div></li><li><div>        // mbstring.func_overload and mbstring.internal_encoding&nbsp;</div></li><li><div>        $mbExists = extension_loaded( 'mbstring' );&nbsp;</div></li><li><div>        if ( $mbExists ) {&nbsp;</div></li><li><div>            $enc = mb_internal_encoding();&nbsp;</div></li><li><div>            mb_internal_encoding( 'ISO-8859-1' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $record_pointer = $seek_country + ( 2 * $this-&gt;record_length - 1 ) * $this-&gt;databaseSegments;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $this-&gt;flags & self::GEOIP_MEMORY_CACHE ) {&nbsp;</div></li><li><div>            $record_buf = substr( $this-&gt;memory_buffer, $record_pointer, FULL_RECORD_LENGTH );&nbsp;</div></li><li><div>        } elseif ( $this-&gt;flags & self::GEOIP_SHARED_MEMORY ) {&nbsp;</div></li><li><div>            $record_buf = @shmop_read( $this-&gt;shmid, $record_pointer, FULL_RECORD_LENGTH );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            fseek( $this-&gt;filehandle, $record_pointer, SEEK_SET );&nbsp;</div></li><li><div>            $record_buf = fread( $this-&gt;filehandle, FULL_RECORD_LENGTH );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $record = new WC_Geo_IP_Record();&nbsp;</div></li><li><div>        $record_buf_pos = 0;&nbsp;</div></li><li><div>        $char = ord( substr( $record_buf, $record_buf_pos, 1 ) );&nbsp;</div></li><li><div>        $record-&gt;country_code = $this-&gt;GEOIP_COUNTRY_CODES[ $char ];&nbsp;</div></li><li><div>        $record-&gt;country_code3 = $this-&gt;GEOIP_COUNTRY_CODES3[ $char ];&nbsp;</div></li><li><div>        $record-&gt;country_name = $this-&gt;GEOIP_COUNTRY_NAMES[ $char ];&nbsp;</div></li><li><div>        $record-&gt;continent_code = $this-&gt;GEOIP_CONTINENT_CODES[ $char ];&nbsp;</div></li><li><div>        $str_length = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $record_buf_pos++;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Get region&nbsp;</div></li><li><div>        $char = ord( substr( $record_buf, $record_buf_pos + $str_length, 1 ) );&nbsp;</div></li><li><div>        while ( 0 != $char ) {&nbsp;</div></li><li><div>            $str_length++;&nbsp;</div></li><li><div>            $char = ord( substr( $record_buf, $record_buf_pos + $str_length, 1 ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $str_length &gt; 0 ) {&nbsp;</div></li><li><div>            $record-&gt;region = substr( $record_buf, $record_buf_pos, $str_length );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $record_buf_pos += $str_length + 1;&nbsp;</div></li><li><div>        $str_length = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Get city&nbsp;</div></li><li><div>        $char = ord( substr( $record_buf, $record_buf_pos + $str_length, 1 ) );&nbsp;</div></li><li><div>        while ( 0 != $char ) {&nbsp;</div></li><li><div>            $str_length++;&nbsp;</div></li><li><div>            $char = ord( substr( $record_buf, $record_buf_pos + $str_length, 1 ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $str_length &gt; 0 ) {&nbsp;</div></li><li><div>            $record-&gt;city = substr( $record_buf, $record_buf_pos, $str_length );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $record_buf_pos += $str_length + 1;&nbsp;</div></li><li><div>        $str_length = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Get postal code&nbsp;</div></li><li><div>        $char = ord( substr( $record_buf, $record_buf_pos + $str_length, 1 ) );&nbsp;</div></li><li><div>        while ( 0 != $char ) {&nbsp;</div></li><li><div>            $str_length++;&nbsp;</div></li><li><div>            $char = ord( substr( $record_buf, $record_buf_pos + $str_length, 1 ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $str_length &gt; 0 ) {&nbsp;</div></li><li><div>            $record-&gt;postal_code = substr( $record_buf, $record_buf_pos, $str_length );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $record_buf_pos += $str_length + 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Get latitude and longitude&nbsp;</div></li><li><div>        $latitude = 0;&nbsp;</div></li><li><div>        $longitude = 0;&nbsp;</div></li><li><div>        for ( $j = 0; $j &lt; 3; ++$j ) {&nbsp;</div></li><li><div>            $char = ord( substr( $record_buf, $record_buf_pos++, 1 ) );&nbsp;</div></li><li><div>            $latitude += ( $char &lt;&lt; ( $j * 8 ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $record-&gt;latitude = ( $latitude / 10000 ) - 180;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        for ( $j = 0; $j &lt; 3; ++$j ) {&nbsp;</div></li><li><div>            $char = ord( substr( $record_buf, $record_buf_pos++, 1 ) );&nbsp;</div></li><li><div>            $longitude += ( $char &lt;&lt; ( $j * 8 ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $record-&gt;longitude = ( $longitude / 10000 ) - 180;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( self::GEOIP_CITY_EDITION_REV1 == $this-&gt;databaseType ) {&nbsp;</div></li><li><div>            $metroarea_combo = 0;&nbsp;</div></li><li><div>            if ( 'US' === $record-&gt;country_code ) {&nbsp;</div></li><li><div>                for ( $j = 0; $j &lt; 3; ++$j ) {&nbsp;</div></li><li><div>                    $char = ord( substr( $record_buf, $record_buf_pos++, 1 ) );&nbsp;</div></li><li><div>                    $metroarea_combo += ( $char &lt;&lt; ( $j * 8 ) );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $record-&gt;metro_code = $record-&gt;dma_code = floor( $metroarea_combo / 1000 );&nbsp;</div></li><li><div>                $record-&gt;area_code = $metroarea_combo % 1000;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $mbExists ) {&nbsp;</div></li><li><div>            mb_internal_encoding( $enc );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $record;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Get record.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param  int $ipnum&nbsp;</div></li><li><div>     * @return WC_Geo_IP_Record instance&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function _get_record( $ipnum ) {&nbsp;</div></li><li><div>        $seek_country = $this-&gt;_geoip_seek_country( $ipnum );&nbsp;</div></li><li><div>        if ( $seek_country == $this-&gt;databaseSegments ) {&nbsp;</div></li><li><div>            return null;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $this-&gt;_common_get_record( $seek_country );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Seek country IPv6.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param  int $ipnum&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function _geoip_seek_country_v6( $ipnum ) {&nbsp;</div></li><li><div>        // arrays from unpack start with offset 1&nbsp;</div></li><li><div>        // yet another php mystery. array_merge work around&nbsp;</div></li><li><div>        // this broken behaviour&nbsp;</div></li><li><div>        $v6vec = array_merge( unpack( 'C16', $ipnum ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $offset = 0;&nbsp;</div></li><li><div>        for ( $depth = 127; $depth &gt;= 0; --$depth ) {&nbsp;</div></li><li><div>            if ( $this-&gt;flags & self::GEOIP_MEMORY_CACHE ) {&nbsp;</div></li><li><div>                $buf = $this-&gt;_safe_substr(&nbsp;</div></li><li><div>                    $this-&gt;memory_buffer, &nbsp;</div></li><li><div>                    2 * $this-&gt;record_length * $offset, &nbsp;</div></li><li><div>                    2 * $this-&gt;record_length&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            } elseif ( $this-&gt;flags & self::GEOIP_SHARED_MEMORY ) {&nbsp;</div></li><li><div>                $buf = @shmop_read(&nbsp;</div></li><li><div>                    $this-&gt;shmid, &nbsp;</div></li><li><div>                    2 * $this-&gt;record_length * $offset, &nbsp;</div></li><li><div>                    2 * $this-&gt;record_length&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                if ( 0 != fseek( $this-&gt;filehandle, 2 * $this-&gt;record_length * $offset, SEEK_SET ) ) {&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $buf = fread( $this-&gt;filehandle, 2 * $this-&gt;record_length );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $x = array( 0, 0 );&nbsp;</div></li><li><div>            for ( $i = 0; $i &lt; 2; ++$i ) {&nbsp;</div></li><li><div>                for ( $j = 0; $j &lt; $this-&gt;record_length; ++$j ) {&nbsp;</div></li><li><div>                    $x[ $i ] += ord( $buf[ $this-&gt;record_length * $i + $j ] ) &lt;&lt; ( $j * 8 );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $bnum = 127 - $depth;&nbsp;</div></li><li><div>            $idx = $bnum &gt;&gt; 3;&nbsp;</div></li><li><div>            $b_mask = 1 &lt;&lt; ( $bnum & 7 ^ 7 );&nbsp;</div></li><li><div>            if ( ( $v6vec[ $idx ] & $b_mask ) &gt; 0 ) {&nbsp;</div></li><li><div>                if ( $x[1] &gt;= $this-&gt;databaseSegments ) {&nbsp;</div></li><li><div>                    return $x[1];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $offset = $x[1];&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                if ( $x[0] &gt;= $this-&gt;databaseSegments ) {&nbsp;</div></li><li><div>                    return $x[0];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $offset = $x[0];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;log( 'GeoIP API: Error traversing database - perhaps it is corrupt?', 'error' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Seek country.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param  int $ipnum&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function _geoip_seek_country( $ipnum ) {&nbsp;</div></li><li><div>        $offset = 0;&nbsp;</div></li><li><div>        for ( $depth = 31; $depth &gt;= 0; --$depth ) {&nbsp;</div></li><li><div>            if ( $this-&gt;flags & self::GEOIP_MEMORY_CACHE ) {&nbsp;</div></li><li><div>                $buf = $this-&gt;_safe_substr(&nbsp;</div></li><li><div>                    $this-&gt;memory_buffer, &nbsp;</div></li><li><div>                    2 * $this-&gt;record_length * $offset, &nbsp;</div></li><li><div>                    2 * $this-&gt;record_length&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            } elseif ( $this-&gt;flags & self::GEOIP_SHARED_MEMORY ) {&nbsp;</div></li><li><div>                $buf = @shmop_read(&nbsp;</div></li><li><div>                    $this-&gt;shmid, &nbsp;</div></li><li><div>                    2 * $this-&gt;record_length * $offset, &nbsp;</div></li><li><div>                    2 * $this-&gt;record_length&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                if ( 0 != fseek( $this-&gt;filehandle, 2 * $this-&gt;record_length * $offset, SEEK_SET ) ) {&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $buf = fread( $this-&gt;filehandle, 2 * $this-&gt;record_length );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $x = array( 0, 0 );&nbsp;</div></li><li><div>            for ( $i = 0; $i &lt; 2; ++$i ) {&nbsp;</div></li><li><div>                for ( $j = 0; $j &lt; $this-&gt;record_length; ++$j ) {&nbsp;</div></li><li><div>                    $x[ $i ] += ord( $buf[ $this-&gt;record_length * $i + $j ] ) &lt;&lt; ( $j * 8 );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( $ipnum & ( 1 &lt;&lt; $depth ) ) {&nbsp;</div></li><li><div>                if ( $x[1] &gt;= $this-&gt;databaseSegments ) {&nbsp;</div></li><li><div>                    return $x[1];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $offset = $x[1];&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                if ( $x[0] &gt;= $this-&gt;databaseSegments ) {&nbsp;</div></li><li><div>                    return $x[0];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $offset = $x[0];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;log( 'GeoIP API: Error traversing database - perhaps it is corrupt?', 'error' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Record by addr.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param  string $addr&nbsp;</div></li><li><div>     * @return int&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function geoip_record_by_addr( $addr ) {&nbsp;</div></li><li><div>        if ( null == $addr ) {&nbsp;</div></li><li><div>            return 0;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $ipnum = ip2long( $addr );&nbsp;</div></li><li><div>        return $this-&gt;_get_record( $ipnum );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Country ID by addr IPv6.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param  string $addr&nbsp;</div></li><li><div>     * @return int|bool&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function geoip_country_id_by_addr_v6( $addr ) {&nbsp;</div></li><li><div>        if ( ! defined( 'AF_INET6' ) ) {&nbsp;</div></li><li><div>            $this-&gt;log( 'GEOIP (geoip_country_id_by_addr_v6): PHP was compiled with --disable-ipv6 option' );&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $ipnum = inet_pton( $addr );&nbsp;</div></li><li><div>        return $this-&gt;_geoip_seek_country_v6( $ipnum ) - self::GEOIP_COUNTRY_BEGIN;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Country ID by addr.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param  string $addr&nbsp;</div></li><li><div>     * @return int&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function geoip_country_id_by_addr( $addr ) {&nbsp;</div></li><li><div>        $ipnum = ip2long( $addr );&nbsp;</div></li><li><div>        return $this-&gt;_geoip_seek_country( $ipnum ) - self::GEOIP_COUNTRY_BEGIN;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Country code by addr IPv6.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param  string $addr&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function geoip_country_code_by_addr_v6( $addr ) {&nbsp;</div></li><li><div>        $country_id = $this-&gt;geoip_country_id_by_addr_v6( $addr );&nbsp;</div></li><li><div>        if ( false !== $country_id && isset( $this-&gt;GEOIP_COUNTRY_CODES[ $country_id ] ) ) {&nbsp;</div></li><li><div>            return $this-&gt;GEOIP_COUNTRY_CODES[ $country_id ];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Country code by addr.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param  string $addr&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function geoip_country_code_by_addr( $addr ) {&nbsp;</div></li><li><div>        if ( self::GEOIP_CITY_EDITION_REV1 == $this-&gt;databaseType ) {&nbsp;</div></li><li><div>            $record = $this-&gt;geoip_record_by_addr( $addr );&nbsp;</div></li><li><div>            if ( false !== $record ) {&nbsp;</div></li><li><div>                return $record-&gt;country_code;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $country_id = $this-&gt;geoip_country_id_by_addr( $addr );&nbsp;</div></li><li><div>            if ( false !== $country_id && isset( $this-&gt;GEOIP_COUNTRY_CODES[ $country_id ] ) ) {&nbsp;</div></li><li><div>                return $this-&gt;GEOIP_COUNTRY_CODES[ $country_id ];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Encode string.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param  string $string&nbsp;</div></li><li><div>     * @param  int    $start&nbsp;</div></li><li><div>     * @param  int    $length&nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function _safe_substr( $string, $start, $length ) {&nbsp;</div></li><li><div>        // workaround php's broken substr, strpos, etc handling with&nbsp;</div></li><li><div>        // mbstring.func_overload and mbstring.internal_encoding&nbsp;</div></li><li><div>        $mb_exists = extension_loaded( 'mbstring' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $mb_exists ) {&nbsp;</div></li><li><div>            $enc = mb_internal_encoding();&nbsp;</div></li><li><div>            mb_internal_encoding( 'ISO-8859-1' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $buf = substr( $string, $start, $length );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $mb_exists ) {&nbsp;</div></li><li><div>            mb_internal_encoding( $enc );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $buf;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 3.0.2</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/woocommerce/3.0.6/classes/wc_geo_ip/" class="active">3.0.6</a></li><li><a href="http://hookr.io/plugins/woocommerce/3.0.5/classes/wc_geo_ip/" class="">3.0.5</a></li><li><a href="http://hookr.io/plugins/woocommerce/3.0.4/classes/wc_geo_ip/" class="">3.0.4</a></li><li><a href="http://hookr.io/plugins/woocommerce/3.0.3/classes/wc_geo_ip/" class="">3.0.3</a></li><li><a href="http://hookr.io/plugins/woocommerce/3.0.2/classes/wc_geo_ip/" class="">3.0.2</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>WC_Geo_IP</li><li><span></span>WooCommerce</li><li><span></span>3.0.6</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2021 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>