<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="3.0.6" data-slug="woocommerce" data-type="file" data-id="40611"><head xmlns="http://www.w3.org/1999/xhtml"><title> includes-class-wc-product-variable | file | Woocommerce | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, woocommerce, 3.0.6" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=de20d0c981420dfa4d79b556c874f1e1' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/includes-class-wc-product-variable/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fincludes-class-wc-product-variable%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fincludes-class-wc-product-variable%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-woocommerce-3.0.6-file-includes-class-wc-product-variable","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="includes-class-wc-product-variable" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to woocommerce." href="http://hookr.io/plugins/woocommerce/" class="plugin"><span property="name">woocommerce</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 3.0.6." href="http://hookr.io/plugins/woocommerce/3.0.6/" class="H_VERSION"><span property="name">3.0.6</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/woocommerce/3.0.6/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">includes-class-wc-product-var&hellip;</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="3119"><a href="http://hookr.io/plugins/woocommerce/3.0.6/all/" title="All">All <span class="count badge">3119</span></a></li><li class="" data-id="new" data-count="3"><a href="http://hookr.io/plugins/woocommerce/3.0.6/new/" title="New">New <span class="count badge">3</span></a></li><li class="" data-id="hooks" data-count="2110"><a href="http://hookr.io/plugins/woocommerce/3.0.6/hooks/" title="Hooks">Hooks <span class="count badge">2110</span></a></li><li class="" data-id="action" data-count="774"><a href="http://hookr.io/plugins/woocommerce/3.0.6/actions/" title="Actions">Actions <span class="count badge">774</span></a></li><li class="" data-id="filter" data-count="1336"><a href="http://hookr.io/plugins/woocommerce/3.0.6/filters/" title="Filters">Filters <span class="count badge">1336</span></a></li><li class="" data-id="class" data-count="365"><a href="http://hookr.io/plugins/woocommerce/3.0.6/classes/" title="Classes">Classes <span class="count badge">365</span></a></li><li class="" data-id="constant" data-count="14"><a href="http://hookr.io/plugins/woocommerce/3.0.6/constants/" title="Constants">Constants <span class="count badge">14</span></a></li><li class="" data-id="function" data-count="626"><a href="http://hookr.io/plugins/woocommerce/3.0.6/functions/" title="Functions">Functions <span class="count badge">626</span></a></li><li class="" data-id="shortcode" data-count="4"><a href="http://hookr.io/plugins/woocommerce/3.0.6/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">4</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/includes/class-wc-product-variable.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div>if ( ! defined( 'ABSPATH' ) ) {&nbsp;</div></li><li><div>  exit;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Variable Product Class.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The WooCommerce product class handles individual product data.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @version        3.0.0</span>&nbsp;</div></li><li><div><span class="comment"> * @package        WooCommerce/Classes/Products</span>&nbsp;</div></li><li><div><span class="comment"> * @category    Class</span>&nbsp;</div></li><li><div><span class="comment"> * @author         WooThemes</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>class WC_Product_Variable extends WC_Product {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Array of children variation IDs. Determined by children.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  protected $children = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Array of visible children variation IDs. Determined by children.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  protected $visible_children = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Array of variation attributes IDs. Determined by children.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  protected $variation_attributes = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get internal type.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_type() {&nbsp;</div></li><li><div>      return 'variable';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">  |--------------------------------------------------------------------------</span>&nbsp;</div></li><li><div><span class="comment">  | Getters</span>&nbsp;</div></li><li><div><span class="comment">  |--------------------------------------------------------------------------</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the add to cart button text.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function add_to_cart_text() {&nbsp;</div></li><li><div>      return apply_filters( 'woocommerce_product_add_to_cart_text', $this-&gt;is_purchasable() ? __( 'Select options', 'woocommerce' ) : __( 'Read more', 'woocommerce' ), $this );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get an array of all sale and regular prices from all variations. This is used for example when displaying the price range at variable product level or seeing if the variable product is on sale.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  bool $include_taxes Should taxes be included in the prices.</span>&nbsp;</div></li><li><div><span class="comment">   * @return array() Array of RAW prices, regular prices, and sale prices with keys set to variation ID.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_variation_prices( $include_taxes = false ) {&nbsp;</div></li><li><div>      $prices = $this-&gt;data_store-&gt;read_price_data( $this, $include_taxes );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $prices as $price_key =&gt; $variation_prices ) {&nbsp;</div></li><li><div>          $prices[ $price_key ] = $this-&gt;sort_variation_prices( $variation_prices );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $prices;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the min or max variation regular price.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $min_or_max    Min or max price.</span>&nbsp;</div></li><li><div><span class="comment">   * @param  boolean $include_taxes Should the price include taxes?</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_variation_regular_price( $min_or_max = 'min', $include_taxes = false ) {&nbsp;</div></li><li><div>      $prices = $this-&gt;get_variation_prices( $include_taxes );&nbsp;</div></li><li><div>      $price = 'min' === $min_or_max ? current( $prices['regular_price'] ) : end( $prices['regular_price'] );&nbsp;</div></li><li><div>      return apply_filters( 'woocommerce_get_variation_regular_price', $price, $this, $min_or_max, $include_taxes );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the min or max variation sale price.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $min_or_max    Min or max price.</span>&nbsp;</div></li><li><div><span class="comment">   * @param  boolean $include_taxes Should the price include taxes?</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_variation_sale_price( $min_or_max = 'min', $include_taxes = false ) {&nbsp;</div></li><li><div>      $prices = $this-&gt;get_variation_prices( $include_taxes );&nbsp;</div></li><li><div>      $price = 'min' === $min_or_max ? current( $prices['sale_price'] ) : end( $prices['sale_price'] );&nbsp;</div></li><li><div>      return apply_filters( 'woocommerce_get_variation_sale_price', $price, $this, $min_or_max, $include_taxes );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the min or max variation (active) price.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $min_or_max    Min or max price.</span>&nbsp;</div></li><li><div><span class="comment">   * @param  boolean $include_taxes Should the price include taxes?</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_variation_price( $min_or_max = 'min', $include_taxes = false ) {&nbsp;</div></li><li><div>      $prices = $this-&gt;get_variation_prices( $include_taxes );&nbsp;</div></li><li><div>      $price = 'min' === $min_or_max ? current( $prices['price'] ) : end( $prices['price'] );&nbsp;</div></li><li><div>      return apply_filters( 'woocommerce_get_variation_price', $price, $this, $min_or_max, $include_taxes );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns the price in html format.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Note: Variable prices do not show suffixes like other product types. This</span>&nbsp;</div></li><li><div><span class="comment">   * is due to some things like tax classes being set at variation level which</span>&nbsp;</div></li><li><div><span class="comment">   * could differ from the parent price. The only way to show accurate prices</span>&nbsp;</div></li><li><div><span class="comment">   * would be to load the variation and get IT's price, which adds extra</span>&nbsp;</div></li><li><div><span class="comment">   * overhead and still has edge cases where the values would be inaccurate.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Additionally, ranges of prices no longer show 'striked out' sale prices</span>&nbsp;</div></li><li><div><span class="comment">   * due to the strings being very long and unclear/confusing. A single range</span>&nbsp;</div></li><li><div><span class="comment">   * is shown instead.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $price (default: '')</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_price_html( $price = '' ) {&nbsp;</div></li><li><div>      $prices = $this-&gt;get_variation_prices( true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $prices['price'] ) ) {&nbsp;</div></li><li><div>          $price = apply_filters( 'woocommerce_variable_empty_price_html', '', $this );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $min_price = current( $prices['price'] );&nbsp;</div></li><li><div>          $max_price = end( $prices['price'] );&nbsp;</div></li><li><div>          $min_reg_price = current( $prices['regular_price'] );&nbsp;</div></li><li><div>          $max_reg_price = end( $prices['regular_price'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $min_price !== $max_price ) {&nbsp;</div></li><li><div>              $price = apply_filters( 'woocommerce_variable_price_html', wc_format_price_range( $min_price, $max_price ) . $this-&gt;get_price_suffix(), $this );&nbsp;</div></li><li><div>          } elseif ( $this-&gt;is_on_sale() && $min_reg_price === $max_reg_price ) {&nbsp;</div></li><li><div>              $price = apply_filters( 'woocommerce_variable_price_html', wc_format_sale_price( wc_price( $max_reg_price ), wc_price( $min_price ) ) . $this-&gt;get_price_suffix(), $this );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $price = apply_filters( 'woocommerce_variable_price_html', wc_price( $min_price ) . $this-&gt;get_price_suffix(), $this );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'woocommerce_get_price_html', $price, $this );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the suffix to display after prices &gt; 0.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * This is skipped if the suffix</span>&nbsp;</div></li><li><div><span class="comment">   * has dynamic values such as {price_excluding_tax} for variable products.</span>&nbsp;</div></li><li><div><span class="comment">   * @see get_price_html for an explanation as to why.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $price to calculate, left blank to just use get_price()</span>&nbsp;</div></li><li><div><span class="comment">   * @param  integer $qty   passed on to get_price_including_tax() or get_price_excluding_tax()</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_price_suffix( $price = '', $qty = 1 ) {&nbsp;</div></li><li><div>      $suffix = get_option( 'woocommerce_price_display_suffix' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( strstr( $suffix, '{' ) ) {&nbsp;</div></li><li><div>          return apply_filters( 'woocommerce_get_price_suffix', '', $this, $price, $qty );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          return parent::get_price_suffix( $price, $qty );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return a products child ids.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array Children ids</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_children( $visible_only = '' ) {&nbsp;</div></li><li><div>      if ( is_bool( $visible_only ) ) {&nbsp;</div></li><li><div>          wc_deprecated_argument( 'visible_only', '3.0', 'WC_Product_Variable::get_visible_children' );&nbsp;</div></li><li><div>          return $visible_only ? $this-&gt;get_visible_children() : $this-&gt;get_children();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return apply_filters( 'woocommerce_get_children', $this-&gt;children, $this, false );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return a products child ids - visible only.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @return array Children ids</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_visible_children() {&nbsp;</div></li><li><div>      return apply_filters( 'woocommerce_get_children', $this-&gt;visible_children, $this, true );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return an array of attributes used for variations, as well as their possible values.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array Attributes and their available values</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_variation_attributes() {&nbsp;</div></li><li><div>      return $this-&gt;variation_attributes;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * If set, get the default attributes for a variable product.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $attribute_name</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_variation_default_attribute( $attribute_name ) {&nbsp;</div></li><li><div>      $defaults = $this-&gt;get_default_attributes();&nbsp;</div></li><li><div>      $attribute_name = sanitize_title( $attribute_name );&nbsp;</div></li><li><div>      return isset( $defaults[ $attribute_name ] ) ? $defaults[ $attribute_name ] : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Variable products themselves cannot be downloadable.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_downloadable( $context = 'view' ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Variable products themselves cannot be virtual.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_virtual( $context = 'view' ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get an array of available variations for the current product.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_available_variations() {&nbsp;</div></li><li><div>      $available_variations = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $this-&gt;get_children() as $child_id ) {&nbsp;</div></li><li><div>          $variation = wc_get_product( $child_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Hide out of stock variations if 'Hide out of stock items from the catalog' is checked</span>&nbsp;</div></li><li><div>          if ( ! $variation || ! $variation-&gt;exists() || ( 'yes' === get_option( 'woocommerce_hide_out_of_stock_items' ) && ! $variation-&gt;is_in_stock() ) ) {&nbsp;</div></li><li><div>              continue;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Filter 'woocommerce_hide_invisible_variations' to optionally hide invisible variations (disabled variations and variations with empty price)</span>&nbsp;</div></li><li><div>          if ( apply_filters( 'woocommerce_hide_invisible_variations', false, $this-&gt;get_id(), $variation ) && ! $variation-&gt;variation_is_visible() ) {&nbsp;</div></li><li><div>              continue;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $available_variations[] = $this-&gt;get_available_variation( $variation );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $available_variations;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns an array of data for a variation. Used in the add to cart form.</span>&nbsp;</div></li><li><div><span class="comment">   * @since  2.4.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param  WC_Product $variation Variation product object or ID</span>&nbsp;</div></li><li><div><span class="comment">   * @return array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_available_variation( $variation ) {&nbsp;</div></li><li><div>      if ( is_numeric( $variation ) ) {&nbsp;</div></li><li><div>          $variation = wc_get_product( $variation );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// See if prices should be shown for each variation after selection.</span>&nbsp;</div></li><li><div>      $show_variation_price = apply_filters( 'woocommerce_show_variation_price', $variation-&gt;get_price() === &quot;&quot; || $this-&gt;get_variation_sale_price( 'min' ) !== $this-&gt;get_variation_sale_price( 'max' ) || $this-&gt;get_variation_regular_price( 'min' ) !== $this-&gt;get_variation_regular_price( 'max' ), $this, $variation );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'woocommerce_available_variation', array_merge( $variation-&gt;get_data(), array(&nbsp;</div></li><li><div>          'attributes' =&gt; $variation-&gt;get_variation_attributes(), &nbsp;</div></li><li><div>          'image' =&gt; wc_get_product_attachment_props( $variation-&gt;get_image_id() ), &nbsp;</div></li><li><div>          'weight_html' =&gt; wc_format_weight( $variation-&gt;get_weight() ), &nbsp;</div></li><li><div>          'dimensions_html' =&gt; wc_format_dimensions( $variation-&gt;get_dimensions( false ) ), &nbsp;</div></li><li><div>          'price_html' =&gt; $show_variation_price ? '&lt;span class=&quot;price&quot;&gt;' . $variation-&gt;get_price_html() . '&lt;/span&gt;' : '', &nbsp;</div></li><li><div>          'availability_html' =&gt; wc_get_stock_html( $variation ), &nbsp;</div></li><li><div>          'variation_id' =&gt; $variation-&gt;get_id(), &nbsp;</div></li><li><div>          'variation_is_visible' =&gt; $variation-&gt;variation_is_visible(), &nbsp;</div></li><li><div>          'variation_is_active' =&gt; $variation-&gt;variation_is_active(), &nbsp;</div></li><li><div>          'is_purchasable' =&gt; $variation-&gt;is_purchasable(), &nbsp;</div></li><li><div>          'display_price' =&gt; wc_get_price_to_display( $variation ), &nbsp;</div></li><li><div>          'display_regular_price' =&gt; wc_get_price_to_display( $variation, array( 'price' =&gt; $variation-&gt;get_regular_price() ) ), &nbsp;</div></li><li><div>          'dimensions' =&gt; wc_format_dimensions( $variation-&gt;get_dimensions( false ) ), &nbsp;</div></li><li><div>          'min_qty' =&gt; $variation-&gt;get_min_purchase_quantity(), &nbsp;</div></li><li><div>          'max_qty' =&gt; 0 &lt; $variation-&gt;get_max_purchase_quantity() ? $variation-&gt;get_max_purchase_quantity() : '', &nbsp;</div></li><li><div>          'backorders_allowed' =&gt; $variation-&gt;backorders_allowed(), &nbsp;</div></li><li><div>          'is_in_stock' =&gt; $variation-&gt;is_in_stock(), &nbsp;</div></li><li><div>          'is_downloadable' =&gt; $variation-&gt;is_downloadable(), &nbsp;</div></li><li><div>          'is_virtual' =&gt; $variation-&gt;is_virtual(), &nbsp;</div></li><li><div>          'is_sold_individually' =&gt; $variation-&gt;is_sold_individually() ? 'yes' : 'no', &nbsp;</div></li><li><div>          'variation_description' =&gt; wc_format_content( $variation-&gt;get_description() ), &nbsp;</div></li><li><div> ) ), $this, $variation );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">  |--------------------------------------------------------------------------</span>&nbsp;</div></li><li><div><span class="comment">  | Setters</span>&nbsp;</div></li><li><div><span class="comment">  |--------------------------------------------------------------------------</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Sets an array of variation attributes.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function set_variation_attributes( $variation_attributes ) {&nbsp;</div></li><li><div>      $this-&gt;variation_attributes = $variation_attributes;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Sets an array of children for the product.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function set_children( $children ) {&nbsp;</div></li><li><div>      $this-&gt;children = array_filter( wp_parse_id_list( (array) $children ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Sets an array of visible children only.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @param array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function set_visible_children( $visible_children ) {&nbsp;</div></li><li><div>      $this-&gt;visible_children = array_filter( wp_parse_id_list( (array) $visible_children ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">  |--------------------------------------------------------------------------</span>&nbsp;</div></li><li><div><span class="comment">  | CRUD methods</span>&nbsp;</div></li><li><div><span class="comment">  |--------------------------------------------------------------------------</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Ensure properties are set correctly before save.</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function validate_props() {&nbsp;</div></li><li><div>      <span class="comment">// Before updating, ensure stock props are all aligned. Qty and backorders are not needed if not stock managed.</span>&nbsp;</div></li><li><div>      if ( ! $this-&gt;get_manage_stock() ) {&nbsp;</div></li><li><div>          $this-&gt;set_stock_quantity( '' );&nbsp;</div></li><li><div>          $this-&gt;set_backorders( 'no' );&nbsp;</div></li><li><div>          $this-&gt;set_stock_status( $this-&gt;child_is_in_stock() ? 'instock' : 'outofstock' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If we are stock managing and we don't have stock, force out of stock status.</span>&nbsp;</div></li><li><div>      } elseif ( $this-&gt;get_stock_quantity() &lt;= get_option( 'woocommerce_notify_no_stock_amount' ) ) {&nbsp;</div></li><li><div>          $this-&gt;set_stock_status( 'outofstock' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If the stock level is changing and we do now have enough, force in stock status.</span>&nbsp;</div></li><li><div>      } elseif ( $this-&gt;get_stock_quantity() &gt; get_option( 'woocommerce_notify_no_stock_amount' ) && array_key_exists( 'stock_quantity', $this-&gt;get_changes() ) ) {&nbsp;</div></li><li><div>          $this-&gt;set_stock_status( 'instock' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Otherwise revert to status the children have.</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $this-&gt;set_stock_status( $this-&gt;child_is_in_stock() ? 'instock' : 'outofstock' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Save data (either create or update depending on if we are working on an existing product).</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function save() {&nbsp;</div></li><li><div>      $this-&gt;validate_props();&nbsp;</div></li><li><div>      if ( $this-&gt;data_store ) {&nbsp;</div></li><li><div>          <span class="comment">// Trigger action before saving to the DB. Allows you to adjust object props before save.</span>&nbsp;</div></li><li><div>          do_action( 'woocommerce_before_' . $this-&gt;object_type . '_object_save', $this, $this-&gt;data_store );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Get names before save.</span>&nbsp;</div></li><li><div>          $previous_name = $this-&gt;data['name'];&nbsp;</div></li><li><div>          $new_name = $this-&gt;get_name( 'edit' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;get_id() ) {&nbsp;</div></li><li><div>              $this-&gt;data_store-&gt;update( $this );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $this-&gt;data_store-&gt;create( $this );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;data_store-&gt;sync_variation_names( $this, $previous_name, $new_name );&nbsp;</div></li><li><div>          $this-&gt;data_store-&gt;sync_managed_variation_stock_status( $this );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $this-&gt;get_id();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">  |--------------------------------------------------------------------------</span>&nbsp;</div></li><li><div><span class="comment">  | Conditionals</span>&nbsp;</div></li><li><div><span class="comment">  |--------------------------------------------------------------------------</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns whether or not the product is on sale.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $context What the value is for. Valid values are view and edit.</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function is_on_sale( $context = 'view' ) {&nbsp;</div></li><li><div>      $prices = $this-&gt;get_variation_prices();&nbsp;</div></li><li><div>      $on_sale = $prices['regular_price'] !== $prices['sale_price'] && $prices['sale_price'] === $prices['price'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return 'view' === $context ? apply_filters( 'woocommerce_product_is_on_sale', $on_sale, $this ) : $on_sale;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Is a child in stock?</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function child_is_in_stock() {&nbsp;</div></li><li><div>      return $this-&gt;data_store-&gt;child_is_in_stock( $this );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Does a child have a weight set?</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function child_has_weight() {&nbsp;</div></li><li><div>      $transient_name = 'wc_child_has_weight_' . $this-&gt;get_id();&nbsp;</div></li><li><div>      $has_weight = get_transient( $transient_name );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( false === $has_weight ) {&nbsp;</div></li><li><div>          $has_weight = $this-&gt;data_store-&gt;child_has_weight( $this );&nbsp;</div></li><li><div>          set_transient( $transient_name, $has_weight, DAY_IN_SECONDS * 30 );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return (bool) $has_weight;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Does a child have dimensions set?</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function child_has_dimensions() {&nbsp;</div></li><li><div>      $transient_name = 'wc_child_has_dimensions_' . $this-&gt;get_id();&nbsp;</div></li><li><div>      $has_dimension = get_transient( $transient_name );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( false === $has_dimension ) {&nbsp;</div></li><li><div>          $has_dimension = $this-&gt;data_store-&gt;child_has_dimensions( $this );&nbsp;</div></li><li><div>          set_transient( $transient_name, $has_dimension, DAY_IN_SECONDS * 30 );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return (bool) $has_dimension;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns whether or not the product has dimensions set.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function has_dimensions() {&nbsp;</div></li><li><div>      return parent::has_dimensions() || $this-&gt;child_has_dimensions();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns whether or not the product has weight set.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function has_weight() {&nbsp;</div></li><li><div>      return parent::has_weight() || $this-&gt;child_has_weight();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns whether or not the product has additonal options that need</span>&nbsp;</div></li><li><div><span class="comment">   * selecting before adding to cart.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  3.0.0</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function has_options() {&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">  |--------------------------------------------------------------------------</span>&nbsp;</div></li><li><div><span class="comment">  | Sync with child variations.</span>&nbsp;</div></li><li><div><span class="comment">  |--------------------------------------------------------------------------</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Sync a variable product with it's children. These sync functions sync</span>&nbsp;</div></li><li><div><span class="comment">   * upwards (from child to parent) when the variation is saved.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param WC_Product|int $product Product object or ID for which you wish to sync.</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $save If true, the prouduct object will be saved to the DB before returning it.</span>&nbsp;</div></li><li><div><span class="comment">   * @return WC_Product Synced product object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public static function sync( $product, $save = true ) {&nbsp;</div></li><li><div>      if ( ! is_a( $product, 'WC_Product' ) ) {&nbsp;</div></li><li><div>          $product = wc_get_product( $product );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if ( is_a( $product, 'WC_Product_Variable' ) ) {&nbsp;</div></li><li><div>          $data_store = WC_Data_Store::load( 'product-' . $product-&gt;get_type() );&nbsp;</div></li><li><div>          $data_store-&gt;sync_price( $product );&nbsp;</div></li><li><div>          $data_store-&gt;sync_stock_status( $product );&nbsp;</div></li><li><div>          self::sync_attributes( $product ); <span class="comment">// Legacy update of attributes.</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          do_action( 'woocommerce_variable_product_sync_data', $product );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $save ) {&nbsp;</div></li><li><div>              $product-&gt;save();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          wc_do_deprecated_action( 'woocommerce_variable_product_sync', array( $product-&gt;get_id(), $product-&gt;get_visible_children() ), '3.0', 'woocommerce_variable_product_sync_data, woocommerce_new_product or woocommerce_update_product' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return $product;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Sync parent stock status with the status of all children and save.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param WC_Product|int $product Product object or ID for which you wish to sync.</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $save If true, the prouduct object will be saved to the DB before returning it.</span>&nbsp;</div></li><li><div><span class="comment">   * @return WC_Product Synced product object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public static function sync_stock_status( $product, $save = true ) {&nbsp;</div></li><li><div>      if ( ! is_a( $product, 'WC_Product' ) ) {&nbsp;</div></li><li><div>          $product = wc_get_product( $product );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if ( is_a( $product, 'WC_Product_Variable' ) ) {&nbsp;</div></li><li><div>          $data_store = WC_Data_Store::load( 'product-' . $product-&gt;get_type() );&nbsp;</div></li><li><div>          $data_store-&gt;sync_stock_status( $product );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $save ) {&nbsp;</div></li><li><div>              $product-&gt;save();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return $product;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Sort an associativate array of $variation_id =&gt; $price pairs in order of min and max prices.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $prices Associativate array of $variation_id =&gt; $price pairs</span>&nbsp;</div></li><li><div><span class="comment">   * @return array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  protected function sort_variation_prices( $prices ) {&nbsp;</div></li><li><div>      asort( $prices );&nbsp;</div></li><li><div>      return $prices;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>WooCommerce</li><li><span></span>3.0.6</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>