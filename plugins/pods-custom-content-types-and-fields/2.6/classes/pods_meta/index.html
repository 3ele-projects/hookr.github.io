<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="2.6" data-slug="pods-custom-content-types-and-fields" data-type="class" data-id="59596"><head xmlns="http://www.w3.org/1999/xhtml"><title> podsmeta | class | Pods Custom Content Types And Fields | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="PodsMeta, class, plugin, pods-custom-content-types-and-fields, 2.6" /><meta name="description" content="The Pods - Custom Content Types and Fields PodsMeta class." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=033ea60b4870ce34736ffb6bcf5a9f76' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/pods_meta/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fpods_meta%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fpods_meta%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-pods-custom-content-types-and-fields-2.6-class-pods_meta","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="pods_meta" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to pods-custom-content-types-and&hellip;." href="http://hookr.io/plugins/pods-custom-content-types-and-fields/" class="plugin"><span property="name">pods-custom-content-types-and&hellip;</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.6." href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/" class="H_VERSION"><span property="name">2.6</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">pods_meta</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="726"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/all/" title="All">All <span class="count badge">726</span></a></li><li class="" data-id="new" data-count="5"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/new/" title="New">New <span class="count badge">5</span></a></li><li class="" data-id="hooks" data-count="474"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/hooks/" title="Hooks">Hooks <span class="count badge">474</span></a></li><li class="" data-id="action" data-count="109"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/actions/" title="Actions">Actions <span class="count badge">109</span></a></li><li class="" data-id="filter" data-count="365"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/filters/" title="Filters">Filters <span class="count badge">365</span></a></li><li class="active" data-id="class" data-count="70"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/classes/" title="Classes">Classes <span class="count badge">70</span></a></li><li class="" data-id="constant" data-count="18"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/constants/" title="Constants">Constants <span class="count badge">18</span></a></li><li class="" data-id="function" data-count="156"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/functions/" title="Functions">Functions <span class="count badge">156</span></a></li><li class="" data-id="shortcode" data-count="8"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">8</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>PodsMeta</strong></h1><p>The Pods - Custom Content Types and Fields <strong>PodsMeta</strong> class.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/files/classes-podsmeta/" class="file">/classes/PodsMeta.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="5" class="block" start="5"><li><div>class PodsMeta {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var PodsMeta&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    static $instance = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var PodsAPI&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private $api;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var Pods&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private static $current_pod;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private static $current_pod_data;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var Pods&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private static $current_field_pod;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var int&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static $object_identifier = -1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static $advanced_content_types = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static $post_types = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static $taxonomies = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static $media = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static $user = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static $comment = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static $settings = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static $queue = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static $groups = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @var string&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static $old_post_status = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Singleton handling for a basic pods_meta() request&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return \PodsMeta&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 2.3.5&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function init () {&nbsp;</div></li><li><div>        if ( !is_object( self::$instance ) )&nbsp;</div></li><li><div>            self::$instance = new PodsMeta();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return self::$instance;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return \PodsMeta&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 2.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function __construct () {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return \PodsMeta&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function core () {&nbsp;</div></li><li><div>        self::$advanced_content_types = pods_api()-&gt;load_pods( array( 'type' =&gt; 'pod' ) );&nbsp;</div></li><li><div>        self::$post_types = pods_api()-&gt;load_pods( array( 'type' =&gt; 'post_type' ) );&nbsp;</div></li><li><div>        self::$taxonomies = pods_api()-&gt;load_pods( array( 'type' =&gt; 'taxonomy' ) );&nbsp;</div></li><li><div>        self::$media = pods_api()-&gt;load_pods( array( 'type' =&gt; 'media' ) );&nbsp;</div></li><li><div>        self::$user = pods_api()-&gt;load_pods( array( 'type' =&gt; 'user' ) );&nbsp;</div></li><li><div>        self::$comment = pods_api()-&gt;load_pods( array( 'type' =&gt; 'comment' ) );&nbsp;</div></li><li><div>        self::$settings = pods_api()-&gt;load_pods( array( 'type' =&gt; 'settings' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Handle Post Type Editor (needed for Pods core)&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Loop through and add meta boxes for individual types (can't use this, Tabify doesn't pick it up)&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>        foreach ( self::$post_types as $post_type ) {&nbsp;</div></li><li><div>            $post_type_name = $post_type[ 'name' ];&nbsp;</div></li><li><div>&nbsp;&nbsp;</div></li><li><div>            if ( !empty( $post_type[ 'object' ] ) )&nbsp;</div></li><li><div>                $post_type_name = $post_type[ 'object' ];&nbsp;</div></li><li><div>&nbsp;&nbsp;</div></li><li><div>            add_action( 'add_meta_boxes_' . $post_type_name, array( $this, 'meta_post_add' ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_action( 'add_meta_boxes', array( $this, 'meta_post_add' ) );&nbsp;</div></li><li><div>        add_action( 'transition_post_status', array( $this, 'save_post_detect_new' ), 10, 3 );&nbsp;</div></li><li><div>        add_action( 'save_post', array( $this, 'save_post' ), 10, 3 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( apply_filters( 'pods_meta_handler', true, 'post' ) ) {&nbsp;</div></li><li><div>            // Handle *_post_meta&nbsp;</div></li><li><div>            if ( apply_filters( 'pods_meta_handler_get', true, 'post' ) ) {&nbsp;</div></li><li><div>                add_filter( 'get_post_metadata', array( $this, 'get_post_meta' ), 10, 4 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( !pods_tableless() ) {&nbsp;</div></li><li><div>                add_filter( 'add_post_metadata', array( $this, 'add_post_meta' ), 10, 5 );&nbsp;</div></li><li><div>                add_filter( 'update_post_metadata', array( $this, 'update_post_meta' ), 10, 5 );&nbsp;</div></li><li><div>                add_filter( 'delete_post_metadata', array( $this, 'delete_post_meta' ), 10, 5 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_action( 'delete_post', array( $this, 'delete_post' ), 10, 1 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !empty( self::$taxonomies ) ) {&nbsp;</div></li><li><div>            $has_fields = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Handle Taxonomy Editor&nbsp;</div></li><li><div>            foreach ( self::$taxonomies as $taxonomy ) {&nbsp;</div></li><li><div>                if ( empty( $taxonomy[ 'fields' ] ) ) {&nbsp;</div></li><li><div>                    continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $has_fields = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $taxonomy_name = $taxonomy[ 'name' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( !empty( $taxonomy[ 'object' ] ) )&nbsp;</div></li><li><div>                    $taxonomy_name = $taxonomy[ 'object' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                add_action( $taxonomy_name . '_edit_form_fields', array( $this, 'meta_taxonomy' ), 10, 2 );&nbsp;</div></li><li><div>                add_action( $taxonomy_name . '_add_form_fields', array( $this, 'meta_taxonomy' ), 10, 1 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $has_fields ) {&nbsp;</div></li><li><div>                // Handle Term Editor&nbsp;</div></li><li><div>                add_action( 'edited_term', array( $this, 'save_taxonomy' ), 10, 3 );&nbsp;</div></li><li><div>                add_action( 'create_term', array( $this, 'save_taxonomy' ), 10, 3 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( apply_filters( 'pods_meta_handler', true, 'term' ) ) {&nbsp;</div></li><li><div>                    // Handle *_term_meta&nbsp;</div></li><li><div>                    if ( apply_filters( 'pods_meta_handler_get', true, 'term' ) ) {&nbsp;</div></li><li><div>                        add_filter( 'get_term_metadata', array( $this, 'get_term_meta' ), 10, 4 );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( !pods_tableless() ) {&nbsp;</div></li><li><div>                        add_filter( 'add_term_metadata', array( $this, 'add_term_meta' ), 10, 5 );&nbsp;</div></li><li><div>                        add_filter( 'update_term_metadata', array( $this, 'update_term_meta' ), 10, 5 );&nbsp;</div></li><li><div>                        add_filter( 'delete_term_metadata', array( $this, 'delete_term_meta' ), 10, 5 );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * Fires after a previously shared taxonomy term is split into two separate terms.&nbsp;</div></li><li><div>         *&nbsp;</div></li><li><div>         * @since 4.2.0&nbsp;</div></li><li><div>         *&nbsp;</div></li><li><div>         * @param int    $term_id          ID of the formerly shared term.&nbsp;</div></li><li><div>         * @param int    $new_term_id      ID of the new term created for the $term_taxonomy_id.&nbsp;</div></li><li><div>         * @param int    $term_taxonomy_id ID for the term_taxonomy row affected by the split.&nbsp;</div></li><li><div>         * @param string $taxonomy         Taxonomy for the split term.&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        add_action( 'split_shared_term', array( $this, 'split_shared_term' ), 10, 4 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Handle Delete&nbsp;</div></li><li><div>        add_action( 'delete_term_taxonomy', array( $this, 'delete_taxonomy' ), 10, 1 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !empty( self::$media ) ) {&nbsp;</div></li><li><div>            if ( pods_version_check( 'wp', '3.5' ) ) {&nbsp;</div></li><li><div>                add_action( 'add_meta_boxes', array( $this, 'meta_post_add' ) );&nbsp;</div></li><li><div>                add_action( 'wp_ajax_save-attachment-compat', array( $this, 'save_media_ajax' ), 0 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            add_filter( 'attachment_fields_to_edit', array( $this, 'meta_media' ), 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            add_filter( 'attachment_fields_to_save', array( $this, 'save_media' ), 10, 2 );&nbsp;</div></li><li><div>            add_filter( 'wp_update_attachment_metadata', array( $this, 'save_media' ), 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( apply_filters( 'pods_meta_handler', true, 'post' ) ) {&nbsp;</div></li><li><div>                // Handle *_post_meta&nbsp;</div></li><li><div>                if ( !has_filter( 'get_post_metadata', array( $this, 'get_post_meta' ) ) ) {&nbsp;</div></li><li><div>                    if ( apply_filters( 'pods_meta_handler_get', true, 'post' ) ) {&nbsp;</div></li><li><div>                        add_filter( 'get_post_metadata', array( $this, 'get_post_meta' ), 10, 4 );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( !pods_tableless() ) {&nbsp;</div></li><li><div>                        add_filter( 'add_post_metadata', array( $this, 'add_post_meta' ), 10, 5 );&nbsp;</div></li><li><div>                        add_filter( 'update_post_metadata', array( $this, 'update_post_meta' ), 10, 5 );&nbsp;</div></li><li><div>                        add_filter( 'delete_post_metadata', array( $this, 'delete_post_meta' ), 10, 5 );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Handle Delete&nbsp;</div></li><li><div>        add_action( 'delete_attachment', array( $this, 'delete_media' ), 10, 1 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !empty( self::$user ) ) {&nbsp;</div></li><li><div>            // Handle User Editor&nbsp;</div></li><li><div>            add_action( 'show_user_profile', array( $this, 'meta_user' ) );&nbsp;</div></li><li><div>            add_action( 'edit_user_profile', array( $this, 'meta_user' ) );&nbsp;</div></li><li><div>            //add_action( 'user_register', array( $this, 'save_user' ) );&nbsp;</div></li><li><div>            add_action( 'profile_update', array( $this, 'save_user' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( apply_filters( 'pods_meta_handler', true, 'user' ) ) {&nbsp;</div></li><li><div>                // Handle *_user_meta&nbsp;</div></li><li><div>                if ( apply_filters( 'pods_meta_handler_get', true, 'user' ) ) {&nbsp;</div></li><li><div>                    add_filter( 'get_user_metadata', array( $this, 'get_user_meta' ), 10, 4 );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( !pods_tableless() ) {&nbsp;</div></li><li><div>                    add_filter( 'add_user_metadata', array( $this, 'add_user_meta' ), 10, 5 );&nbsp;</div></li><li><div>                    add_filter( 'update_user_metadata', array( $this, 'update_user_meta' ), 10, 5 );&nbsp;</div></li><li><div>                    add_filter( 'delete_user_metadata', array( $this, 'delete_user_meta' ), 10, 5 );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Handle Delete&nbsp;</div></li><li><div>        add_action( 'delete_user', array( $this, 'delete_user' ), 10, 1 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !empty( self::$comment ) ) {&nbsp;</div></li><li><div>            // Handle Comment Form / Editor&nbsp;</div></li><li><div>            add_action( 'comment_form_logged_in_after', array( $this, 'meta_comment_new_logged_in' ), 10, 2 );&nbsp;</div></li><li><div>            add_filter( 'comment_form_default_fields', array( $this, 'meta_comment_new' ) );&nbsp;</div></li><li><div>            add_action( 'add_meta_boxes_comment', array( $this, 'meta_comment_add' ) );&nbsp;</div></li><li><div>            add_filter( 'pre_comment_approved', array( $this, 'validate_comment' ), 10, 2 );&nbsp;</div></li><li><div>            add_action( 'comment_post', array( $this, 'save_comment' ) );&nbsp;</div></li><li><div>            add_action( 'edit_comment', array( $this, 'save_comment' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( apply_filters( 'pods_meta_handler', true, 'comment' ) ) {&nbsp;</div></li><li><div>                // Handle *_comment_meta&nbsp;</div></li><li><div>                add_filter( 'get_comment_metadata', array( $this, 'get_comment_meta' ), 10, 4 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( !pods_tableless() ) {&nbsp;</div></li><li><div>                    add_filter( 'add_comment_metadata', array( $this, 'add_comment_meta' ), 10, 5 );&nbsp;</div></li><li><div>                    add_filter( 'update_comment_metadata', array( $this, 'update_comment_meta' ), 10, 5 );&nbsp;</div></li><li><div>                    add_filter( 'delete_comment_metadata', array( $this, 'delete_comment_meta' ), 10, 5 );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Handle Delete&nbsp;</div></li><li><div>        add_action( 'delete_comment', array( $this, 'delete_comment' ), 10, 1 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // @todo Patch core to provide $option back in filters, patch core to add filter pre_add_option to add_option&nbsp;</div></li><li><div>        /**if ( !empty( self::$settings ) ) {&nbsp;</div></li><li><div>            foreach ( self::$settings as $setting_pod ) {&nbsp;</div></li><li><div>                foreach ( $setting_pod[ 'fields' ] as $option ) {&nbsp;</div></li><li><div>                    add_filter( 'pre_option_' . $setting_pod[ 'name' ] . '_' . $option[ 'name' ], array( $this, 'get_option' ), 10, 1 );&nbsp;</div></li><li><div>                    add_action( 'add_option_' . $setting_pod[ 'name' ] . '_' . $option[ 'name' ], array( $this, 'add_option' ), 10, 2 );&nbsp;</div></li><li><div>                    add_filter( 'pre_update_option_' . $setting_pod[ 'name' ] . '_' . $option[ 'name' ], array( $this, 'update_option' ), 10, 2 );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }*/&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_admin() )&nbsp;</div></li><li><div>            $this-&gt;integrations();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_action( 'init', array( $this, 'enqueue' ), 9 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( function_exists( 'pll_current_language' ) )&nbsp;</div></li><li><div>            add_action( 'init', array( $this, 'cache_pods' ), 101 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_init' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $this;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function enqueue () {&nbsp;</div></li><li><div>        foreach ( self::$queue as $type =&gt; $objects ) {&nbsp;</div></li><li><div>            foreach ( $objects as $pod_name =&gt; $pod ) {&nbsp;</div></li><li><div>                pods_transient_set( 'pods_pod_' . $pod_name, $pod );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            self::$$type = array_merge( self::$$type, $objects );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Go back through and cache the Pods now that Polylang has loaded&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function cache_pods () {&nbsp;</div></li><li><div>        self::$advanced_content_types = pods_api()-&gt;load_pods( array( 'type' =&gt; 'pod', 'refresh' =&gt; true ) );&nbsp;</div></li><li><div>        self::$post_types = pods_api()-&gt;load_pods( array( 'type' =&gt; 'post_type', 'refresh' =&gt; true ) );&nbsp;</div></li><li><div>        self::$taxonomies = pods_api()-&gt;load_pods( array( 'type' =&gt; 'taxonomy', 'refresh' =&gt; true ) );&nbsp;</div></li><li><div>        self::$media = pods_api()-&gt;load_pods( array( 'type' =&gt; 'media', 'refresh' =&gt; true ) );&nbsp;</div></li><li><div>        self::$user = pods_api()-&gt;load_pods( array( 'type' =&gt; 'user', 'refresh' =&gt; true ) );&nbsp;</div></li><li><div>        self::$comment = pods_api()-&gt;load_pods( array( 'type' =&gt; 'comment', 'refresh' =&gt; true ) );&nbsp;</div></li><li><div>        self::$settings = pods_api()-&gt;load_pods( array( 'type' =&gt; 'settings', 'refresh' =&gt; true ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function register ( $type, $pod ) {&nbsp;</div></li><li><div>        $pod_type = $type;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( 'post_type' == $type )&nbsp;</div></li><li><div>            $type = 'post_types';&nbsp;</div></li><li><div>        elseif ( 'taxonomy' == $type )&nbsp;</div></li><li><div>            $type = 'taxonomies';&nbsp;</div></li><li><div>        elseif ( 'pod' == $type )&nbsp;</div></li><li><div>            $type = 'advanced_content_types';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !isset( self::$queue[ $type ] ) )&nbsp;</div></li><li><div>            self::$queue[ $type ] = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_array( $pod ) && !empty( $pod ) && !isset( $pod[ 'name' ] ) ) {&nbsp;</div></li><li><div>            $data = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $pod as $p ) {&nbsp;</div></li><li><div>                $data[] = $this-&gt;register( $type, $p );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return $data;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod[ 'type' ] = $pod_type;&nbsp;</div></li><li><div>        $pod = pods_api()-&gt;save_pod( $pod, false, false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !empty( $pod ) ) {&nbsp;</div></li><li><div>            self::$object_identifier--;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            self::$queue[ $type ][ $pod[ 'name' ] ] = $pod;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return $pod;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function register_field ( $pod, $field ) {&nbsp;</div></li><li><div>        if ( is_array( $pod ) && !empty( $pod ) && !isset( $pod[ 'name' ] ) ) {&nbsp;</div></li><li><div>            $data = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $pod as $p ) {&nbsp;</div></li><li><div>                $data[] = $this-&gt;register_field( $p, $field );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return $data;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( self::$current_pod_data ) || !is_object( self::$current_pod_data ) || self::$current_pod_data[ 'name' ] != $pod )&nbsp;</div></li><li><div>            self::$current_pod_data = pods_api()-&gt;load_pod( array( 'name' =&gt; $pod ), false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod = self::$current_pod_data;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !empty( $pod ) ) {&nbsp;</div></li><li><div>            $type = $pod[ 'type' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( 'post_type' == $pod[ 'type' ] )&nbsp;</div></li><li><div>                $type = 'post_types';&nbsp;</div></li><li><div>            elseif ( 'taxonomy' == $pod[ 'type' ] )&nbsp;</div></li><li><div>                $type = 'taxonomies';&nbsp;</div></li><li><div>            elseif ( 'pod' == $pod[ 'type' ] )&nbsp;</div></li><li><div>                $type = 'advanced_content_types';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( !isset( self::$queue[ $pod[ 'type' ] ] ) )&nbsp;</div></li><li><div>                self::$queue[ $type ] = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $field = pods_api()-&gt;save_field( $field, false, false, $pod[ 'id' ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( !empty( $field ) ) {&nbsp;</div></li><li><div>                $pod[ 'fields' ][ $field[ 'name' ] ] = $field;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                self::$queue[ $type ][ $pod[ 'name' ] ] = $pod;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                return $field;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function integrations () {&nbsp;</div></li><li><div>        // Codepress Admin Columns 2.x&nbsp;</div></li><li><div>        add_filter( 'cac/storage_model/meta_keys', array( $this, 'cpac_meta_keys' ), 10, 2 );&nbsp;</div></li><li><div>        add_filter( 'cac/post_types', array( $this, 'cpac_post_types' ), 10, 1 );&nbsp;</div></li><li><div>        add_filter( 'cac/column/meta/value', array( $this, 'cpac_meta_value' ), 10, 3 );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function cpac_meta_keys ( $meta_fields, $storage_model ) {&nbsp;</div></li><li><div>        $object_type = 'post_type';&nbsp;</div></li><li><div>        $object = $storage_model-&gt;key;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( in_array( $storage_model-&gt;key, array( 'wp-links', 'link' ) ) ) {&nbsp;</div></li><li><div>            $object_type = $object = 'link';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( in_array( $storage_model-&gt;key, array( 'wp-media', 'media' ) ) ) {&nbsp;</div></li><li><div>            $object_type = $object = 'media';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( in_array( $storage_model-&gt;key, array( 'wp-users', 'user' ) ) ) {&nbsp;</div></li><li><div>            $object_type = $object = 'user';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( in_array( $storage_model-&gt;key, array( 'wp-comments', 'comment' ) ) ) {&nbsp;</div></li><li><div>            $object_type = $object = 'comment';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( 'taxonomy' === $storage_model-&gt;type ) {&nbsp;</div></li><li><div>            $object_type = 'taxonomy';&nbsp;</div></li><li><div>            $object = $storage_model-&gt;taxonomy;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( self::$current_pod_data ) || !is_object( self::$current_pod_data ) || self::$current_pod_data[ 'name' ] != $object )&nbsp;</div></li><li><div>            self::$current_pod_data = pods_api()-&gt;load_pod( array( 'name' =&gt; $object ), false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod = self::$current_pod_data;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add Pods fields&nbsp;</div></li><li><div>        if ( !empty( $pod ) && $object_type == $pod[ 'type' ] ) {&nbsp;</div></li><li><div>            foreach ( $pod[ 'fields' ] as $field =&gt; $field_data ) {&nbsp;</div></li><li><div>                if ( !is_array( $meta_fields ) )&nbsp;</div></li><li><div>                    $meta_fields = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( !in_array( $field, $meta_fields ) )&nbsp;</div></li><li><div>                    $meta_fields[] = $field;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Remove internal Pods fields&nbsp;</div></li><li><div>        if ( is_array( $meta_fields ) ) {&nbsp;</div></li><li><div>            foreach ( $meta_fields as $k =&gt; $meta_field ) {&nbsp;</div></li><li><div>                if ( 0 === strpos( $meta_field, '_pods_' ) )&nbsp;</div></li><li><div>                    unset( $meta_fields[ $k ] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $meta_fields;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function cpac_post_types ( $post_types ) {&nbsp;</div></li><li><div>        // Remove internal Pods post types&nbsp;</div></li><li><div>        foreach ( $post_types as $post_type =&gt; $post_type_name ) {&nbsp;</div></li><li><div>            if ( 0 === strpos( $post_type, '_pods_' ) || 0 === strpos( $post_type_name, '_pods_' ) )&nbsp;</div></li><li><div>                unset( $post_types[ $post_type ] );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $post_types;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function cpac_meta_value ( $meta, $id, $obj ) {&nbsp;</div></li><li><div>        $tableless_field_types = PodsForm::tableless_field_types();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $object_type = 'post_type';&nbsp;</div></li><li><div>        $object = $obj-&gt;storage_model-&gt;key;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( in_array( $obj-&gt;storage_model-&gt;type, array( 'wp-links', 'link' ) ) ) {&nbsp;</div></li><li><div>            $object_type = $object = 'link';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( in_array( $obj-&gt;storage_model-&gt;type, array( 'wp-media', 'media' ) ) ) {&nbsp;</div></li><li><div>            $object_type = $object = 'media';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( in_array( $obj-&gt;storage_model-&gt;type, array( 'wp-users', 'user' ) ) ) {&nbsp;</div></li><li><div>            $object_type = $object = 'user';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( in_array( $obj-&gt;storage_model-&gt;type, array( 'wp-comments', 'comment' ) ) ) {&nbsp;</div></li><li><div>            $object_type = $object = 'comment';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( 'taxonomy' === $obj-&gt;storage_model-&gt;type ) {&nbsp;</div></li><li><div>            $object_type = 'taxonomy';&nbsp;</div></li><li><div>            $object = $obj-&gt;storage_model-&gt;taxonomy;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $field = substr( $obj-&gt;options-&gt;field, 0, 10 ) == &quot;cpachidden&quot; ? str_replace( 'cpachidden', '', $obj-&gt;options-&gt;field ) : $obj-&gt;options-&gt;field;&nbsp;</div></li><li><div>        $field_type = $obj-&gt;options-&gt;field_type;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( self::$current_pod_data ) || !is_object( self::$current_pod_data ) || self::$current_pod_data[ 'name' ] != $object )&nbsp;</div></li><li><div>            self::$current_pod_data = pods_api()-&gt;load_pod( array( 'name' =&gt; $object ), false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod = self::$current_pod_data;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add Pods fields&nbsp;</div></li><li><div>        if ( !empty( $pod ) && isset( $pod[ 'fields' ][ $field ] ) ) {&nbsp;</div></li><li><div>            if ( in_array( $pod[ 'type' ], array( 'post_type', 'media', 'taxonomy', 'user', 'comment', 'media' ) ) && ( !empty( $field_type ) || in_array( $pod[ 'fields' ][ $field ][ 'type' ], $tableless_field_types ) ) ) {&nbsp;</div></li><li><div>                $metadata_type = $pod['type'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( in_array( $metadata_type, array( 'post_type', 'media' ) ) ) {&nbsp;</div></li><li><div>                    $metadata_type = 'post';&nbsp;</div></li><li><div>                } elseif ( 'taxonomy' == $metadata_type ) {&nbsp;</div></li><li><div>                    $metadata_type = 'term';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( 'term' == $metadata_type && ! function_exists( 'get_term_meta' ) ) {&nbsp;</div></li><li><div>                    $podterms = pods( $pod['name'], $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $meta = $podterms-&gt;field( $field );&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $meta = get_metadata( $metadata_type, $id, $field, true );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            elseif ( 'taxonomy' == $pod['type'] ) {&nbsp;</div></li><li><div>                $podterms = pods( $pod['name'], $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $meta = $podterms-&gt;field( $field );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $meta = PodsForm::field_method( $pod[ 'fields' ][ $field ][ 'type' ], 'ui', $id, $meta, $field, array_merge( $pod[ 'fields' ][ $field ], $pod[ 'fields' ][ $field ][ 'options' ] ), $pod[ 'fields' ], $pod );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $meta;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function cpac_meta_values ( $meta, $field_type, $field, $type, $id ) {&nbsp;</div></li><li><div>        $tableless_field_types = PodsForm::tableless_field_types();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $object = $type;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( 'wp-media' == $type )&nbsp;</div></li><li><div>            $object = 'media';&nbsp;</div></li><li><div>        elseif ( 'wp-users' == $type )&nbsp;</div></li><li><div>            $object = 'user';&nbsp;</div></li><li><div>        elseif ( 'wp-comments' == $type )&nbsp;</div></li><li><div>            $object = 'comment';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( self::$current_pod_data ) || !is_object( self::$current_pod_data ) || self::$current_pod_data[ 'name' ] != $object )&nbsp;</div></li><li><div>            self::$current_pod_data = pods_api()-&gt;load_pod( array( 'name' =&gt; $object ), false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod = self::$current_pod_data;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add Pods fields&nbsp;</div></li><li><div>        if ( !empty( $pod ) && isset( $pod[ 'fields' ][ $field ] ) ) {&nbsp;</div></li><li><div>            if ( in_array( $pod[ 'type' ], array( 'post_type', 'user', 'taxonomy', 'comment', 'media' ) ) && ( !empty( $field_type ) || in_array( $pod[ 'fields' ][ $field ][ 'type' ], $tableless_field_types ) ) ) {&nbsp;</div></li><li><div>                $metadata_type = $pod['type'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( in_array( $metadata_type, array( 'post_type', 'media' ) ) ) {&nbsp;</div></li><li><div>                    $metadata_type = 'post';&nbsp;</div></li><li><div>                } elseif ( 'taxonomy' == $metadata_type ) {&nbsp;</div></li><li><div>                    $metadata_type = 'term';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $meta = get_metadata( $metadata_type, $id, $field, true );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $meta = PodsForm::field_method( $pod[ 'fields' ][ $field ][ 'type' ], 'ui', $id, $meta, $field, array_merge( $pod[ 'fields' ][ $field ], $pod[ 'fields' ][ $field ][ 'options' ] ), $pod[ 'fields' ], $pod );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $meta;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Add a meta group of fields to add/edit forms&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param string|array $pod The pod or type of element to attach the group to.&nbsp;</div></li><li><div>     * @param string $label Title of the edit screen section, visible to user.&nbsp;</div></li><li><div>     * @param string|array $fields Either a comma separated list of text fields or an associative array containing field infomration.&nbsp;</div></li><li><div>     * @param string $context (optional) The part of the page where the edit screen section should be shown ('normal', 'advanced', or 'side').&nbsp;</div></li><li><div>     * @param string $priority (optional) The priority within the context where the boxes should show ('high', 'core', 'default' or 'low').&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since 2.0&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed|void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function group_add ( $pod, $label, $fields, $context = 'normal', $priority = 'default' ) {&nbsp;</div></li><li><div>        if ( is_array( $pod ) && !empty( $pod ) && !isset( $pod[ 'name' ] ) ) {&nbsp;</div></li><li><div>            foreach ( $pod as $p ) {&nbsp;</div></li><li><div>                $this-&gt;group_add( $pod, $label, $fields, $context, $priority );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !is_array( $pod ) ) {&nbsp;</div></li><li><div>            if ( empty( self::$current_pod_data ) || !is_object( self::$current_pod_data ) || self::$current_pod_data[ 'name' ] != $pod )&nbsp;</div></li><li><div>                self::$current_pod_data = pods_api()-&gt;load_pod( array( 'name' =&gt; $pod ), false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( !empty( self::$current_pod_data ) )&nbsp;</div></li><li><div>                $pod = self::$current_pod_data;&nbsp;</div></li><li><div>            else {&nbsp;</div></li><li><div>                $type = 'post_type';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( in_array( $pod, array( 'media', 'user', 'comment' ) ) )&nbsp;</div></li><li><div>                    $type = $pod;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $pod = array(&nbsp;</div></li><li><div>                    'name' =&gt; $pod, &nbsp;</div></li><li><div>                    'type' =&gt; $type&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_array( $pod ) && !isset( $pod[ 'id' ] ) ) {&nbsp;</div></li><li><div>            $defaults = array(&nbsp;</div></li><li><div>                'name' =&gt; '', &nbsp;</div></li><li><div>                'type' =&gt; 'post_type'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod = array_merge( $defaults, $pod );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( 'post' == $pod[ 'type' ] )&nbsp;</div></li><li><div>            $pod[ 'type' ] = 'post_type';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $pod[ 'name' ] ) && isset( $pod[ 'object' ] ) && !empty( $pod[ 'object' ] ) )&nbsp;</div></li><li><div>            $pod[ 'name' ] = $pod[ 'object' ];&nbsp;</div></li><li><div>        elseif ( !isset( $pod[ 'object' ] ) || empty( $pod[ 'object' ] ) )&nbsp;</div></li><li><div>            $pod[ 'object' ] = $pod[ 'name' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $pod[ 'object' ] ) )&nbsp;</div></li><li><div>            return pods_error( __( 'Object required to add a Pods meta group', 'pods' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $object_name = $pod[ 'object' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( 'pod' == $pod[ 'type' ] )&nbsp;</div></li><li><div>            $object_name = $pod[ 'name' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !isset( self::$groups[ $pod[ 'type' ] ] ) )&nbsp;</div></li><li><div>            self::$groups[ $pod[ 'type' ] ] = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !isset( self::$groups[ $pod[ 'type' ] ][ $object_name ] ) )&nbsp;</div></li><li><div>            self::$groups[ $pod[ 'type' ] ][ $object_name ] = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_fields = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !is_array( $fields ) )&nbsp;</div></li><li><div>            $fields = explode( ', ', $fields );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $fields as $k =&gt; $field ) {&nbsp;</div></li><li><div>            $name = $k;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $defaults = array(&nbsp;</div></li><li><div>                'name' =&gt; $name, &nbsp;</div></li><li><div>                'label' =&gt; $name, &nbsp;</div></li><li><div>                'type' =&gt; 'text'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( !is_array( $field ) ) {&nbsp;</div></li><li><div>                $name = trim( $field );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $field = array(&nbsp;</div></li><li><div>                    'name' =&gt; $name, &nbsp;</div></li><li><div>                    'label' =&gt; $name&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $field = array_merge( $defaults, $field );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $field[ 'name' ] = trim( $field[ 'name' ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( isset( $pod[ 'fields' ] ) && isset( $pod[ 'fields' ][ $field[ 'name' ] ] ) )&nbsp;</div></li><li><div>                $field = array_merge( $field, $pod[ 'fields' ][ $field[ 'name' ] ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $_fields[ $k ] = $field;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Setup field options&nbsp;</div></li><li><div>        $fields = PodsForm::fields_setup( $_fields );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $group = array(&nbsp;</div></li><li><div>            'pod' =&gt; $pod, &nbsp;</div></li><li><div>            'label' =&gt; $label, &nbsp;</div></li><li><div>            'fields' =&gt; $fields, &nbsp;</div></li><li><div>            'context' =&gt; $context, &nbsp;</div></li><li><div>            'priority' =&gt; $priority&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Filter group data, pass vars separately for reference down the line (in case array changed by other filter)&nbsp;</div></li><li><div>        $group = apply_filters( 'pods_meta_group_add_' . $pod[ 'type' ] . '_' . $object_name, $group, $pod, $label, $fields );&nbsp;</div></li><li><div>        $group = apply_filters( 'pods_meta_group_add_' . $pod[ 'type' ], $group, $pod, $label, $fields );&nbsp;</div></li><li><div>        $group = apply_filters( 'pods_meta_group_add', $group, $pod, $label, $fields );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        self::$groups[ $pod[ 'type' ] ][ $object_name ][] = $group;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Hook it up!&nbsp;</div></li><li><div>        if ( 'post_type' == $pod[ 'type' ] ) {&nbsp;</div></li><li><div>            if ( !has_action( 'add_meta_boxes', array( $this, 'meta_post_add' ) ) )&nbsp;</div></li><li><div>                add_action( 'add_meta_boxes', array( $this, 'meta_post_add' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            /**if ( !has_action( 'save_post', array( $this, 'save_post' ), 10, 3 ) )&nbsp;</div></li><li><div>                add_action( 'save_post', array( $this, 'save_post' ), 10, 3 );*/&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( 'taxonomy' == $pod[ 'type' ] ) {&nbsp;</div></li><li><div>            if ( !has_action( $pod[ 'object' ] . '_edit_form_fields', array( $this, 'meta_taxonomy' ), 10, 2 ) ) {&nbsp;</div></li><li><div>                add_action( $pod[ 'object' ] . '_edit_form_fields', array( $this, 'meta_taxonomy' ), 10, 2 );&nbsp;</div></li><li><div>                add_action( $pod[ 'object' ] . '_add_form_fields', array( $this, 'meta_taxonomy' ), 10, 1 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( !has_action( 'edited_term', array( $this, 'save_taxonomy' ), 10, 3 ) ) {&nbsp;</div></li><li><div>                add_action( 'edited_term', array( $this, 'save_taxonomy' ), 10, 3 );&nbsp;</div></li><li><div>                add_action( 'create_term', array( $this, 'save_taxonomy' ), 10, 3 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( 'media' == $pod[ 'type' ] ) {&nbsp;</div></li><li><div>            if ( !has_filter( 'wp_update_attachment_metadata', array( $this, 'save_media' ), 10, 2 ) ) {&nbsp;</div></li><li><div>                if ( pods_version_check( 'wp', '3.5' ) ) {&nbsp;</div></li><li><div>                    add_action( 'add_meta_boxes', array( $this, 'meta_post_add' ) );&nbsp;</div></li><li><div>                    add_action( 'wp_ajax_save-attachment-compat', array( $this, 'save_media_ajax' ), 0 );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                add_filter( 'attachment_fields_to_edit', array( $this, 'meta_media' ), 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                add_filter( 'attachment_fields_to_save', array( $this, 'save_media' ), 10, 2 );&nbsp;</div></li><li><div>                add_filter( 'wp_update_attachment_metadata', array( $this, 'save_media' ), 10, 2 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( 'user' == $pod[ 'type' ] ) {&nbsp;</div></li><li><div>            if ( !has_action( 'show_user_profile', array( $this, 'meta_user' ) ) ) {&nbsp;</div></li><li><div>                add_action( 'show_user_profile', array( $this, 'meta_user' ) );&nbsp;</div></li><li><div>                add_action( 'edit_user_profile', array( $this, 'meta_user' ) );&nbsp;</div></li><li><div>                //add_action( 'user_register', array( $this, 'save_user' ) );&nbsp;</div></li><li><div>                add_action( 'profile_update', array( $this, 'save_user' ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( 'comment' == $pod[ 'type' ] ) {&nbsp;</div></li><li><div>            if ( !has_action( 'comment_form_logged_in_after', array( $this, 'meta_comment_new_logged_in' ), 10, 2 ) ) {&nbsp;</div></li><li><div>                add_action( 'comment_form_logged_in_after', array( $this, 'meta_comment_new_logged_in' ), 10, 2 );&nbsp;</div></li><li><div>                add_filter( 'comment_form_default_fields', array( $this, 'meta_comment_new' ) );&nbsp;</div></li><li><div>                add_action( 'add_meta_boxes_comment', array( $this, 'meta_comment_add' ) );&nbsp;</div></li><li><div>                add_action( 'wp_insert_comment', array( $this, 'save_comment' ) );&nbsp;</div></li><li><div>                add_action( 'edit_comment', array( $this, 'save_comment' ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function object_get ( $type, $name ) {&nbsp;</div></li><li><div>        $object = self::$post_types;&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        if ( 'term' == $type ) {&nbsp;</div></li><li><div>            $type = 'taxonomy';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( 'taxonomy' == $type )&nbsp;</div></li><li><div>            $object = self::$taxonomies;&nbsp;</div></li><li><div>        elseif ( 'media' == $type )&nbsp;</div></li><li><div>            $object = self::$media;&nbsp;</div></li><li><div>        elseif ( 'user' == $type )&nbsp;</div></li><li><div>            $object = self::$user;&nbsp;</div></li><li><div>        elseif ( 'comment' == $type )&nbsp;</div></li><li><div>            $object = self::$comment;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( 'pod' != $type && !empty( $object ) && is_array( $object ) && isset( $object[ $name ] ) )&nbsp;</div></li><li><div>            $pod = $object[ $name ];&nbsp;</div></li><li><div>        else {&nbsp;</div></li><li><div>            if ( empty( self::$current_pod_data ) || !is_object( self::$current_pod_data ) || self::$current_pod_data[ 'name' ] != $name )&nbsp;</div></li><li><div>                self::$current_pod_data = pods_api()-&gt;load_pod( array( 'name' =&gt; $name ), false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod = self::$current_pod_data;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $pod ) )&nbsp;</div></li><li><div>            return array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $defaults = array(&nbsp;</div></li><li><div>            'name' =&gt; 'post', &nbsp;</div></li><li><div>            'object' =&gt; 'post', &nbsp;</div></li><li><div>            'type' =&gt; 'post_type'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod = array_merge( $defaults, (array) $pod );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $pod[ 'name' ] ) )&nbsp;</div></li><li><div>            $pod[ 'name' ] = $pod[ 'object' ];&nbsp;</div></li><li><div>        elseif ( empty( $pod[ 'object' ] ) )&nbsp;</div></li><li><div>            $pod[ 'object' ] = $pod[ 'name' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $pod[ 'type' ] != $type )&nbsp;</div></li><li><div>            return array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $pod;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $type&nbsp;</div></li><li><div>     * @param $name&nbsp;</div></li><li><div>     * @param $default_fields&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function groups_get ( $type, $name, $default_fields = null ) {&nbsp;</div></li><li><div>        if ( 'post_type' == $type && 'attachment' == $name ) {&nbsp;</div></li><li><div>            $type = 'media';&nbsp;</div></li><li><div>            $name = 'media';&nbsp;</div></li><li><div>        } elseif ( 'term' == $type ) {&nbsp;</div></li><li><div>            $type = 'taxonomy';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_groups', $type, $name );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod = array();&nbsp;</div></li><li><div>        $fields = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $object = self::$post_types;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( 'taxonomy' == $type )&nbsp;</div></li><li><div>            $object = self::$taxonomies;&nbsp;</div></li><li><div>        elseif ( 'media' == $type )&nbsp;</div></li><li><div>            $object = self::$media;&nbsp;</div></li><li><div>        elseif ( 'user' == $type )&nbsp;</div></li><li><div>            $object = self::$user;&nbsp;</div></li><li><div>        elseif ( 'comment' == $type )&nbsp;</div></li><li><div>            $object = self::$comment;&nbsp;</div></li><li><div>        elseif ( 'pod' == $type )&nbsp;</div></li><li><div>            $object = self::$advanced_content_types;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !empty( $object ) && is_array( $object ) && isset( $object[ $name ] ) )&nbsp;</div></li><li><div>            $fields = $object[ $name ][ 'fields' ];&nbsp;</div></li><li><div>        else {&nbsp;</div></li><li><div>            if ( empty( self::$current_pod_data ) || !is_object( self::$current_pod_data ) || self::$current_pod_data[ 'name' ] != $name )&nbsp;</div></li><li><div>                self::$current_pod_data = pods_api()-&gt;load_pod( array( 'name' =&gt; $name ), false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod = self::$current_pod_data;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( !empty( $pod ) )&nbsp;</div></li><li><div>                $fields = $pod[ 'fields' ];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $default_fields ) {&nbsp;</div></li><li><div>            $fields = $default_fields;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $defaults = array(&nbsp;</div></li><li><div>            'name' =&gt; 'post', &nbsp;</div></li><li><div>            'object' =&gt; 'post', &nbsp;</div></li><li><div>            'type' =&gt; 'post_type'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod = array_merge( $defaults, (array) $pod );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $pod[ 'name' ] ) )&nbsp;</div></li><li><div>            $pod[ 'name' ] = $pod[ 'object' ];&nbsp;</div></li><li><div>        elseif ( empty( $pod[ 'object' ] ) )&nbsp;</div></li><li><div>            $pod[ 'object' ] = $pod[ 'name' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $pod[ 'type' ] != $type )&nbsp;</div></li><li><div>            return array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $groups = array(&nbsp;</div></li><li><div>            array(&nbsp;</div></li><li><div>                'pod' =&gt; $pod, &nbsp;</div></li><li><div>                /**&nbsp;</div></li><li><div>                 * Filter the title of the Pods Metabox In The Post Editor&nbsp;</div></li><li><div>                 *&nbsp;</div></li><li><div>                 * @param string $title The title to use, default is 'More Fields'&nbsp;</div></li><li><div>                 * @param obj|Pod $pod Current Pods Object&nbsp;</div></li><li><div>                 * @param array $fields Array of fields that will go in the metabox&nbsp;</div></li><li><div>                 * @param string $type The type of Pod&nbsp;</div></li><li><div>                 * @params string $name Name of the Pod&nbsp;</div></li><li><div>                 *&nbsp;</div></li><li><div>                 * @returns string The title for the metabox.&nbsp;</div></li><li><div>                 *&nbsp;</div></li><li><div>                 * @since unknown&nbsp;</div></li><li><div>                 */&nbsp;</div></li><li><div>                'label' =&gt; apply_filters( 'pods_meta_default_box_title', __( 'More Fields', 'pods' ), $pod, $fields, $type, $name ), &nbsp;</div></li><li><div>                'fields' =&gt; $fields, &nbsp;</div></li><li><div>                'context' =&gt; 'normal', &nbsp;</div></li><li><div>                'priority' =&gt; 'default'&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( isset( self::$groups[ $type ] ) && isset( self::$groups[ $type ][ $name ] ) )&nbsp;</div></li><li><div>            $groups = self::$groups[ $type ][ $name ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $groups;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $post_type&nbsp;</div></li><li><div>     * @param null $post&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function meta_post_add ( $post_type, $post = null ) {&nbsp;</div></li><li><div>        if ( 'comment' == $post_type )&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_object( $post ) )&nbsp;</div></li><li><div>            $post_type = $post-&gt;post_type;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $groups = $this-&gt;groups_get( 'post_type', $post_type );&nbsp;</div></li><li><div>        $pods_field_found = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $groups as $group ) {&nbsp;</div></li><li><div>            if ( empty( $group[ 'fields' ] ) )&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $field_found = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $group[ 'fields' ] as $field ) {&nbsp;</div></li><li><div>                if ( false !== PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field, $group[ 'fields' ] ) ) {&nbsp;</div></li><li><div>                    $field_found = true;&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( empty( $group[ 'label' ] ) )&nbsp;</div></li><li><div>                $group[ 'label' ] = get_post_type_object( $post_type )-&gt;labels-&gt;label;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $field_found ) {&nbsp;</div></li><li><div>                $pods_field_found = true;&nbsp;</div></li><li><div>                add_meta_box(&nbsp;</div></li><li><div>                    'pods-meta-' . sanitize_title( $group[ 'label' ] ), &nbsp;</div></li><li><div>                    $group[ 'label' ], &nbsp;</div></li><li><div>                    array( $this, 'meta_post' ), &nbsp;</div></li><li><div>                    $post_type, &nbsp;</div></li><li><div>                    $group[ 'context' ], &nbsp;</div></li><li><div>                    $group[ 'priority' ], &nbsp;</div></li><li><div>                    array( 'group' =&gt; $group )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $pods_field_found ) {&nbsp;</div></li><li><div>            // Only add the classes to forms that actually have pods fields&nbsp;</div></li><li><div>            add_action( 'post_edit_form_tag', array( $this, 'add_class_submittable' ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Called by 'post_edit_form_tag' action to include the classes in the &lt;form&gt; tag&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function add_class_submittable () {&nbsp;</div></li><li><div>        echo ' class=&quot;pods-submittable pods-form&quot;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $post&nbsp;</div></li><li><div>     * @param $metabox&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function meta_post ( $post, $metabox ) {&nbsp;</div></li><li><div>        wp_enqueue_style( 'pods-form' );&nbsp;</div></li><li><div>        wp_enqueue_script( 'pods' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod_type = 'post';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( 'attachment' == $post-&gt;post_type ) {&nbsp;</div></li><li><div>            $pod_type = 'media';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_' . __FUNCTION__, $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $hidden_fields = array();&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>    &lt;table class=&quot;form-table pods-metabox pods-admin pods-dependency&quot;&gt;&nbsp;</div></li><li><div>        &lt;?php echo PodsForm::field( 'pods_meta', wp_create_nonce( 'pods_meta_' . $pod_type ), 'hidden' ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        $id = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_object( $post ) && false === strpos( $_SERVER[ 'REQUEST_URI' ], '/post-new.php' ) )&nbsp;</div></li><li><div>            $id = $post-&gt;ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( self::$current_pod_data ) || !is_object( self::$current_pod ) || self::$current_pod-&gt;pod != $metabox[ 'args' ][ 'group' ][ 'pod' ][ 'name' ] )&nbsp;</div></li><li><div>            self::$current_pod = pods( $metabox[ 'args' ][ 'group' ][ 'pod' ][ 'name' ], $id, true );&nbsp;</div></li><li><div>        elseif ( self::$current_pod-&gt;id() != $id )&nbsp;</div></li><li><div>            self::$current_pod-&gt;fetch( $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod = self::$current_pod;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $metabox[ 'args' ][ 'group' ][ 'fields' ] as $field ) {&nbsp;</div></li><li><div>            if ( false === PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field[ 'options' ], $metabox[ 'args' ][ 'group' ][ 'fields' ], $pod, $id ) ) {&nbsp;</div></li><li><div>                if ( pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                    $field[ 'type' ] = 'hidden';&nbsp;</div></li><li><div>                else&nbsp;</div></li><li><div>                    continue;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            elseif ( !pods_has_permissions( $field[ 'options' ] ) && pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                $field[ 'type' ] = 'hidden';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $value = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( !empty( $pod ) ) {&nbsp;</div></li><li><div>                pods_no_conflict_on( 'post' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $value = $pod-&gt;field( array( 'name' =&gt; $field[ 'name' ], 'in_form' =&gt; true ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                pods_no_conflict_off( 'post' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            elseif ( !empty( $id ) )&nbsp;</div></li><li><div>                $value = get_post_meta( $id, $field[ 'name' ], true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( 'hidden' == $field[ 'type' ] ) {&nbsp;</div></li><li><div>                $hidden_fields[] = array(&nbsp;</div></li><li><div>                    'field' =&gt; $field, &nbsp;</div></li><li><div>                    'value' =&gt; $value&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            else {&nbsp;</div></li><li><div>                $depends = PodsForm::dependencies( $field, 'pods-meta-' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            do_action( 'pods_meta_' . __FUNCTION__ . '_' . $field[ 'name' ], $post, $field, $pod );&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>            &lt;tr class=&quot;form-field pods-field pods-field-input &lt;?php echo esc_attr( 'pods-form-ui-row-type-' . $field[ 'type' ] . ' pods-form-ui-row-name-' . PodsForm::clean( $field[ 'name' ], true ) ); ?&gt; &lt;?php echo esc_attr( $depends ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;?php echo PodsForm::label( 'pods_meta_' . $field[ 'name' ], $field[ 'label' ], $field[ 'help' ], $field ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                &lt;td&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                        // Remove any extra ? help icons&nbsp;</div></li><li><div>                        if ( isset( $field[ 'help' ] ) )&nbsp;</div></li><li><div>                            unset( $field[ 'help' ] );&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;pods-submittable-fields&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php echo PodsForm::field( 'pods_meta_' . $field[ 'name' ], $value, $field[ 'type' ], $field, $pod, $id ); ?&gt;&nbsp;</div></li><li><div>                    &lt;?php echo PodsForm::comment( 'pods_meta_' . $field[ 'name' ], $field[ 'description' ], $field ); ?&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>                do_action( 'pods_meta_' . __FUNCTION__ . '_' . $field[ 'name' ] . '_post', $post, $field, $pod );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>    &lt;/table&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>        do_action( 'pods_meta_' . __FUNCTION__ . '_post', $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $hidden_fields as $hidden_field ) {&nbsp;</div></li><li><div>            $field = $hidden_field[ 'field' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            echo PodsForm::field( 'pods_meta_' . $field[ 'name' ], $hidden_field[ 'value' ], 'hidden' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>        jQuery( function ( $ ) {&nbsp;</div></li><li><div>            $( document ).Pods( 'validate' );&nbsp;</div></li><li><div>            $( document ).Pods( 'submit_meta' );&nbsp;</div></li><li><div>            $( document ).Pods( 'dependency', true );&nbsp;</div></li><li><div>        } );&nbsp;</div></li><li><div>    &lt;/script&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $new_status&nbsp;</div></li><li><div>     * @param $old_status&nbsp;</div></li><li><div>     * @param $post&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function save_post_detect_new ( $new_status, $old_status, $post ) {&nbsp;</div></li><li><div>        self::$old_post_status = $old_status;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $post_id&nbsp;</div></li><li><div>     * @param $post&nbsp;</div></li><li><div>     * @param $update&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return int Post ID&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function save_post ( $post_id, $post, $update = null ) {&nbsp;</div></li><li><div>        $is_new_item = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_bool( $update ) )&nbsp;</div></li><li><div>            $is_new_item = !$update; // false is new item&nbsp;</div></li><li><div>        elseif ( 'new' == self::$old_post_status ) {&nbsp;</div></li><li><div>            $is_new_item = true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $_POST ) ) {&nbsp;</div></li><li><div>            return $post_id;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( !$is_new_item && !wp_verify_nonce( pods_v( 'pods_meta', 'post' ), 'pods_meta_post' ) ) {&nbsp;</div></li><li><div>            return $post_id;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Reset to avoid manual new post issues&nbsp;</div></li><li><div>        self::$old_post_status = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $blacklisted_types = array(&nbsp;</div></li><li><div>            'revision', &nbsp;</div></li><li><div>            '_pods_pod', &nbsp;</div></li><li><div>            '_pods_field'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $blacklisted_types = apply_filters( 'pods_meta_save_post_blacklist_types', $blacklisted_types, $post_id, $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // @todo Figure out how to hook into autosave for saving meta&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Block Autosave and Revisions&nbsp;</div></li><li><div>        if ( ( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE ) || in_array( $post-&gt;post_type, $blacklisted_types ) )&nbsp;</div></li><li><div>            return $post_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Block Quick Edits / Bulk Edits&nbsp;</div></li><li><div>        if ( 'edit.php' == pods_var( 'pagenow', 'global' ) && ( 'inline-save' == pods_var( 'action', 'post' ) || null != pods_var( 'bulk_edit', 'get' ) || is_array( pods_var( 'post', 'get' ) ) ) )&nbsp;</div></li><li><div>            return $post_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Block Trash&nbsp;</div></li><li><div>        if ( in_array( pods_var( 'action', 'get' ), array( 'untrash', 'trash' ) ) )&nbsp;</div></li><li><div>            return $post_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Block Auto-drafting and Trash (not via Admin action)&nbsp;</div></li><li><div>        $blacklisted_status = array(&nbsp;</div></li><li><div>            'auto-draft', &nbsp;</div></li><li><div>            'trash'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $blacklisted_status = apply_filters( 'pods_meta_save_post_blacklist_status', $blacklisted_status, $post_id, $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( in_array( $post-&gt;post_status, $blacklisted_status ) )&nbsp;</div></li><li><div>            return $post_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $groups = $this-&gt;groups_get( 'post_type', $post-&gt;post_type );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $groups ) )&nbsp;</div></li><li><div>            return $post_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $data = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $id = $post_id;&nbsp;</div></li><li><div>        $pod = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $groups as $group ) {&nbsp;</div></li><li><div>            if ( empty( $group[ 'fields' ] ) )&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( null === $pod || ( is_object( $pod ) && $pod-&gt;id() != $id ) ) {&nbsp;</div></li><li><div>                if ( !is_object( self::$current_pod ) || self::$current_pod-&gt;pod != $group[ 'pod' ][ 'name' ] )&nbsp;</div></li><li><div>                    self::$current_pod = pods( $group[ 'pod' ][ 'name' ], $id, true );&nbsp;</div></li><li><div>                elseif ( self::$current_pod-&gt;id() != $id )&nbsp;</div></li><li><div>                    self::$current_pod-&gt;fetch( $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $pod = self::$current_pod;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $group[ 'fields' ] as $field ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( false === PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field, $group[ 'fields' ], $pod, $id ) ) {&nbsp;</div></li><li><div>                    if ( !pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $data[ $field[ 'name' ] ] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( isset( $_POST[ 'pods_meta_' . $field[ 'name' ] ] ) )&nbsp;</div></li><li><div>                    $data[ $field[ 'name' ] ] = $_POST[ 'pods_meta_' . $field[ 'name' ] ];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $is_new_item ) {&nbsp;</div></li><li><div>            do_action( 'pods_meta_create_pre_post', $data, $pod, $id, $groups, $post, $post-&gt;post_type );&nbsp;</div></li><li><div>            do_action( &quot;pods_meta_create_pre_post_{$post-&gt;post_type}&quot;, $data, $pod, $id, $groups, $post );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_save_pre_post', $data, $pod, $id, $groups, $post, $post-&gt;post_type, $is_new_item );&nbsp;</div></li><li><div>        do_action( &quot;pods_meta_save_pre_post_{$post-&gt;post_type}&quot;, $data, $pod, $id, $groups, $post, $is_new_item );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        pods_no_conflict_on( 'post' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !empty( $pod ) ) {&nbsp;</div></li><li><div>            // Fix for Pods doing it's own sanitization&nbsp;</div></li><li><div>            $data = pods_unslash( (array) $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod-&gt;save( $data, null, null, array( 'is_new_item' =&gt; $is_new_item ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( !empty( $id ) ) {&nbsp;</div></li><li><div>            foreach ( $data as $field =&gt; $value ) {&nbsp;</div></li><li><div>                update_post_meta( $id, $field, $value );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        pods_no_conflict_off( 'post' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $is_new_item ) {&nbsp;</div></li><li><div>            do_action( 'pods_meta_create_post', $data, $pod, $id, $groups, $post, $post-&gt;post_type );&nbsp;</div></li><li><div>            do_action( &quot;pods_meta_create_post_{$post-&gt;post_type}&quot;, $data, $pod, $id, $groups, $post );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_save_post', $data, $pod, $id, $groups, $post, $post-&gt;post_type, $is_new_item );&nbsp;</div></li><li><div>        do_action( &quot;pods_meta_save_post_{$post-&gt;post_type}&quot;, $data, $pod, $id, $groups, $post, $is_new_item );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $post_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $form_fields&nbsp;</div></li><li><div>     * @param $post&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function meta_media ( $form_fields, $post ) {&nbsp;</div></li><li><div>        $groups = $this-&gt;groups_get( 'media', 'media' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $groups ) || 'attachment' == pods_var( 'typenow', 'global' ) )&nbsp;</div></li><li><div>            return $form_fields;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        wp_enqueue_style( 'pods-form' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $id = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_object( $post ) )&nbsp;</div></li><li><div>            $id = $post-&gt;ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $meta_nonce = PodsForm::field( 'pods_meta', wp_create_nonce( 'pods_meta_media' ), 'hidden' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $groups as $group ) {&nbsp;</div></li><li><div>            if ( empty( $group[ 'fields' ] ) )&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( null === $pod || ( is_object( $pod ) && $pod-&gt;id() != $id ) ) {&nbsp;</div></li><li><div>                if ( !is_object( self::$current_pod ) || self::$current_pod-&gt;pod != $group[ 'pod' ][ 'name' ] )&nbsp;</div></li><li><div>                    self::$current_pod = pods( $group[ 'pod' ][ 'name' ], $id, true );&nbsp;</div></li><li><div>                elseif ( self::$current_pod-&gt;id() != $id )&nbsp;</div></li><li><div>                    self::$current_pod-&gt;fetch( $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $pod = self::$current_pod;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $group[ 'fields' ] as $field ) {&nbsp;</div></li><li><div>                if ( false === PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field, $group[ 'fields' ], $pod, $id ) ) {&nbsp;</div></li><li><div>                    if ( !pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $value = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( !empty( $pod ) )&nbsp;</div></li><li><div>                    $value = $pod-&gt;field( array( 'name' =&gt; $field[ 'name' ], 'in_form' =&gt; true ) );&nbsp;</div></li><li><div>                elseif ( !empty( $id ) ) {&nbsp;</div></li><li><div>                    pods_no_conflict_on( 'post' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $value = get_post_meta( $id, $field[ 'name' ], true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    pods_no_conflict_off( 'post' );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $form_fields[ 'pods_meta_' . $field[ 'name' ] ] = array(&nbsp;</div></li><li><div>                    'label' =&gt; $field[ 'label' ], &nbsp;</div></li><li><div>                    'input' =&gt; 'html', &nbsp;</div></li><li><div>                    'html' =&gt; PodsForm::field( 'pods_meta_' . $field[ 'name' ], $value, $field[ 'type' ], $field, $pod, $id ) . $meta_nonce, &nbsp;</div></li><li><div>                    'helps' =&gt; PodsForm::comment( 'pods_meta_' . $field[ 'name' ], $field[ 'description' ], $field )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $form_fields = apply_filters( 'pods_meta_' . __FUNCTION__, $form_fields );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $form_fields;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $post&nbsp;</div></li><li><div>     * @param $attachment&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function save_media ( $post, $attachment ) {&nbsp;</div></li><li><div>        $groups = $this-&gt;groups_get( 'media', 'media' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $groups ) )&nbsp;</div></li><li><div>            return $post;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $post_id = $attachment;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $_POST ) || !wp_verify_nonce( pods_v( 'pods_meta', 'post' ), 'pods_meta_media' ) ) {&nbsp;</div></li><li><div>            return $post;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_array( $post ) && !empty( $post ) && isset( $post[ 'ID' ] ) && 'attachment' == $post[ 'post_type' ] )&nbsp;</div></li><li><div>            $post_id = $post[ 'ID' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_array( $post_id ) || empty( $post_id ) )&nbsp;</div></li><li><div>            return $post;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $data = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $id = $post_id;&nbsp;</div></li><li><div>        $pod = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $groups as $group ) {&nbsp;</div></li><li><div>            if ( empty( $group[ 'fields' ] ) )&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( null === $pod || ( is_object( $pod ) && $pod-&gt;id() != $id ) ) {&nbsp;</div></li><li><div>                if ( !is_object( self::$current_pod ) || self::$current_pod-&gt;pod != $group[ 'pod' ][ 'name' ] )&nbsp;</div></li><li><div>                    self::$current_pod = pods( $group[ 'pod' ][ 'name' ], $id, true );&nbsp;</div></li><li><div>                elseif ( self::$current_pod-&gt;id() != $id )&nbsp;</div></li><li><div>                    self::$current_pod-&gt;fetch( $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $pod = self::$current_pod;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $group[ 'fields' ] as $field ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( false === PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field, $group[ 'fields' ], $pod, $id ) ) {&nbsp;</div></li><li><div>                    if ( !pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $data[ $field[ 'name' ] ] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( isset( $_POST[ 'pods_meta_' . $field[ 'name' ] ] ) )&nbsp;</div></li><li><div>                    $data[ $field[ 'name' ] ] = $_POST[ 'pods_meta_' . $field[ 'name' ] ];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_save_pre_media', $data, $pod, $id, $groups, $post, $attachment );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !empty( $pod ) ) {&nbsp;</div></li><li><div>            // Fix for Pods doing it's own sanitization&nbsp;</div></li><li><div>            $data = pods_unslash( (array) $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod-&gt;save( $data );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( !empty( $id ) ) {&nbsp;</div></li><li><div>            pods_no_conflict_on( 'post' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $data as $field =&gt; $value ) {&nbsp;</div></li><li><div>                update_post_meta( $id, $field, $value );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            pods_no_conflict_off( 'post' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_save_media', $data, $pod, $id, $groups, $post, $attachment );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $post;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function save_media_ajax () {&nbsp;</div></li><li><div>        if ( !isset( $_POST[ 'id' ] ) || empty( $_POST[ 'id' ] ) || absint( $_POST[ 'id' ] ) &lt; 1 )&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $id = absint( $_POST[ 'id' ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !isset( $_POST[ 'nonce' ] ) || empty( $_POST[ 'nonce' ] ) )&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        check_ajax_referer( 'update-post_' . $id, 'nonce' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !current_user_can( 'edit_post', $id ) )&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $post = get_post( $id, ARRAY_A );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( 'attachment' != $post[ 'post_type' ] )&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // fix ALL THE THINGS&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !isset( $_REQUEST[ 'attachments' ] ) )&nbsp;</div></li><li><div>            $_REQUEST[ 'attachments' ] = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !isset( $_REQUEST[ 'attachments' ][ $id ] ) )&nbsp;</div></li><li><div>            $_REQUEST[ 'attachments' ][ $id ] = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $_REQUEST[ 'attachments' ][ $id ] ) )&nbsp;</div></li><li><div>            $_REQUEST[ 'attachments' ][ $id ][ '_fix_wp' ] = 1;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $tag&nbsp;</div></li><li><div>     * @param null $taxonomy&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function meta_taxonomy ( $tag, $taxonomy = null ) {&nbsp;</div></li><li><div>        wp_enqueue_style( 'pods-form' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_' . __FUNCTION__, $tag, $taxonomy );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $taxonomy_name = $taxonomy;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !is_object( $tag ) )&nbsp;</div></li><li><div>            $taxonomy_name = $tag;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $groups = $this-&gt;groups_get( 'taxonomy', $taxonomy_name );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $id = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_object( $tag ) )&nbsp;</div></li><li><div>            $id = $tag-&gt;term_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo PodsForm::field( 'pods_meta', wp_create_nonce( 'pods_meta_taxonomy' ), 'hidden' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $groups as $group ) {&nbsp;</div></li><li><div>            if ( empty( $group[ 'fields' ] ) )&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( null === $pod || ( is_object( $pod ) && $pod-&gt;id() != $id ) ) {&nbsp;</div></li><li><div>                if ( !is_object( self::$current_pod ) || self::$current_pod-&gt;pod != $group[ 'pod' ][ 'name' ] )&nbsp;</div></li><li><div>                    self::$current_pod = pods( $group[ 'pod' ][ 'name' ], $id, true );&nbsp;</div></li><li><div>                elseif ( self::$current_pod-&gt;id() != $id )&nbsp;</div></li><li><div>                    self::$current_pod-&gt;fetch( $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $pod = self::$current_pod;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $group[ 'fields' ] as $field ) {&nbsp;</div></li><li><div>                if ( false === PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field, $group[ 'fields' ], $pod, $id ) ) {&nbsp;</div></li><li><div>                    if ( pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                        $field[ 'type' ] = 'hidden';&nbsp;</div></li><li><div>                    else&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                elseif ( !pods_has_permissions( $field[ 'options' ] ) && pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                    $field[ 'type' ] = 'hidden';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $value = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( !empty( $pod ) )&nbsp;</div></li><li><div>                    $value = $pod-&gt;field( array( 'name' =&gt; $field[ 'name' ], 'in_form' =&gt; true ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( !is_object( $tag ) ) {&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>                &lt;div class=&quot;form-field pods-field&quot; style=&quot;&lt;?php echo esc_attr( 'hidden' == $field[ 'type' ] ? 'display:none;' : '' ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                        echo PodsForm::label( 'pods_meta_' . $field[ 'name' ], $field[ 'label' ], $field[ 'help' ], $field );&nbsp;</div></li><li><div>                        echo PodsForm::field( 'pods_meta_' . $field[ 'name' ], $value, $field[ 'type' ], $field, $pod, $id );&nbsp;</div></li><li><div>                        echo PodsForm::comment( 'pods_meta_' . $field[ 'name' ], $field[ 'description' ], $field );&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                else {&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>                &lt;tr class=&quot;form-field pods-field &lt;?php echo esc_attr( 'pods-form-ui-row-type-' . $field[ 'type' ] . ' pods-form-ui-row-name-' . PodsForm::clean( $field[ 'name' ], true ) ); ?&gt;&quot; style=&quot;&lt;?php echo esc_attr( 'hidden' == $field[ 'type' ] ? 'display:none;' : '' ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                    &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;?php echo PodsForm::label( 'pods_meta_' . $field[ 'name' ], $field[ 'label' ], $field[ 'help' ], $field ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                    &lt;td&gt;&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                            echo PodsForm::field( 'pods_meta_' . $field[ 'name' ], $value, $field[ 'type' ], $field, $pod, $id );&nbsp;</div></li><li><div>                            echo PodsForm::comment( 'pods_meta_' . $field[ 'name' ], $field[ 'description' ], $field );&nbsp;</div></li><li><div>                        ?&gt;&nbsp;</div></li><li><div>                    &lt;/td&gt;&nbsp;</div></li><li><div>                &lt;/tr&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_' . __FUNCTION__ . '_post', $tag, $taxonomy );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $term_id&nbsp;</div></li><li><div>     * @param $term_taxonomy_id&nbsp;</div></li><li><div>     * @param $taxonomy&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function save_taxonomy ( $term_id, $term_taxonomy_id, $taxonomy ) {&nbsp;</div></li><li><div>        $is_new_item = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( 'create_term' == current_filter() )&nbsp;</div></li><li><div>            $is_new_item = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $_POST ) || !wp_verify_nonce( pods_v( 'pods_meta', 'post' ), 'pods_meta_taxonomy' ) ) {&nbsp;</div></li><li><div>            return $term_id;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Block Quick Edits / Bulk Edits&nbsp;</div></li><li><div>        if ( 'inline-save-tax' == pods_var( 'action', 'post' ) || null != pods_var( 'delete_tags', 'post' ) ) {&nbsp;</div></li><li><div>            return $term_id;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $groups = $this-&gt;groups_get( 'taxonomy', $taxonomy );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $groups ) )&nbsp;</div></li><li><div>            return $term_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $term = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $id = $term_id;&nbsp;</div></li><li><div>        $pod = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $has_fields = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $groups as $group ) {&nbsp;</div></li><li><div>            if ( empty( $group[ 'fields' ] ) )&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( null === $term ) {&nbsp;</div></li><li><div>                $term = get_term( $term_id, $taxonomy );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $data = array(&nbsp;</div></li><li><div>                    'name' =&gt; $term-&gt;name&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $has_fields = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( null === $pod || ( is_object( $pod ) && $pod-&gt;id() != $id ) ) {&nbsp;</div></li><li><div>                if ( !is_object( self::$current_pod ) || self::$current_pod-&gt;pod != $group[ 'pod' ][ 'name' ] )&nbsp;</div></li><li><div>                    self::$current_pod = pods( $group[ 'pod' ][ 'name' ], $id, true );&nbsp;</div></li><li><div>                elseif ( self::$current_pod-&gt;id() != $id )&nbsp;</div></li><li><div>                    self::$current_pod-&gt;fetch( $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $pod = self::$current_pod;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $group[ 'fields' ] as $field ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( false === PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field, $group[ 'fields' ], $pod, $id ) ) {&nbsp;</div></li><li><div>                    if ( !pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $data[ $field[ 'name' ] ] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( isset( $_POST[ 'pods_meta_' . $field[ 'name' ] ] ) )&nbsp;</div></li><li><div>                    $data[ $field[ 'name' ] ] = $_POST[ 'pods_meta_' . $field[ 'name' ] ];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !$has_fields ) {&nbsp;</div></li><li><div>            return $term_id;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $is_new_item ) {&nbsp;</div></li><li><div>            do_action( 'pods_meta_create_pre_taxonomy', $data, $pod, $id, $groups, $term_id, $term_taxonomy_id, $taxonomy );&nbsp;</div></li><li><div>            do_action( &quot;pods_meta_create_pre_taxonomy_{$taxonomy}&quot;, $data, $pod, $id, $groups, $term_id, $term_taxonomy_id, $taxonomy );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_save_pre_taxonomy', $data, $pod, $id, $groups, $term_id, $term_taxonomy_id, $taxonomy, $is_new_item );&nbsp;</div></li><li><div>        do_action( &quot;pods_meta_save_pre_taxonomy_{$taxonomy}&quot;, $data, $pod, $id, $groups, $term_id, $term_taxonomy_id, $taxonomy, $is_new_item );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        pods_no_conflict_on( 'taxonomy' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !empty( $pod ) ) {&nbsp;</div></li><li><div>            // Fix for Pods doing it's own sanitization&nbsp;</div></li><li><div>            $data = pods_unslash( (array) $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod-&gt;save( $data, null, null, array( 'is_new_item' =&gt; $is_new_item ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        pods_no_conflict_off( 'taxonomy' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $is_new_item ) {&nbsp;</div></li><li><div>            do_action( 'pods_meta_create_taxonomy', $data, $pod, $id, $groups, $term_id, $term_taxonomy_id, $taxonomy );&nbsp;</div></li><li><div>            do_action( &quot;pods_meta_create_taxonomy_{$taxonomy}&quot;, $data, $pod, $id, $groups, $term_id, $term_taxonomy_id, $taxonomy );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_save_taxonomy', $data, $pod, $id, $groups, $term_id, $term_taxonomy_id, $taxonomy, $is_new_item );&nbsp;</div></li><li><div>        do_action( &quot;pods_meta_save_taxonomy_{$taxonomy}&quot;, $data, $pod, $id, $groups, $term_id, $term_taxonomy_id, $taxonomy, $is_new_item );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $term_id;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $user_id&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function meta_user ( $user_id ) {&nbsp;</div></li><li><div>        wp_enqueue_style( 'pods-form' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_' . __FUNCTION__, $user_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $groups = $this-&gt;groups_get( 'user', 'user' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_object( $user_id ) )&nbsp;</div></li><li><div>            $user_id = $user_id-&gt;ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $id = $user_id;&nbsp;</div></li><li><div>        $pod = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $groups as $group ) {&nbsp;</div></li><li><div>            if ( empty( $group[ 'fields' ] ) )&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( null === $pod || ( is_object( $pod ) && $pod-&gt;id() != $id ) ) {&nbsp;</div></li><li><div>                if ( !is_object( self::$current_pod ) || self::$current_pod-&gt;pod != $group[ 'pod' ][ 'name' ] )&nbsp;</div></li><li><div>                    self::$current_pod = pods( $group[ 'pod' ][ 'name' ], $id, true );&nbsp;</div></li><li><div>                elseif ( self::$current_pod-&gt;id() != $id )&nbsp;</div></li><li><div>                    self::$current_pod-&gt;fetch( $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $pod = self::$current_pod;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $hidden_fields = array();&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>    &lt;h3&gt;&lt;?php echo $group[ 'label' ]; ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    &lt;?php echo PodsForm::field( 'pods_meta', wp_create_nonce( 'pods_meta_user' ), 'hidden' ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    &lt;table class=&quot;form-table pods-meta&quot;&gt;&nbsp;</div></li><li><div>        &lt;tbody&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>                foreach ( $group[ 'fields' ] as $field ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( false === PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field, $group[ 'fields' ], $pod, $id ) ) {&nbsp;</div></li><li><div>                        if ( pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                            $field[ 'type' ] = 'hidden';&nbsp;</div></li><li><div>                        else&nbsp;</div></li><li><div>                            continue;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    elseif ( !pods_has_permissions( $field[ 'options' ] ) && pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                        $field[ 'type' ] = 'hidden';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $value = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( !empty( $pod ) )&nbsp;</div></li><li><div>                        $value = $pod-&gt;field( array( 'name' =&gt; $field[ 'name' ], 'in_form' =&gt; true ) );&nbsp;</div></li><li><div>                    elseif ( !empty( $id ) ) {&nbsp;</div></li><li><div>                        pods_no_conflict_on( 'user' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        $value = get_user_meta( $id, $field[ 'name' ], true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        pods_no_conflict_off( 'user' );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( 'hidden' == $field[ 'type' ] ) {&nbsp;</div></li><li><div>                        $hidden_fields[] = array(&nbsp;</div></li><li><div>                            'field' =&gt; $field, &nbsp;</div></li><li><div>                            'value' =&gt; $value&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    else {&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>                &lt;tr class=&quot;form-field pods-field &lt;?php echo esc_attr( 'pods-form-ui-row-type-' . $field[ 'type' ] . ' pods-form-ui-row-name-' . PodsForm::clean( $field[ 'name' ], true ) ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                    &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;?php echo PodsForm::label( 'pods_meta_' . $field[ 'name' ], $field[ 'label' ], $field[ 'help' ], $field ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                    &lt;td&gt;&nbsp;</div></li><li><div>                        &lt;?php echo PodsForm::field( 'pods_meta_' . $field[ 'name' ], $value, $field[ 'type' ], $field, $pod, $id ); ?&gt;&nbsp;</div></li><li><div>                        &lt;?php echo PodsForm::comment( 'pods_meta_' . $field[ 'name' ], $field[ 'description' ], $field ); ?&gt;&nbsp;</div></li><li><div>                    &lt;/td&gt;&nbsp;</div></li><li><div>                &lt;/tr&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>        &lt;/tbody&gt;&nbsp;</div></li><li><div>    &lt;/table&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>            foreach ( $hidden_fields as $hidden_field ) {&nbsp;</div></li><li><div>                $field = $hidden_field[ 'field' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                echo PodsForm::field( 'pods_meta_' . $field[ 'name' ], $hidden_field[ 'value' ], 'hidden' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_' . __FUNCTION__ . '_post', $user_id );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $user_id&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function save_user ( $user_id ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $is_new_item = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( 'user_register' == current_filter() ) {&nbsp;</div></li><li><div>            $is_new_item = true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $_POST ) ) {&nbsp;</div></li><li><div>            return $user_id;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( $is_new_item || !wp_verify_nonce( pods_v( 'pods_meta', 'post' ), 'pods_meta_user' ) ) {&nbsp;</div></li><li><div>            return $user_id;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $groups = $this-&gt;groups_get( 'user', 'user' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $groups ) ) {&nbsp;</div></li><li><div>            return $user_id;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_object( $user_id ) ) {&nbsp;</div></li><li><div>            $user_id = $user_id-&gt;ID;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $data = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $id = $user_id;&nbsp;</div></li><li><div>        $pod = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $groups as $group ) {&nbsp;</div></li><li><div>            if ( empty( $group[ 'fields' ] ) ) {&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( null === $pod || ( is_object( $pod ) && $pod-&gt;id() != $id ) ) {&nbsp;</div></li><li><div>                if ( !is_object( self::$current_pod ) || self::$current_pod-&gt;pod != $group[ 'pod' ][ 'name' ] ) {&nbsp;</div></li><li><div>                    self::$current_pod = pods( $group[ 'pod' ][ 'name' ], $id, true );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                elseif ( self::$current_pod-&gt;id() != $id ) {&nbsp;</div></li><li><div>                    self::$current_pod-&gt;fetch( $id );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $pod = self::$current_pod;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $group[ 'fields' ] as $field ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( false === PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field, $group[ 'fields' ], $pod, $id ) ) {&nbsp;</div></li><li><div>                    if ( !pods_var( 'hidden', $field[ 'options' ], false ) ) {&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $data[ $field[ 'name' ] ] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( isset( $_POST[ 'pods_meta_' . $field[ 'name' ] ] ) ) {&nbsp;</div></li><li><div>                    $data[ $field[ 'name' ] ] = $_POST[ 'pods_meta_' . $field[ 'name' ] ];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $is_new_item ) {&nbsp;</div></li><li><div>            do_action( 'pods_meta_create_pre_user', $data, $pod, $id, $groups );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_save_pre_user', $data, $pod, $id, $groups, $is_new_item );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        pods_no_conflict_on( 'user' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !empty( $pod ) ) {&nbsp;</div></li><li><div>            // Fix for Pods doing it's own sanitization&nbsp;</div></li><li><div>            $data = pods_unslash( (array) $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod-&gt;save( $data, null, null, array( 'is_new_item' =&gt; $is_new_item ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( !empty( $id ) ) {&nbsp;</div></li><li><div>            foreach ( $data as $field =&gt; $value ) {&nbsp;</div></li><li><div>                update_user_meta( $id, $field, $value );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        pods_no_conflict_off( 'user' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $is_new_item ) {&nbsp;</div></li><li><div>            do_action( 'pods_meta_create_user', $data, $pod, $id, $groups );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_save_user', $data, $pod, $id, $groups, $is_new_item );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $user_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $commenter&nbsp;</div></li><li><div>     * @param $user_identity&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function meta_comment_new_logged_in ( $commenter, $user_identity ) {&nbsp;</div></li><li><div>        wp_enqueue_style( 'pods-form' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_' . __FUNCTION__, $commenter, $user_identity );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $groups = $this-&gt;groups_get( 'comment', 'comment' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $id = null;&nbsp;</div></li><li><div>        $pod = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo PodsForm::field( 'pods_meta', wp_create_nonce( 'pods_meta_comment' ), 'hidden' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $groups as $group ) {&nbsp;</div></li><li><div>            if ( empty( $group[ 'fields' ] ) )&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( null === $pod || ( is_object( $pod ) && $pod-&gt;id() != $id ) ) {&nbsp;</div></li><li><div>                if ( !is_object( self::$current_pod ) || self::$current_pod-&gt;pod != $group[ 'pod' ][ 'name' ] )&nbsp;</div></li><li><div>                    self::$current_pod = pods( $group[ 'pod' ][ 'name' ], $id, true );&nbsp;</div></li><li><div>                elseif ( self::$current_pod-&gt;id() != $id )&nbsp;</div></li><li><div>                    self::$current_pod-&gt;fetch( $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $pod = self::$current_pod;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $group[ 'fields' ] as $field ) {&nbsp;</div></li><li><div>                if ( false === PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field, $group[ 'fields' ], $pod, $id ) ) {&nbsp;</div></li><li><div>                    if ( pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                        $field[ 'type' ] = 'hidden';&nbsp;</div></li><li><div>                    else&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                elseif ( !pods_has_permissions( $field[ 'options' ] ) && pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                    $field[ 'type' ] = 'hidden';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $value = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( !empty( $pod ) )&nbsp;</div></li><li><div>                    $value = $pod-&gt;field( array( 'name' =&gt; $field[ 'name' ], 'in_form' =&gt; true ) );&nbsp;</div></li><li><div>                elseif ( !empty( $id ) ) {&nbsp;</div></li><li><div>                    pods_no_conflict_on( 'comment' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $value = get_comment_meta( $id, $field[ 'name' ], true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    pods_no_conflict_off( 'comment' );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>            &lt;p class=&quot;comment-form-author comment-form-pods-meta-&lt;?php echo esc_attr( $field[ 'name' ] ); ?&gt;  pods-field&quot; style=&quot;&lt;?php echo esc_attr( 'hidden' == $field[ 'type' ] ? 'display:none;' : '' ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                    echo PodsForm::label( 'pods_meta_' . $field[ 'name' ], $field[ 'label' ], $field[ 'help' ], $field );&nbsp;</div></li><li><div>                    echo PodsForm::field( 'pods_meta_' . $field[ 'name' ], $value, $field[ 'type' ], $field, $pod, $id );&nbsp;</div></li><li><div>                    echo PodsForm::comment( 'pods_meta_' . $field[ 'name' ], $field[ 'description' ], $field );&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>            &lt;/p&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_' . __FUNCTION__ . '_post', $commenter, $user_identity );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $form_fields&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function meta_comment_new ( $form_fields ) {&nbsp;</div></li><li><div>        wp_enqueue_style( 'pods-form' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $groups = $this-&gt;groups_get( 'comment', 'comment' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $id = null;&nbsp;</div></li><li><div>        $pod = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $form_fields[ 'pods_meta' ] = PodsForm::field( 'pods_meta', wp_create_nonce( 'pods_meta_comment' ), 'hidden' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $groups as $group ) {&nbsp;</div></li><li><div>            if ( empty( $group[ 'fields' ] ) )&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( null === $pod || ( is_object( $pod ) && $pod-&gt;id() != $id ) ) {&nbsp;</div></li><li><div>                if ( !is_object( self::$current_pod ) || self::$current_pod-&gt;pod != $group[ 'pod' ][ 'name' ] )&nbsp;</div></li><li><div>                    self::$current_pod = pods( $group[ 'pod' ][ 'name' ], $id, true );&nbsp;</div></li><li><div>                elseif ( self::$current_pod-&gt;id() != $id )&nbsp;</div></li><li><div>                    self::$current_pod-&gt;fetch( $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $pod = self::$current_pod;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $group[ 'fields' ] as $field ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( false === PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field, $group[ 'fields' ], $pod, $id ) ) {&nbsp;</div></li><li><div>                    if ( pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                        $field[ 'type' ] = 'hidden';&nbsp;</div></li><li><div>                    else&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                elseif ( !pods_has_permissions( $field[ 'options' ] ) && pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                    $field[ 'type' ] = 'hidden';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $value = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( !empty( $pod ) )&nbsp;</div></li><li><div>                    $value = $pod-&gt;field( array( 'name' =&gt; $field[ 'name' ], 'in_form' =&gt; true ) );&nbsp;</div></li><li><div>                elseif ( !empty( $id ) ) {&nbsp;</div></li><li><div>                    pods_no_conflict_on( 'comment' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $value = get_comment_meta( $id, $field[ 'name' ], true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    pods_no_conflict_off( 'comment' );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                ob_start();&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>            &lt;p class=&quot;comment-form-author comment-form-pods-meta-&lt;?php echo esc_attr( $field[ 'name' ] ); ?&gt; pods-field&quot; style=&quot;&lt;?php echo esc_attr( 'hidden' == $field[ 'type' ] ? 'display:none;' : '' ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                    echo PodsForm::label( 'pods_meta_' . $field[ 'name' ], $field[ 'label' ], $field[ 'help' ], $field );&nbsp;</div></li><li><div>                    echo PodsForm::field( 'pods_meta_' . $field[ 'name' ], $value, $field[ 'type' ], $field, $pod, $id );&nbsp;</div></li><li><div>                    echo PodsForm::comment( 'pods_meta_' . $field[ 'name' ], $field[ 'description' ], $field );&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>            &lt;/p&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>                $form_fields[ 'pods_meta_' . $field[ 'name' ] ] = ob_get_clean();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $form_fields = apply_filters( 'pods_meta_' . __FUNCTION__, $form_fields );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $form_fields;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $comment_type&nbsp;</div></li><li><div>     * @param null $comment&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function meta_comment_add ( $comment_type, $comment = null ) {&nbsp;</div></li><li><div>        if ( is_object( $comment ) && isset( $comment_type-&gt;comment_type ) )&nbsp;</div></li><li><div>            $comment_type = $comment-&gt;comment_type;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_object( $comment_type ) && isset( $comment_type-&gt;comment_type ) ) {&nbsp;</div></li><li><div>            $comment = $comment_type;&nbsp;</div></li><li><div>            $comment_type = $comment_type-&gt;comment_type;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_object( $comment_type ) )&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        elseif ( empty( $comment_type ) )&nbsp;</div></li><li><div>            $comment_type = 'comment';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $groups = $this-&gt;groups_get( 'comment', $comment_type );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $groups as $group ) {&nbsp;</div></li><li><div>            if ( empty( $group[ 'fields' ] ) )&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $field_found = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $group[ 'fields' ] as $field ) {&nbsp;</div></li><li><div>                if ( false === PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field, $group[ 'fields' ], null, null ) ) {&nbsp;</div></li><li><div>                    if ( pods_var( 'hidden', $field[ 'options' ], false ) ) {&nbsp;</div></li><li><div>                        $field_found = true;&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    else {&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                else {&nbsp;</div></li><li><div>                    $field_found = true;&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $field_found ) {&nbsp;</div></li><li><div>                add_meta_box(&nbsp;</div></li><li><div>                    'pods-meta-' . sanitize_title( $group[ 'label' ] ), &nbsp;</div></li><li><div>                    $group[ 'label' ], &nbsp;</div></li><li><div>                    array( $this, 'meta_comment' ), &nbsp;</div></li><li><div>                    $comment_type, &nbsp;</div></li><li><div>                    $group[ 'context' ], &nbsp;</div></li><li><div>                    $group[ 'priority' ], &nbsp;</div></li><li><div>                    array( 'group' =&gt; $group )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $comment&nbsp;</div></li><li><div>     * @param $metabox&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function meta_comment ( $comment, $metabox ) {&nbsp;</div></li><li><div>        wp_enqueue_style( 'pods-form' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_' . __FUNCTION__, $comment, $metabox );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $hidden_fields = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo PodsForm::field( 'pods_meta', wp_create_nonce( 'pods_meta_comment' ), 'hidden' );&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>    &lt;table class=&quot;form-table editcomment pods-metabox&quot;&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>            $id = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( is_object( $comment ) )&nbsp;</div></li><li><div>                $id = $comment-&gt;comment_ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( !is_object( self::$current_pod ) || self::$current_pod-&gt;pod != $metabox[ 'args' ][ 'group' ][ 'pod' ][ 'name' ] )&nbsp;</div></li><li><div>                self::$current_pod = pods( $metabox[ 'args' ][ 'group' ][ 'pod' ][ 'name' ], $id, true );&nbsp;</div></li><li><div>            elseif ( self::$current_pod-&gt;id() != $id )&nbsp;</div></li><li><div>                self::$current_pod-&gt;fetch( $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod = self::$current_pod;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $metabox[ 'args' ][ 'group' ][ 'fields' ] as $field ) {&nbsp;</div></li><li><div>                if ( false === PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field, $metabox[ 'args' ][ 'group' ][ 'fields' ], $pod, $id ) ) {&nbsp;</div></li><li><div>                    if ( pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                        $field[ 'type' ] = 'hidden';&nbsp;</div></li><li><div>                    else&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                elseif ( !pods_has_permissions( $field[ 'options' ] ) && pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                    $field[ 'type' ] = 'hidden';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $value = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( !empty( $pod ) )&nbsp;</div></li><li><div>                    $value = $pod-&gt;field( array( 'name' =&gt; $field[ 'name' ], 'in_form' =&gt; true ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( 'hidden' == $field[ 'type' ] ) {&nbsp;</div></li><li><div>                    $hidden_fields[] = array(&nbsp;</div></li><li><div>                        'field' =&gt; $field, &nbsp;</div></li><li><div>                        'value' =&gt; $value&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                else {&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>            &lt;tr class=&quot;form-field pods-field &lt;?php echo esc_attr( 'pods-form-ui-row-type-' . $field[ 'type' ] . ' pods-form-ui-row-name-' . PodsForm::clean( $field[ 'name' ], true ) ); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;?php echo PodsForm::label( 'pods_meta_' . $field[ 'name' ], $field[ 'label' ], $field[ 'help' ], $field ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                &lt;td&gt;&nbsp;</div></li><li><div>                    &lt;?php echo PodsForm::field( 'pods_meta_' . $field[ 'name' ], $value, $field[ 'type' ], $field, $pod, $id ); ?&gt;&nbsp;</div></li><li><div>                    &lt;?php echo PodsForm::comment( 'pods_meta_' . $field[ 'name' ], $field[ 'description' ], $field ); ?&gt;&nbsp;</div></li><li><div>                &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>    &lt;/table&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>        foreach ( $hidden_fields as $hidden_field ) {&nbsp;</div></li><li><div>            $field = $hidden_field[ 'field' ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            echo PodsForm::field( 'pods_meta_' . $field[ 'name' ], $hidden_field[ 'value' ], 'hidden' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_' . __FUNCTION__ . '_post', $comment, $metabox );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $approved&nbsp;</div></li><li><div>     * @param $commentdata&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function validate_comment ( $approved, $commentdata ) {&nbsp;</div></li><li><div>        $groups = $this-&gt;groups_get( 'comment', 'comment' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $groups ) )&nbsp;</div></li><li><div>            return $approved;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $data = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod = null;&nbsp;</div></li><li><div>        $id = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $groups as $group ) {&nbsp;</div></li><li><div>            if ( empty( $group[ 'fields' ] ) )&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( null === $pod || ( is_object( $pod ) && $pod-&gt;id() != $id ) ) {&nbsp;</div></li><li><div>                if ( !is_object( self::$current_pod ) || self::$current_pod-&gt;pod != $group[ 'pod' ][ 'name' ] )&nbsp;</div></li><li><div>                    self::$current_pod = pods( $group[ 'pod' ][ 'name' ], $id, true );&nbsp;</div></li><li><div>                elseif ( self::$current_pod-&gt;id() != $id )&nbsp;</div></li><li><div>                    self::$current_pod-&gt;fetch( $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $pod = self::$current_pod;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $group[ 'fields' ] as $field ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( false === PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field, $group[ 'fields' ], $pod, $id ) ) {&nbsp;</div></li><li><div>                    if ( !pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $data[ $field[ 'name' ] ] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( isset( $_POST[ 'pods_meta_' . $field[ 'name' ] ] ) )&nbsp;</div></li><li><div>                    $data[ $field[ 'name' ] ] = $_POST[ 'pods_meta_' . $field[ 'name' ] ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $validate = pods_api()-&gt;handle_field_validation( $data[ $field[ 'name' ] ], $field[ 'name' ], pods_api()-&gt;get_wp_object_fields( 'comment' ), $pod-&gt;fields(), $pod, array() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( false === $validate )&nbsp;</div></li><li><div>                    $validate = sprintf( __( 'There was an issue validating the field %s', 'pods' ), $field[ 'label' ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( !is_bool( $validate ) && !empty( $validate ) )&nbsp;</div></li><li><div>                    return pods_error( $validate, $this );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $approved;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $comment_id&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function save_comment ( $comment_id ) {&nbsp;</div></li><li><div>        $groups = $this-&gt;groups_get( 'comment', 'comment' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $groups ) ) {&nbsp;</div></li><li><div>            return $comment_id;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( empty( $_POST ) ) {&nbsp;</div></li><li><div>            return $comment_id;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( !wp_verify_nonce( pods_v( 'pods_meta', 'post' ), 'pods_meta_comment' ) ) {&nbsp;</div></li><li><div>            return $comment_id;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $data = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $id = $comment_id;&nbsp;</div></li><li><div>        $pod = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $groups as $group ) {&nbsp;</div></li><li><div>            if ( empty( $group[ 'fields' ] ) )&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( null === $pod || ( is_object( $pod ) && $pod-&gt;id() != $id ) ) {&nbsp;</div></li><li><div>                if ( !is_object( self::$current_pod ) || self::$current_pod-&gt;pod != $group[ 'pod' ][ 'name' ] )&nbsp;</div></li><li><div>                    self::$current_pod = pods( $group[ 'pod' ][ 'name' ], $id, true );&nbsp;</div></li><li><div>                elseif ( self::$current_pod-&gt;id() != $id )&nbsp;</div></li><li><div>                    self::$current_pod-&gt;fetch( $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $pod = self::$current_pod;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $group[ 'fields' ] as $field ) {&nbsp;</div></li><li><div>                if ( false === PodsForm::permission( $field[ 'type' ], $field[ 'name' ], $field, $group[ 'fields' ], $pod, $id ) ) {&nbsp;</div></li><li><div>                    if ( !pods_var( 'hidden', $field[ 'options' ], false ) )&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $data[ $field[ 'name' ] ] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( isset( $_POST[ 'pods_meta_' . $field[ 'name' ] ] ) )&nbsp;</div></li><li><div>                    $data[ $field[ 'name' ] ] = $_POST[ 'pods_meta_' . $field[ 'name' ] ];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_save_pre_comment', $data, $pod, $id, $groups );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !empty( $pod ) ) {&nbsp;</div></li><li><div>            // Fix for Pods doing it's own sanitization&nbsp;</div></li><li><div>            $data = pods_unslash( (array) $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod-&gt;save( $data );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( !empty( $id ) ) {&nbsp;</div></li><li><div>            pods_no_conflict_on( 'comment' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $data as $field =&gt; $value ) {&nbsp;</div></li><li><div>                update_comment_meta( $id, $field, $value );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            pods_no_conflict_off( 'comment' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'pods_meta_save_comment', $data, $pod, $id, $groups );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $comment_id;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * All *_*_meta filter handler aliases&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function get_post_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'post_type' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_get_post_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'get_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function get_user_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'user' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_get_user_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'get_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function get_comment_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'comment' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_get_comment_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'get_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function get_term_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'term' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_get_term_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'get_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * All *_*_meta filter handler aliases&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function get_option () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_get_option', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'get_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function add_post_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'post_type' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_add_post_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'add_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function add_user_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'user' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_add_user_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'add_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function add_comment_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'comment' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_add_comment_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'add_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function add_term_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'term' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_add_term_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'add_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function add_option () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_add_option', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'add_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function update_post_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'post_type' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_update_post_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'update_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function update_user_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'user' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_update_user_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'update_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function update_comment_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'comment' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_update_comment_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'update_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function update_term_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'term' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_update_term_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'update_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function update_option () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_update_option', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'update_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function delete_post_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'post_type' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_delete_post_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'delete_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function delete_user_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'user' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_delete_user_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'delete_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function delete_comment_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'comment' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_delete_comment_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'delete_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function delete_term_meta () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'term' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_delete_term_meta', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'delete_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function delete_option () {&nbsp;</div></li><li><div>        $args = func_get_args();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $args, 'settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $_null = apply_filters( 'pods_meta_delete_option', null, $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( null !== $_null )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return call_user_func_array( array( $this, 'delete_meta' ), $args );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * The real meta functions&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $object_type&nbsp;</div></li><li><div>     * @param $object_id&nbsp;</div></li><li><div>     * @param string $aux&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return bool|mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function get_object ( $object_type, $object_id, $aux = '' ) {&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        if ( 'term' == $object_type ) {&nbsp;</div></li><li><div>            $object_type = 'taxonomy';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        if ( 'post_type' == $object_type )&nbsp;</div></li><li><div>            $objects = self::$post_types;&nbsp;</div></li><li><div>        elseif ( 'taxonomy' == $object_type )&nbsp;</div></li><li><div>            $objects = self::$taxonomies;&nbsp;</div></li><li><div>        elseif ( 'media' == $object_type )&nbsp;</div></li><li><div>            $objects = self::$media;&nbsp;</div></li><li><div>        elseif ( 'user' == $object_type )&nbsp;</div></li><li><div>            $objects = self::$user;&nbsp;</div></li><li><div>        elseif ( 'comment' == $object_type )&nbsp;</div></li><li><div>            $objects = self::$comment;&nbsp;</div></li><li><div>        elseif ( 'settings' == $object_type )&nbsp;</div></li><li><div>            $objects = self::$settings;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $objects ) || !is_array( $objects ) )&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $object_name = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( 'media' == $object_type )&nbsp;</div></li><li><div>            return @current( $objects );&nbsp;</div></li><li><div>        elseif ( 'user' == $object_type )&nbsp;</div></li><li><div>            return @current( $objects );&nbsp;</div></li><li><div>        elseif ( 'comment' == $object_type )&nbsp;</div></li><li><div>            return @current( $objects );&nbsp;</div></li><li><div>        elseif ( 'post_type' == $object_type ) {&nbsp;</div></li><li><div>            $object = get_post( $object_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( !is_object( $object ) || !isset( $object-&gt;post_type ) )&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $object_name = $object-&gt;post_type;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( 'taxonomy' == $object_type ) {&nbsp;</div></li><li><div>            if ( pods_version_check( 'wp', '4.4' ) ) {&nbsp;</div></li><li><div>                $object = get_term( $object_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( !is_object( $object ) || !isset( $object-&gt;taxonomy ) )&nbsp;</div></li><li><div>                    return false;&nbsp;</div></li><li><div>                &nbsp;</div></li><li><div>                $object_name = $object-&gt;taxonomy;&nbsp;</div></li><li><div>            } elseif ( empty( $aux ) ) {&nbsp;</div></li><li><div>                $object_name = $wpdb-&gt;get_var( $wpdb-&gt;prepare( &quot;SELECT `taxonomy` FROM `{$wpdb-&gt;term_taxonomy}` WHERE `term_id` = %d&quot;, $object_id ) );&nbsp;</div></li><li><div>            } else { &nbsp;</div></li><li><div>                $object_name = $aux;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( 'settings' == $object_type )&nbsp;</div></li><li><div>            $object = $object_id;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $reserved_post_types = array(&nbsp;</div></li><li><div>            'revision'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $reserved_post_types = apply_filters( 'pods_meta_reserved_post_types', $reserved_post_types, $object_type, $object_id, $object_name, $objects );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $object_name ) || ( 'post_type' == $object_type && ( 0 === strpos( $object_name, '_pods_' ) ) || in_array( $object_name, $reserved_post_types ) ) ) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        elseif ( 'attachment' == $object_name ) {&nbsp;</div></li><li><div>            return @current( self::$media );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $recheck = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Return first created by Pods, save extended for later&nbsp;</div></li><li><div>        foreach ( $objects as $pod ) {&nbsp;</div></li><li><div>            if ( $object_name == $pod[ 'object' ] )&nbsp;</div></li><li><div>                $recheck[] = $pod;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( '' == $pod[ 'object' ] && $object_name == $pod[ 'name' ] )&nbsp;</div></li><li><div>                return $pod;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // If no objects created by Pods, return first extended&nbsp;</div></li><li><div>        foreach ( $recheck as $pod ) {&nbsp;</div></li><li><div>            return $pod;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $object_type&nbsp;</div></li><li><div>     * @param null $_null&nbsp;</div></li><li><div>     * @param int $object_id&nbsp;</div></li><li><div>     * @param string $meta_key&nbsp;</div></li><li><div>     * @param bool $single&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return array|bool|int|mixed|null|string|void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function get_meta ( $object_type, $_null = null, $object_id = 0, $meta_key = '', $single = false ) {&nbsp;</div></li><li><div>        $meta_type = $object_type;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( in_array( $meta_type, array( 'post_type', 'media' ) ) )&nbsp;</div></li><li><div>            $meta_type = 'post';&nbsp;</div></li><li><div>        elseif ( 'taxonomy' == $meta_type )&nbsp;</div></li><li><div>            $meta_type = 'term';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $meta_key ) ) {&nbsp;</div></li><li><div>            if ( !defined( 'PODS_ALLOW_FULL_META' ) || !PODS_ALLOW_FULL_META ) {&nbsp;</div></li><li><div>                return $_null; // don't cover get_post_meta( $id )&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $single = false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $object = $this-&gt;get_object( $object_type, $object_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $object_id ) || empty( $object ) )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $no_conflict = pods_no_conflict_check( $meta_type );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !$no_conflict )&nbsp;</div></li><li><div>            pods_no_conflict_on( $meta_type );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $meta_cache = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !$single && isset( $GLOBALS[ 'wp_object_cache' ] ) && is_object( $GLOBALS[ 'wp_object_cache' ] ) ) {&nbsp;</div></li><li><div>            $meta_cache = wp_cache_get( $object_id, 'pods_' . $meta_type . '_meta' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( empty( $meta_cache ) ) {&nbsp;</div></li><li><div>                $meta_cache = wp_cache_get( $object_id, $meta_type . '_meta' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( empty( $meta_cache ) ) {&nbsp;</div></li><li><div>                    $meta_cache = update_meta_cache( $meta_type, array( $object_id ) );&nbsp;</div></li><li><div>                    $meta_cache = $meta_cache[ $object_id ];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $meta_cache ) || !is_array( $meta_cache ) )&nbsp;</div></li><li><div>            $meta_cache = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !is_object( self::$current_field_pod ) || self::$current_field_pod-&gt;pod != $object[ 'name' ] )&nbsp;</div></li><li><div>            self::$current_field_pod = pods( $object[ 'name' ], $object_id );&nbsp;</div></li><li><div>        elseif ( self::$current_field_pod-&gt;id() != $object_id )&nbsp;</div></li><li><div>            self::$current_field_pod-&gt;fetch( $object_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod = self::$current_field_pod;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $meta_keys = array( $meta_key );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $meta_key ) )&nbsp;</div></li><li><div>            $meta_keys = array_keys( $meta_cache );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $key_found = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $meta_keys as $meta_k ) {&nbsp;</div></li><li><div>            if ( !empty( $pod ) ) {&nbsp;</div></li><li><div>                if ( isset( $pod-&gt;fields[ $meta_k ] ) ) {&nbsp;</div></li><li><div>                    $key_found = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $meta_cache[ $meta_k ] = $pod-&gt;field( array( 'name' =&gt; $meta_k, 'single' =&gt; $single, 'get_meta' =&gt; true ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( ( !is_array( $meta_cache[ $meta_k ] ) || !isset( $meta_cache[ $meta_k ][ 0 ] ) ) ) {&nbsp;</div></li><li><div>                        if ( empty( $meta_cache[ $meta_k ] ) && !is_array( $meta_cache[ $meta_k ] ) && $single )&nbsp;</div></li><li><div>                            $meta_cache[ $meta_k ] = array();&nbsp;</div></li><li><div>                        else&nbsp;</div></li><li><div>                            $meta_cache[ $meta_k ] = array( $meta_cache[ $meta_k ] );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( in_array( $pod-&gt;fields[ $meta_k ][ 'type' ], PodsForm::tableless_field_types() ) && isset( $meta_cache[ '_pods_' . $meta_k ] ) )&nbsp;</div></li><li><div>                        unset( $meta_cache[ '_pods_' . $meta_k ] );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                elseif ( false !== strpos( $meta_k, '.' ) ) {&nbsp;</div></li><li><div>                    $key_found = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $first = current( explode( '.', $meta_k ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( isset( $pod-&gt;fields[ $first ] ) ) {&nbsp;</div></li><li><div>                        $meta_cache[ $meta_k ] = $pod-&gt;field( array( 'name' =&gt; $meta_k, 'single' =&gt; $single, 'get_meta' =&gt; true ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        if ( ( !is_array( $meta_cache[ $meta_k ] ) || !isset( $meta_cache[ $meta_k ][ 0 ] ) ) && $single ) {&nbsp;</div></li><li><div>                            if ( empty( $meta_cache[ $meta_k ] ) && !is_array( $meta_cache[ $meta_k ] ) && $single )&nbsp;</div></li><li><div>                                $meta_cache[ $meta_k ] = array();&nbsp;</div></li><li><div>                            else&nbsp;</div></li><li><div>                                $meta_cache[ $meta_k ] = array( $meta_cache[ $meta_k ] );&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        if ( in_array( $pod-&gt;fields[ $first ][ 'type' ], PodsForm::tableless_field_types() ) && isset( $meta_cache[ '_pods_' . $first ] ) )&nbsp;</div></li><li><div>                            unset( $meta_cache[ '_pods_' . $first ] );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !$no_conflict )&nbsp;</div></li><li><div>            pods_no_conflict_off( $meta_type );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        unset( $pod ); // memory clear&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !$key_found )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !$single && isset( $GLOBALS[ 'wp_object_cache' ] ) && is_object( $GLOBALS[ 'wp_object_cache' ] ) )&nbsp;</div></li><li><div>            wp_cache_set( $object_id, $meta_cache, 'pods_' . $meta_type . '_meta' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $meta_key ) )&nbsp;</div></li><li><div>            return $meta_cache;&nbsp;</div></li><li><div>        elseif ( isset( $meta_cache[ $meta_key ] ) )&nbsp;</div></li><li><div>            $value = $meta_cache[ $meta_key ];&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $value = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !is_numeric( $value ) && empty( $value ) ) {&nbsp;</div></li><li><div>            if ( $single )&nbsp;</div></li><li><div>                $value = '';&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                $value = array();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // get_metadata requires $meta[ 0 ] to be set for first value to be retrieved&nbsp;</div></li><li><div>        elseif ( !is_array( $value ) )&nbsp;</div></li><li><div>            $value = array( $value );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $value;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $object_type&nbsp;</div></li><li><div>     * @param null $_null&nbsp;</div></li><li><div>     * @param int $object_id&nbsp;</div></li><li><div>     * @param string $meta_key&nbsp;</div></li><li><div>     * @param string $meta_value&nbsp;</div></li><li><div>     * @param bool $unique&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return bool|int|null&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function add_meta ( $object_type, $_null = null, $object_id = 0, $meta_key = '', $meta_value = '', $unique = false ) {&nbsp;</div></li><li><div>        if ( pods_tableless() )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $object = $this-&gt;get_object( $object_type, $object_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $object_id ) || empty( $object ) || !isset( $object[ 'fields' ][ $meta_key ] ) )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( in_array( $object[ 'fields' ][ $meta_key ][ 'type' ], PodsForm::tableless_field_types() ) ) {&nbsp;</div></li><li><div>            if ( !is_object( self::$current_field_pod ) || self::$current_field_pod-&gt;pod != $object[ 'name' ] )&nbsp;</div></li><li><div>                self::$current_field_pod = pods( $object[ 'name' ], $object_id );&nbsp;</div></li><li><div>            elseif ( self::$current_field_pod-&gt;id() != $object_id )&nbsp;</div></li><li><div>                self::$current_field_pod-&gt;fetch( $object_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod = self::$current_field_pod;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod-&gt;add_to( $meta_key, $meta_value );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else {&nbsp;</div></li><li><div>            if ( !is_object( self::$current_field_pod ) || self::$current_field_pod-&gt;pod != $object[ 'name' ] )&nbsp;</div></li><li><div>                self::$current_field_pod = pods( $object[ 'name' ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod = self::$current_field_pod;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod-&gt;save( $meta_key, $meta_value, $object_id );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $object_id;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $object_type&nbsp;</div></li><li><div>     * @param null $_null&nbsp;</div></li><li><div>     * @param int $object_id&nbsp;</div></li><li><div>     * @param string $meta_key&nbsp;</div></li><li><div>     * @param string $meta_value&nbsp;</div></li><li><div>     * @param string $prev_value&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return bool|int|null&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function update_meta ( $object_type, $_null = null, $object_id = 0, $meta_key = '', $meta_value = '', $prev_value = '' ) {&nbsp;</div></li><li><div>        if ( pods_tableless() )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $object = $this-&gt;get_object( $object_type, $object_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $object_id ) || empty( $object ) || !isset( $object[ 'fields' ][ $meta_key ] ) )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !is_object( self::$current_field_pod ) || self::$current_field_pod-&gt;pod != $object[ 'name' ] )&nbsp;</div></li><li><div>            self::$current_field_pod = pods( $object[ 'name' ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod = self::$current_field_pod;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ( isset( $pod-&gt;fields[ $meta_key ] ) || false !== strpos( $meta_key, '.' ) ) && $pod-&gt;row !== null) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $key = $meta_key;&nbsp;</div></li><li><div>            if(false !== strpos( $meta_key, '.' )) {&nbsp;</div></li><li><div>                $key = current( explode( '.', $meta_key ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod-&gt;row[ $meta_key ] = $meta_value;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( isset( $pod-&gt;fields[ $key ] ) ) {&nbsp;</div></li><li><div>                if ( in_array( $pod-&gt;fields[ $key ][ 'type' ], PodsForm::tableless_field_types() ) && isset( $meta_cache[ '_pods_' . $key ] ) )&nbsp;</div></li><li><div>                    unset( $meta_cache[ '_pods_' . $key ] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pod-&gt;save( $meta_key, $meta_value, $object_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $object_id;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @param $object_type&nbsp;</div></li><li><div>     * @param null $_null&nbsp;</div></li><li><div>     * @param int $object_id&nbsp;</div></li><li><div>     * @param string $meta_key&nbsp;</div></li><li><div>     * @param string $meta_value&nbsp;</div></li><li><div>     * @param bool $delete_all&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return null&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function delete_meta ( $object_type, $_null = null, $object_id = 0, $meta_key = '', $meta_value = '', $delete_all = false ) {&nbsp;</div></li><li><div>        if ( pods_tableless() )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $object = $this-&gt;get_object( $object_type, $object_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $object_id ) || empty( $object ) || !isset( $object[ 'fields' ][ $meta_key ] ) )&nbsp;</div></li><li><div>            return $_null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // @todo handle $delete_all (delete the field values from all pod items)&nbsp;</div></li><li><div>        if ( !empty( $meta_value ) && in_array( $object[ 'fields' ][ $meta_key ][ 'type' ], PodsForm::tableless_field_types() ) ) {&nbsp;</div></li><li><div>            if ( !is_object( self::$current_field_pod ) || self::$current_field_pod-&gt;pod != $object[ 'name' ] )&nbsp;</div></li><li><div>                self::$current_field_pod = pods( $object[ 'name' ], $object_id );&nbsp;</div></li><li><div>            elseif ( self::$current_field_pod-&gt;id() != $object_id )&nbsp;</div></li><li><div>                self::$current_field_pod-&gt;fetch( $object_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod = self::$current_field_pod;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod-&gt;remove_from( $meta_key, $meta_value );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else {&nbsp;</div></li><li><div>            if ( !is_object( self::$current_field_pod ) || self::$current_field_pod-&gt;pod != $object[ 'name' ] )&nbsp;</div></li><li><div>                self::$current_field_pod = pods( $object[ 'name' ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod = self::$current_field_pod;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $pod-&gt;save( array( $meta_key =&gt; null ), null, $object_id );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $_null;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function delete_post ( $id ) {&nbsp;</div></li><li><div>        $post = get_post( $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $post ) )&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $id = $post-&gt;ID;&nbsp;</div></li><li><div>        $post_type = $post-&gt;post_type;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $this-&gt;delete_object( 'post_type', $id, $post_type );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function delete_taxonomy ( $id ) {&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * @var $wpdb WPDB&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $terms = $wpdb-&gt;get_results( &quot;SELECT `term_id`, `taxonomy` FROM `{$wpdb-&gt;term_taxonomy}` WHERE `term_taxonomy_id` = {$id}&quot; );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $terms ) )&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $terms as $term ) {&nbsp;</div></li><li><div>            $id = $term-&gt;term_id;&nbsp;</div></li><li><div>            $taxonomy = $term-&gt;taxonomy;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $this-&gt;delete_object( 'taxonomy', $id, $taxonomy );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Hook the split_shared_term action and point it to this method&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Fires after a previously shared taxonomy term is split into two separate terms.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param int    $term_id          ID of the formerly shared term.&nbsp;</div></li><li><div>     * @param int    $new_term_id      ID of the new term created for the $term_taxonomy_id.&nbsp;</div></li><li><div>     * @param int    $term_taxonomy_id ID for the term_taxonomy row affected by the split.&nbsp;</div></li><li><div>     * @param string $taxonomy         Taxonomy for the split term.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function split_shared_term( $term_id, $new_term_id, $term_taxonomy_id, $taxonomy ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        require_once( PODS_DIR . 'classes/PodsTermSplitting.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $term_splitting = new Pods_Term_Splitting( $term_id, $new_term_id, $taxonomy );&nbsp;</div></li><li><div>        $term_splitting-&gt;split_shared_term();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function delete_user ( $id ) {&nbsp;</div></li><li><div>        return $this-&gt;delete_object( 'user', $id );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function delete_comment ( $id ) {&nbsp;</div></li><li><div>        return $this-&gt;delete_object( 'comment', $id );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function delete_media ( $id ) {&nbsp;</div></li><li><div>        return $this-&gt;delete_object( 'media', $id );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function delete_object ( $type, $id, $name = null ) {&nbsp;</div></li><li><div>        if ( empty( $name ) )&nbsp;</div></li><li><div>            $name = $type;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $object = $this-&gt;object_get( $type, $name );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( !empty( $object ) ) {&nbsp;</div></li><li><div>            $params = array(&nbsp;</div></li><li><div>                'pod' =&gt; pods_var( 'name', $object ), &nbsp;</div></li><li><div>                'pod_id' =&gt; pods_var( 'id', $object ), &nbsp;</div></li><li><div>                'id' =&gt; $id&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            return pods_api()-&gt;delete_pod_item( $params, false );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            return pods_api()-&gt;delete_object_from_relationships( $id, $type, $name );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 2.5.2</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/classes/pods_meta/" class="active">2.6</a></li><li><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.5.5/classes/pods_meta/" class="">2.5.5</a></li><li><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.5.4/classes/pods_meta/" class="">2.5.4</a></li><li><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.5.3/classes/pods_meta/" class="">2.5.3</a></li><li><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.5.2/classes/pods_meta/" class="">2.5.2</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>PodsMeta</li><li><span></span>Pods - Custom Content Types and Fields</li><li><span></span>2.6</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>