<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="2.6" data-slug="pods-custom-content-types-and-fields" data-type="file" data-id="59232"><head xmlns="http://www.w3.org/1999/xhtml"><title> components-templates-includes-functions-view-template | file | Pods Custom Content Types And Fields | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, pods-custom-content-types-and-fields, 2.6" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.10"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=59fefc24921c3dcbe9e4f7b557db00f4' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.10' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/components-templates-includes-functions-view-template/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fcomponents-templates-includes-functions-view-template%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fcomponents-templates-includes-functions-view-template%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-pods-custom-content-types-and-fields-2.6-file-components-templates-includes-functions-view-template","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="components-templates-includes-functions-view-template" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to pods-custom-content-types-and&hellip;." href="http://hookr.io/plugins/pods-custom-content-types-and-fields/" class="plugin"><span property="name">pods-custom-content-types-and&hellip;</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.6." href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/" class="H_VERSION"><span property="name">2.6</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">components-templates-includes&hellip;</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="726"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/all/" title="All">All <span class="count badge">726</span></a></li><li class="" data-id="new" data-count="5"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/new/" title="New">New <span class="count badge">5</span></a></li><li class="" data-id="hooks" data-count="474"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/hooks/" title="Hooks">Hooks <span class="count badge">474</span></a></li><li class="" data-id="action" data-count="109"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/actions/" title="Actions">Actions <span class="count badge">109</span></a></li><li class="" data-id="filter" data-count="365"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/filters/" title="Filters">Filters <span class="count badge">365</span></a></li><li class="" data-id="class" data-count="70"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/classes/" title="Classes">Classes <span class="count badge">70</span></a></li><li class="" data-id="constant" data-count="18"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/constants/" title="Constants">Constants <span class="count badge">18</span></a></li><li class="" data-id="function" data-count="156"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/functions/" title="Functions">Functions <span class="count badge">156</span></a></li><li class="" data-id="shortcode" data-count="8"><a href="http://hookr.io/plugins/pods-custom-content-types-and-fields/2.6/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">8</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/components/Templates/includes/functions-view_template.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Utility function for processesing fromtier based templates</span>&nbsp;</div></li><li><div><span class="comment"> * @package Pods_Frontier_Template_Editor\view_template</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// add filters</span>&nbsp;</div></li><li><div>add_filter( &quot;pods_templates_post_template&quot;, &quot;frontier_end_template&quot;, 25, 4 );&nbsp;</div></li><li><div>add_filter( &quot;pods_templates_do_template&quot;, &quot;frontier_do_shortcode&quot;, 25, 1 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// template shortcode handlers</span>&nbsp;</div></li><li><div>add_shortcode( &quot;pod_sub_template&quot;, &quot;frontier_do_subtemplate&quot; );&nbsp;</div></li><li><div>add_shortcode( &quot;pod_once_template&quot;, &quot;frontier_template_once_blocks&quot; );&nbsp;</div></li><li><div>add_shortcode( &quot;pod_after_template&quot;, &quot;frontier_template_blocks&quot; );&nbsp;</div></li><li><div>add_shortcode( &quot;pod_before_template&quot;, &quot;frontier_template_blocks&quot; );&nbsp;</div></li><li><div>add_shortcode( &quot;pod_if_field&quot;, &quot;frontier_if_block&quot; );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @param $content</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.4.3</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function frontier_do_shortcode( $content ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $content = pods_do_shortcode( $content, array( 'each', 'pod_sub_template', 'once', 'pod_once_template', 'before', 'pod_before_template', 'after', 'pod_after_template', 'if', 'pod_if_field' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $content;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * decodes a like nested shortcode based template</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string encoded template to be decoded</span>&nbsp;</div></li><li><div><span class="comment"> * @param array attributed provided from parent</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.4</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function frontier_decode_template( $code, $atts ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $code = base64_decode( $code );&nbsp;</div></li><li><div>  $pod = pods( $atts[ 'pod' ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $atts[ 'pod' ] ) ) {&nbsp;</div></li><li><div>      $code = str_replace( '@pod', $atts[ 'pod' ], $code );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( isset( $atts[ 'id' ] ) ) {&nbsp;</div></li><li><div>      $code = str_replace( '{@EntryID}', $atts[ 'id' ], $code );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( isset( $atts[ 'index' ] ) ) {&nbsp;</div></li><li><div>      $code = str_replace( '{_index}', $atts[ 'index' ], $code );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $code;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * processes if condition within a template</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array attributes from template</span>&nbsp;</div></li><li><div><span class="comment"> * @param string encoded template to be decoded</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.4</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function frontier_if_block( $atts, $code ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $pod = pods( $atts[ 'pod' ], $atts[ 'id' ] );&nbsp;</div></li><li><div>  $code = explode( '[else]', frontier_decode_template( $code, $atts ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $template = pods_do_shortcode( $pod-&gt;do_magic_tags( $code[ 0 ] ), array( 'each', 'pod_sub_template', 'once', 'pod_once_template', 'before', 'pod_before_template', 'after', 'pod_after_template', 'if', 'pod_if_field' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// sysvals</span>&nbsp;</div></li><li><div>  $system_values = array(&nbsp;</div></li><li><div>      '_index', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// field data</span>&nbsp;</div></li><li><div>  $field_data = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( in_array( $atts[ 'field' ], $system_values) ) {&nbsp;</div></li><li><div>      switch ( $atts[ 'field' ] ) {&nbsp;</div></li><li><div>          case '_index':&nbsp;</div></li><li><div>              $field_data = $atts['index'];&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  else{&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $field_data = $pod-&gt;field( $atts[ 'field' ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $field_data ) || isset( $atts[ 'value' ] ) ) {&nbsp;</div></li><li><div>      <span class="comment">// theres a field - let go deeper</span>&nbsp;</div></li><li><div>      if ( isset( $atts[ 'value' ] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// check if + or - are present</span>&nbsp;</div></li><li><div>          if( substr( $atts[ 'value' ], 0, 1) === '+' ) {&nbsp;</div></li><li><div>              <span class="comment">// is greater</span>&nbsp;</div></li><li><div>              $atts[ 'value' ] = (float) substr( $atts[ 'value' ], 1) + 1;&nbsp;</div></li><li><div>              if(  (float) $field_data &gt; $atts[ 'value' ] ) {&nbsp;</div></li><li><div>                  <span class="comment">// is greater</span> - set it the same to allow&nbsp;</div></li><li><div>                  $atts[ 'value' ] = $field_data;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }elseif( substr( $atts[ 'value' ], 0, 1) === '-' ) {&nbsp;</div></li><li><div>              <span class="comment">// is smaller</span>&nbsp;</div></li><li><div>              $atts[ 'value' ] = (float) substr( $atts[ 'value' ], 1) - 1;&nbsp;</div></li><li><div>              if( (float) $field_data &lt;  $atts[ 'value' ] ) {&nbsp;</div></li><li><div>                  <span class="comment">// is greater</span> - set it the same to allow&nbsp;</div></li><li><div>                  $atts[ 'value' ] = $field_data;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $field_data == $atts[ 'value' ] ) {&nbsp;</div></li><li><div>              return pods_do_shortcode( $template, array( 'each', 'pod_sub_template', 'once', 'pod_once_template', 'before', 'pod_before_template', 'after', 'pod_after_template', 'if', 'pod_if_field' ) );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              if ( isset( $code[ 1 ] ) ) {&nbsp;</div></li><li><div>                  $template = pods_do_shortcode( $pod-&gt;do_magic_tags( $code[ 1 ] ), array( 'each', 'pod_sub_template', 'once', 'pod_once_template', 'before', 'pod_before_template', 'after', 'pod_after_template', 'if', 'pod_if_field' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  return pods_do_shortcode( $template, array( 'each', 'pod_sub_template', 'once', 'pod_once_template', 'before', 'pod_before_template', 'after', 'pod_after_template', 'if', 'pod_if_field' ) );&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  <span class="comment">// Value did not match, nothing should be displayed</span>&nbsp;</div></li><li><div>                  return '';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return pods_do_shortcode( $template, array( 'each', 'pod_sub_template', 'once', 'pod_once_template', 'before', 'pod_before_template', 'after', 'pod_after_template', 'if', 'pod_if_field' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  else {&nbsp;</div></li><li><div>      if ( isset( $code[ 1 ] ) ) {&nbsp;</div></li><li><div>          $template = pods_do_shortcode( $pod-&gt;do_magic_tags( $code[ 1 ] ), array( 'each', 'pod_sub_template', 'once', 'pod_once_template', 'before', 'pod_before_template', 'after', 'pod_after_template', 'if', 'pod_if_field' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $template;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * processes before and after template blocks</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array attributes from template</span>&nbsp;</div></li><li><div><span class="comment"> * @param string encoded template to be decoded</span>&nbsp;</div></li><li><div><span class="comment"> * @param string shortcode slug used to process</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return null</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.4</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function frontier_template_blocks( $atts, $code, $slug ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $template_post_blocks;&nbsp;</div></li><li><div>  if ( !isset( $template_post_blocks ) ) {&nbsp;</div></li><li><div>      $template_post_blocks = array(&nbsp;</div></li><li><div>          'before' =&gt; null, &nbsp;</div></li><li><div>          'after' =&gt; null, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( $slug === 'pod_before_template' ) {&nbsp;</div></li><li><div>      if ( !isset( $template_post_blocks[ 'before' ][ $atts[ 'pod' ] ] ) ) {&nbsp;</div></li><li><div>          $template_post_blocks[ 'before' ][ $atts[ 'pod' ] ] = pods_do_shortcode( frontier_decode_template( $code, $atts ), array(&nbsp;</div></li><li><div>              'if', &nbsp;</div></li><li><div>              'else'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  elseif ( $slug === 'pod_after_template' ) {&nbsp;</div></li><li><div>      if ( !isset( $template_post_blocks[ 'after' ][ $atts[ 'pod' ] ] ) ) {&nbsp;</div></li><li><div>          $template_post_blocks[ 'after' ][ $atts[ 'pod' ] ] = pods_do_shortcode( frontier_decode_template( $code, $atts ), array(&nbsp;</div></li><li><div>              'if', &nbsp;</div></li><li><div>              'else'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return null;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * processes once blocks</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array attributes from template</span>&nbsp;</div></li><li><div><span class="comment"> * @param string encoded template to be decoded</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return string template code</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.4</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function frontier_template_once_blocks( $atts, $code ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $frontier_once_hashes;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !isset( $frontier_once_hashes ) ) {&nbsp;</div></li><li><div>      $frontier_once_hashes = array();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $blockhash = md5( $code . $atts[ 'id' ] );&nbsp;</div></li><li><div>  if ( in_array( $blockhash, $frontier_once_hashes ) ) {&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  $frontier_once_hashes[ ] = $blockhash;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return pods_do_shortcode( frontier_decode_template( $code, $atts ), array( 'each', 'pod_sub_template', 'once', 'pod_once_template', 'before', 'pod_before_template', 'after', 'pod_after_template', 'if', 'pod_if_field' ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * processes template code within an each command from the base template</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array attributes from template</span>&nbsp;</div></li><li><div><span class="comment"> * @param string template to be processed</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return null</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.4</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function frontier_do_subtemplate( $atts, $content ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $out = null;&nbsp;</div></li><li><div>  $pod = pods( $atts[ 'pod' ], $atts[ 'id' ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $params = array(&nbsp;</div></li><li><div>      'name' =&gt; $atts[ 'field' ], &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $entries = $pod-&gt;field( $atts[ 'field' ] );&nbsp;</div></li><li><div>  if ( ! empty( $entries ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Note on the change below for issue #3018:</span>&nbsp;</div></li><li><div><span class="comment">       * ... || 'taxonomy' == $pod-&gt;fields[ $atts[ 'field' ] ][ 'type' ]</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * calling field() above for a taxonomy object field will populate</span>&nbsp;</div></li><li><div><span class="comment">       * $pod-&gt;fields[ $field_name ] for the object field's data, in this</span>&nbsp;</div></li><li><div><span class="comment">       * case a taxonomy object field. Without calling</span>&nbsp;</div></li><li><div><span class="comment">       * $pod-&gt;field( $field_name ), it would not normally be available in</span>&nbsp;</div></li><li><div><span class="comment">       * the $pod-&gt;fields array and is something to not expect to be there in</span>&nbsp;</div></li><li><div><span class="comment">       * 3.0 as this was unintentional.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      if ( ! empty( $pod-&gt;fields[ $atts[ 'field' ] ][ 'table_info' ] ) || 'taxonomy' == $pod-&gt;fields[ $atts[ 'field' ] ][ 'type' ] ) {&nbsp;</div></li><li><div>          foreach ( $entries as $key =&gt; $entry ) {&nbsp;</div></li><li><div>              $subpod = pods( $pod-&gt;fields[ $atts[ 'field' ] ][ 'pick_val' ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $subatts = array(&nbsp;</div></li><li><div>                  'id' =&gt; $entry[ $subpod-&gt;api-&gt;pod_data[ 'field_id' ] ], &nbsp;</div></li><li><div>                  'pod' =&gt; $pod-&gt;fields[ $atts[ 'field' ] ][ 'pick_val' ]&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $template = frontier_decode_template( $content, array_merge( $atts, $subatts ) );&nbsp;</div></li><li><div>              $template = str_replace( '{_index}', $key, $template );&nbsp;</div></li><li><div>              $template = str_replace( '{@' . $atts[ 'field' ] . '.', '{@', $template );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Kludge to work with taxonomies, pending a better solution: see issue #3018</span>&nbsp;</div></li><li><div>              $target_id = null;&nbsp;</div></li><li><div>              if ( isset( $entry[ 'ID' ] ) ) {&nbsp;</div></li><li><div>                  $target_id = $entry[ 'ID' ];&nbsp;</div></li><li><div>              } elseif ( isset( $entry[ 'term_id' ] ) ) {&nbsp;</div></li><li><div>                  $target_id = $entry[ 'term_id' ];&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $out .= pods_shortcode( array(&nbsp;</div></li><li><div>                  'name' =&gt; $pod-&gt;fields[ $atts[ 'field' ] ][ 'pick_val' ], &nbsp;</div></li><li><div>                  'slug' =&gt; $target_id, &nbsp;</div></li><li><div>                  'index' =&gt; $key&nbsp;</div></li><li><div> ), $template );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      } elseif ( 'file' == $pod-&gt;fields[ $atts[ 'field' ] ][ 'type' ] && 'attachment' == $pod-&gt;fields[ $atts[ 'field' ] ][ 'options' ][ 'file_uploader' ] && 'multi' == $pod-&gt;fields[ $atts[ 'field' ] ][ 'options' ][ 'file_format_type' ] ) {&nbsp;</div></li><li><div>          $template = frontier_decode_template( $content, $atts );&nbsp;</div></li><li><div>          foreach ( $entries as $key =&gt; $entry ) {&nbsp;</div></li><li><div>              $content = str_replace( '{_index}', $key, $template );&nbsp;</div></li><li><div>              $content = str_replace( '{@_img', '{@image_attachment.' . $entry[ 'ID' ], $content );&nbsp;</div></li><li><div>              $content = str_replace( '{@_src', '{@image_attachment_url.' . $entry[ 'ID' ], $content );&nbsp;</div></li><li><div>              $content = str_replace( '{@' . $atts[ 'field' ] . '}', '{@image_attachment.' . $entry[ 'ID' ] . '}', $content );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $out .= pods_do_shortcode( $pod-&gt;do_magic_tags( $content ), array(&nbsp;</div></li><li><div>                  'each', &nbsp;</div></li><li><div>                  'pod_sub_template', &nbsp;</div></li><li><div>                  'once', &nbsp;</div></li><li><div>                  'pod_once_template', &nbsp;</div></li><li><div>                  'before', &nbsp;</div></li><li><div>                  'pod_before_template', &nbsp;</div></li><li><div>                  'after', &nbsp;</div></li><li><div>                  'pod_after_template', &nbsp;</div></li><li><div>                  'if', &nbsp;</div></li><li><div>                  'pod_if_field'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return pods_do_shortcode( $out, array(&nbsp;</div></li><li><div>      'each', &nbsp;</div></li><li><div>      'pod_sub_template', &nbsp;</div></li><li><div>      'once', &nbsp;</div></li><li><div>      'pod_once_template', &nbsp;</div></li><li><div>      'before', &nbsp;</div></li><li><div>      'pod_before_template', &nbsp;</div></li><li><div>      'after', &nbsp;</div></li><li><div>      'pod_after_template', &nbsp;</div></li><li><div>      'if', &nbsp;</div></li><li><div>      'pod_if_field'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * processes template code within an each command from the base template</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array attributes from template</span>&nbsp;</div></li><li><div><span class="comment"> * @param string template to be processed</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return null</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.4</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function frontier_prefilter_template( $code, $template, $pod ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $frontier_once_tags;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $commands = array(&nbsp;</div></li><li><div>      'each' =&gt; 'pod_sub_template', &nbsp;</div></li><li><div>      'once' =&gt; 'pod_once_template', &nbsp;</div></li><li><div>      'before' =&gt; 'pod_before_template', &nbsp;</div></li><li><div>      'after' =&gt; 'pod_after_template', &nbsp;</div></li><li><div>      'if' =&gt; 'pod_if_field', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $commands = array_merge( $commands, get_option( 'pods_frontier_extra_commands', array() ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Add additional control blocks to Pods templates</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Can also be use to remove each/once/before/after/if functionality from Pods Templates</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $commands The control blocks in the form of 'tag' =&gt; 'shortcode'</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array An array of control blocks, and shortcodes used to power them.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $commands = apply_filters( 'pods_frontier_template_commands', $commands );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $aliases = array();&nbsp;</div></li><li><div>  foreach ( $commands as $command =&gt; $shortcode ) {&nbsp;</div></li><li><div>      preg_match_all( &quot;/(\[&quot; . $command . &quot;(.*?)]|\[\/&quot; . $command . &quot;\])/m&quot;, $code, $matches );&nbsp;</div></li><li><div>      if ( !empty( $matches[ 0 ] ) ) {&nbsp;</div></li><li><div>          <span class="comment">// holder for found blocks.</span>&nbsp;</div></li><li><div>          $blocks = array();&nbsp;</div></li><li><div>          $indexCount = 0;&nbsp;</div></li><li><div>          foreach ( $matches[ 0 ] as $key =&gt; $tag ) {&nbsp;</div></li><li><div>              if ( false === strpos( $tag, '[/' ) ) {&nbsp;</div></li><li><div>                  <span class="comment">// open tag</span>&nbsp;</div></li><li><div>                  $field = null;&nbsp;</div></li><li><div>                  $value = null;&nbsp;</div></li><li><div>                  $ID = '{@EntryID}';&nbsp;</div></li><li><div>                  $atts = ' pod=&quot;@pod&quot; id=&quot;' . $ID . '&quot;';&nbsp;</div></li><li><div>                  if ( !empty( $matches[ 2 ][ $key ] ) ) {&nbsp;</div></li><li><div>                      <span class="comment">// get atts if any</span>&nbsp;</div></li><li><div>                      <span class="comment">//$atts = shortcode_parse_atts(str_replace('.', '____', $matches[2][$key]));</span>&nbsp;</div></li><li><div>                      $atts = array();&nbsp;</div></li><li><div>                      $pattern = '/(\w.+)\s*=\s*&quot;([^&quot;]*)&quot;(?:\s|$)/';&nbsp;</div></li><li><div>                      $text = preg_replace( &quot;/[\x{00a0}\x{200b}]+/u&quot;, &quot; &quot;, $matches[ 2 ][ $key ] );&nbsp;</div></li><li><div>                      if ( preg_match_all( $pattern, $text, $match, PREG_SET_ORDER ) ) {&nbsp;</div></li><li><div>                          $field = $match[ 0 ][ 1 ];&nbsp;</div></li><li><div>                          $value = $match[ 0 ][ 2 ];&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      else {&nbsp;</div></li><li><div>                          $field = trim( $matches[ 2 ][ $key ] );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      if ( false !== strpos( $field, '.' ) ) {&nbsp;</div></li><li><div>                          $path = explode( '.', $field );&nbsp;</div></li><li><div>                          $field = array_pop( $path );&nbsp;</div></li><li><div>                          $ID = '{@' . implode( '.', $path ) . '.' . $pod-&gt;api-&gt;pod_data[ 'field_id' ] . '}';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      $atts = ' id=&quot;' . $ID . '&quot; pod=&quot;@pod&quot; field=&quot;' . $field . '&quot;';&nbsp;</div></li><li><div>                      if ( !empty( $value ) ) {&nbsp;</div></li><li><div>                          $atts .= ' value=&quot;' . $value . '&quot;';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $newtag = $shortcode . '__' . $key;&nbsp;</div></li><li><div>                  $tags[ $indexCount ] = $newtag;&nbsp;</div></li><li><div>                  $aliases[ ] = $newtag;&nbsp;</div></li><li><div>                  $code = preg_replace( &quot;/(&quot; . preg_quote( $tag ) . &quot;)/m&quot;, &quot;[&quot; . $newtag . $atts . &quot; index=\&quot;{_index}\&quot;]&quot;, $code, 1 );&nbsp;</div></li><li><div>                  $indexCount++;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              else {&nbsp;</div></li><li><div>                  <span class="comment">// close tag</span>&nbsp;</div></li><li><div>                  $indexCount--;&nbsp;</div></li><li><div>                  $newclose = $tags[ $indexCount ];&nbsp;</div></li><li><div>                  $code = preg_replace( &quot;/(&quot; . preg_quote( $tag, '/' ) . &quot;)/m&quot;, &quot;[/&quot; . $newclose . &quot;]&quot;, $code, 1 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          if ( $command == 'if' ) {&nbsp;</div></li><li><div>              <span class="comment">//dump($pod);</span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  <span class="comment">// get new aliased shotcodes</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !empty( $aliases ) ) {&nbsp;</div></li><li><div>      $code = frontier_backtrack_template( $code, $aliases );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  $code = str_replace( '@pod', $pod-&gt;pod, $code );&nbsp;</div></li><li><div>  $code = str_replace( '@EntryID', '@' . $pod-&gt;api-&gt;pod_data[ 'field_id' ], $code );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $code;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function frontier_backtrack_template( $code, $aliases ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $regex = frontier_get_regex( $aliases );&nbsp;</div></li><li><div>  preg_match_all( '/' . $regex . '/s', $code, $used );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !empty( $used[ 2 ] ) ) {&nbsp;</div></li><li><div>      foreach ( $used[ 2 ] as $key =&gt; $alias ) {&nbsp;</div></li><li><div>          $shortcodes = explode( '__', $alias );&nbsp;</div></li><li><div>          $content = $used[ 5 ][ $key ];&nbsp;</div></li><li><div>          $atts = shortcode_parse_atts( $used[ 3 ][ $key ] );&nbsp;</div></li><li><div>          if ( !empty( $atts ) ) {&nbsp;</div></li><li><div>              if ( !empty( $atts[ 'field' ] ) ) {&nbsp;</div></li><li><div>                  $content = str_replace( $atts[ 'field' ] . '.', '', $content );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              preg_match_all( '/' . $regex . '/s', $content, $subused );&nbsp;</div></li><li><div>              if ( !empty( $subused[ 2 ] ) ) {&nbsp;</div></li><li><div>                  $content = frontier_backtrack_template( $content, $aliases );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $codecontent = &quot;[&quot; . $shortcodes[ 0 ] . &quot; &quot; . trim( $used[ 3 ][ $key ] ) . &quot; seq=\&quot;&quot; . $shortcodes[ 1 ] . &quot;\&quot;]&quot; . base64_encode( $content ) . &quot;[/&quot; . $shortcodes[ 0 ] . &quot;]&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          else {&nbsp;</div></li><li><div>              $codecontent = &quot;[&quot; . $shortcodes[ 0 ] . &quot; seq=\&quot;&quot; . $shortcodes[ 1 ] . &quot;\&quot;]&quot; . base64_encode( $content ) . &quot;[/&quot; . $shortcodes[ 0 ] . &quot;]&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $code = str_replace( $used[ 0 ][ $key ], $codecontent, $code );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $code;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function frontier_get_regex( $codes ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// A custom version of the shortcode regex as to only use podsfrontier codes.</span>&nbsp;</div></li><li><div>  <span class="comment">// this makes it easier to cycle through and get the used codes for inclusion</span>&nbsp;</div></li><li><div>  $validcodes = join( '|', array_map( 'preg_quote', $codes ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return '\\[' <span class="comment">// Opening bracket</span>&nbsp;</div></li><li><div>  . '(\\[?)' <span class="comment">// 1: Optional second opening bracket for escaping shortcodes: [[tag]]</span>&nbsp;</div></li><li><div>  . &quot;($validcodes)&quot; <span class="comment">// 2: selected codes only</span>&nbsp;</div></li><li><div>  . '\\b' <span class="comment">// Word boundary</span>&nbsp;</div></li><li><div>  . '(' <span class="comment">// 3: Unroll the loop: Inside the opening shortcode tag</span>&nbsp;</div></li><li><div>  . '[^\\]\\/]*' <span class="comment"><span class="comment">// Not a closing bracket or forward slash</span></span>&nbsp;</div></li><li><div>  . '(?:' . '\\/(?!\\])' <span class="comment">// A forward slash not followed by a closing bracket</span>&nbsp;</div></li><li><div>  . '[^\\]\\/]*' <span class="comment"><span class="comment">// Not a closing bracket or forward slash</span></span>&nbsp;</div></li><li><div>  . ')*?' . ')' . '(?:' . '(\\/)' <span class="comment">// 4: Self closing tag ...</span>&nbsp;</div></li><li><div>  . '\\]' <span class="comment">// ... and closing bracket</span>&nbsp;</div></li><li><div>  . '|' . '\\]' <span class="comment">// Closing bracket</span>&nbsp;</div></li><li><div>  . '(?:' . '(' <span class="comment">// 5: Unroll the loop: Optionally, anything between the opening and closing shortcode tags</span>&nbsp;</div></li><li><div>  . '[^\\[]*+' <span class="comment"><span class="comment">// Not an opening bracket</span></span>&nbsp;</div></li><li><div>  . '(?:' . '\\[(?!\\/\\2\\])' <span class="comment">// An opening bracket not followed by the closing shortcode tag</span>&nbsp;</div></li><li><div>  . '[^\\[]*+' <span class="comment"><span class="comment">// Not an opening bracket</span></span>&nbsp;</div></li><li><div>  . ')*+' . ')' . '\\[\\/\\2\\]' <span class="comment">// Closing shortcode tag</span>&nbsp;</div></li><li><div>  . ')?' . ')' . '(\\]?)'; <span class="comment">// 6: Optional second closing brocket for escaping shortcodes: [[tag]]</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function frontier_end_template( $code, $base, $template, $pod ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  global $template_post_blocks;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !empty( $template_post_blocks[ 'before' ][ $pod-&gt;pod ] ) ) {&nbsp;</div></li><li><div>      $code = $template_post_blocks[ 'before' ][ $pod-&gt;pod ] . $code;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      unset( $template_post_blocks[ 'before' ][ $pod-&gt;pod ] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !empty( $template_post_blocks[ 'after' ][ $pod-&gt;pod ] ) ) {&nbsp;</div></li><li><div>      $code .= $template_post_blocks[ 'after' ][ $pod-&gt;pod ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      unset( $template_post_blocks[ 'after' ][ $pod-&gt;pod ] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return pods_do_shortcode( $code, array( 'each', 'pod_sub_template', 'once', 'pod_once_template', 'before', 'pod_before_template', 'after', 'pod_after_template', 'if', 'pod_if_field' ) );&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>Pods - Custom Content Types and Fields</li><li><span></span>2.6</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>