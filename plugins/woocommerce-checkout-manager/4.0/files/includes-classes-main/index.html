<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="4.0" data-slug="woocommerce-checkout-manager" data-type="file" data-id="25363"><head xmlns="http://www.w3.org/1999/xhtml"><title> includes-classes-main | file | Woocommerce Checkout Manager | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, woocommerce-checkout-manager, 4.0" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=77ad9613aa73e6e36deb5a26eccae698' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/includes-classes-main/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fincludes-classes-main%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fincludes-classes-main%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-woocommerce-checkout-manager-4.0-file-includes-classes-main","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="includes-classes-main" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to woocommerce-checkout-manager." href="http://hookr.io/plugins/woocommerce-checkout-manager/" class="plugin"><span property="name">woocommerce-checkout-manager</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 4.0." href="http://hookr.io/plugins/woocommerce-checkout-manager/4.0/" class="H_VERSION"><span property="name">4.0</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/woocommerce-checkout-manager/4.0/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">includes-classes-main</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="114"><a href="http://hookr.io/plugins/woocommerce-checkout-manager/4.0/all/" title="All">All <span class="count badge">114</span></a></li><li class="" data-id="new" data-count="111"><a href="http://hookr.io/plugins/woocommerce-checkout-manager/4.0/new/" title="New">New <span class="count badge">111</span></a></li><li class="" data-id="hooks" data-count="1"><a href="http://hookr.io/plugins/woocommerce-checkout-manager/4.0/hooks/" title="Hooks">Hooks <span class="count badge">1</span></a></li><li class="" data-id="action" data-count="1"><a href="http://hookr.io/plugins/woocommerce-checkout-manager/4.0/actions/" title="Actions">Actions <span class="count badge">1</span></a></li><li class="" data-id="filter" data-count="0"><a href="http://hookr.io/plugins/woocommerce-checkout-manager/4.0/filters/" title="Filters">Filters <span class="count badge">0</span></a></li><li class="" data-id="class" data-count="0"><a href="http://hookr.io/plugins/woocommerce-checkout-manager/4.0/classes/" title="Classes">Classes <span class="count badge">0</span></a></li><li class="" data-id="constant" data-count="1"><a href="http://hookr.io/plugins/woocommerce-checkout-manager/4.0/constants/" title="Constants">Constants <span class="count badge">1</span></a></li><li class="" data-id="function" data-count="112"><a href="http://hookr.io/plugins/woocommerce-checkout-manager/4.0/functions/" title="Functions">Functions <span class="count badge">112</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/plugins/woocommerce-checkout-manager/4.0/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/includes/classes/main.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php &nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * WooCommerce Checkout Manager </span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * MAIN</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div> &nbsp;</div></li><li><div><span class="comment">// Exit if accessed directly</span>&nbsp;</div></li><li><div>if ( !defined( 'ABSPATH' ) ) exit;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wccs_admin_plugin_actions_pro($links) {&nbsp;</div></li><li><div>          $wccs_plugin_links = array(&nbsp;</div></li><li><div>                  '&lt;a href=&quot;admin.php?page=woocommerce-checkout-manager&quot;&gt;'.__('Settings', 'woocommerce-checkout-manager' ).'&lt;/a&gt;', &nbsp;</div></li><li><div>                  '&lt;a href=&quot;https:<span class="comment">//wordpress.org/plugins/woocommerce-checkout-manager/developers/&quot;&gt;'.__('Support', 'woocommerce-checkout-manager' ).'&lt;/a&gt;', </span>&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          return array_merge( $wccs_plugin_links, $links );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function add_payment_method_to_new_order( $order, $sent_to_admin, $plain_text ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$shipping = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode' );&nbsp;</div></li><li><div>$billing = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode', 'email', 'phone' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$names = array( 'billing', 'shipping' );&nbsp;</div></li><li><div>$inc = 3;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div> if( $plain_text ) {&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>foreach( $names as $name ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$array = ($name == 'billing') ? $billing : $shipping;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings'.$inc.'' );&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>          foreach ( $options[''.$name.'_buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !in_array( $btn['cow'], $array ) ) {&nbsp;</div></li><li><div>              if (  (''.get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] !== 'heading') && ($btn['type'] !== 'multiselect') && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                  echo ''.wpml_string_wccm_pro($btn['label']).': '.nl2br(get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true)).'';&nbsp;</div></li><li><div>                  echo &quot;\n&quot;;&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              } elseif ( !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] == 'heading') && ($btn['type'] !== 'multiselect') && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                  echo '' .wpml_string_wccm_pro($btn['label']). '';&nbsp;</div></li><li><div>                  echo &quot;\n&quot;;&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              } elseif (  (''.get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] !== 'heading') && $btn['type'] !== 'wooccmupload' && (($btn['type'] == 'multiselect') || ($btn['type'] == 'multicheckbox')) ) {&nbsp;</div></li><li><div>                   $strings = unserialize(get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true));&nbsp;</div></li><li><div>                      $iww = 0;&nbsp;</div></li><li><div>                      $len = count($strings);&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                          echo ''.wpml_string_wccm_pro($btn['label']).': ';&nbsp;</div></li><li><div>                              foreach($strings as $key ) {&nbsp;</div></li><li><div>                                  if ($iww == $len - 1) {&nbsp;</div></li><li><div>                                          echo ''.$key.'';&nbsp;</div></li><li><div>                                      } else {&nbsp;</div></li><li><div>                                                      echo ''.$key.', ';&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                                  $iww++;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          echo &quot;\n&quot;;&nbsp;</div></li><li><div>              }elseif( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>                  $info = explode( &quot;||&quot;, get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true));&nbsp;</div></li><li><div>                  echo ''.wpml_string_wccm_pro($btn['force_title2']).': '.$info[0].'';&nbsp;</div></li><li><div>                  echo &quot;\n&quot;;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>           endforeach;&nbsp;</div></li><li><div>$inc--;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( (''.get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty($btn['deny_receipt']) && ($btn['type'] !== 'heading') && ($btn['type'] !== 'multiselect') && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                      echo ''.wpml_string_wccm_pro($btn['label']).': '.nl2br(get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true)).'';&nbsp;</div></li><li><div>                      echo &quot;\n&quot;;&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                  } elseif ( !empty( $btn['label'] ) && empty($btn['deny_receipt']) && ($btn['type'] == 'heading') && ($btn['type'] !== 'multiselect') && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                      echo ''.wpml_string_wccm_pro($btn['label']).'';&nbsp;</div></li><li><div>                      echo &quot;\n&quot;;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  } elseif ( (''.get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty($btn['deny_receipt']) && ($btn['type'] !== 'heading') && $btn['type'] !== 'wooccmupload' && (($btn['type'] == 'multiselect') || ($btn['type'] == 'multicheckbox')) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $strings = unserialize(get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true));&nbsp;</div></li><li><div>                      $iww = 0;&nbsp;</div></li><li><div>                      $len = count($strings);&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                          echo ''.wpml_string_wccm_pro($btn['label']).': ';&nbsp;</div></li><li><div>                              foreach($strings as $key ) {&nbsp;</div></li><li><div>                                  if ($iww == $len - 1) {&nbsp;</div></li><li><div>                                          echo ''.$key.'';&nbsp;</div></li><li><div>                                      } else {&nbsp;</div></li><li><div>                                                      echo ''.$key.', ';&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                                  $iww++;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          echo &quot;\n&quot;;&nbsp;</div></li><li><div>                  }elseif( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>                      $info = explode(&quot;||&quot;, get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true));&nbsp;</div></li><li><div>                      echo ''.wpml_string_wccm_pro($btn['force_title2']).': '.$info[0].'';&nbsp;</div></li><li><div>                      echo &quot;\n&quot;;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  endforeach;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !empty($options['checkness']['set_timezone']) ) {&nbsp;</div></li><li><div>                  date_default_timezone_set(''.$options['checkness']['set_timezone'].'');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $date = ( !empty($options['checkness']['twenty_hour'])) ? date(&quot;G:i T (P&quot;).' GMT)' : date(&quot;g:i a&quot;);&nbsp;</div></li><li><div>              if ( $options['checkness']['time_stamp'] == true ) {&nbsp;</div></li><li><div>                  echo ''.$options['checkness']['time_stamp_title'].' ' . $date . &quot;\n&quot;;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( $order-&gt;payment_method_title && $options['checkness']['payment_method_t'] == true ) {&nbsp;</div></li><li><div>                  echo ''.$options['checkness']['payment_method_d'].': ' . $order-&gt;payment_method_title . &quot;\n&quot;;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( $order-&gt;shipping_method_title && ($options['checkness']['shipping_method_t'] == true)) {&nbsp;</div></li><li><div>                  echo ''.$options['checkness']['shipping_method_d'].': ' . $order-&gt;shipping_method_title . &quot;\n&quot;;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              echo &quot;\n&quot;;&nbsp;</div></li><li><div> } else {&nbsp;</div></li><li><div>   foreach( $names as $name ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$array = ($name == 'billing') ? $billing : $shipping;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings'.$inc.'' );&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>          foreach ( $options[''.$name.'_buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !in_array( $btn['cow'], $array ) ) {&nbsp;</div></li><li><div>              if (  (''.get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] !== 'heading') && ($btn['type'] !== 'multiselect') && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                  echo '&lt;p&gt;&lt;strong&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/strong&gt; '.nl2br(get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true)).'&lt;/p&gt;';&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              } elseif ( !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] == 'heading') && ($btn['type'] !== 'multiselect') && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                  echo '&lt;h2&gt;' .wpml_string_wccm_pro($btn['label']). '&lt;/h2&gt;';&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              } elseif (  (''.get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] !== 'heading') && $btn['type'] !== 'wooccmupload' && (($btn['type'] == 'multiselect') || ($btn['type'] == 'multicheckbox')) ) {&nbsp;</div></li><li><div>                   $strings = unserialize(get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true));&nbsp;</div></li><li><div>                      $iww = 0;&nbsp;</div></li><li><div>                      $len = count($strings);&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                          echo '&lt;p&gt;&lt;strong&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/strong&gt; ';&nbsp;</div></li><li><div>                              foreach($strings as $key ) {&nbsp;</div></li><li><div>                                  if ($iww == $len - 1) {&nbsp;</div></li><li><div>                                          echo ''.$key.'';&nbsp;</div></li><li><div>                                      } else {&nbsp;</div></li><li><div>                                                      echo ''.$key.', ';&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                                  $iww++;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          echo '&lt;/p&gt;';&nbsp;</div></li><li><div>              }elseif( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>              $info = explode(&quot;||&quot;, get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true));&nbsp;</div></li><li><div>                  echo '&lt;p&gt;&lt;strong&gt;'.wpml_string_wccm_pro($btn['force_title2']).':&lt;/strong&gt; '.$info[0].'&lt;/p&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>           endforeach;&nbsp;</div></li><li><div>$inc--;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( (''.get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty($btn['deny_receipt']) && ($btn['type'] !== 'heading') && ($btn['type'] !== 'multiselect') && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                      echo '&lt;p&gt;&lt;strong&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/strong&gt; '.nl2br(get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true)).'&lt;/p&gt;';&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  } elseif ( !empty( $btn['label'] ) && empty($btn['deny_receipt']) && ($btn['type'] == 'heading') && ($btn['type'] !== 'multiselect') && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                      echo '&lt;h2&gt;'.wpml_string_wccm_pro($btn['label']).'&lt;/h2&gt;';&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  } elseif ( (''.get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty($btn['deny_receipt']) && ($btn['type'] !== 'heading') && $btn['type'] !== 'wooccmupload' && (($btn['type'] == 'multiselect') || ($btn['type'] == 'multicheckbox')) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $strings = unserialize(get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true));&nbsp;</div></li><li><div>                      $iww = 0;&nbsp;</div></li><li><div>                      $len = count($strings);&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                          echo '&lt;p&gt;&lt;strong&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/strong&gt; ';&nbsp;</div></li><li><div>                              foreach($strings as $key ) {&nbsp;</div></li><li><div>                                  if ($iww == $len - 1) {&nbsp;</div></li><li><div>                                          echo ''.$key.'';&nbsp;</div></li><li><div>                                      } else {&nbsp;</div></li><li><div>                                                      echo ''.$key.', ';&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                                  $iww++;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          echo '&lt;/p&gt;';&nbsp;</div></li><li><div>                  }elseif( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>                      $info = explode( &quot;||&quot;, get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true));&nbsp;</div></li><li><div>                      echo '&lt;p&gt;&lt;strong&gt;'.wpml_string_wccm_pro($btn['force_title2']).':&lt;/strong&gt; '.$info[0].'&lt;/p&gt;';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  endforeach;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !empty($options['checkness']['set_timezone']) ) {&nbsp;</div></li><li><div>                  date_default_timezone_set(''.$options['checkness']['set_timezone'].'');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $date = ( !empty($options['checkness']['twenty_hour'])) ? date(&quot;G:i T (P&quot;).' GMT)' : date(&quot;g:i a&quot;);&nbsp;</div></li><li><div>              if ( $options['checkness']['time_stamp'] == true ) {&nbsp;</div></li><li><div>                  echo '&lt;p&gt;&lt;strong&gt;'.$options['checkness']['time_stamp_title'].':&lt;/strong&gt; ' . $date . '&lt;/p&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( $order-&gt;payment_method_title && $options['checkness']['payment_method_t'] == true ) {&nbsp;</div></li><li><div>                  echo '&lt;p&gt;&lt;strong&gt;'.$options['checkness']['payment_method_d'].':&lt;/strong&gt; ' . $order-&gt;payment_method_title . '&lt;/p&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( $order-&gt;shipping_method_title && ($options['checkness']['shipping_method_t'] == true)) {&nbsp;</div></li><li><div>                  echo '&lt;p&gt;&lt;strong&gt;'.$options['checkness']['shipping_method_d'].':&lt;/strong&gt; ' . $order-&gt;shipping_method_title . '&lt;/p&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div> &nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wccs_custom_checkout_field_pro( $checkout ) {&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>              if ( !empty($options['buttons'])) {&nbsp;</div></li><li><div>              foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $btn['type'] == 'heading' && empty($btn['deny_checkout'] ) ) {&nbsp;</div></li><li><div>                      echo '&lt;h3 class=&quot;form-row '.$btn['position'].'&quot; id=&quot;'.$btn['cow'].'_field&quot;&gt;' . wpml_string_wccm_pro(''.$btn['label'].'') . '&lt;/h3&gt;';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $btn['type'] == 'wooccmtext' ) {&nbsp;</div></li><li><div>                      woocommerce_form_field( ''.$btn['cow'].'' , array(&nbsp;</div></li><li><div>                          'type' =&gt; 'wooccmtext', &nbsp;</div></li><li><div>                          'class' =&gt; array(''.$btn['position'].' '.$btn['conditional_tie'].' '.$btn['extra_class'].''), &nbsp;</div></li><li><div>                          'label' =&gt;  wpml_string_wccm_pro(''.$btn['label'].''), &nbsp;</div></li><li><div>                          'wooccm_required' =&gt; ''.$btn['checkbox'].'', &nbsp;</div></li><li><div>                          'clear' =&gt; ''.$btn['clear_row'].'', &nbsp;</div></li><li><div>                          'user_role' =&gt; ''.$btn['user_role'].'', &nbsp;</div></li><li><div>                          'role_options' =&gt; ''.$btn['role_options'].'', &nbsp;</div></li><li><div>                          'role_options2' =&gt; ''.$btn['role_options2'].'', &nbsp;</div></li><li><div>                          'placeholder' =&gt; wpml_string_wccm_pro(''.$btn['placeholder'].''), &nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div> ), $checkout-&gt;get_value( ''.$btn['cow'].'' ));&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $btn['type'] == 'wooccmtextarea' ) {&nbsp;</div></li><li><div>                      woocommerce_form_field( ''.$btn['cow'].'' , array(&nbsp;</div></li><li><div>                          'type' =&gt; 'wooccmtextarea', &nbsp;</div></li><li><div>                          'class' =&gt; array(''.$btn['position'].' wccs-form-row-wide '.$btn['conditional_tie'].' '.$btn['extra_class'].''), &nbsp;</div></li><li><div>                          'label' =&gt;  wpml_string_wccm_pro(''.$btn['label'].''), &nbsp;</div></li><li><div>                          'wooccm_required' =&gt; ''.$btn['checkbox'].'', &nbsp;</div></li><li><div>                          'clear' =&gt; ''.$btn['clear_row'].'', &nbsp;</div></li><li><div>                          'user_role' =&gt; ''.$btn['user_role'].'', &nbsp;</div></li><li><div>                          'role_options' =&gt; ''.$btn['role_options'].'', &nbsp;</div></li><li><div>                          'role_options2' =&gt; ''.$btn['role_options2'].'', &nbsp;</div></li><li><div>                          'placeholder' =&gt; wpml_string_wccm_pro(''.$btn['placeholder'].''), &nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div> ), $checkout-&gt;get_value( ''.$btn['cow'].'' ));&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if ( $btn['type'] == 'colorpicker' ) {&nbsp;</div></li><li><div>                      woocommerce_form_field( ''.$btn['cow'].'' , array(&nbsp;</div></li><li><div>                          'type' =&gt; 'colorpicker', &nbsp;</div></li><li><div>                          'class' =&gt; array(''.$btn['position'].' '.$btn['conditional_tie'].' wccs_colorpicker '.$btn['extra_class'].''), &nbsp;</div></li><li><div>                          'label' =&gt;  wpml_string_wccm_pro(''.$btn['label'].''), &nbsp;</div></li><li><div>                          'wooccm_required' =&gt; ''.$btn['checkbox'].'', &nbsp;</div></li><li><div>                          'clear' =&gt; ''.$btn['clear_row'].'', &nbsp;</div></li><li><div>                          'user_role' =&gt; ''.$btn['user_role'].'', &nbsp;</div></li><li><div>                          'role_options' =&gt; ''.$btn['role_options'].'', &nbsp;</div></li><li><div>                          'role_options2' =&gt; ''.$btn['role_options2'].'', &nbsp;</div></li><li><div>                          'placeholder' =&gt; wpml_string_wccm_pro(''.$btn['placeholder'].''), &nbsp;</div></li><li><div>                          'color' =&gt; ''.$btn['colorpickerd'].'', &nbsp;</div></li><li><div>                          'colorpickertype' =&gt; ''.$btn['colorpickertype'].''&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div> ), $checkout-&gt;get_value( ''.$btn['cow'].'' ));&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if ( $btn['type'] == 'datepicker' ) {&nbsp;</div></li><li><div>                      woocommerce_form_field( ''.$btn['cow'].'' , array(&nbsp;</div></li><li><div>                          'type' =&gt; 'wooccmtext', &nbsp;</div></li><li><div>                          'class' =&gt; array(''.$btn['position'].' MyDate'.$btn['cow'].' wccs-form-row-wide '.$btn['conditional_tie'].' '.$btn['extra_class'].''), &nbsp;</div></li><li><div>                          'label' =&gt;  wpml_string_wccm_pro(''.$btn['label'].''), &nbsp;</div></li><li><div>                          'wooccm_required' =&gt; ''.$btn['checkbox'].'', &nbsp;</div></li><li><div>                          'user_role' =&gt; ''.$btn['user_role'].'', &nbsp;</div></li><li><div>                          'role_options' =&gt; ''.$btn['role_options'].'', &nbsp;</div></li><li><div>                          'role_options2' =&gt; ''.$btn['role_options2'].'', &nbsp;</div></li><li><div>                          'clear' =&gt; ''.$btn['clear_row'].'', &nbsp;</div></li><li><div>                          'placeholder' =&gt; wpml_string_wccm_pro(''.$btn['placeholder'].''), &nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div> ), $checkout-&gt;get_value( ''.$btn['cow'].'' ));&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if ( $btn['type'] == 'time' ) {&nbsp;</div></li><li><div>                      woocommerce_form_field( ''.$btn['cow'].'' , array(&nbsp;</div></li><li><div>                          'type' =&gt; 'wooccmtext', &nbsp;</div></li><li><div>                          'class' =&gt; array(''.$btn['position'].' MyTime'.$btn['cow'].' wccs-form-row-wide '.$btn['conditional_tie'].' '.$btn['extra_class'].''), &nbsp;</div></li><li><div>                          'label' =&gt;  wpml_string_wccm_pro(''.$btn['label'].''), &nbsp;</div></li><li><div>                          'wooccm_required' =&gt; ''.$btn['checkbox'].'', &nbsp;</div></li><li><div>                          'user_role' =&gt; ''.$btn['user_role'].'', &nbsp;</div></li><li><div>                          'role_options' =&gt; ''.$btn['role_options'].'', &nbsp;</div></li><li><div>                          'role_options2' =&gt; ''.$btn['role_options2'].'', &nbsp;</div></li><li><div>                          'clear' =&gt; ''.$btn['clear_row'].'', &nbsp;</div></li><li><div>                          'placeholder' =&gt; wpml_string_wccm_pro(''.$btn['placeholder'].''), &nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div> ), $checkout-&gt;get_value( ''.$btn['cow'].'' ));&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if ( $btn['type'] == 'checkbox_wccm' ) {&nbsp;</div></li><li><div>                      woocommerce_form_field( ''.$btn['cow'].'' , array(&nbsp;</div></li><li><div>                          'type' =&gt; 'checkbox_wccm', &nbsp;</div></li><li><div>                          'class' =&gt; array(''.$btn['position'].' '.$btn['conditional_tie'].' '.$btn['extra_class'].''), &nbsp;</div></li><li><div>                          'label' =&gt;  wpml_string_wccm_pro(''.$btn['label'].''), &nbsp;</div></li><li><div>                          'user_role' =&gt; ''.$btn['user_role'].'', &nbsp;</div></li><li><div>                          'role_options' =&gt; ''.$btn['role_options'].'', &nbsp;</div></li><li><div>                          'role_options2' =&gt; ''.$btn['role_options2'].'', &nbsp;</div></li><li><div>                          'wooccm_required' =&gt; ''.$btn['checkbox'].'', &nbsp;</div></li><li><div>                          'clear' =&gt; ''.$btn['clear_row'].'', &nbsp;</div></li><li><div>                          'options' =&gt; ''.$btn['option_array'].'', &nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div> ), $checkout-&gt;get_value( ''.$btn['cow'].'' ));&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if ( $btn['type'] == 'wooccmpassword' ) {&nbsp;</div></li><li><div>                      woocommerce_form_field( ''.$btn['cow'].'' , array(&nbsp;</div></li><li><div>                          'type' =&gt; 'wooccmpassword', &nbsp;</div></li><li><div>                          'class' =&gt; array(''.$btn['position'].' '.$btn['conditional_tie'].' '.$btn['extra_class'].' '.$btn['extra_class'].''), &nbsp;</div></li><li><div>                          'label' =&gt;  wpml_string_wccm_pro(''.$btn['label'].''), &nbsp;</div></li><li><div>                          'wooccm_required' =&gt; ''.$btn['checkbox'].'', &nbsp;</div></li><li><div>                          'user_role' =&gt; ''.$btn['user_role'].'', &nbsp;</div></li><li><div>                          'role_options' =&gt; ''.$btn['role_options'].'', &nbsp;</div></li><li><div>                          'role_options2' =&gt; ''.$btn['role_options2'].'', &nbsp;</div></li><li><div>                          'clear' =&gt; ''.$btn['clear_row'].'', &nbsp;</div></li><li><div>                          'placeholder' =&gt; ''.$btn['placeholder'].'', &nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div> ), $checkout-&gt;get_value( ''.$btn['cow'].'' ));&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if ( $btn['type'] == 'wooccmradio' ) {&nbsp;</div></li><li><div>                      woocommerce_form_field( ''.$btn['cow'].'' , array(&nbsp;</div></li><li><div>                          'type' =&gt; 'wooccmradio', &nbsp;</div></li><li><div>                          'class' =&gt; array(''.$btn['position'].' '.$btn['conditional_tie'].' '.$btn['extra_class'].''), &nbsp;</div></li><li><div>                          'label' =&gt;  wpml_string_wccm_pro(''.$btn['label'].''), &nbsp;</div></li><li><div>                          'wooccm_required' =&gt; ''.$btn['checkbox'].'', &nbsp;</div></li><li><div>                          'default' =&gt; ''.$btn['force_title2'].'', &nbsp;</div></li><li><div>                          'user_role' =&gt; ''.$btn['user_role'].'', &nbsp;</div></li><li><div>                          'role_options' =&gt; ''.$btn['role_options'].'', &nbsp;</div></li><li><div>                          'role_options2' =&gt; ''.$btn['role_options2'].'', &nbsp;</div></li><li><div>                          'clear' =&gt; ''.$btn['clear_row'].'', &nbsp;</div></li><li><div>                          'options' =&gt; ''.$btn['option_array'].'', &nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div> ), $checkout-&gt;get_value( ''.$btn['cow'].'' ));&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if ( $btn['type'] == 'multiselect' ) {&nbsp;</div></li><li><div>                      woocommerce_form_field( ''.$btn['cow'].'' , array(&nbsp;</div></li><li><div>                          'type' =&gt; 'multiselect', &nbsp;</div></li><li><div>                          'class' =&gt; array(''.$btn['position'].' '.$btn['conditional_tie'].' '.$btn['extra_class'].''), &nbsp;</div></li><li><div>                          'label' =&gt;  wpml_string_wccm_pro(''.$btn['label'].''), &nbsp;</div></li><li><div>                          'wooccm_required' =&gt; ''.$btn['checkbox'].'', &nbsp;</div></li><li><div>                          'user_role' =&gt; ''.$btn['user_role'].'', &nbsp;</div></li><li><div>                          'role_options' =&gt; ''.$btn['role_options'].'', &nbsp;</div></li><li><div>                          'role_options2' =&gt; ''.$btn['role_options2'].'', &nbsp;</div></li><li><div>                          'clear' =&gt; ''.$btn['clear_row'].'', &nbsp;</div></li><li><div>                          'options' =&gt; ''.$btn['option_array'].'', &nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div> ), $checkout-&gt;get_value( ''.$btn['cow'].'' ));&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if ( $btn['type'] == 'multicheckbox' ) {&nbsp;</div></li><li><div>                      woocommerce_form_field( ''.$btn['cow'].'' , array(&nbsp;</div></li><li><div>                          'type' =&gt; 'multicheckbox', &nbsp;</div></li><li><div>                          'class' =&gt; array(''.$btn['position'].' '.$btn['conditional_tie'].' '.$btn['extra_class'].''), &nbsp;</div></li><li><div>                          'label' =&gt;  wpml_string_wccm_pro(''.$btn['label'].''), &nbsp;</div></li><li><div>                          'wooccm_required' =&gt; ''.$btn['checkbox'].'', &nbsp;</div></li><li><div>                          'user_role' =&gt; ''.$btn['user_role'].'', &nbsp;</div></li><li><div>                          'role_options' =&gt; ''.$btn['role_options'].'', &nbsp;</div></li><li><div>                          'role_options2' =&gt; ''.$btn['role_options2'].'', &nbsp;</div></li><li><div>                          'clear' =&gt; ''.$btn['clear_row'].'', &nbsp;</div></li><li><div>                          'options' =&gt; ''.$btn['option_array'].'', &nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div> ), $checkout-&gt;get_value( ''.$btn['cow'].'' ));&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if ( $btn['type'] == 'wooccmselect' ) {&nbsp;</div></li><li><div>                      woocommerce_form_field( ''.$btn['cow'].'' , array(&nbsp;</div></li><li><div>                          'type' =&gt; 'wooccmselect', &nbsp;</div></li><li><div>                          'class' =&gt; array(''.$btn['position'].' '.$btn['conditional_tie'].' '.$btn['extra_class'].''), &nbsp;</div></li><li><div>                          'label' =&gt;  wpml_string_wccm_pro(''.$btn['label'].''), &nbsp;</div></li><li><div>                          'wooccm_required' =&gt; ''.$btn['checkbox'].'', &nbsp;</div></li><li><div>                          'clear' =&gt; ''.$btn['clear_row'].'', &nbsp;</div></li><li><div>                          'user_role' =&gt; ''.$btn['user_role'].'', &nbsp;</div></li><li><div>                          'role_options' =&gt; ''.$btn['role_options'].'', &nbsp;</div></li><li><div>                          'role_options2' =&gt; ''.$btn['role_options2'].'', &nbsp;</div></li><li><div>                          'fancy' =&gt; ''.$btn['fancy'].'', &nbsp;</div></li><li><div>                          'default' =&gt; ''.$btn['force_title2'].'', &nbsp;</div></li><li><div>                          'options' =&gt; ''.$btn['option_array'].'', &nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div> ), $checkout-&gt;get_value( ''.$btn['cow'].'' ));&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if ( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>                      woocommerce_form_field( ''.$btn['cow'].'' , array(&nbsp;</div></li><li><div>                          'type' =&gt; 'wooccmupload', &nbsp;</div></li><li><div>                          'placeholder' =&gt; ''.$btn['placeholder'].'', &nbsp;</div></li><li><div>                          'class' =&gt; array(''.$btn['position'].' '.$btn['conditional_tie'].' '.$btn['extra_class'].''), &nbsp;</div></li><li><div>                          'label' =&gt;  wpml_string_wccm_pro(''.$btn['label'].''), &nbsp;</div></li><li><div>                          'wooccm_required' =&gt; ''.$btn['checkbox'].'', &nbsp;</div></li><li><div>                          'clear' =&gt; ''.$btn['clear_row'].'', &nbsp;</div></li><li><div>                          'user_role' =&gt; ''.$btn['user_role'].'', &nbsp;</div></li><li><div>                          'role_options' =&gt; ''.$btn['role_options'].'', &nbsp;</div></li><li><div>                          'role_options2' =&gt; ''.$btn['role_options2'].'', &nbsp;</div></li><li><div>                          'fancy' =&gt; ''.$btn['fancy'].'', &nbsp;</div></li><li><div>                          'default' =&gt; ''.$btn['force_title2'].'', &nbsp;</div></li><li><div>                          'options' =&gt; ''.$btn['option_array'].'', &nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div> ), $checkout-&gt;get_value( ''.$btn['cow'].'' ));&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              endforeach;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wccs_positioning() {&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>      if ( $options['checkness']['position'] == 'before_shipping_form' ) {&nbsp;</div></li><li><div>          return 'before_shipping_form';&nbsp;</div></li><li><div>      }elseif( $options['checkness']['position'] == 'after_shipping_form' ) {&nbsp;</div></li><li><div>          return 'after_shipping_form';&nbsp;</div></li><li><div>      }elseif( $options['checkness']['position'] == 'before_billing_form' ) {&nbsp;</div></li><li><div>          return 'before_billing_form';&nbsp;</div></li><li><div>      }elseif( $options['checkness']['position'] == 'after_billing_form' ) {&nbsp;</div></li><li><div>          return 'after_billing_form';&nbsp;</div></li><li><div>      }elseif( $options['checkness']['position'] == 'after_order_notes' ) {&nbsp;</div></li><li><div>          return 'after_order_notes';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wccs_custom_checkout_field_pro_update_order_meta( $order ) {&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>              $label = ( isset( $btn['label'] ) ) ? $btn['label'] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $btn['type'] !== 'multiselect' && $btn['type'] !== 'multicheckbox' ) {&nbsp;</div></li><li><div>                  if ( $_POST[ ''.$btn['cow'].'' ]) {&nbsp;</div></li><li><div>                      update_post_meta( $order, ''.$btn['cow'].'' , $_POST[ ''.$btn['cow'].'' ] );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              } elseif ( $btn['type'] == 'multiselect' || $btn['type'] == 'multicheckbox' ) {&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if ( $_POST[ ''.$btn['cow'].'' ]) {&nbsp;</div></li><li><div>                      update_post_meta( $order, ''.$btn['cow'].'' , serialize( $_POST[ ''.$btn['cow'].'' ] ));&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wccs_custom_checkout_field_pro_process() {&nbsp;</div></li><li><div>global $woocommerce;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>          foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if( $btn['checkbox'] === 'true' ) {&nbsp;</div></li><li><div>              <span class="comment">// without checkbox</span>&nbsp;</div></li><li><div>              if ( empty($btn['single_px_cat']) && empty($btn['single_p_cat']) && empty($btn['single_px']) && empty($btn['single_p']) && !empty( $btn['label'] ) && $btn['type'] !== 'wooccmupload' && $btn['type'] !== 'changename' && ($btn['type'] !== 'heading') ) {&nbsp;</div></li><li><div>                  if (!$_POST[''.$btn['cow'].''] ) {&nbsp;</div></li><li><div>                      wc_add_notice( '&lt;strong&gt;'.wpml_string_wccm_pro($btn['label']).'&lt;/strong&gt; '.wpml_string_wccm_pro('is a required field.').'' , 'error');&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// checkbox</span>&nbsp;</div></li><li><div>              if ( empty($btn['single_px_cat']) && empty($btn['single_p_cat']) && empty($btn['single_px']) && empty($btn['single_p']) && $btn['type'] == 'checkbox' && !empty( $btn['label'] ) && $btn['type'] !== 'changename' && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'heading') ) {&nbsp;</div></li><li><div>                  if ( ($_POST[ ''.$btn['cow'].'' ] == ''.$btn['check_2'].'')  && (!empty ($btn['checkbox']) ) ) {&nbsp;</div></li><li><div>                      wc_add_notice( '&lt;strong&gt;'.wpml_string_wccm_pro($btn['label']).'&lt;/strong&gt; '.wpml_string_wccm_pro('is a required field.').'', 'error');&nbsp;</div></li><li><div>                  }               &nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> *breakdown csv and change to descending order by $key</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment">function wooccm_descending_order_csv($heading) {</span>&nbsp;</div></li><li><div><span class="comment">  $heading = str_replace( array('[&quot;Name&quot;, &quot;', '&quot;, ]', '&quot;, &quot;'), array('', '', '||'), $heading);</span>&nbsp;</div></li><li><div><span class="comment">  $heading = explode('||', $heading);</span>&nbsp;</div></li><li><div><span class="comment">  krsort($heading);</span>&nbsp;</div></li><li><div><span class="comment">  $heading = implode('||', $heading);</span>&nbsp;</div></li><li><div><span class="comment">  $heading = str_replace( '||', '&quot;, &quot;', $heading);</span>&nbsp;</div></li><li><div><span class="comment">  $heading = '[&quot;Name&quot;, &quot;'.$heading.'&quot;, ]';</span>&nbsp;</div></li><li><div><span class="comment">  </span>&nbsp;</div></li><li><div><span class="comment">  return $heading;</span>&nbsp;</div></li><li><div><span class="comment">}</span>&nbsp;</div></li><li><div><span class="comment">**/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wooccm_mul_array($val, $array) {&nbsp;</div></li><li><div>  foreach ($array as $item)&nbsp;</div></li><li><div>      if (isset($item['cow']) && $item['cow'] == $val)&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wooccm_mul_array2($val) {&nbsp;</div></li><li><div>global $wpdb;&nbsp;</div></li><li><div>  foreach ($wpdb-&gt;last_result as $item =&gt; $tru ) {&nbsp;</div></li><li><div>      if (isset($tru-&gt;meta_key) && $tru-&gt;meta_key == $val) {&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wooccm_get_value_by_key($array, $key) {&nbsp;</div></li><li><div>  foreach($array as $k=&gt;$each) {&nbsp;</div></li><li><div>      if($k==$key) {&nbsp;</div></li><li><div>      return $each;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if(is_array($each)) {&nbsp;</div></li><li><div>          if($return = wooccm_get_value_by_key($each, $key)) {&nbsp;</div></li><li><div>          return $return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wooccm_does_existw($array) {&nbsp;</div></li><li><div>  foreach( $array as $sub ) {&nbsp;</div></li><li><div>      if( wooccm_mul_array2( wooccm_get_value_by_key($sub, 'cow') ) ) {&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wccs_options_validate_pro( $input ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $detect_error = 0;&nbsp;</div></li><li><div>  <span class="comment">// translate additional fields</span>&nbsp;</div></li><li><div>  if ( !empty($input['buttons']) ) {&nbsp;</div></li><li><div>      foreach( $input['buttons'] as $i =&gt; $btn ) :&nbsp;</div></li><li><div>           &nbsp;</div></li><li><div>          if( function_exists( 'icl_register_string' ) ) {&nbsp;</div></li><li><div>              if ( !empty($btn['label']) ) {&nbsp;</div></li><li><div>                  icl_register_string('WooCommerce Checkout Manager', ''.$btn['label'].'', ''.$btn['label'].'');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( !empty($btn['placeholder']) ) {&nbsp;</div></li><li><div>                  icl_register_string('WooCommerce Checkout Manager', ''.$btn['placeholder'].'', ''.$btn['placeholder'].'');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>      if ( !empty($btn['option_array']) ) {    &nbsp;</div></li><li><div>      $mysecureop = explode( '||', $btn['option_array']);&nbsp;</div></li><li><div>          foreach ( $mysecureop as $one ) {&nbsp;</div></li><li><div>              icl_register_string('WooCommerce Checkout Manager', ''.$one.'', ''.$one.'');&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if( !empty($btn['role_options']) && !empty($btn['role_options2']) ) { &nbsp;</div></li><li><div>                       $input['buttons'][$i]['role_options2'] = '';&nbsp;</div></li><li><div>                      add_settings_error(&nbsp;</div></li><li><div>                                  'wooccm_settings_errors', &nbsp;</div></li><li><div>                                  esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                                  __( 'Sorry! An error occurred. WooCheckout requires you to not have values in both role options. OK.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                                  'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              } &nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if( !empty($btn['single_p']) && !empty($btn['single_px']) ) { &nbsp;</div></li><li><div>                       $input['buttons'][$i]['single_px'] = '';&nbsp;</div></li><li><div>                      add_settings_error(&nbsp;</div></li><li><div>                                  'wooccm_settings_errors', &nbsp;</div></li><li><div>                                  esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                                  __( 'Sorry! An error occurred. WooCheckout requires you to not have values in both hidden product options. OK.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                                  'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              } &nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if( !empty($btn['single_p_cat']) && !empty($btn['single_px_cat']) ) { &nbsp;</div></li><li><div>                       $input['buttons'][$i]['single_px_cat'] = '';&nbsp;</div></li><li><div>                      add_settings_error(&nbsp;</div></li><li><div>                                  'wooccm_settings_errors', &nbsp;</div></li><li><div>                                  esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                                  __( 'Sorry! An error occurred. WooCheckout requires you to not have values in both hidden category options. OK.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                                  'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              } &nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if( empty( $btn['cow'] ) && empty( $btn['label'] ) && empty( $btn['placeholder'] ) ) { &nbsp;</div></li><li><div>                       unset( $input['buttons'][$i] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $i != 999 ) {&nbsp;</div></li><li><div>              $detect_error++;&nbsp;</div></li><li><div>              $fieldnum = $i + 1;&nbsp;</div></li><li><div>              add_settings_error(&nbsp;</div></li><li><div>                          'wooccm_settings_errors', &nbsp;</div></li><li><div>                              esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                          __( 'Sorry! An error occurred. WooCheckout removed field # '.$fieldnum.' because no Label or Placeholder name was detected.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                          'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( empty( $btn['cow'] ) && (!empty( $btn['label'] ) || !empty( $btn['placeholder'] )) ) {&nbsp;</div></li><li><div>              $newNum = $i + 1;&nbsp;</div></li><li><div>                      if( wooccm_mul_array( 'myfield'.$newNum.'' , $input['buttons'] ) ) {&nbsp;</div></li><li><div>                          $input['buttons'][$i]['cow'] = 'myfield'.$newNum.'c';&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          $input['buttons'][$i]['cow'] = 'myfield'.$newNum.'';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if( !empty( $btn['cow'] ) && empty( $btn['label'] ) && empty( $btn['placeholder'] ) ) { &nbsp;</div></li><li><div>                       unset( $input['buttons'][$i] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $i != 999 ) {&nbsp;</div></li><li><div>              $detect_error++;&nbsp;</div></li><li><div>              $fieldnum = $i + 1;&nbsp;</div></li><li><div>              add_settings_error(&nbsp;</div></li><li><div>                          'wooccm_settings_errors', &nbsp;</div></li><li><div>                              esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                          __( 'Sorry! An error occurred. WooCheckout removed field # '.$fieldnum.' because no Label or Placeholder name was detected.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                          'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              }                        &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>      endforeach;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( $detect_error == 0 ) {&nbsp;</div></li><li><div>          add_settings_error(&nbsp;</div></li><li><div>                              'wooccm_settings_errors', &nbsp;</div></li><li><div>                              esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                              __( 'Your settings has been saved.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                              'updated'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $input;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wccs_options_validate_pro2( $input ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $detect_error = 0;&nbsp;</div></li><li><div>  <span class="comment">// translate shipping fields</span>&nbsp;</div></li><li><div>  if ( !empty($input['shipping_buttons']) ) {&nbsp;</div></li><li><div>      foreach( $input['shipping_buttons'] as $i =&gt; $btn ) :        &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>          if( function_exists( 'icl_register_string' ) ) {&nbsp;</div></li><li><div>              if ( !empty($btn['label']) ) {&nbsp;</div></li><li><div>                  icl_register_string('WooCommerce Checkout Manager', ''.$btn['label'].'', ''.$btn['label'].'');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( !empty($btn['placeholder']) ) {&nbsp;</div></li><li><div>                  icl_register_string('WooCommerce Checkout Manager', ''.$btn['placeholder'].'', ''.$btn['placeholder'].'');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>      if ( !empty($btn['option_array']) ) {    &nbsp;</div></li><li><div>      $mysecureop = explode( '||', $btn['option_array']);&nbsp;</div></li><li><div>          foreach ( $mysecureop as $one ) {&nbsp;</div></li><li><div>              icl_register_string('WooCommerce Checkout Manager', ''.$one.'', ''.$one.'');&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>                          if( !empty($btn['role_options']) && !empty($btn['role_options2']) ) { &nbsp;</div></li><li><div>                       $input['buttons'][$i]['role_options2'] = '';&nbsp;</div></li><li><div>                      add_settings_error(&nbsp;</div></li><li><div>                                  'wooccm_settings_errors', &nbsp;</div></li><li><div>                                  esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                                  __( 'Sorry! An error occurred. WooCheckout requires you to not have values in both role options.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                                  'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              } &nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if( !empty($btn['single_p']) && !empty($btn['single_px']) ) { &nbsp;</div></li><li><div>                       $input['buttons'][$i]['single_px'] = '';&nbsp;</div></li><li><div>                      add_settings_error(&nbsp;</div></li><li><div>                                  'wooccm_settings_errors', &nbsp;</div></li><li><div>                                  esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                                  __( 'Sorry! An error occurred. WooCheckout requires you to not have values in both hidden product options.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                                  'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              } &nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if( !empty($btn['single_p_cat']) && !empty($btn['single_px_cat']) ) { &nbsp;</div></li><li><div>                       $input['buttons'][$i]['single_px_cat'] = '';&nbsp;</div></li><li><div>                      add_settings_error(&nbsp;</div></li><li><div>                                  'wooccm_settings_errors', &nbsp;</div></li><li><div>                                  esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                                  __( 'Sorry! An error occurred. WooCheckout requires you to not have values in both hidden category options.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                                  'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>                  if( empty( $btn['cow'] ) && empty( $btn['label'] ) && empty( $btn['placeholder'] ) ) { &nbsp;</div></li><li><div>                       unset( $input['shipping_buttons'][$i] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $i != 999 ) {&nbsp;</div></li><li><div>              $detect_error++;&nbsp;</div></li><li><div>              $fieldnum = $i + 1;&nbsp;</div></li><li><div>                  add_settings_error(&nbsp;</div></li><li><div>                          'wooccm_settings_errors', &nbsp;</div></li><li><div>                              esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                          __( 'Sorry! An error occurred. WooCheckout removed field # '.$fieldnum.' because no Label or Placeholder name was detected.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                          'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( empty( $btn['cow'] ) && (!empty( $btn['label'] ) || !empty( $btn['placeholder'] )) ) {&nbsp;</div></li><li><div>              $newNum = $i + 1;&nbsp;</div></li><li><div>                         if( wooccm_mul_array( 'myfield'.$newNum.'' , $input['shipping_buttons'] ) ) {&nbsp;</div></li><li><div>                          $input['shipping_buttons'][$i]['cow'] = 'myfield'.$newNum.'c';&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          $input['shipping_buttons'][$i]['cow'] = 'myfield'.$newNum.'';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      } &nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      if( !empty( $btn['cow'] ) && empty( $btn['label'] ) && empty( $btn['placeholder'] ) ) { &nbsp;</div></li><li><div>                       unset( $input['shipping_buttons'][$i] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $i != 999 ) {&nbsp;</div></li><li><div>              $detect_error++;&nbsp;</div></li><li><div>              $fieldnum = $i + 1;&nbsp;</div></li><li><div>              add_settings_error(&nbsp;</div></li><li><div>                          'wooccm_settings_errors', &nbsp;</div></li><li><div>                              esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                          __( 'Sorry! An error occurred. WooCheckout removed field # '.$fieldnum.' because no Label or Placeholder name was detected.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                          'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>      endforeach;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( $detect_error == 0 ) {&nbsp;</div></li><li><div>          add_settings_error(&nbsp;</div></li><li><div>                              'wooccm_settings_errors', &nbsp;</div></li><li><div>                              esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                              __( 'Your settings has been saved.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                              'updated'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $input;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wccs_options_validate_pro3( $input ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $detect_error = 0;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">// translate billing fields</span>&nbsp;</div></li><li><div>  if ( !empty($input['billing_buttons']) ) {&nbsp;</div></li><li><div>      foreach( $input['billing_buttons'] as $i =&gt; $btn ) :&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>          if( function_exists( 'icl_register_string' ) ) {&nbsp;</div></li><li><div>              if ( !empty($btn['label']) ) {&nbsp;</div></li><li><div>                  icl_register_string('WooCommerce Checkout Manager', ''.$btn['label'].'', ''.$btn['label'].'');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( !empty($btn['placeholder']) ) {&nbsp;</div></li><li><div>                  icl_register_string('WooCommerce Checkout Manager', ''.$btn['placeholder'].'', ''.$btn['placeholder'].'');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>      if ( !empty($btn['option_array']) ) {    &nbsp;</div></li><li><div>      $mysecureop = explode( '||', $btn['option_array']);&nbsp;</div></li><li><div>          foreach ( $mysecureop as $one ) {&nbsp;</div></li><li><div>              icl_register_string('WooCommerce Checkout Manager', ''.$one.'', ''.$one.'');&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>              if( !empty($btn['role_options']) && !empty($btn['role_options2']) ) { &nbsp;</div></li><li><div>                       $input['buttons'][$i]['role_options2'] = '';&nbsp;</div></li><li><div>                      add_settings_error(&nbsp;</div></li><li><div>                                  'wooccm_settings_errors', &nbsp;</div></li><li><div>                                  esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                                  __( 'Sorry! An error occurred. WooCheckout requires you to not have values in both role options.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                                  'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              } &nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if( !empty($btn['single_p']) && !empty($btn['single_px']) ) { &nbsp;</div></li><li><div>                       $input['buttons'][$i]['single_px'] = '';&nbsp;</div></li><li><div>                      add_settings_error(&nbsp;</div></li><li><div>                                  'wooccm_settings_errors', &nbsp;</div></li><li><div>                                  esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                                  __( 'Sorry! An error occurred. WooCheckout requires you to not have values in both hidden product options.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                                  'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              } &nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if( !empty($btn['single_p_cat']) && !empty($btn['single_px_cat']) ) { &nbsp;</div></li><li><div>                       $input['buttons'][$i]['single_px_cat'] = '';&nbsp;</div></li><li><div>                      add_settings_error(&nbsp;</div></li><li><div>                                  'wooccm_settings_errors', &nbsp;</div></li><li><div>                                  esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                                  __( 'Sorry! An error occurred. WooCheckout requires you to not have values in both hidden category options.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                                  'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>                if( empty( $btn['cow'] ) && empty( $btn['label'] ) && empty( $btn['placeholder'] ) ) { &nbsp;</div></li><li><div>                       unset( $input['billing_buttons'][$i] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $i != 999 ) {&nbsp;</div></li><li><div>              $detect_error++;&nbsp;</div></li><li><div>              $fieldnum = $i + 1;&nbsp;</div></li><li><div>              add_settings_error(&nbsp;</div></li><li><div>                          'wooccm_settings_errors', &nbsp;</div></li><li><div>                              esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                          __( 'Sorry! An error occurred. WooCheckout removed field # '.$fieldnum.' because no Label or Placeholder name was detected.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                          'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( empty( $btn['cow'] ) && (!empty( $btn['label'] ) || !empty( $btn['placeholder'] )) ) {&nbsp;</div></li><li><div>              $newNum = $i + 1;&nbsp;</div></li><li><div>                          if( wooccm_mul_array( 'myfield'.$newNum.'' , $input['billing_buttons'] ) ) {&nbsp;</div></li><li><div>                          $input['billing_buttons'][$i]['cow'] = 'myfield'.$newNum.'c';&nbsp;</div></li><li><div>                          } else {&nbsp;</div></li><li><div>                              $input['billing_buttons'][$i]['cow'] = 'myfield'.$newNum.'';&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>              if( !empty( $btn['cow'] ) && empty( $btn['label'] ) && empty( $btn['placeholder'] ) ) { &nbsp;</div></li><li><div>              $detect_error++;&nbsp;</div></li><li><div>                       unset( $input['billing_buttons'][$i] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $i != 999 ) {&nbsp;</div></li><li><div>              $detect_error++;&nbsp;</div></li><li><div>              $fieldnum = $i + 1;&nbsp;</div></li><li><div>              add_settings_error(&nbsp;</div></li><li><div>                          'wooccm_settings_errors', &nbsp;</div></li><li><div>                              esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                          __( 'Sorry! An error occurred. WooCheckout removed field # '.$fieldnum.' because no Label or Placeholder name was detected.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                          'error'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>      endforeach;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( $detect_error == 0 ) {&nbsp;</div></li><li><div>          add_settings_error(&nbsp;</div></li><li><div>                              'wooccm_settings_errors', &nbsp;</div></li><li><div>                              esc_attr( 'settings_updated' ), &nbsp;</div></li><li><div>                              __( 'Your settings has been saved.', 'woocommerce-checkout-manager' ), &nbsp;</div></li><li><div>                              'updated'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $input;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wccs_custom_checkout_details_pro( $order) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$shipping = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode' );&nbsp;</div></li><li><div>$billing = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode', 'email', 'phone' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$names = array( 'billing', 'shipping' );&nbsp;</div></li><li><div>$inc = 3;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( defined( 'WOOCOMMERCE_VERSION' ) && version_compare( WOOCOMMERCE_VERSION, '2.3', '&gt;=' ) ) {&nbsp;</div></li><li><div>foreach( $names as $name ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$array = ($name == 'billing') ? $billing : $shipping;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings'.$inc.'' );&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>          foreach ( $options[''.$name.'_buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !in_array( $btn['cow'], $array ) ) {&nbsp;</div></li><li><div>              if (  (''.get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] !== 'heading') && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'multiselect') && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                  echo '&lt;tr&gt;&lt;th&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/th&gt; &lt;td&gt;'.nl2br(get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true)).'&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              } elseif ( !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] == 'heading') && ($btn['type'] !== 'multiselect') && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                  echo '&lt;tr&gt;&lt;th colspan=&quot;2&quot;&gt;' .wpml_string_wccm_pro($btn['label']). '&lt;/th&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              } elseif (  (''.get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true).'' !== '') && $btn['type'] !== 'wooccmupload' && !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] !== 'heading') && (($btn['type'] == 'multiselect') || ($btn['type'] == 'multicheckbox')) ) {&nbsp;</div></li><li><div>                  $strings = unserialize(get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true));&nbsp;</div></li><li><div>                  echo '&lt;tr&gt;&lt;th&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/th&gt;';&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>                  foreach($strings as $key ) {&nbsp;</div></li><li><div>                      echo '&lt;td data-title=&quot;' .wpml_string_wccm_pro($btn['label']). '&quot;&gt;'.wpml_string_wccm_pro($key).'&lt;/td&gt;';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  echo '&lt;/tr&gt;';&nbsp;</div></li><li><div>              }elseif( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>                  $info = explode(&quot;||&quot;, get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true));&nbsp;</div></li><li><div>                   echo '&lt;tr&gt;&lt;th&gt;'.wpml_string_wccm_pro($btn['force_title2']).':&lt;/th&gt; &lt;td&gt;'.$info[0].'&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>           endforeach;&nbsp;</div></li><li><div>$inc--;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>          foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if (  (''.get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] !== 'heading') && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'multiselect') && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                  echo '&lt;tr&gt;&lt;th&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/th&gt;&lt;td data-title=&quot;' .wpml_string_wccm_pro($btn['label']). '&quot;&gt;'.nl2br(get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true)).'&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              } elseif ( !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] == 'heading') && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'multiselect') && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                  echo '&lt;tr&gt;&lt;th colspan=&quot;2&quot;&gt;' .wpml_string_wccm_pro($btn['label']). '&lt;/th&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              } elseif (  (''.get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] !== 'heading') && $btn['type'] !== 'wooccmupload' && (($btn['type'] == 'multiselect') || ($btn['type'] == 'multicheckbox')) ) {&nbsp;</div></li><li><div>                  $strings = unserialize(get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true));&nbsp;</div></li><li><div>                  echo '&lt;tr&gt;&lt;th&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/th&gt;';&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>                  foreach($strings as $key ) {&nbsp;</div></li><li><div>                      echo '&lt;td data-title=&quot;' .wpml_string_wccm_pro($btn['label']). '&quot;&gt;'.wpml_string_wccm_pro($key).'&lt;/td&gt;';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  echo '&lt;/tr&gt;';&nbsp;</div></li><li><div>              }elseif( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>                  $info = explode(&quot;||&quot;, get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true));&nbsp;</div></li><li><div>                  echo '&lt;tr&gt;&lt;th&gt;'.wpml_string_wccm_pro($btn['force_title2']).':&lt;/th&gt;&lt;td data-title=&quot;' .wpml_string_wccm_pro($btn['force_title2']). '&quot;&gt;'.$info[0].'&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>           endforeach;&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>foreach( $names as $name ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$array = ($name == 'billing') ? $billing : $shipping;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings'.$inc.'' );&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>          foreach ( $options[''.$name.'_buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !in_array( $btn['cow'], $array ) ) {&nbsp;</div></li><li><div>              if (  (''.get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] !== 'heading') && ($btn['type'] !== 'multiselect') && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                  echo '&lt;dt&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/dt&gt; &lt;dd&gt;'.nl2br(get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true)).'&lt;/dd&gt;';&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              } elseif ( !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] == 'heading') && ($btn['type'] !== 'multiselect') && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                  echo '&lt;h2&gt;' .wpml_string_wccm_pro($btn['label']). '&lt;/h2&gt;';&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              } elseif (  (''.get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] !== 'heading') && (($btn['type'] == 'multiselect') || ($btn['type'] == 'multicheckbox')) ) {&nbsp;</div></li><li><div>                  $strings = unserialize(get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true));&nbsp;</div></li><li><div>                  echo '&lt;dt&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/dt&gt;&lt;dd&gt;';&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>                  foreach($strings as $key ) {&nbsp;</div></li><li><div>                      echo ''.wpml_string_wccm_pro($key).', ';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  echo '&lt;/dd&gt;';&nbsp;</div></li><li><div>              }elseif( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>                  $info = explode(&quot;||&quot;, get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true));&nbsp;</div></li><li><div>                  echo '&lt;dt&gt;'.wpml_string_wccm_pro($btn['force_title2']).':&lt;/dt&gt; &lt;dd&gt;'.$info[0].'&lt;/dd&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>           endforeach;&nbsp;</div></li><li><div>$inc--;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>          foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if (  (''.get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] !== 'heading') && ($btn['type'] !== 'wooccmupload' && $btn['type'] !== 'multiselect') && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                  echo '&lt;dt&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/dt&gt; &lt;dd&gt;'.nl2br(get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true)).'&lt;/dd&gt;';&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              } elseif ( !empty( $btn['label'] ) && $btn['type'] !== 'wooccmupload' && empty( $btn['deny_receipt'] ) && ($btn['type'] == 'heading') && ($btn['type'] !== 'multiselect') && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                  echo '&lt;h2&gt;' .wpml_string_wccm_pro($btn['label']). '&lt;/h2&gt;';&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              } elseif (  (''.get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && empty( $btn['deny_receipt'] ) && ($btn['type'] !== 'heading') && $btn['type'] !== 'wooccmupload' && (($btn['type'] == 'multiselect') || ($btn['type'] == 'multicheckbox')) ) {&nbsp;</div></li><li><div>                  $strings = unserialize(get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true));&nbsp;</div></li><li><div>                  echo '&lt;dt&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/dt&gt;&lt;dd&gt;';&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>                  foreach($strings as $key ) {&nbsp;</div></li><li><div>                      echo ''.wpml_string_wccm_pro($key).', ';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  echo '&lt;/dd&gt;';&nbsp;</div></li><li><div>              }elseif( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>                  $info = explode(&quot;||&quot;, get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true));&nbsp;</div></li><li><div>                   echo '&lt;dt&gt;'.wpml_string_wccm_pro($btn['force_title2']).':&lt;/dt&gt; &lt;dd&gt;'.$info[0].'&lt;/dd&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>           endforeach;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wccm_checkout_text_after() {&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>      if ( !empty($options['checkness']['text2']) ) {&nbsp;</div></li><li><div>          if ( $options['checkness']['checkbox3'] == true || $options['checkness']['checkbox4'] == true ) {&nbsp;</div></li><li><div>              if ( $options['checkness']['checkbox4'] == true ) {&nbsp;</div></li><li><div>                  echo ''.$options['checkness']['text2'].'';&nbsp;</div></li><li><div>      }}}&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if ( !empty($options['checkness']['text1']) ) {&nbsp;</div></li><li><div>          if ( $options['checkness']['checkbox1'] == true || $options['checkness']['checkbox2'] == true ) {&nbsp;</div></li><li><div>              if ( $options['checkness']['checkbox2'] == true ) {&nbsp;</div></li><li><div>                  echo ''.$options['checkness']['text1'].'';&nbsp;</div></li><li><div>      }}}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>function wccm_checkout_text_before() {&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>      if ( !empty($options['checkness']['text2']) ) {&nbsp;</div></li><li><div>          if ( $options['checkness']['checkbox3'] == true || $options['checkness']['checkbox4'] == true ) {&nbsp;</div></li><li><div>              if ( $options['checkness']['checkbox3'] == true ) {&nbsp;</div></li><li><div>                  echo ''.$options['checkness']['text2'].'';&nbsp;</div></li><li><div>      }}}&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if ( !empty($options['checkness']['text1']) ) {&nbsp;</div></li><li><div>          if ( $options['checkness']['checkbox1'] == true || $options['checkness']['checkbox2'] == true ) {&nbsp;</div></li><li><div>              if ( $options['checkness']['checkbox1'] == true ) {&nbsp;</div></li><li><div>                  echo ''.$options['checkness']['text1'].'';&nbsp;</div></li><li><div>      }}}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wooccm_clean($string) {&nbsp;</div></li><li><div>  $trim_length = 200;  <span class="comment">//desired length of text to display</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $string = str_replace('-', '', $string); <span class="comment">// Replaces all spaces with hyphens.</span>&nbsp;</div></li><li><div>  $string = preg_replace('/[^A-Za-z0-9\-]/', '', $string); <span class="comment">// Removes special chars.</span>&nbsp;</div></li><li><div><span class="comment">//  $string = preg_replace('/\s+/', '', strip_tags($string)); // removes html and spaces</span>&nbsp;</div></li><li><div><span class="comment">//  $string = preg_replace('/\d/', '', $string); // Replaces multiple hyphens with single one.</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>return rtrim(substr($string, 0, $trim_length));&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Billing</span>&nbsp;</div></li><li><div>function delta_wccs_custom_checkout_details_pro_billing( $order ) {&nbsp;</div></li><li><div>  global $post;&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>?&gt; &lt;style type=&quot;text/css&quot;&gt;#order_data .order_data_column strong { display: block; }&lt;/style&gt; &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $options = get_option( 'wccs_settings3' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$billing = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode', 'email', 'phone' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( $options['billing_buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( !in_array( $btn['cow'], $billing )) {&nbsp;</div></li><li><div>                  if ( (''.get_post_meta( $order-&gt;id , '_billing_'.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && ($btn['type'] !== 'heading') && ($btn['type'] !== 'multiselect') && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                      echo '&lt;p&gt;&lt;strong&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/strong&gt; '.nl2br(get_post_meta( $order-&gt;id , '_billing_'.$btn['cow'].'', true)).'&lt;/p&gt;';&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  } elseif  ( !empty( $btn['label'] ) && $btn['type'] !== 'wooccmupload' && ($btn['type'] == 'heading') && ($btn['type'] !== 'multiselect') && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                      echo '&lt;h4&gt;' .wpml_string_wccm_pro($btn['label']). '&lt;/h4&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  } elseif ( (''.get_post_meta( $order-&gt;id , '_billing_'.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && ($btn['type'] !== 'heading') && $btn['type'] !== 'wooccmupload' && (($btn['type'] == 'multiselect') || ($btn['type'] == 'multicheckbox')) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $strings = unserialize(get_post_meta( $order-&gt;id , '_billing_'.$btn['cow'].'', true));&nbsp;</div></li><li><div>                      $iww = 0;&nbsp;</div></li><li><div>                      $len = count($strings);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      echo '&lt;p&gt;&lt;strong&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/strong&gt; ';&nbsp;</div></li><li><div>                          foreach($strings as $key ) {&nbsp;</div></li><li><div>                              if ($iww == $len - 1) {&nbsp;</div></li><li><div>                                      echo ''.wpml_string_wccm_pro($key).'';&nbsp;</div></li><li><div>                                  } else {&nbsp;</div></li><li><div>                                                  echo ''.wpml_string_wccm_pro($key).', ';&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          $iww++;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          echo '&lt;/p&gt;';&nbsp;</div></li><li><div>                  }elseif( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>                      $info = explode(&quot;||&quot;, get_post_meta( $order-&gt;id , 'billing_'.$btn['cow'].'', true));&nbsp;</div></li><li><div>                      echo '&lt;p&gt;&lt;strong&gt;'.wpml_string_wccm_pro($btn['force_title2']).':&lt;/strong&gt; '.$info[0].'&lt;/p&gt;';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>                  endforeach;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Shipping</span>&nbsp;</div></li><li><div>function delta_wccs_custom_checkout_details_pro_shipping( $order ) {&nbsp;</div></li><li><div>  global $post;&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>?&gt; &lt;style type=&quot;text/css&quot;&gt;#order_data .order_data_column strong { display: block; }&lt;/style&gt; &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$shipping = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $options = get_option( 'wccs_settings2' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( $options['shipping_buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !in_array( $btn['cow'], $shipping ) ) {&nbsp;</div></li><li><div>                  if ( (''.get_post_meta( $order-&gt;id , '_shipping_'.$btn['cow'].'', true).'' !== '') && $btn['type'] !== 'wooccmupload' && !empty( $btn['label'] ) && ($btn['type'] !== 'heading') && ($btn['type'] !== 'multiselect') && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                      echo '&lt;p&gt;&lt;strong&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/strong&gt; '.nl2br(get_post_meta( $order-&gt;id , '_shipping_'.$btn['cow'].'', true)).'&lt;/p&gt;';&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  } elseif  ( !empty( $btn['label'] ) && ($btn['type'] == 'heading') && ($btn['type'] !== 'multiselect') && ($btn['type'] !== 'multicheckbox') ) {&nbsp;</div></li><li><div>                      echo '&lt;h4&gt;' .wpml_string_wccm_pro($btn['label']). '&lt;/h4&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  } elseif ( (''.get_post_meta( $order-&gt;id , '_shipping_'.$btn['cow'].'', true).'' !== '') && !empty( $btn['label'] ) && ($btn['type'] !== 'heading') && $btn['type'] !== 'wooccmupload' && (($btn['type'] == 'multiselect') || ($btn['type'] == 'multicheckbox')) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $strings = unserialize(get_post_meta( $order-&gt;id , '_shipping_'.$btn['cow'].'', true));&nbsp;</div></li><li><div>                      $iww = 0;&nbsp;</div></li><li><div>                      $len = count($strings);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      echo '&lt;p&gt;&lt;strong&gt;'.wpml_string_wccm_pro($btn['label']).':&lt;/strong&gt; ';&nbsp;</div></li><li><div>                          foreach($strings as $key ) {&nbsp;</div></li><li><div>                              if ($iww == $len - 1) {&nbsp;</div></li><li><div>                                      echo ''.wpml_string_wccm_pro($key).'';&nbsp;</div></li><li><div>                                  } else {&nbsp;</div></li><li><div>                                                  echo ''.wpml_string_wccm_pro($key).', ';&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          $iww++;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          echo '&lt;/p&gt;';&nbsp;</div></li><li><div>                  }elseif( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>                      $info = explode(&quot;||&quot;, get_post_meta( $order-&gt;id , '_shipping_'.$btn['cow'].'', true));&nbsp;</div></li><li><div>                      echo '&lt;p&gt;&lt;strong&gt;'.wpml_string_wccm_pro($btn['force_title2']).':&lt;/strong&gt; '.$info[0].'&lt;/p&gt;';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>                  endforeach;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function remove_fields_filter($fields) {&nbsp;</div></li><li><div>  global $woocommerce;&nbsp;</div></li><li><div>      $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>          foreach ($woocommerce-&gt;cart-&gt;cart_contents as $key =&gt; $values ) {&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>              $multiCategoriesx = $options['checkness']['productssave'];&nbsp;</div></li><li><div>              $multiCategoriesArrayx = explode(', ', $multiCategoriesx);&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if(in_array($values['product_id'], $multiCategoriesArrayx) && ($woocommerce-&gt;cart-&gt;cart_contents_count &lt; 2) ) {&nbsp;</div></li><li><div>                  unset($fields['billing']['billing_address_1']);&nbsp;</div></li><li><div>                  unset($fields['billing']['billing_address_2']);&nbsp;</div></li><li><div>                  unset($fields['billing']['billing_phone']);&nbsp;</div></li><li><div>                  unset($fields['billing']['billing_country']);&nbsp;</div></li><li><div>                  unset($fields['billing']['billing_city']);&nbsp;</div></li><li><div>                  unset($fields['billing']['billing_postcode']);&nbsp;</div></li><li><div>                  unset($fields['billing']['billing_state']);&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>  return $fields;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function remove_fields_filter3($fields) {&nbsp;</div></li><li><div>  global $woocommerce;&nbsp;</div></li><li><div>      $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>          foreach ($woocommerce-&gt;cart-&gt;cart_contents as $key =&gt; $values ) {&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>              $multiCategoriesx = $options['checkness']['productssave'];&nbsp;</div></li><li><div>              $multiCategoriesArrayx = explode(', ', $multiCategoriesx);&nbsp;</div></li><li><div>              $_product = $values['data'];&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if( ($woocommerce-&gt;cart-&gt;cart_contents_count &gt; 1) && ($_product-&gt;needs_shipping()) ) {&nbsp;</div></li><li><div>                  remove_filter('woocommerce_checkout_fields', 'remove_fields_filter', 15);&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>  return $fields;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function woocmmatl() { &nbsp;</div></li><li><div>  global    $wp_version; &nbsp;</div></li><li><div>      wooccmadd();&nbsp;</div></li><li><div>      if ( wooccmcurr() ) {&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }            &nbsp;</div></li><li><div>          return false; &nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( validator_changename() ) {&nbsp;</div></li><li><div>function wccm_before_checkout() {&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>          foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>              $label = ( isset( $btn['label'] ) ) ? $btn['label'] : '';&nbsp;</div></li><li><div>                  ob_start();&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wccm_after_checkout() {&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if ( $btn['type'] == 'changename' ) {&nbsp;</div></li><li><div>                  $content = ob_get_clean();&nbsp;</div></li><li><div>                  echo str_replace( ''.$btn['changenamep'].'', ''.$btn['changename'].'', $content);                   &nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function display_front_wccs_pro() {&nbsp;</div></li><li><div>  global $woocommerce;&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_checkout() ) {&nbsp;</div></li><li><div>      if (!empty($options['checkness']['additional_info'])) {&nbsp;</div></li><li><div>          echo '&lt;style type=&quot;text/css&quot;&gt;.woocommerce-shipping-fields h3:first-child { display: none; }&lt;/style&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo '&lt;style type=&quot;text/css&quot;&gt;'.$options['checkness']['custom_css_w'].' &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      @media screen and (max-width: 685px) {&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          .woocommerce .checkout .container .wooccm-btn {&nbsp;</div></li><li><div>              padding: 1% 6% !important;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      @media screen and (max-width: 685px) {&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          .woocommerce .checkout .container .wooccm-btn {&nbsp;</div></li><li><div>              padding: 1% 8% !important;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      @media screen and (max-width: 770px) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          .checkout .wooccm_each_file .wooccm-image-holder {&nbsp;</div></li><li><div>              width: 20% !important;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          .checkout name.wooccm_name, .wooccm_each_file span.container{&nbsp;</div></li><li><div>              width: 80% !important;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          .checkout .container .wooccm-btn {&nbsp;</div></li><li><div>              padding: 1% 10% !important;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      @media screen and (max-width: 992px) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          .wooccm_each_file .wooccm-image-holder {&nbsp;</div></li><li><div>              width: 26% !important;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          name.wooccm_name, .wooccm_each_file span.container{&nbsp;</div></li><li><div>              width: 74% !important;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          .container .wooccm-btn {&nbsp;</div></li><li><div>              padding: 5px 8px !important;&nbsp;</div></li><li><div>              font-size: 12px !important;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      .container .wooccm-btn {&nbsp;</div></li><li><div>          padding: 1.7% 6.7%;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      #caman_content .blockUI.blockOverlay:before, #caman_content .loader:before {&nbsp;</div></li><li><div>        height: 1em;&nbsp;</div></li><li><div>        width: 1em;&nbsp;</div></li><li><div>        position: absolute;&nbsp;</div></li><li><div>        top: 50%;&nbsp;</div></li><li><div>        left: 50%;&nbsp;</div></li><li><div>        margin-left: -.5em;&nbsp;</div></li><li><div>        margin-top: -.5em;&nbsp;</div></li><li><div>        display: block;&nbsp;</div></li><li><div>        -webkit-animation: spin 1s ease-in-out infinite;&nbsp;</div></li><li><div>        -moz-animation: spin 1s ease-in-out infinite;&nbsp;</div></li><li><div>        animation: spin 1s ease-in-out infinite;&nbsp;</div></li><li><div>        content: &quot;&quot;;&nbsp;</div></li><li><div>        background: url('.plugins_url('woocommerce/assets/images/icons/loader.svg').') center center/cover;&nbsp;</div></li><li><div>        line-height: 1;&nbsp;</div></li><li><div>        text-align: center;&nbsp;</div></li><li><div>        font-size: 2em;&nbsp;</div></li><li><div>        color: rgba(0, 0, 0, .75);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      .file_upload_button_hide { display: none !important; }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      .wooccm_each_file {&nbsp;</div></li><li><div>          display: block;&nbsp;</div></li><li><div>          padding-top: 20px;&nbsp;</div></li><li><div>          clear: both;&nbsp;</div></li><li><div>          text-align: center;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      .wooccm_each_file .wooccm-image-holder {&nbsp;</div></li><li><div>          width: 20%;&nbsp;</div></li><li><div>          display: block;&nbsp;</div></li><li><div>          float: left;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      .wooccm-btn.disable {&nbsp;</div></li><li><div>          margin-right: 10px;&nbsp;</div></li><li><div>          cursor: auto;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      zoom.wooccm_zoom, edit.wooccm_edit, dele.wooccm_dele {&nbsp;</div></li><li><div>          padding: 5px;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      .wooccm_each_file name {&nbsp;</div></li><li><div>          font-size: 18px;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      name.wooccm_name, .wooccm_each_file span.container {&nbsp;</div></li><li><div>        display: block;&nbsp;</div></li><li><div>        padding: 0 0 10px 20px;&nbsp;</div></li><li><div>        float: left;&nbsp;</div></li><li><div>        width: 80%;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      .wooccm_each_file img{ &nbsp;</div></li><li><div>                display: inline-block;&nbsp;</div></li><li><div>                  height: 90px !Important;&nbsp;</div></li><li><div>                  border: 2px solid #767676 !important;&nbsp;</div></li><li><div>                  border-radius: 4px;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                                  .file_upload_account:before{ content: &quot;\f317&quot;;font-family: dashicons; margin-right: 10px; }&nbsp;</div></li><li><div>                                  .wooccm_each_file .wooccm_zoom:before{ content: &quot;\f179&quot;;font-family: dashicons; margin-right: 5px; }&nbsp;</div></li><li><div>                                  .wooccm_each_file .wooccm_edit:before{ content: &quot;\f464&quot;;font-family: dashicons; margin-right: 5px; }&nbsp;</div></li><li><div>                                  .wooccm_each_file .wooccm_dele:before{ content: &quot;\f158&quot;;font-family: dashicons; margin-right: 5px; }&nbsp;</div></li><li><div>.wooccm-btn{&nbsp;</div></li><li><div>display: inline-block;&nbsp;</div></li><li><div>padding: 6px 12px;&nbsp;</div></li><li><div>margin-bottom: 0;&nbsp;</div></li><li><div>font-size: 14px;&nbsp;</div></li><li><div>font-weight: 400;&nbsp;</div></li><li><div>line-height: 1.42857143;&nbsp;</div></li><li><div>text-align: center;&nbsp;</div></li><li><div>white-space: nowrap;&nbsp;</div></li><li><div>vertical-align: middle;&nbsp;</div></li><li><div>cursor: pointer;&nbsp;</div></li><li><div>-webkit-user-select: none;&nbsp;</div></li><li><div>-moz-user-select: none;&nbsp;</div></li><li><div>-ms-user-select: none;&nbsp;</div></li><li><div>user-select: none;&nbsp;</div></li><li><div>background-image: none;&nbsp;</div></li><li><div>border: 1px solid transparent;&nbsp;</div></li><li><div>border-radius: 4px;&nbsp;</div></li><li><div>font-family: &quot;Raleway&quot;, Arial, Helvetica, sans-serif; &nbsp;</div></li><li><div>color: #767676;&nbsp;</div></li><li><div>background-color: buttonface;&nbsp;</div></li><li><div>align-items: flex-start;&nbsp;</div></li><li><div>text-indent: 0px;&nbsp;</div></li><li><div>text-shadow: none;&nbsp;</div></li><li><div>letter-spacing: normal;&nbsp;</div></li><li><div>word-spacing: normal;&nbsp;</div></li><li><div>text-rendering: auto;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>.wooccm-btn-primary {&nbsp;</div></li><li><div>width: 100%;&nbsp;</div></li><li><div>color: #fff;&nbsp;</div></li><li><div>background-color: #428bca;&nbsp;</div></li><li><div>border-color: #357ebd;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>.wooccm-btn-danger {&nbsp;</div></li><li><div>color: #fff;&nbsp;</div></li><li><div>background-color: #d9534f;&nbsp;</div></li><li><div>border-color: #d43f3a;&nbsp;</div></li><li><div>  margin-right: 10px;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>.wooccm_each_file .container a:hover, .wooccm_each_file .container a:focus, .wooccm_each_file .container a:active, .wooccm_each_file .container a:visited, .wooccm_each_file .container a:link {&nbsp;</div></li><li><div>color: #fff !important;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>#caman_content #wooccmtoolbar #close:hover, #caman_content #wooccmtoolbar #save:hover {&nbsp;</div></li><li><div>background: #1B1917 !Important;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>.wooccm-btn-zoom {&nbsp;</div></li><li><div>color: #fff;&nbsp;</div></li><li><div>background-color: #5cb85c;&nbsp;</div></li><li><div>border-color: #4cae4c;&nbsp;</div></li><li><div>  margin-right: 10px;&nbsp;</div></li><li><div>} &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>.wooccm-btn-edit {&nbsp;</div></li><li><div>color: #fff;&nbsp;</div></li><li><div>background-color: #f0ad4e;&nbsp;</div></li><li><div>border-color: #eea236;&nbsp;</div></li><li><div>  margin-right: 10px;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/style&gt;';&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment"><span class="comment"><span class="comment"><span class="comment">// -----------------------------------------------------------</span></span></span></span>&nbsp;</div></li><li><div><span class="comment"><span class="comment"><span class="comment"><span class="comment">// -----------------------------------------------------------</span></span></span></span>&nbsp;</div></li><li><div><span class="comment"><span class="comment"><span class="comment"><span class="comment">// -----------------------------------------------------------</span></span></span></span>&nbsp;</div></li><li><div><span class="comment"><span class="comment"><span class="comment"><span class="comment">// -----------------------------------------------------------</span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function validator_changename() {&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>          if ( !empty($options['buttons']) ) {&nbsp;</div></li><li><div>          foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>              if (!empty($btn['type']) ) {&nbsp;</div></li><li><div>                  if ( $btn['type'] == 'changename' && !empty($btn['label']) ) {&nbsp;</div></li><li><div>                  return true;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( validator_changename() ) {&nbsp;</div></li><li><div>function string_replacer_wccs( $order ) {&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;header&gt;&nbsp;</div></li><li><div>          &lt;h2&gt;&lt;?php _e( 'Customer details', 'woocommerce' ); ?&gt;&lt;/h2&gt;&nbsp;</div></li><li><div>      &lt;/header&gt;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      &lt;dl class=&quot;customer_details&quot;&gt;&nbsp;</div></li><li><div>          &lt;?php &nbsp;</div></li><li><div>          if ($order-&gt;billing_email) echo '&lt;dt&gt;'.__( 'Email:', 'woocommerce' ).'&lt;/dt&gt;&lt;dd&gt;'.$order-&gt;billing_email.'&lt;/dd&gt;';&nbsp;</div></li><li><div>          if ($order-&gt;billing_phone) echo '&lt;dt&gt;'.__( 'Telephone:', 'woocommerce' ).'&lt;/dt&gt;&lt;dd&gt;'.$order-&gt;billing_phone.'&lt;/dd&gt;';&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>      &lt;/dl&gt;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      &lt;?php if (get_option('woocommerce_ship_to_billing_address_only')=='no') : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;div class=&quot;col2-set addresses&quot;&gt;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>              &lt;div class=&quot;col-1&quot;&gt;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>                  &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &lt;header class=&quot;title&quot;&gt;&nbsp;</div></li><li><div>                      &lt;h3&gt;&lt;?php _e( 'Billing Address', 'woocommerce' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                  &lt;/header&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &lt;address&gt;&nbsp;</div></li><li><div>                      &lt;p&gt;&lt;?php if (!$order-&gt;get_formatted_billing_address()) _e( 'N/A', 'woocommerce' ); else echo $order-&gt;get_formatted_billing_address(); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                  &lt;/address&gt;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>                  &lt;?php if (get_option('woocommerce_ship_to_billing_address_only')=='no') : ?&gt;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>              &lt;/div&gt;&lt;!-- /.col-1 --&gt;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>              &lt;div class=&quot;col-2&quot;&gt;&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>                  &lt;header class=&quot;title&quot;&gt;&nbsp;</div></li><li><div>                      &lt;h3&gt;&lt;?php _e( 'Shipping Address', 'woocommerce' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                  &lt;/header&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &lt;address&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php if (!$order-&gt;get_formatted_shipping_address()) _e( 'N/A', 'woocommerce' ); else echo $order-&gt;get_formatted_shipping_address(); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                  &lt;/address&gt;&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              &lt;/div&gt;&lt;!-- /.col-2 --&gt;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>          &lt;/div&gt;&lt;!-- /.col2-set --&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>              var array = [];&nbsp;</div></li><li><div>              &lt;?php&nbsp;</div></li><li><div>                      foreach ( $options['buttons'] as $btn ) : ?&gt;&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          array.push(&quot;&lt;?php echo $btn['changenamep']; ?&gt;&quot; , &quot;&lt;?php echo $btn['changename']; ?&gt;&quot;)&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                      &lt;?php&nbsp;</div></li><li><div>                      endforeach;&nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  b(array);&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  function b(array) {&nbsp;</div></li><li><div>                      for(var i = 0; i&lt;(array.length-1); i=i+2) {&nbsp;</div></li><li><div>                          document.body.innerHTML= document.body.innerHTML.replace(array[i], array[i+1])&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>          &lt;/script&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( enable_auto_complete_wccs()) {&nbsp;</div></li><li><div>  function retain_field_values_wccm() {    &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>      $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>      $options2 = get_option( 'wccs_settings2' );&nbsp;</div></li><li><div>      $options3 = get_option( 'wccs_settings3' );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>if ( is_checkout() ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $saved = WC()-&gt;session-&gt;get('wooccm_retain', array() );&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          jQuery(document).ready(function() {&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>              window.onload = function() {&nbsp;</div></li><li><div>       &nbsp;</div></li><li><div>                  &lt;?php &nbsp;</div></li><li><div>                      if( !empty($options) ) {&nbsp;</div></li><li><div>                      foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>                              if ( $btn['type'] !== 'wooccmupload' && $btn['type'] !== 'changename' && $btn['type'] !== 'heading' && empty($btn['tax_remove']) && empty($btn['add_amount']) )  { ?&gt;&nbsp;</div></li><li><div>                                  document.forms['checkout'].elements['&lt;?php echo $btn['cow']; ?&gt;'].value = &quot;&lt;?php echo $saved[''.$btn['cow'].'']; ?&gt;&quot;;&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                              &lt;?php }&nbsp;</div></li><li><div>                      endforeach;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      if( !is_user_logged_in() ) {&nbsp;</div></li><li><div>                          if ( WC()-&gt;cart-&gt;needs_shipping_address() === true && $_POST['ship_to_different_address'] == 1 ) :&nbsp;</div></li><li><div>                              foreach ( $options2['shipping_buttons'] as $btn ) :&nbsp;</div></li><li><div>                                      if ( $btn['type'] !== 'wooccmupload' && $btn['type'] !== 'changename' && $btn['type'] !== 'heading' && empty($btn['tax_remove']) && empty($btn['add_amount']) )  { ?&gt;&nbsp;</div></li><li><div>                                          document.forms['checkout'].elements['shipping_&lt;?php echo $btn['cow']; ?&gt;'].value = &quot;&lt;?php echo $saved['shipping_'.$btn['cow'].'']; ?&gt;&quot;;&nbsp;</div></li><li><div>                                      &nbsp;</div></li><li><div>                                      &lt;?php }&nbsp;</div></li><li><div>                              endforeach;&nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          foreach ( $options3['billing_buttons'] as $btn ) :&nbsp;</div></li><li><div>                                  if ( $btn['type'] !== 'wooccmupload' && $btn['type'] !== 'changename' && $btn['type'] !== 'heading' && empty($btn['tax_remove']) && empty($btn['add_amount']) )  { ?&gt;&nbsp;</div></li><li><div>                                      document.forms['checkout'].elements['billing_&lt;?php echo $btn['cow']; ?&gt;'].value = &quot;&lt;?php echo $saved['billing_'.$btn['cow'].'']; ?&gt;&quot;;&nbsp;</div></li><li><div>                                  &nbsp;</div></li><li><div>                                  &lt;?php }&nbsp;</div></li><li><div>                          endforeach;&nbsp;</div></li><li><div>                      } &nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      ?&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              } &nbsp;</div></li><li><div>          }); &nbsp;</div></li><li><div>      &lt;/script&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>              jQuery(document).ready(function() {&nbsp;</div></li><li><div>                  jQuery('body').change(function() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          var ajaxurl = '&lt;?php echo admin_url('admin-ajax.php'); ?&gt;';&nbsp;</div></li><li><div>                              data = { action: 'retain_val_wccs', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  &lt;?php&nbsp;</div></li><li><div>                                  if( !empty($options) ) {&nbsp;</div></li><li><div>                                  foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>                                          if ( $btn['type'] !== 'wooccmupload' && $btn['type'] !== 'changename' && $btn['type'] !== 'heading' && empty($btn['tax_remove']) && empty($btn['add_amount']) ) { ?&gt;&nbsp;</div></li><li><div>                                                      &lt;?php echo $btn['cow']; ?&gt;: jQuery(&quot;#&lt;?php echo $btn['cow']; ?&gt;&quot;).val(), &nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                                          &lt;?php }&nbsp;</div></li><li><div>                                  endforeach;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                                  &nbsp;</div></li><li><div>                                  if(!is_user_logged_in()) {&nbsp;</div></li><li><div>                                      if ( WC()-&gt;cart-&gt;needs_shipping_address() === true && $_POST['ship_to_different_address'] == 1 ) : &nbsp;</div></li><li><div>                                          foreach ( $options2['shipping_buttons'] as $btn ) :&nbsp;</div></li><li><div>                                                  if ( $btn['type'] !== 'wooccmupload' && $btn['type'] !== 'changename' && $btn['type'] !== 'heading' && empty($btn['tax_remove']) && empty($btn['add_amount']) ) { ?&gt;&nbsp;</div></li><li><div>                                                              shipping_&lt;?php echo $btn['cow']; ?&gt;: jQuery(&quot;shipping_&lt;?php echo $btn['cow']; ?&gt;&quot;).val(), &nbsp;</div></li><li><div>                                      &nbsp;</div></li><li><div>                                                  &lt;?php }&nbsp;</div></li><li><div>                                          endforeach;&nbsp;</div></li><li><div>                                      endif;&nbsp;</div></li><li><div>                                      &nbsp;</div></li><li><div>                                      foreach ( $options3['billing_buttons'] as $btn ) :&nbsp;</div></li><li><div>                                              if ( $btn['type'] !== 'wooccmupload' && $btn['type'] !== 'changename' && $btn['type'] !== 'heading' && empty($btn['tax_remove']) && empty($btn['add_amount']) ) { ?&gt;&nbsp;</div></li><li><div>                                                          billing_&lt;?php echo $btn['cow']; ?&gt;: jQuery(&quot;#billing_&lt;?php echo $btn['cow']; ?&gt;&quot;).val(), &nbsp;</div></li><li><div>                                  &nbsp;</div></li><li><div>                                              &lt;?php }&nbsp;</div></li><li><div>                                      endforeach;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                                  ?&gt;&nbsp;</div></li><li><div>                              };&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>                  jQuery.post(ajaxurl, data, function(response) { });&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>          });&nbsp;</div></li><li><div>      });&nbsp;</div></li><li><div>      &lt;/script&gt;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php &nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>} &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action( 'wp_ajax_retain_val_wccs', 'retain_val_wccs_callback' );&nbsp;</div></li><li><div>add_action('wp_ajax_nopriv_retain_val_wccs', 'retain_val_wccs_callback');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function retain_val_wccs_callback() {&nbsp;</div></li><li><div>  global $wpdb; <span class="comment">// this is how you get access to the database</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>  $options2 = get_option( 'wccs_settings2' );&nbsp;</div></li><li><div>  $options3 = get_option( 'wccs_settings3' );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>      if (!empty($options) ) {&nbsp;</div></li><li><div>      foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>           if ( $btn['type'] !== 'wooccmupload' && $btn['type'] !== 'changename' && $btn['type'] !== 'heading' && empty($btn['tax_remove']) && empty($btn['add_amount']) ) {&nbsp;</div></li><li><div>              if( $_POST[''.$btn['cow'].''] ) {&nbsp;</div></li><li><div>                  $saved[''.$btn['cow'].''] = $_POST[''.$btn['cow'].''];      &nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>           }&nbsp;</div></li><li><div>      endforeach;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if ( WC()-&gt;cart-&gt;needs_shipping_address() === true && $_POST['ship_to_different_address'] == 1 ) :&nbsp;</div></li><li><div>          foreach ( $options2['shipping_buttons'] as $btn ) :&nbsp;</div></li><li><div>               if ( $btn['type'] !== 'wooccmupload' && $btn['type'] !== 'changename' && $btn['type'] !== 'heading' && empty($btn['tax_remove']) && empty($btn['add_amount']) ) {&nbsp;</div></li><li><div>                  if( $_POST['shipping_'.$btn['cow'].''] ) {&nbsp;</div></li><li><div>                      $saved['shipping_'.$btn['cow'].''] = $_POST['shipping_'.$btn['cow'].''];       &nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>               }&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      foreach ( $options3['billing_buttons'] as $btn ) :&nbsp;</div></li><li><div>           if ( $btn['type'] !== 'wooccmupload' && $btn['type'] !== 'changename' && $btn['type'] !== 'heading' && empty($btn['tax_remove']) && empty($btn['add_amount']) ) {&nbsp;</div></li><li><div>              if( $_POST['billing_'.$btn['cow'].''] ) {&nbsp;</div></li><li><div>                  $saved['billing_'.$btn['cow'].''] = $_POST['billing_'.$btn['cow'].''];      &nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>           }&nbsp;</div></li><li><div>      endforeach;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      WC()-&gt;session-&gt;set('wooccm_retain', $saved );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>die(); &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>} <span class="comment">// end function retain_val_wccs_callback()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function enable_auto_complete_wccs() {&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !empty($options['checkness']['retainval']) ) {&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wccm_autocreate_account( $fields ) {&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !empty($options['checkness']['auto_create_wccm_account']) ) {&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>      &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>          jQuery(document).ready(function() {&nbsp;</div></li><li><div>              jQuery( &quot;input#createaccount&quot; ).prop(&quot;checked&quot;, &quot;checked&quot;);&nbsp;</div></li><li><div>          });&nbsp;</div></li><li><div>      &lt;/script&gt;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      &lt;style type=&quot;text/css&quot;&gt;&nbsp;</div></li><li><div>          .create-account {&nbsp;</div></li><li><div>          display:none;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      &lt;/style&gt;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>&lt;?php   }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action( 'wp_ajax_remove_tax_wccm', 'remove_tax_wccm' );&nbsp;</div></li><li><div>add_action( 'wp_ajax_nopriv_remove_tax_wccm', 'remove_tax_wccm' );&nbsp;</div></li><li><div>function remove_tax_wccm() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$saved['wooccm_addamount453userf'] = $_POST['add_amount_faj'];&nbsp;</div></li><li><div>$saved['wooccm_tax_save_method'] = $_POST['tax_remove_aj'];&nbsp;</div></li><li><div>$saved['wooccm_addamount453user'] = $_POST['add_amount_aj'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>WC()-&gt;session-&gt;set('wooccm_retain', $saved );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>die();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action( 'woocommerce_cart_calculate_fees', 'wooccm_custom_user_charge_man' );&nbsp;</div></li><li><div>function wooccm_custom_user_charge_man( $cart ) {&nbsp;</div></li><li><div>  global $woocommerce, $wpdb;&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>  $options2 = get_option( 'wccs_settings2' );&nbsp;</div></li><li><div>      $options3 = get_option( 'wccs_settings3' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$saved = WC()-&gt;session-&gt;get('wooccm_retain', array() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ( !empty($options['buttons']) ) {&nbsp;</div></li><li><div>          foreach ( $options['buttons'] as $btn ) {&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>              if ( !empty( $btn['add_amount'] ) && !empty( $btn['add_amount_field'] ) && !empty( $btn['label'] ) && !empty( $btn['fee_name'] ) ) {&nbsp;</div></li><li><div>          if ( $saved['wooccm_addamount453user'] == $btn['chosen_valt'] ) {        &nbsp;</div></li><li><div>                      $woocommerce-&gt;cart-&gt;add_fee( $btn['fee_name'], $btn['add_amount_field'], false, '' );                    &nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !empty( $btn['add_amount'] ) && empty( $btn['add_amount_field'] ) && !empty( $btn['label'] ) && !empty( $btn['fee_name'] ) ) {                    &nbsp;</div></li><li><div>          if ( !empty($saved['wooccm_addamount453userf']) && is_numeric($saved['wooccm_addamount453userf']) ) {&nbsp;</div></li><li><div>                      $woocommerce-&gt;cart-&gt;add_fee( $btn['fee_name'], $saved['wooccm_addamount453userf'], false, '' );  &nbsp;</div></li><li><div>          }             &nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ( !empty($options3['billing_buttons']) ) {&nbsp;</div></li><li><div>          foreach ( $options3['billing_buttons'] as $btn ) {&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>              if ( !empty( $btn['add_amount'] ) && !empty( $btn['add_amount_field'] ) && !empty( $btn['label'] ) && !empty( $btn['fee_name'] ) ) {&nbsp;</div></li><li><div>          if ( $saved['wooccm_addamount453user'] == $btn['chosen_valt'] ) {        &nbsp;</div></li><li><div>                      $woocommerce-&gt;cart-&gt;add_fee( $btn['fee_name'], $btn['add_amount_field'], false, '' );                    &nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !empty( $btn['add_amount'] ) && empty( $btn['add_amount_field'] ) && !empty( $btn['label'] ) && !empty( $btn['fee_name'] ) ) {                    &nbsp;</div></li><li><div>          if ( !empty($saved['wooccm_addamount453userf']) && is_numeric($saved['wooccm_addamount453userf']) ) {&nbsp;</div></li><li><div>                      $woocommerce-&gt;cart-&gt;add_fee( $btn['fee_name'], $saved['wooccm_addamount453userf'], false, '' );  &nbsp;</div></li><li><div>          }             &nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ( !empty($options2['shipping_buttons']) ) {&nbsp;</div></li><li><div>          foreach ( $options2['shipping_buttons'] as $btn ) {&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>              if ( !empty( $btn['add_amount'] ) && !empty( $btn['add_amount_field'] ) && !empty( $btn['label'] ) && !empty( $btn['fee_name'] ) ) {&nbsp;</div></li><li><div>          if ( $saved['wooccm_addamount453user'] == $btn['chosen_valt'] ) {        &nbsp;</div></li><li><div>                      $woocommerce-&gt;cart-&gt;add_fee( $btn['fee_name'], $btn['add_amount_field'], false, '' );                    &nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !empty( $btn['add_amount'] ) && empty( $btn['add_amount_field'] ) && !empty( $btn['label'] ) && !empty( $btn['fee_name'] ) ) {                    &nbsp;</div></li><li><div>          if ( !empty($saved['wooccm_addamount453userf']) && is_numeric($saved['wooccm_addamount453userf']) ) {&nbsp;</div></li><li><div>                      $woocommerce-&gt;cart-&gt;add_fee( $btn['fee_name'], $saved['wooccm_addamount453userf'], false, '' );  &nbsp;</div></li><li><div>          }             &nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action( 'woocommerce_calculate_totals', 'remove_tax_for_exempt' );&nbsp;</div></li><li><div>function remove_tax_for_exempt( $cart ) {&nbsp;</div></li><li><div>  global $woocommerce, $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>   $options2 = get_option( 'wccs_settings2' );&nbsp;</div></li><li><div>       $options3 = get_option( 'wccs_settings3' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $saved = WC()-&gt;session-&gt;get('wooccm_retain', array() );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  if ( !empty($options['buttons']) ) {&nbsp;</div></li><li><div>          foreach ( $options['buttons'] as $btn ) {&nbsp;</div></li><li><div>      if ( !empty( $btn['tax_remove'] ) ) {&nbsp;</div></li><li><div>              if ( $saved['wooccm_tax_save_method'] == $btn['chosen_valt'] ) {&nbsp;</div></li><li><div>                  $cart-&gt;remove_taxes();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>       }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !empty($options3['billing_buttons']) ) {&nbsp;</div></li><li><div>          foreach ( $options3['billing_buttons'] as $btn ) {&nbsp;</div></li><li><div>      if ( !empty( $btn['tax_remove'] ) ) {&nbsp;</div></li><li><div>              if ( $saved['wooccm_tax_save_method'] == $btn['chosen_valt'] ) {&nbsp;</div></li><li><div>                  $cart-&gt;remove_taxes();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>       }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ( !empty($options2['shipping_buttons']) ) {&nbsp;</div></li><li><div>          foreach ( $options2['shipping_buttons'] as $btn ) {&nbsp;</div></li><li><div>      if ( !empty( $btn['tax_remove'] ) ) {&nbsp;</div></li><li><div>              if ( $saved['wooccm_tax_save_method'] == $btn['chosen_valt'] ) {&nbsp;</div></li><li><div>                  $cart-&gt;remove_taxes();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>       }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>return $cart;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function state_defaultSwitchWooccm() {&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>      if( !empty($options['checkness']['per_state']) && !empty($options['checkness']['per_state_check']) ) {&nbsp;</div></li><li><div>          return ''.$options['checkness']['per_state'].''; &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// add custom column headers</span>&nbsp;</div></li><li><div>function wooccm_pro_csv_export_modify_column_headers( $column_headers ) {    &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$new_headers = array();&nbsp;</div></li><li><div>$shipping = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode' );&nbsp;</div></li><li><div>$billing = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode', 'email', 'phone' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$names = array( 'billing', 'shipping' );&nbsp;</div></li><li><div>$inc = 3;&nbsp;</div></li><li><div>foreach( $names as $name ) {&nbsp;</div></li><li><div>$array = ($name == 'billing') ? $billing : $shipping;&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings'.$inc.'' );&nbsp;</div></li><li><div>          foreach ( $options[''.$name.'_buttons'] as $btn ) :&nbsp;</div></li><li><div>      if ( !in_array( $btn['cow'], $array ) ) {                &nbsp;</div></li><li><div>                  $new_headers['_'.$name.'_'.$btn['cow'].''] = ''.wpml_string_wccm_pro($btn['label']).'';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>           endforeach;&nbsp;</div></li><li><div>$inc--;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>              foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>              $new_headers[''.$btn['cow'].''] = ''.wpml_string_wccm_pro($btn['label']).'';&nbsp;</div></li><li><div>      endforeach;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>return array_merge( $column_headers, $new_headers );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// set the data for each for custom columns</span>&nbsp;</div></li><li><div>function wooccm_pro_csv_export_modify_row_data( $order_data, $order, $csv_generator ) {&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>$custom_data = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$shipping = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode' );&nbsp;</div></li><li><div>$billing = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode', 'email', 'phone' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$names = array( 'billing', 'shipping' );&nbsp;</div></li><li><div>$inc = 3;&nbsp;</div></li><li><div>foreach( $names as $name ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$array = ($name == 'billing') ? $billing : $shipping;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings'.$inc.'' );&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>          foreach ( $options[''.$name.'_buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !in_array( $btn['cow'], $array ) ) {&nbsp;</div></li><li><div>                                &nbsp;</div></li><li><div>      if( get_post_meta( $order-&gt;id, '_'.$name.'_'.$btn['cow'].'', true ) && (($btn['type'] !== 'multiselect') || ($btn['type'] !== 'multicheckbox')) && ($btn['type'] !== 'heading') ) {&nbsp;</div></li><li><div>              $custom_data['_'.$name.'_'.$btn['cow'].''] = get_post_meta( $order-&gt;id, '_'.$name.'_'.$btn['cow'].'', true );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( get_post_meta( $order-&gt;id, '_'.$name.'_'.$btn['cow'].'', true )  && (($btn['type'] == 'multiselect') || ($btn['type'] == 'multicheckbox')) && ($btn['type'] !== 'heading') && $btn['type'] !== 'wooccmupload' ) {&nbsp;</div></li><li><div>              $custom_data['_'.$name.'_'.$btn['cow'].''] = '';&nbsp;</div></li><li><div>              $strings = unserialize(get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true));        &nbsp;</div></li><li><div>              $iww = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach( $strings as $key ) {&nbsp;</div></li><li><div>                  if ( $iww == count($strings) - 1) {&nbsp;</div></li><li><div>                      $custom_data['_'.$name.'_'.$btn['cow'].''] .= $key;&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $custom_data['_'.$name.'_'.$btn['cow'].''] .= $key.', ';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              $iww++;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>           endforeach;&nbsp;</div></li><li><div>$inc--;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if( get_post_meta( $order-&gt;id, ''.$btn['cow'].'', true ) && (($btn['type'] !== 'multiselect') || ($btn['type'] !== 'multicheckbox')) && ($btn['type'] !== 'heading') ) {&nbsp;</div></li><li><div>              $custom_data[''.$btn['cow'].''] = get_post_meta( $order-&gt;id, ''.$btn['cow'].'', true );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( get_post_meta( $order-&gt;id, ''.$btn['cow'].'', true )  && (($btn['type'] == 'multiselect') || ($btn['type'] == 'multicheckbox')) && ($btn['type'] !== 'heading') && $btn['type'] !== 'wooccmupload' ) {&nbsp;</div></li><li><div>              $custom_data[''.$btn['cow'].''] = '';&nbsp;</div></li><li><div>              $strings = unserialize(get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true));        &nbsp;</div></li><li><div>              $iww = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach( $strings as $key ) {&nbsp;</div></li><li><div>                  if ( $iww == count($strings) - 1) {&nbsp;</div></li><li><div>                      $custom_data[''.$btn['cow'].''] .= $key;&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $custom_data[''.$btn['cow'].''] .= $key.', ';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              $iww++;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      endforeach;    &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// defaults set back</span>&nbsp;</div></li><li><div>  $new_order_data = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $csv_generator-&gt;order_format ) && ( 'default_one_row_per_item' == $csv_generator-&gt;order_format || 'legacy_one_row_per_item' == $csv_generator-&gt;order_format ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $order_data as $data ) {&nbsp;</div></li><li><div>          $new_order_data[] = array_merge( (array) $data, $custom_data );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $new_order_data = array_merge( $order_data, $custom_data );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $new_order_data;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wccm_woocommerce_delivery_notes_compat_pro( $fields, $order ) {&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>$new_fields = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$shipping = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode' );&nbsp;</div></li><li><div>$billing = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode', 'email', 'phone' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$names = array( 'billing', 'shipping' );&nbsp;</div></li><li><div>$inc = 3;&nbsp;</div></li><li><div>foreach( $names as $name ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$array = ($name == 'billing') ? $billing : $shipping;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings'.$inc.'' );&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>          foreach ( $options[''.$name.'_buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !in_array( $btn['cow'], $array ) ) {&nbsp;</div></li><li><div>                                &nbsp;</div></li><li><div>      if( get_post_meta( $order-&gt;id, '_'.$name.'_'.$btn['cow'].'', true ) && (($btn['type'] !== 'multiselect') || ($btn['type'] !== 'multicheckbox')) &&  $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'heading') ) {&nbsp;</div></li><li><div>              $new_fields['_'.$name.'_'.$btn['cow'].''] = array( &nbsp;</div></li><li><div>                  'label' =&gt; ''.wpml_string_wccm_pro($btn['label']).'', &nbsp;</div></li><li><div>                  'value' =&gt; get_post_meta( $order-&gt;id, '_'.$name.'_'.$btn['cow'].'', true )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( get_post_meta( $order-&gt;id, '_'.$name.'_'.$btn['cow'].'', true )  && (($btn['type'] == 'multiselect') || ($btn['type'] == 'multicheckbox')) && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'heading')) {&nbsp;</div></li><li><div>              $new_fields['_'.$name.'_'.$btn['cow'].'']['label'] = ''.wpml_string_wccm_pro($btn['label']).'';&nbsp;</div></li><li><div>              $new_fields['_'.$name.'_'.$btn['cow'].'']['value'] = '';&nbsp;</div></li><li><div>              $strings = unserialize(get_post_meta( $order-&gt;id , '_'.$name.'_'.$btn['cow'].'', true));        &nbsp;</div></li><li><div>              $iww = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach( $strings as $key ) {&nbsp;</div></li><li><div>                  if ( $iww == count($strings) - 1) {&nbsp;</div></li><li><div>                      $new_fields['_'.$name.'_'.$btn['cow'].'']['value'] .= $key;&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $new_fields['_'.$name.'_'.$btn['cow'].'']['value'] .= $key.', ';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              $iww++;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      }elseif( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>          $info = explode(&quot;||&quot;, get_post_meta( $order-&gt;id, '_'.$name.'_'.$btn['cow'].'', true ));&nbsp;</div></li><li><div>          $new_fields['_'.$name.'_'.$btn['cow'].''] = array( &nbsp;</div></li><li><div>                  'label' =&gt; ''.wpml_string_wccm_pro($btn['force_title2']).'', &nbsp;</div></li><li><div>                  'value' =&gt; $info[0]&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>           endforeach;&nbsp;</div></li><li><div>$inc--;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if( get_post_meta( $order-&gt;id, ''.$btn['cow'].'', true ) && (($btn['type'] !== 'multiselect') || ($btn['type'] !== 'multicheckbox')) && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'heading') ) {&nbsp;</div></li><li><div>              $new_fields[''.$btn['cow'].''] = array( &nbsp;</div></li><li><div>                  'label' =&gt; ''.wpml_string_wccm_pro($btn['label']).'', &nbsp;</div></li><li><div>                  'value' =&gt; get_post_meta( $order-&gt;id, ''.$btn['cow'].'', true )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( get_post_meta( $order-&gt;id, ''.$btn['cow'].'', true )  && (($btn['type'] == 'multiselect') || ($btn['type'] == 'multicheckbox')) && $btn['type'] !== 'wooccmupload' && ($btn['type'] !== 'heading')) {&nbsp;</div></li><li><div>              $new_fields[''.$btn['cow'].'']['label'] = ''.wpml_string_wccm_pro($btn['label']).'';&nbsp;</div></li><li><div>              $new_fields[''.$btn['cow'].'']['value'] = '';&nbsp;</div></li><li><div>              $strings = unserialize(get_post_meta( $order-&gt;id , ''.$btn['cow'].'', true));        &nbsp;</div></li><li><div>              $iww = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach( $strings as $key ) {&nbsp;</div></li><li><div>                  if ( $iww == count($strings) - 1) {&nbsp;</div></li><li><div>                      $new_fields[''.$btn['cow'].'']['value'] .= $key;&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $new_fields[''.$btn['cow'].'']['value'] .= $key.', ';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              $iww++;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>          $info = get_post_meta( $order-&gt;id, ''.$btn['cow'].'', true );&nbsp;</div></li><li><div>          $new_fields[''.$btn['cow'].''] = array( &nbsp;</div></li><li><div>                  'label' =&gt; ''.wpml_string_wccm_pro($btn['force_title2']).'', &nbsp;</div></li><li><div>                  'value' =&gt; $info[0]&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      endforeach;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>return array_merge( $fields, $new_fields );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wpml_string_wccm_pro($input) {&nbsp;</div></li><li><div>  if (function_exists( 'icl_t' )) {&nbsp;</div></li><li><div>      return icl_t('WooCommerce Checkout Manager', ''.$input.'', ''.$input.'');&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      return $input;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wooccm_deactivate_plugin_conditional() {&nbsp;</div></li><li><div>  $name = 'woocommerce-checkout-manager/woocommerce-checkout-manager.php';&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ( !is_plugin_active( 'woocommerce/woocommerce.php' ) ) {&nbsp;</div></li><li><div>      add_action('admin_notices', 'wooccm_admin_notice_woo');&nbsp;</div></li><li><div>      deactivate_plugins( $name );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wooccm_admin_notice_woo() {&nbsp;</div></li><li><div>  echo '&lt;div class=&quot;error&quot;&gt;&lt;p&gt;&lt;strong&gt;'.__( 'WooCommerce is not active! WooCommerce Checkout Manager Pro requires WooCommerce to be active.', 'woocommerce-checkout-manager' ).'&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wooccm_order_notes( $fields ) {&nbsp;</div></li><li><div> $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if( !empty($options['checkness']['noteslabel']) ) {&nbsp;</div></li><li><div>          $fields['order']['order_comments']['label'] = $options['checkness']['noteslabel'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if( !empty($options['checkness']['notesplaceholder']) ) {&nbsp;</div></li><li><div>          $fields['order']['order_comments']['placeholder'] = $options['checkness']['notesplaceholder'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>      if( !empty($options['checkness']['notesenable']) ) {&nbsp;</div></li><li><div>          unset($fields['order']['order_comments']);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>return $fields;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function woooccm_restrict_manage_posts() {&nbsp;</div></li><li><div>$options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>$options2 = get_option( 'wccs_settings2' );&nbsp;</div></li><li><div>$options3 = get_option( 'wccs_settings3' );&nbsp;</div></li><li><div>$billing = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode', 'email', 'phone' );&nbsp;</div></li><li><div>$shipping = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( get_current_screen()-&gt;post_type == 'shop_order' ) {&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      foreach($options['buttons'] as $name) {&nbsp;</div></li><li><div>          $values[$name['label']] = $name['cow'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if( !empty($values) ) {&nbsp;</div></li><li><div>          array_unique($values);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      foreach($options2['shipping_buttons'] as $name) {&nbsp;</div></li><li><div>          if( !in_array($name['cow'], $shipping)) {&nbsp;</div></li><li><div>              $values2['Shipping '.$name['label']] = '_shipping_'.$name['cow'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if( !empty($values2) ) {&nbsp;</div></li><li><div>          array_unique($values2);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      foreach($options3['billing_buttons'] as $name) {&nbsp;</div></li><li><div>          if( !in_array($name['cow'], $billing)) {&nbsp;</div></li><li><div>              $values3['Billing '.$name['label']] = '_billing_'.$name['cow'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if( !empty($values3) ) {&nbsp;</div></li><li><div>          array_unique($values3);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( !empty($values) && !empty($values2) && !empty($values3) ) {&nbsp;</div></li><li><div>          $values = array_merge($values, $values2);&nbsp;</div></li><li><div>          $values = array_merge($values, $values3);&nbsp;</div></li><li><div>      } elseif( !empty($values) && !empty($values2) && empty($values3) ) {&nbsp;</div></li><li><div>              $values = array_merge($values, $values2);&nbsp;</div></li><li><div>          }elseif( !empty($values) && empty($values2) && !empty($values3) ) {&nbsp;</div></li><li><div>                  $values = array_merge($values, $values3);&nbsp;</div></li><li><div>              }elseif( empty($values) && !empty($values2) && !empty($values3) ) {&nbsp;</div></li><li><div>                      $values = array_merge($values2, $values3);&nbsp;</div></li><li><div>                  }elseif( empty($values) && empty($values2) && !empty($values3) ) {&nbsp;</div></li><li><div>                          $values = $values3;&nbsp;</div></li><li><div>                      }elseif( empty($values) && !empty($values2) && empty($values3) ) {&nbsp;</div></li><li><div>                              $values = $values2;&nbsp;</div></li><li><div>                          }elseif( !empty($values) && empty($values2) && empty($values3) ) {&nbsp;</div></li><li><div>                                  $values = $values;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;select name=&quot;wooccm_abbreviation&quot;&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      if( empty($values) && empty($values2) && empty($values3) ) { ?&gt;&nbsp;</div></li><li><div>          &lt;option value=&quot;&quot;&gt;&lt;?php _e('No Added Fields', 'woocommerce-checkout-manager'); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>      &lt;?php }else { ?&gt;&nbsp;</div></li><li><div>          &lt;option value=&quot;&quot;&gt;&lt;?php _e('Field Name', 'woocommerce-checkout-manager'); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>      &lt;?php }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>          $current_v = isset($_GET['wooccm_abbreviation'])? $_GET['wooccm_abbreviation']:'';&nbsp;</div></li><li><div>          foreach ($values as $label =&gt; $value) {&nbsp;</div></li><li><div>              printf&nbsp;</div></li><li><div>                  (&nbsp;</div></li><li><div>                      '&lt;option value=&quot;%s&quot;%s&gt;%s&lt;/option&gt;', &nbsp;</div></li><li><div>                      $value, &nbsp;</div></li><li><div>                      $value == $current_v? ' selected=&quot;selected&quot;':'', &nbsp;</div></li><li><div>                      $label&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;/select&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wooccm_query_list( $query ) {&nbsp;</div></li><li><div>  global $pagenow;&nbsp;</div></li><li><div>  if ( is_admin() && $pagenow=='edit.php' && isset($_GET['wooccm_abbreviation']) && $_GET['wooccm_abbreviation'] != '') {&nbsp;</div></li><li><div>      $query-&gt;query_vars[ 'meta_key' ] = $_GET['wooccm_abbreviation'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function display_notices_wooccm() {&nbsp;</div></li><li><div>  echo '&lt;form method=&quot;post&quot; name=&quot;clickhere&quot; action=&quot;&quot;&gt;&lt;div id=&quot;setting-error-settings_updated&quot; class=&quot;updated settings-error click-here-wooccm&quot;&gt;&lt;p&gt;&lt;strong&gt;'.__('Almost done! Install latest settings.', 'woocommerce-checkout-manager').'&lt;/strong&gt; | &lt;input type=&quot;hidden&quot; name=&quot;click-here-wooccm&quot; value=&quot;y&quot; /&gt;&lt;input type=&quot;submit&quot; class=&quot;button button-primary button-hero&quot; value=&quot;Click Here&quot; /&gt;&lt;/p&gt;&lt;/div&gt;&lt;/form&gt;';&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( isset($_POST['click-here-wooccm']) && $_POST['click-here-wooccm'] == 'y') { ?&gt;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>                  &lt;!-- First Use --&gt;&nbsp;</div></li><li><div>                  &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>                  jQuery(document).ready(function($) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $( '#wpbody-content' ).block({message:null, overlayCSS:{background:&quot;#fff url(&lt;?php echo plugins_url('woocommerce/assets/images/ajax-loader.gif'); ?&gt; ) no-repeat center&quot;, opacity:.6}});&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  var form = $('#frm1'); &nbsp;</div></li><li><div>                      data = $('#frm1');&nbsp;</div></li><li><div>                      forma = $('#frm2'); &nbsp;</div></li><li><div>                      dataa = $('#frm2');&nbsp;</div></li><li><div>                      formb = $('#frm3'); &nbsp;</div></li><li><div>                      datab = $('#frm3');&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                  $.ajax( {&nbsp;</div></li><li><div>                        type: &quot;POST&quot;, &nbsp;</div></li><li><div>                        url: form.attr( 'action' ), &nbsp;</div></li><li><div>                        data: data.serialize(), &nbsp;</div></li><li><div>                        success: function( response ) {   &nbsp;</div></li><li><div>                                  $.ajax( {&nbsp;</div></li><li><div>                                        type: &quot;POST&quot;, &nbsp;</div></li><li><div>                                        url: forma.attr( 'action' ), &nbsp;</div></li><li><div>                                        data: dataa.serialize(), &nbsp;</div></li><li><div>                                        success: function( response ) {   &nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>                                      });&nbsp;</div></li><li><div>                                      &nbsp;</div></li><li><div>                                      $.ajax( {&nbsp;</div></li><li><div>                                        type: &quot;POST&quot;, &nbsp;</div></li><li><div>                                        url: formb.attr( 'action' ), &nbsp;</div></li><li><div>                                        data: datab.serialize(), &nbsp;</div></li><li><div>                                        success: function( response ) {   &nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>                                      });&nbsp;</div></li><li><div>                                  $('.settings-error.click-here-wooccm').hide();&nbsp;</div></li><li><div>                                   $('#wpbody-content').unblock();&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                      });&nbsp;</div></li><li><div>                  });&nbsp;</div></li><li><div>                  &lt;/script&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>          update_option('wooccm_update_notice', 'yep');&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment"><span class="comment">// ========================================</span></span>&nbsp;</div></li><li><div><span class="comment">// Remove conditional notices</span>&nbsp;</div></li><li><div><span class="comment"><span class="comment">// ========================================</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action('woocommerce_after_checkout_validation', 'wooccm_remove_notices_conditional');&nbsp;</div></li><li><div>function wooccm_remove_notices_conditional( $posted ) {&nbsp;</div></li><li><div>$notice = WC()-&gt;session-&gt;get( 'wc_notices' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$shipping = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode' );&nbsp;</div></li><li><div>$billing = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode', 'email', 'phone' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$names = array( 'billing', 'shipping' );&nbsp;</div></li><li><div>$inc = 3;&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>foreach( $names as $name ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$array = ($name == 'billing') ? $billing : $shipping;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $options2 = get_option( 'wccs_settings'.$inc.'' );&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>          foreach ( $options2[''.$name.'_buttons'] as $btn ) :&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>      if( !empty($btn['chosen_valt']) && !empty($btn['conditional_parent_use']) && !empty($btn['conditional_tie']) && $btn['type'] !== 'changename' && ($btn['type'] !== 'heading') && !empty($btn['conditional_parent']) ) {&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( !empty($_POST[$btn['cow']]) ) {&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>          foreach( $options['buttons'] as $btn2 ) {&nbsp;</div></li><li><div>          if( !empty($btn2['chosen_valt']) && !empty($btn2['conditional_parent_use']) && !empty($btn2['conditional_tie']) && $btn2['type'] !== 'changename' && ($btn2['type'] !== 'heading') && empty($btn2['conditional_parent']) ) {&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>          if( $_POST[''.$btn['cow'].''] != $btn2['chosen_valt'] ) {&nbsp;</div></li><li><div>              if( empty($_POST[''.$btn2['cow'].'']) ) {&nbsp;</div></li><li><div>                  foreach( $notice['error'] as $position =&gt; $value ) {&nbsp;</div></li><li><div>                      if( strip_tags($value) == ''.wpml_string_wccm_pro($btn2['label']).' is a required field.' ) {&nbsp;</div></li><li><div>                          unset($notice['error'][$position]);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          } &nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          foreach( $notice['error'] as $position =&gt; $value ) {&nbsp;</div></li><li><div>                      if( strip_tags($value) == ''.wpml_string_wccm_pro($btn2['label']).' is a required field.' ) {&nbsp;</div></li><li><div>                          unset($notice['error'][$position]);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>           endforeach;&nbsp;</div></li><li><div>$inc--;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>  global $woocommerce;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  foreach( $options['buttons'] as $btn ) {&nbsp;</div></li><li><div>      if( !empty($btn['chosen_valt']) && !empty($btn['conditional_parent_use']) && !empty($btn['conditional_tie']) && $btn['type'] !== 'changename' && ($btn['type'] !== 'heading') && !empty($btn['conditional_parent']) ) {&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( !empty($_POST[$btn['cow']]) ) {&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>          foreach( $options['buttons'] as $btn2 ) {&nbsp;</div></li><li><div>          if( !empty($btn2['chosen_valt']) && !empty($btn2['conditional_parent_use']) && !empty($btn2['conditional_tie']) && $btn2['type'] !== 'changename' && ($btn2['type'] !== 'heading') && empty($btn2['conditional_parent']) ) {&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>          if( $_POST[''.$btn['cow'].''] != $btn2['chosen_valt'] ) {&nbsp;</div></li><li><div>              if( empty($_POST[''.$btn2['cow'].'']) ) {&nbsp;</div></li><li><div>                  foreach( $notice['error'] as $position =&gt; $value ) {&nbsp;</div></li><li><div>                      if( strip_tags($value) == ''.wpml_string_wccm_pro($btn2['label']).' is a required field.' ) {&nbsp;</div></li><li><div>                          unset($notice['error'][$position]);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          } &nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          foreach( $notice['error'] as $position =&gt; $value ) {&nbsp;</div></li><li><div>                      if( strip_tags($value) == ''.wpml_string_wccm_pro($btn2['label']).' is a required field.' ) {&nbsp;</div></li><li><div>                          unset($notice['error'][$position]);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  WC()-&gt;session-&gt;set( 'wc_notices', $notice );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action('woocommerce_order_status_completed', 'wooccm_update_attachmentids');&nbsp;</div></li><li><div>function wooccm_update_attachmentids( $order_id ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$shipping = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode' );&nbsp;</div></li><li><div>$billing = array( 'country', 'first_name', 'last_name', 'company', 'address_1', 'address_2', 'city', 'state', 'postcode', 'email', 'phone' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$names = array( 'billing', 'shipping' );&nbsp;</div></li><li><div>$inc = 3;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>foreach( $names as $name ) {&nbsp;</div></li><li><div>$array = ($name == 'billing') ? $billing : $shipping;&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings'.$inc.'' );&nbsp;</div></li><li><div>          foreach ( $options[''.$name.'_buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !in_array( $btn['cow'], $array ) ) {&nbsp;</div></li><li><div>                      if( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>                          $info = explode(&quot;||&quot;, get_post_meta( $order_id , '_'.$name.'_'.$btn['cow'].'', true));&nbsp;</div></li><li><div>                          if( $info ) {&nbsp;</div></li><li><div>                              $new_info = explode( &quot;||&quot;, $info[1] );&nbsp;</div></li><li><div>                              foreach( $new_info as $image_id ) {&nbsp;</div></li><li><div>                                  if( !empty($image_id ) ) {&nbsp;</div></li><li><div>                                      wp_update_post( array( 'ID' =&gt; $image_id, 'post_parent' =&gt; $order_id ));&nbsp;</div></li><li><div>                                      require_once( ABSPATH . 'wp-admin/includes/image.php' );&nbsp;</div></li><li><div>                                      wp_update_attachment_metadata( $image_id, wp_generate_attachment_metadata( $image_id, wp_get_attachment_url($image_id) ) );&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>           endforeach;&nbsp;</div></li><li><div>$inc--;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $options = get_option( 'wccs_settings' );&nbsp;</div></li><li><div>              foreach ( $options['buttons'] as $btn ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if( $btn['type'] == 'wooccmupload' ) {&nbsp;</div></li><li><div>                      $info = explode( &quot;||&quot;, get_post_meta( $order_id , ''.$btn['cow'].'', true));&nbsp;</div></li><li><div>                      if( $info ) {&nbsp;</div></li><li><div>                          $new_info = explode( &quot;||&quot;, $info[1] );&nbsp;</div></li><li><div>                          foreach( $new_info as $image_id ) {&nbsp;</div></li><li><div>                              if( !empty($image_id ) ) {&nbsp;</div></li><li><div>                                  wp_update_post( array( 'ID' =&gt; $image_id, 'post_parent' =&gt; $order_id ));&nbsp;</div></li><li><div>                                  require_once( ABSPATH . 'wp-admin/includes/image.php' );&nbsp;</div></li><li><div>                                  wp_update_attachment_metadata( $image_id, wp_generate_attachment_metadata( $image_id, wp_get_attachment_url($image_id) ) );&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              endforeach;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action(&quot;wp_ajax_wooccm_front_endupload&quot;, &quot;wooccm_front_endupload&quot;);&nbsp;</div></li><li><div>add_action(&quot;wp_ajax_nopriv_wooccm_front_endupload&quot;, &quot;wooccm_front_endupload&quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wooccm_front_endupload() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>require_once( ABSPATH . 'wp-admin/includes/file.php' ); &nbsp;</div></li><li><div>require_once( ABSPATH . 'wp-admin/includes/media.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$wp_upload_dir = wp_upload_dir();&nbsp;</div></li><li><div>$name = $_REQUEST[&quot;name&quot;];&nbsp;</div></li><li><div>$upload_overrides = array( 'test_form' =&gt; false );&nbsp;</div></li><li><div>$number_of_files = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $file = array(&nbsp;</div></li><li><div>              'name' =&gt; $_FILES[''.$name.'']['name'], &nbsp;</div></li><li><div>              'type' =&gt; $_FILES[''.$name.'']['type'], &nbsp;</div></li><li><div>              'tmp_name' =&gt; $_FILES[''.$name.'']['tmp_name'], &nbsp;</div></li><li><div>              'error' =&gt; $_FILES[''.$name.'']['error'], &nbsp;</div></li><li><div>              'size' =&gt; $_FILES[''.$name.'']['size']&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>          $movefile = wp_handle_upload($file, $upload_overrides);&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          $attachment = array(&nbsp;</div></li><li><div>              'guid' =&gt; $movefile['url'], &nbsp;</div></li><li><div>              'post_mime_type' =&gt; $movefile['type'], &nbsp;</div></li><li><div>              'post_title' =&gt; preg_replace( '/\.[^.]+$/', '', basename($movefile['file'])), &nbsp;</div></li><li><div>              'post_content' =&gt; '', &nbsp;</div></li><li><div>              'post_status' =&gt; 'inherit'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $attach_id = wp_insert_attachment( $attachment, $movefile['url'] );&nbsp;</div></li><li><div>$number_of_files++;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>echo json_encode( array( $number_of_files, $attach_id ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>die();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//frontend handle</span>&nbsp;</div></li><li><div>add_action(&quot;wp_ajax_wooccm_front_enduploadsave&quot;, &quot;wooccm_front_enduploadsave&quot;);&nbsp;</div></li><li><div>add_action(&quot;wp_ajax_nopriv_wooccm_front_enduploadsave&quot;, &quot;wooccm_front_enduploadsave&quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wooccm_front_enduploadsave() {&nbsp;</div></li><li><div>global $wpdb, $woocommerce, $post; &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      require_once( ABSPATH . 'wp-admin/includes/file.php' ); &nbsp;</div></li><li><div>      require_once( ABSPATH . 'wp-admin/includes/media.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $name = $_REQUEST[&quot;name&quot;];&nbsp;</div></li><li><div>      $attachtoremove = $_REQUEST[&quot;remove&quot;];&nbsp;</div></li><li><div>      $upload_overrides = array( 'test_form' =&gt; false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      wp_delete_attachment( $attachtoremove );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $file = array(&nbsp;</div></li><li><div>          'name' =&gt; $_FILES[''.$name.'']['name'], &nbsp;</div></li><li><div>          'type' =&gt; $_FILES[''.$name.'']['type'], &nbsp;</div></li><li><div>          'tmp_name' =&gt; $_FILES[''.$name.'']['tmp_name'], &nbsp;</div></li><li><div>          'error' =&gt; $_FILES[''.$name.'']['error'], &nbsp;</div></li><li><div>          'size' =&gt; $_FILES[''.$name.'']['size']&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      $movefile = wp_handle_upload($file, $upload_overrides);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $attachment = array(&nbsp;</div></li><li><div>          'guid' =&gt; $movefile['url'], &nbsp;</div></li><li><div>          'post_mime_type' =&gt; $movefile['type'], &nbsp;</div></li><li><div>          'post_title' =&gt; preg_replace( '/\.[^.]+$/', '', basename($movefile['file'])), &nbsp;</div></li><li><div>          'post_content' =&gt; '', &nbsp;</div></li><li><div>          'post_status' =&gt; 'inherit'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $attach_id = wp_insert_attachment( $attachment, $movefile['url'] );&nbsp;</div></li><li><div>echo json_encode($attach_id);&nbsp;</div></li><li><div>die();&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>WooCommerce Checkout Manager</li><li><span></span>4.0</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>