<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="1.9" data-slug="paid-memberships-pro" data-type="file" data-id="73443"><head xmlns="http://www.w3.org/1999/xhtml"><title> adminpages-orders | file | Paid Memberships Pro | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, paid-memberships-pro, 1.9" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=3302819c21668879c6496f1738c4de57' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/adminpages-orders/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fadminpages-orders%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fadminpages-orders%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-paid-memberships-pro-1.9-file-adminpages-orders","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="adminpages-orders" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to paid-memberships-pro." href="http://hookr.io/plugins/paid-memberships-pro/" class="plugin"><span property="name">paid-memberships-pro</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 1.9." href="http://hookr.io/plugins/paid-memberships-pro/1.9/" class="H_VERSION"><span property="name">1.9</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/paid-memberships-pro/1.9/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">adminpages-orders</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="1062"><a href="http://hookr.io/plugins/paid-memberships-pro/1.9/all/" title="All">All <span class="count badge">1062</span></a></li><li class="" data-id="new" data-count="186"><a href="http://hookr.io/plugins/paid-memberships-pro/1.9/new/" title="New">New <span class="count badge">186</span></a></li><li class="" data-id="hooks" data-count="398"><a href="http://hookr.io/plugins/paid-memberships-pro/1.9/hooks/" title="Hooks">Hooks <span class="count badge">398</span></a></li><li class="" data-id="action" data-count="92"><a href="http://hookr.io/plugins/paid-memberships-pro/1.9/actions/" title="Actions">Actions <span class="count badge">92</span></a></li><li class="" data-id="filter" data-count="306"><a href="http://hookr.io/plugins/paid-memberships-pro/1.9/filters/" title="Filters">Filters <span class="count badge">306</span></a></li><li class="" data-id="class" data-count="346"><a href="http://hookr.io/plugins/paid-memberships-pro/1.9/classes/" title="Classes">Classes <span class="count badge">346</span></a></li><li class="" data-id="constant" data-count="29"><a href="http://hookr.io/plugins/paid-memberships-pro/1.9/constants/" title="Constants">Constants <span class="count badge">29</span></a></li><li class="" data-id="function" data-count="282"><a href="http://hookr.io/plugins/paid-memberships-pro/1.9/functions/" title="Functions">Functions <span class="count badge">282</span></a></li><li class="" data-id="shortcode" data-count="7"><a href="http://hookr.io/plugins/paid-memberships-pro/1.9/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">7</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/adminpages/orders.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">//only admins can get this</span>&nbsp;</div></li><li><div>if ( ! function_exists( &quot;current_user_can&quot; ) || ( ! current_user_can( &quot;manage_options&quot; ) && ! current_user_can( &quot;pmpro_orders&quot; ) ) ) {&nbsp;</div></li><li><div>  die( __( &quot;You do not have permissions to perform this action.&quot;, 'paid-memberships-pro' ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//vars</span>&nbsp;</div></li><li><div>global $wpdb;&nbsp;</div></li><li><div>if ( isset( $_REQUEST['s'] ) ) {&nbsp;</div></li><li><div>  $s = sanitize_text_field( trim( $_REQUEST['s'] ) );&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  $s = &quot;&quot;;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['l'] ) ) {&nbsp;</div></li><li><div>  $l = intval( $_REQUEST['l'] );&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  $l = false;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['start-month'] ) ) {&nbsp;</div></li><li><div>  $start_month = intval( $_REQUEST['start-month'] );&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  $start_month = &quot;1&quot;;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['start-day'] ) ) {&nbsp;</div></li><li><div>  $start_day = intval( $_REQUEST['start-day'] );&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  $start_day = &quot;1&quot;;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['start-year'] ) ) {&nbsp;</div></li><li><div>  $start_year = intval( $_REQUEST['start-year'] );&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  $start_year = date_i18n( &quot;Y&quot; );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['end-month'] ) ) {&nbsp;</div></li><li><div>  $end_month = intval( $_REQUEST['end-month'] );&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  $end_month = date_i18n( &quot;n&quot; );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['end-day'] ) ) {&nbsp;</div></li><li><div>  $end_day = intval( $_REQUEST['end-day'] );&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  $end_day = date_i18n( &quot;j&quot; );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['end-year'] ) ) {&nbsp;</div></li><li><div>  $end_year = intval( $_REQUEST['end-year'] );&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  $end_year = date_i18n( &quot;Y&quot; );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['predefined-date'] ) ) {&nbsp;</div></li><li><div>  $predefined_date = sanitize_text_field( $_REQUEST['predefined-date'] );&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  $predefined_date = &quot;This Month&quot;;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['status'] ) ) {&nbsp;</div></li><li><div>  $status = sanitize_text_field( $_REQUEST['status'] );&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  $status = &quot;&quot;;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['filter'] ) ) {&nbsp;</div></li><li><div>  $filter = sanitize_text_field( $_REQUEST['filter'] );&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  $filter = &quot;all&quot;;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//some vars for the search</span>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['pn'] ) ) {&nbsp;</div></li><li><div>  $pn = intval( $_REQUEST['pn'] );&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  $pn = 1;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset( $_REQUEST['limit'] ) ) {&nbsp;</div></li><li><div>  $limit = intval( $_REQUEST['limit'] );&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filter to set the default number of items to show per page</span>&nbsp;</div></li><li><div><span class="comment">   * on the Orders page in the admin.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.8.4.5</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $limit The number of items to show per page.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $limit = apply_filters( 'pmpro_orders_per_page', 15 );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$end = $pn * $limit;&nbsp;</div></li><li><div>$start = $end - $limit;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//filters</span>&nbsp;</div></li><li><div>if ( empty( $filter ) || $filter === &quot;all&quot; ) {&nbsp;</div></li><li><div>  $condition = &quot;1=1&quot;;&nbsp;</div></li><li><div>  $filter = &quot;all&quot;;&nbsp;</div></li><li><div>} elseif ( $filter == &quot;within-a-date-range&quot; ) {&nbsp;</div></li><li><div>  $start_date = $start_year . &quot;-&quot; . $start_month . &quot;-&quot; . $start_day;&nbsp;</div></li><li><div>  $end_date = $end_year . &quot;-&quot; . $end_month . &quot;-&quot; . $end_day;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">//add times to dates</span></span>&nbsp;</div></li><li><div>  $start_date = $start_date . &quot; 00:00:00&quot;;&nbsp;</div></li><li><div>  $end_date = $end_date . &quot; 23:59:59&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $condition = &quot;timestamp BETWEEN '&quot; . esc_sql( $start_date ) . &quot;' AND '&quot; . esc_sql( $end_date ) . &quot;'&quot;;&nbsp;</div></li><li><div>} elseif ( $filter == &quot;predefined-date-range&quot; ) {&nbsp;</div></li><li><div>  if ( $predefined_date == &quot;Last Month&quot; ) {&nbsp;</div></li><li><div>      $start_date = date_i18n( &quot;Y-m-d&quot;, strtotime( &quot;first day of last month&quot;, current_time( &quot;timestamp&quot; ) ) );&nbsp;</div></li><li><div>      $end_date = date_i18n( &quot;Y-m-d&quot;, strtotime( &quot;last day of last month&quot;, current_time( &quot;timestamp&quot; ) ) );&nbsp;</div></li><li><div>  } elseif ( $predefined_date == &quot;This Month&quot; ) {&nbsp;</div></li><li><div>      $start_date = date_i18n( &quot;Y-m-d&quot;, strtotime( &quot;first day of this month&quot;, current_time( &quot;timestamp&quot; ) ) );&nbsp;</div></li><li><div>      $end_date = date_i18n( &quot;Y-m-d&quot;, strtotime( &quot;last day of this month&quot;, current_time( &quot;timestamp&quot; ) ) );&nbsp;</div></li><li><div>  } elseif ( $predefined_date == &quot;This Year&quot; ) {&nbsp;</div></li><li><div>      $year = date_i18n( 'Y' );&nbsp;</div></li><li><div>      $start_date = date_i18n( &quot;Y-m-d&quot;, strtotime( &quot;first day of January $year&quot;, current_time( &quot;timestamp&quot; ) ) );&nbsp;</div></li><li><div>      $end_date = date_i18n( &quot;Y-m-d&quot;, strtotime( &quot;last day of December $year&quot;, current_time( &quot;timestamp&quot; ) ) );&nbsp;</div></li><li><div>  } elseif ( $predefined_date == &quot;Last Year&quot; ) {&nbsp;</div></li><li><div>      $year = date_i18n( 'Y' ) - 1;&nbsp;</div></li><li><div>      $start_date = date_i18n( &quot;Y-m-d&quot;, strtotime( &quot;first day of January $year&quot;, current_time( &quot;timestamp&quot; ) ) );&nbsp;</div></li><li><div>      $end_date = date_i18n( &quot;Y-m-d&quot;, strtotime( &quot;last day of December $year&quot;, current_time( &quot;timestamp&quot; ) ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">//add times to dates</span></span>&nbsp;</div></li><li><div>  $start_date = $start_date . &quot; 00:00:00&quot;;&nbsp;</div></li><li><div>  $end_date = $end_date . &quot; 23:59:59&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $condition = &quot;timestamp BETWEEN '&quot; . esc_sql( $start_date ) . &quot;' AND '&quot; . esc_sql( $end_date ) . &quot;'&quot;;&nbsp;</div></li><li><div>} elseif ( $filter == &quot;within-a-level&quot; ) {&nbsp;</div></li><li><div>  $condition = &quot;membership_id = &quot; . esc_sql( $l );&nbsp;</div></li><li><div>} elseif ( $filter == &quot;within-a-status&quot; ) {&nbsp;</div></li><li><div>  $condition = &quot;status = '&quot; . esc_sql( $status ) . &quot;' &quot;;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//emailing?</span>&nbsp;</div></li><li><div>if ( ! empty( $_REQUEST['email'] ) && ! empty( $_REQUEST['order'] ) ) {&nbsp;</div></li><li><div>  $email = new PMProEmail();&nbsp;</div></li><li><div>  $user = get_user_by( 'email', $_REQUEST['email'] );&nbsp;</div></li><li><div>  $order = new MemberOrder( $_REQUEST['order'] );&nbsp;</div></li><li><div>  if ( $email-&gt;sendBillableInvoiceEmail( $user, $order ) ) {&nbsp;</div></li><li><div>      $pmpro_msg = __( &quot;Invoice emailed successfully.&quot;, 'paid-memberships-pro' );&nbsp;</div></li><li><div>      $pmpro_msgt = &quot;success&quot;;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $pmpro_msg = __( &quot;Error emailing invoice.&quot;, 'paid-memberships-pro' );&nbsp;</div></li><li><div>      $pmpro_msgt = &quot;error&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">//clean up so we stay on the orders list view</span>&nbsp;</div></li><li><div>  unset( $_REQUEST['order'] );&nbsp;</div></li><li><div>  $order = null;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//deleting?</span>&nbsp;</div></li><li><div>if ( ! empty( $_REQUEST['delete'] ) ) {&nbsp;</div></li><li><div>  $dorder = new MemberOrder( intval( $_REQUEST['delete'] ) );&nbsp;</div></li><li><div>  if ( $dorder-&gt;deleteMe() ) {&nbsp;</div></li><li><div>      $pmpro_msg = __( &quot;Order deleted successfully.&quot;, 'paid-memberships-pro' );&nbsp;</div></li><li><div>      $pmpro_msgt = &quot;success&quot;;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $pmpro_msg = __( &quot;Error deleting order.&quot;, 'paid-memberships-pro' );&nbsp;</div></li><li><div>      $pmpro_msgt = &quot;error&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$thisyear = date_i18n( &quot;Y&quot; );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//this array stores fields that should be read only</span>&nbsp;</div></li><li><div>$read_only_fields = apply_filters( &quot;pmpro_orders_read_only_fields&quot;, array(&nbsp;</div></li><li><div>  &quot;code&quot;, &nbsp;</div></li><li><div>  &quot;payment_transaction_id&quot;, &nbsp;</div></li><li><div>  &quot;subscription_transaction_id&quot;&nbsp;</div></li><li><div>) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//saving?</span>&nbsp;</div></li><li><div>if ( ! empty( $_REQUEST['save'] ) ) {&nbsp;</div></li><li><div>  <span class="comment">//start with old order if applicable</span>&nbsp;</div></li><li><div>  $order_id = intval( $_REQUEST['order'] );&nbsp;</div></li><li><div>  if ( $order_id &gt; 0 ) {&nbsp;</div></li><li><div>      $order = new MemberOrder( $order_id );&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $order = new MemberOrder();&nbsp;</div></li><li><div>      $order-&gt;billing = new stdClass();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">//update values</span>&nbsp;</div></li><li><div>  if ( ! in_array( &quot;code&quot;, $read_only_fields ) && isset( $_POST['code'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;code = $_POST['code'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;user_id&quot;, $read_only_fields ) && isset( $_POST['user_id'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;user_id = intval( $_POST['user_id'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;membership_id&quot;, $read_only_fields ) && isset( $_POST['membership_id'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;membership_id = intval( $_POST['membership_id'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;billing_name&quot;, $read_only_fields ) && isset( $_POST['billing_name'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;billing-&gt;name = stripslashes( $_POST['billing_name'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;billing_street&quot;, $read_only_fields ) && isset( $_POST['billing_street'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;billing-&gt;street = stripslashes( $_POST['billing_street'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;billing_city&quot;, $read_only_fields ) && isset( $_POST['billing_city'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;billing-&gt;city = stripslashes( $_POST['billing_city'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;billing_state&quot;, $read_only_fields ) && isset( $_POST['billing_state'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;billing-&gt;state = stripslashes( $_POST['billing_state'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;billing_zip&quot;, $read_only_fields ) && isset( $_POST['billing_zip'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;billing-&gt;zip = $_POST['billing_zip'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;billing_country&quot;, $read_only_fields ) && isset( $_POST['billing_country'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;billing-&gt;country = stripslashes( $_POST['billing_country'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;billing_phone&quot;, $read_only_fields ) && isset( $_POST['billing_phone'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;billing-&gt;phone = $_POST['billing_phone'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;subtotal&quot;, $read_only_fields ) && isset( $_POST['subtotal'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;subtotal = $_POST['subtotal'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;tax&quot;, $read_only_fields ) && isset( $_POST['tax'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;tax = $_POST['tax'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;couponamount&quot;, $read_only_fields ) && isset( $_POST['couponamount'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;couponamount = $_POST['couponamount'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;total&quot;, $read_only_fields ) && isset( $_POST['total'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;total = $_POST['total'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;payment_type&quot;, $read_only_fields ) && isset( $_POST['payment_type'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;payment_type = $_POST['payment_type'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;cardtype&quot;, $read_only_fields ) && isset( $_POST['cardtype'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;cardtype = $_POST['cardtype'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;accountnumber&quot;, $read_only_fields ) && isset( $_POST['accountnumber'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;accountnumber = $_POST['accountnumber'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;expirationmonth&quot;, $read_only_fields ) && isset( $_POST['expirationmonth'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;expirationmonth = $_POST['expirationmonth'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;expirationyear&quot;, $read_only_fields ) && isset( $_POST['expirationyear'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;expirationyear = $_POST['expirationyear'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;ExpirationDate&quot;, $read_only_fields ) && isset( $_POST['ExpirationDate'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;ExpirationDate = $order-&gt;expirationmonth . $order-&gt;expirationyear;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;status&quot;, $read_only_fields ) && isset( $_POST['status'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;status = stripslashes( $_POST['status'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;gateway&quot;, $read_only_fields ) && isset( $_POST['gateway'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;gateway = $_POST['gateway'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;gateway_environment&quot;, $read_only_fields ) && isset( $_POST['gateway_environment'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;gateway_environment = $_POST['gateway_environment'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;payment_transaction_id&quot;, $read_only_fields ) && isset( $_POST['payment_transaction_id'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;payment_transaction_id = $_POST['payment_transaction_id'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;subscription_transaction_id&quot;, $read_only_fields ) && isset( $_POST['subscription_transaction_id'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;subscription_transaction_id = $_POST['subscription_transaction_id'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( ! in_array( &quot;notes&quot;, $read_only_fields ) && isset( $_POST['notes'] ) ) {&nbsp;</div></li><li><div>      $order-&gt;notes = stripslashes( $_POST['notes'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">//affiliate stuff</span>&nbsp;</div></li><li><div>  $affiliates = apply_filters( &quot;pmpro_orders_show_affiliate_ids&quot;, false );&nbsp;</div></li><li><div>  if ( ! empty( $affiliates ) ) {&nbsp;</div></li><li><div>      if ( ! in_array( &quot;affiliate_id&quot;, $read_only_fields ) ) {&nbsp;</div></li><li><div>          $order-&gt;affiliate_id = $_POST['affiliate_id'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if ( ! in_array( &quot;affiliate_subid&quot;, $read_only_fields ) ) {&nbsp;</div></li><li><div>          $order-&gt;affiliate_subid = $_POST['affiliate_subid'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">//save</span>&nbsp;</div></li><li><div>  if ( $order-&gt;saveOrder() !== false ) {&nbsp;</div></li><li><div>      <span class="comment">//handle timestamp</span>&nbsp;</div></li><li><div>      if ( $order-&gt;updateTimestamp( $_POST['ts_year'], $_POST['ts_month'], $_POST['ts_day'] ) !== false ) {&nbsp;</div></li><li><div>          $pmpro_msg = __( &quot;Order saved successfully.&quot;, 'paid-memberships-pro' );&nbsp;</div></li><li><div>          $pmpro_msgt = &quot;success&quot;;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $pmpro_msg = __( &quot;Error updating order timestamp.&quot;, 'paid-memberships-pro' );&nbsp;</div></li><li><div>          $pmpro_msgt = &quot;error&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $pmpro_msg = __( &quot;Error saving order.&quot;, 'paid-memberships-pro' );&nbsp;</div></li><li><div>      $pmpro_msgt = &quot;error&quot;;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>} else {&nbsp;</div></li><li><div>  <span class="comment">//order passed?</span>&nbsp;</div></li><li><div>  if ( ! empty( $_REQUEST['order'] ) ) {&nbsp;</div></li><li><div>      $order_id = intval( $_REQUEST['order'] );&nbsp;</div></li><li><div>      if ( $order_id &gt; 0 ) {&nbsp;</div></li><li><div>          $order = new MemberOrder( $order_id );&nbsp;</div></li><li><div>      } elseif ( ! empty( $_REQUEST['copy'] ) ) {&nbsp;</div></li><li><div>          $order = new MemberOrder( intval( $_REQUEST['copy'] ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">//new id</span>&nbsp;</div></li><li><div>          $order-&gt;id = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">//new code</span>&nbsp;</div></li><li><div>          $order-&gt;code = $order-&gt;getRandomCode();&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $order = new MemberOrder();            <span class="comment">//new order</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">//defaults</span>&nbsp;</div></li><li><div>          $order-&gt;code = $order-&gt;getRandomCode();&nbsp;</div></li><li><div>          $order-&gt;user_id = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;membership_id = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;billing = new stdClass();&nbsp;</div></li><li><div>          $order-&gt;billing-&gt;name = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;billing-&gt;street = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;billing-&gt;city = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;billing-&gt;state = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;billing-&gt;zip = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;billing-&gt;country = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;billing-&gt;phone = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;subtotal = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;tax = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;couponamount = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;total = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;payment_type = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;cardtype = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;accountnumber = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;expirationmonth = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;expirationyear = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;status = &quot;success&quot;;&nbsp;</div></li><li><div>          $order-&gt;gateway = pmpro_getOption(&quot;gateway&quot;);&nbsp;</div></li><li><div>          $order-&gt;gateway_environment = pmpro_getOption(&quot;gateway_environment&quot;);&nbsp;</div></li><li><div>          $order-&gt;payment_transaction_id = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;subscription_transaction_id = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;affiliate_id = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;affiliate_subid = &quot;&quot;;&nbsp;</div></li><li><div>          $order-&gt;notes = &quot;&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>require_once( dirname( __FILE__ ) . &quot;/admin_header.php&quot; );&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php if ( ! empty( $order ) ) { ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;h2&gt;&nbsp;</div></li><li><div>      &lt;?php if ( ! empty( $order-&gt;id ) ) { ?&gt;&nbsp;</div></li><li><div>          &lt;?php _e( 'Order', 'paid-memberships-pro' ); ?&gt; #&lt;?php echo $order-&gt;id ?&gt;: &lt;?php echo $order-&gt;code ?&gt;&nbsp;</div></li><li><div>      &lt;?php } else { ?&gt;&nbsp;</div></li><li><div>          &lt;?php _e( 'New Order', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>      &lt;?php } ?&gt;&nbsp;</div></li><li><div>  &lt;/h2&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php if ( ! empty( $pmpro_msg ) ) { ?&gt;&nbsp;</div></li><li><div>      &lt;div id=&quot;message&quot; class=&quot;&lt;?php if ( $pmpro_msgt == &quot;success&quot; ) {&nbsp;</div></li><li><div>          echo &quot;updated fade&quot;;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          echo &quot;error&quot;;&nbsp;</div></li><li><div>      } ?&gt;&quot;&gt;&lt;p&gt;&lt;?php echo $pmpro_msg ?&gt;&lt;/p&gt;&lt;/div&gt;&nbsp;</div></li><li><div>  &lt;?php } ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;form method=&quot;post&quot; action=&quot;&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;table class=&quot;form-table&quot;&gt;&nbsp;</div></li><li><div>          &lt;tbody&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label&gt;ID:&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&lt;?php if ( ! empty( $order-&gt;id ) ) {&nbsp;</div></li><li><div>                      echo $order-&gt;id;&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      echo __( &quot;This will be generated when you save.&quot;, 'paid-memberships-pro' );&nbsp;</div></li><li><div>                  } ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;code&quot;&gt;&lt;?php _e( 'Code', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;code&quot;, $read_only_fields ) ) {&nbsp;</div></li><li><div>                      echo $order-&gt;code;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;code&quot; name=&quot;code&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;code ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( $order_id &lt; 0 ) { ?&gt;&nbsp;</div></li><li><div>                      &lt;small&nbsp;</div></li><li><div>                          class=&quot;pmpro_lite&quot;&gt;&lt;?php _e( 'Randomly generated for you.', 'paid-memberships-pro' ); ?&gt;&lt;/small&gt;&lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;user_id&quot;&gt;&lt;?php _e( 'User ID', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;user_id&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;user_id;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;user_id&quot; name=&quot;user_id&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;user_id ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;membership_id&quot;&gt;&lt;?php _e( 'Membership Level ID', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>                      :&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;membership_id&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;membership_id;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;membership_id&quot; name=&quot;membership_id&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;membership_id ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;billing_name&quot;&gt;&lt;?php _e( 'Billing Name', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&nbsp;</div></li><li><div>              &lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;billing_name&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;billing_name;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;billing_name&quot; name=&quot;billing_name&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;billing-&gt;name ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;billing_street&quot;&gt;&lt;?php _e( 'Billing Street', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>                      :&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;billing_street&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;billing_street;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                  &lt;input id=&quot;billing_street&quot; name=&quot;billing_street&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                         value=&quot;&lt;?php echo esc_attr( $order-&gt;billing-&gt;street ); ?&gt;&quot;/&gt;&lt;/td&gt;&nbsp;</div></li><li><div>              &lt;?php } ?&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;billing_city&quot;&gt;&lt;?php _e( 'Billing City', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&nbsp;</div></li><li><div>              &lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;billing_city&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;billing_city;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                  &lt;input id=&quot;billing_city&quot; name=&quot;billing_city&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                         value=&quot;&lt;?php echo esc_attr( $order-&gt;billing-&gt;city ); ?&gt;&quot;/&gt;&lt;/td&gt;&nbsp;</div></li><li><div>              &lt;?php } ?&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;billing_state&quot;&gt;&lt;?php _e( 'Billing State', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>                      :&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;billing_state&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;billing_state;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                  &lt;input id=&quot;billing_state&quot; name=&quot;billing_state&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                         value=&quot;&lt;?php echo esc_attr( $order-&gt;billing-&gt;state ); ?&gt;&quot;/&gt;&lt;/td&gt;&nbsp;</div></li><li><div>              &lt;?php } ?&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;billing_zip&quot;&gt;&lt;?php _e( 'Billing Postal Code', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>                      :&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;billing_zip&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;billing_zip;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                  &lt;input id=&quot;billing_zip&quot; name=&quot;billing_zip&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                         value=&quot;&lt;?php echo esc_attr( $order-&gt;billing-&gt;zip ); ?&gt;&quot;/&gt;&lt;/td&gt;&nbsp;</div></li><li><div>              &lt;?php } ?&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;billing_country&quot;&gt;&lt;?php _e( 'Billing Country', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>                      :&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;billing_country&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;billing_country;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;billing_country&quot; name=&quot;billing_country&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;billing-&gt;country ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;billing_phone&quot;&gt;&lt;?php _e( 'Billing Phone', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>                      :&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;billing_phone&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;billing_phone;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;billing_phone&quot; name=&quot;billing_phone&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;billing-&gt;phone ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;subtotal&quot;&gt;&lt;?php _e( 'Sub Total', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;subtotal&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;subtotal;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;subtotal&quot; name=&quot;subtotal&quot; type=&quot;text&quot; size=&quot;10&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;subtotal ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;tax&quot;&gt;&lt;?php _e( 'Tax', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;tax&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;tax;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;tax&quot; name=&quot;tax&quot; type=&quot;text&quot; size=&quot;10&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;tax ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;couponamount&quot;&gt;&lt;?php _e( 'Coupon Amount', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&nbsp;</div></li><li><div>              &lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;couponamount&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;couponamount;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;couponamount&quot; name=&quot;couponamount&quot; type=&quot;text&quot; size=&quot;10&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;couponamount ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;total&quot;&gt;&lt;?php _e( 'Total', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;total&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;total;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;total&quot; name=&quot;total&quot; type=&quot;text&quot; size=&quot;10&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;total ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>                  &lt;small&nbsp;</div></li><li><div>                      class=&quot;pmpro_lite&quot;&gt;&lt;?php _e( 'Should be subtotal + tax - couponamount.', 'paid-memberships-pro' ); ?&gt;&lt;/small&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;payment_type&quot;&gt;&lt;?php _e( 'Payment Type', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&nbsp;</div></li><li><div>              &lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;payment_type&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;payment_type;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;payment_type&quot; name=&quot;payment_type&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;payment_type ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>                  &lt;small&nbsp;</div></li><li><div>                      class=&quot;pmpro_lite&quot;&gt;&lt;?php _e( 'e.g. PayPal Express, PayPal Standard, Credit Card.', 'paid-memberships-pro' ); ?&gt;&lt;/small&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;cardtype&quot;&gt;&lt;?php _e( 'Card Type', 'paid-memberships-pro' ); ?&gt;&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;cardtype&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;cardtype;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;cardtype&quot; name=&quot;cardtype&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;cardtype ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>                  &lt;small class=&quot;pmpro_lite&quot;&gt;&lt;?php _e( 'e.g. Visa, MasterCard, AMEX, etc', 'paid-memberships-pro' ); ?&gt;&lt;/small&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;accountnumber&quot;&gt;&lt;?php _e( 'Account Number', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>                      :&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;accountnumber&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;accountnumber;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;accountnumber&quot; name=&quot;accountnumber&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;accountnumber ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>                  &lt;small class=&quot;pmpro_lite&quot;&gt;&lt;?php _e( 'Obscure all but last 4 digits.', 'paid-memberships-pro' ); ?&gt;&lt;/small&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;?php if ( in_array( &quot;ExpirationDate&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>              echo $order-&gt;ExpirationDate;&nbsp;</div></li><li><div>          } else { ?&gt;&nbsp;</div></li><li><div>              &lt;tr&gt;&nbsp;</div></li><li><div>                  &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label&nbsp;</div></li><li><div>                          for=&quot;expirationmonth&quot;&gt;&lt;?php _e( 'Expiration Month', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;expirationmonth&quot; name=&quot;expirationmonth&quot; type=&quot;text&quot; size=&quot;10&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;expirationmonth ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                      &lt;small class=&quot;pmpro_lite&quot;&gt;MM&lt;/small&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;/tr&gt;&nbsp;</div></li><li><div>              &lt;tr&gt;&nbsp;</div></li><li><div>                  &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;expirationyear&quot;&gt;&lt;?php _e( 'Expiration Year', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>                          :&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;expirationyear&quot; name=&quot;expirationyear&quot; type=&quot;text&quot; size=&quot;10&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;expirationyear ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                      &lt;small class=&quot;pmpro_lite&quot;&gt;YYYY&lt;/small&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;?php } ?&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;status&quot;&gt;&lt;?php _e( 'Status', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;status&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;status;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;?php&nbsp;</div></li><li><div>                      $statuses = array();&nbsp;</div></li><li><div>                      $default_statuses = array(&nbsp;</div></li><li><div>                          &quot;&quot;, &nbsp;</div></li><li><div>                          &quot;success&quot;, &nbsp;</div></li><li><div>                          &quot;cancelled&quot;, &nbsp;</div></li><li><div>                          &quot;review&quot;, &nbsp;</div></li><li><div>                          &quot;token&quot;, &nbsp;</div></li><li><div>                          &quot;refunded&quot;, &nbsp;</div></li><li><div>                          &quot;pending&quot;, &nbsp;</div></li><li><div>                          &quot;error&quot;, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                      $used_statuses = $wpdb-&gt;get_col( &quot;SELECT DISTINCT(status) FROM $wpdb-&gt;pmpro_membership_orders&quot; );&nbsp;</div></li><li><div>                      $statuses = array_unique( array_merge( $default_statuses, $used_statuses ) );&nbsp;</div></li><li><div>                      asort( $statuses );&nbsp;</div></li><li><div>                      $statuses = apply_filters( &quot;pmpro_order_statuses&quot;, $statuses );&nbsp;</div></li><li><div>                      ?&gt;&nbsp;</div></li><li><div>                      &lt;select id=&quot;status&quot; name=&quot;status&quot;&gt;&nbsp;</div></li><li><div>                          &lt;?php foreach ( $statuses as $status ) { ?&gt;&nbsp;</div></li><li><div>                              &lt;option&nbsp;</div></li><li><div>                                  value=&quot;&lt;?php echo esc_attr( $status ); ?&gt;&quot; &lt;?php selected( $order-&gt;status, $status ); ?&gt;&gt;&lt;?php echo $status; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                          &lt;?php } ?&gt;&nbsp;</div></li><li><div>                      &lt;/select&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;gateway&quot;&gt;&lt;?php _e( 'Gateway', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;gateway&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;gateway;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;select id=&quot;gateway&quot; name=&quot;gateway&quot; onchange=&quot;pmpro_changeGateway(jQuery(this).val());&quot;&gt;&nbsp;</div></li><li><div>                          &lt;?php&nbsp;</div></li><li><div>                          $pmpro_gateways = pmpro_gateways();&nbsp;</div></li><li><div>                          foreach ( $pmpro_gateways as $pmpro_gateway_name =&gt; $pmpro_gateway_label ) {&nbsp;</div></li><li><div>                              ?&gt;&nbsp;</div></li><li><div>                              &lt;option&nbsp;</div></li><li><div>                                  value=&quot;&lt;?php echo esc_attr( $pmpro_gateway_name ); ?&gt;&quot; &lt;?php selected( $order-&gt;gateway, $pmpro_gateway_name ); ?&gt;&gt;&lt;?php echo $pmpro_gateway_label; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                              &lt;?php&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          ?&gt;&nbsp;</div></li><li><div>                      &lt;/select&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label&nbsp;</div></li><li><div>                      for=&quot;gateway_environment&quot;&gt;&lt;?php _e( 'Gateway Environment', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;gateway_environment&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;gateway_environment;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;select name=&quot;gateway_environment&quot;&gt;&nbsp;</div></li><li><div>                          &lt;option value=&quot;sandbox&quot;&nbsp;</div></li><li><div>                                  &lt;?php if ( $order-&gt;gateway_environment == &quot;sandbox&quot; ) { ?&gt;selected=&quot;selected&quot;&lt;?php } ?&gt;&gt;&lt;?php _e( 'Sandbox/Testing', 'paid-memberships-pro' ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                          &lt;option value=&quot;live&quot;&nbsp;</div></li><li><div>                                  &lt;?php if ( $order-&gt;gateway_environment == &quot;live&quot; ) { ?&gt;selected=&quot;selected&quot;&lt;?php } ?&gt;&gt;&lt;?php _e( 'Live/Production', 'paid-memberships-pro' ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;/select&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label&nbsp;</div></li><li><div>                      for=&quot;payment_transaction_id&quot;&gt;&lt;?php _e( 'Payment Transaction ID', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;payment_transaction_id&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;payment_transaction_id;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;payment_transaction_id&quot; name=&quot;payment_transaction_id&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;payment_transaction_id ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>                  &lt;small&nbsp;</div></li><li><div>                      class=&quot;pmpro_lite&quot;&gt;&lt;?php _e( 'Generated by the gateway. Useful to cross reference orders.', 'paid-memberships-pro' ); ?&gt;&lt;/small&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label&nbsp;</div></li><li><div>                      for=&quot;subscription_transaction_id&quot;&gt;&lt;?php _e( 'Subscription Transaction ID', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>                      :&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;subscription_transaction_id&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;subscription_transaction_id;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;input id=&quot;subscription_transaction_id&quot; name=&quot;subscription_transaction_id&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                             value=&quot;&lt;?php echo esc_attr( $order-&gt;subscription_transaction_id ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>                  &lt;small&nbsp;</div></li><li><div>                      class=&quot;pmpro_lite&quot;&gt;&lt;?php _e( 'Generated by the gateway. Useful to cross reference subscriptions.', 'paid-memberships-pro' ); ?&gt;&lt;/small&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;ts_month&quot;&gt;&lt;?php _e( 'Date', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;timestamp&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo date_i18n( get_option( 'date_format' ) . &quot; &quot; . get_option( 'time_format' ), $order-&gt;timestamp );&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;?php&nbsp;</div></li><li><div>                      <span class="comment">//set up date vars</span>&nbsp;</div></li><li><div>                      if ( ! empty( $order-&gt;timestamp ) ) {&nbsp;</div></li><li><div>                          $timestamp = $order-&gt;timestamp;&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          $timestamp = current_time( 'timestamp' );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      $year = date_i18n( &quot;Y&quot;, $timestamp );&nbsp;</div></li><li><div>                      $month = date_i18n( &quot;n&quot;, $timestamp );&nbsp;</div></li><li><div>                      $day = date_i18n( &quot;j&quot;, $timestamp );&nbsp;</div></li><li><div>                      ?&gt;&nbsp;</div></li><li><div>                      &lt;select id=&quot;ts_month&quot; name=&quot;ts_month&quot;&gt;&nbsp;</div></li><li><div>                          &lt;?php&nbsp;</div></li><li><div>                          for ( $i = 1; $i &lt; 13; $i ++ ) {&nbsp;</div></li><li><div>                              ?&gt;&nbsp;</div></li><li><div>                              &lt;option value=&quot;&lt;?php echo $i ?&gt;&quot;&nbsp;</div></li><li><div>                                      &lt;?php if ( $i == $month ) { ?&gt;selected=&quot;selected&quot;&lt;?php } ?&gt;&gt;&lt;?php echo date_i18n( &quot;M&quot;, strtotime( $i . &quot;/1/&quot; . $year, current_time( &quot;timestamp&quot; ) ) ) ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                              &lt;?php&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          ?&gt;&nbsp;</div></li><li><div>                      &lt;/select&gt;&nbsp;</div></li><li><div>                      &lt;input name=&quot;ts_day&quot; type=&quot;text&quot; size=&quot;2&quot; value=&quot;&lt;?php echo esc_attr( $day ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                      &lt;input name=&quot;ts_year&quot; type=&quot;text&quot; size=&quot;4&quot; value=&quot;&lt;?php echo esc_attr( $year ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>          $affiliates = apply_filters( &quot;pmpro_orders_show_affiliate_ids&quot;, false );&nbsp;</div></li><li><div>          if ( ! empty( $affiliates ) ) {&nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>              &lt;tr&gt;&nbsp;</div></li><li><div>                  &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;affiliate_id&quot;&gt;&lt;?php _e( 'Affiliate ID', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>                          :&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;?php if ( in_array( &quot;affiliate_id&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                          echo $order-&gt;affiliate_id;&nbsp;</div></li><li><div>                      } else { ?&gt;&nbsp;</div></li><li><div>                          &lt;input id=&quot;affiliate_id&quot; name=&quot;affiliate_id&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                                 value=&quot;&lt;?php echo esc_attr( $order-&gt;affiliate_id ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                      &lt;?php } ?&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;/tr&gt;&nbsp;</div></li><li><div>              &lt;tr&gt;&nbsp;</div></li><li><div>                  &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;affiliate_subid&quot;&gt;&lt;?php _e( 'Affiliate SubID', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>                          :&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;?php if ( in_array( &quot;affiliate_subid&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                          echo $order-&gt;affiliate_subid;&nbsp;</div></li><li><div>                      } else { ?&gt;&nbsp;</div></li><li><div>                          &lt;input id=&quot;affiliate_subid&quot; name=&quot;affiliate_subid&quot; type=&quot;text&quot; size=&quot;50&quot;&nbsp;</div></li><li><div>                                 value=&quot;&lt;?php echo esc_attr( $order-&gt;affiliate_subid ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                      &lt;?php } ?&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;?php } ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;row&quot; valign=&quot;top&quot;&gt;&lt;label for=&quot;notes&quot;&gt;&lt;?php _e( 'Notes', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( in_array( &quot;notes&quot;, $read_only_fields ) && $order_id &gt; 0 ) {&nbsp;</div></li><li><div>                      echo $order-&gt;notes;&nbsp;</div></li><li><div>                  } else { ?&gt;&nbsp;</div></li><li><div>                      &lt;textarea id=&quot;notes&quot; name=&quot;notes&quot; rows=&quot;5&quot;&nbsp;</div></li><li><div>                                cols=&quot;80&quot;&gt;&lt;?php echo esc_textarea( $order-&gt;notes ); ?&gt;&lt;/textarea&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php do_action( &quot;pmpro_after_order_settings&quot;, $order ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/tbody&gt;&nbsp;</div></li><li><div>      &lt;/table&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;p class=&quot;submit topborder&quot;&gt;&nbsp;</div></li><li><div>          &lt;input name=&quot;order&quot; type=&quot;hidden&quot; value=&quot;&lt;?php if ( ! empty( $order-&gt;id ) ) {&nbsp;</div></li><li><div>              echo $order-&gt;id;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              echo $order_id;&nbsp;</div></li><li><div>          } ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>          &lt;input name=&quot;save&quot; type=&quot;submit&quot; class=&quot;button-primary&quot; value=&quot;&lt;?php _e( 'Save Order', 'paid-memberships-pro' ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>          &lt;input name=&quot;cancel&quot; type=&quot;button&quot; class=&quot;cancel button-secondary&quot; value=&quot;&lt;?php _e( 'Cancel', 'paid-memberships-pro' ); ?&gt;&quot;&nbsp;</div></li><li><div>                 onclick=&quot;location.href='&lt;?php echo get_admin_url( null, '/admin.php?page=pmpro-orders' ) ?&gt;';&quot;/&gt;&nbsp;</div></li><li><div>      &lt;/p&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;/form&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php } else { ?&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Code to handle emailing billable invoices.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 1.8.6</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>  &lt;script&gt;&nbsp;</div></li><li><div>      <span class="comment">// Update fields in email modal.</span>&nbsp;</div></li><li><div>      jQuery(document).ready(function ($) {&nbsp;</div></li><li><div>          var order, order_id;&nbsp;</div></li><li><div>          $('.email_link').click(function () {&nbsp;</div></li><li><div>              order_id = $(this).data('order');&nbsp;</div></li><li><div>              $('input[name=order]').val(order_id);&nbsp;</div></li><li><div>              <span class="comment">// Get email address from order ID</span>&nbsp;</div></li><li><div>              data = {&nbsp;</div></li><li><div>                  action: 'pmpro_get_order_json', &nbsp;</div></li><li><div>                  order_id: order_id&nbsp;</div></li><li><div>              };&nbsp;</div></li><li><div>              $.post(ajaxurl, data, function (response) {&nbsp;</div></li><li><div>                  order = JSON.parse(response);&nbsp;</div></li><li><div>                  $('input[name=email]').val(order.Email);&nbsp;</div></li><li><div>              });&nbsp;</div></li><li><div>          });&nbsp;</div></li><li><div>      });&nbsp;</div></li><li><div>  &lt;/script&gt;&nbsp;</div></li><li><div>  &lt;?php add_thickbox(); ?&gt;&nbsp;</div></li><li><div>  &lt;div id=&quot;email_invoice&quot; style=&quot;display:none;&quot;&gt;&nbsp;</div></li><li><div>      &lt;h3&gt;&lt;?php _e( 'Email Invoice', 'paid-memberships-pro' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>      &lt;form method=&quot;post&quot; action=&quot;&quot;&gt;&nbsp;</div></li><li><div>          &lt;input type=&quot;hidden&quot; name=&quot;order&quot; value=&quot;&quot;/&gt;&nbsp;</div></li><li><div>          &lt;?php _e( 'Send an invoice for this order to: ', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>          &lt;input type=&quot;text&quot; value=&quot;&quot; name=&quot;email&quot;/&gt;&nbsp;</div></li><li><div>          &lt;button class=&quot;button button-primary alignright&quot;&gt;&lt;?php _e( 'Send Email', 'paid-memberships-pro' ); ?&gt;&lt;/button&gt;&nbsp;</div></li><li><div>      &lt;/form&gt;&nbsp;</div></li><li><div>  &lt;/div&gt;&nbsp;</div></li><li><div>  &lt;form id=&quot;posts-filter&quot; method=&quot;get&quot; action=&quot;&quot;&gt;&nbsp;</div></li><li><div>      &lt;h2&gt;&nbsp;</div></li><li><div>          &lt;?php _e( 'Orders', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>          &lt;a href=&quot;admin.php?page=pmpro-orders&order=-1&quot;&nbsp;</div></li><li><div>             class=&quot;add-new-h2&quot;&gt;+ &lt;?php _e( 'Add New Order', 'paid-memberships-pro' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>          <span class="comment">//build the export URL</span>&nbsp;</div></li><li><div>          $export_url = admin_url( 'admin-ajax.php?action=orders_csv' );&nbsp;</div></li><li><div>          $url_params = array(&nbsp;</div></li><li><div>              &quot;filter&quot; =&gt; $filter, &nbsp;</div></li><li><div>              &quot;s&quot; =&gt; $s, &nbsp;</div></li><li><div>              &quot;l&quot; =&gt; $l, &nbsp;</div></li><li><div>              &quot;start-month&quot; =&gt; $start_month, &nbsp;</div></li><li><div>              &quot;start-day&quot; =&gt; $start_day, &nbsp;</div></li><li><div>              &quot;start-year&quot; =&gt; $start_year, &nbsp;</div></li><li><div>              &quot;end-month&quot; =&gt; $end_month, &nbsp;</div></li><li><div>              &quot;end-day&quot; =&gt; $end_day, &nbsp;</div></li><li><div>              &quot;end-year&quot; =&gt; $end_year, &nbsp;</div></li><li><div>              &quot;predefined-date&quot; =&gt; $predefined_date, &nbsp;</div></li><li><div>              &quot;status&quot; =&gt; $status&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          $export_url = add_query_arg( $url_params, $export_url );&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>          &lt;a target=&quot;_blank&quot; href=&quot;&lt;?php echo $export_url; ?&gt;&quot;&nbsp;</div></li><li><div>             class=&quot;add-new-h2&quot;&gt;&lt;?php _e( 'Export to CSV', 'paid-memberships-pro' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>      &lt;/h2&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php if ( ! empty( $pmpro_msg ) ) { ?&gt;&nbsp;</div></li><li><div>          &lt;div id=&quot;message&quot; class=&quot;&lt;?php if ( $pmpro_msgt == &quot;success&quot; ) {&nbsp;</div></li><li><div>              echo &quot;updated fade&quot;;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              echo &quot;error&quot;;&nbsp;</div></li><li><div>          } ?&gt;&quot;&gt;&lt;p&gt;&lt;?php echo $pmpro_msg ?&gt;&lt;/p&gt;&lt;/div&gt;&nbsp;</div></li><li><div>      &lt;?php } ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;ul class=&quot;subsubsub&quot;&gt;&nbsp;</div></li><li><div>          &lt;li&gt;&nbsp;</div></li><li><div>              &lt;?php _e( 'Show', 'paid-memberships-pro' ) ?&gt;&nbsp;</div></li><li><div>              &lt;select id=&quot;filter&quot; name=&quot;filter&quot;&gt;&nbsp;</div></li><li><div>                  &lt;option value=&quot;all&quot; &lt;?php selected( $filter, &quot;all&quot; ); ?&gt;&gt;&lt;?php _e( 'All', 'paid-memberships-pro' ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;option&nbsp;</div></li><li><div>                      value=&quot;within-a-date-range&quot; &lt;?php selected( $filter, &quot;within-a-date-range&quot; ); ?&gt;&gt;&lt;?php _e( 'Within a Date Range', 'paid-memberships-pro' ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;option&nbsp;</div></li><li><div>                      value=&quot;predefined-date-range&quot; &lt;?php selected( $filter, &quot;predefined-date-range&quot; ); ?&gt;&gt;&lt;?php _e( 'Predefined Date Range', 'paid-memberships-pro' ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;option&nbsp;</div></li><li><div>                      value=&quot;within-a-level&quot; &lt;?php selected( $filter, &quot;within-a-level&quot; ); ?&gt;&gt;&lt;?php _e( 'Within a Level', 'paid-memberships-pro' ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;option&nbsp;</div></li><li><div>                      value=&quot;within-a-status&quot; &lt;?php selected( $filter, &quot;within-a-status&quot; ); ?&gt;&gt;&lt;?php _e( 'Within a Status', 'paid-memberships-pro' ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>              &lt;/select&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;span id=&quot;from&quot;&gt;&lt;?php _e( 'From', 'paid-memberships-pro' ) ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;select id=&quot;start-month&quot; name=&quot;start-month&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php for ( $i = 1; $i &lt; 13; $i ++ ) { ?&gt;&nbsp;</div></li><li><div>                      &lt;option&nbsp;</div></li><li><div>                          value=&quot;&lt;?php echo $i; ?&gt;&quot; &lt;?php selected( $start_month, $i ); ?&gt;&gt;&lt;?php echo date_i18n( &quot;F&quot;, mktime( 0, 0, 0, $i, 2 ) ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/select&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;input id='start-day' name=&quot;start-day&quot; type=&quot;text&quot; size=&quot;2&quot;&nbsp;</div></li><li><div>                     value=&quot;&lt;?php echo esc_attr( $start_day ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>              &lt;input id='start-year' name=&quot;start-year&quot; type=&quot;text&quot; size=&quot;4&quot;&nbsp;</div></li><li><div>                     value=&quot;&lt;?php echo esc_attr( $start_year ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;span id=&quot;to&quot;&gt;&lt;?php _e( 'To', 'paid-memberships-pro' ) ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;select id=&quot;end-month&quot; name=&quot;end-month&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php for ( $i = 1; $i &lt; 13; $i ++ ) { ?&gt;&nbsp;</div></li><li><div>                      &lt;option&nbsp;</div></li><li><div>                          value=&quot;&lt;?php echo $i; ?&gt;&quot; &lt;?php selected( $end_month, $i ); ?&gt;&gt;&lt;?php echo date_i18n( &quot;F&quot;, mktime( 0, 0, 0, $i, 2 ) ); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/select&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;input id='end-day' name=&quot;end-day&quot; type=&quot;text&quot; size=&quot;2&quot; value=&quot;&lt;?php echo esc_attr( $end_day ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>              &lt;input id='end-year' name=&quot;end-year&quot; type=&quot;text&quot; size=&quot;4&quot; value=&quot;&lt;?php echo esc_attr( $end_year ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;span id=&quot;filterby&quot;&gt;&lt;?php _e( 'filter by ', 'paid-memberships-pro' ) ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;select id=&quot;predefined-date&quot; name=&quot;predefined-date&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;option&nbsp;</div></li><li><div>                      value=&quot;&lt;?php echo &quot;This Month&quot;; ?&gt;&quot; &lt;?php selected( $predefined_date, &quot;This Month&quot; ); ?&gt;&gt;&lt;?php echo &quot;This Month&quot;; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;option&nbsp;</div></li><li><div>                      value=&quot;&lt;?php echo &quot;Last Month&quot;; ?&gt;&quot; &lt;?php selected( $predefined_date, &quot;Last Month&quot; ); ?&gt;&gt;&lt;?php echo &quot;Last Month&quot;; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;option&nbsp;</div></li><li><div>                      value=&quot;&lt;?php echo &quot;This Year&quot;; ?&gt;&quot; &lt;?php selected( $predefined_date, &quot;This Year&quot; ); ?&gt;&gt;&lt;?php echo &quot;This Year&quot;; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;option&nbsp;</div></li><li><div>                      value=&quot;&lt;?php echo &quot;Last Year&quot;; ?&gt;&quot; &lt;?php selected( $predefined_date, &quot;Last Year&quot; ); ?&gt;&gt;&lt;?php echo &quot;Last Year&quot;; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;/select&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;?php&nbsp;</div></li><li><div>              <span class="comment">//Note: only orders belonging to current levels can be filtered. There is no option for orders belonging to deleted levels</span>&nbsp;</div></li><li><div>              $levels = pmpro_getAllLevels( true, true );&nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>              &lt;select id=&quot;l&quot; name=&quot;l&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php foreach ( $levels as $level ) { ?&gt;&nbsp;</div></li><li><div>                      &lt;option&nbsp;</div></li><li><div>                          value=&quot;&lt;?php echo $level-&gt;id; ?&gt;&quot; &lt;?php selected( $l, $level-&gt;id ); ?&gt;&gt;&lt;?php echo $level-&gt;name; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;/select&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;?php&nbsp;</div></li><li><div>              $statuses = array();&nbsp;</div></li><li><div>              $default_statuses = array( &quot;&quot;, &quot;success&quot;, &quot;cancelled&quot;, &quot;review&quot;, &quot;token&quot;, &quot;refunded&quot; );&nbsp;</div></li><li><div>              $used_statuses = $wpdb-&gt;get_col( &quot;SELECT DISTINCT(status) FROM $wpdb-&gt;pmpro_membership_orders&quot; );&nbsp;</div></li><li><div>              $statuses = array_unique( array_merge( $default_statuses, $used_statuses ) );&nbsp;</div></li><li><div>              asort( $statuses );&nbsp;</div></li><li><div>              $statuses = apply_filters( &quot;pmpro_order_statuses&quot;, $statuses );&nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>              &lt;select id=&quot;status&quot; name=&quot;status&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php foreach ( $statuses as $the_status ) { ?&gt;&nbsp;</div></li><li><div>                      &lt;option&nbsp;</div></li><li><div>                          value=&quot;&lt;?php echo esc_attr( $the_status ); ?&gt;&quot; &lt;?php selected( $the_status, $status ); ?&gt;&gt;&lt;?php echo $the_status; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;?php } ?&gt;&nbsp;</div></li><li><div>              &lt;/select&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;input id=&quot;submit&quot; type=&quot;submit&quot; value=&quot;&lt;?php _e( 'Filter', 'paid-memberships-pro' ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>          &lt;/li&gt;&nbsp;</div></li><li><div>      &lt;/ul&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;script&gt;&nbsp;</div></li><li><div>          <span class="comment">//update month/year when period dropdown is changed</span>&nbsp;</div></li><li><div>          jQuery(document).ready(function () {&nbsp;</div></li><li><div>              jQuery('#filter').change(function () {&nbsp;</div></li><li><div>                  pmpro_ShowMonthOrYear();&nbsp;</div></li><li><div>              });&nbsp;</div></li><li><div>          });&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          function pmpro_ShowMonthOrYear() {&nbsp;</div></li><li><div>              var filter = jQuery('#filter').val();&nbsp;</div></li><li><div>              if (filter == 'all') {&nbsp;</div></li><li><div>                  jQuery('#start-month').hide();&nbsp;</div></li><li><div>                  jQuery('#start-day').hide();&nbsp;</div></li><li><div>                  jQuery('#start-year').hide();&nbsp;</div></li><li><div>                  jQuery('#end-month').hide();&nbsp;</div></li><li><div>                  jQuery('#end-day').hide();&nbsp;</div></li><li><div>                  jQuery('#end-year').hide();&nbsp;</div></li><li><div>                  jQuery('#predefined-date').hide();&nbsp;</div></li><li><div>                  jQuery('#status').hide();&nbsp;</div></li><li><div>                  jQuery('#l').hide();&nbsp;</div></li><li><div>                  jQuery('#from').hide();&nbsp;</div></li><li><div>                  jQuery('#to').hide();&nbsp;</div></li><li><div>                  jQuery('#submit').show();&nbsp;</div></li><li><div>                  jQuery('#filterby').hide();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              else if (filter == 'within-a-date-range') {&nbsp;</div></li><li><div>                  jQuery('#start-month').show();&nbsp;</div></li><li><div>                  jQuery('#start-day').show();&nbsp;</div></li><li><div>                  jQuery('#start-year').show();&nbsp;</div></li><li><div>                  jQuery('#end-month').show();&nbsp;</div></li><li><div>                  jQuery('#end-day').show();&nbsp;</div></li><li><div>                  jQuery('#end-year').show();&nbsp;</div></li><li><div>                  jQuery('#predefined-date').hide();&nbsp;</div></li><li><div>                  jQuery('#status').hide();&nbsp;</div></li><li><div>                  jQuery('#l').hide();&nbsp;</div></li><li><div>                  jQuery('#submit').show();&nbsp;</div></li><li><div>                  jQuery('#from').show();&nbsp;</div></li><li><div>                  jQuery('#to').show();&nbsp;</div></li><li><div>                  jQuery('#filterby').hide();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              else if (filter == 'predefined-date-range') {&nbsp;</div></li><li><div>                  jQuery('#start-month').hide();&nbsp;</div></li><li><div>                  jQuery('#start-day').hide();&nbsp;</div></li><li><div>                  jQuery('#start-year').hide();&nbsp;</div></li><li><div>                  jQuery('#end-month').hide();&nbsp;</div></li><li><div>                  jQuery('#end-day').hide();&nbsp;</div></li><li><div>                  jQuery('#end-year').hide();&nbsp;</div></li><li><div>                  jQuery('#predefined-date').show();&nbsp;</div></li><li><div>                  jQuery('#status').hide();&nbsp;</div></li><li><div>                  jQuery('#l').hide();&nbsp;</div></li><li><div>                  jQuery('#submit').show();&nbsp;</div></li><li><div>                  jQuery('#from').hide();&nbsp;</div></li><li><div>                  jQuery('#to').hide();&nbsp;</div></li><li><div>                  jQuery('#filterby').show();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              else if (filter == 'within-a-level') {&nbsp;</div></li><li><div>                  jQuery('#start-month').hide();&nbsp;</div></li><li><div>                  jQuery('#start-day').hide();&nbsp;</div></li><li><div>                  jQuery('#start-year').hide();&nbsp;</div></li><li><div>                  jQuery('#end-month').hide();&nbsp;</div></li><li><div>                  jQuery('#end-day').hide();&nbsp;</div></li><li><div>                  jQuery('#end-year').hide();&nbsp;</div></li><li><div>                  jQuery('#predefined-date').hide();&nbsp;</div></li><li><div>                  jQuery('#status').hide();&nbsp;</div></li><li><div>                  jQuery('#l').show();&nbsp;</div></li><li><div>                  jQuery('#submit').show();&nbsp;</div></li><li><div>                  jQuery('#from').hide();&nbsp;</div></li><li><div>                  jQuery('#to').hide();&nbsp;</div></li><li><div>                  jQuery('#filterby').show();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              else if (filter == 'within-a-status') {&nbsp;</div></li><li><div>                  jQuery('#start-month').hide();&nbsp;</div></li><li><div>                  jQuery('#start-day').hide();&nbsp;</div></li><li><div>                  jQuery('#start-year').hide();&nbsp;</div></li><li><div>                  jQuery('#end-month').hide();&nbsp;</div></li><li><div>                  jQuery('#end-day').hide();&nbsp;</div></li><li><div>                  jQuery('#end-year').hide();&nbsp;</div></li><li><div>                  jQuery('#predefined-date').hide();&nbsp;</div></li><li><div>                  jQuery('#status').show();&nbsp;</div></li><li><div>                  jQuery('#l').hide();&nbsp;</div></li><li><div>                  jQuery('#submit').show();&nbsp;</div></li><li><div>                  jQuery('#from').hide();&nbsp;</div></li><li><div>                  jQuery('#to').hide();&nbsp;</div></li><li><div>                  jQuery('#filterby').show();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          pmpro_ShowMonthOrYear();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;/script&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;p class=&quot;search-box&quot;&gt;&nbsp;</div></li><li><div>          &lt;label class=&quot;hidden&quot; for=&quot;post-search-input&quot;&gt;&lt;?php _e( 'Search Orders', 'paid-memberships-pro' ); ?&gt;:&lt;/label&gt;&nbsp;</div></li><li><div>          &lt;input type=&quot;hidden&quot; name=&quot;page&quot; value=&quot;pmpro-orders&quot;/&gt;&nbsp;</div></li><li><div>          &lt;input id=&quot;post-search-input&quot; type=&quot;text&quot; value=&quot;&lt;?php echo esc_attr( $s ); ?&gt;&quot; name=&quot;s&quot;/&gt;&nbsp;</div></li><li><div>          &lt;input class=&quot;button&quot; type=&quot;submit&quot; value=&quot;&lt;?php _e( 'Search Orders', 'paid-memberships-pro' ); ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>      &lt;/p&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      <span class="comment">//string search</span>&nbsp;</div></li><li><div>      if ( $s ) {&nbsp;</div></li><li><div>          $sqlQuery = &quot;SELECT SQL_CALC_FOUND_ROWS o.id FROM $wpdb-&gt;pmpro_membership_orders o LEFT JOIN $wpdb-&gt;users u ON o.user_id = u.ID LEFT JOIN $wpdb-&gt;pmpro_membership_levels l ON o.membership_id = l.id &quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $join_with_usermeta = apply_filters( &quot;pmpro_orders_search_usermeta&quot;, false );&nbsp;</div></li><li><div>          if ( $join_with_usermeta ) {&nbsp;</div></li><li><div>              $sqlQuery .= &quot;LEFT JOIN $wpdb-&gt;usermeta um ON o.user_id = um.user_id &quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sqlQuery .= &quot;WHERE (1=2 &quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $fields = array(&nbsp;</div></li><li><div>              &quot;o.id&quot;, &nbsp;</div></li><li><div>              &quot;o.code&quot;, &nbsp;</div></li><li><div>              &quot;o.billing_name&quot;, &nbsp;</div></li><li><div>              &quot;o.billing_street&quot;, &nbsp;</div></li><li><div>              &quot;o.billing_city&quot;, &nbsp;</div></li><li><div>              &quot;o.billing_state&quot;, &nbsp;</div></li><li><div>              &quot;o.billing_zip&quot;, &nbsp;</div></li><li><div>              &quot;o.billing_phone&quot;, &nbsp;</div></li><li><div>              &quot;o.payment_type&quot;, &nbsp;</div></li><li><div>              &quot;o.cardtype&quot;, &nbsp;</div></li><li><div>              &quot;o.accountnumber&quot;, &nbsp;</div></li><li><div>              &quot;o.status&quot;, &nbsp;</div></li><li><div>              &quot;o.gateway&quot;, &nbsp;</div></li><li><div>              &quot;o.gateway_environment&quot;, &nbsp;</div></li><li><div>              &quot;o.payment_transaction_id&quot;, &nbsp;</div></li><li><div>              &quot;o.subscription_transaction_id&quot;, &nbsp;</div></li><li><div>              &quot;u.user_login&quot;, &nbsp;</div></li><li><div>              &quot;u.user_email&quot;, &nbsp;</div></li><li><div>              &quot;u.display_name&quot;, &nbsp;</div></li><li><div>              &quot;l.name&quot;&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $join_with_usermeta ) {&nbsp;</div></li><li><div>              $fields[] = &quot;um.meta_value&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $fields = apply_filters( &quot;pmpro_orders_search_fields&quot;, $fields );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $fields as $field ) {&nbsp;</div></li><li><div>              $sqlQuery .= &quot; OR &quot; . $field . &quot; LIKE '%&quot; . esc_sql( $s ) . &quot;%' &quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $sqlQuery .= &quot;) &quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sqlQuery .= &quot;AND &quot; . $condition . &quot; &quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sqlQuery .= &quot;GROUP BY o.id ORDER BY o.id DESC, o.timestamp DESC &quot;;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $sqlQuery = &quot;SELECT SQL_CALC_FOUND_ROWS id FROM $wpdb-&gt;pmpro_membership_orders WHERE &quot; . $condition . &quot; ORDER BY id DESC, timestamp DESC &quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $sqlQuery .= &quot;LIMIT $start, $limit&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $order_ids = $wpdb-&gt;get_col( $sqlQuery );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $totalrows = $wpdb-&gt;get_var( &quot;SELECT FOUND_ROWS() as found_rows&quot; );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $order_ids ) {&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>          &lt;p class=&quot;clear&quot;&gt;&lt;?php printf( __( &quot;%d orders found.&quot;, 'paid-memberships-pro' ), $totalrows ); ?&gt;&lt;/span&gt;&lt;/p&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;table class=&quot;widefat&quot;&gt;&nbsp;</div></li><li><div>          &lt;thead&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;thead&quot;&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;?php _e( 'ID', 'paid-memberships-pro' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;?php _e( 'Code', 'paid-memberships-pro' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;?php _e( 'User', 'paid-memberships-pro' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;?php do_action( &quot;pmpro_orders_extra_cols_header&quot;, $order_ids ); ?&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;?php _e( 'Membership Level', 'paid-memberships-pro' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;?php _e( 'Total', 'paid-memberships-pro' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;?php _e( 'Payment', 'paid-memberships-pro' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;?php _e( 'Gateway', 'paid-memberships-pro' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;?php _e( 'Transaction IDs', 'paid-memberships-pro' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;?php _e( 'Status', 'paid-memberships-pro' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;?php _e( 'Date', 'paid-memberships-pro' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th&gt;&lt;/th&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;/thead&gt;&nbsp;</div></li><li><div>          &lt;tbody id=&quot;orders&quot; class=&quot;list:order orders-list&quot;&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>          $count = 0;&nbsp;</div></li><li><div>          foreach ( $order_ids as $order_id ) {&nbsp;</div></li><li><div>              $order = new MemberOrder();&nbsp;</div></li><li><div>              $order-&gt;nogateway = true;&nbsp;</div></li><li><div>              $order-&gt;getMemberOrderByID( $order_id );&nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>              &lt;tr &lt;?php if ( $count ++ % 2 == 0 ) { ?&gt;class=&quot;alternate&quot;&lt;?php } ?&gt;&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;a href=&quot;admin.php?page=pmpro-orders&order=&lt;?php echo $order-&gt;id ?&gt;&quot;&gt;&lt;?php echo $order-&gt;id; ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;a href=&quot;admin.php?page=pmpro-orders&order=&lt;?php echo $order-&gt;id ?&gt;&quot;&gt;&lt;?php echo $order-&gt;code; ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td class=&quot;username column-username&quot;&gt;&nbsp;</div></li><li><div>                      &lt;?php $order-&gt;getUser(); ?&gt;&nbsp;</div></li><li><div>                      &lt;?php if ( ! empty( $order-&gt;user ) ) { ?&gt;&nbsp;</div></li><li><div>                          &lt;a href=&quot;user-edit.php?user_id=&lt;?php echo $order-&gt;user-&gt;ID ?&gt;&quot;&gt;&lt;?php echo $order-&gt;user-&gt;user_login ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                      &lt;?php } else { ?&gt;&nbsp;</div></li><li><div>                          [&lt;?php _e( 'deleted', 'paid-memberships-pro' ); ?&gt;]&nbsp;</div></li><li><div>                      &lt;?php } ?&gt;&nbsp;</div></li><li><div>                      &lt;br/&gt;&nbsp;</div></li><li><div>                      &lt;?php&nbsp;</div></li><li><div>                      <span class="comment">// Set up the hover actions for this user</span>&nbsp;</div></li><li><div>                      $actions = apply_filters( 'pmpro_orders_user_row_actions', array(), $order-&gt;user, $order );&nbsp;</div></li><li><div>                      $action_count = count( $actions );&nbsp;</div></li><li><div>                      $i = 0;&nbsp;</div></li><li><div>                      if ( $action_count ) {&nbsp;</div></li><li><div>                          $out = '&lt;div class=&quot;row-actions&quot;&gt;';&nbsp;</div></li><li><div>                          foreach ( $actions as $action =&gt; $link ) {&nbsp;</div></li><li><div>                              ++ $i;&nbsp;</div></li><li><div>                              ( $i == $action_count ) ? $sep = '' : $sep = ' | ';&nbsp;</div></li><li><div>                              $out .= &quot;&lt;span class='$action'&gt;$link$sep&lt;/span&gt;&quot;;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $out .= '&lt;/div&gt;';&nbsp;</div></li><li><div>                          echo $out;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      ?&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;?php do_action( &quot;pmpro_orders_extra_cols_body&quot;, $order ); ?&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&lt;?php echo $order-&gt;membership_id; ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&lt;?php echo pmpro_formatPrice( $order-&gt;total ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;?php if ( ! empty( $order-&gt;payment_type ) ) {&nbsp;</div></li><li><div>                          echo $order-&gt;payment_type . &quot;&lt;br /&gt;&quot;;&nbsp;</div></li><li><div>                      } ?&gt;&nbsp;</div></li><li><div>                      &lt;?php if ( ! empty( $order-&gt;accountnumber ) ) { ?&gt;&nbsp;</div></li><li><div>                          &lt;?php echo $order-&gt;cardtype; ?&gt;: x&lt;?php echo last4( $order-&gt;accountnumber ); ?&gt;&lt;br/&gt;&nbsp;</div></li><li><div>                      &lt;?php } ?&gt;&nbsp;</div></li><li><div>                      &lt;?php if ( ! empty( $order-&gt;billing-&gt;name ) ) { ?&gt;&nbsp;</div></li><li><div>                              &lt;?php echo $order-&gt;billing-&gt;name; ?&gt;&lt;br/&gt;&nbsp;</div></li><li><div>                      &lt;?php } ?&gt;&nbsp;</div></li><li><div>                      &lt;?php if ( ! empty( $order-&gt;billing-&gt;street ) ) { ?&gt;&nbsp;</div></li><li><div>                          &lt;?php echo $order-&gt;billing-&gt;street; ?&gt;&lt;br/&gt;&nbsp;</div></li><li><div>                          &lt;?php if ( $order-&gt;billing-&gt;city && $order-&gt;billing-&gt;state ) { ?&gt;&nbsp;</div></li><li><div>                              &lt;?php echo $order-&gt;billing-&gt;city ?&gt;, &lt;?php echo $order-&gt;billing-&gt;state ?&gt;&lt;?php echo $order-&gt;billing-&gt;zip ?&gt;&lt;?php if ( ! empty( $order-&gt;billing-&gt;country ) )&nbsp;</div></li><li><div>                                  echo $order-&gt;billing-&gt;country ?&gt;&lt;br/&gt;&nbsp;</div></li><li><div>                          &lt;?php } ?&gt;&nbsp;</div></li><li><div>                      &lt;?php } ?&gt;&nbsp;</div></li><li><div>                      &lt;?php if ( ! empty( $order-&gt;billing-&gt;phone ) ) {&nbsp;</div></li><li><div>                          echo formatPhone( $order-&gt;billing-&gt;phone );&nbsp;</div></li><li><div>                      } ?&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&lt;?php echo $order-&gt;gateway; ?&gt;&lt;?php if ( $order-&gt;gateway_environment == &quot;test&quot; ) {&nbsp;</div></li><li><div>                          echo &quot;(test)&quot;;&nbsp;</div></li><li><div>                      } ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;?php _e( 'Payment', 'paid-memberships-pro' ); ?&gt;: &lt;?php if ( ! empty( $order-&gt;payment_transaction_id ) ) {&nbsp;</div></li><li><div>                          echo $order-&gt;payment_transaction_id;&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          echo &quot;N/A&quot;;&nbsp;</div></li><li><div>                      } ?&gt;&nbsp;</div></li><li><div>                      &lt;br/&gt;&nbsp;</div></li><li><div>                      &lt;?php _e( 'Subscription', 'paid-memberships-pro' ); ?&gt;&nbsp;</div></li><li><div>                      : &lt;?php if ( ! empty( $order-&gt;subscription_transaction_id ) ) {&nbsp;</div></li><li><div>                          echo $order-&gt;subscription_transaction_id;&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          echo &quot;N/A&quot;;&nbsp;</div></li><li><div>                      } ?&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&lt;?php echo $order-&gt;status; ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;?php echo date_i18n( get_option( 'date_format' ), $order-&gt;timestamp ); ?&gt;&lt;br/&gt;&nbsp;</div></li><li><div>                      &lt;?php echo date_i18n( get_option( 'time_format' ), $order-&gt;timestamp ); ?&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td align=&quot;center&quot;&gt;&nbsp;</div></li><li><div>                      &lt;a href=&quot;admin.php?page=pmpro-orders&order=&lt;?php echo $order-&gt;id; ?&gt;&quot;&gt;&lt;?php _e( 'edit', 'paid-memberships-pro' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td align=&quot;center&quot;&gt;&nbsp;</div></li><li><div>                      &lt;a href=&quot;admin.php?page=pmpro-orders&order=-1&copy=&lt;?php echo $order-&gt;id; ?&gt;&quot;&gt;&lt;?php _e( 'copy', 'paid-memberships-pro' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td align=&quot;center&quot;&gt;&nbsp;</div></li><li><div>                      &lt;a href=&quot;javascript:askfirst('&lt;?php echo str_replace( &quot;'&quot;, &quot;\'&quot;, sprintf( __( &quot;Deleting orders is permanent and can affect active users. Are you sure you want to delete order %s?&quot;, 'paid-memberships-pro' ), str_replace( &quot;'&quot;, &quot;&quot;, $order-&gt;code ) ) ); ?&gt;', 'admin.php?page=pmpro-orders&delete=&lt;?php echo $order-&gt;id; ?&gt;'); void(0);&quot;&gt;&lt;?php _e( 'delete', 'paid-memberships-pro' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td align=&quot;center&quot;&gt;&nbsp;</div></li><li><div>                      &lt;a href=&quot;admin-ajax.php?action=pmpro_orders_print_view&order=&lt;?php echo $order-&gt;id; ?&gt;&quot;&nbsp;</div></li><li><div>                         target=&quot;_blank&quot;&gt;&lt;?php _e( 'print', 'paid-memberships-pro' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td align=&quot;center&quot;&gt;&nbsp;</div></li><li><div>                      &lt;a href=&quot;#TB_inline?width=600&height=200&inlineId=email_invoice&quot; class=&quot;thickbox email_link&quot;&nbsp;</div></li><li><div>                         data-order=&quot;&lt;?php echo $order-&gt;id; ?&gt;&quot;&gt;&lt;?php _e( 'email', 'paid-memberships-pro' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;/tr&gt;&nbsp;</div></li><li><div>              &lt;?php&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! $order_ids ) {&nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>              &lt;tr&gt;&nbsp;</div></li><li><div>                  &lt;td colspan=&quot;9&quot;&gt;&lt;p&gt;&lt;?php _e( 'No orders found.', 'paid-memberships-pro' ); ?&gt;&lt;/p&gt;&lt;/td&gt;&nbsp;</div></li><li><div>              &lt;/tr&gt;&nbsp;</div></li><li><div>              &lt;?php&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>          &lt;/tbody&gt;&nbsp;</div></li><li><div>      &lt;/table&gt;&nbsp;</div></li><li><div>  &lt;/form&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>  <span class="comment">//add normal args</span>&nbsp;</div></li><li><div>  $pagination_url = add_query_arg( $url_params, get_admin_url( null, &quot;/admin.php?page=pmpro-orders&quot; ) );&nbsp;</div></li><li><div>  echo pmpro_getPaginationString( $pn, $totalrows, $limit, 1, $pagination_url, &quot;&limit=$limit&pn=&quot; );&nbsp;</div></li><li><div>  ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php } ?&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>require_once( dirname( __FILE__ ) . &quot;/admin_footer.php&quot; );&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>Paid Memberships Pro</li><li><span></span>1.9</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>