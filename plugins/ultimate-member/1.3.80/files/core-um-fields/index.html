<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="1.3.80" data-slug="ultimate-member" data-type="file" data-id="83886"><head xmlns="http://www.w3.org/1999/xhtml"><title> core-um-fields | file | Ultimate Member | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, ultimate-member, 1.3.80" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=97e128f2df191ffa9383def4168f73c0' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/core-um-fields/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fcore-um-fields%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fcore-um-fields%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-ultimate-member-1.3.80-file-core-um-fields","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="core-um-fields" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to ultimate-member." href="http://hookr.io/plugins/ultimate-member/" class="plugin"><span property="name">ultimate-member</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 1.3.80." href="http://hookr.io/plugins/ultimate-member/1.3.80/" class="H_VERSION"><span property="name">1.3.80</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/ultimate-member/1.3.80/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">core-um-fields</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="1016"><a href="http://hookr.io/plugins/ultimate-member/1.3.80/all/" title="All">All <span class="count badge">1016</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/ultimate-member/1.3.80/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="557"><a href="http://hookr.io/plugins/ultimate-member/1.3.80/hooks/" title="Hooks">Hooks <span class="count badge">557</span></a></li><li class="" data-id="action" data-count="279"><a href="http://hookr.io/plugins/ultimate-member/1.3.80/actions/" title="Actions">Actions <span class="count badge">279</span></a></li><li class="" data-id="filter" data-count="278"><a href="http://hookr.io/plugins/ultimate-member/1.3.80/filters/" title="Filters">Filters <span class="count badge">278</span></a></li><li class="" data-id="class" data-count="162"><a href="http://hookr.io/plugins/ultimate-member/1.3.80/classes/" title="Classes">Classes <span class="count badge">162</span></a></li><li class="" data-id="constant" data-count="6"><a href="http://hookr.io/plugins/ultimate-member/1.3.80/constants/" title="Constants">Constants <span class="count badge">6</span></a></li><li class="" data-id="function" data-count="284"><a href="http://hookr.io/plugins/ultimate-member/1.3.80/functions/" title="Functions">Functions <span class="count badge">284</span></a></li><li class="" data-id="shortcode" data-count="7"><a href="http://hookr.io/plugins/ultimate-member/1.3.80/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">7</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/core/um-fields.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>class UM_Fields {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  function __construct() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;editing = false;&nbsp;</div></li><li><div>      $this-&gt;viewing = false;&nbsp;</div></li><li><div>      $this-&gt;timestamp = current_time('timestamp');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Standard checkbox field</span>&nbsp;</div></li><li><div><span class="comment">   * @param  integer $id   </span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $title</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function checkbox( $id, $title ) {&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;div class=&quot;um-field um-field-c&quot;&gt;&nbsp;</div></li><li><div>          &lt;div class=&quot;um-field-area&quot;&gt;&nbsp;</div></li><li><div>              &lt;label class=&quot;um-field-checkbox active&quot;&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;checkbox&quot; name=&quot;&lt;?php echo $id; ?&gt;&quot; value=&quot;1&quot; checked /&gt;&lt;span class=&quot;um-field-checkbox-state&quot;&gt;&lt;i class=&quot;um-icon-android-checkbox-outline&quot;&gt;&lt;/i&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;span class=&quot;um-field-checkbox-option&quot;&gt; &lt;?php echo $title; ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>              &lt;/label&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Shows social links</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function show_social_urls() {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      $fields = $ultimatemember-&gt;builtin-&gt;all_user_fields;&nbsp;</div></li><li><div>      foreach( $fields as $field =&gt; $args ) {&nbsp;</div></li><li><div>          if ( isset( $args['advanced'] ) && $args['advanced'] == 'social' ) {&nbsp;</div></li><li><div>              $social[$field] = $args;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      foreach( $social as $k =&gt; $arr ) {&nbsp;</div></li><li><div>          if ( um_profile( $k ) ) { ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;a href=&quot;&lt;?php echo um_filtered_social_link( $k , $arr['match'] ); ?&gt;&quot; style=&quot;background: &lt;?php echo $arr['color']; ?&gt;;&quot; target=&quot;_blank&quot; class=&quot;um-tip-n&quot; title=&quot;&lt;?php echo $arr['title']; ?&gt;&quot;&gt;&lt;i class=&quot;&lt;?php echo $arr['icon']; ?&gt;&quot;&gt;&lt;/i&gt;&lt;/a&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Hidden field insaide a shortcode</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $field </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function add_hidden_field( $field ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      echo '&lt;div style=&quot;display: none !important;&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $fields = $ultimatemember-&gt;builtin-&gt;get_specific_fields( $field );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $output = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach( $fields as $key =&gt; $data ) {&nbsp;</div></li><li><div>              $output .= $ultimatemember-&gt;fields-&gt;edit_field( $key, $data );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo $output;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo '&lt;/div&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get hidden field</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $key  </span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $value</span>&nbsp;</div></li><li><div><span class="comment">   * @return string      </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function disabled_hidden_field( $key, $value ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return '&lt;input type=&quot;hidden&quot; name=&quot;'.$key.'&quot; value=&quot;'.esc_attr( $value ).'&quot;/&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Updates a field globally</span>&nbsp;</div></li><li><div><span class="comment">   * @param  integer $id  </span>&nbsp;</div></li><li><div><span class="comment">   * @param  array $args</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function globally_update_field( $id, $args ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      $fields = $ultimatemember-&gt;builtin-&gt;saved_fields;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $fields[$id] = $args;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      unset( $fields[ $id ]['in_row'] );&nbsp;</div></li><li><div>      unset( $fields[ $id ]['in_sub_row'] );&nbsp;</div></li><li><div>      unset( $fields[ $id ]['in_column'] );&nbsp;</div></li><li><div>      unset( $fields[ $id ]['in_group'] );&nbsp;</div></li><li><div>      unset( $fields[ $id ]['position'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      update_option('um_fields', $fields );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Updates a field in form only</span>&nbsp;</div></li><li><div><span class="comment">   * @param  integer $id     </span>&nbsp;</div></li><li><div><span class="comment">   * @param  array $args   </span>&nbsp;</div></li><li><div><span class="comment">   * @param  integer $form_id</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function update_field($id, $args, $form_id) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      $fields = $ultimatemember-&gt;query-&gt;get_attr( 'custom_fields', $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $args['type'] == 'row' ) {&nbsp;</div></li><li><div>          if ( isset( $fields[$id] ) ) {&nbsp;</div></li><li><div>              $old_args = $fields[$id];&nbsp;</div></li><li><div>              foreach( $old_args as $k =&gt; $v ) {&nbsp;</div></li><li><div>                  if (!in_array($k, array('sub_rows', 'cols')) ) {&nbsp;</div></li><li><div>                      unset($old_args[$k]);&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $args = array_merge( $old_args, $args );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// custom fields support</span>&nbsp;</div></li><li><div>      if ( isset( $ultimatemember-&gt;builtin-&gt;predefined_fields[$id] ) && isset( $ultimatemember-&gt;builtin-&gt;predefined_fields[$id]['custom'] ) ) {&nbsp;</div></li><li><div>          $args = array_merge( $ultimatemember-&gt;builtin-&gt;predefined_fields[$id], $args);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $fields[$id] = $args;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// for group field only</span>&nbsp;</div></li><li><div>      if ( $args['type'] == 'group' ) {&nbsp;</div></li><li><div>          $fields[$id]['in_group'] = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $ultimatemember-&gt;query-&gt;update_attr( 'custom_fields', $form_id, $fields );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Deletes a field in form only</span>&nbsp;</div></li><li><div><span class="comment">   * @param  integer $id      </span>&nbsp;</div></li><li><div><span class="comment">   * @param  integer $form_id </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function delete_field_from_form( $id, $form_id ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      $fields = $ultimatemember-&gt;query-&gt;get_attr( 'custom_fields', $form_id );&nbsp;</div></li><li><div>      if ( isset( $fields[ $id ] ) ) {&nbsp;</div></li><li><div>          unset( $fields[ $id ] );&nbsp;</div></li><li><div>          $ultimatemember-&gt;query-&gt;update_attr( 'custom_fields', $form_id, $fields );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Deletes a field from custom fields</span>&nbsp;</div></li><li><div><span class="comment">   * @param  integer $id </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function delete_field_from_db( $id ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      $fields = $ultimatemember-&gt;builtin-&gt;saved_fields;&nbsp;</div></li><li><div>      if ( isset( $fields[$id] ) ) {&nbsp;</div></li><li><div>          unset( $fields[$id] );&nbsp;</div></li><li><div>          update_option('um_fields', $fields );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Quickly adds a field from custom fields</span>&nbsp;</div></li><li><div><span class="comment">   * @param integer $global_id </span>&nbsp;</div></li><li><div><span class="comment">   * @param integer $form_id   </span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $position  </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function add_field_from_list( $global_id, $form_id, $position = array() ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      $fields = $ultimatemember-&gt;query-&gt;get_attr( 'custom_fields', $form_id );&nbsp;</div></li><li><div>      $field_scope = $ultimatemember-&gt;builtin-&gt;saved_fields;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !isset( $fields[$global_id] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $count = 1;&nbsp;</div></li><li><div>          if ( isset( $fields ) && !empty( $fields) ) $count = count($fields)+1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $fields[$global_id] = $field_scope[$global_id];&nbsp;</div></li><li><div>          $fields[$global_id]['position'] = $count;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">// set position</span></span>&nbsp;</div></li><li><div>          if ( $position ) {&nbsp;</div></li><li><div>              foreach( $position as $key =&gt; $val ) {&nbsp;</div></li><li><div>                  $fields[$global_id][$key] = $val;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">// add field to form</span></span>&nbsp;</div></li><li><div>          $ultimatemember-&gt;query-&gt;update_attr( 'custom_fields', $form_id, $fields );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Quickly adds a field from pre-defined fields</span>&nbsp;</div></li><li><div><span class="comment">   * @param integer $global_id </span>&nbsp;</div></li><li><div><span class="comment">   * @param integer $form_id   </span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $position  </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function add_field_from_predefined( $global_id, $form_id, $position = array() ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $fields = $ultimatemember-&gt;query-&gt;get_attr( 'custom_fields', $form_id );&nbsp;</div></li><li><div>      $field_scope = $ultimatemember-&gt;builtin-&gt;predefined_fields;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !isset( $fields[$global_id] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $count = 1;&nbsp;</div></li><li><div>          if ( isset( $fields ) && !empty( $fields) ) $count = count($fields)+1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $fields[$global_id] = $field_scope[$global_id];&nbsp;</div></li><li><div>          $fields[$global_id]['position'] = $count;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">// set position</span></span>&nbsp;</div></li><li><div>          if ( $position ) {&nbsp;</div></li><li><div>              foreach( $position as $key =&gt; $val ) {&nbsp;</div></li><li><div>                  $fields[$global_id][$key] = $val;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">// add field to form</span></span>&nbsp;</div></li><li><div>          $ultimatemember-&gt;query-&gt;update_attr( 'custom_fields', $form_id, $fields );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// add field to db</span>&nbsp;</div></li><li><div>          <span class="comment">//$this-&gt;globally_update_field( $global_id, $fields[$global_id] );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Duplicates a frield by meta key</span>&nbsp;</div></li><li><div><span class="comment">   * @param  integer $id      </span>&nbsp;</div></li><li><div><span class="comment">   * @param  integer $form_id </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function duplicate_field( $id, $form_id ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      $fields = $ultimatemember-&gt;query-&gt;get_attr( 'custom_fields', $form_id );&nbsp;</div></li><li><div>      $all_fields = $ultimatemember-&gt;builtin-&gt;saved_fields;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $inc = count( $fields ) + 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $duplicate = $fields[ $id ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $new_metakey = $id . &quot;_&quot; . $inc;&nbsp;</div></li><li><div>      $new_title = $fields[ $id ]['title'] . &quot; #&quot; . $inc;&nbsp;</div></li><li><div>      $new_position = $inc;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $duplicate['title'] = $new_title;&nbsp;</div></li><li><div>      $duplicate['metakey'] = $new_metakey;&nbsp;</div></li><li><div>      $duplicate['position'] = $new_position;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $fields[ $new_metakey ] = $duplicate;&nbsp;</div></li><li><div>      $all_fields[ $new_metakey ] = $duplicate;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// not global attributes</span>&nbsp;</div></li><li><div>      unset( $all_fields[ $new_metakey ]['in_row'] );&nbsp;</div></li><li><div>      unset( $all_fields[ $new_metakey ]['in_sub_row'] );&nbsp;</div></li><li><div>      unset( $all_fields[ $new_metakey ]['in_column'] );&nbsp;</div></li><li><div>      unset( $all_fields[ $new_metakey ]['in_group'] );&nbsp;</div></li><li><div>      unset( $all_fields[ $new_metakey ]['position'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $ultimatemember-&gt;query-&gt;update_attr( 'custom_fields', $form_id, $fields );&nbsp;</div></li><li><div>      update_option('um_fields', $all_fields );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   *  Print field error</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $text       </span>&nbsp;</div></li><li><div><span class="comment">   * @param  boolean $force_show </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function field_error($text, $force_show = false ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      if ( $force_show ) {&nbsp;</div></li><li><div>          $output = '&lt;div class=&quot;um-field-error&quot;&gt;&lt;span class=&quot;um-field-arrow&quot;&gt;&lt;i class=&quot;um-faicon-caret-up&quot;&gt;&lt;/i&gt;&lt;/span&gt;'.$text.'&lt;/div&gt;';&nbsp;</div></li><li><div>          return $output;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if ( isset( $this-&gt;set_id ) && $ultimatemember-&gt;form-&gt;processing == $this-&gt;set_id ) {&nbsp;</div></li><li><div>          $output = '&lt;div class=&quot;um-field-error&quot;&gt;&lt;span class=&quot;um-field-arrow&quot;&gt;&lt;i class=&quot;um-faicon-caret-up&quot;&gt;&lt;/i&gt;&lt;/span&gt;'.$text.'&lt;/div&gt;';&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $output = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !$ultimatemember-&gt;form-&gt;processing ) {&nbsp;</div></li><li><div>          $output = '&lt;div class=&quot;um-field-error&quot;&gt;&lt;span class=&quot;um-field-arrow&quot;&gt;&lt;i class=&quot;um-faicon-caret-up&quot;&gt;&lt;/i&gt;&lt;/span&gt;'.$text.'&lt;/div&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return $output;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Checks if field has a server-side error</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $key </span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean      </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function is_error($key) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      return $ultimatemember-&gt;form-&gt;has_error($key);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns field error</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $key </span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function show_error($key) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      return $ultimatemember-&gt;form-&gt;errors[$key];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   *  Display field label</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $label </span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $key   </span>&nbsp;</div></li><li><div><span class="comment">   * @param  data $data  </span>&nbsp;</div></li><li><div><span class="comment">   * @return  string    </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function field_label( $label, $key, $data ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      $output = null;&nbsp;</div></li><li><div>      $output .= '&lt;div class=&quot;um-field-label&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset($data['icon']) && $data['icon'] != '' && isset( $this-&gt;field_icons ) && $this-&gt;field_icons != 'off' && ( $this-&gt;field_icons == 'label' || $this-&gt;viewing == true ) ) {&nbsp;</div></li><li><div>          $output .= '&lt;div class=&quot;um-field-label-icon&quot;&gt;&lt;i class=&quot;'.$data['icon'].'&quot;&gt;&lt;/i&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;viewing == true ) {&nbsp;</div></li><li><div>          $label = apply_filters(&quot;um_view_label_{$key}&quot;, $label );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $label = apply_filters(&quot;um_edit_label_{$key}&quot;, $label );&nbsp;</div></li><li><div>          $label = apply_filters(&quot;um_edit_label_all_fields&quot;, $label, $data );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $output .= '&lt;label for=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot;&gt;'.__( $label, UM_TEXTDOMAIN ).'&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $data['help'] ) && !empty( $data['help'] ) && $this-&gt;viewing == false && !strstr($key, 'confirm_user_pass') ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( !$ultimatemember-&gt;mobile-&gt;isMobile() ) {&nbsp;</div></li><li><div>              if ( !isset( $this-&gt;disable_tooltips ) ) {&nbsp;</div></li><li><div>                  $output .= '&lt;span class=&quot;um-tip um-tip-w&quot; title=&quot;'.__( $data['help'], UM_TEXTDOMAIN ).'&quot;&gt;&lt;i class=&quot;um-icon-help-circled&quot;&gt;&lt;/i&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $ultimatemember-&gt;mobile-&gt;isMobile() || isset( $this-&gt;disable_tooltips ) ) {&nbsp;</div></li><li><div>              $output .= '&lt;span class=&quot;um-tip-text&quot;&gt;'.__( $data['help'], UM_TEXTDOMAIN ). '&lt;/span&gt;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $output .= '&lt;div class=&quot;um-clear&quot;&gt;&lt;/div&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $output;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Output field classes</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $key  </span>&nbsp;</div></li><li><div><span class="comment">   * @param  array $data </span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $add  </span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function get_class($key, $data, $add = null) {&nbsp;</div></li><li><div>      $classes = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $classes .= 'um-form-field ';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>          $classes .= 'um-error ';&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $classes .= 'valid ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !isset($data['required']) ) {&nbsp;</div></li><li><div>          $classes .= 'not-required ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $data['type'] == 'date' ) {&nbsp;</div></li><li><div>          $classes .= 'um-datepicker ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $data['type'] == 'time' ) {&nbsp;</div></li><li><div>          $classes .= 'um-timepicker ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset($data['icon']) && $data['icon'] && isset( $this-&gt;field_icons ) && $this-&gt;field_icons == 'field' ) {&nbsp;</div></li><li><div>          $classes .= 'um-iconed ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ($add) {&nbsp;</div></li><li><div>          $classes .= $add . ' ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $classes;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Gets field value</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $key     </span>&nbsp;</div></li><li><div><span class="comment">   * @param  boolean $default </span>&nbsp;</div></li><li><div><span class="comment">   * @param  array $data    </span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function field_value( $key, $default = false, $data = null ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>       &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $_SESSION ) && isset( $_SESSION['um_social_profile'][ $key ] ) && isset( $this-&gt;set_mode ) && $this-&gt;set_mode == 'register' )&nbsp;</div></li><li><div>          return $_SESSION['um_social_profile'][ $key ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $type = ( isset( $data['type'] ) ) ? $data['type'] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// preview in backend</span>&nbsp;</div></li><li><div>      if ( isset( $ultimatemember-&gt;user-&gt;preview ) && $ultimatemember-&gt;user-&gt;preview ) {&nbsp;</div></li><li><div>          $submitted = um_user('submitted');&nbsp;</div></li><li><div>          if ( isset( $submitted[ $key ] ) && ! empty( $submitted[ $key ] ) ) {&nbsp;</div></li><li><div>              return $submitted[ $key ];&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              return 'Undefined';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// normal state</span>&nbsp;</div></li><li><div>      if ( isset( $ultimatemember-&gt;form-&gt;post_form[ $key ] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( strstr( $key, 'user_pass' ) && $this-&gt;set_mode != 'password' ) return '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $ultimatemember-&gt;form-&gt;post_form[ $key ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      } else if ( um_user( $key ) && $this-&gt;editing == true ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( strstr( $key, 'user_pass' ) ) return '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return apply_filters( &quot;um_edit_{$key}_field_value&quot;, um_user( $key ), $key );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      } else if ( ( um_user( $key ) || isset( $data['show_anyway'] ) ) && $this-&gt;viewing == true ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $value = um_filtered_value( $key, $data );&nbsp;</div></li><li><div>          return $value;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      } else if ( $default ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $default = apply_filters( &quot;um_field_default_value&quot;, $default, $data, $type );&nbsp;</div></li><li><div>          $default = apply_filters( &quot;um_field_{$key}_default_value&quot;, $default, $data );&nbsp;</div></li><li><div>          $default = apply_filters( &quot;um_field_{$type}_default_value&quot;, $default, $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $default;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      } else if ( $this-&gt;editing == true ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return apply_filters( &quot;um_edit_{$key}_field_value&quot;, '', $key);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Checks if an option is selected</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $key   </span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $value </span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $data  </span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean        </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function is_selected($key, $value, $data) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $key = apply_filters('um_is_selected_filter_key', $key );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $ultimatemember-&gt;form-&gt;post_form[ $key ] ) && is_array( $ultimatemember-&gt;form-&gt;post_form[ $key ] ) ) {&nbsp;</div></li><li><div>         &nbsp;</div></li><li><div>          if ( in_array( $value, $ultimatemember-&gt;form-&gt;post_form[ $key ] ) ) {&nbsp;</div></li><li><div>              return true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( in_array( html_entity_decode( $value ), $ultimatemember-&gt;form-&gt;post_form[ $key ] ) ) {&nbsp;</div></li><li><div>              return true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( !isset( $ultimatemember-&gt;form-&gt;post_form ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $field_value = um_user( $key );&nbsp;</div></li><li><div>              $field_value = apply_filters('um_is_selected_filter_value', $field_value, $key );&nbsp;</div></li><li><div>                     $data = apply_filters('um_is_selected_filter_data', $data, $key, $field_value );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $field_value && $this-&gt;editing == true && is_array( $field_value ) && ( in_array( $value, $field_value ) || in_array( html_entity_decode( $value ), $field_value ) ) ) {&nbsp;</div></li><li><div>                  return true;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $field_value && $this-&gt;editing == true && !is_array( $field_value ) && $field_value == $value ) {&nbsp;</div></li><li><div>                  return true;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $field_value && $this-&gt;editing == true && !is_array( $field_value ) && html_entity_decode( $field_value ) == html_entity_decode( $value ) ) {&nbsp;</div></li><li><div>                  return true;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( strstr( $data['default'], ', ') ) {&nbsp;</div></li><li><div>                  $data['default'] = explode(', ', $data['default']);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset( $data['default'] ) && !is_array( $data['default'] ) && $data['default'] == $value ) {&nbsp;</div></li><li><div>                  return true;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset( $data['default'] ) && is_array( $data['default'] ) && in_array( $value, $data['default'] ) ) {&nbsp;</div></li><li><div>                  return true;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset( $ultimatemember-&gt;form-&gt;post_form[ $key ] ) && $value == $ultimatemember-&gt;form-&gt;post_form[ $key ] ) {&nbsp;</div></li><li><div>                  return true;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Checks if a radio button is selected</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $key   </span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $value </span>&nbsp;</div></li><li><div><span class="comment">   * @param  array $data  </span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean        </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function is_radio_checked($key, $value, $data) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $ultimatemember-&gt;form-&gt;post_form[$key] ) && is_array( $ultimatemember-&gt;form-&gt;post_form[$key] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( in_array( $value, $ultimatemember-&gt;form-&gt;post_form[$key] ) ) {&nbsp;</div></li><li><div>              return true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( !isset( $ultimatemember-&gt;form-&gt;post_form ) ) {&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if ( um_user( $key ) && $this-&gt;editing == true ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( strstr($key, 'role_') ) {&nbsp;</div></li><li><div>                      $key = 'role';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $um_user_value = um_user( $key );&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if( $key == 'role' ) {&nbsp;</div></li><li><div>                      $um_user_value = strtolower( $um_user_value );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $um_user_value == $value ) {&nbsp;</div></li><li><div>                      return true;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( is_array( $um_user_value ) && in_array( $value, $um_user_value ) ) {&nbsp;</div></li><li><div>                      return true;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( is_array( $um_user_value ) ) {&nbsp;</div></li><li><div>                      foreach( $um_user_value as $u) {&nbsp;</div></li><li><div>                          if( $u == html_entity_decode( $value ) ) {&nbsp;</div></li><li><div>                              return true;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset($data['default']) && $data['default'] == $value ) {&nbsp;</div></li><li><div>                      return true;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset( $ultimatemember-&gt;form-&gt;post_form[$key] ) && $value == $ultimatemember-&gt;form-&gt;post_form[$key] ) {&nbsp;</div></li><li><div>                  return true;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get field icon</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $key </span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function get_field_icon( $key ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      $fields = $ultimatemember-&gt;builtin-&gt;all_user_fields;&nbsp;</div></li><li><div>      if ( isset( $fields[$key]['icon'] ) )&nbsp;</div></li><li><div>          return $fields[$key]['icon'];&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Gets selected option value from a callback function</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $value </span>&nbsp;</div></li><li><div><span class="comment">   * @param  array $data  </span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $type  </span>&nbsp;</div></li><li><div><span class="comment">   * @return json</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function get_option_value_from_callback( $value, $data, $type ) {&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if( in_array( $type , array('select', 'multiselect') ) && isset( $data['custom_dropdown_options_source'] ) && ! empty( $data['custom_dropdown_options_source'] ) ) {&nbsp;</div></li><li><div>           &nbsp;</div></li><li><div>           if( function_exists( $data['custom_dropdown_options_source'] ) ) {&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              $arr_options = call_user_func( $data['custom_dropdown_options_source'] );&nbsp;</div></li><li><div>             &nbsp;</div></li><li><div>              if( $type == 'select' ) {&nbsp;</div></li><li><div>                  if( isset( $arr_options[ $value ] ) && ! empty( $arr_options[ $value ] ) ) {&nbsp;</div></li><li><div>                     return $arr_options[ $value ];&nbsp;</div></li><li><div>                  }else if( isset( $data['default'] ) && ! empty( $data['default'] ) && empty( $arr_options[ $value ] ) ) {&nbsp;</div></li><li><div>                      return $arr_options[ $data['default'] ];&nbsp;</div></li><li><div>                  }else{&nbsp;</div></li><li><div>                      return '';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if( $type == 'multiselect' ) {&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if( is_array( $value ) ) {&nbsp;</div></li><li><div>                      $values = $value;&nbsp;</div></li><li><div>                  }else{&nbsp;</div></li><li><div>                      $values = explode(', ', $value );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $arr_paired_options = array();&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  foreach ( $values as $option ) {&nbsp;</div></li><li><div>                      if( isset( $arr_options[ $option ] ) ) {&nbsp;</div></li><li><div>                         $arr_paired_options[] = $arr_options[ $option ];&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  return implode( ', ' , $arr_paired_options );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>           }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $value;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get select options from a callback function</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array $data </span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $type </span>&nbsp;</div></li><li><div><span class="comment">   * @return array $arr_options</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function get_options_from_callback( $data, $type ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if( in_array( $type , array('select', 'multiselect') ) && isset( $data['custom_dropdown_options_source'] ) && ! empty( $data['custom_dropdown_options_source'] ) ) {&nbsp;</div></li><li><div>           &nbsp;</div></li><li><div>          if( function_exists( $data['custom_dropdown_options_source'] ) ) {&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              $arr_options = call_user_func( $data['custom_dropdown_options_source'] );&nbsp;</div></li><li><div>               &nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $arr_options;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get field type</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $key </span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function get_field_type( $key ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      $fields = $ultimatemember-&gt;builtin-&gt;all_user_fields;&nbsp;</div></li><li><div>      if ( isset( $fields[$key]['type'] ) )&nbsp;</div></li><li><div>          return $fields[$key]['type'];&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get field label</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $key </span>&nbsp;</div></li><li><div><span class="comment">   * @return string      </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function get_label( $key ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      $fields = $ultimatemember-&gt;builtin-&gt;all_user_fields;&nbsp;</div></li><li><div>      if ( isset( $fields[$key]['label'] ) )&nbsp;</div></li><li><div>          return $fields[$key]['label'];&nbsp;</div></li><li><div>      if ( isset( $fields[$key]['title'] ) )&nbsp;</div></li><li><div>          return $fields[$key]['title'];&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get field title</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $key </span>&nbsp;</div></li><li><div><span class="comment">   * @return string     </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function get_field_title( $key ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      $fields = $ultimatemember-&gt;builtin-&gt;all_user_fields;&nbsp;</div></li><li><div>      if ( isset( $fields[$key]['title'] ) )&nbsp;</div></li><li><div>          return $fields[$key]['title'];&nbsp;</div></li><li><div>      if ( isset( $fields[$key]['label'] ) )&nbsp;</div></li><li><div>          return $fields[$key]['label'];&nbsp;</div></li><li><div>      return __('Custom Field', 'ultimatemember');&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get form fields</span>&nbsp;</div></li><li><div><span class="comment">   * @return array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function get_fields() {&nbsp;</div></li><li><div>      $this-&gt;fields = array();&nbsp;</div></li><li><div>      $this-&gt;fields = apply_filters(&quot;um_get_form_fields&quot;, $this-&gt;fields );&nbsp;</div></li><li><div>      return $this-&gt;fields;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get specific field</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $key </span>&nbsp;</div></li><li><div><span class="comment">   * @return array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function get_field( $key ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $fields = $this-&gt;get_fields();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $fields ) && is_array( $fields ) && isset( $fields[$key] ) ) {&nbsp;</div></li><li><div>          $array = $fields[$key];&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          if ( !isset( $ultimatemember-&gt;builtin-&gt;predefined_fields[$key] ) && !isset( $ultimatemember-&gt;builtin-&gt;all_user_fields[$key] ) ) {&nbsp;</div></li><li><div>              return '';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $array = (isset( $ultimatemember-&gt;builtin-&gt;predefined_fields[$key] ) ) ? $ultimatemember-&gt;builtin-&gt;predefined_fields[$key] :  $ultimatemember-&gt;builtin-&gt;all_user_fields[$key];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $array['classes'] = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if (!isset($array['placeholder'])) $array['placeholder'] = null;&nbsp;</div></li><li><div>      if (!isset($array['required'])) $array['required'] = null;&nbsp;</div></li><li><div>      if (!isset($array['validate'])) $array['validate'] = null;&nbsp;</div></li><li><div>      if (!isset($array['default'])) $array['default'] = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $array['conditions'] ) && is_array( $array['conditions'] ) && !$this-&gt;viewing ) {&nbsp;</div></li><li><div>          $array['conditional'] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach( $array['conditions'] as $cond_id =&gt; $cond ) {&nbsp;</div></li><li><div>              $array['conditional'] .= ' data-cond-'.$cond_id.'-action=&quot;'. $cond[0] . '&quot; data-cond-'.$cond_id.'-field=&quot;'. $cond[1] . '&quot; data-cond-'.$cond_id.'-operator=&quot;'. $cond[2] . '&quot; data-cond-'.$cond_id.'-value=&quot;'. $cond[3] . '&quot;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $array['classes'] .= ' um-is-conditional';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $array['conditional'] = null;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $array['classes'] .= ' um-field-' . $key;&nbsp;</div></li><li><div>      $array['classes'] .= ' um-field-' . $array['type'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      switch( $array['type'] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'googlemap':&nbsp;</div></li><li><div>          case 'youtube_video':&nbsp;</div></li><li><div>          case 'vimeo_video':&nbsp;</div></li><li><div>          case 'soundcloud_track':&nbsp;</div></li><li><div>              $array['disabled'] = '';&nbsp;</div></li><li><div>              $array['input'] = 'text';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'text':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $array['disabled'] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $key == 'user_login' && isset(  $this-&gt;set_mode ) && $this-&gt;set_mode == 'account' ) {&nbsp;</div></li><li><div>                  $array['disabled'] = 'disabled=&quot;disabled&quot;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $array['input'] = 'text';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'password':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $array['input'] = 'password';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'number':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $array['disabled'] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'url':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $array['input'] = 'text';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'date':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $array['input'] = 'text';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !isset( $array['format'] ) ) $array['format'] = 'j M Y';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              switch( $array['format'] ) {&nbsp;</div></li><li><div>                  case 'j M Y':&nbsp;</div></li><li><div>                      $js_format = 'd mmm yyyy';&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case 'j F Y':&nbsp;</div></li><li><div>                      $js_format = 'd mmmm yyyy';&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case 'M j Y':&nbsp;</div></li><li><div>                      $js_format = 'mmm d yyyy';&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case 'F j Y':&nbsp;</div></li><li><div>                      $js_format = 'mmmm d yyyy';&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $array['js_format'] = $js_format;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !isset( $array['range'] ) ) $array['range'] = 'years';&nbsp;</div></li><li><div>              if ( !isset( $array['years'] ) ) $array['years'] = 100;&nbsp;</div></li><li><div>              if ( !isset( $array['years_x'] ) ) $array['years_x'] = 'past';&nbsp;</div></li><li><div>              if ( !isset( $array['disabled_weekdays'] ) ) $array['disabled_weekdays'] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !empty( $array['disabled_weekdays'] ) ) {&nbsp;</div></li><li><div>                  $array['disabled_weekdays'] = '[' . implode(', ', $array['disabled_weekdays']) . ']';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// When date range is strictly defined</span>&nbsp;</div></li><li><div>              if ( $array['range'] == 'date_range' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $array['date_min'] = str_replace('/', ', ', $array['range_start']);&nbsp;</div></li><li><div>                  $array['date_max'] = str_replace('/', ', ', $array['range_end']);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $array['years_x'] == 'past' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $date = new DateTime( date('Y-n-d') );&nbsp;</div></li><li><div>                      $past = $date-&gt;modify('-'.$array['years'].' years');&nbsp;</div></li><li><div>                      $past = $date-&gt;format('Y, n, d');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $array['date_min'] = $past;&nbsp;</div></li><li><div>                      $array['date_max'] = date('Y, n, d');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  } else if ( $array['years_x'] == 'future' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $date = new DateTime( date('Y-n-d') );&nbsp;</div></li><li><div>                      $future = $date-&gt;modify('+'.$array['years'].' years');&nbsp;</div></li><li><div>                      $future = $date-&gt;format('Y, n, d');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $array['date_min'] = date('Y, n, d');&nbsp;</div></li><li><div>                      $array['date_max'] = $future;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $date = new DateTime( date('Y-n-d') );&nbsp;</div></li><li><div>                      $date_f = new DateTime( date('Y-n-d') );&nbsp;</div></li><li><div>                      $past = $date-&gt;modify('-'. ( $array['years'] / 2 ).' years');&nbsp;</div></li><li><div>                      $past = $date-&gt;format('Y, n, d');&nbsp;</div></li><li><div>                      $future = $date_f-&gt;modify('+'. ( $array['years'] / 2 ).' years');&nbsp;</div></li><li><div>                      $future = $date_f-&gt;format('Y, n, d');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $array['date_min'] = $past;&nbsp;</div></li><li><div>                      $array['date_max'] = $future;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'time':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $array['input'] = 'text';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !isset( $array['format'] ) ) $array['format'] = 'g:i a';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              switch( $array['format'] ) {&nbsp;</div></li><li><div>                  case 'g:i a':&nbsp;</div></li><li><div>                      $js_format = 'h:i a';&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case 'g:i A':&nbsp;</div></li><li><div>                      $js_format = 'h:i A';&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                  case 'H:i':&nbsp;</div></li><li><div>                      $js_format = 'HH:i';&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $array['js_format'] = $js_format;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !isset( $array['intervals'] ) ) $array['intervals'] = 60;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'textarea':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if (!isset($array['height'])) $array['height'] = '100px';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'rating':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if (!isset($array['number'])) $array['number'] = 5;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'spacing':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !isset($array['spacing'])) {&nbsp;</div></li><li><div>                  $array['spacing'] = '20px';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'divider':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if (isset($array['width'])) {&nbsp;</div></li><li><div>                  $array['borderwidth'] = $array['width'];&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $array['borderwidth'] = 4;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if (isset($array['color'])) {&nbsp;</div></li><li><div>                  $array['bordercolor'] = $array['color'];&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $array['bordercolor'] = '#eee';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if (isset($array['style'])) {&nbsp;</div></li><li><div>                  $array['borderstyle'] = $array['style'];&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $array['borderstyle'] = 'solid';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !isset( $array['divider_text'] ) ) {&nbsp;</div></li><li><div>                  $array['divider_text'] = '';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'image':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !isset( $array['crop'] ) ) $array['crop'] = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $array['crop'] == 0 ) {&nbsp;</div></li><li><div>                  $array['crop_data'] = 0;&nbsp;</div></li><li><div>              } else if ( $array['crop'] == 1 ) {&nbsp;</div></li><li><div>                  $array['crop_data'] = 'square';&nbsp;</div></li><li><div>              } else if ( $array['crop'] == 2 ) {&nbsp;</div></li><li><div>                  $array['crop_data'] = 'cover';&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $array['crop_data'] = 'user';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !isset( $array['modal_size'] ) ) $array['modal_size'] = 'normal';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $array['crop'] &gt; 0 ) {&nbsp;</div></li><li><div>                  $array['crop_class'] = 'crop';&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $array['crop_class'] = '';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !isset( $array['ratio'] ) ) $array['ratio'] = 1.0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !isset( $array['min_width'] ) ) $array['min_width'] = '';&nbsp;</div></li><li><div>              if ( !isset( $array['min_height'] ) ) $array['min_height'] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $array['min_width'] == '' && $array['crop'] == 1 ) $array['min_width'] = 600;&nbsp;</div></li><li><div>              if ( $array['min_height'] == '' && $array['crop'] == 1 ) $array['min_height'] = 600;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $array['min_width'] == '' && $array['crop'] == 3 ) $array['min_width'] = 600;&nbsp;</div></li><li><div>              if ( $array['min_height'] == '' && $array['crop'] == 3 ) $array['min_height'] = 600;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if (!isset($array['invalid_image'])) $array['invalid_image'] = __(&quot;Please upload a valid image!&quot;, 'ultimatemember');&nbsp;</div></li><li><div>              if (!isset($array['allowed_types'])) {&nbsp;</div></li><li><div>                  $array['allowed_types'] = &quot;gif, jpg, jpeg, png&quot;;&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $array['allowed_types'] = implode(', ', $array['allowed_types']);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if (!isset($array['upload_text'])) $array['upload_text'] = '';&nbsp;</div></li><li><div>              if (!isset($array['button_text'])) $array['button_text'] = __('Upload', 'ultimatemember');&nbsp;</div></li><li><div>              if (!isset($array['extension_error'])) $array['extension_error'] =  __(&quot;Sorry this is not a valid image.&quot;, 'ultimatemember');&nbsp;</div></li><li><div>              if (!isset($array['max_size_error'])) $array['max_size_error'] = __(&quot;This image is too large!&quot;, 'ultimatemember');&nbsp;</div></li><li><div>              if (!isset($array['min_size_error'])) $array['min_size_error'] = __(&quot;This image is too small!&quot;, 'ultimatemember');&nbsp;</div></li><li><div>              if (!isset($array['max_files_error'])) $array['max_files_error'] = __(&quot;You can only upload one image&quot;, 'ultimatemember');&nbsp;</div></li><li><div>              if (!isset($array['max_size'])) $array['max_size'] = 999999999;&nbsp;</div></li><li><div>              if (!isset($array['upload_help_text'])) $array['upload_help_text'] = '';&nbsp;</div></li><li><div>              if (!isset($array['icon']) ) $array['icon'] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'file':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !isset( $array['modal_size'] ) ) $array['modal_size'] = 'normal';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if (!isset($array['allowed_types'])) {&nbsp;</div></li><li><div>                  $array['allowed_types'] = &quot;pdf, txt&quot;;&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $array['allowed_types'] = implode(', ', $array['allowed_types']);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if (!isset($array['upload_text'])) $array['upload_text'] = '';&nbsp;</div></li><li><div>              if (!isset($array['button_text'])) $array['button_text'] = __('Upload', 'ultimatemember');&nbsp;</div></li><li><div>              if (!isset($array['extension_error'])) $array['extension_error'] =  &quot;Sorry this is not a valid file.&quot;;&nbsp;</div></li><li><div>              if (!isset($array['max_size_error'])) $array['max_size_error'] = &quot;This file is too large!&quot;;&nbsp;</div></li><li><div>              if (!isset($array['min_size_error'])) $array['min_size_error'] = &quot;This file is too small!&quot;;&nbsp;</div></li><li><div>              if (!isset($array['max_files_error'])) $array['max_files_error'] = &quot;You can only upload one file&quot;;&nbsp;</div></li><li><div>              if (!isset($array['max_size'])) $array['max_size'] = 999999999;&nbsp;</div></li><li><div>              if (!isset($array['upload_help_text'])) $array['upload_help_text'] = '';&nbsp;</div></li><li><div>              if (!isset($array['icon']) ) $array['icon'] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'select':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'multiselect':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'group':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( !isset( $array['max_entries'] ) ) $array['max_entries'] = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !isset( $array['visibility'] ) ) $array['visibility'] = 'all';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $array = apply_filters(&quot;um_get_field__{$key}&quot;, $array );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $array;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Gets a field in 'input mode'</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $key  </span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $data </span>&nbsp;</div></li><li><div><span class="comment">   * @param  boolean $rule </span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function edit_field( $key, $data, $rule=false ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $output = null;&nbsp;</div></li><li><div>      $disabled = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// get whole field data</span></span>&nbsp;</div></li><li><div>      if ( isset( $data ) && is_array( $data ) ) {&nbsp;</div></li><li><div>          $data = $this-&gt;get_field($key);&nbsp;</div></li><li><div>          if( is_array( $data ) ) {&nbsp;</div></li><li><div>              extract($data);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !isset( $data['type'] ) ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $data['in_group'] ) && $data['in_group'] != '' && $rule != 'group' ) return;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if ( $visibility == 'view' && $this-&gt;set_mode != 'register' ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ( $visibility == 'view' && $this-&gt;set_mode == 'register' ) || &nbsp;</div></li><li><div>          ( isset( $data['editable'] ) && $data['editable'] == 0 && $this-&gt;set_mode == 'profile' ) ) {&nbsp;</div></li><li><div>          $disabled = ' disabled=&quot;disabled&quot; ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if( ! isset( $data['autocomplete'] ) ) {&nbsp;</div></li><li><div>          $autocomplete = 'off';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !um_can_view_field( $data ) ) return;&nbsp;</div></li><li><div>      if ( !um_can_edit_field( $data ) ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// fields that need to be disabled in edit mode (profile)</span>&nbsp;</div></li><li><div>      $arr_restricted_fields = array('user_email', 'username', 'user_login', 'user_password');&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( um_get_option('editable_primary_email_in_profile') == 1 ) {&nbsp;</div></li><li><div>          unset( $arr_restricted_fields[0] ); <span class="comment">// remove user_email</span>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( in_array( $key, $arr_restricted_fields ) && $this-&gt;editing == true && $this-&gt;set_mode == 'profile' ) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// forbidden in edit mode?</span>&nbsp;</div></li><li><div>      if ( isset( $data['edit_forbidden'] ) ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// required option</span>&nbsp;</div></li><li><div>      if ( isset( $data['required_opt'] ) ) {&nbsp;</div></li><li><div>          $opt = $data['required_opt'];&nbsp;</div></li><li><div>          if ( um_get_option( $opt[0] ) != $opt[1] ) {&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// required user permission</span>&nbsp;</div></li><li><div>      if ( isset( $data['required_perm'] ) ) {&nbsp;</div></li><li><div>          if ( !um_user( $data['required_perm'] ) ) {&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// do not show passwords</span>&nbsp;</div></li><li><div>      if ( isset( $ultimatemember-&gt;user-&gt;preview ) && $ultimatemember-&gt;user-&gt;preview ) {&nbsp;</div></li><li><div>          if ( $data['type'] == 'password' ) {&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $type = apply_filters(&quot;um_hook_for_field_{$type}&quot;, $type );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Begin by field type */</span>&nbsp;</div></li><li><div>      switch( $type ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Default: Integration */</span>&nbsp;</div></li><li><div>          default:&nbsp;</div></li><li><div>              $mode = (isset($this-&gt;set_mode))?$this-&gt;set_mode:'no_mode';&nbsp;</div></li><li><div>              $output .= apply_filters(&quot;um_edit_field_{$mode}_{$type}&quot;, $output, $data);&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Other fields */</span>&nbsp;</div></li><li><div>          case 'googlemap':&nbsp;</div></li><li><div>          case 'youtube_video':&nbsp;</div></li><li><div>          case 'vimeo_video':&nbsp;</div></li><li><div>          case 'soundcloud_track':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset($icon) && $icon && isset( $this-&gt;field_icons ) && $this-&gt;field_icons == 'field' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-icon&quot;&gt;&lt;i class=&quot;'.$icon.'&quot;&gt;&lt;/i&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $field_name = $key.$ultimatemember-&gt;form-&gt;form_suffix;&nbsp;</div></li><li><div>                      $field_value = htmlspecialchars( $this-&gt;field_value( $key, $default, $data ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;input '.$disabled.' class=&quot;'.$this-&gt;get_class($key, $data).'&quot; type=&quot;'.$input.'&quot; name=&quot;'.$field_name.'&quot; id=&quot;'.$field_name.'&quot; value=&quot;'. $field_value .'&quot; placeholder=&quot;'.$placeholder.'&quot; data-validate=&quot;'.$validate.'&quot; data-key=&quot;'.$key.'&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;/div&gt;';&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      if( ! empty( $disabled ) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;disabled_hidden_field( $field_name, $field_value ); &nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_error( $this-&gt;show_error($key) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Text */</span>&nbsp;</div></li><li><div>          case 'text':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset($icon) && $icon && isset( $this-&gt;field_icons ) && $this-&gt;field_icons == 'field' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-icon&quot;&gt;&lt;i class=&quot;'.$icon.'&quot;&gt;&lt;/i&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $field_name = $key.$ultimatemember-&gt;form-&gt;form_suffix;&nbsp;</div></li><li><div>                      $field_value = htmlspecialchars( $this-&gt;field_value( $key, $default, $data ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;input '.$disabled.' autocomplete=&quot;'.$autocomplete.'&quot; class=&quot;'.$this-&gt;get_class($key, $data).'&quot; type=&quot;'.$input.'&quot; name=&quot;'.$field_name.'&quot; id=&quot;'.$field_name.'&quot; value=&quot;'. $field_value .'&quot; placeholder=&quot;'.$placeholder.'&quot; data-validate=&quot;'.$validate.'&quot; data-key=&quot;'.$key.'&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;/div&gt;';&nbsp;</div></li><li><div>                       &nbsp;</div></li><li><div>                       if( ! empty( $disabled ) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;disabled_hidden_field( $field_name, $field_value ); &nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_error( $this-&gt;show_error($key) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Number */</span>&nbsp;</div></li><li><div>          case 'number':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset($icon) && $icon && isset( $this-&gt;field_icons ) && $this-&gt;field_icons == 'field' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-icon&quot;&gt;&lt;i class=&quot;'.$icon.'&quot;&gt;&lt;/i&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $number_limit = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if( isset( $min ) ) {&nbsp;</div></li><li><div>                          $number_limit .= &quot; min=\&quot;{$min}\&quot; &quot;;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if( isset( $max ) ) {&nbsp;</div></li><li><div>                          $number_limit .= &quot; max=\&quot;{$max}\&quot; &quot;;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;input '.$disabled.' class=&quot;'.$this-&gt;get_class($key, $data).'&quot; type=&quot;number&quot; name=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; id=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; value=&quot;'. htmlspecialchars( $this-&gt;field_value( $key, $default, $data ) ) .'&quot; placeholder=&quot;'.$placeholder.'&quot; data-validate=&quot;'.$validate.'&quot; data-key=&quot;'.$key.'&quot; {$number_limit} /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_error( $this-&gt;show_error($key) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Password */</span>&nbsp;</div></li><li><div>          case 'password':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $original_key = $key;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $key == 'single_user_password' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $key = $original_key;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                              $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset($icon) && $icon && $this-&gt;field_icons == 'field' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-field-icon&quot;&gt;&lt;i class=&quot;'.$icon.'&quot;&gt;&lt;/i&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;input class=&quot;'.$this-&gt;get_class($key, $data).'&quot; type=&quot;'.$input.'&quot; name=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; id=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; value=&quot;'. $this-&gt;field_value( $key, $default, $data ) .'&quot; placeholder=&quot;'.$placeholder.'&quot; data-validate=&quot;'.$validate.'&quot; data-key=&quot;'.$key.'&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                              $output .= $this-&gt;field_error( $this-&gt;show_error($key) );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $this-&gt;set_mode == 'account' && um_is_core_page('account') ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $key = 'current_' . $original_key;&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                              $output .= $this-&gt;field_label( __('Current Password', 'ultimatemember'), $key, $data);&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( isset($icon) && $icon && $this-&gt;field_icons == 'field' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              $output .= '&lt;div class=&quot;um-field-icon&quot;&gt;&lt;i class=&quot;'.$icon.'&quot;&gt;&lt;/i&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              $output .= '&lt;input class=&quot;'.$this-&gt;get_class($key, $data).'&quot; type=&quot;'.$input.'&quot; name=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; id=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; value=&quot;' . $this-&gt;field_value( $key, $default, $data ) .'&quot; placeholder=&quot;'.$placeholder.'&quot; data-validate=&quot;'.$validate.'&quot; data-key=&quot;'.$key.'&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                                  $output .= $this-&gt;field_error( $this-&gt;show_error($key) );&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $key = $original_key;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $this-&gt;set_mode == 'account' && um_is_core_page('account') || $this-&gt;set_mode == 'password' && um_is_core_page('password-reset') ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_label( __('New Password', 'ultimatemember'), $key, $data);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      } else if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset($icon) && $icon && $this-&gt;field_icons == 'field' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-icon&quot;&gt;&lt;i class=&quot;'.$icon.'&quot;&gt;&lt;/i&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;input class=&quot;'.$this-&gt;get_class($key, $data).'&quot; type=&quot;'.$input.'&quot; name=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; id=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; value=&quot;'. $this-&gt;field_value( $key, $default, $data ) .'&quot; placeholder=&quot;'.$placeholder.'&quot; data-validate=&quot;'.$validate.'&quot; data-key=&quot;'.$key.'&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_error( $this-&gt;show_error($key) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $this-&gt;set_mode != 'login' && isset( $data['force_confirm_pass'] ) && $data['force_confirm_pass'] == 1 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $key = 'confirm_' . $original_key;&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                              $output .= $this-&gt;field_label( sprintf(__('Confirm %s', 'ultimatemember'), $data['label'] ), $key, $data);&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( isset($icon) && $icon && $this-&gt;field_icons == 'field' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              $output .= '&lt;div class=&quot;um-field-icon&quot;&gt;&lt;i class=&quot;'.$icon.'&quot;&gt;&lt;/i&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              $output .= '&lt;input class=&quot;'.$this-&gt;get_class($key, $data).'&quot; type=&quot;'.$input.'&quot; name=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; id=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; value=&quot;' . $this-&gt;field_value( $key, $default, $data ) .'&quot; placeholder=&quot;'.$placeholder.'&quot; data-validate=&quot;'.$validate.'&quot; data-key=&quot;'.$key.'&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                                  $output .= $this-&gt;field_error( $this-&gt;show_error($key) );&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** URL */</span>&nbsp;</div></li><li><div>          case 'url':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset($icon) && $icon && isset($this-&gt;field_icons) && $this-&gt;field_icons == 'field' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-icon&quot;&gt;&lt;i class=&quot;'.$icon.'&quot;&gt;&lt;/i&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;input  '.$disabled.'  class=&quot;'.$this-&gt;get_class($key, $data).'&quot; type=&quot;'.$input.'&quot; name=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; id=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; value=&quot;'. $this-&gt;field_value( $key, $default, $data ) .'&quot; placeholder=&quot;'.$placeholder.'&quot; data-validate=&quot;'.$validate.'&quot; data-key=&quot;'.$key.'&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_error( $this-&gt;show_error($key) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Date */</span>&nbsp;</div></li><li><div>          case 'date':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset($icon) && $icon && isset( $this-&gt;field_icons ) && $this-&gt;field_icons == 'field' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-icon&quot;&gt;&lt;i class=&quot;'.$icon.'&quot;&gt;&lt;/i&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;input  '.$disabled.'  class=&quot;'.$this-&gt;get_class($key, $data).'&quot; type=&quot;'.$input.'&quot; name=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; id=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; value=&quot;'. $this-&gt;field_value( $key, $default, $data ) .'&quot; placeholder=&quot;'.$placeholder.'&quot; data-validate=&quot;'.$validate.'&quot; data-key=&quot;'.$key.'&quot;    data-range=&quot;'.$range.'&quot; data-years=&quot;'.$years.'&quot; data-years_x=&quot;'.$years_x.'&quot; data-disabled_weekdays=&quot;'.$disabled_weekdays.'&quot; data-date_min=&quot;'.$date_min.'&quot; data-date_max=&quot;'.$date_max.'&quot; data-format=&quot;'.$js_format.'&quot; data-value=&quot;'. $this-&gt;field_value( $key, $default, $data ) .'&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_error( $this-&gt;show_error($key) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Time */</span>&nbsp;</div></li><li><div>          case 'time':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset($icon) && $icon && $this-&gt;field_icons == 'field' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-icon&quot;&gt;&lt;i class=&quot;'.$icon.'&quot;&gt;&lt;/i&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;input  '.$disabled.'  class=&quot;'.$this-&gt;get_class($key, $data).'&quot; type=&quot;'.$input.'&quot; name=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; id=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; value=&quot;'. $this-&gt;field_value( $key, $default, $data ) .'&quot; placeholder=&quot;'.$placeholder.'&quot; data-validate=&quot;'.$validate.'&quot; data-key=&quot;'.$key.'&quot;  data-format=&quot;'.$js_format.'&quot; data-intervals=&quot;'.$intervals.'&quot; data-value=&quot;'. $this-&gt;field_value( $key, $default, $data ) .'&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_error( $this-&gt;show_error($key) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Row */</span>&nbsp;</div></li><li><div>          case 'row':&nbsp;</div></li><li><div>              $output .= '';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Textarea */</span>&nbsp;</div></li><li><div>          case 'textarea':&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>                      $field_name = $key;&nbsp;</div></li><li><div>                      $field_value = $this-&gt;field_value( $key, $default, $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['html'] ) && $data['html'] != 0 && $key != &quot;description&quot; ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $textarea_settings = array(&nbsp;</div></li><li><div>                              'media_buttons' =&gt; false, &nbsp;</div></li><li><div>                              'wpautop' =&gt; false, &nbsp;</div></li><li><div>                              'editor_class' =&gt; $this-&gt;get_class($key, $data), &nbsp;</div></li><li><div>                              'editor_height' =&gt; $height, &nbsp;</div></li><li><div>                              'tinymce'=&gt; array(&nbsp;</div></li><li><div>                                  'toolbar1' =&gt; 'formatselect, bullist, numlist, bold, italic, underline, forecolor, blockquote, hr, removeformat, link, unlink, undo, redo', &nbsp;</div></li><li><div>                                  'toolbar2' =&gt; '', &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if( ! empty( $disabled ) ) {&nbsp;</div></li><li><div>                              $textarea_settings['tinymce']['readonly'] = true;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          $textarea_settings = apply_filters('um_form_fields_textarea_settings', $textarea_settings );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// turn on the output buffer</span>&nbsp;</div></li><li><div>                          ob_start();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// echo the editor to the buffer</span>&nbsp;</div></li><li><div>                          wp_editor( $field_value , $key, $textarea_settings );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// add the contents of the buffer to the output variable</span>&nbsp;</div></li><li><div>                          $output .=  ob_get_clean();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      else $output .= '&lt;textarea  '.$disabled.'  style=&quot;height: '.$height.';&quot; class=&quot;'.$this-&gt;get_class($key, $data).'&quot; name=&quot;'.$key.'&quot; id=&quot;'.$key.'&quot; placeholder=&quot;'.$placeholder.'&quot;&gt;'.$field_value.'&lt;/textarea&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&nbsp;</div></li><li><div>                      &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if( ! empty( $disabled ) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;disabled_hidden_field( $field_name, $field_value ); &nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_error( $this-&gt;show_error($key) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** Rating */</span></span>&nbsp;</div></li><li><div>          case 'rating':&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-rating um-raty&quot; id=&quot;'.$key.'&quot; data-key=&quot;'.$key.'&quot; data-number=&quot;'.$data['number'].'&quot; data-score=&quot;' . $this-&gt;field_value( $key, $default, $data ) . '&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** Gap/Space */</span></span>&nbsp;</div></li><li><div>          case 'spacing':&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field um-field-spacing' . $classes . '&quot;' . $conditional . ' style=&quot;height: '.$spacing.'&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** A line divider */</span></span>&nbsp;</div></li><li><div>          case 'divider':&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field um-field-divider' . $classes . '&quot;' . $conditional . ' style=&quot;border-bottom: '.$borderwidth.'px '.$borderstyle.' '.$bordercolor.'&quot;&gt;';&nbsp;</div></li><li><div>              if ( $divider_text ) {&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-field-divider-text&quot;&gt;&lt;span&gt;' . $divider_text . '&lt;/span&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Single Image Upload */</span>&nbsp;</div></li><li><div>          case 'image':&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( in_array( $key, array('profile_photo', 'cover_photo') ) ) {&nbsp;</div></li><li><div>                      $field_value = '';&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $field_value = $this-&gt;field_value( $key, $default, $data );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;input type=&quot;hidden&quot; name=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; id=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; value=&quot;'. $field_value . '&quot; /&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $modal_label = ( isset( $data['label'] ) ) ? $data['label'] : __('Upload Photo', 'ultimatemember');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-field-area&quot; style=&quot;text-align: center&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $this-&gt;field_value( $key, $default, $data ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( !in_array( $key, array('profile_photo', 'cover_photo') ) ) {&nbsp;</div></li><li><div>                          if ( isset( $this-&gt;set_mode ) && $this-&gt;set_mode == 'register' ) {&nbsp;</div></li><li><div>                              $imgValue = $this-&gt;field_value( $key, $default, $data );&nbsp;</div></li><li><div>                          } else {&nbsp;</div></li><li><div>                              $imgValue = um_user_uploads_uri() . $this-&gt;field_value( $key, $default, $data );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $img = '&lt;img src=&quot;' . $imgValue . '&quot; alt=&quot;&quot; /&gt;';&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          $img = '';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-single-image-preview show '. $crop_class .'&quot; data-crop=&quot;'.$crop_data.'&quot; data-key=&quot;'.$key.'&quot;&gt;&nbsp;</div></li><li><div>                              &lt;a href=&quot;#&quot; class=&quot;cancel&quot;&gt;&lt;i class=&quot;um-icon-close&quot;&gt;&lt;/i&gt;&lt;/a&gt;' . $img . '&nbsp;</div></li><li><div>                          &lt;/div&gt;&lt;a href=&quot;#&quot; data-modal=&quot;um_upload_single&quot; data-modal-size=&quot;'.$modal_size.'&quot; data-modal-copy=&quot;1&quot; class=&quot;um-button um-btn-auto-width&quot;&gt;'. __('Change photo', 'ultimatemember') . '&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-single-image-preview '. $crop_class .'&quot; data-crop=&quot;'.$crop_data.'&quot; data-key=&quot;'.$key.'&quot;&gt;&nbsp;</div></li><li><div>                              &lt;a href=&quot;#&quot; class=&quot;cancel&quot;&gt;&lt;i class=&quot;um-icon-close&quot;&gt;&lt;/i&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                              &lt;img src=&quot;&quot; alt=&quot;&quot; /&gt;&nbsp;</div></li><li><div>                          &lt;div class=&quot;um-clear&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;a href=&quot;#&quot; data-modal=&quot;um_upload_single&quot; data-modal-size=&quot;'.$modal_size.'&quot; data-modal-copy=&quot;1&quot; class=&quot;um-button um-btn-auto-width&quot;&gt;'. $button_text . '&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">/** modal hidden */</span></span>&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-modal-hidden-content&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-modal-header&quot;&gt; ' . $modal_label . '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-modal-body&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset( $this-&gt;set_id ) ) {&nbsp;</div></li><li><div>                      $set_id = $this-&gt;set_id;&nbsp;</div></li><li><div>                      $set_mode = $this-&gt;set_mode;&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $set_id = 0;&nbsp;</div></li><li><div>                      $set_mode = '';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $nonce = wp_create_nonce( 'um_upload_nonce-'.$this-&gt;timestamp );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-single-image-preview '. $crop_class .'&quot;  data-crop=&quot;'.$crop_data.'&quot; data-ratio=&quot;'.$ratio.'&quot; data-min_width=&quot;'.$min_width.'&quot; data-min_height=&quot;'.$min_height.'&quot; data-coord=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;cancel&quot;&gt;&lt;i class=&quot;um-icon-close&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;img src=&quot;&quot; alt=&quot;&quot; /&gt;&lt;div class=&quot;um-clear&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;um-clear&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-single-image-upload&quot; data-nonce=&quot;'.$nonce.'&quot; data-timestamp=&quot;'.$this-&gt;timestamp.'&quot; data-icon=&quot;'.$icon.'&quot; data-set_id=&quot;'.$set_id.'&quot; data-set_mode=&quot;'.$set_mode.'&quot; data-type=&quot;'.$type.'&quot; data-key=&quot;'.$key.'&quot; data-max_size=&quot;'.$max_size.'&quot; data-max_size_error=&quot;'.$max_size_error.'&quot; data-min_size_error=&quot;'.$min_size_error.'&quot; data-extension_error=&quot;'.$extension_error.'&quot;  data-allowed_types=&quot;'.$allowed_types.'&quot; data-upload_text=&quot;'.$upload_text.'&quot; data-max_files_error=&quot;'.$max_files_error.'&quot; data-upload_help_text=&quot;'.$upload_help_text.'&quot;&gt;'.$button_text.'&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-modal-footer&quot;&gt;&nbsp;</div></li><li><div>                                  &lt;div class=&quot;um-modal-right&quot;&gt;&nbsp;</div></li><li><div>                                      &lt;a href=&quot;#&quot; class=&quot;um-modal-btn um-finish-upload image disabled&quot; data-key=&quot;'.$key.'&quot; data-change=&quot;'.__('Change photo', 'ultimatemember').'&quot; data-processing=&quot;'.__('Processing...', 'ultimatemember').'&quot;&gt; ' . __('Apply', 'ultimatemember') . '&lt;/a&gt;&nbsp;</div></li><li><div>                                      &lt;a href=&quot;#&quot; class=&quot;um-modal-btn alt&quot; data-action=&quot;um_remove_modal&quot;&gt; ' . __('Cancel', 'ultimatemember') . '&lt;/a&gt;&nbsp;</div></li><li><div>                                  &lt;/div&gt;&nbsp;</div></li><li><div>                                  &lt;div class=&quot;um-clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                              &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">/** end */</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_error( $this-&gt;show_error($key) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Single File Upload */</span>&nbsp;</div></li><li><div>          case 'file':&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;input type=&quot;hidden&quot; name=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; id=&quot;'.$key.$ultimatemember-&gt;form-&gt;form_suffix.'&quot; value=&quot;'. $this-&gt;field_value( $key, $default, $data ) . '&quot; /&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                  $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $modal_label = ( isset( $data['label'] ) ) ? $data['label'] : __('Upload Photo', 'ultimatemember');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-field-area&quot; style=&quot;text-align: center&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $this-&gt;field_value( $key, $default, $data ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $extension = pathinfo( $this-&gt;field_value( $key, $default, $data ), PATHINFO_EXTENSION);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-single-file-preview show&quot; data-key=&quot;'.$key.'&quot;&gt;&nbsp;</div></li><li><div>                                      &lt;a href=&quot;#&quot; class=&quot;cancel&quot;&gt;&lt;i class=&quot;um-icon-close&quot;&gt;&lt;/i&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                                      &lt;div class=&quot;um-single-fileinfo&quot;&gt;&nbsp;</div></li><li><div>                                          &lt;a href=&quot;' . um_user_uploads_uri() . $this-&gt;field_value( $key, $default, $data )  . '&quot; target=&quot;_blank&quot;&gt;&nbsp;</div></li><li><div>                                              &lt;span class=&quot;icon&quot; style=&quot;background:'. $ultimatemember-&gt;files-&gt;get_fonticon_bg_by_ext( $extension ) . '&quot;&gt;&lt;i class=&quot;'. $ultimatemember-&gt;files-&gt;get_fonticon_by_ext( $extension ) .'&quot;&gt;&lt;/i&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                                              &lt;span class=&quot;filename&quot;&gt;' . $this-&gt;field_value( $key, $default, $data ) . '&lt;/span&gt;&nbsp;</div></li><li><div>                                          &lt;/a&gt;&nbsp;</div></li><li><div>                                      &lt;/div&gt;&nbsp;</div></li><li><div>                          &lt;/div&gt;&lt;a href=&quot;#&quot; data-modal=&quot;um_upload_single&quot; data-modal-size=&quot;'.$modal_size.'&quot; data-modal-copy=&quot;1&quot; class=&quot;um-button um-btn-auto-width&quot;&gt;'. __('Change file', 'ultimatemember') . '&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-single-file-preview&quot; data-key=&quot;'.$key.'&quot;&gt;&nbsp;</div></li><li><div>                          &lt;/div&gt;&lt;a href=&quot;#&quot; data-modal=&quot;um_upload_single&quot; data-modal-size=&quot;'.$modal_size.'&quot; data-modal-copy=&quot;1&quot; class=&quot;um-button um-btn-auto-width&quot;&gt;'. $button_text . '&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">/** modal hidden */</span></span>&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-modal-hidden-content&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-modal-header&quot;&gt; ' . $modal_label . '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-modal-body&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset( $this-&gt;set_id ) ) {&nbsp;</div></li><li><div>                      $set_id = $this-&gt;set_id;&nbsp;</div></li><li><div>                      $set_mode = $this-&gt;set_mode;&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $set_id = 0;&nbsp;</div></li><li><div>                      $set_mode = '';&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-single-file-preview&quot;&gt;&nbsp;</div></li><li><div>                                      &lt;a href=&quot;#&quot; class=&quot;cancel&quot;&gt;&lt;i class=&quot;um-icon-close&quot;&gt;&lt;/i&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                                      &lt;div class=&quot;um-single-fileinfo&quot;&gt;&nbsp;</div></li><li><div>                                          &lt;a href=&quot;&quot; target=&quot;_blank&quot;&gt;&nbsp;</div></li><li><div>                                              &lt;span class=&quot;icon&quot;&gt;&lt;i&gt;&lt;/i&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                                              &lt;span class=&quot;filename&quot;&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                                          &lt;/a&gt;&nbsp;</div></li><li><div>                                      &lt;/div&gt;&nbsp;</div></li><li><div>                              &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $nonce = wp_create_nonce( 'um_upload_nonce-'.$this-&gt;timestamp );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-single-file-upload&quot; data-timestamp=&quot;'.$this-&gt;timestamp.'&quot; data-nonce=&quot;'.$nonce.'&quot; data-icon=&quot;'.$icon.'&quot; data-set_id=&quot;'.$set_id.'&quot; data-set_mode=&quot;'.$set_mode.'&quot; data-type=&quot;'.$type.'&quot; data-key=&quot;'.$key.'&quot; data-max_size=&quot;'.$max_size.'&quot; data-max_size_error=&quot;'.$max_size_error.'&quot; data-min_size_error=&quot;'.$min_size_error.'&quot; data-extension_error=&quot;'.$extension_error.'&quot;  data-allowed_types=&quot;'.$allowed_types.'&quot; data-upload_text=&quot;'.$upload_text.'&quot; data-max_files_error=&quot;'.$max_files_error.'&quot; data-upload_help_text=&quot;'.$upload_help_text.'&quot;&gt;'.$button_text.'&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-modal-footer&quot;&gt;&nbsp;</div></li><li><div>                                  &lt;div class=&quot;um-modal-right&quot;&gt;&nbsp;</div></li><li><div>                                      &lt;a href=&quot;#&quot; class=&quot;um-modal-btn um-finish-upload file disabled&quot; data-key=&quot;'.$key.'&quot; data-change=&quot;'.__('Change file').'&quot; data-processing=&quot;'.__('Processing...', 'ultimatemember').'&quot;&gt; ' . __('Save', 'ultimatemember') . '&lt;/a&gt;&nbsp;</div></li><li><div>                                      &lt;a href=&quot;#&quot; class=&quot;um-modal-btn alt&quot; data-action=&quot;um_remove_modal&quot;&gt; ' . __('Cancel', 'ultimatemember') . '&lt;/a&gt;&nbsp;</div></li><li><div>                                  &lt;/div&gt;&nbsp;</div></li><li><div>                                  &lt;div class=&quot;um-clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                              &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">/** end */</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_error( $this-&gt;show_error($key) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Select dropdown */</span>&nbsp;</div></li><li><div>          case 'select':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $form_key = str_replace('role_select', 'role', $key);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['allowclear'] ) && $data['allowclear'] == 0 ) {&nbsp;</div></li><li><div>                          $class = 'um-s2';&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          $class = 'um-s1';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      $has_parent_option = false;&nbsp;</div></li><li><div>                      $disabled_by_parent_option = '';&nbsp;</div></li><li><div>                      $atts_ajax = '';&nbsp;</div></li><li><div>                      $select_original_option_value = '';&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      if( isset( $data['parent_dropdown_relationship'] ) && ! empty( $data['parent_dropdown_relationship'] ) && ! $ultimatemember-&gt;user-&gt;preview ) {&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                              $disabled_by_parent_option = 'disabled = disabled';&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                              $has_parent_option = true;&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                              $parent_dropdown_relationship = apply_filters(&quot;um_custom_dropdown_options_parent__{$form_key}&quot;, $data['parent_dropdown_relationship'], $data );&nbsp;</div></li><li><div>                              $atts_ajax .= &quot; data-um-parent='{$parent_dropdown_relationship}' &quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if( isset( $data['custom_dropdown_options_source'] ) && ! empty( $data['custom_dropdown_options_source'] ) &&&nbsp;</div></li><li><div>                                  $has_parent_option &&  function_exists( $data['custom_dropdown_options_source'] ) &&&nbsp;</div></li><li><div>                                  um_user( $data['parent_dropdown_relationship'] ) ) {&nbsp;</div></li><li><div>                                  $options = call_user_func( $data['custom_dropdown_options_source'] );&nbsp;</div></li><li><div>                                  $disabled_by_parent_option = '';&nbsp;</div></li><li><div>                                  if( um_user( $form_key ) ) {&nbsp;</div></li><li><div>                                      $select_original_option_value = &quot; data-um-original-value='&quot;.um_user( $form_key ).&quot;' &quot;;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if( isset( $data['custom_dropdown_options_source'] ) && ! empty( $data['custom_dropdown_options_source'] ) ) {&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          $ajax_source = apply_filters(&quot;um_custom_dropdown_options_source__{$form_key}&quot;, $data['custom_dropdown_options_source'], $data );&nbsp;</div></li><li><div>                          $atts_ajax .= &quot; data-um-ajax-source='{$ajax_source}' &quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $ajax_source_url = apply_filters(&quot;um_custom_dropdown_options_source_url__{$form_key}&quot;, admin_url('admin-ajax.php'), $data );&nbsp;</div></li><li><div>                          $atts_ajax .= &quot; data-um-ajax-url='{$ajax_source_url}' &quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;select  '.$disabled.' '.$select_original_option_value.' '.$disabled_by_parent_option.'  name=&quot;'.$form_key.'&quot; id=&quot;'.$form_key.'&quot; data-validate=&quot;'.$validate.'&quot; data-key=&quot;'.$key.'&quot; class=&quot;'.$this-&gt;get_class($key, $data, $class).'&quot; style=&quot;width: 100%&quot; data-placeholder=&quot;'.$placeholder.'&quot; '.$atts_ajax.'&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if( ! $has_parent_option ) {&nbsp;</div></li><li><div>                          if ( isset($options) && $options == 'builtin') {&nbsp;</div></li><li><div>                              $options = $ultimatemember-&gt;builtin-&gt;get ( $filter );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if (!isset($options)) {&nbsp;</div></li><li><div>                              $options = $ultimatemember-&gt;builtin-&gt;get ( 'countries' );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( isset( $options ) ) {&nbsp;</div></li><li><div>                              $options = apply_filters('um_select_dropdown_dynamic_options', $options, $data );&nbsp;</div></li><li><div>                              $options = apply_filters(&quot;um_select_dropdown_dynamic_options_{$key}&quot;, $options );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">// role field</span></span>&nbsp;</div></li><li><div>                      if ( $form_key == 'role' ) {&nbsp;</div></li><li><div>                          global $wpdb;&nbsp;</div></li><li><div>                          foreach($options as $key =&gt; $val ) {&nbsp;</div></li><li><div>                              $val = (string) $val;&nbsp;</div></li><li><div>                              $val = trim( $val );&nbsp;</div></li><li><div>                              $post_id = $wpdb-&gt;get_var( &nbsp;</div></li><li><div>                                  $wpdb-&gt;prepare(&quot;SELECT ID FROM $wpdb-&gt;posts WHERE post_status = 'publish' AND post_type = 'um_role' AND ( post_name = %s OR post_title = %s )&quot;, $key, $val )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                              $_role = get_post( $post_id );&nbsp;</div></li><li><div>                              if( isset( $_role-&gt;post_title ) ) {&nbsp;</div></li><li><div>                                  $new_roles[ $_role-&gt;post_name ] = $_role-&gt;post_title;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              wp_reset_postdata();&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $options = $new_roles;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">// add an empty option!</span></span>&nbsp;</div></li><li><div>                      $output .= '&lt;option value=&quot;&quot;&gt;&lt;/option&gt;';&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      $field_value = '';&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">// switch options pair for custom options from a callback function</span></span>&nbsp;</div></li><li><div>                      if( isset( $data['custom_dropdown_options_source'] ) && ! empty( $data['custom_dropdown_options_source'] ) ) {&nbsp;</div></li><li><div>                          $options_pair = true;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                     <span class="comment"><span class="comment"><span class="comment"><span class="comment">// add options</span></span></span></span>&nbsp;</div></li><li><div>                      foreach($options as $k =&gt; $v) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $v = rtrim($v);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $option_value = $v;&nbsp;</div></li><li><div>                          $um_field_checkbox_item_title = $v;&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( ! is_numeric( $k ) && in_array($form_key, array('role') ) ) {&nbsp;</div></li><li><div>                              $option_value = $k;&nbsp;</div></li><li><div>                              $um_field_checkbox_item_title = $v;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          if ( isset( $options_pair ) ) {&nbsp;</div></li><li><div>                              $option_value = $k;&nbsp;</div></li><li><div>                              $um_field_checkbox_item_title = $v;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          $option_value = apply_filters('um_field_non_utf8_value', $option_value );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>                          $output .= '&lt;option value=&quot;' . $option_value . '&quot; ';&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          if ( $this-&gt;is_selected( $form_key, $option_value, $data ) ) {&nbsp;</div></li><li><div>                              $output.= 'selected';&nbsp;</div></li><li><div>                              $field_value = $option_value;&nbsp;</div></li><li><div>                          }else if( ! isset( $options_pair ) && $this-&gt;is_selected( $form_key, $v, $data ) ) {&nbsp;</div></li><li><div>                              $output.= 'selected';&nbsp;</div></li><li><div>                              $field_value = $v;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          $output .= '&gt;'.__( $um_field_checkbox_item_title, UM_TEXTDOMAIN).'&lt;/option&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if( ! empty( $disabled ) ) {&nbsp;</div></li><li><div>                              $output .= $this-&gt;disabled_hidden_field( $form_key, $field_value ); &nbsp;</div></li><li><div>                       }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/select&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $this-&gt;is_error($form_key) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_error( $this-&gt;show_error($form_key) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Multi-Select dropdown */</span>&nbsp;</div></li><li><div>          case 'multiselect':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $max_selections = ( isset( $max_selections ) ) ? absint( $max_selections ) : 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['allowclear'] ) && $data['allowclear'] == 0 ) {&nbsp;</div></li><li><div>                          $class = 'um-s2';&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          $class = 'um-s1';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $use_keyword = apply_filters('um_multiselect_option_value', 0, $data['type'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;select  '.$disabled.' multiple=&quot;multiple&quot; name=&quot;'.$key.'[]&quot; id=&quot;'.$key.'&quot; data-maxsize=&quot;'. $max_selections . '&quot; data-validate=&quot;'.$validate.'&quot; data-key=&quot;'.$key.'&quot; class=&quot;'.$this-&gt;get_class($key, $data, $class).' um-user-keyword_'.$use_keyword.'&quot; style=&quot;width: 100%&quot; data-placeholder=&quot;'.$placeholder.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      if ( isset($options) && $options == 'builtin') {&nbsp;</div></li><li><div>                          $options = $ultimatemember-&gt;builtin-&gt;get ( $filter );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if (!isset($options)) {&nbsp;</div></li><li><div>                          $options = $ultimatemember-&gt;builtin-&gt;get ( 'countries' );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $options ) ) {&nbsp;</div></li><li><div>                          $options = apply_filters('um_multiselect_options', $options, $data );&nbsp;</div></li><li><div>                          $options = apply_filters(&quot;um_multiselect_options_{$key}&quot;, $options );&nbsp;</div></li><li><div>                          $options = apply_filters(&quot;um_multiselect_options_{$data['type']}&quot;, $options, $data );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">// switch options pair for custom options from a callback function</span></span>&nbsp;</div></li><li><div>                      if( isset( $data['custom_dropdown_options_source'] ) && ! empty( $data['custom_dropdown_options_source'] ) ) {&nbsp;</div></li><li><div>                          $use_keyword = true;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">// add an empty option!</span></span>&nbsp;</div></li><li><div>                      $output .= '&lt;option value=&quot;&quot;&gt;&lt;/option&gt;';&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      $arr_selected = array();&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment"><span class="comment">// add options</span></span></span></span>&nbsp;</div></li><li><div>                      foreach( $options as $k =&gt; $v ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $v = rtrim( $v );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $um_field_checkbox_item_title = $v;&nbsp;</div></li><li><div>                          $opt_value = $v;&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          if ( $use_keyword ) {&nbsp;</div></li><li><div>                              $um_field_checkbox_item_title = $v;&nbsp;</div></li><li><div>                              $opt_value = $k;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          $opt_value = apply_filters('um_field_non_utf8_value', $opt_value );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>                          $output .= '&lt;option value=&quot;'.$opt_value.'&quot; ';&nbsp;</div></li><li><div>                          if ( $this-&gt;is_selected( $key, $opt_value, $data ) ) {&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                              $output .= 'selected';&nbsp;</div></li><li><div>                              $arr_selected[ $opt_value ] = $opt_value;    &nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&gt;'.__( $um_field_checkbox_item_title , UM_TEXTDOMAIN).'&lt;/option&gt;';&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                         &nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/select&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if( ! empty( $disabled ) && ! empty( $arr_selected ) ) {&nbsp;</div></li><li><div>                          foreach( $arr_selected as $item ) {&nbsp;</div></li><li><div>                             $output .= $this-&gt;disabled_hidden_field( $key.'[]', $item );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_error( $this-&gt;show_error( $key ) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Radio */</span>&nbsp;</div></li><li><div>          case 'radio':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $form_key = str_replace('role_radio', 'role', $key);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset( $options ) ) {&nbsp;</div></li><li><div>                  $options = apply_filters('um_radio_field_options', $options, $data );&nbsp;</div></li><li><div>                  $options = apply_filters(&quot;um_radio_field_options_{$key}&quot;, $options );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">// role field</span></span>&nbsp;</div></li><li><div>                      if ( $form_key == 'role' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          global $wpdb;&nbsp;</div></li><li><div>                          foreach($options as $rkey =&gt; $val ) {&nbsp;</div></li><li><div>                              $val = (string) $val;&nbsp;</div></li><li><div>                              $val = trim( $val );&nbsp;</div></li><li><div>                              $post_id = $wpdb-&gt;get_var(&nbsp;</div></li><li><div>                                  $wpdb-&gt;prepare(&quot;SELECT ID FROM $wpdb-&gt;posts WHERE post_status = 'publish' AND post_type = 'um_role' AND ( post_name = %s OR post_title = %s )&quot;, $rkey, $val )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                              $_role = get_post($post_id);&nbsp;</div></li><li><div>                              $new_roles[$_role-&gt;post_name] = $_role-&gt;post_title;&nbsp;</div></li><li><div>                              wp_reset_postdata();&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $options = $new_roles;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment"><span class="comment">// add options</span></span></span></span>&nbsp;</div></li><li><div>                      $i = 0;&nbsp;</div></li><li><div>                      $field_value = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      foreach($options as $k =&gt; $v) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $v = rtrim($v);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $um_field_checkbox_item_title = $v;&nbsp;</div></li><li><div>                          $option_value = $v;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( !is_numeric( $k ) && in_array($form_key, array('role') ) ) {&nbsp;</div></li><li><div>                              $um_field_checkbox_item_title = $v;&nbsp;</div></li><li><div>                              $option_value = $k;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $i++;&nbsp;</div></li><li><div>                          if ($i % 2 == 0 ) {&nbsp;</div></li><li><div>                              $col_class = 'right';&nbsp;</div></li><li><div>                          } else {&nbsp;</div></li><li><div>                              $col_class = '';&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( $this-&gt;is_radio_checked($key, $option_value, $data) ) {&nbsp;</div></li><li><div>                              $active = 'active';&nbsp;</div></li><li><div>                              $class = &quot;um-icon-android-radio-button-on&quot;;&nbsp;</div></li><li><div>                          } else {&nbsp;</div></li><li><div>                              $active = '';&nbsp;</div></li><li><div>                              $class = &quot;um-icon-android-radio-button-off&quot;;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;label class=&quot;um-field-radio '.$active.' um-field-half '.$col_class.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $option_value = apply_filters('um_field_non_utf8_value', $option_value );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>                          $output .= '&lt;input  '.$disabled.' type=&quot;radio&quot; name=&quot;'.$form_key.'[]&quot; value=&quot;'.$option_value.'&quot; ';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( $this-&gt;is_radio_checked($key, $option_value, $data) ) {&nbsp;</div></li><li><div>                              $output.= 'checked';&nbsp;</div></li><li><div>                              $field_value[ $key ] = $option_value;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= ' /&gt;';&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                          $output .= '&lt;span class=&quot;um-field-radio-state&quot;&gt;&lt;i class=&quot;'.$class.'&quot;&gt;&lt;/i&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>                          $output .= '&lt;span class=&quot;um-field-radio-option&quot;&gt;'.__( $um_field_checkbox_item_title, UM_TEXTDOMAIN).'&lt;/span&gt;';&nbsp;</div></li><li><div>                          $output .= '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ($i % 2 == 0) {&nbsp;</div></li><li><div>                              $output .= '&lt;div class=&quot;um-clear&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if( ! empty( $disabled ) ) {&nbsp;</div></li><li><div>                          foreach( $field_value as $item ) {&nbsp;</div></li><li><div>                              $output .= $this-&gt;disabled_hidden_field( $form_key , $item );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-clear&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $this-&gt;is_error($form_key) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_error( $this-&gt;show_error($form_key) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Checkbox */</span>&nbsp;</div></li><li><div>          case 'checkbox':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset( $options ) ) {&nbsp;</div></li><li><div>                  $options = apply_filters('um_checkbox_field_options', $options, $data );&nbsp;</div></li><li><div>                  $options = apply_filters(&quot;um_checkbox_field_options_{$key}&quot;, $options );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                      $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment"><span class="comment">// add options</span></span></span></span>&nbsp;</div></li><li><div>                      $i = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      foreach($options as $k =&gt; $v) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $v = rtrim($v);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $i++;&nbsp;</div></li><li><div>                          if ($i % 2 == 0 ) {&nbsp;</div></li><li><div>                              $col_class = 'right';&nbsp;</div></li><li><div>                          } else {&nbsp;</div></li><li><div>                              $col_class = '';&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( $this-&gt;is_selected($key, $v, $data) ) {&nbsp;</div></li><li><div>                              $active = 'active';&nbsp;</div></li><li><div>                              $class = &quot;um-icon-android-checkbox-outline&quot;;&nbsp;</div></li><li><div>                          } else {&nbsp;</div></li><li><div>                              $active = '';&nbsp;</div></li><li><div>                              $class = &quot;um-icon-android-checkbox-outline-blank&quot;;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;label class=&quot;um-field-checkbox '.$active.' um-field-half '.$col_class.'&quot;&gt;';&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          $um_field_checkbox_item_title = $v;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $v = apply_filters('um_field_non_utf8_value', $v );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>                          $output .= '&lt;input  '.$disabled.' type=&quot;checkbox&quot; name=&quot;'.$key.'[]&quot; value=&quot;'.strip_tags( $v ).'&quot; ';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( $this-&gt;is_selected($key, $v, $data) ) {&nbsp;</div></li><li><div>                              $output.= 'checked';&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= ' /&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if( ! empty( $disabled ) &&  $this-&gt;is_selected($key, $v, $data) ) {&nbsp;</div></li><li><div>                                  $output .= $this-&gt;disabled_hidden_field( $key.'[]', strip_tags( $v ) ); &nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          $output .= '&lt;span class=&quot;um-field-checkbox-state&quot;&gt;&lt;i class=&quot;'.$class.'&quot;&gt;&lt;/i&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>                          $um_field_checkbox_item_title = apply_filters(&quot;um_field_checkbox_item_title&quot;, $um_field_checkbox_item_title , $key, $v, $data );&nbsp;</div></li><li><div>                          $output .= '&lt;span class=&quot;um-field-checkbox-option&quot;&gt;'. __( $um_field_checkbox_item_title , UM_TEXTDOMAIN) .'&lt;/span&gt;';&nbsp;</div></li><li><div>                          $output .= '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ($i % 2 == 0) {&nbsp;</div></li><li><div>                              $output .= '&lt;div class=&quot;um-clear&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-clear&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $this-&gt;is_error($key) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_error( $this-&gt;show_error($key) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** HTML */</span></span>&nbsp;</div></li><li><div>          case 'block':&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;&nbsp;</div></li><li><div>                              &lt;div class=&quot;um-field-block&quot;&gt;'.$content.'&lt;/div&gt;&nbsp;</div></li><li><div>                          &lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** Shortcode */</span></span>&nbsp;</div></li><li><div>          case 'shortcode':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $content = str_replace('{profile_id}', um_profile_id(), $content );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;&nbsp;</div></li><li><div>                              &lt;div class=&quot;um-field-shortcode&quot;&gt;' . do_shortcode($content) . '&lt;/div&gt;&nbsp;</div></li><li><div>                          &lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Unlimited Group */</span>&nbsp;</div></li><li><div>          case 'group':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $fields = $this-&gt;get_fields_in_group( $key );&nbsp;</div></li><li><div>              if ( !empty( $fields ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field-group&quot; data-max_entries=&quot;'.$max_entries.'&quot;&gt;&nbsp;</div></li><li><div>                              &lt;div class=&quot;um-field-group-head&quot;&gt;&lt;i class=&quot;um-icon-plus&quot;&gt;&lt;/i&gt;'.__($label, UM_TEXTDOMAIN).'&lt;/div&gt;';&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-field-group-body&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;um-field-group-cancel&quot;&gt;&lt;i class=&quot;um-icon-close&quot;&gt;&lt;/i&gt;&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  foreach($fields as $subkey =&gt; $subdata) {&nbsp;</div></li><li><div>                                      $output .= $this-&gt;edit_field( $subkey, $subdata, 'group' );&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>              $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Custom filter for field output</span></span>&nbsp;</div></li><li><div>      if ( isset( $this-&gt;set_mode ) ) {&nbsp;</div></li><li><div>          $output = apply_filters(&quot;um_{$key}_form_edit_field&quot;, $output, $this-&gt;set_mode);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $output;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Sorts columns array</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array $arr </span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $col </span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $dir </span>&nbsp;</div></li><li><div><span class="comment">   * @return array $arr</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function array_sort_by_column($arr, $col, $dir = SORT_ASC) {&nbsp;</div></li><li><div>      $sort_col = array();&nbsp;</div></li><li><div>      foreach ($arr as $key=&gt; $row) {&nbsp;</div></li><li><div>          if ( isset( $row[$col] ) ) {&nbsp;</div></li><li><div>              $sort_col[$key] = $row[$col];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      array_multisort($sort_col, $dir, $arr);&nbsp;</div></li><li><div>      return $arr;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get fields in row</span>&nbsp;</div></li><li><div><span class="comment">   * @param  integer $row_id </span>&nbsp;</div></li><li><div><span class="comment">   * @return string     </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function get_fields_by_row( $row_id ) {&nbsp;</div></li><li><div>      foreach( $this-&gt;get_fields as $key =&gt; $array ) {&nbsp;</div></li><li><div>          if ( !isset( $array['in_row'] ) || ( isset( $array['in_row'] ) && $array['in_row'] == $row_id ) ) {&nbsp;</div></li><li><div>              $results[$key] = $array;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return ( isset ( $results ) ) ? $results : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get fields by sub row</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $row_fields </span>&nbsp;</div></li><li><div><span class="comment">   * @param  integer $subrow_id  </span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function get_fields_in_subrow( $row_fields, $subrow_id ) {&nbsp;</div></li><li><div>      if ( !is_array( $row_fields ) ) return '';&nbsp;</div></li><li><div>      foreach( $row_fields as $key =&gt; $array ) {&nbsp;</div></li><li><div>          if ( !isset( $array['in_sub_row'] ) || ( isset( $array['in_sub_row'] ) && $array['in_sub_row'] == $subrow_id ) ) {&nbsp;</div></li><li><div>              $results[$key] = $array;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return ( isset ( $results ) ) ? $results : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get fields in group</span>&nbsp;</div></li><li><div><span class="comment">   * @param  integer $group_id </span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed         </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function get_fields_in_group( $group_id ) {&nbsp;</div></li><li><div>      foreach( $this-&gt;get_fields as $key =&gt; $array ) {&nbsp;</div></li><li><div>          if ( isset( $array['in_group'] ) && $array['in_group'] == $group_id ) {&nbsp;</div></li><li><div>              $results[$key] = $array;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return ( isset ( $results ) ) ? $results : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get fields in column</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array $fields     </span>&nbsp;</div></li><li><div><span class="comment">   * @param  integer $col_number </span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed           </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function get_fields_in_column( $fields, $col_number ) {&nbsp;</div></li><li><div>      foreach( $fields as $key =&gt; $array ) {&nbsp;</div></li><li><div>          if ( isset( $array['in_column'] ) && $array['in_column'] == $col_number ) {&nbsp;</div></li><li><div>              $results[$key] = $array;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return ( isset ( $results ) ) ? $results : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Display fields</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $mode </span>&nbsp;</div></li><li><div><span class="comment">   * @param  array $args </span>&nbsp;</div></li><li><div><span class="comment">   * @return string      </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function display( $mode, $args ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      $output = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;global_args = $args;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $ultimatemember-&gt;form-&gt;form_suffix = '-' . $this-&gt;global_args['form_id'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;set_mode = $mode;&nbsp;</div></li><li><div>      $this-&gt;set_id = $this-&gt;global_args['form_id'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;field_icons = ( isset(  $this-&gt;global_args['icons'] ) ) ? $this-&gt;global_args['icons'] : 'label';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// start output here</span></span>&nbsp;</div></li><li><div>      $this-&gt;get_fields = $this-&gt;get_fields();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !empty( $this-&gt;get_fields ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">// find rows</span></span>&nbsp;</div></li><li><div>          foreach( $this-&gt;get_fields as $key =&gt; $array ) {&nbsp;</div></li><li><div>              if ( $array['type'] == 'row' ) {&nbsp;</div></li><li><div>                  $this-&gt;rows[$key] = $array;&nbsp;</div></li><li><div>                  unset( $this-&gt;get_fields[ $key ] ); <span class="comment"><span class="comment">// not needed anymore</span></span>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">// rows fallback</span></span>&nbsp;</div></li><li><div>          if ( !isset( $this-&gt;rows ) ) {&nbsp;</div></li><li><div>              $this-&gt;rows = array( '_um_row_1' =&gt; array(&nbsp;</div></li><li><div>                      'type' =&gt; 'row', &nbsp;</div></li><li><div>                      'id' =&gt; '_um_row_1', &nbsp;</div></li><li><div>                      'sub_rows' =&gt; 1, &nbsp;</div></li><li><div>                      'cols' =&gt; 1&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">// master rows</span></span>&nbsp;</div></li><li><div>          foreach ( $this-&gt;rows as $row_id =&gt; $row_array ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $row_fields = $this-&gt;get_fields_by_row( $row_id );&nbsp;</div></li><li><div>              if ( $row_fields ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= $this-&gt;new_row_output( $row_id, $row_array );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $sub_rows = ( isset( $row_array['sub_rows'] ) ) ? $row_array['sub_rows'] : 1;&nbsp;</div></li><li><div>              for( $c = 0; $c &lt; $sub_rows; $c++ ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// cols</span></span>&nbsp;</div></li><li><div>                  $cols = ( isset(  $row_array['cols'] ) ) ? $row_array['cols'] : 1;&nbsp;</div></li><li><div>                  if ( strstr( $cols, ':' ) ) {&nbsp;</div></li><li><div>                      $col_split = explode( ':', $cols );&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $col_split = array( $cols );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  $cols_num = $col_split[$c];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// sub row fields</span></span>&nbsp;</div></li><li><div>                  $subrow_fields = null;&nbsp;</div></li><li><div>                  $subrow_fields = $this-&gt;get_fields_in_subrow( $row_fields, $c );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( is_array( $subrow_fields ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $subrow_fields = $this-&gt;array_sort_by_column( $subrow_fields, 'position');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $cols_num == 1 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-col-1&quot;&gt;';&nbsp;</div></li><li><div>                          $col1_fields = $this-&gt;get_fields_in_column( $subrow_fields, 1 );&nbsp;</div></li><li><div>                          if ( $col1_fields ) {&nbsp;</div></li><li><div>                          foreach( $col1_fields as $key =&gt; $data ) {$output .= $this-&gt;edit_field( $key, $data );}&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      } else if ( $cols_num == 2 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-col-121&quot;&gt;';&nbsp;</div></li><li><div>                          $col1_fields = $this-&gt;get_fields_in_column( $subrow_fields, 1 );&nbsp;</div></li><li><div>                          if ( $col1_fields ) {&nbsp;</div></li><li><div>                          foreach( $col1_fields as $key =&gt; $data ) {$output .= $this-&gt;edit_field( $key, $data );}&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-col-122&quot;&gt;';&nbsp;</div></li><li><div>                          $col2_fields = $this-&gt;get_fields_in_column( $subrow_fields, 2 );&nbsp;</div></li><li><div>                          if ( $col2_fields ) {&nbsp;</div></li><li><div>                          foreach( $col2_fields as $key =&gt; $data ) {$output .= $this-&gt;edit_field( $key, $data );}&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $output .= '&lt;/div&gt;&lt;div class=&quot;um-clear&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-col-131&quot;&gt;';&nbsp;</div></li><li><div>                          $col1_fields = $this-&gt;get_fields_in_column( $subrow_fields, 1 );&nbsp;</div></li><li><div>                          if ( $col1_fields ) {&nbsp;</div></li><li><div>                          foreach( $col1_fields as $key =&gt; $data ) {$output .= $this-&gt;edit_field( $key, $data );}&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-col-132&quot;&gt;';&nbsp;</div></li><li><div>                          $col2_fields = $this-&gt;get_fields_in_column( $subrow_fields, 2 );&nbsp;</div></li><li><div>                          if ( $col2_fields ) {&nbsp;</div></li><li><div>                          foreach( $col2_fields as $key =&gt; $data ) {$output .= $this-&gt;edit_field( $key, $data );}&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-col-133&quot;&gt;';&nbsp;</div></li><li><div>                          $col3_fields = $this-&gt;get_fields_in_column( $subrow_fields, 3 );&nbsp;</div></li><li><div>                          if ( $col3_fields ) {&nbsp;</div></li><li><div>                          foreach( $col3_fields as $key =&gt; $data ) {$output .= $this-&gt;edit_field( $key, $data );}&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $output .= '&lt;/div&gt;&lt;div class=&quot;um-clear&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $output;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Gets a field in `view mode`</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $key  </span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $data </span>&nbsp;</div></li><li><div><span class="comment">   * @param  boolean $rule </span>&nbsp;</div></li><li><div><span class="comment">   * @return string       </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function view_field( $key, $data, $rule=false ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $output = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// get whole field data</span></span>&nbsp;</div></li><li><div>      if (is_array($data)) {&nbsp;</div></li><li><div>          $data = $this-&gt;get_field($key);&nbsp;</div></li><li><div>          extract($data);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !isset( $data['type'] ) ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $data['in_group'] ) && $data['in_group'] != '' && $rule != 'group' ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $visibility == 'edit' ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( in_array( $type, array('block', 'shortcode', 'spacing', 'divider', 'group') ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          if ( ! $this-&gt;field_value( $key, $default, $data ) ) return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !um_can_view_field( $data ) ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// disable these fields in profile view only</span>&nbsp;</div></li><li><div>      if ( in_array( $key, array('user_password') ) && $this-&gt;set_mode == 'profile' ) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !um_field_conditions_are_met( $data ) ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      switch( $type ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Default */</span>&nbsp;</div></li><li><div>          default:&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      $res = $this-&gt;field_value( $key, $default, $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if( ! empty( $res ) ) {&nbsp;</div></li><li><div>                          $res = stripslashes( $res );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $data['is_view_field'] = true;&nbsp;</div></li><li><div>                      $res = apply_filters(&quot;um_view_field&quot;, $res, $data, $type );&nbsp;</div></li><li><div>                      $res = apply_filters(&quot;um_view_field_value_{$type}&quot;, $res, $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-value&quot;&gt;' . $res . '&lt;/div&gt;';&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** HTML */</span></span>&nbsp;</div></li><li><div>          case 'block':&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;&nbsp;</div></li><li><div>                              &lt;div class=&quot;um-field-block&quot;&gt;'.$content.'&lt;/div&gt;&nbsp;</div></li><li><div>                          &lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** Shortcode */</span></span>&nbsp;</div></li><li><div>          case 'shortcode':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $content = str_replace('{profile_id}', um_profile_id(), $content );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;&nbsp;</div></li><li><div>                              &lt;div class=&quot;um-field-shortcode&quot;&gt;' . do_shortcode($content) . '&lt;/div&gt;&nbsp;</div></li><li><div>                          &lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** Gap/Space */</span></span>&nbsp;</div></li><li><div>          case 'spacing':&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field um-field-spacing' . $classes . '&quot;' . $conditional . ' style=&quot;height: '.$spacing.'&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** A line divider */</span></span>&nbsp;</div></li><li><div>          case 'divider':&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field um-field-divider' . $classes . '&quot;' . $conditional . ' style=&quot;border-bottom: '.$borderwidth.'px '.$borderstyle.' '.$bordercolor.'&quot;&gt;';&nbsp;</div></li><li><div>              if ( $divider_text ) {&nbsp;</div></li><li><div>                  $output .= '&lt;div class=&quot;um-field-divider-text&quot;&gt;&lt;span&gt;' . $divider_text . '&lt;/span&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** Rating */</span></span>&nbsp;</div></li><li><div>          case 'rating':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;div class=&quot;um-field' . $classes . '&quot;' . $conditional . ' data-key=&quot;'.$key.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $data['label'] ) ) {&nbsp;</div></li><li><div>                          $output .= $this-&gt;field_label($label, $key, $data);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-area&quot;&gt;';&nbsp;</div></li><li><div>                      $output .= '&lt;div class=&quot;um-field-value&quot;&gt;&nbsp;</div></li><li><div>                                      &lt;div class=&quot;um-rating-readonly um-raty&quot; id=&quot;'.$key.'&quot; data-key=&quot;'.$key.'&quot; data-number=&quot;'.$data['number'].'&quot; data-score=&quot;' .  $this-&gt;field_value( $key, $default, $data ) . '&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                                  &lt;/div&gt;';&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Custom filter for field output</span></span>&nbsp;</div></li><li><div>      if ( isset( $this-&gt;set_mode ) ) {&nbsp;</div></li><li><div>          $output = apply_filters(&quot;um_{$key}_form_show_field&quot;, $output, $this-&gt;set_mode);&nbsp;</div></li><li><div>          $output = apply_filters(&quot;um_{$type}_form_show_field&quot;, $output, $this-&gt;set_mode);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $output;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Display fields ( view mode )</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $mode </span>&nbsp;</div></li><li><div><span class="comment">   * @param  array $args </span>&nbsp;</div></li><li><div><span class="comment">   * @return string       </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function display_view( $mode, $args ) {&nbsp;</div></li><li><div>      global $ultimatemember;&nbsp;</div></li><li><div>      $output = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;global_args = $args;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $ultimatemember-&gt;form-&gt;form_suffix = '-' . $this-&gt;global_args['form_id'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;set_mode = $mode;&nbsp;</div></li><li><div>      $this-&gt;set_id = $this-&gt;global_args['form_id'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;field_icons = ( isset(  $this-&gt;global_args['icons'] ) ) ? $this-&gt;global_args['icons'] : 'label';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// start output here</span></span>&nbsp;</div></li><li><div>      $this-&gt;get_fields = $this-&gt;get_fields();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( um_get_option('profile_empty_text') ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $emo = um_get_option('profile_empty_text_emo');&nbsp;</div></li><li><div>          if ( $emo ) {&nbsp;</div></li><li><div>              $emo = '&lt;i class=&quot;um-faicon-frown-o&quot;&gt;&lt;/i&gt;';&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $emo = false;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( um_is_myprofile() ) {&nbsp;</div></li><li><div>              $output .= '&lt;p class=&quot;um-profile-note&quot;&gt;' . $emo .'&lt;span&gt;' . sprintf(__('Your profile is looking a little empty. Why not &lt;a href=&quot;%s&quot;&gt;add&lt;/a&gt; some information!', 'ultimatemember'), um_edit_profile_url() ) . '&lt;/span&gt;&lt;/p&gt;';&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $output .= '&lt;p class=&quot;um-profile-note&quot;&gt;'. $emo . '&lt;span&gt;' . __('This user has not added any information to their profile yet.', 'ultimatemember') . '&lt;/span&gt;&lt;/p&gt;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !empty( $this-&gt;get_fields ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">// find rows</span></span>&nbsp;</div></li><li><div>          foreach( $this-&gt;get_fields as $key =&gt; $array ) {&nbsp;</div></li><li><div>              if ( $array['type'] == 'row' ) {&nbsp;</div></li><li><div>                  $this-&gt;rows[$key] = $array;&nbsp;</div></li><li><div>                  unset( $this-&gt;get_fields[ $key ] ); <span class="comment"><span class="comment">// not needed anymore</span></span>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">// rows fallback</span></span>&nbsp;</div></li><li><div>          if ( !isset( $this-&gt;rows ) ) {&nbsp;</div></li><li><div>              $this-&gt;rows = array( '_um_row_1' =&gt; array(&nbsp;</div></li><li><div>                      'type' =&gt; 'row', &nbsp;</div></li><li><div>                      'id' =&gt; '_um_row_1', &nbsp;</div></li><li><div>                      'sub_rows' =&gt; 1, &nbsp;</div></li><li><div>                      'cols' =&gt; 1&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">// master rows</span></span>&nbsp;</div></li><li><div>          foreach ( $this-&gt;rows as $row_id =&gt; $row_array ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $row_fields = $this-&gt;get_fields_by_row( $row_id );&nbsp;</div></li><li><div>              if ( $row_fields ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= $this-&gt;new_row_output( $row_id, $row_array );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $sub_rows = ( isset( $row_array['sub_rows'] ) ) ? $row_array['sub_rows'] : 1;&nbsp;</div></li><li><div>              for( $c = 0; $c &lt; $sub_rows; $c++ ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// cols</span></span>&nbsp;</div></li><li><div>                  $cols = ( isset(  $row_array['cols'] ) ) ? $row_array['cols'] : 1;&nbsp;</div></li><li><div>                  if ( strstr( $cols, ':' ) ) {&nbsp;</div></li><li><div>                      $col_split = explode( ':', $cols );&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $col_split = array( $cols );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  $cols_num = $col_split[$c];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// sub row fields</span></span>&nbsp;</div></li><li><div>                  $subrow_fields = null;&nbsp;</div></li><li><div>                  $subrow_fields = $this-&gt;get_fields_in_subrow( $row_fields, $c );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( is_array( $subrow_fields ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $subrow_fields = $this-&gt;array_sort_by_column( $subrow_fields, 'position');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $cols_num == 1 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-col-1&quot;&gt;';&nbsp;</div></li><li><div>                          $col1_fields = $this-&gt;get_fields_in_column( $subrow_fields, 1 );&nbsp;</div></li><li><div>                          if ( $col1_fields ) {&nbsp;</div></li><li><div>                              foreach( $col1_fields as $key =&gt; $data ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $data = apply_filters(&quot;um_view_field_output_&quot;.$data['type'], $data);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $output .= $this-&gt;view_field( $key, $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      } else if ( $cols_num == 2 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-col-121&quot;&gt;';&nbsp;</div></li><li><div>                          $col1_fields = $this-&gt;get_fields_in_column( $subrow_fields, 1 );&nbsp;</div></li><li><div>                          if ( $col1_fields ) {&nbsp;</div></li><li><div>                              foreach( $col1_fields as $key =&gt; $data ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $data = apply_filters(&quot;um_view_field_output_&quot;.$data['type'], $data);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $output .= $this-&gt;view_field( $key, $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-col-122&quot;&gt;';&nbsp;</div></li><li><div>                          $col2_fields = $this-&gt;get_fields_in_column( $subrow_fields, 2 );&nbsp;</div></li><li><div>                          if ( $col2_fields ) {&nbsp;</div></li><li><div>                              foreach( $col2_fields as $key =&gt; $data ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $data = apply_filters(&quot;um_view_field_output_&quot;.$data['type'], $data);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $output .= $this-&gt;view_field( $key, $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $output .= '&lt;/div&gt;&lt;div class=&quot;um-clear&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-col-131&quot;&gt;';&nbsp;</div></li><li><div>                          $col1_fields = $this-&gt;get_fields_in_column( $subrow_fields, 1 );&nbsp;</div></li><li><div>                          if ( $col1_fields ) {&nbsp;</div></li><li><div>                              foreach( $col1_fields as $key =&gt; $data ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $data = apply_filters(&quot;um_view_field_output_&quot;.$data['type'], $data);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $output .= $this-&gt;view_field( $key, $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-col-132&quot;&gt;';&nbsp;</div></li><li><div>                          $col2_fields = $this-&gt;get_fields_in_column( $subrow_fields, 2 );&nbsp;</div></li><li><div>                          if ( $col2_fields ) {&nbsp;</div></li><li><div>                              foreach( $col2_fields as $key =&gt; $data ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $data = apply_filters(&quot;um_view_field_output_&quot;.$data['type'], $data);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $output .= $this-&gt;view_field( $key, $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $output .= '&lt;div class=&quot;um-col-133&quot;&gt;';&nbsp;</div></li><li><div>                          $col3_fields = $this-&gt;get_fields_in_column( $subrow_fields, 3 );&nbsp;</div></li><li><div>                          if ( $col3_fields ) {&nbsp;</div></li><li><div>                              foreach( $col3_fields as $key =&gt; $data ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $data = apply_filters(&quot;um_view_field_output_&quot;.$data['type'], $data);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                  $output .= $this-&gt;view_field( $key, $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $output .= '&lt;/div&gt;&lt;div class=&quot;um-clear&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $output;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get new row in form</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $row_id    </span>&nbsp;</div></li><li><div><span class="comment">   * @param  array $row_array </span>&nbsp;</div></li><li><div><span class="comment">   * @return array         </span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function new_row_output( $row_id, $row_array ) {&nbsp;</div></li><li><div>      $output = null;&nbsp;</div></li><li><div>      extract($row_array);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $padding = (isset($padding))?$padding:'';&nbsp;</div></li><li><div>      $margin = (isset($margin))?$margin:'';&nbsp;</div></li><li><div>      $background = (isset($background))?$background:'';&nbsp;</div></li><li><div>      $text_color = (isset($text_color))?$text_color:'';&nbsp;</div></li><li><div>      $borderradius = (isset($borderradius))?$borderradius:'';&nbsp;</div></li><li><div>      $border = (isset($border))?$border:'';&nbsp;</div></li><li><div>      $bordercolor = (isset($bordercolor))?$bordercolor:'';&nbsp;</div></li><li><div>      $borderstyle = (isset($borderstyle))?$borderstyle:'';&nbsp;</div></li><li><div>      $heading = (isset($heading))?$heading:'';&nbsp;</div></li><li><div>      $css_class = (isset($css_class))?$css_class:'';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $css_padding = '';&nbsp;</div></li><li><div>      $css_margin = '';&nbsp;</div></li><li><div>      $css_background = '';&nbsp;</div></li><li><div>      $css_borderradius = '';&nbsp;</div></li><li><div>      $css_border = '';&nbsp;</div></li><li><div>      $css_bordercolor = '';&nbsp;</div></li><li><div>      $css_borderstyle = '';&nbsp;</div></li><li><div>      $css_heading_background_color = '';&nbsp;</div></li><li><div>      $css_heading_padding = '';&nbsp;</div></li><li><div>      $css_heading_text_color = '';&nbsp;</div></li><li><div>      $css_heading_borderradius = '';&nbsp;</div></li><li><div>      $css_text_color = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// row css rules</span>&nbsp;</div></li><li><div>      if ( $padding ) $css_padding = 'padding: ' . $padding .';';&nbsp;</div></li><li><div>      if ( $margin ) {&nbsp;</div></li><li><div>          $css_margin = 'margin: ' . $margin .';';&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $css_margin = 'margin: 0 0 30px 0;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $background ) $css_background = 'background-color: ' . $background .';';&nbsp;</div></li><li><div>      if ( $borderradius ) $css_borderradius = 'border-radius: 0px 0px ' . $borderradius . ' ' . $borderradius . ';';&nbsp;</div></li><li><div>      if ( $border ) $css_border = 'border-width: ' . $border . ';';&nbsp;</div></li><li><div>      if ( $bordercolor ) $css_bordercolor = 'border-color: ' . $bordercolor . ';';&nbsp;</div></li><li><div>      if ( $borderstyle ) $css_borderstyle = 'border-style: ' . $borderstyle . ';';&nbsp;</div></li><li><div>      if ( $text_color ) $css_text_color = 'color: ' . $text_color . ' !important;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// show the heading</span>&nbsp;</div></li><li><div>      if ( $heading ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $heading_background_color = (isset($heading_background_color))?$heading_background_color:'';&nbsp;</div></li><li><div>          $heading_text_color = (isset($heading_text_color))?$heading_text_color:'';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $heading_background_color ) {&nbsp;</div></li><li><div>              $css_heading_background_color = 'background-color: ' . $heading_background_color .';';&nbsp;</div></li><li><div>              $css_heading_padding = 'padding: 10px 15px;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $heading_text_color ) $css_heading_text_color = 'color: ' . $heading_text_color .';';&nbsp;</div></li><li><div>          if ( $borderradius ) $css_heading_borderradius = 'border-radius: ' . $borderradius . ' ' . $borderradius . ' 0px 0px;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $output .= '&lt;div class=&quot;um-row-heading&quot; style=&quot;' . $css_heading_background_color . $css_heading_padding . $css_heading_text_color . $css_heading_borderradius . '&quot;&gt;';&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          if ( isset( $icon ) ) {&nbsp;</div></li><li><div>              $output .= '&lt;span class=&quot;um-row-heading-icon&quot;&gt;&lt;i class=&quot;' . $icon . '&quot;&gt;&lt;/i&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          $output .= ( ! empty( $heading_text ) ? $heading_text: '') .'&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// no heading</span>&nbsp;</div></li><li><div>          if ( $borderradius ) $css_borderradius = 'border-radius: ' . $borderradius . ';';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $output .= '&lt;div class=&quot;um-row ' . $row_id . ' ' . $css_class . '&quot; style=&quot;'. $css_padding . $css_background . $css_margin . $css_border . $css_borderstyle . $css_bordercolor . $css_borderradius . $css_text_color.'&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $output;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>Ultimate Member</li><li><span></span>1.3.82</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>