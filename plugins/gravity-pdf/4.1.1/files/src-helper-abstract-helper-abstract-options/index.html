<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="4.1.1" data-slug="gravity-pdf" data-type="file" data-id="20961"><head xmlns="http://www.w3.org/1999/xhtml"><title> src-helper-abstract-helper-abstract-options | file | Gravity Pdf | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, gravity-pdf, 4.1.1" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=27d1f086789dc6c06706a59107e0f9b7' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/src-helper-abstract-helper-abstract-options/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fsrc-helper-abstract-helper-abstract-options%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fsrc-helper-abstract-helper-abstract-options%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-gravity-pdf-4.1.1-file-src-helper-abstract-helper-abstract-options","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="src-helper-abstract-helper-abstract-options" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to gravity-pdf." href="http://hookr.io/plugins/gravity-pdf/" class="plugin"><span property="name">gravity-pdf</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 4.1.1." href="http://hookr.io/plugins/gravity-pdf/4.1.1/" class="H_VERSION"><span property="name">4.1.1</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/gravity-pdf/4.1.1/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">src-helper-abstract-helper-ab&hellip;</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="696"><a href="http://hookr.io/plugins/gravity-pdf/4.1.1/all/" title="All">All <span class="count badge">696</span></a></li><li class="" data-id="new" data-count="2"><a href="http://hookr.io/plugins/gravity-pdf/4.1.1/new/" title="New">New <span class="count badge">2</span></a></li><li class="" data-id="hooks" data-count="177"><a href="http://hookr.io/plugins/gravity-pdf/4.1.1/hooks/" title="Hooks">Hooks <span class="count badge">177</span></a></li><li class="" data-id="action" data-count="15"><a href="http://hookr.io/plugins/gravity-pdf/4.1.1/actions/" title="Actions">Actions <span class="count badge">15</span></a></li><li class="" data-id="filter" data-count="162"><a href="http://hookr.io/plugins/gravity-pdf/4.1.1/filters/" title="Filters">Filters <span class="count badge">162</span></a></li><li class="" data-id="class" data-count="411"><a href="http://hookr.io/plugins/gravity-pdf/4.1.1/classes/" title="Classes">Classes <span class="count badge">411</span></a></li><li class="" data-id="constant" data-count="64"><a href="http://hookr.io/plugins/gravity-pdf/4.1.1/constants/" title="Constants">Constants <span class="count badge">64</span></a></li><li class="" data-id="function" data-count="43"><a href="http://hookr.io/plugins/gravity-pdf/4.1.1/functions/" title="Functions">Functions <span class="count badge">43</span></a></li><li class="" data-id="shortcode" data-count="1"><a href="http://hookr.io/plugins/gravity-pdf/4.1.1/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">1</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/src/helper/abstract/Helper_Abstract_Options.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>namespace GFPDF\Helper;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>use Psr\Log\LoggerInterface;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>use WP_Error;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Our Gravity PDF Options API</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package     Gravity PDF</span>&nbsp;</div></li><li><div><span class="comment"> * @copyright   Copyright (c) 2016, Blue Liquid Designs</span>&nbsp;</div></li><li><div><span class="comment"> * @license     http://opensource.org/licenses/gpl-2.0.php GNU Public License</span>&nbsp;</div></li><li><div><span class="comment"> * @since       4.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">  This file is part of Gravity PDF.</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">  Gravity PDF * Copyright (C) 2016, Blue Liquid Designs</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">  This program is free software; you can redistribute it and/or modify</span>&nbsp;</div></li><li><div><span class="comment">  it under the terms of the GNU General Public License as published by</span>&nbsp;</div></li><li><div><span class="comment">  the Free Software Foundation; either version 2 of the License, or</span>&nbsp;</div></li><li><div><span class="comment">  (at your option) any later version.</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">  This program is distributed in the hope that it will be useful, </span>&nbsp;</div></li><li><div><span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>&nbsp;</div></li><li><div><span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>&nbsp;</div></li><li><div><span class="comment">  GNU General Public License for more details.</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">  You should have received a copy of the GNU General Public License</span>&nbsp;</div></li><li><div><span class="comment">  along with this program; if not, write to the Free Software</span>&nbsp;</div></li><li><div><span class="comment">  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>&nbsp;</div></li><li><div><span class="comment">*/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Exit if accessed directly */</span>&nbsp;</div></li><li><div>if ( ! defined( 'ABSPATH' ) ) {&nbsp;</div></li><li><div>  exit;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Class to set up the settings api callbacks</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Pulled straight from the Easy Digital Download register-settings.php file (props to Pippin and team)</span>&nbsp;</div></li><li><div><span class="comment"> * and modified to suit our requirements</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>abstract class Helper_Abstract_Options implements Helper_Interface_Filters {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Holds the abstracted Gravity Forms API specific to Gravity PDF</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var \GFPDF\Helper\Helper_Form</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  protected $gform;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Holds our log class</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var \Monolog\Logger|LoggerInterface</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  protected $log;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Holds our Helper_Data object</span>&nbsp;</div></li><li><div><span class="comment">   * which we can autoload with any data needed</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var \GFPDF\Helper\Helper_Data</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  protected $data;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Holds our Helper_Templates object</span>&nbsp;</div></li><li><div><span class="comment">   * used to ease access to our PDF templates</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var \GFPDF\Helper\Helper_Templates</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  protected $templates;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Holds our Helper_Misc object</span>&nbsp;</div></li><li><div><span class="comment">   * Makes it easy to access common methods throughout the plugin</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var \GFPDF\Helper\Helper_Misc</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  protected $misc;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Holds our Helper_Notices object</span>&nbsp;</div></li><li><div><span class="comment">   * which we can use to queue up admin messages for the user</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var \GFPDF\Helper\Helper_Notices</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  protected $notices;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Holds the current global user settings</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var array</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $settings = [];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Holds the Gravity Form PDF Settings</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var array</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $form_settings = [];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Helper_Abstract_Options constructor.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param \Monolog\Logger|LoggerInterface    $log</span>&nbsp;</div></li><li><div><span class="comment">   * @param \GFPDF\Helper\Helper_Abstract_Form $gform</span>&nbsp;</div></li><li><div><span class="comment">   * @param \GFPDF\Helper\Helper_Data          $data</span>&nbsp;</div></li><li><div><span class="comment">   * @param \GFPDF\Helper\Helper_Misc          $misc</span>&nbsp;</div></li><li><div><span class="comment">   * @param \GFPDF\Helper\Helper_Notices       $notices</span>&nbsp;</div></li><li><div><span class="comment">   * @param \GFPDF\Helper\Helper_Templates     $templates</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function __construct( LoggerInterface $log, Helper_Abstract_Form $gform, Helper_Data $data, Helper_Misc $misc, Helper_Notices $notices, Helper_Templates $templates ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Assign our internal variables */</span>&nbsp;</div></li><li><div>      $this-&gt;log = $log;&nbsp;</div></li><li><div>      $this-&gt;gform = $gform;&nbsp;</div></li><li><div>      $this-&gt;data = $data;&nbsp;</div></li><li><div>      $this-&gt;misc = $misc;&nbsp;</div></li><li><div>      $this-&gt;notices = $notices;&nbsp;</div></li><li><div>      $this-&gt;templates = $templates;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns an array of registered fields</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  abstract public function get_registered_fields();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Initialise the options API</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function init() {&nbsp;</div></li><li><div>      $this-&gt;set_plugin_settings();&nbsp;</div></li><li><div>      $this-&gt;add_filters();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Add our filters</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function add_filters() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Register our core santize functions */</span>&nbsp;</div></li><li><div>      add_filter( 'gfpdf_settings_sanitize', [ $this, 'sanitize_required_field' ], 10, 4 );&nbsp;</div></li><li><div>      add_filter( 'gfpdf_settings_sanitize', [ $this, 'sanitize_all_fields' ], 10, 4 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      add_filter( 'gfpdf_settings_sanitize_text', [ $this, 'sanitize_trim_field' ] );&nbsp;</div></li><li><div>      add_filter( 'gfpdf_settings_sanitize_textarea', [ $this, 'sanitize_trim_field' ] );&nbsp;</div></li><li><div>      add_filter( 'gfpdf_settings_sanitize_number', [ $this, 'sanitize_number_field' ] );&nbsp;</div></li><li><div>      add_filter( 'gfpdf_settings_sanitize_paper_size', [ $this, 'sanitize_paper_size' ] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the plugin's settings from the database</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function set_plugin_settings() {&nbsp;</div></li><li><div>      <span class="comment">/** assign our settings */</span>&nbsp;</div></li><li><div>      $this-&gt;settings = $this-&gt;get_settings();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Add all settings sections and fields</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $fields Fields that should be registered</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function register_settings( $fields = [] ) {&nbsp;</div></li><li><div>      global $wp_settings_fields;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $fields as $tab =&gt; $settings ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Clear all previously set types */</span>&nbsp;</div></li><li><div>          $group = 'gfpdf_settings_' . $tab;&nbsp;</div></li><li><div>          if ( isset( $wp_settings_fields[ $group ] ) ) {&nbsp;</div></li><li><div>              unset( $wp_settings_fields[ $group ] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $settings as $option ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $name = isset( $option['name'] ) ? $option['name'] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              add_settings_field(&nbsp;</div></li><li><div>                  'gfpdf_settings[' . $option['id'] . ']', &nbsp;</div></li><li><div>                  $name, &nbsp;</div></li><li><div>                  method_exists( $this, $option['type'] . '_callback' ) ? [&nbsp;</div></li><li><div>                      $this, &nbsp;</div></li><li><div>                      $option['type'] . '_callback', &nbsp;</div></li><li><div> ] : [ $this, 'missing_callback' ], &nbsp;</div></li><li><div>                  'gfpdf_settings_' . $tab, &nbsp;</div></li><li><div>                  'gfpdf_settings_' . $tab, &nbsp;</div></li><li><div>                  [&nbsp;</div></li><li><div>                      'id' =&gt; isset( $option['id'] ) ? $option['id'] : null, &nbsp;</div></li><li><div>                      'desc' =&gt; ! empty( $option['desc'] ) ? $option['desc'] : '', &nbsp;</div></li><li><div>                      'desc2' =&gt; ! empty( $option['desc2'] ) ? $option['desc2'] : '', &nbsp;</div></li><li><div>                      'type' =&gt; isset( $option['type'] ) ? $option['type'] : null, &nbsp;</div></li><li><div>                      'name' =&gt; isset( $option['name'] ) ? $option['name'] : null, &nbsp;</div></li><li><div>                      'size' =&gt; isset( $option['size'] ) ? $option['size'] : null, &nbsp;</div></li><li><div>                      'options' =&gt; isset( $option['options'] ) ? $option['options'] : '', &nbsp;</div></li><li><div>                      'std' =&gt; isset( $option['std'] ) ? $option['std'] : '', &nbsp;</div></li><li><div>                      'min' =&gt; isset( $option['min'] ) ? $option['min'] : null, &nbsp;</div></li><li><div>                      'max' =&gt; isset( $option['max'] ) ? $option['max'] : null, &nbsp;</div></li><li><div>                      'step' =&gt; isset( $option['step'] ) ? $option['step'] : null, &nbsp;</div></li><li><div>                      'chosen' =&gt; isset( $option['chosen'] ) ? $option['chosen'] : null, &nbsp;</div></li><li><div>                      'class' =&gt; isset( $option['class'] ) ? $option['class'] : null, &nbsp;</div></li><li><div>                      'inputClass' =&gt; isset( $option['inputClass'] ) ? $option['inputClass'] : null, &nbsp;</div></li><li><div>                      'placeholder' =&gt; isset( $option['placeholder'] ) ? $option['placeholder'] : null, &nbsp;</div></li><li><div>                      'tooltip' =&gt; isset( $option['tooltip'] ) ? $option['tooltip'] : null, &nbsp;</div></li><li><div>                      'multiple' =&gt; isset( $option['multiple'] ) ? $option['multiple'] : null, &nbsp;</div></li><li><div>                      'required' =&gt; isset( $option['required'] ) ? $option['required'] : null, &nbsp;</div></li><li><div>                      'uploaderTitle' =&gt; isset( $option['uploaderTitle'] ) ? $option['uploaderTitle'] : null, &nbsp;</div></li><li><div>                      'uploaderButtonText' =&gt; isset( $option['uploaderButtonText'] ) ? $option['uploaderButtonText'] : null, &nbsp;</div></li><li><div>                      'toggle' =&gt; isset( $option['toggle'] ) ? $option['toggle'] : null, &nbsp;</div></li><li><div>                      'data' =&gt; isset( $option['data'] ) ? $option['data'] : null, &nbsp;</div></li><li><div> ]&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Creates our settings in the options table */</span>&nbsp;</div></li><li><div>      register_setting( 'gfpdf_settings', 'gfpdf_settings', [ $this, 'settings_sanitize' ] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Update a current registered settings</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $group_id     The top-level group we're updating</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $setting_id   The section group we're updating</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $option_id    The option we are updating</span>&nbsp;</div></li><li><div><span class="comment">   * @param  mixed  $option_value The new option value</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean              True on success, false on failure</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function update_registered_field( $group_id, $setting_id, $option_id, $option_value ) {&nbsp;</div></li><li><div>      global $wp_settings_fields;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $group = 'gfpdf_settings_' . $group_id;&nbsp;</div></li><li><div>      $setting = &quot;gfpdf_settings[$setting_id]&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Check if our setting exists */</span>&nbsp;</div></li><li><div>      if ( isset( $wp_settings_fields[ $group ][ $group ][ $setting ]['args'][ $option_id ] ) ) {&nbsp;</div></li><li><div>          $wp_settings_fields[ $group ][ $group ][ $setting ]['args'][ $option_id ] = $option_value;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get Settings</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Retrieves all plugin settings</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array GFPDF settings</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_settings() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * We are storing temporary settings in a transient when validation fails.</span>&nbsp;</div></li><li><div><span class="comment">       * This allows us to keep track of the updated fields without updating main settings in the DB</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * We'll check if the transient exists and use it, otherwise get the main plugin settings from the options table</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $tmp_settings = get_transient( 'gfpdf_settings_user_data' );&nbsp;</div></li><li><div>      $is_temp = ( $tmp_settings !== false ) ? true : false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $is_temp ) {&nbsp;</div></li><li><div>          delete_transient( 'gfpdf_settings_user_data' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $settings = ( $is_temp ) ? (array) $tmp_settings : get_option( 'gfpdf_settings', [] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** See https://gravitypdf.com/documentation/v4/gfpdf_get_settings/ for more details about this filter */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'gfpdf_get_settings', $settings, $is_temp );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get form settings if on that page in the admin area (by having ID and PID set in the $_GET or $_POST variables)</span>&nbsp;</div></li><li><div><span class="comment">   * Use get_pdf( $form_id, $pdf_id ) if you want to get a particular PDF setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array The stored form settings</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_form_settings() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** get GF settings */</span>&nbsp;</div></li><li><div>      $form_id = ( ! empty( $_GET['id'] ) ) ? (int) rgget( 'id' ) : (int) rgpost( 'id' );&nbsp;</div></li><li><div>      $pid = ( ! empty( $_GET['pid'] ) ) ? rgget( 'pid' ) : rgpost( 'gform_pdf_id' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** return early if no ID set */</span>&nbsp;</div></li><li><div>      if ( ! $form_id || ! $pid ) {&nbsp;</div></li><li><div>          return [];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $settings = $this-&gt;get_pdf( $form_id, $pid );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! is_wp_error( $settings ) ) {&nbsp;</div></li><li><div>          <span class="comment">/** get the selected form settings */</span>&nbsp;</div></li><li><div>          return $settings;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;log-&gt;addError( 'Settings Retreival Error', [&nbsp;</div></li><li><div>          'form_id' =&gt; $form_id, &nbsp;</div></li><li><div>          'pid' =&gt; $pid, &nbsp;</div></li><li><div>          'WP_Error_Message' =&gt; $settings-&gt;get_error_message(), &nbsp;</div></li><li><div>          'WP_Error_Code' =&gt; $settings-&gt;get_error_code(), &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** there was an error */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return [];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get Form Settings</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Retrieves all form PDF settings</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param integer $form_id The Gravity Form ID</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array|WP_Error An array of GFPDF settings, or WP_Error</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_form_pdfs( $form_id ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! isset( $this-&gt;data-&gt;form_settings ) ) {&nbsp;</div></li><li><div>          $this-&gt;data-&gt;form_settings = [];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $form_id = (int) $form_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 0 === $form_id ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $error = new WP_Error( 'invalid_id', esc_html__( 'You must pass in a valid form ID', 'gravity-forms-pdf-extended' ) );&nbsp;</div></li><li><div>          $this-&gt;log-&gt;addError( 'Error Getting Settings.', [&nbsp;</div></li><li><div>              'WP_Error_Message' =&gt; $error-&gt;get_error_message(), &nbsp;</div></li><li><div>              'WP_Error_Code' =&gt; $error-&gt;get_error_code(), &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $error;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** If we haven't pulled the form meta data from the database do so now */</span>&nbsp;</div></li><li><div>      if ( ! isset( $this-&gt;data-&gt;form_settings[ $form_id ] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $form = $this-&gt;gform-&gt;get_form( $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( $form ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $error = new WP_Error( 'invalid_id', esc_html__( 'You must pass in a valid form ID', 'gravity-forms-pdf-extended' ) );&nbsp;</div></li><li><div>              $this-&gt;log-&gt;addError( 'Error Getting Settings.', [&nbsp;</div></li><li><div>                  'WP_Error_Message' =&gt; $error-&gt;get_error_message(), &nbsp;</div></li><li><div>                  'WP_Error_Code' =&gt; $error-&gt;get_error_code(), &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $error;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Pull the settings from the $form object, if they exist */</span>&nbsp;</div></li><li><div>          $settings = ( isset( $form['gfpdf_form_settings'] ) ) ? $form['gfpdf_form_settings'] : [];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;data-&gt;form_settings[ $form_id ] = $settings;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** return the form meta data */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $this-&gt;data-&gt;form_settings[ $form_id ];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get pdf config</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Looks to see if the specified setting exists, returns default if not</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param integer $form_id The Gravity Form ID</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $pdf_id  The Gravity Form PDF ID</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array|WP_Error</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_pdf( $form_id, $pdf_id ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;log-&gt;addNotice( 'Getting Settings.', [&nbsp;</div></li><li><div>          'form_id' =&gt; $form_id, &nbsp;</div></li><li><div>          'pdf_id' =&gt; $pdf_id, &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $gfpdf_options = $this-&gt;get_form_pdfs( $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! is_wp_error( $gfpdf_options ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Get our PDF array if it exists */</span>&nbsp;</div></li><li><div>          $pdf = ! empty( $gfpdf_options[ $pdf_id ] ) ? $gfpdf_options[ $pdf_id ] : new WP_Error( 'invalid_pdf_id', esc_html__( 'You must pass in a valid PDF ID', 'gravity-forms-pdf-extended' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! is_wp_error( $pdf ) ) {&nbsp;</div></li><li><div>              <span class="comment">/** See https://gravitypdf.com/documentation/v4/gfpdf_pdf_config/ for more details about these filters */</span>&nbsp;</div></li><li><div>              $pdf = apply_filters( 'gfpdf_pdf_config', $pdf, $form_id );&nbsp;</div></li><li><div>              $pdf = apply_filters( 'gfpdf_pdf_config_' . $form_id, $pdf, $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $pdf;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** return WP_Error */</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $pdf;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">/** return WP_Error */</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $gfpdf_options;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Create a new PDF configuration option for that form</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param integer $form_id The form ID</span>&nbsp;</div></li><li><div><span class="comment">   * @param array   $pdf     The settings array</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function add_pdf( $form_id, $pdf = [] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;log-&gt;addNotice( 'Adding Settings.', [&nbsp;</div></li><li><div>          'form_id' =&gt; $form_id, &nbsp;</div></li><li><div>          'new_settings' =&gt; $pdf, &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment">/** First let's grab the current settings */</span></span></span></span>&nbsp;</div></li><li><div>      $options = $this-&gt;get_form_pdfs( $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! is_wp_error( $options ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** check the ID, if any */</span>&nbsp;</div></li><li><div>          $pdf['id'] = ( isset( $pdf['id'] ) ) ? $pdf['id'] : uniqid();&nbsp;</div></li><li><div>          $pdf['active'] = ( isset( $pdf['active'] ) ) ? $pdf['active'] : true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** See https://gravitypdf.com/documentation/v4/gfpdf_form_add_pdf/ for more details about these filters */</span>&nbsp;</div></li><li><div>          $pdf = apply_filters( 'gfpdf_form_add_pdf', $pdf, $form_id );&nbsp;</div></li><li><div>          $pdf = apply_filters( 'gfpdf_form_add_pdf_' . $form_id, $pdf, $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $results = $this-&gt;update_pdf( $form_id, $pdf['id'], $pdf, true, false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $results ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/** return the ID if successful */</span>&nbsp;</div></li><li><div>              $this-&gt;log-&gt;addNotice( 'Successfuly Added.', [&nbsp;</div></li><li><div>                  'pdf' =&gt; $pdf, &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $pdf['id'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;log-&gt;addError( 'Error Saving.', [&nbsp;</div></li><li><div>              'error' =&gt; $results, &nbsp;</div></li><li><div>              'pdf' =&gt; $pdf, &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Update an pdf config</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Updates a Gravity PDF setting value in both the db and the global variable.</span>&nbsp;</div></li><li><div><span class="comment">   * Warning: Passing in an empty, false or null string value will remove</span>&nbsp;</div></li><li><div><span class="comment">   *          the key from the gfpdf_options array.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since    4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param integer         $form_id   The Gravity Form ID</span>&nbsp;</div></li><li><div><span class="comment">   * @param string          $pdf_id    The PDF Setting ID</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool|int|string $pdf       The PDF settings array</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool            $update_db Whether we should just update the local PDF settings array, or update the DB as well</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool            $filters   Whether we should apply the update filters</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool True if updated, false if not.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function update_pdf( $form_id, $pdf_id, $pdf = '', $update_db = true, $filters = true ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;log-&gt;addNotice( 'Updating Settings.', [&nbsp;</div></li><li><div>          'form_id' =&gt; $form_id, &nbsp;</div></li><li><div>          'pdf_id' =&gt; $pdf_id, &nbsp;</div></li><li><div>          'new_settings' =&gt; $pdf, &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $pdf ) || ! is_array( $pdf ) || sizeof( $pdf ) == 0 ) {&nbsp;</div></li><li><div>          <span class="comment">/** No value was passed in so we will delete the PDF */</span>&nbsp;</div></li><li><div>          $remove_option = $this-&gt;delete_pdf( $form_id, $pdf_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $remove_option;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment">/** First let's grab the current settings */</span></span></span></span>&nbsp;</div></li><li><div>      $options = $this-&gt;get_form_pdfs( $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! is_wp_error( $options ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Don't run when adding a new PDF */</span>&nbsp;</div></li><li><div>          if ( $filters ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;log-&gt;addNotice( 'Trigger Filters.' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/** See https://gravitypdf.com/documentation/v4/gfpdf_form_update_pdf/ for more details about these filters */</span>&nbsp;</div></li><li><div>              $pdf = apply_filters( 'gfpdf_form_update_pdf', $pdf, $form_id, $pdf_id );&nbsp;</div></li><li><div>              $pdf = apply_filters( 'gfpdf_form_update_pdf_' . $form_id, $pdf, $form_id, $pdf_id );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment">/** Next let's try to update the value */</span></span></span>&nbsp;</div></li><li><div>          $options[ $pdf_id ] = $pdf;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** get the up-to-date form object and merge in the results */</span>&nbsp;</div></li><li><div>          $form = $this-&gt;gform-&gt;get_form( $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** Update our GFPDF settings */</span></span>&nbsp;</div></li><li><div>          $form['gfpdf_form_settings'] = $options;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $did_update = false;&nbsp;</div></li><li><div>          if ( $update_db ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;log-&gt;addNotice( 'Update Form.', [&nbsp;</div></li><li><div>                  'form_id' =&gt; $form['id'], &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/** Update the database, if able */</span>&nbsp;</div></li><li><div>              $did_update = $this-&gt;gform-&gt;update_form( $form );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! $update_db || $did_update !== false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/** If it updated successfully let's update the global variable */</span>&nbsp;</div></li><li><div>              $this-&gt;log-&gt;addNotice( 'Save Local Form Cache.' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;data-&gt;form_settings[ $form_id ] = $options;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** true if successful, false if failed */</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $did_update;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Remove an option</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Removes an Gravity PDF setting value in both the db and the global variable.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since    4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param integer $form_id The Gravity Form ID</span>&nbsp;</div></li><li><div><span class="comment">   * @param string  $pdf_id  The Gravity Form PDF ID</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool True if updated, false if not.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function delete_pdf( $form_id, $pdf_id ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;log-&gt;addNotice( 'Deleting Setting.', [&nbsp;</div></li><li><div>          'form_id' =&gt; $form_id, &nbsp;</div></li><li><div>          'pdf_id' =&gt; $pdf_id, &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment">/** First let's grab the current settings */</span></span></span></span>&nbsp;</div></li><li><div>      $options = $this-&gt;get_form_pdfs( $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! is_wp_error( $options ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment">/** Next let's try to update the value */</span></span></span>&nbsp;</div></li><li><div>          if ( isset( $options[ $pdf_id ] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;log-&gt;addNotice( 'Found Setting. Now deleting...', [&nbsp;</div></li><li><div>                  'pdf' =&gt; $options[ $pdf_id ], &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              unset( $options[ $pdf_id ] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** get the form and merge in the results */</span>&nbsp;</div></li><li><div>          $form = $this-&gt;gform-&gt;get_form( $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** Update our GFPDF settings */</span></span>&nbsp;</div></li><li><div>          $form['gfpdf_form_settings'] = $options;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** update the database, if able */</span>&nbsp;</div></li><li><div>          $did_update = $this-&gt;gform-&gt;update_form( $form );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** If it updated, let's update the global variable */</span></span>&nbsp;</div></li><li><div>          if ( $did_update !== false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;log-&gt;addNotice( 'Setting Deleted.', [&nbsp;</div></li><li><div>                  'form_id' =&gt; $form_id, &nbsp;</div></li><li><div>                  'pdf_id' =&gt; $pdf_id, &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;data-&gt;form_settings[ $form_id ] = $options;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">/** true if successful, false if failed */</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $did_update;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;log-&gt;addError( 'PDF Delete Failed.', [&nbsp;</div></li><li><div>          'form_id' =&gt; $form_id, &nbsp;</div></li><li><div>          'pdf_id' =&gt; $pdf_id, &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get a global setting option</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Looks to see if the specified setting exists, returns default if not</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $key     The options key to get</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool   $default The default option value if the key isn't found</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_option( $key = '', $default = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $gfpdf_options = $this-&gt;settings;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $value = ( ! empty( $gfpdf_options[ $key ] ) ) ? $gfpdf_options[ $key ] : $default;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** See https://gravitypdf.com/documentation/v4/gfpdf_get_option/ for more details about these filters */</span>&nbsp;</div></li><li><div>      $value = apply_filters( 'gfpdf_get_option', $value, $key, $default );&nbsp;</div></li><li><div>      $value = apply_filters( 'gfpdf_get_option_' . $key, $value, $key, $default );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $value;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Update a global setting option</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Updates a Gravity PDF setting value in both the db and the global variable.</span>&nbsp;</div></li><li><div><span class="comment">   * Warning: Passing in an empty, false or null string value will remove</span>&nbsp;</div></li><li><div><span class="comment">   *          the key from the gfpdf_options array.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string          $key   The Key to update</span>&nbsp;</div></li><li><div><span class="comment">   * @param string|bool|int $value The value to set the key to</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean True if updated, false if not.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function update_option( $key = '', $value = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $key ) ) {&nbsp;</div></li><li><div>          $this-&gt;log-&gt;addError( 'Option Update Error', [&nbsp;</div></li><li><div>              'key' =&gt; $key, &nbsp;</div></li><li><div>              'value' =&gt; $value, &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $value ) ) {&nbsp;</div></li><li><div>          $remove_option = $this-&gt;delete_option( $key );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $remove_option;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment">/** First let's grab the current settings */</span></span></span></span>&nbsp;</div></li><li><div>      $options = get_option( 'gfpdf_settings', [] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** See https://gravitypdf.com/documentation/v4/gfpdf_update_option/ for more details about these filters */</span>&nbsp;</div></li><li><div>      $value = apply_filters( 'gfpdf_update_option', $value, $key );&nbsp;</div></li><li><div>      $value = apply_filters( 'gfpdf_update_option_' . $key, $value, $key );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Disable default sanitization (it shouldn't be triggered through this method) */</span>&nbsp;</div></li><li><div>      remove_filter( 'sanitize_option_gfpdf_settings', [ $this, 'settings_sanitize' ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">/** Next let's try to update the value */</span></span></span>&nbsp;</div></li><li><div>      $options[ $key ] = $value;&nbsp;</div></li><li><div>      $did_update = update_option( 'gfpdf_settings', $options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Re-enable sanitization */</span>&nbsp;</div></li><li><div>      add_filter( 'sanitize_option_gfpdf_settings', [ $this, 'settings_sanitize' ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">/** If it updated, let's update the global variable */</span></span>&nbsp;</div></li><li><div>      if ( $did_update ) {&nbsp;</div></li><li><div>          $this-&gt;settings[ $key ] = $value;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $did_update;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Remove a global setting option</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Removes an Gravity PDF setting value in both the db and the global variable.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $key The Key to delete</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean True if updated, false if not.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function delete_option( $key = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $key ) ) {&nbsp;</div></li><li><div>          $this-&gt;log-&gt;addError( 'Option Delete Error' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// First let's grab the current settings</span>&nbsp;</div></li><li><div>      $options = get_option( 'gfpdf_settings', [] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Next let's try to update the value</span>&nbsp;</div></li><li><div>      if ( isset( $options[ $key ] ) ) {&nbsp;</div></li><li><div>          unset( $options[ $key ] );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $did_update = update_option( 'gfpdf_settings', $options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $did_update ) {&nbsp;</div></li><li><div>          $this-&gt;settings = $options;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $did_update;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get a list of user capabilities</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array The array of roles available</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_capabilities() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** sort through all roles and fetch unique capabilities */</span>&nbsp;</div></li><li><div>      $roles = get_editable_roles();&nbsp;</div></li><li><div>      $capabilities = [];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Add Gravity Forms Capabilities */</span>&nbsp;</div></li><li><div>      $gf_caps = $this-&gt;gform-&gt;get_capabilities();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $gf_caps as $gf_cap ) {&nbsp;</div></li><li><div>          $capabilities[ esc_html__( 'Gravity Forms Capabilities', 'gravity-forms-pdf-extended' ) ][ $gf_cap ] = $gf_cap;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $roles as $role ) {&nbsp;</div></li><li><div>          if ( isset( $role['capabilities'] ) && is_array( $role['capabilities'] ) ) {&nbsp;</div></li><li><div>              foreach ( $role['capabilities'] as $cap =&gt; $val ) {&nbsp;</div></li><li><div>                  if ( ! isset( $capabilities[ $cap ] ) && ! in_array( $cap, $gf_caps ) ) {&nbsp;</div></li><li><div>                      $capabilities[ esc_html__( 'Active WordPress Capabilities', 'gravity-forms-pdf-extended' ) ][ $cap ] = $cap;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** sort alphabetically */</span>&nbsp;</div></li><li><div>      foreach ( $capabilities as &$val ) {&nbsp;</div></li><li><div>          ksort( $val );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** See https://gravitypdf.com/documentation/v4/gfpdf_capabilities/ for more details about this filter */</span>&nbsp;</div></li><li><div>      return apply_filters( 'gfpdf_capabilities', $capabilities );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return our paper size</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array The array of paper sizes available</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_paper_size() {&nbsp;</div></li><li><div>      return apply_filters( 'gfpdf_get_paper_size', [&nbsp;</div></li><li><div>          esc_html__( 'Common Sizes', 'gravity-forms-pdf-extended' ) =&gt; [&nbsp;</div></li><li><div>              'A4' =&gt; esc_html__( 'A4 (210 x 297mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'LETTER' =&gt; esc_html__( 'Letter (8.5 x 11in)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'LEGAL' =&gt; esc_html__( 'Legal (8.5 x 14in)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'LEDGER' =&gt; esc_html__( 'Ledger / Tabloid (11 x 17in)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'EXECUTIVE' =&gt; esc_html__( 'Executive (7 x 10in)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'CUSTOM' =&gt; esc_html__( 'Custom Paper Size', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div> ], &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          esc_html__( '&quot;A&quot; Sizes', 'gravity-forms-pdf-extended' ) =&gt; [&nbsp;</div></li><li><div>              'A0' =&gt; esc_html__( 'A0 (841 x 1189mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'A1' =&gt; esc_html__( 'A1 (594 x 841mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'A2' =&gt; esc_html__( 'A2 (420 x 594mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'A3' =&gt; esc_html__( 'A3 (297 x 420mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'A5' =&gt; esc_html__( 'A5 (210 x 297mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'A6' =&gt; esc_html__( 'A6 (105 x 148mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'A7' =&gt; esc_html__( 'A7 (74 x 105mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'A8' =&gt; esc_html__( 'A8 (52 x 74mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'A9' =&gt; esc_html__( 'A9 (37 x 52mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'A10' =&gt; esc_html__( 'A10 (26 x 37mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div> ], &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          esc_html__( '&quot;B&quot; Sizes', 'gravity-forms-pdf-extended' ) =&gt; [&nbsp;</div></li><li><div>              'B0' =&gt; esc_html__( 'B0 (1414 x 1000mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'B1' =&gt; esc_html__( 'B1 (1000 x 707mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'B2' =&gt; esc_html__( 'B2 (707 x 500mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'B3' =&gt; esc_html__( 'B3 (500 x 353mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'B4' =&gt; esc_html__( 'B4 (353 x 250mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'B5' =&gt; esc_html__( 'B5 (250 x 176mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'B6' =&gt; esc_html__( 'B6 (176 x 125mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'B7' =&gt; esc_html__( 'B7 (125 x 88mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'B8' =&gt; esc_html__( 'B8 (88 x 62mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'B9' =&gt; esc_html__( 'B9 (62 x 44mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'B10' =&gt; esc_html__( 'B10 (44 x 31mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div> ], &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          esc_html__( '&quot;C&quot; Sizes', 'gravity-forms-pdf-extended' ) =&gt; [&nbsp;</div></li><li><div>              'C0' =&gt; esc_html__( 'C0 (1297 x 917mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'C1' =&gt; esc_html__( 'C1 (917 x 648mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'C2' =&gt; esc_html__( 'C2 (648 x 458mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'C3' =&gt; esc_html__( 'C3 (458 x 324mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'C4' =&gt; esc_html__( 'C4 (324 x 229mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'C5' =&gt; esc_html__( 'C5 (229 x 162mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'C6' =&gt; esc_html__( 'C6 (162 x 114mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'C7' =&gt; esc_html__( 'C7 (114 x 81mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'C8' =&gt; esc_html__( 'C8 (81 x 57mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'C9' =&gt; esc_html__( 'C9 (57 x 40mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'C10' =&gt; esc_html__( 'C10 (40 x 28mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div> ], &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          esc_html__( '&quot;RA&quot; and &quot;SRA&quot; Sizes', 'gravity-forms-pdf-extended' ) =&gt; [&nbsp;</div></li><li><div>              'RA0' =&gt; esc_html__( 'RA0 (860 x 1220mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'RA1' =&gt; esc_html__( 'RA1 (610 x 860mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'RA2' =&gt; esc_html__( 'RA2 (430 x 610mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'RA3' =&gt; esc_html__( 'RA3 (305 x 430mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'RA4' =&gt; esc_html__( 'RA4 (215 x 305mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'SRA0' =&gt; esc_html__( 'SRA0 (900 x 1280mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'SRA1' =&gt; esc_html__( 'SRA1 (640 x 900mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'SRA2' =&gt; esc_html__( 'SRA2 (450 x 640mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'SRA3' =&gt; esc_html__( 'SRA3 (320 x 450mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>              'SRA4' =&gt; esc_html__( 'SRA4 (225 x 320mm)', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div> ], &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Parse our installed font files</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array The array of fonts</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_installed_fonts() {&nbsp;</div></li><li><div>      $fonts = [&nbsp;</div></li><li><div>          esc_html__( 'Unicode', 'gravity-forms-pdf-extended' ) =&gt; [&nbsp;</div></li><li><div>              'dejavusanscondensed' =&gt; 'Dejavu Sans Condensed', &nbsp;</div></li><li><div>              'dejavusans' =&gt; 'Dejavu Sans', &nbsp;</div></li><li><div>              'dejavuserifcondensed' =&gt; 'Dejavu Serif Condensed', &nbsp;</div></li><li><div>              'dejavuserif' =&gt; 'Dejavu Serif', &nbsp;</div></li><li><div>              'dejavusansmono' =&gt; 'Dejavu Sans Mono', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              'freesans' =&gt; 'Free Sans', &nbsp;</div></li><li><div>              'freeserif' =&gt; 'Free Serif', &nbsp;</div></li><li><div>              'freemono' =&gt; 'Free Mono', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              'mph2bdamase' =&gt; 'MPH 2B Damase', &nbsp;</div></li><li><div> ], &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          esc_html__( 'Indic', 'gravity-forms-pdf-extended' ) =&gt; [&nbsp;</div></li><li><div>              'lohitkannada' =&gt; 'Lohit Kannada', &nbsp;</div></li><li><div>              'pothana2000' =&gt; 'Pothana2000', &nbsp;</div></li><li><div> ], &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          esc_html__( 'Arabic', 'gravity-forms-pdf-extended' ) =&gt; [&nbsp;</div></li><li><div>              'xbriyaz' =&gt; 'XB Riyaz', &nbsp;</div></li><li><div>              'lateef' =&gt; 'Lateef', &nbsp;</div></li><li><div>              'kfgqpcuthmantahanaskh' =&gt; 'Bahif Uthman Taha', &nbsp;</div></li><li><div> ], &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          esc_html__( 'Other', 'gravity-forms-pdf-extended' ) =&gt; [&nbsp;</div></li><li><div>              'estrangeloedessa' =&gt; 'Estrangelo Edessa (Syriac)', &nbsp;</div></li><li><div>              'kaputaunicode' =&gt; 'Kaputa (Sinhala)', &nbsp;</div></li><li><div>              'abyssinicasil' =&gt; 'Abyssinica SIL (Ethiopic)', &nbsp;</div></li><li><div>              'aboriginalsans' =&gt; 'Aboriginal Sans (Cherokee / Canadian)', &nbsp;</div></li><li><div>              'jomolhari' =&gt; 'Jomolhari (Tibetan)', &nbsp;</div></li><li><div>              'sundaneseunicode' =&gt; 'Sundanese (Sundanese)', &nbsp;</div></li><li><div>              'taiheritagepro' =&gt; 'Tai Heritage Pro (Tai Viet)', &nbsp;</div></li><li><div>              'aegean' =&gt; 'Aegean (Greek)', &nbsp;</div></li><li><div>              'quivira' =&gt; 'Quivira (Greek)', &nbsp;</div></li><li><div>              'eeyekunicode' =&gt; 'Eeyek (Meetei Mayek)', &nbsp;</div></li><li><div>              'lannaalif' =&gt; 'Lanna Alif (Tai Tham)', &nbsp;</div></li><li><div>              'daibannasilbook' =&gt; 'Dai Banna SIL (New Tai Lue)', &nbsp;</div></li><li><div>              'garuda' =&gt; 'Garuda (Thai)', &nbsp;</div></li><li><div>              'khmeros' =&gt; 'Khmer OS (Khmer)', &nbsp;</div></li><li><div>              'dhyana' =&gt; 'Dhyana (Lao)', &nbsp;</div></li><li><div>              'tharlon' =&gt; 'TharLon (Myanmar / Burmese)', &nbsp;</div></li><li><div>              'padaukbook' =&gt; 'Padauk Book (Myanmar / Burmese)', &nbsp;</div></li><li><div>              'zawgyi-one' =&gt; 'Zawgyi One (Myanmar / Burmese)', &nbsp;</div></li><li><div>              'ayar' =&gt; 'Ayar Myanmar (Myanmar / Burmese)', &nbsp;</div></li><li><div>              'taameydavidclm' =&gt; 'Taamey David CLM (Hebrew)', &nbsp;</div></li><li><div> ], &nbsp;</div></li><li><div> ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $fonts = $this-&gt;add_custom_fonts( $fonts );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'gfpdf_font_list', $fonts );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * If any custom fonts add them to our font list</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $fonts Current font list</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array The list of custom fonts installed in a preformatted array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function add_custom_fonts( $fonts = [] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $custom_fonts = $this-&gt;get_custom_fonts();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( sizeof( $custom_fonts ) &gt; 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $user_defined_fonts = [];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Loop through our fonts and assign them to a new array in the appropriate format */</span>&nbsp;</div></li><li><div>          foreach ( $custom_fonts as $font ) {&nbsp;</div></li><li><div>              $user_defined_fonts[ $font['shortname'] ] = $font['font_name'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Merge the new fonts at the beginning of the $fonts array */</span>&nbsp;</div></li><li><div>          $fonts = $this-&gt;misc-&gt;array_unshift_assoc( $fonts, esc_html__( 'User-Defined Fonts', 'gravity-forms-pdf-extended' ), $user_defined_fonts );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $fonts;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get a list of the custom fonts installed</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_custom_fonts() {&nbsp;</div></li><li><div>      $fonts = $this-&gt;get_option( 'custom_fonts' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_array( $fonts ) && sizeof( $fonts ) &gt; 0 ) {&nbsp;</div></li><li><div>          foreach ( $fonts as &$font ) {&nbsp;</div></li><li><div>              $font['shortname'] = $this-&gt;get_font_short_name( $font['font_name'] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $fonts;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return [];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get font shortname we can use an in array</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $name The font name to convert</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string       Shortname of font</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_font_short_name( $name ) {&nbsp;</div></li><li><div>      return mb_strtolower( str_replace( ' ', '', $name ), 'UTF-8' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the font's display name from the font key</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string $font_key The font key to search for</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return mixed (String / Object)           The font display name or WP_Error</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_font_display_name( $font_key ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $this-&gt;get_installed_fonts() as $groups ) {&nbsp;</div></li><li><div>          if ( isset( $groups[ $font_key ] ) ) {&nbsp;</div></li><li><div>              return $groups[ $font_key ];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return new WP_Error( 'font_not_found', esc_html__( 'Could not find Gravity PDF Font' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Parse our PDF privilages</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array The array of privilages</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_privilages() {&nbsp;</div></li><li><div>      $privilages = [&nbsp;</div></li><li><div>          'copy' =&gt; esc_html__( 'Copy', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>          'print' =&gt; esc_html__( 'Print - Low Resolution', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>          'print-highres' =&gt; esc_html__( 'Print - High Resolution', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>          'modify' =&gt; esc_html__( 'Modify', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>          'annot-forms' =&gt; esc_html__( 'Annotate', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>          'fill-forms' =&gt; esc_html__( 'Fill Forms', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>          'extract' =&gt; esc_html__( 'Extract', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>          'assemble' =&gt; esc_html__( 'Assemble', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div> ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'gfpdf_privilages_list', $privilages );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Increment the PDF Generation Counter</span>&nbsp;</div></li><li><div><span class="comment">   * To decrease load on the database we'll increment by 10 after a rand() function matches</span>&nbsp;</div></li><li><div><span class="comment">   * This is less accurate but we only need a rough guesstimation to prompt the user</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function increment_pdf_count() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $rand = rand( 1, 10 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 10 === $rand ) {&nbsp;</div></li><li><div>          $total_pdf_count = (int) $this-&gt;get_option( 'pdf_count', 0 );&nbsp;</div></li><li><div>          $total_pdf_count += 10;&nbsp;</div></li><li><div>          $this-&gt;update_option( 'pdf_count', $total_pdf_count );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Settings Sanitization</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Adds a settings error (for the updated message)</span>&nbsp;</div></li><li><div><span class="comment">   * Run on admin options.php page</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $input The value inputted in the field</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string $input Sanitizied value</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function settings_sanitize( $input = [] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $gfpdf_options = $this-&gt;settings;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $_POST['_wp_http_referer'] ) || empty( $_POST['option_page'] ) || $_POST['option_page'] != 'gfpdf_settings' ) {&nbsp;</div></li><li><div>          return $input;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      parse_str( $_POST['_wp_http_referer'], $referrer );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $all_settings = $this-&gt;get_registered_fields();&nbsp;</div></li><li><div>      $tab = isset( $referrer['tab'] ) ? $referrer['tab'] : 'general';&nbsp;</div></li><li><div>      $settings = ( ! empty( $all_settings[ $tab ] ) && $tab !== 'tools' ) ? $all_settings[ $tab ] : [];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Get all setting types</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $tab_len = strlen( $tab );&nbsp;</div></li><li><div>      foreach ( $all_settings as $id =&gt; $s ) {&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Check if extra item(s) belongs on page but isn't the existing page</span>&nbsp;</div></li><li><div><span class="comment">           * Note that this requires the section ID share a similar ID to what is referenced in $tab</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          if ( $tab != $id && $tab == substr( $id, 0, $tab_len ) ) {&nbsp;</div></li><li><div>              $settings = array_merge( $settings, $s );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $input = $input ? $input : [];&nbsp;</div></li><li><div>      $input = apply_filters( 'gfpdf_settings_' . $tab . '_sanitize', $input );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Loop through the settings whitelist and add any missing required fields to the $input</span>&nbsp;</div></li><li><div><span class="comment">       * Prevalant with Select boxes</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      foreach ( $settings as $key =&gt; $value ) {&nbsp;</div></li><li><div>          if ( isset( $value['required'] ) && $value['required'] ) {&nbsp;</div></li><li><div>              switch ( $value['type'] ) {&nbsp;</div></li><li><div>                  case 'select':&nbsp;</div></li><li><div>                      if ( ! isset( $input[ $key ] ) ) {&nbsp;</div></li><li><div>                          $input[ $key ] = [];&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  default:&nbsp;</div></li><li><div>                      if ( ! isset( $input[ $key ] ) ) {&nbsp;</div></li><li><div>                          $input[ $key ] = '';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Loop through each setting being saved and pass it through a sanitization filter */</span>&nbsp;</div></li><li><div>      foreach ( $input as $key =&gt; $value ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Check if the input is apart of our whitelist, otherwise remove */</span>&nbsp;</div></li><li><div>          if ( ! isset( $settings[ $key ] ) ) {&nbsp;</div></li><li><div>              unset( $input[ $key ] );&nbsp;</div></li><li><div>              continue;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** Get the setting type (checkbox, select, etc) */</span>&nbsp;</div></li><li><div>          $type = isset( $settings[ $key ]['type'] ) ? $settings[ $key ]['type'] : false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * General filter</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * See https://gravitypdf.com/documentation/v4/gfpdf_settings_sanitize/ for more details about this filter</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          $input[ $key ] = apply_filters( 'gfpdf_settings_sanitize', $input[ $key ], $key, $input, $settings[ $key ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $type ) {&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Field type specific filter</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * See https://gravitypdf.com/documentation/v4/gfpdf_settings_sanitize/ for more details about this filter</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $input[ $key ] = apply_filters( 'gfpdf_settings_sanitize_' . $type, $value, $key, $input, $settings[ $key ] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** check for errors */</span>&nbsp;</div></li><li><div>      if ( count( get_settings_errors() ) === 0 ) {&nbsp;</div></li><li><div>          <span class="comment">/** Merge our new settings with the existing */</span>&nbsp;</div></li><li><div>          $output = array_merge( $gfpdf_options, $input );&nbsp;</div></li><li><div>          add_settings_error( 'gfpdf-notices', '', esc_html__( 'Settings updated.', 'gravity-forms-pdf-extended' ), 'updated' );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          <span class="comment">/** error is thrown. store the user data in a transient so fields are remembered */</span>&nbsp;</div></li><li><div>          set_transient( 'gfpdf_settings_user_data', array_merge( $gfpdf_options, $input ), 30 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** return nothing */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return [];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $output;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Sanitize text / textarea fields</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $input The field value</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string $input Sanitizied value</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function sanitize_trim_field( $input ) {&nbsp;</div></li><li><div>      return trim( $input );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Sanitize number fields</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $input The field value</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string $input Sanitizied value</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function sanitize_number_field( $input ) {&nbsp;</div></li><li><div>      return (integer) $input;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Converts negative numbers to positive numbers</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array $input The unsanitized paper size</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array        The sanitized paper size</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function sanitize_paper_size( $input ) {&nbsp;</div></li><li><div>      if ( is_array( $input ) && sizeof( $input ) == 3 ) {&nbsp;</div></li><li><div>          $input[0] = abs( $input[0] );&nbsp;</div></li><li><div>          $input[1] = abs( $input[1] );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $input;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Sanitize all fields depending on type</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param mixed  $value    The field's user input value</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $key      The settings key</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $input    All user fields</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $settings The field settings</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string $input Sanitizied value</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function sanitize_all_fields( $value, $key, $input, $settings ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! isset( $settings['type'] ) ) {&nbsp;</div></li><li><div>          $settings['type'] = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      switch ( $settings['type'] ) {&nbsp;</div></li><li><div>          case 'rich_editor':&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Don't do any sanitization on input, which was causing problems with merge tags in HTML attributes.</span>&nbsp;</div></li><li><div><span class="comment">               * See https://github.com/GravityPDF/gravity-pdf/issues/492 for more details.</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @internal Devs should run the field through wp_kses_post() on output to correctly sanitize</span>&nbsp;</div></li><li><div><span class="comment">               * @since 4.0.6</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              return $value;&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'textarea':&nbsp;</div></li><li><div>              return wp_kses_post( $value );&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** treat as plain text */</span>&nbsp;</div></li><li><div>          default:&nbsp;</div></li><li><div>              if ( is_array( $value ) ) {&nbsp;</div></li><li><div>                  array_walk_recursive( $value, function ( &$item ) {&nbsp;</div></li><li><div>                      $item = wp_strip_all_tags( $item );&nbsp;</div></li><li><div>                  } );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  return $value;&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  return wp_strip_all_tags( $value );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Sanitize all required fields</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param mixed  $value    The field's user input value</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $key      The settings key</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $input    All user fields</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $settings The field settings</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string $input Sanitizied value</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function sanitize_required_field( $value, $key, $input, $settings ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $settings['required'] ) && $settings['required'] === true ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          switch ( $settings['type'] ) {&nbsp;</div></li><li><div>              case 'select':&nbsp;</div></li><li><div>              case 'multicheck':&nbsp;</div></li><li><div>                  $size = count( $value );&nbsp;</div></li><li><div>                  if ( empty( $value ) || sizeof( array_filter( $value ) ) !== $size ) {&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment">/** throw error */</span></span></span>&nbsp;</div></li><li><div>                      add_settings_error( 'gfpdf-notices', $key, esc_html__( 'PDF Settings could not be saved. Please enter all required information below.', 'gravity-forms-pdf-extended' ) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              case 'paper_size':&nbsp;</div></li><li><div>                  if ( isset( $input['default_pdf_size'] ) && $input['default_pdf_size'] === 'CUSTOM' ) {&nbsp;</div></li><li><div>                      if ( sizeof( array_filter( $value ) ) !== 3 ) {&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment"><span class="comment">/** throw error */</span></span></span>&nbsp;</div></li><li><div>                          add_settings_error( 'gfpdf-notices', $key, esc_html__( 'PDF Settings could not be saved. Please enter all required information below.', 'gravity-forms-pdf-extended' ) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              default:&nbsp;</div></li><li><div>                  if ( strlen( trim( $value ) ) === 0 ) {&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment">/** throw error */</span></span></span>&nbsp;</div></li><li><div>                      add_settings_error( 'gfpdf-notices', $key, esc_html__( 'PDF Settings could not be saved. Please enter all required information below.', 'gravity-forms-pdf-extended' ) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $value;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Gets the correct option value based on the field type</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array $args The field articles</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return String       The current value for that particular field</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  4.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_form_value( $args = [] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** If callback method called directly (and not through the Settings API) */</span>&nbsp;</div></li><li><div>      if ( isset( $args['value'] ) ) {&nbsp;</div></li><li><div>          return $args['value'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Get our global Gravity PDF Settings */</span>&nbsp;</div></li><li><div>      $options = $this-&gt;settings;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Get our PDF GF settings (if any) */</span>&nbsp;</div></li><li><div>      $pdf_form_settings = $this-&gt;get_form_settings();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! isset( $args['type'] ) ) {&nbsp;</div></li><li><div>          $args['type'] = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Fix up our conditional logic array so it returns a string value */</span>&nbsp;</div></li><li><div>      if ( $args['id'] == 'conditionalLogic' && isset( $pdf_form_settings['conditionalLogic'] ) ) {&nbsp;</div></li><li><div>          $pdf_form_settings['conditionalLogic'] = json_encode( $pdf_form_settings['conditionalLogic'] );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      switch ( $args['type'] ) {&nbsp;</div></li><li><div>          case 'checkbox':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset( $options[ $args['id'] ] ) ) {&nbsp;</div></li><li><div>                  return checked( 1, $options[ $args['id'] ], false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } elseif ( isset( $pdf_form_settings[ $args['id'] ] ) ) {&nbsp;</div></li><li><div>                  return checked( 1, $pdf_form_settings[ $args['id'] ], false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } elseif ( $args['std'] === true ) {&nbsp;</div></li><li><div>                  return checked( 1, 1, false );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'multicheck':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset( $options[ $args['id'] ][ $args['multi-key'] ] ) ) {&nbsp;</div></li><li><div>                  return $args['multi-option'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } elseif ( isset( $pdf_form_settings[ $args['id'] ][ $args['multi-key'] ] ) ) {&nbsp;</div></li><li><div>                  return $args['multi-option'];&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'radio':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset( $options[ $args['id'] ] ) && isset( $args['options'][ $options[ $args['id'] ] ] ) ) {&nbsp;</div></li><li><div>                  return $options[ $args['id'] ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } elseif ( isset( $pdf_form_settings[ $args['id'] ] ) && isset( $args['options'][ $pdf_form_settings[ $args['id'] ] ] ) ) {&nbsp;</div></li><li><div>                  return $pdf_form_settings[ $args['id'] ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } elseif ( isset( $args['std'] ) && isset( $args['std'] ) ) {&nbsp;</div></li><li><div>                  return $args['std'];&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'password':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( isset( $options[ $args['id'] ] ) ) {&nbsp;</div></li><li><div>                  return trim( $options[ $args['id'] ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } elseif ( isset( $pdf_form_settings[ $args['id'] ] ) ) {&nbsp;</div></li><li><div>                  return trim( $pdf_form_settings[ $args['id'] ] );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'select':&nbsp;</div></li><li><div>          case 'paper_size':&nbsp;</div></li><li><div>              if ( isset( $options[ $args['id'] ] ) ) {&nbsp;</div></li><li><div>                  return $options[ $args['id'] ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } elseif ( isset( $pdf_form_settings[ $args['id'] ] ) ) {&nbsp;</div></li><li><div>                  return $pdf_form_settings[ $args['id'] ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } elseif ( isset( $args['std'] ) ) {&nbsp;</div></li><li><div>                  return $args['std'];&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">/** treat as a text or hidden callback */</span>&nbsp;</div></li><li><div>          default:&nbsp;</div></li><li><div>              if ( isset( $options[ $args['id'] ] ) ) {&nbsp;</div></li><li><div>                  return trim( $options[ $args['id'] ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } elseif ( isset( $pdf_form_settings[ $args['id'] ] ) ) {&nbsp;</div></li><li><div>                  return trim( $pdf_form_settings[ $args['id'] ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } elseif ( isset( $args['std'] ) ) {&nbsp;</div></li><li><div>                  return $args['std'];&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** if we made it here return empty string */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Checkbox Callback</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Renders checkboxes.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function checkbox_callback( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** get our selected value */</span>&nbsp;</div></li><li><div>      $checked = $this-&gt;get_form_value( $args );&nbsp;</div></li><li><div>      $class = ( isset( $args['inputClass'] ) ) ? esc_attr( $args['inputClass'] ) : '';&nbsp;</div></li><li><div>      $required = ( isset( $args['required'] ) && $args['required'] === true ) ? 'required' : '';&nbsp;</div></li><li><div>      $id = ( isset( $args['idOverride'] ) ) ? esc_attr( $args['idOverride'] ) : 'gfpdf_settings[' . esc_attr( $args['id'] ) . ']';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html = '&lt;input type=&quot;checkbox&quot; id=&quot;' . $id . '&quot; class=&quot;gfpdf_settings_' . $args['id'] . ' ' . $class . '&quot; name=&quot;gfpdf_settings[' . $args['id'] . ']&quot; value=&quot;1&quot; ' . $checked . ' ' . $required . ' /&gt;';&nbsp;</div></li><li><div>      $html .= '&lt;label for=&quot;' . $id . '&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $args['tooltip'] ) ) {&nbsp;</div></li><li><div>          $html .= '&lt;span class=&quot;gf_hidden_tooltip&quot; style=&quot;display: none;&quot;&gt;' . wp_kses_post( $args['tooltip'] ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Multicheck Callback</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Renders multiple checkboxes.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function multicheck_callback( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $class = ( isset( $args['inputClass'] ) ) ? esc_attr( $args['inputClass'] ) : '';&nbsp;</div></li><li><div>      $required = ( isset( $args['required'] ) && $args['required'] === true ) ? 'required' : '';&nbsp;</div></li><li><div>      $args['id'] = esc_attr( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $args['options'] ) ) {&nbsp;</div></li><li><div>          foreach ( $args['options'] as $key =&gt; $option ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/** Set up multi-select option to pass to our form value getter */</span>&nbsp;</div></li><li><div>              $args['multi-key'] = esc_attr( $key );&nbsp;</div></li><li><div>              $args['multi-option'] = $option;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $enabled = $this-&gt;get_form_value( $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              echo '&lt;input name=&quot;gfpdf_settings[' . $args['id'] . '][' . esc_attr( $key ) . ']&quot; id=&quot;gfpdf_settings[' . $args['id'] . '][' . esc_attr( $key ) . ']&quot; class=&quot;gfpdf_settings_' . $args['id'] . ' ' . $class . '&quot; type=&quot;checkbox&quot; value=&quot;' . $option . '&quot; ' . checked( $option, $enabled, false ) . ' ' . $required . ' /&gt;&nbsp;';&nbsp;</div></li><li><div>              echo '&lt;label for=&quot;gfpdf_settings[' . $args['id'] . '][' . esc_attr( $key ) . ']&quot;&gt;' . $option . '&lt;/label&gt;&lt;br /&gt;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo '&lt;span class=&quot;gf_settings_description&quot;&gt;&lt;label for=&quot;gfpdf_settings[' . $args['id'] . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( isset( $args['tooltip'] ) ) {&nbsp;</div></li><li><div>              echo '&lt;span class=&quot;gf_hidden_tooltip&quot; style=&quot;display: none;&quot;&gt;' . wp_kses_post( $args['tooltip'] ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Radio Callback</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Renders radio boxes.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function radio_callback( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** get selected value (if any) */</span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $selected = $this-&gt;get_form_value( $args );&nbsp;</div></li><li><div>      $required = ( isset( $args['required'] ) && $args['required'] === true ) ? 'required' : '';&nbsp;</div></li><li><div>      $args['id'] = esc_attr( $args['id'] );&nbsp;</div></li><li><div>      $html = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $args['options'] as $key =&gt; $option ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $checked = false;&nbsp;</div></li><li><div>          if ( $selected == $key ) {&nbsp;</div></li><li><div>              $checked = true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $html .= '&lt;label for=&quot;gfpdf_settings[' . $args['id'] . '][' . esc_attr( $key ) . ']&quot;&gt;&lt;input name=&quot;gfpdf_settings[' . $args['id'] . ']&quot; class=&quot;gfpdf_settings_' . $args['id'] . '&quot; id=&quot;gfpdf_settings[' . $args['id'] . '][' . esc_attr( $key ) . ']&quot; type=&quot;radio&quot; value=&quot;' . esc_attr( $key ) . '&quot; ' . checked( true, $checked, false ) . ' ' . $required . ' /&gt;';&nbsp;</div></li><li><div>          $html .= $option . '&lt;/label&gt; &nbsp;&nbsp;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html .= '&lt;span class=&quot;gf_settings_description&quot;&gt;&lt;label for=&quot;gfpdf_settings[' . $args['id'] . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $args['tooltip'] ) ) {&nbsp;</div></li><li><div>          $html .= '&lt;span class=&quot;gf_hidden_tooltip&quot; style=&quot;display: none;&quot;&gt;' . wp_kses_post( $args['tooltip'] ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Text Callback</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Renders text fields.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function text_callback( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** get selected value (if any) */</span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $value = $this-&gt;get_form_value( $args );&nbsp;</div></li><li><div>      $class = ( isset( $args['inputClass'] ) ) ? esc_attr( $args['inputClass'] ) : '';&nbsp;</div></li><li><div>      $input_data = ( isset( $args['data'] ) && is_array( $args['data'] ) ) ? $args['data'] : [];&nbsp;</div></li><li><div>      $required = ( isset( $args['required'] ) && $args['required'] === true ) ? 'required' : '';&nbsp;</div></li><li><div>      $args['id'] = esc_attr( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $size = ( isset( $args['size'] ) && ! is_null( $args['size'] ) ) ? esc_attr( $args['size'] ) : 'regular';&nbsp;</div></li><li><div>      $html = '&lt;input type=&quot;text&quot; class=&quot;' . $size . '-text ' . $class . '&quot; id=&quot;gfpdf_settings[' . $args['id'] . ']&quot; class=&quot;gfpdf_settings_' . $args['id'] . '&quot; name=&quot;gfpdf_settings[' . $args['id'] . ']&quot; value=&quot;' . esc_attr( stripslashes( $value ) ) . '&quot; ' . $required;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $input_data as $data_id =&gt; $data_value ) {&nbsp;</div></li><li><div>          $html .= ' data-' . $data_id . '=&quot;' . esc_html( $data_value ) . '&quot; ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html .= ' /&gt;';&nbsp;</div></li><li><div>      $html .= '&lt;span class=&quot;gf_settings_description&quot;&gt;&lt;label for=&quot;gfpdf_settings[' . $args['id'] . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $args['tooltip'] ) ) {&nbsp;</div></li><li><div>          $html .= '&lt;span class=&quot;gf_hidden_tooltip&quot; style=&quot;display: none;&quot;&gt;' . wp_kses_post( $args['tooltip'] ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Number Callback</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Renders number fields.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function number_callback( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** get selected value (if any) */</span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $value = $this-&gt;get_form_value( $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** ensure value is not an array */</span>&nbsp;</div></li><li><div>      if ( is_array( $value ) ) {&nbsp;</div></li><li><div>          $value = implode( ' ', $value );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** check if required */</span>&nbsp;</div></li><li><div>      $class = ( isset( $args['inputClass'] ) ) ? esc_attr( $args['inputClass'] ) : '';&nbsp;</div></li><li><div>      $required = ( isset( $args['required'] ) && $args['required'] === true ) ? 'required' : '';&nbsp;</div></li><li><div>      $input_data = ( isset( $args['data'] ) && is_array( $args['data'] ) ) ? $args['data'] : [];&nbsp;</div></li><li><div>      $args['id'] = esc_attr( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $max = isset( $args['max'] ) ? (int) $args['max'] : 999999;&nbsp;</div></li><li><div>      $min = isset( $args['min'] ) ? (int) $args['min'] : 0;&nbsp;</div></li><li><div>      $step = isset( $args['step'] ) ? (int) $args['step'] : 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $size = ( isset( $args['size'] ) && ! is_null( $args['size'] ) ) ? esc_attr( $args['size'] ) : 'regular';&nbsp;</div></li><li><div>      $html = '&lt;input type=&quot;number&quot; step=&quot;' . esc_attr( $step ) . '&quot; max=&quot;' . esc_attr( $max ) . '&quot; min=&quot;' . esc_attr( $min ) . '&quot; class=&quot;' . $size . '-text gfpdf_settings_' . $args['id'] . ' ' . $class . '&quot; id=&quot;gfpdf_settings[' . $args['id'] . ']&quot; name=&quot;gfpdf_settings[' . $args['id'] . ']&quot; value=&quot;' . esc_attr( stripslashes( $value ) ) . '&quot; ' . $required;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $input_data as $data_id =&gt; $data_value ) {&nbsp;</div></li><li><div>          $html .= ' data-' . $data_id . '=&quot;' . esc_html( $data_value ) . '&quot; ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html .= ' /&gt; ' . $args['desc2'];&nbsp;</div></li><li><div>      $html .= '&lt;span class=&quot;gf_settings_description&quot;&gt;&lt;label for=&quot;gfpdf_settings[' . $args['id'] . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $args['tooltip'] ) ) {&nbsp;</div></li><li><div>          $html .= '&lt;span class=&quot;gf_hidden_tooltip&quot; style=&quot;display: none;&quot;&gt;' . wp_kses_post( $args['tooltip'] ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Textarea Callback</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Renders textarea fields.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function textarea_callback( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** get selected value (if any) */</span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $value = $this-&gt;get_form_value( $args );&nbsp;</div></li><li><div>      $class = ( isset( $args['inputClass'] ) ) ? esc_attr( $args['inputClass'] ) : '';&nbsp;</div></li><li><div>      $required = ( isset( $args['required'] ) && $args['required'] === true ) ? 'required' : '';&nbsp;</div></li><li><div>      $input_data = ( isset( $args['data'] ) && is_array( $args['data'] ) ) ? $args['data'] : [];&nbsp;</div></li><li><div>      $args['id'] = esc_attr( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html = '&lt;textarea cols=&quot;50&quot; rows=&quot;5&quot; id=&quot;gfpdf_settings[' . $args['id'] . ']&quot; class=&quot;large-text gfpdf_settings_' . $args['id'] . ' ' . $class . '&quot; name=&quot;gfpdf_settings[' . $args['id'] . ']&quot; ' . $required;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $input_data as $data_id =&gt; $data_value ) {&nbsp;</div></li><li><div>          $html .= ' data-' . $data_id . '=&quot;' . esc_html( $data_value ) . '&quot; ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html .= '&gt;' . esc_textarea( stripslashes( $value ) ) . '&lt;/textarea&gt;';&nbsp;</div></li><li><div>      $html .= '&lt;span class=&quot;gf_settings_description&quot;&gt;&lt;label for=&quot;gfpdf_settings[' . $args['id'] . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $args['tooltip'] ) ) {&nbsp;</div></li><li><div>          $html .= '&lt;span class=&quot;gf_hidden_tooltip&quot; style=&quot;display: none;&quot;&gt;' . wp_kses_post( $args['tooltip'] ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">/** Check if the field should include a toggle option */</span></span>&nbsp;</div></li><li><div>      $toggle = ( ! empty( $args['toggle'] ) ) ? $args['toggle'] : false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $toggle !== false ) {&nbsp;</div></li><li><div>          $html = $this-&gt;create_toggle_input( $toggle, $html, $value );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Password Callback</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Renders password fields.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function password_callback( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** get selected value (if any) */</span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $value = $this-&gt;get_form_value( $args );&nbsp;</div></li><li><div>      $class = ( isset( $args['inputClass'] ) ) ? esc_attr( $args['inputClass'] ) : '';&nbsp;</div></li><li><div>      $required = ( isset( $args['required'] ) && $args['required'] === true ) ? 'required' : '';&nbsp;</div></li><li><div>      $args['id'] = esc_attr( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $size = ( isset( $args['size'] ) && ! is_null( $args['size'] ) ) ? esc_attr( $args['size'] ) : 'regular';&nbsp;</div></li><li><div>      $html = '&lt;input type=&quot;password&quot; class=&quot;' . $size . '-text ' . $class . '&quot; id=&quot;gfpdf_settings[' . $args['id'] . ']&quot; class=&quot;gfpdf_settings_' . $args['id'] . '&quot; name=&quot;gfpdf_settings[' . $args['id'] . ']&quot; value=&quot;' . esc_attr( $value ) . '&quot; ' . $required . ' /&gt;';&nbsp;</div></li><li><div>      $html .= '&lt;span class=&quot;gf_settings_description&quot;&gt;&lt;label for=&quot;gfpdf_settings[' . $args['id'] . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $args['tooltip'] ) ) {&nbsp;</div></li><li><div>          $html .= '&lt;span class=&quot;gf_hidden_tooltip&quot; style=&quot;display: none;&quot;&gt;' . wp_kses_post( $args['tooltip'] ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Select Callback</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Renders select fields.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function select_callback( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** get selected value (if any) */</span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $value = $this-&gt;get_form_value( $args );&nbsp;</div></li><li><div>      $placeholder = ( isset( $args['placeholder'] ) ) ? esc_attr( $args['placeholder'] ) : '';&nbsp;</div></li><li><div>      $chosen = ( isset( $args['chosen'] ) ) ? 'gfpdf-chosen' : '';&nbsp;</div></li><li><div>      $class = ( isset( $args['inputClass'] ) ) ? esc_attr( $args['inputClass'] ) : '';&nbsp;</div></li><li><div>      $required = ( isset( $args['required'] ) && $args['required'] === true ) ? 'required' : '';&nbsp;</div></li><li><div>      $input_data = ( isset( $args['data'] ) && is_array( $args['data'] ) ) ? $args['data'] : [];&nbsp;</div></li><li><div>      $args['id'] = esc_attr( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $multiple = $multipleExt = '';&nbsp;</div></li><li><div>      if ( isset( $args['multiple'] ) ) {&nbsp;</div></li><li><div>          $multiple = 'multiple';&nbsp;</div></li><li><div>          $multipleExt = '[]';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html = '&lt;select id=&quot;gfpdf_settings[' . $args['id'] . ']&quot; class=&quot;gfpdf_settings_' . $args['id'] . ' ' . $class . ' ' . $chosen . '&quot; name=&quot;gfpdf_settings[' . $args['id'] . ']' . $multipleExt . '&quot; data-placeholder=&quot;' . $placeholder . '&quot; ' . $multiple . ' ' . $required;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $input_data as $data_id =&gt; $data_value ) {&nbsp;</div></li><li><div>          $html .= ' data-' . $data_id . '=&quot;' . esc_html( $data_value ) . '&quot; ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html .= '&gt;';&nbsp;</div></li><li><div>      $html .= $this-&gt;build_options_for_select( $args['options'], $value );&nbsp;</div></li><li><div>      $html .= '&lt;/select&gt;';&nbsp;</div></li><li><div>      $html .= '&lt;span class=&quot;gf_settings_description&quot;&gt;&lt;label for=&quot;gfpdf_settings[' . $args['id'] . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $args['tooltip'] ) ) {&nbsp;</div></li><li><div>          $html .= '&lt;span class=&quot;gf_hidden_tooltip&quot; style=&quot;display: none;&quot;&gt;' . wp_kses_post( $args['tooltip'] ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Build our option groups for the select box</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array        $options The list of options that should be displayed</span>&nbsp;</div></li><li><div><span class="comment">   * @param array|string $value   The selected option</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.1</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function build_options_for_select( $options, $value ) {&nbsp;</div></li><li><div>      $html = '';&nbsp;</div></li><li><div>      foreach ( $options as $option =&gt; $name ) {&nbsp;</div></li><li><div>          if ( ! is_array( $name ) ) {&nbsp;</div></li><li><div>              if ( is_array( $value ) ) {&nbsp;</div></li><li><div>                  foreach ( $value as $v ) {&nbsp;</div></li><li><div>                      $selected = selected( $option, $v, false );&nbsp;</div></li><li><div>                      if ( $selected != '' ) {&nbsp;</div></li><li><div>                          break;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $selected = selected( $option, $value, false );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $html .= '&lt;option value=&quot;' . esc_attr( $option ) . '&quot; ' . $selected . '&gt;' . esc_html( $name ) . '&lt;/option&gt;';&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $html .= '&lt;optgroup label=&quot;' . esc_attr( $option ) . '&quot;&gt;';&nbsp;</div></li><li><div>              foreach ( $name as $op_value =&gt; $op_label ) {&nbsp;</div></li><li><div>                  $selected = '';&nbsp;</div></li><li><div>                  if ( is_array( $value ) ) {&nbsp;</div></li><li><div>                      foreach ( $value as $v ) {&nbsp;</div></li><li><div>                          $selected = selected( $op_value, $v, false );&nbsp;</div></li><li><div>                          if ( $selected != '' ) {&nbsp;</div></li><li><div>                              break;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $selected = selected( $op_value, $value, false );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $html .= '&lt;option value=&quot;' . esc_attr( $op_value ) . '&quot; ' . $selected . '&gt;' . esc_html( $op_label ) . '&lt;/option&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $html .= '&lt;/optgroup&gt;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Rich Editor Callback</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Renders rich editor fields.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array  $args       Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @global float $wp_version The WordPress Version</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function rich_editor_callback( $args ) {&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** get selected value (if any) */</span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $value = $this-&gt;get_form_value( $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $rows = isset( $args['size'] ) ? esc_attr( $args['size'] ) : 20;&nbsp;</div></li><li><div>      $args['id'] = esc_attr( $args['id'] );&nbsp;</div></li><li><div>      $class = ( isset( $args['inputClass'] ) ) ? esc_attr( $args['inputClass'] ) : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( function_exists( 'wp_editor' ) ) {&nbsp;</div></li><li><div>          ob_start();&nbsp;</div></li><li><div>          echo '&lt;span class=&quot;mt-gfpdf_settings_' . $args['id'] . '&quot; style=&quot;float:right; position:relative; right: 10px; top: 90px;&quot;&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>          wp_editor( stripslashes( $value ), 'gfpdf_settings_' . $args['id'], apply_filters( 'gfpdf_rich_editor_settings', [&nbsp;</div></li><li><div>              'textarea_name' =&gt; 'gfpdf_settings[' . $args['id'] . ']', &nbsp;</div></li><li><div>              'textarea_rows' =&gt; $rows, &nbsp;</div></li><li><div>              'editor_height' =&gt; $rows * 10, <span class="comment">/** estimate row height at 10px */</span>&nbsp;</div></li><li><div>              'editor_class' =&gt; 'gfpdf_settings_' . $args['id'] . ' ' . $class, &nbsp;</div></li><li><div>              'autop' =&gt; false, &nbsp;</div></li><li><div> ] ) );&nbsp;</div></li><li><div>          $html = ob_get_clean();&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $html = '&lt;textarea class=&quot;large-text&quot; rows=&quot;'. $rows . '&quot; class=&quot;gfpdf_settings_' . $args['id'] . ' ' . $class . '&quot; id=&quot;gfpdf_settings[' . $args['id'] . ']&quot; name=&quot;gfpdf_settings[' . $args['id'] . ']&quot;&gt;' . esc_textarea( stripslashes( $value ) ) . '&lt;/textarea&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html .= '&lt;span class=&quot;gf_settings_description&quot;&gt;&lt;label for=&quot;gfpdf_settings[' . $args['id'] . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $args['tooltip'] ) ) {&nbsp;</div></li><li><div>          $html .= '&lt;span class=&quot;gf_hidden_tooltip&quot; style=&quot;display: none;&quot;&gt;' . wp_kses_post( $args['tooltip'] ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">/** Check if the field should include a toggle option */</span></span>&nbsp;</div></li><li><div>      $toggle = ( ! empty( $args['toggle'] ) ) ? $args['toggle'] : false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $toggle !== false ) {&nbsp;</div></li><li><div>          $html = $this-&gt;create_toggle_input( $toggle, $html, $value );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Upload Callback</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Renders upload fields.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function upload_callback( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** get selected value (if any) */</span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $value = $this-&gt;get_form_value( $args );&nbsp;</div></li><li><div>      $uploader_title = ( isset( $args['uploaderTitle'] ) ) ? esc_attr( $args['uploaderTitle'] ) : esc_attr__( 'Select Media', 'gravity-forms-pdf-extended' );&nbsp;</div></li><li><div>      $uploader_button_text = ( isset( $args['uploaderButtonText'] ) ) ? esc_attr( $args['uploaderButtonText'] ) : esc_attr__( 'Select Media', 'gravity-forms-pdf-extended' );&nbsp;</div></li><li><div>      $button_text = ( isset( $args['buttonText'] ) ) ? esc_attr( $args['buttonText'] ) : esc_attr__( 'Upload File', 'gravity-forms-pdf-extended' );&nbsp;</div></li><li><div>      $class = ( isset( $args['inputClass'] ) ) ? esc_attr( $args['inputClass'] ) : '';&nbsp;</div></li><li><div>      $required = ( isset( $args['required'] ) && $args['required'] === true ) ? 'required' : '';&nbsp;</div></li><li><div>      $args['id'] = esc_attr( $args['id'] );&nbsp;</div></li><li><div>      $size = ( isset( $args['size'] ) && ! is_null( $args['size'] ) ) ? esc_attr( $args['size'] ) : 'regular';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html = '&lt;input type=&quot;text&quot; class=&quot;' . $size . '-text gfpdf_settings_' . $args['id'] . ' ' . $class . '&quot; id=&quot;gfpdf_settings[' . $args['id'] . ']&quot; name=&quot;gfpdf_settings[' . $args['id'] . ']&quot; value=&quot;' . esc_attr( stripslashes( $value ) ) . '&quot; ' . $required . ' /&gt;';&nbsp;</div></li><li><div>      $html .= '&lt;span&gt;&nbsp;&lt;input type=&quot;button&quot; class=&quot;gfpdf_settings_upload_button button-secondary&quot; value=&quot;' . $button_text . '&quot; data-uploader-title=&quot;' . $uploader_title . '&quot; data-uploader-button-text=&quot;' . $uploader_button_text . '&quot; /&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>      $html .= '&lt;span class=&quot;gf_settings_description&quot;&gt;&lt;label for=&quot;gfpdf_settings[' . $args['id'] . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $args['tooltip'] ) ) {&nbsp;</div></li><li><div>          $html .= '&lt;span class=&quot;gf_hidden_tooltip&quot; style=&quot;display: none;&quot;&gt;' . wp_kses_post( $args['tooltip'] ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Color picker Callback</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Renders color picker fields.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function color_callback( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** get selected value (if any) */</span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $value = $this-&gt;get_form_value( $args );&nbsp;</div></li><li><div>      $default = isset( $args['std'] ) ? esc_attr( $args['std'] ) : '';&nbsp;</div></li><li><div>      $class = ( isset( $args['inputClass'] ) ) ? esc_attr( $args['inputClass'] ) : '';&nbsp;</div></li><li><div>      $required = ( isset( $args['required'] ) && $args['required'] === true ) ? 'required' : '';&nbsp;</div></li><li><div>      $args['id'] = esc_attr( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html = '&lt;input type=&quot;text&quot; class=&quot;gfpdf-color-picker gfpdf_settings_' . $args['id'] . ' ' . $class . '&quot; id=&quot;gfpdf_settings[' . $args['id'] . ']&quot; name=&quot;gfpdf_settings[' . $args['id'] . ']&quot; value=&quot;' . esc_attr( $value ) . '&quot; data-default-color=&quot;' . esc_attr( $default ) . '&quot; ' . $required . ' /&gt;';&nbsp;</div></li><li><div>      $html .= '&lt;span class=&quot;gf_settings_description&quot;&gt;&lt;label for=&quot;gfpdf_settings[' . $args['id'] . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $args['tooltip'] ) ) {&nbsp;</div></li><li><div>          $html .= '&lt;span class=&quot;gf_hidden_tooltip&quot; style=&quot;display: none;&quot;&gt;' . wp_kses_post( $args['tooltip'] ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Add a button callback.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Renders a button onto the settings field.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function button_callback( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $nonce = wp_create_nonce( 'gfpdf_settings[' . $args['id'] . ']' );&nbsp;</div></li><li><div>      $input_data = ( isset( $args['data'] ) && is_array( $args['data'] ) ) ? $args['data'] : [];&nbsp;</div></li><li><div>      $class = ( isset( $args['inputClass'] ) ) ? esc_attr( $args['inputClass'] ) : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html = '&lt;button id=&quot;gfpdf_settings[' . $args['id'] . ']&quot; name=&quot;gfpdf_settings[' . $args['id'] . '][name]&quot; value=&quot;' . $args['id'] . '&quot; class=&quot;button gfpdf-button ' . $class . '&quot; type=&quot;submit&quot;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $input_data as $data_id =&gt; $data_value ) {&nbsp;</div></li><li><div>          $html .= ' data-' . $data_id . '=&quot;' . esc_html( $data_value ) . '&quot; ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html .= '&gt;' . esc_html( $args['std'] ) . '&lt;/button&gt;';&nbsp;</div></li><li><div>      $html .= '&lt;span class=&quot;gf_settings_description&quot;&gt;' . wp_kses_post( $args['desc'] ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>      $html .= '&lt;input type=&quot;hidden&quot; name=&quot;gfpdf_settings[' . $args['id'] . '][nonce]&quot; value=&quot;' . $nonce . '&quot; /&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $args['tooltip'] ) ) {&nbsp;</div></li><li><div>          $html .= '&lt;span class=&quot;gf_hidden_tooltip&quot; style=&quot;display: none;&quot;&gt;' . wp_kses_post( $args['tooltip'] ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Gravity Forms Conditional Logic Callback</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Renders the GF Conditional logic container</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function conditional_logic_callback( $args ) {&nbsp;</div></li><li><div>      $args['idOverride'] = 'gfpdf_conditional_logic';&nbsp;</div></li><li><div>      $args['type'] = 'checkbox';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;checkbox_callback( $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html = '&lt;div id=&quot;gfpdf_conditional_logic_container&quot; class=&quot;gfpdf_conditional_logic&quot;&gt;&nbsp;</div></li><li><div>          &lt;!-- content dynamically created from form_admin.js --&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Render a hidden field</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function hidden_callback( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** get selected value (if any) */</span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $value = $this-&gt;get_form_value( $args );&nbsp;</div></li><li><div>      $class = ( isset( $args['inputClass'] ) ) ? esc_attr( $args['inputClass'] ) : '';&nbsp;</div></li><li><div>      $input_data = ( isset( $args['data'] ) && is_array( $args['data'] ) ) ? $args['data'] : [];&nbsp;</div></li><li><div>      $args['id'] = esc_attr( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html = '&lt;input type=&quot;hidden&quot; class=&quot;' . $class . '&quot; id=&quot;gfpdf_settings[' . $args['id'] . ']&quot; class=&quot;gfpdf_settings_' . $args['id'] . '&quot; name=&quot;gfpdf_settings[' . $args['id'] . ']&quot; value=&quot;' . esc_attr( stripslashes( $value ) ) . '&quot;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $input_data as $data_id =&gt; $data_value ) {&nbsp;</div></li><li><div>          $html .= ' data-' . $data_id . '=&quot;' . esc_html( $data_value ) . '&quot; ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html .= '/&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Render the custom paper size functionality</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function paper_size_callback( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">/** get selected value (if any) */</span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $value = $this-&gt;get_form_value( $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $value ) ) {&nbsp;</div></li><li><div>          $value = [ '', '', 'mm' ];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $placeholder = ( isset( $args['placeholder'] ) ) ? esc_attr( $args['placeholder'] ) : '';&nbsp;</div></li><li><div>      $chosen = ( isset( $args['chosen'] ) ) ? 'gfpdf-chosen' : '';&nbsp;</div></li><li><div>      $class = ( isset( $args['inputClass'] ) ) ? esc_attr( $args['inputClass'] ) : '';&nbsp;</div></li><li><div>      $size = ( isset( $args['size'] ) && ! is_null( $args['size'] ) ) ? esc_attr( $args['size'] ) : 'regular';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html = '&lt;input type=&quot;number&quot; class=&quot;' . $size . '-text gfpdf_settings_' . $args['id'] . '&quot; id=&quot;gfpdf_settings[' . $args['id'] . ']_width&quot; min=&quot;1&quot; name=&quot;gfpdf_settings[' . $args['id'] . '][]&quot; value=&quot;' . esc_attr( stripslashes( $value[0] ) ) . '&quot; required /&gt; ' . esc_html__( 'Width', 'gravity-forms-pdf-extended' );&nbsp;</div></li><li><div>      $html .= ' &lt;input type=&quot;number&quot; class=&quot;' . $size . '-text gfpdf_settings_' . $args['id'] . '&quot; id=&quot;gfpdf_settings[' . $args['id'] . ']_height&quot; min=&quot;1&quot; name=&quot;gfpdf_settings[' . $args['id'] . '][]&quot; value=&quot;' . esc_attr( stripslashes( $value[1] ) ) . '&quot; required /&gt; ' . esc_html__( 'Height', 'gravity-forms-pdf-extended' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $measurement = apply_filters( 'gfpdf_paper_size_dimensions', [&nbsp;</div></li><li><div>          'millimeters' =&gt; esc_html__( 'mm', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div>          'inches' =&gt; esc_html__( 'inches', 'gravity-forms-pdf-extended' ), &nbsp;</div></li><li><div> ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html .= '&nbsp; * &nbsp; &lt;select id=&quot;gfpdf_settings[' . $args['id'] . ']_measurement&quot; style=&quot;width: 75px&quot; class=&quot;gfpdf_settings_' . $args['id'] . ' ' . $class . ' ' . $chosen . '&quot; name=&quot;gfpdf_settings[' . $args['id'] . '][]&quot; data-placeholder=&quot;' . $placeholder . '&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $measure_value = esc_attr( stripslashes( $value[2] ) );&nbsp;</div></li><li><div>      foreach ( $measurement as $key =&gt; $val ) {&nbsp;</div></li><li><div>          $selected = ( $measure_value === $key ) ? 'selected=&quot;selected&quot;' : '';&nbsp;</div></li><li><div>          $html .= '&lt;option value=&quot;' . $key . '&quot; ' . $selected . '&gt;' . $val . '&lt;/option&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html .= '&lt;/select&gt; ';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html .= '&lt;span class=&quot;gf_settings_description&quot;&gt;&lt;label for=&quot;gfpdf_settings[' . esc_attr( $args['id'] ) . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Descriptive text callback.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Renders descriptive text onto the settings field.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function descriptive_text_callback( $args ) {&nbsp;</div></li><li><div>      echo wp_kses_post( $args['desc'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Hook Callback</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Adds a do_action() hook in place of the field</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function hook_callback( $args ) {&nbsp;</div></li><li><div>      do_action( 'gfpdf_' . $args['id'], $args );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Missing Callback</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * If a public function is missing for settings callbacks alert the user.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since 4.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return void</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function missing_callback( $args ) {&nbsp;</div></li><li><div>      printf( esc_html__( 'The callback used for the %s setting is missing.', 'gravity-forms-pdf-extended' ), &quot;&lt;strong&gt;{$args['id']}&lt;/strong&gt;&quot; );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Creates jQuery toggle functionality for the current fiel</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  String $toggle The text to be used in the toggle</span>&nbsp;</div></li><li><div><span class="comment">   * @param  String $html   The field HTML</span>&nbsp;</div></li><li><div><span class="comment">   * @param  String $value  Whether the field currently has a value</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return String         The modified HTML</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function create_toggle_input( $toggle, $html, $value ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $has_value = ( strlen( $value ) &gt; 0 ) ? 1 : 0;&nbsp;</div></li><li><div>      $current_display = ( ! $has_value ) ? 'style=&quot;display: none;&quot;' : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $toggle_elm = '&lt;label&gt;&lt;input class=&quot;gfpdf-input-toggle&quot; type=&quot;checkbox&quot; value=&quot;1&quot; ' . checked( $has_value, 1, false ) . ' /&gt; ' . esc_attr( $toggle ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html = '&lt;div class=&quot;gfpdf-toggle-wrapper&quot; ' . $current_display . '&gt;' .&nbsp;</div></li><li><div>              $html .&nbsp;</div></li><li><div>              '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html = $toggle_elm . $html;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>Gravity PDF</li><li><span></span>4.1.1</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>