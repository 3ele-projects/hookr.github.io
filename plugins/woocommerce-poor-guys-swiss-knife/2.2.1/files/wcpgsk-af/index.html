<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="2.2.1" data-slug="woocommerce-poor-guys-swiss-knife" data-type="file" data-id="65915"><head xmlns="http://www.w3.org/1999/xhtml"><title> wcpgsk-af | file | Woocommerce Poor Guys Swiss Knife | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, woocommerce-poor-guys-swiss-knife, 2.2.1" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=67b36fb63428a5df8b746095851dba3d' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/wcpgsk-af/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwcpgsk-af%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fwcpgsk-af%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-woocommerce-poor-guys-swiss-knife-2.2.1-file-wcpgsk-af","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wcpgsk-af" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to woocommerce-poor-guys-swiss-k&hellip;." href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/" class="plugin"><span property="name">woocommerce-poor-guys-swiss-k&hellip;</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.2.1." href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/" class="H_VERSION"><span property="name">2.2.1</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wcpgsk-af</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="93"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/all/" title="All">All <span class="count badge">93</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="45"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/hooks/" title="Hooks">Hooks <span class="count badge">45</span></a></li><li class="" data-id="action" data-count="21"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/actions/" title="Actions">Actions <span class="count badge">21</span></a></li><li class="" data-id="filter" data-count="24"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/filters/" title="Filters">Filters <span class="count badge">24</span></a></li><li class="" data-id="class" data-count="4"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/classes/" title="Classes">Classes <span class="count badge">4</span></a></li><li class="" data-id="constant" data-count="3"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/constants/" title="Constants">Constants <span class="count badge">3</span></a></li><li class="" data-id="function" data-count="41"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/functions/" title="Functions">Functions <span class="count badge">41</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/wcpgsk-af.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div>if ( ! defined( 'ABSPATH' ) ) exit;&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Execute actions and filters</span>&nbsp;</div></li><li><div><span class="comment"> * Checks for standard configured actions and filters and attaches these actions and filters</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>global $wcpgsk_options;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'woocommerce_add_to_cart_validation', 'wcpgsk_maxitems_in_cart', 10, 3 );&nbsp;</div></li><li><div>add_filter( 'woocommerce_update_cart_validation', 'wcpgsk_minitems_in_cart', 2, 4 );&nbsp;</div></li><li><div>add_filter( 'woocommerce_add_to_cart_validation', 'wcpgsk_globalqty_cart_add', 1, 3 );&nbsp;</div></li><li><div>add_filter( 'woocommerce_update_cart_validation', 'wcpgsk_globalqty_cart_update', 1, 4 );&nbsp;</div></li><li><div>add_filter( 'woocommerce_is_sold_individually', 'wcpgsk_check_qty_config', 10, 2 );&nbsp;</div></li><li><div>add_filter( 'woocommerce_quantity_input_max', 'wcpgsk_qtyselector_max', 10, 2 );&nbsp;</div></li><li><div>add_filter( 'woocommerce_quantity_input_min', 'wcpgsk_qtyselector_min', 10, 2 );&nbsp;</div></li><li><div>add_filter( 'woocommerce_quantity_input_step', 'wcpgsk_quantity_input_step', 10, 2 );&nbsp;</div></li><li><div><span class="comment">//add_filter( 'woocommerce_quantity_input_args', 'wcpgsk_qty_input_args', 10, 2 );</span>&nbsp;</div></li><li><div>if ( function_exists('WC') ) :&nbsp;</div></li><li><div>  add_filter( 'woocommerce_product_single_add_to_cart_text', 'wcpgsk_product_single_cart_button_text', 10, 2 );&nbsp;</div></li><li><div>  add_filter( 'woocommerce_product_add_to_cart_text', 'wcpgsk_product_cart_button_text', 10, 2 );&nbsp;</div></li><li><div>else :&nbsp;</div></li><li><div>  add_filter( 'single_add_to_cart_text', 'wcpgsk_single_cart_button_text', 10, 2 );&nbsp;</div></li><li><div>  add_filter( 'variable_add_to_cart_text', 'wcpgsk_variable_cart_button_text', 10, 1 );&nbsp;</div></li><li><div>  add_filter( 'grouped_add_to_cart_text', 'wcpgsk_grouped_cart_button_text', 10, 1 );&nbsp;</div></li><li><div>  add_filter( 'external_add_to_cart_text', 'wcpgsk_external_cart_button_text', 10, 1 );&nbsp;</div></li><li><div>  add_filter( 'out_of_stock_add_to_cart_text', 'wcpgsk_outofstock_cart_button_text', 10, 1 );&nbsp;</div></li><li><div>  add_filter( 'add_to_cart_text', 'wcpgsk_cart_button_text', 10, 1 );&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>add_action( 'woocommerce_after_checkout_form', 'wcpgsk_after_checkout_form', 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//add_action( 'woocommerce_after_cart_item_quantity_update', 'wcpgsk_after_cart_item_quantity_update', 10, 2 );</span>&nbsp;</div></li><li><div>add_filter( 'woocommerce_add_cart_item', 'wcpgsk_add_cart_item', 10, 2 );&nbsp;</div></li><li><div>add_action( 'woocommerce_check_cart_items', 'wcpgsk_check_cart_items', 10 );&nbsp;</div></li><li><div>add_filter( 'woocommerce_available_variation', 'wcpgsk_available_variation', 10, 3 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//fix input quantity problem of woocommerce for variations as variations are configured via javasript overwriting all filters and actions by woocommerce, in fact a bug of woocommerce</span>&nbsp;</div></li><li><div>function wcpgsk_available_variation($variation_data, $product, $variation) {&nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  $ival = apply_filters( 'woocommerce_quantity_input_min', '', $product );&nbsp;</div></li><li><div>  if ( !$ival ) :&nbsp;</div></li><li><div>      $ival = apply_filters( 'woocommerce_quantity_input_step', '1', $product );&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>  $variation_data['min_qty'] = $ival;&nbsp;</div></li><li><div>  return $variation_data;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wcpgsk_check_cart_items() {&nbsp;</div></li><li><div>  global $woocommerce;&nbsp;</div></li><li><div>  wcpgsk_clear_messages();&nbsp;</div></li><li><div>  <span class="comment">//wcpgsk_clear_messages();</span>&nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  $qtycnt = 0;&nbsp;</div></li><li><div>  $prodcnt = 0;&nbsp;</div></li><li><div>  $do_cart_redirect = false;&nbsp;</div></li><li><div>  foreach ( $woocommerce-&gt;cart-&gt;get_cart() as $cart_item_key =&gt; $values ) :&nbsp;</div></li><li><div>      $product_id = $values['product_id'];        &nbsp;</div></li><li><div>      $quantity = $values['quantity'];&nbsp;</div></li><li><div>      $qtycnt += $quantity;&nbsp;</div></li><li><div>      $prodcnt++;&nbsp;</div></li><li><div>      $product = get_product( $product_id );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      $minqty = isset($options['cart']['minqty_' . $product-&gt;product_type]) && $options['cart']['minqty_' . $product-&gt;product_type] ? $options['cart']['minqty_' . $product-&gt;product_type] : 0;&nbsp;</div></li><li><div>      $maxqty = isset($options['cart']['maxqty_' . $product-&gt;product_type]) && $options['cart']['maxqty_' . $product-&gt;product_type] ? $options['cart']['maxqty_' . $product-&gt;product_type] : 0;&nbsp;</div></li><li><div>      $stepqty = isset($options['cart']['stepqty_' . $product-&gt;product_type]) && $options['cart']['stepqty_' . $product-&gt;product_type] ? $options['cart']['stepqty_' . $product-&gt;product_type] : 0;&nbsp;</div></li><li><div>      if ( isset($options['cart']['minmaxstepproduct']) && $options['cart']['minmaxstepproduct'] == 1 ) :        &nbsp;</div></li><li><div>          $maxval = get_post_meta($product_id, '_wcpgsk_maxqty', true);&nbsp;</div></li><li><div>          if ( isset($maxval) && $maxval &gt; 0 ) :&nbsp;</div></li><li><div>              $maxqty = $maxval;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          $minval = get_post_meta($product_id, '_wcpgsk_minqty', true);&nbsp;</div></li><li><div>          if ( isset($minval) && $minval &gt; 0 ) :&nbsp;</div></li><li><div>              $minqty = $minval;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          $stepval = get_post_meta($product_id, '_wcpgsk_stepqty', true);&nbsp;</div></li><li><div>          if ( isset($stepval) && $stepval &gt; 0 ) :&nbsp;</div></li><li><div>              $stepqty = $stepval;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>      if ( $minqty &gt; 0 && $quantity &lt; $minqty ) :&nbsp;</div></li><li><div>          $woocommerce-&gt;cart-&gt;set_quantity( $cart_item_key, $minqty );&nbsp;</div></li><li><div>          if ( is_checkout() ) :&nbsp;</div></li><li><div>              wcpgsk_add_error( sprintf( __( 'You have to buy a minimum quantity. We have set the required minimum of %s as quantity for you.', WCPGSK_DOMAIN ), $minqty ) );&nbsp;</div></li><li><div>              $do_cart_redirect = true;&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              wcpgsk_clear_messages();&nbsp;</div></li><li><div>              wcpgsk_add_message( sprintf( __( 'You have to buy a minimum quantity. We have set the required minimum of %s as quantity for you.', WCPGSK_DOMAIN ), $minqty ) );&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          wcpgsk_set_messages();        &nbsp;</div></li><li><div>      elseif ( $maxqty &gt; 0 && $quantity &gt; $maxqty ) :&nbsp;</div></li><li><div>          $woocommerce-&gt;cart-&gt;set_quantity( $cart_item_key, $maxqty );&nbsp;</div></li><li><div>          if ( is_checkout() ) :&nbsp;</div></li><li><div>              wcpgsk_add_error( sprintf( __( 'You cannot buy more than the allowed quantity for this product. We have set the maximum of %s as quantity for you.', WCPGSK_DOMAIN ), $maxqty ) );&nbsp;</div></li><li><div>              $do_cart_redirect = true;&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              wcpgsk_clear_messages();&nbsp;</div></li><li><div>              wcpgsk_add_message( sprintf( __( 'You cannot buy more than the allowed quantity for this product. We have set the maximum of %s as quantity for you.', WCPGSK_DOMAIN ), $maxqty ) );&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          wcpgsk_set_messages();        &nbsp;</div></li><li><div>      elseif ( $stepqty &gt; 0 && ( $quantity % $stepqty ) &gt; 0 ) :&nbsp;</div></li><li><div>          $remainder = $quantity % $stepqty;&nbsp;</div></li><li><div>          $newqty = $quantity - $remainder;&nbsp;</div></li><li><div>          if ( $newqty &gt; 0 ) :&nbsp;</div></li><li><div>              $woocommerce-&gt;cart-&gt;set_quantity( $cart_item_key, $newqty );&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              $newqty = $stepqty;&nbsp;</div></li><li><div>              $woocommerce-&gt;cart-&gt;set_quantity( $cart_item_key, $newqty );                &nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          if ( is_checkout() ) :&nbsp;</div></li><li><div>              wcpgsk_add_error( sprintf( __( 'You have to buy this product in multiples of %s. We have set the product quantity to the closest lower multiple available.', WCPGSK_DOMAIN ), $stepqty ) );&nbsp;</div></li><li><div>              $do_cart_redirect = true;&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              wcpgsk_clear_messages();&nbsp;</div></li><li><div>              wcpgsk_add_message( sprintf( __( 'You have to buy this product in multiples of %s. We have set the product quantity to the closest lower multiple available.', WCPGSK_DOMAIN ), $stepqty ) );&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          wcpgsk_set_messages();                    &nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>  endforeach;&nbsp;</div></li><li><div>  $maxqtycart = isset( $options['cart']['maxqtycart'] ) ? $options['cart']['maxqtycart'] : 0;&nbsp;</div></li><li><div>  $minqtycart = isset( $options['cart']['minqtycart'] ) ? $options['cart']['minqtycart'] : 0;&nbsp;</div></li><li><div>  if ( $maxqtycart && is_numeric($maxqtycart) && $qtycnt &gt; $maxqtycart ) :        &nbsp;</div></li><li><div>      if ( is_checkout() ) :&nbsp;</div></li><li><div>          wcpgsk_add_error( sprintf( __( 'The overall sum for all product quantities is restricted to %s in this shop. Your overall quantity sum: %s. Please buy less quantity at least for some products.', WCPGSK_DOMAIN ), $maxqtycart, $qtycnt ) );&nbsp;</div></li><li><div>          $do_cart_redirect = true;&nbsp;</div></li><li><div>      else :&nbsp;</div></li><li><div>          wcpgsk_clear_messages();&nbsp;</div></li><li><div>          wcpgsk_add_message( sprintf( __( 'The overall sum for all product quantities is restricted to %s in this shop. Your overall quantity sum: %s. Please buy less quantity at least for some products.', WCPGSK_DOMAIN ), $maxqtycart, $qtycnt ) );&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>      wcpgsk_set_messages();    &nbsp;</div></li><li><div>  endif;    &nbsp;</div></li><li><div>  if ( $minqtycart && is_numeric($minqtycart) && $qtycnt &lt; $minqtycart ) :        &nbsp;</div></li><li><div>      if ( is_checkout() ) :&nbsp;</div></li><li><div>          wcpgsk_add_error( sprintf( __( 'The required minimum sum for all product quantities is set to %s in this shop. Your overall quantity sum: %s. You have to add products to your cart or buy existing products in a higher quantity.', WCPGSK_DOMAIN ), $minqtycart, $qtycnt ) );&nbsp;</div></li><li><div>          $do_cart_redirect = true;&nbsp;</div></li><li><div>      else :&nbsp;</div></li><li><div>          wcpgsk_clear_messages();&nbsp;</div></li><li><div>          wcpgsk_add_message( sprintf( __( 'The required minimum sum for all product quantities is set to %s in this shop. Your overall quantity sum: %s. You have to add products to your cart or buy existing products in a higher quantity.', WCPGSK_DOMAIN ), $minqtycart, $qtycnt ) );&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>      wcpgsk_set_messages();    &nbsp;</div></li><li><div>  endif;    &nbsp;</div></li><li><div>  if ( $do_cart_redirect ) :&nbsp;</div></li><li><div>      wp_safe_redirect( get_permalink( woocommerce_get_page_id( 'cart' ) ) );        &nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( ! function_exists( 'wcpgsk_globalqty_cart_update' ) ) {&nbsp;</div></li><li><div>function wcpgsk_globalqty_cart_update( $valid, $cart_item_key, $values, $quantity ) {    &nbsp;</div></li><li><div>  global $woocommerce;&nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  $maxqtycart = isset( $options['cart']['maxqtycart'] ) ? $options['cart']['maxqtycart'] : 0;&nbsp;</div></li><li><div>  $minqtycart = isset( $options['cart']['minqtycart'] ) ? $options['cart']['minqtycart'] : 0;&nbsp;</div></li><li><div>  $qtycnt = 0;&nbsp;</div></li><li><div>  $prodcnt = 0;&nbsp;</div></li><li><div>  foreach ( $woocommerce-&gt;cart-&gt;get_cart() as $cart_item_key =&gt; $values ) :&nbsp;</div></li><li><div>      $qtycnt += $values['quantity'];&nbsp;</div></li><li><div>      $prodcnt++;&nbsp;</div></li><li><div>  endforeach;&nbsp;</div></li><li><div>  if ( $maxqtycart && is_numeric($maxqtycart) && $qtycnt &gt; $maxqtycart ) :        &nbsp;</div></li><li><div>      wcpgsk_clear_messages();&nbsp;</div></li><li><div>      wcpgsk_add_message( sprintf( __( 'The overall sum for all product quantities is restricted to %s in this shop. Your overall quantity sum: %s. Please buy less quantity at least for some products.', WCPGSK_DOMAIN ), $maxqtycart, $qtycnt ) );&nbsp;</div></li><li><div>      wcpgsk_set_messages();                    &nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>  if ( $minqtycart && is_numeric($minqtycart) && $qtycnt &lt; $minqtycart ) :        &nbsp;</div></li><li><div>      wcpgsk_clear_messages();&nbsp;</div></li><li><div>      wcpgsk_add_message( sprintf( __( 'The required minimum sum for all product quantities is set to %s in this shop. Your overall quantity sum: %s. You have to add products to your cart or buy existing products in a higher quantity.', WCPGSK_DOMAIN ), $minqtycart, $qtycnt ) );&nbsp;</div></li><li><div>      wcpgsk_set_messages();                    &nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>  return $valid;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( ! function_exists( 'wcpgsk_globalqty_cart_add' ) ) {&nbsp;</div></li><li><div>function wcpgsk_globalqty_cart_add( $valid, $product_id, $quantity ) {    &nbsp;</div></li><li><div>  global $woocommerce;&nbsp;</div></li><li><div>  <span class="comment">//if ( !is_product() ) :</span>&nbsp;</div></li><li><div>      $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>      $maxqtycart = isset( $options['cart']['maxqtycart'] ) ? $options['cart']['maxqtycart'] : 0;&nbsp;</div></li><li><div>      $minqtycart = isset( $options['cart']['minqtycart'] ) ? $options['cart']['minqtycart'] : 0;&nbsp;</div></li><li><div>      $qtycnt = 0;&nbsp;</div></li><li><div>      $prodcnt = 0;&nbsp;</div></li><li><div>      foreach ( $woocommerce-&gt;cart-&gt;get_cart() as $cart_item_key =&gt; $values ) :&nbsp;</div></li><li><div>          $qtycnt += $values['quantity'];&nbsp;</div></li><li><div>          $prodcnt++;&nbsp;</div></li><li><div>      endforeach;&nbsp;</div></li><li><div>      $qtycnt += $quantity;&nbsp;</div></li><li><div>      if ( $maxqtycart && is_numeric($maxqtycart) && $qtycnt &gt; $maxqtycart ) :        &nbsp;</div></li><li><div>          wcpgsk_clear_messages();&nbsp;</div></li><li><div>          wcpgsk_add_message( sprintf( __( 'The overall sum for all product quantities is restricted to %s in this shop. Your overall quantity sum: %s. Please buy less quantity at least for some products.', WCPGSK_DOMAIN ), $maxqtycart, $qtycnt ) );&nbsp;</div></li><li><div>          wcpgsk_set_messages();                    &nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>      if ( $minqtycart && is_numeric($minqtycart) && $qtycnt &lt; $minqtycart ) :        &nbsp;</div></li><li><div>          wcpgsk_clear_messages();&nbsp;</div></li><li><div>          wcpgsk_add_message( sprintf( __( 'The required minimum sum for all product quantities is set to %s in this shop. Your overall quantity sum: %s. You have to add products to your cart or buy existing products in a higher quantity.', WCPGSK_DOMAIN ), $minqtycart, $qtycnt ) );&nbsp;</div></li><li><div>          wcpgsk_set_messages();                    &nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>  <span class="comment">//endif;</span>&nbsp;</div></li><li><div>  return $valid;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_add_cart_item') ) {&nbsp;</div></li><li><div>function wcpgsk_add_cart_item( $cart_item_data, $cart_item_key ) {&nbsp;</div></li><li><div>  global $woocommerce;&nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  $product_id = $cart_item_data['product_id'];&nbsp;</div></li><li><div>  $variation_id = $cart_item_data['variation_id'];&nbsp;</div></li><li><div>  $product = get_product($product_id);&nbsp;</div></li><li><div>  $quantity = $cart_item_data['quantity'];&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  $maxqty = isset($options['cart']['maxqty_' . $product-&gt;product_type]) ? $options['cart']['maxqty_' . $product-&gt;product_type] : 0;&nbsp;</div></li><li><div>  $minqty = isset($options['cart']['minqty_' . $product-&gt;product_type]) ? $options['cart']['minqty_' . $product-&gt;product_type] : 0;&nbsp;</div></li><li><div>  $stepqty = isset($options['cart']['stepqty_' . $product-&gt;product_type]) ? $options['cart']['stepqty_' . $product-&gt;product_type] : 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset($options['cart']['minmaxstepproduct']) && $options['cart']['minmaxstepproduct'] == 1 ) :&nbsp;</div></li><li><div>      $maxval = get_post_meta($product_id, '_wcpgsk_maxqty', true);&nbsp;</div></li><li><div>      if ( isset($maxval) && $maxval &gt; 0 ) :&nbsp;</div></li><li><div>          $maxqty = $maxval;&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>      $minval = get_post_meta($product_id, '_wcpgsk_minqty', true);&nbsp;</div></li><li><div>      if ( isset($minval) && $minval &gt; 0 ) :&nbsp;</div></li><li><div>          $minqty = $minval;&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>      $stepval = get_post_meta($product_id, '_wcpgsk_stepqty', true);&nbsp;</div></li><li><div>      if ( isset($stepval) && $stepval &gt; 0 ) :&nbsp;</div></li><li><div>          $stepqty = $stepval;&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ($minqty &gt; 0 && $quantity &lt; $minqty) :&nbsp;</div></li><li><div>      $cart_item_data['quantity'] = $minqty;&nbsp;</div></li><li><div>      wcpgsk_clear_messages();&nbsp;</div></li><li><div>      wcpgsk_add_message( sprintf( __( 'You have to buy a minimum quantity. We have set the required minimum of %s as quantity for you.', WCPGSK_DOMAIN ), $minqty ) );&nbsp;</div></li><li><div>      wcpgsk_set_messages();        &nbsp;</div></li><li><div>  elseif ($maxqty &gt; 0 && $quantity &gt; $maxqty) :&nbsp;</div></li><li><div>      $cart_item_data['quantity'] = $maxqty;&nbsp;</div></li><li><div>      wcpgsk_clear_messages();&nbsp;</div></li><li><div>      wcpgsk_add_message( sprintf(__( 'You cannot buy more than the allowed maximum quantity. We have set the allowed maximum of %s as quantity for you.', WCPGSK_DOMAIN ), $maxqty ) );&nbsp;</div></li><li><div>      wcpgsk_set_messages();&nbsp;</div></li><li><div>  elseif ( $stepqty &gt; 0 && ( $quantity % $stepqty ) &gt; 0 ) :&nbsp;</div></li><li><div>      $remainder = $quantity % $stepqty;&nbsp;</div></li><li><div>      $newqty = $quantity - $remainder;&nbsp;</div></li><li><div>      if ( $newqty &gt; 0 ) :&nbsp;</div></li><li><div>          $cart_item_data['quantity'] = $newqty;&nbsp;</div></li><li><div>      else :&nbsp;</div></li><li><div>          $newqty = $stepqty;&nbsp;</div></li><li><div>          $cart_item_data['quantity'] = $newqty;&nbsp;</div></li><li><div>      endif;        &nbsp;</div></li><li><div>      wcpgsk_clear_messages();&nbsp;</div></li><li><div>      wcpgsk_add_message( sprintf( __( 'You have to buy this product in multiples of %s. We have set the product quantity to the closest lower multiple available.', WCPGSK_DOMAIN ), $stepqty ) );&nbsp;</div></li><li><div>      wcpgsk_set_messages();                    &nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>  return $cart_item_data;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_after_cart_item_quantity_update') ) {&nbsp;</div></li><li><div>function wcpgsk_after_cart_item_quantity_update( $cart_item_key, $quantity ) {&nbsp;</div></li><li><div>  global $woocommerce;&nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  $product_id = $woocommerce-&gt;cart-&gt;cart_contents[$cart_item_key]['product_id'];&nbsp;</div></li><li><div>  $variation_id = $woocommerce-&gt;cart-&gt;cart_contents[$cart_item_key]['variation_id'];&nbsp;</div></li><li><div>  $product = get_product($product_id);&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  $maxqty = isset($options['cart']['maxqty_' . $product-&gt;product_type]) ? $options['cart']['maxqty_' . $product-&gt;product_type] : 0;&nbsp;</div></li><li><div>  $minqty = isset($options['cart']['minqty_' . $product-&gt;product_type]) ? $options['cart']['minqty_' . $product-&gt;product_type] : 0;&nbsp;</div></li><li><div>  if ( isset($options['cart']['minmaxstepproduct']) && $options['cart']['minmaxstepproduct'] == 1 ) :&nbsp;</div></li><li><div>      $product_id = $product-&gt;ID;        &nbsp;</div></li><li><div>      $maxval = get_post_meta($product_id, '_wcpgsk_maxqty', true);&nbsp;</div></li><li><div>      $minval = get_post_meta($product_id, '_wcpgsk_minqty', true);&nbsp;</div></li><li><div>      if ( isset($maxval) && $maxval &gt; 0 ) :&nbsp;</div></li><li><div>          $maxqty = $maxval;&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>      if ( isset($minval) && $minval &gt; 0 ) :&nbsp;</div></li><li><div>          $minqty = $minval;&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ($minqty &gt; 0 && $quantity &lt; $minqty) :&nbsp;</div></li><li><div>      $woocommerce-&gt;cart-&gt;cart_contents[$cart_item_key]['quantity'] = $minqty;&nbsp;</div></li><li><div>      wcpgsk_add_message( sprintf( __( 'You have to buy a minimum quantity. We have set the required minimum of %s as quantity for you.', WCPGSK_DOMAIN ), $minqty ) );&nbsp;</div></li><li><div>      wcpgsk_set_messages();&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  elseif ($maxqty &gt; 0 && $quantity &gt; $maxqty) :&nbsp;</div></li><li><div>      $woocommerce-&gt;cart-&gt;cart_contents[$cart_item_key]['quantity'] = $maxqty;&nbsp;</div></li><li><div>      wcpgsk_add_message( sprintf(__( 'You cannot buy more than the allowed maximum quantity. We have set the allowed maximum of %s as quantity for you.', WCPGSK_DOMAIN ), $maxqty ) );&nbsp;</div></li><li><div>      wcpgsk_set_messages();&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_maxitems_in_cart') ) {&nbsp;</div></li><li><div>function wcpgsk_maxitems_in_cart( $valid, $product_id, $quantity ) {&nbsp;</div></li><li><div>  global $woocommerce;&nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  $cartItems = sizeof( $woocommerce-&gt;cart-&gt;cart_contents );&nbsp;</div></li><li><div>  $allowed = isset($options['cart']['maxitemscart']) && $options['cart']['maxitemscart'] != 0 ? $options['cart']['maxitemscart'] : 0;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment"><span class="comment">//check cart items count and diminish if more than one variation for a product exists</span></span>&nbsp;</div></li><li><div>  if ( $allowed &gt; 0 && isset($options['cart']['variationscountasproduct']) && $options['cart']['variationscountasproduct'] == 0) {    &nbsp;</div></li><li><div>      $varproducts = array();&nbsp;</div></li><li><div>      foreach($woocommerce-&gt;cart-&gt;cart_contents as $i =&gt; $values) {&nbsp;</div></li><li><div>          $key = $values['product_id'];&nbsp;</div></li><li><div>          <span class="comment">//@TODO: Check layout of the question and answer</span>&nbsp;</div></li><li><div>          if (isset($values[$key]) && isset($values['variation_id']) && $values[$key] != $values['variation_id']) {&nbsp;</div></li><li><div>              if (isset($varproducts[$key])) $varproducts[$key] = 1;&nbsp;</div></li><li><div>              else $varproducts[$key] = 0;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if (!empty($varproducts)) $cartItems = $cartItems - array_sum($varproducts);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ( $allowed &gt; 0 && $cartItems &gt;= $allowed ) {&nbsp;</div></li><li><div>       <span class="comment"><span class="comment">// Sets error message.</span></span>&nbsp;</div></li><li><div>      wcpgsk_add_message( sprintf( __( 'You have reached the maximum amount of %s items allowed for your cart!', WCPGSK_DOMAIN ), $allowed ) );&nbsp;</div></li><li><div>      wcpgsk_set_messages();&nbsp;</div></li><li><div>      $valid = false;&nbsp;</div></li><li><div>      $cart_url = $woocommerce-&gt;cart-&gt;get_cart_url();&nbsp;</div></li><li><div>      wcpgsk_add_message( __('Remove products from the cart', WCPGSK_DOMAIN) . ': &lt;a href=&quot;' . $cart_url . '&quot;&gt;' . __('Cart', WCPGSK_DOMAIN) . '&lt;/a&gt;');&nbsp;</div></li><li><div>      wcpgsk_set_messages();&nbsp;</div></li><li><div>  }    &nbsp;</div></li><li><div>  return $valid;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_minitems_in_cart') ) {&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">* Validate product quantity on cart update.</span>&nbsp;</div></li><li><div><span class="comment">*/</span>&nbsp;</div></li><li><div>function wcpgsk_minitems_in_cart( $valid, $cart_item_key, $values, $quantity ) {&nbsp;</div></li><li><div>  global $woocommerce;&nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">//$cartItems = $woocommerce-&gt;cart-&gt;get_cart_contents_count(); //counts quantities as well and not only items</span>&nbsp;</div></li><li><div>  $cartItems = sizeof( $woocommerce-&gt;cart-&gt;cart_contents );&nbsp;</div></li><li><div>  $allowed = isset($options['cart']['minitemscart']) && $options['cart']['minitemscart'] != 0 ? $options['cart']['minitemscart'] : 0;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment"><span class="comment">//check cart items count and diminish if more than one variation for a product exists</span></span>&nbsp;</div></li><li><div>  if ($allowed &gt; 1 && isset($options['cart']['variationscountasproduct']) && $options['cart']['variationscountasproduct'] == 0) {    &nbsp;</div></li><li><div>      $varproducts = array();&nbsp;</div></li><li><div>      foreach($woocommerce-&gt;cart-&gt;cart_contents as $i =&gt; $values) {&nbsp;</div></li><li><div>          $key = $values['product_id'];&nbsp;</div></li><li><div>          <span class="comment">//@TODO: Check layout of the question and answer</span>            &nbsp;</div></li><li><div>          if (isset($values[$key]) && isset($values['variation_id']) && $values[$key] != $values['variation_id']) {&nbsp;</div></li><li><div>              if (isset($varproducts[$key])) $varproducts[$key] = 1;&nbsp;</div></li><li><div>              else $varproducts[$key] = 0;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if (!empty($varproducts)) $cartItems = $cartItems - array_sum($varproducts);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ($allowed &gt; 1 && $allowed &gt; $cartItems ) {&nbsp;</div></li><li><div>       <span class="comment"><span class="comment">// Sets error message.</span></span>&nbsp;</div></li><li><div>      wcpgsk_add_message( sprintf( __( 'You still have not reached the minimum amount of %s items required for your cart!', WCPGSK_DOMAIN ), $allowed ) );&nbsp;</div></li><li><div>      wcpgsk_set_messages();&nbsp;</div></li><li><div>      $valid = false;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      $shop_page_id = woocommerce_get_page_id( 'shop' );&nbsp;</div></li><li><div>      <span class="comment">//$shop_page_url = get_permalink(icl_object_id($shop_page_id, 'page', false));</span>&nbsp;</div></li><li><div>      $shop_page_url = get_permalink($shop_page_id);&nbsp;</div></li><li><div>      wcpgsk_add_message( __('Select more products from the shop', WCPGSK_DOMAIN) . ': &lt;a href=&quot;' . $shop_page_url . '&quot;&gt;' . __('Shop', WCPGSK_DOMAIN) . '&lt;/a&gt;');&nbsp;</div></li><li><div>      wcpgsk_set_messages();&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  }        &nbsp;</div></li><li><div>  return $valid;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_check_qty_config') ) {&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @changed 1.8.1 to fix sold_individually problem</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wcpgsk_check_qty_config( $return, $product ) {&nbsp;</div></li><li><div>  global $woocommerce;&nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  <span class="comment">//respect established will fix bug communicated</span>&nbsp;</div></li><li><div>  $switch = $return;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  switch ($product-&gt;product_type) {&nbsp;</div></li><li><div>      case 'variation' :&nbsp;</div></li><li><div>          if( isset($options['cart']['variationproductnoqty']) && $options['cart']['variationproductnoqty'] == 1)&nbsp;</div></li><li><div>              $switch = true;&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      case 'variable' :&nbsp;</div></li><li><div>          if(isset($options['cart']['variableproductnoqty']) && $options['cart']['variableproductnoqty'] == 1)&nbsp;</div></li><li><div>              $switch = true;&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      case 'external' :&nbsp;</div></li><li><div>          if( isset($options['cart']['externalproductnoqty']) && $options['cart']['externalproductnoqty'] == 1)&nbsp;</div></li><li><div>              $switch = true;&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      default :&nbsp;</div></li><li><div>          if( isset($options['cart']['simpleproductnoqty']) && $options['cart']['simpleproductnoqty'] == 1)&nbsp;</div></li><li><div>              $switch = true;&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return $switch;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_qtyselector_max') ) {&nbsp;</div></li><li><div>function wcpgsk_qtyselector_max( $whatever, $product = null ) {&nbsp;</div></li><li><div>  if ( isset( $product ) && is_object( $product ) ) :&nbsp;</div></li><li><div>      global $wcpgsk_session;&nbsp;</div></li><li><div>      $options = get_option( 'wcpgsk_settings' );    &nbsp;</div></li><li><div>      if ( $product-&gt;is_sold_individually() ) :&nbsp;</div></li><li><div>          $maxqty = 1;&nbsp;</div></li><li><div>      else :&nbsp;</div></li><li><div>          $maxqty = isset($options['cart']['maxqty_' . $product-&gt;product_type]) && $options['cart']['maxqty_' . $product-&gt;product_type] != 0 ? $options['cart']['maxqty_' . $product-&gt;product_type] : '';    &nbsp;</div></li><li><div>          if ( isset($options['cart']['minmaxstepproduct']) && $options['cart']['minmaxstepproduct'] == 1 ) :&nbsp;</div></li><li><div>              $product_id = $product-&gt;post-&gt;ID;        &nbsp;</div></li><li><div>              $maxval = get_post_meta($product_id, '_wcpgsk_maxqty', true);&nbsp;</div></li><li><div>              if ( isset($maxval) && $maxval &gt; 0 ) :&nbsp;</div></li><li><div>                  $maxqty = $maxval;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          if ($maxqty == '' && isset($wcpgsk_session-&gt;qtyargs['max_value']) ) {&nbsp;</div></li><li><div>              $maxqty = $wcpgsk_session-&gt;qtyargs['max_value'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>      return $maxqty;&nbsp;</div></li><li><div>  else :&nbsp;</div></li><li><div>      return $whatever;&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_qtyselector_min') ) {&nbsp;</div></li><li><div>function wcpgsk_qtyselector_min( $whatever, $product = null ) {&nbsp;</div></li><li><div>  if ( isset( $product ) && is_object( $product ) ) :&nbsp;</div></li><li><div>      global $wcpgsk_session;&nbsp;</div></li><li><div>      $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>      if ( $product-&gt;is_sold_individually() ) :&nbsp;</div></li><li><div>          $minqty = 1;&nbsp;</div></li><li><div>      else :&nbsp;</div></li><li><div>          $minqty = isset($options['cart']['minqty_' . $product-&gt;product_type]) && $options['cart']['minqty_' . $product-&gt;product_type] != 0 ? $options['cart']['minqty_' . $product-&gt;product_type] : 0;&nbsp;</div></li><li><div>          if ( isset($options['cart']['minmaxstepproduct']) && $options['cart']['minmaxstepproduct'] == 1 ) :&nbsp;</div></li><li><div>              $product_id = $product-&gt;post-&gt;ID;        &nbsp;</div></li><li><div>              $minval = get_post_meta($product_id, '_wcpgsk_minqty', true);&nbsp;</div></li><li><div>              if ( isset($minval) && $minval &gt; 0 ) :&nbsp;</div></li><li><div>                  $minqty = $minval;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          if ($minqty == '' && isset($wcpgsk_session-&gt;qtyargs['min_value']) ) {&nbsp;</div></li><li><div>              $minqty = $wcpgsk_session-&gt;qtyargs['min_value'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>      return $minqty;&nbsp;</div></li><li><div>  else :&nbsp;</div></li><li><div>      return $whatever;&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_quantity_input_step') ) {&nbsp;</div></li><li><div>function wcpgsk_quantity_input_step( $whatever, $product = null ) {&nbsp;</div></li><li><div>  if ( isset( $product ) && is_object( $product ) ) :&nbsp;</div></li><li><div>      global $wcpgsk_session;&nbsp;</div></li><li><div>      $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>      if ( $product-&gt;is_sold_individually() ) :&nbsp;</div></li><li><div>          $stepqty = 1;&nbsp;</div></li><li><div>      else :        &nbsp;</div></li><li><div>          $stepqty = isset($options['cart']['stepqty_' . $product-&gt;product_type]) && $options['cart']['stepqty_' . $product-&gt;product_type] != 0 ? $options['cart']['stepqty_' . $product-&gt;product_type] : 1;&nbsp;</div></li><li><div>          if ( isset($options['cart']['minmaxstepproduct']) && $options['cart']['minmaxstepproduct'] == 1 ) :&nbsp;</div></li><li><div>              $product_id = $product-&gt;post-&gt;ID;        &nbsp;</div></li><li><div>              $stepval = get_post_meta($product_id, '_wcpgsk_stepqty', true);&nbsp;</div></li><li><div>              if ( isset($stepval) && $stepval &gt; 0 ) :&nbsp;</div></li><li><div>                  $stepqty = $stepval;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>      return $stepqty;&nbsp;</div></li><li><div>  else :&nbsp;</div></li><li><div>      return $whatever;&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_qty_input_args') ) {&nbsp;</div></li><li><div> <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @changed 1.5.4 to avoid warnings in some php contexts</span>&nbsp;</div></li><li><div><span class="comment"> * @TODO: revision of this all as the whole process is not meaningful due to some other changes</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wcpgsk_qty_input_args($argss) {&nbsp;</div></li><li><div>  global $wcpgsk_session, $woocommerce;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ( !isset($wcpgsk_session) ) :&nbsp;</div></li><li><div>      $wcpgsk_session = $woocommerce-&gt;session;&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>  if ( isset($wcpgsk_session) && isset($args) && !empty($args) ) :    &nbsp;</div></li><li><div>      $wcpgsk_session-&gt;qtyargs = $args;&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>  return $args;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div> <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Redirect to fast checkout</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_add_to_checkout_redirect') ) {&nbsp;</div></li><li><div>function wcpgsk_add_to_checkout_redirect() {    &nbsp;</div></li><li><div>  return get_permalink( woocommerce_get_page_id( 'checkout' ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div> <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Redirect to cart</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_add_to_cart_redirect') ) {&nbsp;</div></li><li><div>function wcpgsk_add_to_cart_redirect() {    &nbsp;</div></li><li><div>  return get_permalink( woocommerce_get_page_id( 'cart' ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( isset($wcpgsk_options['process']['fastcart']) && $wcpgsk_options['process']['fastcart'] == 1 && $wcpgsk_options['process']['fastcheckout'] == 0) {&nbsp;</div></li><li><div>  update_option('woocommerce_cart_redirect_after_add', 'yes');&nbsp;</div></li><li><div>  <span class="comment">//update_option('woocommerce_enable_ajax_add_to_cart', 'no');</span>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>elseif ( isset($wcpgsk_options['process']['fastcheckout']) && $wcpgsk_options['process']['fastcheckout'] == 1 && $wcpgsk_options['process']['fastcart'] == 0) {&nbsp;</div></li><li><div>  update_option('woocommerce_cart_redirect_after_add', 'no');&nbsp;</div></li><li><div>  <span class="comment">//update_option('woocommerce_enable_ajax_add_to_cart', 'no');</span> //@TODO: check if this option is correct like this&nbsp;</div></li><li><div>  add_filter('add_to_cart_redirect', 'wcpgsk_add_to_checkout_redirect', 99); <span class="comment">//late execution, to assure that we overwrite WooCommerce Setting</span>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_cart_button_text') ) {&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Personalize Add to Cart Button</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wcpgsk_cart_button_text($label) {&nbsp;</div></li><li><div>  global $post;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  $cart_btn_text = ((!empty($options['process']['fastcheckoutbtn'])) ? __($options['process']['fastcheckoutbtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>  if ( isset( $post-&gt;ID ) && ( is_shop() || is_product() ) ) :&nbsp;</div></li><li><div>      $button_label = get_post_meta($post-&gt;ID, '_wcpgsk_button_label', true);&nbsp;</div></li><li><div>      if ( isset( $button_label ) && !empty( $button_label ) ) :&nbsp;</div></li><li><div>          $cart_btn_text = &quot;hoopie&quot;;<span class="comment"><span class="comment">//__( $button_label, WCPGSK_DOMAIN );</span></span>&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>  if ($cart_btn_text && $cart_btn_text != '')&nbsp;</div></li><li><div>      return $cart_btn_text;&nbsp;</div></li><li><div>  else return __('Add to Cart', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_grouped_cart_button_text') ) {&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Personalize Add to Cart Button</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wcpgsk_grouped_cart_button_text($label) {&nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  $cart_btn_text = ((!empty($options['process']['viewproductsbtn'])) ? __($options['process']['viewproductsbtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>  if ($cart_btn_text && $cart_btn_text != '')&nbsp;</div></li><li><div>      return $cart_btn_text;&nbsp;</div></li><li><div>  else return __('View options', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_variable_cart_button_text') ) {&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Personalize Add to Cart Button</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wcpgsk_variable_cart_button_text($label) {&nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  $cart_btn_text = ((!empty($options['process']['selectoptionsbtn'])) ? __($options['process']['selectoptionsbtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>  if ($cart_btn_text && $cart_btn_text != '')&nbsp;</div></li><li><div>      return $cart_btn_text;&nbsp;</div></li><li><div>  else return __('Select options', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_external_cart_button_text') ) {&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Personalize Add to Cart Button</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wcpgsk_external_cart_button_text($label) {&nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  $cart_btn_text = ((!empty($options['process']['readmorebtn'])) ? __($options['process']['readmorebtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>  if ($cart_btn_text && $cart_btn_text != '')&nbsp;</div></li><li><div>      return $cart_btn_text;&nbsp;</div></li><li><div>  else return __('Read more', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_outofstock_cart_button_text') ) {&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Personalize Add to Cart Button</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wcpgsk_outofstock_cart_button_text($label) {&nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  $cart_btn_text = ((!empty($options['process']['outofstockbtn'])) ? __($options['process']['outofstockbtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>  if ($cart_btn_text && $cart_btn_text != '')&nbsp;</div></li><li><div>      return $cart_btn_text;&nbsp;</div></li><li><div>  else return __('Read more', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_single_cart_button_text') ) {&nbsp;</div></li><li><div>function wcpgsk_single_cart_button_text($label, $ptype) {&nbsp;</div></li><li><div>  global $post;    &nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  $cart_btn_text = ((!empty($options['process']['fastcheckoutbtn'])) ? __($options['process']['fastcheckoutbtn'], WCPGSK_DOMAIN) : 'Add to Cart');&nbsp;</div></li><li><div>  if ( isset( $post-&gt;ID ) && ( is_shop() || is_product() ) ) :&nbsp;</div></li><li><div>      $button_label = get_post_meta($post-&gt;ID, '_wcpgsk_button_label', true);&nbsp;</div></li><li><div>      if ( isset( $button_label ) && !empty( $button_label ) ) :&nbsp;</div></li><li><div>          $cart_btn_text = &quot;hoopie&quot;;<span class="comment"><span class="comment">//__( $button_label, WCPGSK_DOMAIN );</span></span>&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ($cart_btn_text && $cart_btn_text != '')&nbsp;</div></li><li><div>      return $cart_btn_text;&nbsp;</div></li><li><div>  else return __('Add to Cart', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Personalize Add to Cart Button</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_product_single_cart_button_text') ) {&nbsp;</div></li><li><div>function wcpgsk_product_single_cart_button_text($label, $product) {&nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  $cart_btn_text = $label;&nbsp;</div></li><li><div>  if ( $label == __( 'Read more', 'woocommerce' ) ) :&nbsp;</div></li><li><div>      $cart_btn_text = ((!empty($options['process']['readmorebtn'])) ? __($options['process']['readmorebtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>  elseif ($label == __( 'Add to cart', 'woocommerce' ) ) :&nbsp;</div></li><li><div>      $cart_btn_text = ((!empty($options['process']['fastcheckoutbtn'])) ? __($options['process']['fastcheckoutbtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>      if ( isset( $product-&gt;post-&gt;ID ) && ( is_shop() || is_product() ) ) :&nbsp;</div></li><li><div>          $button_label = get_post_meta($product-&gt;post-&gt;ID, '_wcpgsk_button_label', true);&nbsp;</div></li><li><div>          if ( isset( $button_label ) && !empty( $button_label ) ) :&nbsp;</div></li><li><div>              $cart_btn_text = __( $button_label, WCPGSK_DOMAIN );&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      endif;        &nbsp;</div></li><li><div>  elseif ($label == __( 'Buy product', 'woocommerce' ) ) :&nbsp;</div></li><li><div>      $cart_btn_text = ((!empty($options['process']['buyproductbtn'])) ? __($options['process']['buyproductbtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>  elseif ($label == __( 'View products', 'woocommerce' ) ) :&nbsp;</div></li><li><div>      $cart_btn_text = ((!empty($options['process']['viewproductsbtn'])) ? __($options['process']['viewproductsbtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>  elseif ($label == __( 'Select options', 'woocommerce' ) ) :&nbsp;</div></li><li><div>      $cart_btn_text = ((!empty($options['process']['selectoptionsbtn'])) ? __($options['process']['selectoptionsbtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  return $cart_btn_text;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_product_cart_button_text') ) {&nbsp;</div></li><li><div>function wcpgsk_product_cart_button_text($label, $product) {&nbsp;</div></li><li><div>  $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>  $cart_btn_text = $label;&nbsp;</div></li><li><div>  if ( $label == __( 'Read more', 'woocommerce' ) ) :&nbsp;</div></li><li><div>      $cart_btn_text = ((!empty($options['process']['readmorebtn'])) ? __($options['process']['readmorebtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>  elseif ($label == __( 'Add to cart', 'woocommerce' ) ) :&nbsp;</div></li><li><div>      $cart_btn_text = ((!empty($options['process']['fastcheckoutbtn'])) ? __($options['process']['fastcheckoutbtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>      if ( isset( $product-&gt;post-&gt;ID ) && ( is_shop() || is_product() ) ) :&nbsp;</div></li><li><div>          $button_label = get_post_meta($product-&gt;post-&gt;ID, '_wcpgsk_button_label', true);&nbsp;</div></li><li><div>          if ( isset( $button_label ) && !empty( $button_label ) ) :&nbsp;</div></li><li><div>              $cart_btn_text = __( $button_label, WCPGSK_DOMAIN );&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      endif;                &nbsp;</div></li><li><div>  elseif ($label == __( 'Buy product', 'woocommerce' ) ) :&nbsp;</div></li><li><div>      $cart_btn_text = ((!empty($options['process']['buyproductbtn'])) ? __($options['process']['buyproductbtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>      if ( isset( $product-&gt;post-&gt;ID ) && ( is_shop() || is_product() ) ) :&nbsp;</div></li><li><div>          $button_label = get_post_meta($product-&gt;post-&gt;ID, '_wcpgsk_button_label', true);&nbsp;</div></li><li><div>          if ( isset( $button_label ) && !empty( $button_label ) ) :&nbsp;</div></li><li><div>              $cart_btn_text = __( $button_label, WCPGSK_DOMAIN );&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      endif;                        &nbsp;</div></li><li><div>  elseif ($label == __( 'View products', 'woocommerce' ) ) :&nbsp;</div></li><li><div>      $cart_btn_text = ((!empty($options['process']['viewproductsbtn'])) ? __($options['process']['viewproductsbtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>  elseif ($label == __( 'Select options', 'woocommerce' ) ) :&nbsp;</div></li><li><div>      $cart_btn_text = ((!empty($options['process']['selectoptionsbtn'])) ? __($options['process']['selectoptionsbtn'], WCPGSK_DOMAIN) : $label);&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  return $cart_btn_text;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//Payment gateways</span>&nbsp;</div></li><li><div>$wcpgsk_options = get_option('wcpgsk_settings');&nbsp;</div></li><li><div>if ( isset($wcpgsk_options['process']['paymentgateways']) && 1 == ($wcpgsk_options['process']['paymentgateways'])) :&nbsp;</div></li><li><div>  require_once ABSPATH . WPINC . '/pluggable.php';;&nbsp;</div></li><li><div>  if ( function_exists('WC') ) :&nbsp;</div></li><li><div>      require_once dirname(dirname(__FILE__)).'/woocommerce/includes/class-wc-payment-gateways.php';&nbsp;</div></li><li><div>      require_once dirname(dirname(__FILE__)).'/woocommerce/includes/class-wc-cart.php';&nbsp;</div></li><li><div>  else :&nbsp;</div></li><li><div>      require_once dirname(dirname(__FILE__)).'/woocommerce/classes/class-wc-payment-gateways.php';&nbsp;</div></li><li><div>      require_once dirname(dirname(__FILE__)).'/woocommerce/classes/class-wc-cart.php';&nbsp;</div></li><li><div>  endif; &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  add_action( 'add_meta_boxes', 'wcpgsk_gateways_meta_box_add' );  &nbsp;</div></li><li><div>  if ( !function_exists('wcpgsk_gateways_meta_box_add') ) {&nbsp;</div></li><li><div>  function wcpgsk_gateways_meta_box_add()  &nbsp;</div></li><li><div>  {  &nbsp;</div></li><li><div>      add_meta_box( 'payments', 'Payment Gateways', 'wcpgsk_payments_form', 'product', 'side', 'core' ); &nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( !function_exists('wcpgsk_payments_form') ) {&nbsp;</div></li><li><div>  function wcpgsk_payments_form()  &nbsp;</div></li><li><div>  {&nbsp;</div></li><li><div>      global $post;<span class="comment">//, $woo;</span>&nbsp;</div></li><li><div>      $postPayments = get_metadata('post', $post-&gt;ID, 'payment_gateways', false) ;&nbsp;</div></li><li><div>      $woogate = new WC_Payment_Gateways();&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      $payments = $woogate-&gt;payment_gateways();<span class="comment">//get_available_payment_gateways();</span>&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      foreach ($payments as $pay) {&nbsp;</div></li><li><div>          $checked = '';&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          if ( in_array($pay-&gt;id, $postPayments) ) $checked = ' checked=&quot;yes&quot; ';&nbsp;</div></li><li><div>          ?&gt;  &nbsp;</div></li><li><div>              &lt;input type=&quot;checkbox&quot; &lt;?php echo $checked; ?&gt; value=&quot;&lt;?php echo $pay-&gt;id; ?&gt;&quot; name=&quot;pays[]&quot; id=&quot;payments&quot; /&gt;&nbsp;</div></li><li><div>              &lt;label for=&quot;payment_gateway_meta_box_text&quot;&gt;&lt;?php echo $pay-&gt;title; ?&gt;&lt;/label&gt;  &nbsp;</div></li><li><div>              &lt;br /&gt;  &nbsp;</div></li><li><div>          &lt;?php &nbsp;</div></li><li><div>      } &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  } &nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  add_action('save_post', 'wcpgsk_gateways_meta_box_save', 10, 2 );&nbsp;</div></li><li><div>  if ( !function_exists('wcpgsk_gateways_meta_box_save') ) {&nbsp;</div></li><li><div>  function wcpgsk_gateways_meta_box_save( $post_id )  &nbsp;</div></li><li><div>  {   &nbsp;</div></li><li><div>      if(isset($_POST['post_type']) && $_POST['post_type']=='product') :&nbsp;</div></li><li><div>          delete_post_meta($post_id, 'payment_gateways');     &nbsp;</div></li><li><div>          if( isset( $_POST['pays'] ) && $_POST['pays']) :&nbsp;</div></li><li><div>              foreach($_POST['pays'] as $pay) :&nbsp;</div></li><li><div>                  add_post_meta($post_id, 'payment_gateways', $pay);                     &nbsp;</div></li><li><div>              endforeach;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( !function_exists('wcpgsk_restrict_payment_gateways') ) {&nbsp;</div></li><li><div>  function wcpgsk_restrict_payment_gateways( $restrict_gateways ) {&nbsp;</div></li><li><div>      global $woocommerce;&nbsp;</div></li><li><div>      $arrayKeys = array_keys($restrict_gateways);&nbsp;</div></li><li><div>      $items = isset($woocommerce-&gt;cart-&gt;cart_contents) ? $woocommerce-&gt;cart-&gt;cart_contents : array();&nbsp;</div></li><li><div>      $itemGateways = '';&nbsp;</div></li><li><div>      if($items)&nbsp;</div></li><li><div>          foreach($items as $item)&nbsp;</div></li><li><div>          $itemGateways[] = get_metadata('post', $item['product_id'], 'payment_gateways', false) ;&nbsp;</div></li><li><div>      if($itemGateways)&nbsp;</div></li><li><div>          foreach($itemGateways as $gateway)&nbsp;</div></li><li><div>          if(count($gateway)) :&nbsp;</div></li><li><div>              foreach($arrayKeys as $key) :&nbsp;</div></li><li><div>                  if(!in_array($key, $gateway)) :&nbsp;</div></li><li><div>                      unset($restrict_gateways[$key]);&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>              endforeach;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      return $restrict_gateways;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  add_filter( 'woocommerce_available_payment_gateways', 'wcpgsk_restrict_payment_gateways' );&nbsp;</div></li><li><div>endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !function_exists('wcpgsk_after_checkout_form') ) {&nbsp;</div></li><li><div>function wcpgsk_after_checkout_form($checkout) {&nbsp;</div></li><li><div>  if ( is_checkout() || is_account_page() ) :&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;div id=&quot;wcpgsk-dialog-validation-errors&quot; title=&quot;&lt;?php _e('Validation errors' , WCPGSK_DOMAIN); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>          &lt;p&gt;&lt;span class=&quot;ui-icon ui-icon-alert&quot; style=&quot;float: left; margin: 0 7px 20px 0;&quot;&gt;&lt;/span&gt;&lt;?php _e('Please check the fields marked with a red border. The values do not pass validation.' , WCPGSK_DOMAIN); ?&gt;&lt;/p&gt;        &nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      echo '&lt;script language=&quot;javascript&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo 'jQuery(document).ready(function() {&nbsp;</div></li><li><div>              var cT = &quot;' . __('Close', WCPGSK_DOMAIN) . '&quot;;&nbsp;</div></li><li><div>              var pT = &quot;' . __('&lt;Prev', WCPGSK_DOMAIN) . '&quot;;&nbsp;</div></li><li><div>              var nT = &quot;' . __('Next&gt;', WCPGSK_DOMAIN) . '&quot;;&nbsp;</div></li><li><div>              var cTT = &quot;' . __('Now', WCPGSK_DOMAIN) . '&quot;;&nbsp;</div></li><li><div>              var cTD = &quot;' . __('Today', WCPGSK_DOMAIN) . '&quot;;&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              var mN = [&quot;' . __('January', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('February', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('March', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('April', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('May', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('June', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('July', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('August', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('September', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('October', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('November', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('December', WCPGSK_DOMAIN) . '&quot;];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              var mNS = [&quot;' . __('Jan', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Feb', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Mar', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Apr', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('May', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Jun', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Jul', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Aug', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Sep', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Oct', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Nov', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Dec', WCPGSK_DOMAIN) . '&quot;];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              var dN = [&quot;' . __('Sunday', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Monday', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Tuesday', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Wednesday', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Thursday', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Friday', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Saturday', WCPGSK_DOMAIN) . '&quot;];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              var dNS = [&quot;' . __('Sun', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Mon', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Tue', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Wed', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Thu', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Fri', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                  &quot;' . __('Sat', WCPGSK_DOMAIN) . '&quot;];&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              jQuery(&quot;input[display=\'date\']&quot;).each(function(i, cal) {&nbsp;</div></li><li><div>                  var minD = &quot;' . $options['checkoutform']['mindate'] . '&quot;;&nbsp;</div></li><li><div>                  var maxD = &quot;' . $options['checkoutform']['maxdate'] . '&quot;;&nbsp;</div></li><li><div>                  if (jQuery(this).attr(&quot;mindays&quot;)) minD = jQuery(this).attr(&quot;mindays&quot;);&nbsp;</div></li><li><div>                  if (jQuery(this).attr(&quot;maxdays&quot;)) maxD = jQuery(this).attr(&quot;maxdays&quot;);&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  var dateF = &quot;yy/mm/dd&quot;;&nbsp;</div></li><li><div>                  if (jQuery(this).attr(&quot;dateformat&quot;) && jQuery(this).attr(&quot;dateformat&quot;) != null && jQuery(this).attr(&quot;dateformat&quot;) != &quot;&quot;) dateF = jQuery(this).attr(&quot;dateformat&quot;);&nbsp;</div></li><li><div>                  var exDays = &quot;&quot;;&nbsp;</div></li><li><div>                  var exDates = &quot;&quot;;&nbsp;</div></li><li><div>                  var exWeekend = &quot;0&quot;;&nbsp;</div></li><li><div>                  if (jQuery(this).attr(&quot;daysexcluded&quot;)) exDays = jQuery(this).attr(&quot;daysexcluded&quot;);&nbsp;</div></li><li><div>                  if (jQuery(this).attr(&quot;datesexcluded&quot;)) exDates = jQuery(this).attr(&quot;datesexcluded&quot;);&nbsp;</div></li><li><div>                  if (jQuery(this).attr(&quot;exweekend&quot;)) exWeekend = jQuery(this).attr(&quot;exweekend&quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  jQuery(this).prop(&quot;readonly&quot;, &quot;readonly&quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( exDays != null && exDays != &quot;&quot; ) exDays = jQuery.map(exDays.split(&quot;, &quot;), jQuery.trim); &nbsp;</div></li><li><div>                  if ( exDates != null && exDates != &quot;&quot; ) exDates = jQuery.map(exDates.split(&quot;, &quot;), jQuery.trim);&nbsp;</div></li><li><div>                  jQuery(this).datepicker({&nbsp;</div></li><li><div>                      changeMonth: true, &nbsp;</div></li><li><div>                      changeYear: true, &nbsp;</div></li><li><div>                      yearRange: &quot;-100:+100&quot;, &nbsp;</div></li><li><div>                       beforeShow: function() {&nbsp;</div></li><li><div>                      }, &nbsp;</div></li><li><div>                      beforeShowDay: function(date) {&nbsp;</div></li><li><div>                          show = true;&nbsp;</div></li><li><div>                          if ( exWeekend == &quot;1&quot; ) {&nbsp;</div></li><li><div>                              show = jQuery.datepicker.noWeekends(date)[0];&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          if ( show && exDays != null && exDays != &quot;&quot; && exDays.length &gt; 0 ) {&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                              if ( jQuery.inArray( date.getDay().toString(), exDays ) !== -1 ) show = false;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          if ( show && exDates != null && exDates != &quot;&quot; && exDates.length &gt; 0 ) { &nbsp;</div></li><li><div>                              checkDate = jQuery.datepicker.formatDate(dateF, date);&nbsp;</div></li><li><div>                              if ( jQuery.inArray( checkDate.toString(), exDates ) !== -1 ) show = false;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          return [show, &quot;&quot;, (!show) ? &quot;' . __('Date excluded', WCPGSK_DOMAIN) . '&quot; : &quot;&quot;];&nbsp;</div></li><li><div>                      }, &nbsp;</div></li><li><div>                      dateFormat: dateF, &nbsp;</div></li><li><div>                      minDate: minD, &nbsp;</div></li><li><div>                      maxDate: maxD, &nbsp;</div></li><li><div>                      dayNamesShort: dNS, &nbsp;</div></li><li><div>                      dayNames: dN, &nbsp;</div></li><li><div>                      monthNamesShort: mNS, &nbsp;</div></li><li><div>                      monthNames: mN, &nbsp;</div></li><li><div>                      closeText: cT, &nbsp;</div></li><li><div>                      prevText: pT, &nbsp;</div></li><li><div>                      nextText: nT, &nbsp;</div></li><li><div>                      currentText: cTD, &nbsp;</div></li><li><div>                      firstDay: 1&nbsp;</div></li><li><div>                  });        &nbsp;</div></li><li><div>              });&nbsp;</div></li><li><div>          ';&nbsp;</div></li><li><div>          if ( isset( $options['checkoutform']['caltimepicker'] ) && 1 == $options['checkoutform']['caltimepicker'] ) :&nbsp;</div></li><li><div>              echo '    jQuery(&quot;input[display=\'time\']&quot;).each(function() {&nbsp;</div></li><li><div>                  var hMax = 23;&nbsp;</div></li><li><div>                  var hMin = 0;                    &nbsp;</div></li><li><div>                  if (jQuery(this).attr(&quot;maxhour&quot;)) hMax = parseInt(jQuery(this).attr(&quot;maxhour&quot;));&nbsp;</div></li><li><div>                  if (jQuery(this).attr(&quot;minhour&quot;)) hMin = parseInt(jQuery(this).attr(&quot;minhour&quot;));&nbsp;</div></li><li><div>                  jQuery(this).prop(&quot;readonly&quot;, &quot;readonly&quot;);&nbsp;</div></li><li><div>                  jQuery(this).timepicker({&nbsp;</div></li><li><div>                      hourText: &quot;' . __( 'Hour', WCPGSK_DOMAIN ) . '&quot;, &nbsp;</div></li><li><div>                      minuteText: &quot;' . __( 'Minute', WCPGSK_DOMAIN ) . '&quot;, &nbsp;</div></li><li><div>                      hours: { starts: hMin, ends: hMax  }, &nbsp;</div></li><li><div>                      minutes: { interval: parseInt(jQuery(this).attr(&quot;minutesteps&quot;)) }, &nbsp;</div></li><li><div>                      rows: ( parseInt(jQuery(this).attr(&quot;minutesteps&quot;)) &lt; 5 ? 6 : ( parseInt(jQuery(this).attr(&quot;minutesteps&quot;)) &lt; 10 ? 4 : 3 ) ), &nbsp;</div></li><li><div>                      showPeriodLabels: false, &nbsp;</div></li><li><div>                      closeButtonText: &quot;' . __( 'Close', WCPGSK_DOMAIN ) . '&quot;, &nbsp;</div></li><li><div>                      showCloseButton: true, &nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                  });;&nbsp;</div></li><li><div>              });';&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>              echo '    jQuery(&quot;input[display=\'time\']&quot;).each(function() {&nbsp;</div></li><li><div>                  var hMax = 23;&nbsp;</div></li><li><div>                  var hMin = 0;&nbsp;</div></li><li><div>                  if (jQuery(this).attr(&quot;maxhour&quot;)) hMax = parseInt(jQuery(this).attr(&quot;maxhour&quot;));&nbsp;</div></li><li><div>                  if (jQuery(this).attr(&quot;minhour&quot;)) hMin = parseInt(jQuery(this).attr(&quot;minhour&quot;));&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  jQuery(this).prop(&quot;readonly&quot;, &quot;readonly&quot;);&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  jQuery(this).timepicker({&nbsp;</div></li><li><div>                      timeFormat: &quot;HH:mm&quot;, &nbsp;</div></li><li><div>                      hourMax: hMax, &nbsp;</div></li><li><div>                      hourMin: hMin, &nbsp;</div></li><li><div>                      stepHour: parseInt(jQuery(this).attr(&quot;hoursteps&quot;)), &nbsp;</div></li><li><div>                      stepMinute: parseInt(jQuery(this).attr(&quot;minutesteps&quot;)), &nbsp;</div></li><li><div>                      addSliderAccess: true, &nbsp;</div></li><li><div>                      sliderAccessArgs: { touchonly: false }, &nbsp;</div></li><li><div>                      timeText: &quot;' . __('Time', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                      hourText: &quot;' . __('Hour', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                      minuteText: &quot;' . __('Minute', WCPGSK_DOMAIN) . '&quot;, &nbsp;</div></li><li><div>                      currentText: cTT, &nbsp;</div></li><li><div>                      closeText: cT, &nbsp;</div></li><li><div>                      timeOnlyTitle: &quot;' . __('Choose Time', WCPGSK_DOMAIN) . '&quot;&nbsp;</div></li><li><div>                  });        &nbsp;</div></li><li><div>              });';&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          echo 'jQuery(&quot;input[display=\'number\']&quot;).each(function() {&nbsp;</div></li><li><div>                  var $this = this;&nbsp;</div></li><li><div>                  jQuery(this).after(&quot;&lt;div id=\'slider_&quot; + jQuery(this).attr(&quot;id&quot;) + &quot;\'&gt;&lt;/div&gt;&quot;);&nbsp;</div></li><li><div>                  if ( jQuery($this).attr(&quot;minvalue&quot;) ) {&nbsp;</div></li><li><div>                      jQuery($this).attr(&quot;min&quot;, jQuery($this).attr(&quot;minvalue&quot;) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  if ( jQuery($this).attr(&quot;rangemax&quot;) ) {&nbsp;</div></li><li><div>                      jQuery($this).attr(&quot;max&quot;, jQuery($this).attr(&quot;rangemax&quot;) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  if ( jQuery($this).attr(&quot;maxvalue&quot;) ) {&nbsp;</div></li><li><div>                      jQuery($this).attr(&quot;max&quot;, jQuery($this).attr(&quot;maxvalue&quot;) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  if ( jQuery(this).attr(&quot;numstep&quot;) ) {&nbsp;</div></li><li><div>                      jQuery($this).attr(&quot;step&quot;, jQuery($this).attr(&quot;numstep&quot;) );&nbsp;</div></li><li><div>                  }                &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if (jQuery($this).attr(&quot;numpres&quot;) == &quot;true&quot;) {&nbsp;</div></li><li><div>                      jQuery(&quot;#slider_&quot; + jQuery($this).attr(&quot;id&quot;)).slider({&nbsp;</div></li><li><div>                          range: true, &nbsp;</div></li><li><div>                          min: parseInt(jQuery($this).attr(&quot;minvalue&quot;)), &nbsp;</div></li><li><div>                          max: parseInt(jQuery($this).attr(&quot;maxvalue&quot;)), &nbsp;</div></li><li><div>                          step: parseInt(jQuery($this).attr(&quot;numstep&quot;)), &nbsp;</div></li><li><div>                          values: [ parseInt(jQuery($this).val()), parseInt(jQuery($this).attr(&quot;rangemax&quot;)) ], &nbsp;</div></li><li><div>                          slide: function( event, ui ) {&nbsp;</div></li><li><div>                              jQuery( $this ).val( ui.values[0] + &quot; - &quot; +  ui.values[1]);&nbsp;</div></li><li><div>                          }        &nbsp;</div></li><li><div>                      });&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  else {&nbsp;</div></li><li><div>                      jQuery($this).attr(&quot;type&quot;, &quot;number&quot;);&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                      jQuery(&quot;#slider_&quot; + jQuery($this).attr(&quot;id&quot;)).slider({&nbsp;</div></li><li><div>                          range: jQuery($this).attr(&quot;numpres&quot;), &nbsp;</div></li><li><div>                          min: parseInt(jQuery($this).attr(&quot;minvalue&quot;)), &nbsp;</div></li><li><div>                          max: parseInt(jQuery($this).attr(&quot;maxvalue&quot;)), &nbsp;</div></li><li><div>                          step: parseInt(jQuery($this).attr(&quot;numstep&quot;)), &nbsp;</div></li><li><div>                          value: parseInt(jQuery($this).val()), &nbsp;</div></li><li><div>                          slide: function( event, ui ) {&nbsp;</div></li><li><div>                              jQuery( $this ).val( ui.value );&nbsp;</div></li><li><div>                          }        &nbsp;</div></li><li><div>                      }).sliderAccess({ touchonly : true });&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              });&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>              jQuery(&quot;select[presentation=\'radio\']&quot;).each(function(i, select) {&nbsp;</div></li><li><div>                  var $select = jQuery(select);&nbsp;</div></li><li><div>                  $select.find(&quot;option&quot;).each(function(j, option) {&nbsp;</div></li><li><div>                      var $option = jQuery(option);&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">// Create a radio:</span></span>&nbsp;</div></li><li><div>                      if ($option.val() != null && $option.val() != &quot;&quot;) {&nbsp;</div></li><li><div>                          var $radio = jQuery(&quot;&lt;input type=\'radio\' /&gt;&quot;);&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">// Set name and value:</span></span>&nbsp;</div></li><li><div>                          $radio.attr(&quot;name&quot;, $select.attr(&quot;name&quot;)).attr(&quot;value&quot;, $option.val()).attr(&quot;class&quot;, &quot;radio&quot;).attr(&quot;style&quot;, &quot;width:10%&quot;);&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">// Set checked if the option was selected</span></span>&nbsp;</div></li><li><div>                          if ($option.attr(&quot;selected&quot;) != null && $option.attr(&quot;selected&quot;) == &quot;selected&quot; && $select.attr(&quot;hasselected&quot;) != null && $select.attr(&quot;hasselected&quot;) == &quot;true&quot; ) $radio.attr(&quot;checked&quot;, &quot;checked&quot;);&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//$radio.text($option.text());</span></span>&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">// Insert radio before select box:</span></span>&nbsp;</div></li><li><div>                          $select.before($radio);&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">// Insert a label:</span></span>&nbsp;</div></li><li><div>                          $select.before(&nbsp;</div></li><li><div>                            jQuery(&quot;&lt;span /&gt;&quot;).attr(&quot;for&quot;, $select.attr(&quot;name&quot;)).text($option.text())&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                          <span class="comment">// Insert a &lt;br /&gt;:</span>&nbsp;</div></li><li><div>                          $select.before(&quot;&lt;br/&gt;&quot;);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  });&nbsp;</div></li><li><div>                  $select.remove();&nbsp;</div></li><li><div>              });&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              jQuery(&quot;select[presentation=\'checkbox\']&quot;).each(function(i, select) {&nbsp;</div></li><li><div>                  var $select = jQuery(select);&nbsp;</div></li><li><div>                  $select.find(&quot;option&quot;).each(function(j, option) {&nbsp;</div></li><li><div>                      var $option = jQuery(option);&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">// Create a radio:</span></span>&nbsp;</div></li><li><div>                      if ($option.val() != null && $option.val() != &quot;&quot;) {&nbsp;</div></li><li><div>                          var $radio = jQuery(&quot;&lt;input type=\'checkbox\' /&gt;&quot;);&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">// Set name and value:</span></span>&nbsp;</div></li><li><div>                          $radio.attr(&quot;name&quot;, $select.attr(&quot;name&quot;) + &quot;[&quot; + j + &quot;]&quot;).attr(&quot;value&quot;, $option.val()).attr(&quot;class&quot;, &quot;checkbox&quot;).attr(&quot;style&quot;, &quot;width:10%&quot;);&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">// Set checked if the option was selected</span></span>&nbsp;</div></li><li><div>                          if ($option.attr(&quot;selected&quot;) != null && $option.attr(&quot;selected&quot;) == &quot;selected&quot; && $select.attr(&quot;hasselected&quot;) != null && $select.attr(&quot;hasselected&quot;) == &quot;true&quot; ) $radio.attr(&quot;checked&quot;, &quot;checked&quot;);&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//$radio.text($option.text());</span></span>&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">// Insert radio before select box:</span></span>&nbsp;</div></li><li><div>                          $select.before($radio);&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">// Insert a label:</span></span>&nbsp;</div></li><li><div>                          $select.before(&nbsp;</div></li><li><div>                            jQuery(&quot;&lt;span /&gt;&quot;).attr(&quot;for&quot;, $select.attr(&quot;name&quot;)).text($option.text())&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                          $select.before(&quot;&lt;br/&gt;&quot;);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  });&nbsp;</div></li><li><div>                  $select.remove();&nbsp;</div></li><li><div>              });&nbsp;</div></li><li><div>              jQuery(&quot;select[multiple=\'multiple\']&quot;).each(function(i, select) {&nbsp;</div></li><li><div>                  var $select = jQuery(select);&nbsp;</div></li><li><div>                  $select.attr(&quot;name&quot;, $select.attr(&quot;name&quot;) + &quot;[]&quot;);&nbsp;</div></li><li><div>              });&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>          });&nbsp;</div></li><li><div>      &lt;/script&gt;&lt;!--unit test after checkout end--&gt;';&nbsp;</div></li><li><div>      <span class="comment">//load our user scripts from db...</span>&nbsp;</div></li><li><div>      $wcpgsk_checkoutjs = get_option('wcpgsk_checkoutjs');&nbsp;</div></li><li><div>      if ( !empty($wcpgsk_checkoutjs) ) :&nbsp;</div></li><li><div>          echo '&lt;script language=&quot;javascript&quot;&gt;';&nbsp;</div></li><li><div>          echo $wcpgsk_checkoutjs;&nbsp;</div></li><li><div>          echo '&lt;/script&gt;';&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Handle functions deprecated in WooCommerce since 2.1.0 for WooCommerce installations &lt; 2.1</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function wcpgsk_add_error( $error ) {&nbsp;</div></li><li><div>  if ( function_exists('WC') && function_exists('wc_add_notice') ) :&nbsp;</div></li><li><div>      wc_add_notice( $error, 'error');&nbsp;</div></li><li><div>  else :&nbsp;</div></li><li><div>      global $woocommerce;&nbsp;</div></li><li><div>      $woocommerce-&gt;add_error( $error );&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wcpgsk_add_message( $message ) {&nbsp;</div></li><li><div>  if ( function_exists('WC') && function_exists('wc_add_notice') ) :&nbsp;</div></li><li><div>      wc_add_notice( $message );&nbsp;</div></li><li><div>  else :&nbsp;</div></li><li><div>      global $woocommerce;&nbsp;</div></li><li><div>      $woocommerce-&gt;add_message( $message );&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wcpgsk_clear_messages() {&nbsp;</div></li><li><div>  if ( function_exists('WC') && function_exists('wc_clear_notices') ) :&nbsp;</div></li><li><div>      wc_clear_notices();&nbsp;</div></li><li><div>  else :&nbsp;</div></li><li><div>      global $woocommerce;&nbsp;</div></li><li><div>      $woocommerce-&gt;clear_messages();&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wcpgsk_show_messages() {&nbsp;</div></li><li><div>  if ( function_exists('WC') && function_exists('wc_print_notices') ) :&nbsp;</div></li><li><div>      wc_print_notices();&nbsp;</div></li><li><div>  else :&nbsp;</div></li><li><div>      global $woocommerce;&nbsp;</div></li><li><div>      $woocommerce-&gt;show_messages();&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function wcpgsk_set_messages() {&nbsp;</div></li><li><div>  if ( !function_exists('WC') ) :&nbsp;</div></li><li><div>      global $woocommerce;&nbsp;</div></li><li><div>      $woocommerce-&gt;set_messages();&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>Woocommerce Poor Guys Swiss Knife</li><li><span></span>2.2.1</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>