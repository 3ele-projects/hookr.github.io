<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="2.2.1" data-slug="woocommerce-poor-guys-swiss-knife" data-type="file" data-id="65809"><head xmlns="http://www.w3.org/1999/xhtml"><title> classes-woocommerce-poor-guys-swiss-knife | file | Woocommerce Poor Guys Swiss Knife | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, woocommerce-poor-guys-swiss-knife, 2.2.1" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=fc1ed2946a1c06d1dbdfeb698ad51e5e' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/classes-woocommerce-poor-guys-swiss-knife/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fclasses-woocommerce-poor-guys-swiss-knife%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fclasses-woocommerce-poor-guys-swiss-knife%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-woocommerce-poor-guys-swiss-knife-2.2.1-file-classes-woocommerce-poor-guys-swiss-knife","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="classes-woocommerce-poor-guys-swiss-knife" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to woocommerce-poor-guys-swiss-k&hellip;." href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/" class="plugin"><span property="name">woocommerce-poor-guys-swiss-k&hellip;</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.2.1." href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/" class="H_VERSION"><span property="name">2.2.1</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">classes-woocommerce-poor-guys&hellip;</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="93"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/all/" title="All">All <span class="count badge">93</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="45"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/hooks/" title="Hooks">Hooks <span class="count badge">45</span></a></li><li class="" data-id="action" data-count="21"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/actions/" title="Actions">Actions <span class="count badge">21</span></a></li><li class="" data-id="filter" data-count="24"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/filters/" title="Filters">Filters <span class="count badge">24</span></a></li><li class="" data-id="class" data-count="4"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/classes/" title="Classes">Classes <span class="count badge">4</span></a></li><li class="" data-id="constant" data-count="3"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/constants/" title="Constants">Constants <span class="count badge">3</span></a></li><li class="" data-id="function" data-count="41"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/functions/" title="Functions">Functions <span class="count badge">41</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/plugins/woocommerce-poor-guys-swiss-knife/2.2.1/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/classes/woocommerce-poor-guys-swiss-knife.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php &nbsp;</div></li><li><div>if ( ! defined( 'ABSPATH' ) ) exit;&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * WooCommercePoorGuysSwissKnife Main Class</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @class         WCPGSK_Main</span>&nbsp;</div></li><li><div><span class="comment"> * @version        1.4</span>&nbsp;</div></li><li><div><span class="comment"> * @package        WooCommerce-Poor-Guys-Swiss-Knife/Classes</span>&nbsp;</div></li><li><div><span class="comment"> * @category    Class</span>&nbsp;</div></li><li><div><span class="comment"> * @author         Uli Hake</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>if ( ! class_exists ( 'WCPGSK_Main' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  class WCPGSK_Main {&nbsp;</div></li><li><div>      private $dir;&nbsp;</div></li><li><div>      private $assets_dir;&nbsp;</div></li><li><div>      private $assets_url;&nbsp;</div></li><li><div>      public $version;&nbsp;</div></li><li><div>      private $file;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Constructor function.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return void</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function __construct( $file ) {&nbsp;</div></li><li><div>          global $wcpgsk_about;&nbsp;</div></li><li><div>          $this-&gt;dir = dirname( $file );&nbsp;</div></li><li><div>          $this-&gt;file = $file;&nbsp;</div></li><li><div>          $this-&gt;assets_dir = trailingslashit( $this-&gt;dir ) . 'assets';&nbsp;</div></li><li><div>          $this-&gt;assets_url = esc_url( trailingslashit( plugins_url( '/assets/', $file ) ) );&nbsp;</div></li><li><div>          $this-&gt;load_plugin_textdomain();        &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_action( 'init', array( $this, 'load_localisation' ), 0 );&nbsp;</div></li><li><div>          <span class="comment">// Run this on activation.</span>&nbsp;</div></li><li><div>          register_activation_hook( $this-&gt;file, array( $this, 'activation' ) );&nbsp;</div></li><li><div>          if ( is_admin() ) : <span class="comment">// admin actions</span>&nbsp;</div></li><li><div>              <span class="comment">// Hook into admin_init first</span>&nbsp;</div></li><li><div>              add_action( 'admin_init', array($this, 'wcpgsk_register_setting') );&nbsp;</div></li><li><div>              add_filter( 'plugin_action_links_'. plugin_basename($this-&gt;file), array($this, 'wcpgsk_admin_plugin_actions'), -10 );&nbsp;</div></li><li><div>              add_action( 'admin_menu', array($this, 'wcpgsk_admin_menu') );                &nbsp;</div></li><li><div>              $wcpgsk_about = new WCPGSK_About( $this-&gt;file );&nbsp;</div></li><li><div>              <span class="comment">//add_action( 'add_meta_boxes', array($this, 'wcpgsk_add_meta_box_minmaxstep'), 10 );</span>&nbsp;</div></li><li><div>              add_action('woocommerce_product_options_general_product_data', array( $this, 'wcpgsk_set_price_html' ), 99 );&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              add_action( 'woocommerce_product_write_panel_tabs', array( $this, 'wcpgsk_product_write_panel_tab' ), 99 );&nbsp;</div></li><li><div>              add_action( 'woocommerce_product_write_panels', array( $this, 'wcpgsk_product_write_panels' ), 99 );&nbsp;</div></li><li><div>              add_action( 'woocommerce_process_product_meta', array( $this, 'wcpgsk_process_product_meta' ), 99);&nbsp;</div></li><li><div>              add_action( 'woocommerce_process_product_meta_variable', array( $this, 'wcpgsk_process_product_meta' ), 99);&nbsp;</div></li><li><div>              add_action('wp_ajax_get_locale_field_form', array($this, 'get_locale_field_form_callback'));    &nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              add_action('wp_ajax_wcpgsk_save_checkoutjs', array($this, 'wcpgsk_save_checkoutjs_callback'));    &nbsp;</div></li><li><div>              add_action( 'wcpgsk_settings_page_email', array( $this, 'wcpgsk_settings_page_email_wcpgsk' ), 10, 1 );&nbsp;</div></li><li><div>              add_action( 'wcpgsk_settings_page_labels', array( $this, 'wcpgsk_page_labels' ), 10, 1 );&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          <span class="comment">//billing and shipping filters</span>&nbsp;</div></li><li><div>          add_filter( 'woocommerce_billing_fields' , array($this, 'add_billing_custom_fields'), 10, 1 );&nbsp;</div></li><li><div>          add_filter( 'woocommerce_shipping_fields' , array($this, 'add_shipping_custom_fields'), 10, 1 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_filter('woocommerce_admin_billing_fields', array($this, 'wcpgsk_admin_billing_fields'), 10, 1);&nbsp;</div></li><li><div>          add_filter('woocommerce_admin_shipping_fields', array($this, 'wcpgsk_admin_shipping_fields'), 10, 1);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_filter( 'woocommerce_checkout_fields' , array($this, 'wcpgsk_checkout_fields_billing'), 10, 1 );&nbsp;</div></li><li><div>          add_filter( 'woocommerce_checkout_fields' , array($this, 'wcpgsk_checkout_fields_shipping'), 10, 1 );&nbsp;</div></li><li><div>          if ( function_exists('WC') ) :&nbsp;</div></li><li><div>              add_filter( 'wc_address_i18n_params', array($this, 'wcpgsk_address_i18n_params'), 10, 1 );<span class="comment">//$this-&gt;locale['default'] );</span>&nbsp;</div></li><li><div>              <span class="comment">//bind late to allow other plugins to add their fields</span>&nbsp;</div></li><li><div>              add_filter( 'woocommerce_country_locale_field_selectors', array($this, 'wcpgsk_country_locale_field_selectors'), 99, 1);&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              add_filter( 'woocommerce_params', array($this, 'wcpgsk_address_i18n_params'), 10, 1 );<span class="comment">// $woocommerce_params )            </span>&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          add_action( 'woocommerce_checkout_process', array($this, 'wcpgsk_checkout_process'), 9 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_filter( 'woocommerce_load_order_data', array($this, 'wcpgsk_load_order_data'), 5, 1);&nbsp;</div></li><li><div>          add_action( 'woocommerce_checkout_init', array($this, 'wcpgsk_checkout_init'), 10, 1 );&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>          add_action( 'woocommerce_email_after_order_table', array($this, 'wcpgsk_email_after_order_table') );&nbsp;</div></li><li><div>          add_action( 'woocommerce_order_details_after_order_table', array($this, 'wcpgsk_order_details_after_order_table'), 10, 1 );&nbsp;</div></li><li><div>          add_filter( 'woocommerce_address_to_edit', array($this, 'wcpgsk_address_to_edit'), 10, 1 );&nbsp;</div></li><li><div>          add_action( 'woocommerce_after_template_part', array($this, 'wcpgsk_after_template_part'), 10, 4 );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          add_filter( 'woocommerce_process_myaccount_field_billing_postcode', array($this, 'wcpgsk_process_myaccount_field_billing_postcode'), 99, 1 );&nbsp;</div></li><li><div>          add_filter( 'woocommerce_process_myaccount_field_shipping_postcode', array($this, 'wcpgsk_process_myaccount_field_shipping_postcode'), 99, 1 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_filter( 'woocommerce_order_formatted_billing_address', array($this, 'wcpgsk_order_formatted_billing_address'), 99 );&nbsp;</div></li><li><div>          add_filter( 'woocommerce_order_formatted_shipping_address', array($this, 'wcpgsk_order_formatted_shipping_address'), 99 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_filter( 'woocommerce_user_column_billing_address', array($this, 'wcpgsk_order_formatted_billing_address'), 99 );&nbsp;</div></li><li><div>          add_filter( 'woocommerce_user_column_shipping_address', array($this, 'wcpgsk_order_formatted_shipping_address'), 99 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_filter( 'woocommerce_customer_meta_fields', array($this, 'wcpgsk_customer_meta_fields'), 99 );&nbsp;</div></li><li><div>          <span class="comment">//add_filter( 'woocommerce_customer_meta_fields', array($this, 'wcpgsk_customer_meta_fields'), 99 );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_filter( 'woocommerce_email_headers', array( $this, 'wcpgsk_email_headers' ), PHP_INT_MAX, 3 );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          add_action( 'wp_print_scripts', array($this, 'wcpgsk_handle_scripts'), 100 );&nbsp;</div></li><li><div>          add_action( 'wp_enqueue_scripts', array($this, 'wcpgsk_degenerate'), 100 );        &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          add_filter( 'woocommerce_sale_flash', array( $this, 'wcpgsk_sale_flash' ), 10, 3 );&nbsp;</div></li><li><div>          add_action( 'woocommerce_proceed_to_checkout', array( $this, 'wcpgsk_after_cart' ), 10 );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          add_action( 'woocommerce_init', array( $this, 'wcpgsk_empty_cart' ), PHP_INT_MAX );&nbsp;</div></li><li><div>          add_action( 'woocommerce_checkout_update_order_meta', array( $this, 'wcpgsk_checkout_update_order_meta' ), 10, 2 );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          add_filter('woocommerce_get_price_html', array( $this, 'wcpgsk_get_price_html' ), 10, 2 );&nbsp;</div></li><li><div>          add_filter('woocommerce_empty_price_html', array( $this, 'wcpgsk_empty_price_html' ), PHP_INT_MAX, 2 );&nbsp;</div></li><li><div>          add_filter('woocommerce_free_sale_price_html', array( $this, 'wcpgsk_free_sale_price_html' ), PHP_INT_MAX, 2 );&nbsp;</div></li><li><div>          add_filter('woocommerce_free_price_html', array( $this, 'wcpgsk_free_price_html' ), PHP_INT_MAX, 2 );&nbsp;</div></li><li><div>          add_filter('woocommerce_after_my_account', array( $this, 'wcpgsk_after_my_account' ), 10 );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Process empty cart request</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.9.7</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_empty_cart() {&nbsp;</div></li><li><div>          if ( isset( $_POST['wcpgsk_empty_cart'] ) ) {                &nbsp;</div></li><li><div>              global $woocommerce;&nbsp;</div></li><li><div>              $woocommerce-&gt;cart-&gt;empty_cart();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Add empty cart form</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.9.7</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_after_cart( ) {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          if ( isset( $options['cart']['addemptycart'] ) && $options['cart']['addemptycart'] ) :&nbsp;</div></li><li><div>              if ( isset( $options['process']['confirmemptycart'] ) && !empty( $options['process']['confirmemptycart'] ) ) :&nbsp;</div></li><li><div>                  $eclabel = isset( $options['process']['emptycartlabel'] ) && !empty( $options['process']['emptycartlabel'] ) ? $options['process']['emptycartlabel'] : &quot;Empty cart&quot;; &nbsp;</div></li><li><div>                  $cclabel = isset( $options['process']['confirmemptycart'] ) && !empty( $options['process']['confirmemptycart'] ) ? $options['process']['confirmemptycart'] : &quot;Yes, empty cart&quot;; &nbsp;</div></li><li><div>                  echo '&lt;div class=&quot;wcpgsk_empty_cart&quot;&gt;&lt;input type=&quot;button&quot; class=&quot;button&quot; style=&quot;width:100%&quot; id=&quot;wcpgsk_confirm_empty_cart&quot; value=&quot;' . __( $eclabel, WCPGSK_DOMAIN) . '&quot;/&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>                  echo '&lt;div class=&quot;wcpgsk_empty_cart&quot;&gt;&lt;input type=&quot;submit&quot; class=&quot;button&quot; style=&quot;display:none;width:100%&quot; id=&quot;wcpgsk_empty_cart&quot; name=&quot;wcpgsk_empty_cart&quot; value=&quot;' . __( $cclabel, WCPGSK_DOMAIN) . '&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>              else :&nbsp;</div></li><li><div>                  $eclabel = isset( $options['process']['emptycartlabel'] ) && !empty( $options['process']['emptycartlabel'] ) ? $options['process']['emptycartlabel'] : &quot;Empty cart&quot;; &nbsp;</div></li><li><div>                  echo '&lt;div class=&quot;wcpgsk_empty_cart&quot;&gt;&lt;input type=&quot;submit&quot; class=&quot;button&quot; name=&quot;wcpgsk_empty_cart&quot; value=&quot;' . __( $eclabel, WCPGSK_DOMAIN) . '&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Sale flash text</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.9.7</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $flash</span>&nbsp;</div></li><li><div><span class="comment">       * @param mixed $post</span>&nbsp;</div></li><li><div><span class="comment">       * @param mixed $product</span>&nbsp;</div></li><li><div><span class="comment">       * @return string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_sale_flash( $flash, $post, $product ) {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );                    &nbsp;</div></li><li><div>          <span class="comment">//$lp = get_product( $product-&gt;post-&gt;ID );</span>&nbsp;</div></li><li><div>          if ( $product-&gt;get_price() === '' || $product-&gt;get_price() == 0 ) :&nbsp;</div></li><li><div>              return '';&nbsp;</div></li><li><div>          endif;            &nbsp;</div></li><li><div>          $product_id = $product-&gt;post-&gt;ID;&nbsp;</div></li><li><div>          $onsale_label = get_post_meta($product_id, '_wcpgsk_onsale_html', true);&nbsp;</div></li><li><div>          if ( isset( $onsale_label ) && !empty( $onsale_label ) ) :&nbsp;</div></li><li><div>              return '&lt;span class=&quot;onsale&quot;&gt;' . __( $onsale_label, WCPGSK_DOMAIN ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          if ( isset( $options['process']['onsalelabel'] ) && !empty( $options['process']['onsalelabel'] ) ) :&nbsp;</div></li><li><div>              $flash = '&lt;span class=&quot;onsale&quot;&gt;' . __( $options['process']['onsalelabel'], WCPGSK_DOMAIN ) . '&lt;/span&gt;';&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          return $flash;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Add additional email headers</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.9.7</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $headers (existing)</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $context</span>&nbsp;</div></li><li><div><span class="comment">       * @param mixed $email</span>&nbsp;</div></li><li><div><span class="comment">       * @return string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_email_headers( $headers = '', $context = '', $email = array() ) {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          if ( isset( $headers ) && !empty( $headers ) ) :&nbsp;</div></li><li><div>              $headers = explode( &quot;\r\n&quot;, $headers );&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              $headers = array();&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          if ( isset( $options['email']['wc_cc_email'] ) && !empty( $options['email']['wc_cc_email'] ) && is_email( $options['email']['wc_cc_email'] ) ) :&nbsp;</div></li><li><div>              $headers[] = &quot;Cc: &quot; . $options['email']['wc_cc_email'];&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          if ( isset($options['email']['wc_bcc_email']) && !empty( $options['email']['wc_bcc_email'] ) && is_email( $options['email']['wc_bcc_email'] ) ) :            &nbsp;</div></li><li><div>              $headers[] = &quot;Bcc: &quot; . $options['email']['wc_bcc_email'];            &nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          return implode( &quot;\r\n&quot;, $headers);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Email configuration settings</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.9.7</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $options </span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_settings_page_email_wcpgsk( $options ) {&nbsp;</div></li><li><div>          if ( isset( $options['email']['wc_cc_email'] ) && !empty( $options['email']['wc_cc_email'] ) ) :            &nbsp;</div></li><li><div>              $emails = explode( ', ', str_replace( ';', ', ', $options['email']['wc_cc_email'] ) );&nbsp;</div></li><li><div>              $options['email']['wc_cc_email'] = isset( $emails[0] ) ? $emails[0] : '';&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              $options['email']['wc_cc_email'] = '';                &nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          if ( isset($options['email']['wc_bcc_email']) && !empty( $options['email']['wc_bcc_email'] ) ) :            &nbsp;</div></li><li><div>              $emails = explode( ', ', str_replace( ';', ', ', $options['email']['wc_bcc_email'] ) );&nbsp;</div></li><li><div>              $options['email']['wc_bcc_email'] = isset( $emails[0] ) ? $emails[0] : '';&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              $options['email']['wc_bcc_email'] = '';&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>          &lt;h3 class=&quot;wcpgsk_acc_header&quot;&gt;&lt;?php echo __('Email Settings', WCPGSK_DOMAIN); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>          &lt;div&gt;&nbsp;</div></li><li><div>              &lt;table class=&quot;widefat&quot; border=&quot;1&quot; &gt;&nbsp;</div></li><li><div>              &lt;thead&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;th&gt;&lt;?php _e('Settings Name', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                      &lt;th&gt;&lt;?php _e('Data', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;        &nbsp;</div></li><li><div>                      &lt;th&gt;&lt;?php _e('Comments', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>              &lt;/thead&gt;&nbsp;</div></li><li><div>              &lt;tbody&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Carbon Copy Email (CC) Recipient', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[email][wc_cc_email]&quot; id=&quot;wcpgsk_wc_cc_email&quot; type=&quot;email&quot; value=&quot;&lt;?php echo $options['email']['wc_cc_email'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Specify a valid email address that will receive copies of all WooCommerce emails.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Blind Carbon Copy (BCC) Email Recipient', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[email][wc_bcc_email]&quot; id=&quot;wcpgsk_wc_bcc_email&quot; type=&quot;email&quot; value=&quot;&lt;?php echo $options['email']['wc_bcc_email'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Specify a valid email address that will receive hidden copies of all WooCommerce emails.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&lt;td colspan=&quot;3&quot;&gt;&lt;?php _e('WooCommerce Rich Guys Swiss Knife includes more email options, e.g. context dependent cc and bcc email recipients, etc.', WCPGSK_DOMAIN); ?&gt;&lt;/td&gt;&lt;/tr&gt;    &nbsp;</div></li><li><div>              &lt;/tbody&gt;&nbsp;</div></li><li><div>              &lt;/table&gt;&nbsp;</div></li><li><div>              &lt;?php submit_button( __( 'Save Changes', WCPGSK_DOMAIN ) ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Add extended amount information</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @output fields</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_set_price_html() {&nbsp;</div></li><li><div>          woocommerce_wp_text_input(array('id' =&gt; '_wcpgsk_button_label', 'label' =&gt; __('Specify button label', WCPGSK_DOMAIN) ));&nbsp;</div></li><li><div>          woocommerce_wp_text_input(array('id' =&gt; '_wcpgsk_extend_price', 'label' =&gt; __('Specify extended price data', WCPGSK_DOMAIN) ));&nbsp;</div></li><li><div>          $placements = array( &nbsp;</div></li><li><div>              'after' =&gt; __( 'After price', WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>              'before' =&gt; __( 'Before price', WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>              'newline' =&gt; __( 'On newline', WCPGSK_DOMAIN ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          woocommerce_wp_select(array('id' =&gt; '_wcpgsk_extend_price_placement', 'label' =&gt; __('Select placement of extended price data', WCPGSK_DOMAIN), 'options' =&gt; $placements ));&nbsp;</div></li><li><div>          woocommerce_wp_text_input(array('id' =&gt; '_wcpgsk_onsale_html', 'label' =&gt; __('Specify on sale label', WCPGSK_DOMAIN) ));&nbsp;</div></li><li><div>          woocommerce_wp_text_input(array('id' =&gt; '_wcpgsk_empty_price_html', 'label' =&gt; __('Specify empty price label', WCPGSK_DOMAIN) ));&nbsp;</div></li><li><div>          woocommerce_wp_text_input(array('id' =&gt; '_wcpgsk_free_price_html', 'label' =&gt; __('Specify free price label', WCPGSK_DOMAIN) ));&nbsp;</div></li><li><div>          woocommerce_wp_text_input(array('id' =&gt; '_wcpgsk_free_sale_html', 'label' =&gt; __('Specify free sales label', WCPGSK_DOMAIN) ));&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Display extended price information</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $price</span>&nbsp;</div></li><li><div><span class="comment">       * @param mixed $product</span>&nbsp;</div></li><li><div><span class="comment">       * @return string $price extended</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_get_price_html($price, $product) {&nbsp;</div></li><li><div>          $product_id = $product-&gt;post-&gt;ID;&nbsp;</div></li><li><div>          $extend_price_data = get_post_meta($product_id, '_wcpgsk_extend_price', true);&nbsp;</div></li><li><div>          if ( isset( $extend_price_data ) && !empty( $extend_price_data ) ) :&nbsp;</div></li><li><div>              $extend_price_placement = get_post_meta($product_id, '_wcpgsk_extend_price_placement', true);&nbsp;</div></li><li><div>              switch ( $extend_price_placement ) :&nbsp;</div></li><li><div>                  case &quot;before&quot; :&nbsp;</div></li><li><div>                      $price = '&lt;span class=&quot;wcpgsk-extend-price-data&quot;&gt;' . __( $extend_price_data, WCPGSK_DOMAIN ) . '&lt;/span&gt; ' . $price;&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  case &quot;newline&quot; :&nbsp;</div></li><li><div>                      $price = $price . '&lt;div class=&quot;wcpgsk-extend-price-data&quot;&gt;' . __( $extend_price_data, WCPGSK_DOMAIN ) . '&lt;/div&gt;';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  default :&nbsp;</div></li><li><div>                      $price = $price . ' &lt;span class=&quot;wcpgsk-extend-price-data&quot;&gt;' . __( $extend_price_data, WCPGSK_DOMAIN ) . '&lt;/span&gt;';                        &nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              endswitch;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          if ( $product-&gt;managing_stock() ) :&nbsp;</div></li><li><div>              $hdl_backorder = $product-&gt;get_availability();&nbsp;</div></li><li><div>              $options = get_option( 'wcpgsk_settings' );                    &nbsp;</div></li><li><div>              if ( isset( $hdl_backorder ) && $hdl_backorder['class'] == 'available-on-backorder' && isset( $options['process']['backorderlabel'] ) && !empty( $options['process']['backorderlabel'] ) ) :&nbsp;</div></li><li><div>                  $price = $price . '&lt;div class=&quot;wcpgsk-extend-price-data&quot;&gt;' . __( $options['process']['backorderlabel'], WCPGSK_DOMAIN ) . '&lt;/div&gt;';&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          return $price;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Display empty price label if defined as label or for product</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $empty</span>&nbsp;</div></li><li><div><span class="comment">       * @param mixed $product</span>&nbsp;</div></li><li><div><span class="comment">       * @return string $price label for empty</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_empty_price_html( $empty, $product ) {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );        &nbsp;</div></li><li><div>          $product_id = $product-&gt;post-&gt;ID;&nbsp;</div></li><li><div>          $g_empty_price = isset( $options['process']['empty_price_html'] ) && !empty( $options['process']['empty_price_html'] ) ? $options['process']['empty_price_html'] : '';&nbsp;</div></li><li><div>          $p_empty_price = get_post_meta($product_id, '_wcpgsk_empty_price_html', true);&nbsp;</div></li><li><div>          if ( isset( $p_empty_price ) && !empty( $p_empty_price ) ) :&nbsp;</div></li><li><div>              return $p_empty_price;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          return $g_empty_price;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Display free sales price label if defined for a product</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $empty</span>&nbsp;</div></li><li><div><span class="comment">       * @param mixed $product</span>&nbsp;</div></li><li><div><span class="comment">       * @return string $price label for empty</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_free_sale_price_html( $price, $product ) {&nbsp;</div></li><li><div>          $product_id = $product-&gt;post-&gt;ID;&nbsp;</div></li><li><div>          $free_sales_label = get_post_meta($product_id, '_wcpgsk_free_sale_html', true);&nbsp;</div></li><li><div>          if ( isset( $free_sales_label ) && !empty( $free_sales_label ) ) :&nbsp;</div></li><li><div>              $price = str_replace( __( 'Free!', 'woocommerce' ), __( $free_sales_label, WCPGSK_DOMAIN ), $price );&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          return $price;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Display free price label if defined for a product</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.1.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $empty</span>&nbsp;</div></li><li><div><span class="comment">       * @param mixed $product</span>&nbsp;</div></li><li><div><span class="comment">       * @return string $price label for empty</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_free_price_html( $price, $product ) {&nbsp;</div></li><li><div>          $product_id = $product-&gt;post-&gt;ID;&nbsp;</div></li><li><div>          $free_price_label = get_post_meta($product_id, '_wcpgsk_free_price_html', true);&nbsp;</div></li><li><div>          if ( isset( $free_price_label ) && !empty( $free_price_label ) ) :&nbsp;</div></li><li><div>              $price = __( $free_price_label, WCPGSK_DOMAIN );&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          return $price;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Label configuration settings</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.9.7</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $options </span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_page_labels( $options ) {&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>          &lt;h3 class=&quot;wcpgsk_acc_header&quot;&gt;&lt;?php echo __('Label Settings', WCPGSK_DOMAIN); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>          &lt;div&gt;&nbsp;</div></li><li><div>              &lt;table class=&quot;widefat&quot; border=&quot;1&quot; &gt;&nbsp;</div></li><li><div>              &lt;thead&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;th&gt;&lt;?php _e('Settings Name', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                      &lt;th&gt;&lt;?php _e('Data', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;        &nbsp;</div></li><li><div>                      &lt;th&gt;&lt;?php _e('Comments', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>              &lt;/thead&gt;&nbsp;</div></li><li><div>              &lt;tbody&gt;&nbsp;</div></li><li><div>                  &lt;?php do_action( 'wcpgsk_settings_labels_before', $options ); ?&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'On Sale Label', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[process][onsalelabel]&quot; type=&quot;text&quot; id=&quot;wcpgsk_onsalelabel&quot; value=&quot;&lt;?php echo $options['process']['onsalelabel'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the on sale label. (You may need to adapt css!)', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Backorder Label', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[process][backorderlabel]&quot; type=&quot;text&quot; id=&quot;wcpgsk_backorderlabel&quot; value=&quot;&lt;?php echo $options['process']['backorderlabel'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the backorder label. (You may need to adapt css!)', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Add to Cart Button Label', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[process][fastcheckoutbtn]&quot; type=&quot;text&quot; id=&quot;wcpgsk_fastcheckout_btn&quot; value=&quot;&lt;?php echo $options['process']['fastcheckoutbtn'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the label for the Add to Cart button.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Read more Button Label', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[process][readmorebtn]&quot; type=&quot;text&quot; id=&quot;wcpgsk_readmore_btn&quot; value=&quot;&lt;?php echo $options['process']['readmorebtn'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the label for the Read more button.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'View products Button Label', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[process][viewproductsbtn]&quot; type=&quot;text&quot; id=&quot;wcpgsk_viewproducts_btn&quot; value=&quot;&lt;?php echo $options['process']['viewproductsbtn'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the label for the View products button.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Select options Button Label', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[process][selectoptionsbtn]&quot; type=&quot;text&quot; id=&quot;wcpgsk_selectoptions_btn&quot; value=&quot;&lt;?php echo $options['process']['selectoptionsbtn'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the label for the Select options button.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Buy product Button Label', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[process][buyproductbtn]&quot; type=&quot;text&quot; id=&quot;wcpgsk_buyproduct_btn&quot; value=&quot;&lt;?php echo $options['process']['buyproductbtn'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the label for the Buy product button.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Out of stock Button Label', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[process][outofstockbtn]&quot; type=&quot;text&quot; id=&quot;wcpgsk_outofstock_btn&quot; value=&quot;&lt;?php echo $options['process']['outofstockbtn'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the label for the Out of stock button.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Tax Label', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_countries_tax_or_vat]&quot; type=&quot;text&quot; id=&quot;wcpgsk_woocommerce_countries_tax_or_vat&quot; value=&quot;&lt;?php echo $options['filters']['woocommerce_countries_tax_or_vat'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the tax label.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Includes tax message', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_countries_inc_tax_or_vat]&quot; type=&quot;text&quot; id=&quot;wcpgsk_woocommerce_countries_inc_tax_or_vat&quot; value=&quot;&lt;?php echo $options['filters']['woocommerce_countries_inc_tax_or_vat'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the tax included message.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Tax excluded message', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_countries_ex_tax_or_vat]&quot; type=&quot;text&quot; id=&quot;wcpgsk_woocommerce_countries_ex_tax_or_vat&quot; value=&quot;&lt;?php echo $options['filters']['woocommerce_countries_ex_tax_or_vat'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the tax excluded message.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Product Description Tab Label', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_product_description_tab_title]&quot; type=&quot;text&quot; id=&quot;wcpgsk_woocommerce_product_description_tab_title&quot; value=&quot;&lt;?php echo $options['filters']['woocommerce_product_description_tab_title'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the label for the product description tab.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Product Description Header', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_product_description_heading]&quot; type=&quot;text&quot; id=&quot;wcpgsk_woocommerce_product_description_heading&quot; value=&quot;&lt;?php echo $options['filters']['woocommerce_product_description_heading'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the product description header.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Product Additional Information Tab Label', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_product_additional_information_tab_title]&quot; type=&quot;text&quot; id=&quot;wcpgsk_woocommerce_product_additional_information_tab_title&quot; value=&quot;&lt;?php echo $options['filters']['woocommerce_product_additional_information_tab_title'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the label for the product additional information tab.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Product Additional Information Header', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_product_additional_information_heading]&quot; type=&quot;text&quot; id=&quot;wcpgsk_woocommerce_product_additional_information_heading&quot; value=&quot;&lt;?php echo $options['filters']['woocommerce_product_additional_information_heading'] ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the product additional information header.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&lt;?php _e('Set Order Button Text', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_order_button_text]&quot; type=&quot;text&quot; class=&quot;wcpgsk_textfield&quot; value=&quot;&lt;?php if (!empty($options['filters']['woocommerce_order_button_text'])) echo esc_attr( $options['filters']['woocommerce_order_button_text'] ); ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Set the order button text.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&lt;?php _e('Pay Order Button Text', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_pay_order_button_text]&quot; type=&quot;text&quot; class=&quot;wcpgsk_textfield&quot; value=&quot;&lt;?php if (!empty($options['filters']['woocommerce_pay_order_button_text'])) echo esc_attr( $options['filters']['woocommerce_pay_order_button_text'] ); ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Set the pay order button text.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&lt;?php _e('Set Login required message', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_checkout_must_be_logged_in_message]&quot; type=&quot;text&quot; class=&quot;wcpgsk_textfield&quot; value=&quot;&lt;?php if (!empty($options['filters']['woocommerce_checkout_must_be_logged_in_message'])) echo esc_attr( $options['filters']['woocommerce_checkout_must_be_logged_in_message'] ); ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Change the login required message for the checkout form.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&lt;?php _e('Set Login possible message', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_checkout_login_message]&quot; type=&quot;text&quot; class=&quot;wcpgsk_textfield&quot; value=&quot;&lt;?php if (!empty($options['filters']['woocommerce_checkout_login_message'])) echo esc_attr( $options['filters']['woocommerce_checkout_login_message'] ); ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Change the returning customer login message for the checkout form.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&lt;?php _e('Set Coupon message', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_checkout_coupon_message]&quot; type=&quot;text&quot; class=&quot;wcpgsk_textfield&quot; value=&quot;&lt;?php if (!empty($options['filters']['woocommerce_checkout_coupon_message'])) echo esc_attr( $options['filters']['woocommerce_checkout_coupon_message'] ); ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Change the coupon message for the checkout form.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&lt;?php _e('Set Coupon link message', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_checkout_coupon_link_message]&quot; type=&quot;text&quot; class=&quot;wcpgsk_textfield&quot; value=&quot;&lt;?php if (!empty($options['filters']['woocommerce_checkout_coupon_link_message'])) echo esc_attr( $options['filters']['woocommerce_checkout_coupon_link_message'] ); ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Change the coupon link message for the checkout form. (WC 2.2+ only)', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&lt;?php _e('Define order received message', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_thankyou_order_received_text]&quot; type=&quot;text&quot; class=&quot;wcpgsk_textfield&quot; value=&quot;&lt;?php if (!empty($options['filters']['woocommerce_thankyou_order_received_text'])) echo esc_attr( $options['filters']['woocommerce_thankyou_order_received_text'] ); ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define the order received thank you message.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&lt;?php _e('Define alternative placeholder image url', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_placeholder_img_src]&quot; type=&quot;text&quot; class=&quot;wcpgsk_textfield&quot; value=&quot;&lt;?php if (!empty($options['filters']['woocommerce_placeholder_img_src'])) echo esc_attr( $options['filters']['woocommerce_placeholder_img_src'] ); ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define alternative placeholder image url.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&lt;?php _e('Define empty price label', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;input name=&quot;wcpgsk_settings[process][empty_price_html]&quot; type=&quot;text&quot; class=&quot;wcpgsk_textfield&quot; value=&quot;&lt;?php if (!empty($options['process']['empty_price_html'])) echo esc_attr( $options['process']['empty_price_html'] ); ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                      &lt;td&gt;&nbsp;</div></li><li><div>                          &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Define a empty price label.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>                  &lt;?php do_action( 'wcpgsk_settings_labels_after', $options ); ?&gt;                    &nbsp;</div></li><li><div>              &lt;/tbody&gt;&nbsp;</div></li><li><div>              &lt;/table&gt;&nbsp;</div></li><li><div>              &lt;?php submit_button( __( 'Save Changes', WCPGSK_DOMAIN ) ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>      &lt;?php        &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Hook available and WCPGSK configured WooCommerce filters</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.9.2</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_hook_woocommerce_filters() {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          if ( !empty( $options['filters'] ) ) :&nbsp;</div></li><li><div>              foreach ( $options['filters'] as $filter =&gt; $value ) :&nbsp;</div></li><li><div>                  <span class="comment">//do it late</span>&nbsp;</div></li><li><div>                  add_filter( $filter, array( $this, 'wcpgsk_apply_woocommerce_filter' ), 1 );&nbsp;</div></li><li><div>              endforeach;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Run available WooCommerce filters</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.9.2</span>&nbsp;</div></li><li><div><span class="comment">       * @changed 2.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return configured string value</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_apply_woocommerce_filter( $filterval, $param2 = null ) {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $the_filter = current_filter();&nbsp;</div></li><li><div>          if ( isset( $options['filters'][ $the_filter ] ) ) {&nbsp;</div></li><li><div>              $configval = $options['filters'][ $the_filter ];&nbsp;</div></li><li><div>              switch ( $the_filter ) :&nbsp;</div></li><li><div>                  case &quot;woocommerce_create_account_default_checked&quot; :&nbsp;</div></li><li><div>                      if ( $configval ) :&nbsp;</div></li><li><div>                          $filterval = true;&nbsp;</div></li><li><div>                      else :&nbsp;</div></li><li><div>                          $filterval = false;&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  case &quot;loop_shop_per_page&quot; :&nbsp;</div></li><li><div>                      if ( !empty( $configval ) && is_numeric( $configval ) && intval( $configval ) &gt; 0 ) :&nbsp;</div></li><li><div>                          $filterval = intval( $configval );&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  case &quot;loop_shop_columns&quot; :&nbsp;</div></li><li><div>                      if ( !empty( $configval ) && is_numeric( $configval ) && intval( $configval ) &gt; 0 ) :&nbsp;</div></li><li><div>                          $filterval = intval( $configval );&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  case &quot;woocommerce_product_thumbnails_columns&quot; :&nbsp;</div></li><li><div>                      if ( !empty( $configval ) && is_numeric( $configval ) && intval( $configval ) &gt; 0 ) :&nbsp;</div></li><li><div>                          $filterval = intval( $configval );&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  case &quot;woocommerce_checkout_coupon_message&quot; :&nbsp;</div></li><li><div>                      $current_wc_version = get_option( 'woocommerce_db_version' );&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      if ( version_compare( $current_wc_version, '2.2.0', '&gt;=' ) ) :&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment"><span class="comment">//make translatable</span></span></span>&nbsp;</div></li><li><div>                          if ( !empty( $configval ) ) :&nbsp;</div></li><li><div>                              if ( isset( $options['filters']['woocommerce_checkout_coupon_link_message'] ) && !empty( $options['filters']['woocommerce_checkout_coupon_link_message'] ) ) :&nbsp;</div></li><li><div>                                  $filterval = __($configval, WCPGSK_DOMAIN) . ' &lt;a href=&quot;#&quot; class=&quot;showcoupon&quot;&gt;' . __( $options['filters']['woocommerce_checkout_coupon_link_message'], WCPGSK_DOMAIN ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>                              else :&nbsp;</div></li><li><div>                                  $filterval = __($configval, WCPGSK_DOMAIN) . ' &lt;a href=&quot;#&quot; class=&quot;showcoupon&quot;&gt;' . __( 'Click here to enter your code', 'woocommerce' ) . '&lt;/a&gt;';                                &nbsp;</div></li><li><div>                              endif;&nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                      else :&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment"><span class="comment">//make translatable</span></span></span>&nbsp;</div></li><li><div>                          if ( !empty( $configval ) ) :&nbsp;</div></li><li><div>                              $filterval = __($configval, WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  case &quot;woocommerce_product_description_heading&quot; :&nbsp;</div></li><li><div>                      $filterval = __($configval, WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  case &quot;woocommerce_product_additional_information_heading&quot; :&nbsp;</div></li><li><div>                      $filterval = __($configval, WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  default :&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment">//make translatable</span></span></span>&nbsp;</div></li><li><div>                      if ( !empty( $configval ) ) :&nbsp;</div></li><li><div>                          $filterval = __($configval, WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              endswitch;&nbsp;</div></li><li><div>          }            &nbsp;</div></li><li><div>          return $filterval;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Register Product Tab for Min/Max/Step Configuration for Simple and Variable products</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.6.0</span>&nbsp;</div></li><li><div><span class="comment">       * @echo html</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_product_write_panel_tab() {&nbsp;</div></li><li><div>          global $post;&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          if ( isset($options['cart']['minmaxstepproduct']) && $options['cart']['minmaxstepproduct'] == 1 ) :            &nbsp;</div></li><li><div>              if ( $terms = wp_get_object_terms( $post-&gt;ID, 'product_type' ) )&nbsp;</div></li><li><div>                  $product_type = sanitize_title( current( $terms )-&gt;name );&nbsp;</div></li><li><div>              else&nbsp;</div></li><li><div>                  $product_type = 'simple';            &nbsp;</div></li><li><div>              if ( $product_type === 'simple' || $product_type === 'variable' ) :&nbsp;</div></li><li><div>                  echo &quot;&lt;li class=\&quot;wcpgsk_product_tab\&quot;&gt;&lt;a class=\&quot;icon16 icon-media\&quot; href=\&quot;#wcpgsk_data_tab\&quot;&gt;&quot; . __( 'Product Cart Quantities', WCPGSK_DOMAIN ) . &quot;&lt;/a&gt;&lt;/li&gt;&quot;;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Save checkout js</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * </span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.8.1</span>&nbsp;</div></li><li><div><span class="comment">       * @return nothing </span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_save_checkoutjs_callback() {&nbsp;</div></li><li><div>          global $wpdb;&nbsp;</div></li><li><div>          $data = $_POST['checkoutjs'];<span class="comment">//json_decode(str_replace('\\&quot;', '&quot;', $_POST['jsondata']), true);</span>&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          $checkoutjs = $_POST['checkoutjs'];&nbsp;</div></li><li><div>          if ( isset($checkoutjs) ) :&nbsp;</div></li><li><div>              update_option('wcpgsk_checkoutjs', stripslashes($checkoutjs));&nbsp;</div></li><li><div>              echo __('js saved', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          $this-&gt;phpdie();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Helper function: mimics 2.1.x for 2.0.x installations and calls +2.1 function directly if available</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * </span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.7.1</span>&nbsp;</div></li><li><div><span class="comment">       * @return array of localizable fields </span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_get_country_locale_field_selectors() {&nbsp;</div></li><li><div>          if ( function_exists('WC') ) :&nbsp;</div></li><li><div>              return WC()-&gt;countries-&gt;get_country_locale_field_selectors();&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              <span class="comment">//we need this for internal usage... on the frontend fields are hardcode in WC &lt; 2.1 into js</span>&nbsp;</div></li><li><div>              $locale_fields = array (&nbsp;</div></li><li><div>                  'address_1' =&gt; '#billing_address_1_field, #shipping_address_1_field', &nbsp;</div></li><li><div>                  'address_2' =&gt; '#billing_address_2_field, #shipping_address_2_field', &nbsp;</div></li><li><div>                  'state' =&gt; '#billing_state_field, #shipping_state_field', &nbsp;</div></li><li><div>                  'postcode' =&gt; '#billing_postcode_field, #shipping_postcode_field', &nbsp;</div></li><li><div>                  'city' =&gt; '#billing_city_field, #shipping_city_field'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              <span class="comment">//@TODO: Do we really want to filter in WC &lt; 2.1?</span>&nbsp;</div></li><li><div>              return apply_filters( 'woocommerce_country_locale_field_selectors', $locale_fields );&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Helper function: not really necessary...</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.7.1</span>&nbsp;</div></li><li><div><span class="comment">       * @return array localization config</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_get_country_locale() {&nbsp;</div></li><li><div>          if ( function_exists('WC') ) :&nbsp;</div></li><li><div>              return WC()-&gt;countries-&gt;get_country_locale();&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              global $woocommerce;&nbsp;</div></li><li><div>              return $woocommerce-&gt;countries-&gt;get_country_locale();&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Helper function: not really necessary...</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.7.1</span>&nbsp;</div></li><li><div><span class="comment">       * @return array of allowed countries</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_get_allowed_countries() {&nbsp;</div></li><li><div>          if ( function_exists('WC') ) :&nbsp;</div></li><li><div>              return WC()-&gt;countries-&gt;get_allowed_countries();&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              global $woocommerce;&nbsp;</div></li><li><div>              return $woocommerce-&gt;countries-&gt;get_allowed_countries();&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Locale field form</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.7.1</span>&nbsp;</div></li><li><div><span class="comment">       * @echo html</span>&nbsp;</div></li><li><div><span class="comment">       */</span>         &nbsp;</div></li><li><div>      public function get_locale_field_form_callback() {&nbsp;</div></li><li><div>          $jsfields = $this-&gt;wcpgsk_get_country_locale_field_selectors(); <span class="comment">//WC()-&gt;countries-&gt;get_country_locale_field_selectors();</span>&nbsp;</div></li><li><div>          $localedata = $this-&gt;wcpgsk_get_country_locale(); <span class="comment">//WC()-&gt;countries-&gt;get_country_locale();</span>&nbsp;</div></li><li><div>          $locale = get_option('wcpgsk_locale');&nbsp;</div></li><li><div>          $localeCode = $_POST['localeCode'];&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          if ( $localeCode ) :&nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>              &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;td colspan=&quot;3&quot;&gt;&nbsp;</div></li><li><div>              &lt;input name=&quot;wcpgsk_settings[locale][countrycode]&quot; type=&quot;hidden&quot; value=&quot;&lt;?php echo $localeCode; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;/tr&gt;&nbsp;</div></li><li><div>              &lt;?php&nbsp;</div></li><li><div>              $localepostcode = isset($localedata[$localeCode]) && isset($localedata[$localeCode]['postcode_before_city']) ? ( $localedata[$localeCode]['postcode_before_city'] ? '1' : '0' ) : ( isset($localedata['default']['postcode_before_city']) && $localedata['default']['postcode_before_city'] ? '1' : '0' );&nbsp;</div></li><li><div>              $locale[$localeCode]['postcode_before_city'] = isset($locale[$localeCode]['postcode_before_city']) ? $locale[$localeCode]['postcode_before_city'] : $localepostcode;&nbsp;</div></li><li><div>              foreach ($jsfields as $field =&gt; $fieldids) :&nbsp;</div></li><li><div>                  $localelabel = isset($localedata[$localeCode]) && isset($localedata[$localeCode][$field]) && isset($localedata[$localeCode][$field]['label']) ? $localedata[$localeCode][$field]['label'] : ( isset($localedata['default'][$field]['label']) ? $localedata['default'][$field]['label'] : '' );&nbsp;</div></li><li><div>                  $locale[$localeCode]['label_' . $field] = isset($locale[$localeCode]['label_' . $field]) ? $locale[$localeCode]['label_' . $field] : $localelabel;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $localeplaceholder = isset($localedata[$localeCode]) && isset($localedata[$localeCode][$field]) && isset($localedata[$localeCode][$field]['placeholder']) ? $localedata[$localeCode][$field]['placeholder'] : ( isset($localedata['default'][$field]['placeholder']) ? $localedata['default'][$field]['placeholder'] : '' );&nbsp;</div></li><li><div>                  $locale[$localeCode]['placeholder_' . $field] = isset($locale[$localeCode]['placeholder_' . $field]) ? $locale[$localeCode]['placeholder_' . $field] : $localeplaceholder;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $localerequired = isset($localedata[$localeCode]) && isset($localedata[$localeCode][$field]) && isset($localedata[$localeCode][$field]['required']) ? ( $localedata[$localeCode][$field]['required'] ? '1' : '0' ) : ( isset($localedata['default'][$field]['required']) && $localedata['default'][$field]['required'] ? '1' : '0' );&nbsp;</div></li><li><div>                  $locale[$localeCode]['required_' . $field] = isset($locale[$localeCode]['required_' . $field]) ? $locale[$localeCode]['required_' . $field] : $localerequired;&nbsp;</div></li><li><div>                  if ( $field !== 'state' ) :&nbsp;</div></li><li><div>                      $localehidden = isset($localedata[$localeCode]) && isset($localedata[$localeCode][$field]) && isset($localedata[$localeCode][$field]['hidden']) ? ( $localedata[$localeCode][$field]['hidden'] ? '1' : '0' ) : ( isset($localedata['default'][$field]['hidden']) && $localedata['default'][$field]['hidden'] ? '1' : '0' );&nbsp;</div></li><li><div>                      $locale[$localeCode]['hidden_' . $field] = isset($locale[$localeCode]['hidden_' . $field]) ? $locale[$localeCode]['hidden_' . $field] : $localehidden;&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>              &lt;tr&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&lt;?php echo $field; ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;input name=&quot;wcpgsk_settings[locale][required_&lt;?php echo $field; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;input name=&quot;wcpgsk_settings[locale][required_&lt;?php echo $field; ?&gt;]&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php if ( isset($locale[$localeCode]['required_' . $field]) && 1 == ($locale[$localeCode]['required_' . $field])) echo &quot;checked='checked'&quot;; ?&gt; /&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;span class=&quot;description&quot;&gt;&lt;?php echo __('Required status for ', WCPGSK_DOMAIN) . ' ' . $field; ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;/tr&gt;&nbsp;</div></li><li><div>              &lt;?php if ( $field != 'state' ) : ?&gt;&nbsp;</div></li><li><div>              &lt;tr&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&lt;?php echo $field; ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;input name=&quot;wcpgsk_settings[locale][hidden_&lt;?php echo $field; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;input name=&quot;wcpgsk_settings[locale][hidden_&lt;?php echo $field; ?&gt;]&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php if ( isset($locale[$localeCode]['hidden_' . $field]) && 1 == ($locale[$localeCode]['hidden_' . $field])) echo &quot;checked='checked'&quot;; ?&gt; /&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;span class=&quot;description&quot;&gt;&lt;?php echo __('Hidden status for ', WCPGSK_DOMAIN) . ' ' . $field; ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;/tr&gt;&nbsp;</div></li><li><div>              &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>              &lt;tr&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&lt;?php echo $field; ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;input name=&quot;wcpgsk_settings[locale][label_&lt;?php echo $field; ?&gt;]&quot; value=&quot;&lt;?php if (isset($locale[$localeCode]['label_' . $field]) ) echo $locale[$localeCode]['label_' . $field]; ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;span class=&quot;description&quot;&gt;&lt;?php echo __('Label for ', WCPGSK_DOMAIN) . ' ' . $field; ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;/tr&gt;&nbsp;</div></li><li><div>              &lt;tr&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&lt;?php echo $field; ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;input name=&quot;wcpgsk_settings[locale][placeholder_&lt;?php echo $field; ?&gt;]&quot; value=&quot;&lt;?php if (isset($locale[$localeCode]['placeholder_' . $field]) ) echo $locale[$localeCode]['placeholder_' . $field]; ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;span class=&quot;description&quot;&gt;&lt;?php echo __('Placeholder for ', WCPGSK_DOMAIN) . ' ' . $field; ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;/tr&gt;&nbsp;</div></li><li><div>              &lt;tr&gt;&nbsp;</div></li><li><div>                  &lt;td colspan=&quot;3&quot;&gt;&lt;hr /&gt;&lt;/td&gt;&nbsp;</div></li><li><div>              &lt;/tr&gt;&nbsp;</div></li><li><div>              &lt;?php&nbsp;</div></li><li><div>              endforeach;&nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>              &lt;tr&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&lt;?php echo __('Post/Zip Code Placement', WCPGSK_DOMAIN); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;input name=&quot;wcpgsk_settings[locale][postcode_before_city]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                      &lt;input name=&quot;wcpgsk_settings[locale][postcode_before_city]&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php if ( isset($locale[$localeCode]['postcode_before_city']) && 1 == ($locale[$localeCode]['postcode_before_city'])) echo &quot;checked='checked'&quot;; ?&gt; /&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>                  &lt;td&gt;&nbsp;</div></li><li><div>                      &lt;span class=&quot;description&quot;&gt;&lt;?php echo __('Post/Zip code before city', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;/tr&gt;&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              &lt;?php&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Product Tab Content for Min/Max/Step Configuration for Simple and Variable products</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.6.0</span>&nbsp;</div></li><li><div><span class="comment">       * @echo html</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_product_write_panels() {&nbsp;</div></li><li><div>          global $post;&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          if ( isset($options['cart']['minmaxstepproduct']) && $options['cart']['minmaxstepproduct'] == 1 ) :&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>              <span class="comment">// the product</span>&nbsp;</div></li><li><div>              if ( $terms = wp_get_object_terms( $post-&gt;ID, 'product_type' ) )&nbsp;</div></li><li><div>                  $product_type = sanitize_title( current( $terms )-&gt;name );&nbsp;</div></li><li><div>              else&nbsp;</div></li><li><div>                  $product_type = 'simple';&nbsp;</div></li><li><div>              if ( $product_type === 'simple' || $product_type === 'variable' ) :    &nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                  $minqty = get_post_meta( $post-&gt;ID, '_wcpgsk_minqty', true );</span>&nbsp;</div></li><li><div><span class="comment">                  $maxqty = get_post_meta( $post-&gt;ID, '_wcpgsk_maxqty', true );</span>&nbsp;</div></li><li><div><span class="comment">                  $stepqty = get_post_meta( $post-&gt;ID, '_wcpgsk_stepqty', true );</span>&nbsp;</div></li><li><div><span class="comment">                  $minqty = isset($minqty) && !empty($minqty) ? $minqty : 0;</span>&nbsp;</div></li><li><div><span class="comment">                  $maxqty = isset($maxqty) && !empty($maxqty) ? $maxqty : 0;</span>&nbsp;</div></li><li><div><span class="comment">                  $stepqty = isset($stepqty) && !empty($stepqty) ? $stepqty : 0;</span>&nbsp;</div></li><li><div><span class="comment">                  */</span>&nbsp;</div></li><li><div>                  $style = 'width:125px;padding:5px 5px 5px 5px;font-size:inherit !important;font-family:inherit !important;font-face:inherit !important;line-height: 18px !important;';&nbsp;</div></li><li><div>                  $style_before = 'height:auto !important;vertical-align:sub;padding: 0 3px 0 0 !important;font:400 20px/1 dashicons !important;line-height: 18px !important;content:&quot;\f163&quot;;';&nbsp;</div></li><li><div>                  $active_style = '';                    &nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>                  &lt;style type=&quot;text/css&quot;&gt;&nbsp;</div></li><li><div>                      #woocommerce-product-data ul.product_data_tabs li.wcpgsk_product_tab a { &lt;?php echo $style; ?&gt; }&nbsp;</div></li><li><div>                      #woocommerce-product-data ul.product_data_tabs li.wcpgsk_product_tab a:hover { &lt;?php echo $style; ?&gt; }&nbsp;</div></li><li><div>                      #woocommerce-product-data ul.product_data_tabs li.wcpgsk_product_tab a:before { &lt;?php echo $style_before; ?&gt; }&nbsp;</div></li><li><div>                      &lt;?php echo $active_style; ?&gt;&nbsp;</div></li><li><div>                  &lt;/style&gt;&nbsp;</div></li><li><div>                  &lt;div id=&quot;wcpgsk_data_tab&quot; class=&quot;panel wc-metaboxes-wrapper woocommerce_options_panel&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php&nbsp;</div></li><li><div>                      do_action( 'wcpgsk_qty_panel_settings' );&nbsp;</div></li><li><div>                      woocommerce_wp_checkbox( array( 'id' =&gt; '_wcpgsk_selectqty', 'label' =&gt; __( 'Quantity Selector', WCPGSK_DOMAIN ), 'description' =&gt; __( 'Convert quantity input to selector based on quantity configuration.', WCPGSK_DOMAIN ) ) );&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                      woocommerce_wp_text_input( array( 'id' =&gt; '_wcpgsk_minqty', 'type' =&gt; 'numeric', 'label' =&gt; __( 'Minimum Quantity', WCPGSK_DOMAIN ), 'desc_tip' =&gt; true, 'description' =&gt; __( 'Please specify an integer value. 0 deactivates the option.', WCPGSK_DOMAIN ), 'custom_attributes' =&gt; array('style' =&gt; 'width:40%' ) ) );&nbsp;</div></li><li><div>                      woocommerce_wp_text_input( array( 'id' =&gt; '_wcpgsk_maxqty', 'type' =&gt; 'numeric', 'label' =&gt; __( 'Maximum Quantity', WCPGSK_DOMAIN ), 'desc_tip' =&gt; true, 'description' =&gt; __( 'Please specify an integer value. Should be equal or higher than minimum value or 0. 0 deactivates the option.', WCPGSK_DOMAIN ), 'custom_attributes' =&gt; array('style' =&gt; 'width:40%' ) ) );&nbsp;</div></li><li><div>                      woocommerce_wp_text_input( array( 'id' =&gt; '_wcpgsk_stepqty', 'type' =&gt; 'numeric', 'label' =&gt; __( 'Increment Quantity', WCPGSK_DOMAIN ), 'desc_tip' =&gt; true, 'description' =&gt; __( 'Please specify an integer value for increment steps. Please assure consistency with minimum and maximum value. 0 deactivates the option.', WCPGSK_DOMAIN ), 'custom_attributes' =&gt; array('style' =&gt; 'width:40%' ) ) );&nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>                  &lt;/div&gt;&nbsp;</div></li><li><div>                  &lt;?php&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Store WCPGSK Min/Max/Step configuration data for the product</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.6.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return void</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_process_product_meta( $post_id ) {&nbsp;</div></li><li><div>          global $woocommerce, $wpdb;&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          if ( isset($options['cart']['minmaxstepproduct']) && $options['cart']['minmaxstepproduct'] == 1 ) :&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>              if (WP_DEBUG) {&nbsp;</div></li><li><div>                  <span class="comment">//trigger_error(sprintf(__(&quot;The 'label' and 'id' values of the 'args' parameter of '%s::%s()' are required&quot;, WCPGSK_DOMAIN), $_POST['_wcpgsk_minqty'], $post_id));</span>&nbsp;</div></li><li><div>                  <span class="comment">//die();</span>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $minqty = 0;&nbsp;</div></li><li><div>              $maxqty = 0;&nbsp;</div></li><li><div>              $stepqty = 0;&nbsp;</div></li><li><div>              if ( isset( $_POST['_wcpgsk_minqty'] ) && is_numeric($_POST['_wcpgsk_minqty']) ) :&nbsp;</div></li><li><div>                  $minqty = intval($_POST['_wcpgsk_minqty']) ;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              if ( isset( $_POST['_wcpgsk_maxqty'] ) && is_numeric($_POST['_wcpgsk_maxqty']) ) :&nbsp;</div></li><li><div>                  $maxqty = intval($_POST['_wcpgsk_maxqty']) ;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              if ( isset( $_POST['_wcpgsk_stepqty'] ) && is_numeric($_POST['_wcpgsk_stepqty']) ) :&nbsp;</div></li><li><div>                  $stepqty = intval($_POST['_wcpgsk_stepqty']) ;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if ($minqty &gt; $maxqty && $maxqty &gt; 0) $minqty = 1;&nbsp;</div></li><li><div>              if ($maxqty &lt; $minqty) $maxqty = 0;&nbsp;</div></li><li><div>              do_action( 'wcpgsk_process_additional_product_meta', $post_id );&nbsp;</div></li><li><div>              if ( isset( $_POST['_wcpgsk_selectqty'] ) && $_POST['_wcpgsk_selectqty'] == 'yes' ) :&nbsp;</div></li><li><div>                  update_post_meta( $post_id, '_wcpgsk_selectqty', 'yes' );&nbsp;</div></li><li><div>              else :&nbsp;</div></li><li><div>                  update_post_meta( $post_id, '_wcpgsk_selectqty', 0 );&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_minqty', $minqty );&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_maxqty', $maxqty );&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_stepqty', $stepqty );&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          if ( isset( $_POST['_wcpgsk_button_label'] ) && $_POST['_wcpgsk_button_label'] ) :&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_button_label', wp_kses_post( $_POST['_wcpgsk_button_label'] ) );&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_button_label', '' );&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          if ( isset( $_POST['_wcpgsk_extend_price'] ) && $_POST['_wcpgsk_extend_price'] ) :&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_extend_price', wp_kses_post( $_POST['_wcpgsk_extend_price'] ) );&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_extend_price_placement', $_POST['_wcpgsk_extend_price_placement'] );            &nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_extend_price', '' );&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_extend_price_placement', 'after' );                &nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          if ( isset( $_POST['_wcpgsk_empty_price_html'] ) && $_POST['_wcpgsk_empty_price_html'] ) :&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_empty_price_html', wp_kses_post( $_POST['_wcpgsk_empty_price_html'] ) );            &nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_empty_price_html', '' );            &nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          if ( isset( $_POST['_wcpgsk_free_sale_html'] ) && $_POST['_wcpgsk_free_sale_html'] ) :&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_free_sale_html', wp_kses_post( $_POST['_wcpgsk_free_sale_html'] ) );            &nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_free_sale_html', '' );            &nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          if ( isset( $_POST['_wcpgsk_free_price_html'] ) && $_POST['_wcpgsk_free_price_html'] ) :&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_free_price_html', wp_kses_post( $_POST['_wcpgsk_free_price_html'] ) );            &nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_free_price_html', '' );            &nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          if ( isset( $_POST['_wcpgsk_onsale_html'] ) && $_POST['_wcpgsk_onsale_html'] ) :&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_onsale_html', wp_kses_post( $_POST['_wcpgsk_onsale_html'] ) );            &nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              update_post_meta( $post_id, '_wcpgsk_onsale_html', '' );            &nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Check for minimum and maximum items in cart and if they fulfill the settings.</span>&nbsp;</div></li><li><div><span class="comment">       * and raise error and message if rules are not fulfilled, otherwise clear messages</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param mixed $checkout</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return void</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      public function wcpgsk_checkout_init($checkout) {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          $cartItems = sizeof( $woocommerce-&gt;cart-&gt;cart_contents );&nbsp;</div></li><li><div>          $allowed = $options['cart']['maxitemscart'];&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          <span class="comment"><span class="comment">//check cart items count and diminish if more than one variation for a product exists</span></span>&nbsp;</div></li><li><div>          if ($allowed &gt; 0 && isset($options['cart']['variationscountasproduct']) && $options['cart']['variationscountasproduct'] == 0) {    &nbsp;</div></li><li><div>              $varproducts = array();&nbsp;</div></li><li><div>              foreach($woocommerce-&gt;cart-&gt;cart_contents as $i =&gt; $values) {&nbsp;</div></li><li><div>                  $key = $values['product_id'];&nbsp;</div></li><li><div>                  if (isset($values[$key]) && isset($values[$variation_id]) && $values[$key] != $values['variation_id']) {&nbsp;</div></li><li><div>                      if (isset($varproducts[$key])) $varproducts[$key] = 1;&nbsp;</div></li><li><div>                      else $varproducts[$key] = 0;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if (!empty($varproducts)) $cartItems = $cartItems - array_sum($varproducts);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          if ($allowed &gt; 0 && $cartItems &gt; $allowed ) :&nbsp;</div></li><li><div>              wcpgsk_clear_messages();&nbsp;</div></li><li><div>              <span class="comment"><span class="comment">// Sets error message.</span></span>&nbsp;</div></li><li><div>              wcpgsk_add_error( sprintf( __( 'You have reached the maximum amount of %s items allowed for your cart!', WCPGSK_DOMAIN ), $allowed ) );&nbsp;</div></li><li><div>              wcpgsk_set_messages();&nbsp;</div></li><li><div>              $cart_url = $woocommerce-&gt;cart-&gt;get_cart_url();&nbsp;</div></li><li><div>              wcpgsk_add_message( __('Remove products from the cart', WCPGSK_DOMAIN) . ': &lt;a href=&quot;' . $cart_url . '&quot;&gt;' . __('Cart', WCPGSK_DOMAIN) . '&lt;/a&gt;');&nbsp;</div></li><li><div>              wcpgsk_set_messages();&nbsp;</div></li><li><div>              <span class="comment">//wp_redirect( get_permalink( woocommerce_get_page_id( 'cart' ) ) );</span>&nbsp;</div></li><li><div>              <span class="comment">//exit;                </span>&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              $allowed = $options['cart']['minitemscart'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment">//check cart items count and diminish if more than one variation for a product exists</span></span>&nbsp;</div></li><li><div>              if ($allowed &gt; 1 && isset($options['cart']['variationscountasproduct']) && $options['cart']['variationscountasproduct'] == 0) {    &nbsp;</div></li><li><div>                  $varproducts = array();&nbsp;</div></li><li><div>                  foreach($woocommerce-&gt;cart-&gt;cart_contents as $i =&gt; $values) {&nbsp;</div></li><li><div>                      $key = $values['product_id'];&nbsp;</div></li><li><div>                      if (isset($values[$key]) && isset($values['variation_id']) && $values[$key] != $values['variation_id']) {&nbsp;</div></li><li><div>                          if (isset($varproducts[$key])) $varproducts[$key] = 1;&nbsp;</div></li><li><div>                          else $varproducts[$key] = 0;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  if (!empty($varproducts)) $cartItems = $cartItems - array_sum($varproducts);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if ($allowed &gt; 1 && $allowed &gt; $cartItems ) :&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// Sets error message.</span></span>&nbsp;</div></li><li><div>                  wcpgsk_clear_messages();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  wcpgsk_add_error( sprintf( __( 'You still have not reached the minimum amount of %s items required for your cart!', WCPGSK_DOMAIN ), $allowed ) );&nbsp;</div></li><li><div>                  wcpgsk_set_messages();&nbsp;</div></li><li><div>                  $valid = false;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  $shop_page_id = woocommerce_get_page_id( 'shop' );&nbsp;</div></li><li><div>                  <span class="comment">//$shop_page_url = get_permalink(icl_object_id($shop_page_id, 'page', false));</span>&nbsp;</div></li><li><div>                  $shop_page_url = get_permalink($shop_page_id);&nbsp;</div></li><li><div>                  wcpgsk_add_message( __('Select more products from the shop', WCPGSK_DOMAIN) . ': &lt;a href=&quot;' . $shop_page_url . '&quot;&gt;' . __('Shop', WCPGSK_DOMAIN) . '&lt;/a&gt;');&nbsp;</div></li><li><div>                  wcpgsk_set_messages();&nbsp;</div></li><li><div>                  <span class="comment">//wp_redirect( get_permalink( woocommerce_get_page_id( 'shop' ) ) );</span>&nbsp;</div></li><li><div>                  <span class="comment">//exit;                </span>                &nbsp;</div></li><li><div>              else :&nbsp;</div></li><li><div>                  wcpgsk_clear_messages();            &nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Register settings.</span>&nbsp;</div></li><li><div><span class="comment">       * Establish settings if no default settings are available for some resason</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return void</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      public function wcpgsk_register_setting() {    &nbsp;</div></li><li><div>          register_setting( 'wcpgsk_options', 'wcpgsk_settings', array($this, 'wcpgsk_options_validate') );&nbsp;</div></li><li><div>          <span class="comment">//check if we have initial settings, if not store default settings</span>&nbsp;</div></li><li><div>          global $wcpgsk_options;&nbsp;</div></li><li><div>          $this-&gt;register_plugin_version();&nbsp;</div></li><li><div>          $wcpgsk_options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          if ( empty($wcpgsk_options) ) :&nbsp;</div></li><li><div>              $this-&gt;wcpgsk_initial_settings();&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function wcpgsk_load_order_data($meta) {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $metas = array();&nbsp;</div></li><li><div>          $checkout_fields = array_merge($woocommerce-&gt;countries-&gt;get_address_fields( $woocommerce-&gt;countries-&gt;get_base_country(), 'billing_' ), $woocommerce-&gt;countries-&gt;get_address_fields( $woocommerce-&gt;countries-&gt;get_base_country(), 'shipping_' ));&nbsp;</div></li><li><div>          <span class="comment">//$meta = array_merge($meta, $checkout_fields);</span>&nbsp;</div></li><li><div>          foreach ($checkout_fields as $key =&gt; $field) : &nbsp;</div></li><li><div>              if ( isset($options['woofields']['billing'][$key]['custom_' . $key]) && $options['woofields']['billing'][$key]['custom_' . $key] && !isset($meta[$key]) ) :&nbsp;</div></li><li><div>                  $meta[$key] = '';&nbsp;</div></li><li><div>              elseif ( isset($options['woofields']['shipping'][$key]['custom_' . $key]) && $options['woofields']['shipping'][$key]['custom_' . $key] && !isset($meta[$key]) ) : &nbsp;</div></li><li><div>                  $meta[$key] = '';&nbsp;</div></li><li><div>              endif;                &nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return apply_filters( 'wcpgsk_load_order_data', $meta );    &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Display billing and shipping form data captured.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.3.0</span>&nbsp;</div></li><li><div><span class="comment">       * @output html</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      public function wcpgsk_email_after_order_table($order) {&nbsp;</div></li><li><div>          if ( !isset( $order-&gt;hidecustomproductemail ) || $order-&gt;hidecustomproductemail != 'yes' ) :&nbsp;</div></li><li><div>              global $woocommerce;&nbsp;</div></li><li><div>              $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>              $billing_fields = $this-&gt;wcpgsk_additional_data($order, 'billing');&nbsp;</div></li><li><div>              $shipping_fields = $this-&gt;wcpgsk_additional_data($order, 'shipping');&nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>              &lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; style=&quot;width: 100%; vertical-align: top;&quot; border=&quot;0&quot; class=&quot;wcpgsk_customer_data&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;tr&gt;&nbsp;</div></li><li><div>                      &lt;?php &nbsp;</div></li><li><div>                      if ( isset($billing_fields) && !empty($billing_fields) ) : &nbsp;</div></li><li><div>                      ?&gt;&nbsp;</div></li><li><div>                      &lt;td valign=&quot;top&quot; width=&quot;50%&quot; class=&quot;billing_data&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          &lt;?php if ( !empty($options['checkoutform']['morebillingtitle']) ) : ?&gt;&nbsp;</div></li><li><div>                          &lt;h3&gt;&lt;?php _e( $options['checkoutform']['morebillingtitle'], 'woocommerce' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                          &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          &lt;dl&gt;&nbsp;</div></li><li><div>                          &lt;?php &nbsp;</div></li><li><div>                              foreach ($billing_fields as $key =&gt; $field) :&nbsp;</div></li><li><div>                                  $key_type = &quot;billing_&quot; . $key;&nbsp;</div></li><li><div>                                  $label = !empty($field['label']) ? $field['label'] . &quot;: &quot; : &quot;&quot;;&nbsp;</div></li><li><div>                                  if ( is_array( $field['captured'] ) ) :&nbsp;</div></li><li><div>                                      echo '&lt;dt&gt;' . $label . '&lt;/dt&gt;&lt;dd&gt;' . wp_kses_post( make_clickable( implode( '&lt;br /&gt;', $field['captured'] ) ) ) . '&lt;/dd&gt;';&nbsp;</div></li><li><div>                                  else :&nbsp;</div></li><li><div>                                      echo '&lt;dt&gt;' . $label . '&lt;/dt&gt;&lt;dd&gt;' . wp_kses_post( make_clickable( $field['captured'] ) ) . '&lt;/dd&gt;';&nbsp;</div></li><li><div>                                  endif;&nbsp;</div></li><li><div>                              endforeach;&nbsp;</div></li><li><div>                          ?&gt;&nbsp;</div></li><li><div>                          &lt;/dl&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;?php &nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      if ( get_option( 'woocommerce_ship_to_billing_address_only' ) == 'no' && isset($shipping_fields) && !empty($shipping_fields) ) : &nbsp;</div></li><li><div>                      ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;td valign=&quot;top&quot; width=&quot;50%&quot; class=&quot;shipping_data&quot;&gt;&nbsp;</div></li><li><div>                          &lt;?php if ( !empty($options['checkoutform']['moreshippingtitle']) ) : ?&gt;&nbsp;</div></li><li><div>                          &lt;h3&gt;&lt;?php _e( $options['checkoutform']['moreshippingtitle'], 'woocommerce' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                          &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          &lt;dl&gt;&nbsp;</div></li><li><div>                          &lt;?php &nbsp;</div></li><li><div>                              foreach ($shipping_fields as $key =&gt; $field) :&nbsp;</div></li><li><div>                                  $key_type = &quot;shipping_&quot; . $key;&nbsp;</div></li><li><div>                                  $label = !empty($field['label']) ? $field['label'] . &quot;: &quot; : &quot;&quot;;&nbsp;</div></li><li><div>                                  if ( is_array( $field['captured'] ) ) :&nbsp;</div></li><li><div>                                      echo '&lt;dt&gt;' . $label . '&lt;/dt&gt;&lt;dd&gt;' . wp_kses_post( make_clickable( implode( '&lt;br /&gt;', $field['captured'] ) ) ) . '&lt;/dd&gt;';&nbsp;</div></li><li><div>                                  else :&nbsp;</div></li><li><div>                                      echo '&lt;dt&gt;' . $label . '&lt;/dt&gt;&lt;dd&gt;' . wp_kses_post( make_clickable( $field['captured'] ) ) . '&lt;/dd&gt;';&nbsp;</div></li><li><div>                                  endif;&nbsp;</div></li><li><div>                              endforeach;&nbsp;</div></li><li><div>                          ?&gt;&nbsp;</div></li><li><div>                          &lt;/dl&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;/td&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;/table&gt;&nbsp;</div></li><li><div>              &lt;?php&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Display billing and shipping form data captured.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.3.0</span>&nbsp;</div></li><li><div><span class="comment">       * @output html</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      public function wcpgsk_order_details_after_order_table($order) {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $billing_fields = $this-&gt;wcpgsk_additional_data($order, 'billing');&nbsp;</div></li><li><div>          $shipping_fields = $this-&gt;wcpgsk_additional_data($order, 'shipping');&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>          &lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; style=&quot;width: 100%; vertical-align: top;&quot; border=&quot;0&quot;&gt;&nbsp;</div></li><li><div>              &lt;tr&gt;&nbsp;</div></li><li><div>                  &lt;?php &nbsp;</div></li><li><div>                  if ( isset($billing_fields) && !empty($billing_fields) ) : &nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>                  &lt;td valign=&quot;top&quot; width=&quot;50%&quot; class=&quot;billing_data&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;?php if ( !empty($options['checkoutform']['morebillingtitle']) ) : ?&gt;&nbsp;</div></li><li><div>                      &lt;h3&gt;&lt;?php _e( $options['checkoutform']['morebillingtitle'], 'woocommerce' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                      &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;dl&gt;&nbsp;</div></li><li><div>                      &lt;?php &nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//$billing_fields = $this-&gt;wcpgsk_additional_data($order, 'billing');</span></span>&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//if ( isset($billing_fields) && !empty($billing_fields) ) :</span></span>&nbsp;</div></li><li><div>                          foreach ($billing_fields as $key =&gt; $field) :&nbsp;</div></li><li><div>                              $key_type = &quot;billing_&quot; . $key;&nbsp;</div></li><li><div>                              $label = !empty($field['label']) ? $field['label'] . &quot;: &quot; : &quot;&quot;;&nbsp;</div></li><li><div>                              if ( is_array( $field['captured'] ) ) :&nbsp;</div></li><li><div>                                  echo '&lt;dt&gt;' . $label . '&lt;/dt&gt;&lt;dd&gt;' . wp_kses_post( make_clickable( implode( '&lt;br /&gt;', $field['captured'] ) ) ) . '&lt;/dd&gt;';&nbsp;</div></li><li><div>                              else :&nbsp;</div></li><li><div>                                  echo '&lt;dt&gt;' . $label . '&lt;/dt&gt;&lt;dd&gt;' . wp_kses_post( make_clickable( $field['captured'] ) ) . '&lt;/dd&gt;';&nbsp;</div></li><li><div>                              endif;&nbsp;</div></li><li><div>                          endforeach;&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment"><span class="comment">//endif;</span></span></span>&nbsp;</div></li><li><div>                      ?&gt;&nbsp;</div></li><li><div>                      &lt;/dl&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;?php &nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>                  if ( get_option( 'woocommerce_ship_to_billing_address_only' ) == 'no' && isset($shipping_fields) && !empty($shipping_fields) ) : &nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;td valign=&quot;top&quot; width=&quot;50%&quot; class=&quot;shipping_data&quot;&gt;&nbsp;</div></li><li><div>                      &lt;?php if ( !empty($options['checkoutform']['moreshippingtitle']) ) : ?&gt;&nbsp;</div></li><li><div>                      &lt;h3&gt;&lt;?php _e( $options['checkoutform']['moreshippingtitle'], 'woocommerce' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                      &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>                      &lt;dl&gt;&nbsp;</div></li><li><div>                      &lt;?php &nbsp;</div></li><li><div>                          foreach ($shipping_fields as $key =&gt; $field) :&nbsp;</div></li><li><div>                              $key_type = &quot;shipping_&quot; . $key;&nbsp;</div></li><li><div>                              $label = !empty($field['label']) ? $field['label'] . &quot;: &quot; : &quot;&quot;;&nbsp;</div></li><li><div>                              if ( is_array( $field['captured'] ) ) :&nbsp;</div></li><li><div>                                  echo '&lt;dt&gt;' . $label . '&lt;/dt&gt;&lt;dd&gt;' . wp_kses_post( make_clickable( implode( '&lt;br /&gt;', $field['captured'] ) ) ) . '&lt;/dd&gt;';&nbsp;</div></li><li><div>                              else :&nbsp;</div></li><li><div>                                  echo '&lt;dt&gt;' . $label . '&lt;/dt&gt;&lt;dd&gt;' . wp_kses_post( make_clickable( $field['captured'] ) ) . '&lt;/dd&gt;';&nbsp;</div></li><li><div>                              endif;&nbsp;</div></li><li><div>                          endforeach;&nbsp;</div></li><li><div>                      ?&gt;&nbsp;</div></li><li><div>                      &lt;/dl&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;/td&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/table&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Display billing and shipping custom fields for user meta on my-account page.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.1.2</span>&nbsp;</div></li><li><div><span class="comment">       * @output html</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      public function wcpgsk_after_my_account() {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $billing_fields = $this-&gt;wcpgsk_additional_data_user('billing');&nbsp;</div></li><li><div>          $shipping_fields = $this-&gt;wcpgsk_additional_data_user('shipping');&nbsp;</div></li><li><div>          $col = 1;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          if ( get_option( 'woocommerce_ship_to_billing_address_only' ) == 'no' && get_option( 'woocommerce_calc_shipping' ) !== 'no' ) echo '&lt;div class=&quot;col2-set addresses&quot;&gt;';            &nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>              &lt;div class=&quot;col-&lt;?php echo ( ( $col = $col * -1 ) &lt; 0 ) ? 1 : 2; ?&gt; address billing_data&quot;&gt;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>              &lt;?php &nbsp;</div></li><li><div>              if ( isset($billing_fields) && !empty($billing_fields) ) : &nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;?php if ( !empty($options['checkoutform']['morebillingtitle']) ) : ?&gt;&nbsp;</div></li><li><div>                  &lt;h3&gt;&lt;?php _e( $options['checkoutform']['morebillingtitle'], 'woocommerce' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                  &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;dl&gt;&nbsp;</div></li><li><div>                  &lt;?php &nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">//$billing_fields = $this-&gt;wcpgsk_additional_data($order, 'billing');</span></span>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">//if ( isset($billing_fields) && !empty($billing_fields) ) :</span></span>&nbsp;</div></li><li><div>                      foreach ($billing_fields as $key =&gt; $field) :&nbsp;</div></li><li><div>                          $key_type = &quot;billing_&quot; . $key;&nbsp;</div></li><li><div>                          $label = !empty($field['label']) ? $field['label'] . &quot;: &quot; : &quot;&quot;;&nbsp;</div></li><li><div>                          if ( is_array( $field['captured'] ) ) :&nbsp;</div></li><li><div>                              echo '&lt;dt&gt;' . $label . '&lt;/dt&gt;&lt;dd&gt;' . wp_kses_post( make_clickable( implode( '&lt;br /&gt;', $field['captured'] ) ) ) . '&lt;/dd&gt;';&nbsp;</div></li><li><div>                          else :&nbsp;</div></li><li><div>                              echo '&lt;dt&gt;' . $label . '&lt;/dt&gt;&lt;dd&gt;' . wp_kses_post( make_clickable( $field['captured'] ) ) . '&lt;/dd&gt;';&nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                      endforeach;&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment">//endif;</span></span></span>&nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>                  &lt;/dl&gt;&nbsp;</div></li><li><div>              &lt;/div&gt;&nbsp;</div></li><li><div>              &lt;?php &nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              if ( get_option( 'woocommerce_ship_to_billing_address_only' ) == 'no' && isset($shipping_fields) && !empty($shipping_fields) ) : &nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              ?&gt;&nbsp;</div></li><li><div>                  &lt;div class=&quot;col-&lt;?php echo ( ( $col = $col * -1 ) &lt; 0 ) ? 1 : 2; ?&gt; address shipping_data&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php if ( !empty($options['checkoutform']['moreshippingtitle']) ) : ?&gt;&nbsp;</div></li><li><div>                  &lt;h3&gt;&lt;?php _e( $options['checkoutform']['moreshippingtitle'], 'woocommerce' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                  &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>                  &lt;dl&gt;&nbsp;</div></li><li><div>                  &lt;?php &nbsp;</div></li><li><div>                      foreach ($shipping_fields as $key =&gt; $field) :&nbsp;</div></li><li><div>                          $key_type = &quot;shipping_&quot; . $key;&nbsp;</div></li><li><div>                          $label = !empty($field['label']) ? $field['label'] . &quot;: &quot; : &quot;&quot;;&nbsp;</div></li><li><div>                          if ( is_array( $field['captured'] ) ) :&nbsp;</div></li><li><div>                              echo '&lt;dt&gt;' . $label . '&lt;/dt&gt;&lt;dd&gt;' . wp_kses_post( make_clickable( implode( '&lt;br /&gt;', $field['captured'] ) ) ) . '&lt;/dd&gt;';&nbsp;</div></li><li><div>                          else :&nbsp;</div></li><li><div>                              echo '&lt;dt&gt;' . $label . '&lt;/dt&gt;&lt;dd&gt;' . wp_kses_post( make_clickable( $field['captured'] ) ) . '&lt;/dd&gt;';&nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                      endforeach;&nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>                  &lt;/dl&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>          if ( get_option( 'woocommerce_ship_to_billing_address_only' ) == 'no' && get_option( 'woocommerce_calc_shipping' ) !== 'no' ) echo '&lt;/div&gt;';&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Update our order billing address.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.3.0</span>&nbsp;</div></li><li><div><span class="comment">       * @output Settings page</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      public function wcpgsk_additional_data($order, $fortype) {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $captured_fields = array();&nbsp;</div></li><li><div>          $field_order = 1;    &nbsp;</div></li><li><div>          $checkout_fields = $woocommerce-&gt;countries-&gt;get_address_fields( $woocommerce-&gt;countries-&gt;get_base_country(), $fortype . '_' );&nbsp;</div></li><li><div>          foreach ($checkout_fields as $key =&gt; $field) :&nbsp;</div></li><li><div>              $checkout_fields[$key]['order'] = ((!empty($options['woofields']['order_' . $key]) && ctype_digit($options['woofields']['order_' . $key])) ? $options['woofields']['order_' . $key] : $field_order);&nbsp;</div></li><li><div>              $checkout_fields[$key]['required'] = ((isset($options['woofields']['required_' . $key])) ? $options['woofields']['required_' . $key] : $checkout_fields[$key]['required']);&nbsp;</div></li><li><div>              $checkout_fields[$key]['hideorder'] = ((isset($options['woofields']['hideorder_' . $key])) ? $options['woofields']['hideorder_' . $key] : 0);&nbsp;</div></li><li><div>              if (!isset($configField['label'])) $configField['label'] = __($checkout_fields[$key]['label'], WCPGSK_DOMAIN);                &nbsp;</div></li><li><div>              $field_order++;&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          uasort($checkout_fields, array($this, &quot;compareFieldOrder&quot;));                        &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ($checkout_fields as $key =&gt; $field) : &nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment"><span class="comment">//$fieldLabel = $field['displaylabel'];</span></span></span></span>&nbsp;</div></li><li><div>              $fieldkey = str_replace('billing_', '', $key);&nbsp;</div></li><li><div>              $fieldkey = str_replace('shipping_', '', $key);&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if ($key != 'billing_email_validator' && $field['hideorder'] == 0 && $key != 'billing_phone' && $key != 'billing_email' && !$field['hideorder'] ) :&nbsp;</div></li><li><div>                  if ( isset($options['woofields'][$fortype][$key]['custom_' . $key]) && $options['woofields'][$fortype][$key]['custom_' . $key]) :&nbsp;</div></li><li><div>                      $configField['label'] = isset($checkout_fields[$key]['label']) && !empty($checkout_fields[$key]['label']) ? __($checkout_fields[$key]['label'], WCPGSK_DOMAIN) : &quot;&quot;;&nbsp;</div></li><li><div>                      $captured_value = $order-&gt;$key;&nbsp;</div></li><li><div>                      if ( isset($options['woofields']['settings_' . $key]) ) :&nbsp;</div></li><li><div>                          $params = $this-&gt;explodeParameters($options['woofields']['settings_' . $key]);&nbsp;</div></li><li><div>                          if ( isset($params) && isset($params['validate']) && !empty($params['validate']) && $params['validate'] == 'password' ) :&nbsp;</div></li><li><div>                              $captured_value = '*******';&nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      $configField['captured'] = $captured_value;&nbsp;</div></li><li><div>                      $captured_fields[$fieldkey] = $configField;&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          return $captured_fields;    &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Get user meta data for billing or shipping.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 2.1.2</span>&nbsp;</div></li><li><div><span class="comment">       * @output Settings page</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      public function wcpgsk_additional_data_user($fortype) {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          $customer_id = get_current_user_id();&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $captured_fields = array();&nbsp;</div></li><li><div>          $field_order = 1;    &nbsp;</div></li><li><div>          $checkout_fields = $woocommerce-&gt;countries-&gt;get_address_fields( $woocommerce-&gt;countries-&gt;get_base_country(), $fortype . '_' );&nbsp;</div></li><li><div>          foreach ($checkout_fields as $key =&gt; $field) :&nbsp;</div></li><li><div>              $checkout_fields[$key]['order'] = ((!empty($options['woofields']['order_' . $key]) && ctype_digit($options['woofields']['order_' . $key])) ? $options['woofields']['order_' . $key] : $field_order);&nbsp;</div></li><li><div>              $checkout_fields[$key]['required'] = ((isset($options['woofields']['required_' . $key])) ? $options['woofields']['required_' . $key] : $checkout_fields[$key]['required']);&nbsp;</div></li><li><div>              $checkout_fields[$key]['hideorder'] = ((isset($options['woofields']['hideorder_' . $key])) ? $options['woofields']['hideorder_' . $key] : 0);&nbsp;</div></li><li><div>              if (!isset($configField['label'])) $configField['label'] = __($checkout_fields[$key]['label'], WCPGSK_DOMAIN);                &nbsp;</div></li><li><div>              $field_order++;&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          uasort($checkout_fields, array($this, &quot;compareFieldOrder&quot;));                        &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ($checkout_fields as $key =&gt; $field) : &nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment"><span class="comment">//$fieldLabel = $field['displaylabel'];</span></span></span></span>&nbsp;</div></li><li><div>              $fieldkey = str_replace('billing_', '', $key);&nbsp;</div></li><li><div>              $fieldkey = str_replace('shipping_', '', $key);&nbsp;</div></li><li><div>              if ($key != 'billing_email_validator' && $key != 'billing_phone' && $key != 'billing_email' ) :&nbsp;</div></li><li><div>                  if ( isset($options['woofields'][$fortype][$key]['custom_' . $key]) && $options['woofields'][$fortype][$key]['custom_' . $key]) :&nbsp;</div></li><li><div>                      $configField['label'] = isset($checkout_fields[$key]['label']) && !empty($checkout_fields[$key]['label']) ? __($checkout_fields[$key]['label'], WCPGSK_DOMAIN) : &quot;&quot;;&nbsp;</div></li><li><div>                      $captured_value = get_user_meta( $customer_id, $key, true );<span class="comment">//$order-&gt;$key;</span>&nbsp;</div></li><li><div>                      if ( isset($options['woofields']['settings_' . $key]) ) :&nbsp;</div></li><li><div>                          $params = $this-&gt;explodeParameters($options['woofields']['settings_' . $key]);&nbsp;</div></li><li><div>                          if ( isset($params) && isset($params['validate']) && !empty($params['validate']) && $params['validate'] == 'password' ) :&nbsp;</div></li><li><div>                              $captured_value = '*******';&nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      $configField['captured'] = $captured_value;&nbsp;</div></li><li><div>                      $captured_fields[$fieldkey] = $configField;&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          return $captured_fields;    &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Our Admin Settings Page.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @output Settings page</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      public function wcpgsk__options_page() {&nbsp;</div></li><li><div>          global $woocommerce, $wcpgsk_options, $wcpgsk_name;&nbsp;</div></li><li><div>          <span class="comment">//must check that the user has the required capability </span>&nbsp;</div></li><li><div>          if (!current_user_can('manage_options'))&nbsp;</div></li><li><div>          {&nbsp;</div></li><li><div>              wp_die( __('You do not have sufficient permissions to access this page.') );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $hidden_field_name = 'wcpgsk_submit_hidden';&nbsp;</div></li><li><div>          <span class="comment">// read options values</span>&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          if( isset($_POST[ $hidden_field_name ]) && $_POST[ $hidden_field_name ] == 'Y' ) {&nbsp;</div></li><li><div>              <span class="comment"><span class="comment">// Save the posted values in the database</span></span>&nbsp;</div></li><li><div>              <span class="comment">//var_dump($_POST);</span>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">              if ( isset($_POST['wcpgsk_settings']['checkoutform']['checkoutjs']) ) :</span>&nbsp;</div></li><li><div><span class="comment">                  $wcpgsk_checkoutjs = $options['checkoutform']['checkoutjs'];</span>&nbsp;</div></li><li><div><span class="comment">                  $options['checkoutform']['checkoutjs'] = '';</span>&nbsp;</div></li><li><div><span class="comment">                  update_option('wcpgsk_checkoutjs', $wcpgsk_checkoutjs);</span>&nbsp;</div></li><li><div><span class="comment">              endif;</span>&nbsp;</div></li><li><div><span class="comment">              */</span>&nbsp;</div></li><li><div>              update_option( 'wcpgsk_settings', $options );&nbsp;</div></li><li><div>              <span class="comment">//echo &quot;&lt;h1&gt;mumpits&lt;/h1&gt;&quot;;</span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          do_action( 'wcpgsk_settings_update', $options );&nbsp;</div></li><li><div>          <span class="comment">// Now display the settings editing screen</span>&nbsp;</div></li><li><div>          <span class="comment">//get some reused labels</span>&nbsp;</div></li><li><div>           &nbsp;</div></li><li><div>          $placeWide = __('Wide', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>          $placeFirst = __('First', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>          $placeLast = __('Last', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>          $defchecked = __('Default: checked', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>          $defunchecked = __('Default: unchecked', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          echo '&lt;div class=&quot;wrap&quot;&gt;';&nbsp;</div></li><li><div>          <span class="comment">// icon for settings</span>&nbsp;</div></li><li><div>          echo '&lt;div id=&quot;icon-themes&quot; class=&quot;icon32&quot;&gt;&lt;br&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>          <span class="comment">// header</span>&nbsp;</div></li><li><div>          $wcpgsk_name = apply_filters('wcpgsk_plus_name', $wcpgsk_name);&nbsp;</div></li><li><div>          echo &quot;&lt;h2&gt;&quot; . __( $wcpgsk_name, WCPGSK_DOMAIN ) . &quot;&lt;/h2&gt;&quot;;&nbsp;</div></li><li><div>          <span class="comment">// settings form </span>&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>          if ( isset($options['locale']['countrycode']) && $options['locale']['countrycode'] ) :&nbsp;</div></li><li><div>              $locale = get_option( 'wcpgsk_locale', array() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $localeCode = $options['locale']['countrycode'];&nbsp;</div></li><li><div>              $jsfields = $this-&gt;wcpgsk_get_country_locale_field_selectors();&nbsp;</div></li><li><div>              foreach ($jsfields as $field =&gt; $fieldids) :&nbsp;</div></li><li><div>                  $locale[$localeCode]['label_' . $field] = $options['locale']['label_' . $field];&nbsp;</div></li><li><div>                  $locale[$localeCode]['placeholder_' . $field] = $options['locale']['placeholder_' . $field];&nbsp;</div></li><li><div>                  $locale[$localeCode]['required_' . $field] = $options['locale']['required_' . $field];&nbsp;</div></li><li><div>                  if ( $field !== 'state' ) :&nbsp;</div></li><li><div>                      $locale[$localeCode]['hidden_' . $field] = $options['locale']['hidden_' . $field];&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>              endforeach;&nbsp;</div></li><li><div>              $locale[$localeCode]['postcode_before_city'] = $options['locale']['postcode_before_city'];    &nbsp;</div></li><li><div>              <span class="comment"><span class="comment">// Save the posted values in the database</span></span>&nbsp;</div></li><li><div>              update_option( 'wcpgsk_locale', $locale );&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>          &lt;form name=&quot;form&quot; method=&quot;post&quot; action=&quot;options.php&quot; id=&quot;frm1&quot;&gt;&nbsp;</div></li><li><div>              &lt;input type=&quot;hidden&quot; name=&quot;&lt;?php echo $hidden_field_name; ?&gt;&quot; value=&quot;Y&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php&nbsp;</div></li><li><div>                      settings_fields( 'wcpgsk_options' );&nbsp;</div></li><li><div>                      $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>                      $options['process']['fastcheckoutbtn'] = isset($options['process']['fastcheckoutbtn']) ? $options['process']['fastcheckoutbtn'] : '';&nbsp;</div></li><li><div>                      $options['process']['readmorebtn'] = isset($options['process']['readmorebtn']) ? $options['process']['readmorebtn'] : '';&nbsp;</div></li><li><div>                      $options['process']['buyproductbtn'] = isset($options['process']['buyproductbtn']) ? $options['process']['buyproductbtn'] : '';&nbsp;</div></li><li><div>                      $options['process']['viewproductsbtn'] = isset($options['process']['viewproductsbtn']) ? $options['process']['viewproductsbtn'] : '';&nbsp;</div></li><li><div>                      $options['process']['selectoptionsbtn'] = isset($options['process']['selectoptionsbtn']) ? $options['process']['selectoptionsbtn'] : '';&nbsp;</div></li><li><div>                      $options['process']['outofstockbtn'] = isset($options['process']['outofstockbtn']) ? $options['process']['outofstockbtn'] : '';    &nbsp;</div></li><li><div>                      if ( !isset( $options['process']['onsalelabel'] ) ) :&nbsp;</div></li><li><div>                          $options['process']['onsalelabel'] = __( 'Sale!', WCPGSK_DOMAIN );&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      if ( !isset( $options['process']['backorderlabel'] ) ) :&nbsp;</div></li><li><div>                          $options['process']['backorderlabel'] = '';&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      if ( !isset( $options['process']['emptycartlabel'] ) ) :&nbsp;</div></li><li><div>                          $options['process']['emptycartlabel'] = __( 'Empty cart?', WCPGSK_DOMAIN );&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      if ( !isset( $options['process']['confirmemptycart'] ) ) :&nbsp;</div></li><li><div>                          $options['process']['confirmemptycart'] = __( 'Yes, empty cart', WCPGSK_DOMAIN );&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      if ( !isset( $options['checkoutform']['cssclass'] ) ) :&nbsp;</div></li><li><div>                          $options['cssclass']['cssclass'] = '';&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      <span class="comment">//add options if necessary</span>&nbsp;</div></li><li><div>                      <span class="comment">//unset( $options['filters'] );</span>&nbsp;</div></li><li><div>                      if ( !isset( $options['filters'] ) || empty( $options['filters'] ) ) :&nbsp;</div></li><li><div>                          $options['filters'] = array(&nbsp;</div></li><li><div>                              'loop_shop_per_page' =&gt; get_option( 'posts_per_page' ), &nbsp;</div></li><li><div>                              'loop_shop_columns' =&gt; '4', &nbsp;</div></li><li><div>                              'woocommerce_product_thumbnails_columns' =&gt; '3', &nbsp;</div></li><li><div>                              'woocommerce_create_account_default_checked' =&gt; 0, &nbsp;</div></li><li><div>                              'woocommerce_product_description_tab_title' =&gt; __('Description', 'woocommerce'), &nbsp;</div></li><li><div>                              'woocommerce_product_description_heading' =&gt; __( 'Product Description', 'woocommerce' ), &nbsp;</div></li><li><div>                              'woocommerce_product_additional_information_tab_title' =&gt; __('Additional Information', 'woocommerce'), &nbsp;</div></li><li><div>                              'woocommerce_product_additional_information_heading' =&gt; __( 'Additional Information', 'woocommerce' ), &nbsp;</div></li><li><div>                              'woocommerce_checkout_must_be_logged_in_message' =&gt; __( 'You must be logged in to checkout.', 'woocommerce' ), &nbsp;</div></li><li><div>                              'woocommerce_checkout_login_message' =&gt; __( 'Returning customer?', 'woocommerce' ), &nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                              'woocommerce_checkout_coupon_message' =&gt; __( 'Have a coupon?', 'woocommerce' ), &nbsp;</div></li><li><div>                              'woocommerce_checkout_coupon_link_message' =&gt; __( 'Click here to enter your code', 'woocommerce' ), &nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                              'woocommerce_order_button_text' =&gt; __( 'Place order', 'woocommerce' ), &nbsp;</div></li><li><div>                              'woocommerce_pay_order_button_text' =&gt; __( 'Pay for order', 'woocommerce' ), &nbsp;</div></li><li><div>                              'woocommerce_thankyou_order_received_text' =&gt; __( 'Thank you. Your order has been received.', 'woocommerce' ), &nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                              'woocommerce_countries_tax_or_vat' =&gt; $this-&gt;WC()-&gt;countries-&gt;tax_or_vat(), &nbsp;</div></li><li><div>                              'woocommerce_countries_inc_tax_or_vat' =&gt; $this-&gt;WC()-&gt;countries-&gt;inc_tax_or_vat(), &nbsp;</div></li><li><div>                              'woocommerce_countries_ex_tax_or_vat' =&gt; $this-&gt;WC()-&gt;countries-&gt;ex_tax_or_vat(), &nbsp;</div></li><li><div>                              'woocommerce_placeholder_img_src' =&gt; '', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>              &lt;div id=&quot;wcpgsk_accordion&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php do_action( 'wcpgsk_settings_page_zero', $options ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;h3 class=&quot;wcpgsk_acc_header&quot;&gt;&lt;?php echo __('Shop Settings', WCPGSK_DOMAIN); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                  &lt;div&gt;&nbsp;</div></li><li><div>                      &lt;table class=&quot;widefat&quot; border=&quot;1&quot; &gt;&nbsp;</div></li><li><div>                      &lt;thead&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;th&gt;&lt;?php _e('Settings Name', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                              &lt;th&gt;&lt;?php _e('Data', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;        &nbsp;</div></li><li><div>                              &lt;th&gt;&lt;?php _e('Comments', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                      &lt;/thead&gt;&nbsp;</div></li><li><div>                      &lt;tbody&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Product items per page', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[filters][loop_shop_per_page]&quot; type=&quot;number&quot; value=&quot;&lt;?php if (isset($options['filters']['loop_shop_per_page'])) echo esc_attr( $options['filters']['loop_shop_per_page'] ); ?&gt;&quot; size=&quot;3&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php esc_attr(_e('Specify the number of items you want to show on a shop page.', WCPGSK_DOMAIN)); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Product columns per page', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[filters][loop_shop_columns]&quot; type=&quot;number&quot; value=&quot;&lt;?php if (isset($options['filters']['loop_shop_columns'])) echo esc_attr( $options['filters']['loop_shop_columns'] ); ?&gt;&quot; size=&quot;2&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php esc_attr(_e('Specify the number of product columns you want to show on a shop page.', WCPGSK_DOMAIN)); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Product thumbnail columns per page', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[filters][woocommerce_product_thumbnails_columns]&quot; type=&quot;number&quot; value=&quot;&lt;?php if (isset($options['filters']['woocommerce_product_thumbnails_columns'])) echo esc_attr( $options['filters']['woocommerce_product_thumbnails_columns'] ); ?&gt;&quot; size=&quot;2&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php esc_attr(_e('Specify the number of product thumbnail columns you want to show on a shop page.', WCPGSK_DOMAIN)); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Default state of create account', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input class=&quot;checkbox&quot; name=&quot;wcpgsk_settings[filters][woocommerce_create_account_default_checked]&quot; id=&quot;wcpgsk_create_account&quot; value=&quot;0&quot; type=&quot;hidden&quot;&gt;&nbsp;</div></li><li><div>                                  &lt;input class=&quot;checkbox&quot; name=&quot;wcpgsk_settings[process][woocommerce_create_account_default_checked]&quot; id=&quot;wcpgsk_create_account&quot; value=&quot;1&quot; type=&quot;checkbox&quot; &lt;?php if ( isset( $options['filters']['woocommerce_create_account_default_checked'] ) && 1 == ($options['filters']['woocommerce_create_account_default_checked'])) echo &quot;checked='checked'&quot;; ?&gt; type=&quot;checkbox&quot;&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Control the default state of the create account checkbox in checkout', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Enable Fast Cart', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input class=&quot;checkbox&quot; name=&quot;wcpgsk_settings[process][fastcart]&quot; id=&quot;wcpgsk_fastcart&quot; value=&quot;0&quot; type=&quot;hidden&quot;&gt;&nbsp;</div></li><li><div>                                  &lt;input class=&quot;checkbox&quot; name=&quot;wcpgsk_settings[process][fastcart]&quot; id=&quot;wcpgsk_fastcart&quot; value=&quot;1&quot; type=&quot;checkbox&quot; &lt;?php if (  1 == ($options['process']['fastcart'])) echo &quot;checked='checked'&quot;; ?&gt; type=&quot;checkbox&quot;&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('This option takes customers to cart after adding an item. Do not activate both, Fast Cart and Fast Checkout...', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Enable Fast Checkout', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input class=&quot;checkbox&quot; name=&quot;wcpgsk_settings[process][fastcheckout]&quot; id=&quot;wcpgsk_fastcheckout&quot; value=&quot;0&quot; type=&quot;hidden&quot;&gt;&nbsp;</div></li><li><div>                                  &lt;input class=&quot;checkbox&quot; name=&quot;wcpgsk_settings[process][fastcheckout]&quot; id=&quot;wcpgsk_fastcheckout&quot; value=&quot;1&quot; type=&quot;checkbox&quot; &lt;?php if (  1 == ($options['process']['fastcheckout'])) echo &quot;checked='checked'&quot;; ?&gt; type=&quot;checkbox&quot;&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('This option takes customers to checkout after adding an item. Do not activate both, Fast Cart and Fast Checkout...', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Enable Payment Gateways Configuration', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input class=&quot;checkbox&quot; name=&quot;wcpgsk_settings[process][paymentgateways]&quot; id=&quot;wcpgsk_paymentgateways&quot; value=&quot;0&quot; type=&quot;hidden&quot;&gt;&nbsp;</div></li><li><div>                                  &lt;input class=&quot;checkbox&quot; name=&quot;wcpgsk_settings[process][paymentgateways]&quot; id=&quot;wcpgsk_paymentgateways&quot; value=&quot;1&quot; type=&quot;checkbox&quot; &lt;?php if (  1 == ($options['process']['paymentgateways'])) echo &quot;checked='checked'&quot;; ?&gt; type=&quot;checkbox&quot;&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('This option allows you to configure the available payment gateways for each product.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;?php do_action( 'wcpgsk_settings_shop_after', $options ); ?&gt;&nbsp;</div></li><li><div>                      &lt;/tbody&gt;&nbsp;</div></li><li><div>                      &lt;/table&gt;&nbsp;</div></li><li><div>                      &lt;?php submit_button( __( 'Save Changes', WCPGSK_DOMAIN ) ); ?&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &lt;/div&gt;&nbsp;</div></li><li><div>                  &lt;?php do_action( 'wcpgsk_settings_page_labels', $options ); ?&gt;&nbsp;</div></li><li><div>                  &lt;?php do_action( 'wcpgsk_settings_page_email', $options ); ?&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &lt;?php do_action( 'wcpgsk_settings_page_two', $options ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;h3 class=&quot;wcpgsk_acc_header&quot;&gt;&lt;?php echo __('Cart Settings', WCPGSK_DOMAIN); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                  &lt;div&gt;&nbsp;</div></li><li><div>                      &lt;table class=&quot;widefat&quot; border=&quot;1&quot; &gt;&nbsp;</div></li><li><div>                      &lt;thead&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;th&gt;&lt;?php _e('Settings Name', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                              &lt;th width=&quot;50%&quot;&gt;&lt;?php _e('Data', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;        &nbsp;</div></li><li><div>                              &lt;th&gt;&lt;?php _e('Comments', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                      &lt;/thead&gt;&nbsp;</div></li><li><div>                      &lt;tbody&gt;&nbsp;</div></li><li><div>                          &lt;?php do_action( 'wcpgsk_settings_cart_before', $options ); ?&gt;                            &nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Add empty cart button to cart', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[cart][addemptycart]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[cart][addemptycart]&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php if (  1 == ($options['cart']['addemptycart'])) echo &quot;checked='checked'&quot;; ?&gt; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Allow your customers to empty the cart.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Empty Cart Label', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[process][emptycartlabel]&quot; type=&quot;text&quot; id=&quot;wcpgsk_emptycartlabel&quot; value=&quot;&lt;?php echo isset( $options['process']['emptycartlabel'] ) ? $options['process']['emptycartlabel'] : ''; ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Label for the empty cart button.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td width=&quot;25%&quot;&gt;&lt;?php _e( 'Confirm Empty Cart Label', WCPGSK_DOMAIN ); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[process][confirmemptycart]&quot; type=&quot;text&quot; id=&quot;wcpgsk_confirmemptycart&quot; value=&quot;&lt;?php echo isset( $options['process']['confirmemptycart'] ) ? $options['process']['confirmemptycart'] : ''; ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Leave this blank to allow empty cart action without confirmation.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Minimum cart items', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[cart][minitemscart]&quot; type=&quot;text&quot; value=&quot;&lt;?php if (isset($options['cart']['minitemscart'])) echo esc_attr( $options['cart']['minitemscart'] ); ?&gt;&quot; size=&quot;2&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php esc_attr(_e('You can specify the minimum of items allowed in woocommerce customer carts for wholesale purposes. If you leave this blank 0 (=option deactivated) will be established. Please be aware that you have to set the maximum to the same or a higher limit. This value will be automatically adjusted to assure store operations.', WCPGSK_DOMAIN)); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Maximum cart items', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[cart][maxitemscart]&quot; type=&quot;text&quot; value=&quot;&lt;?php if (isset($options['cart']['maxitemscart'])) echo esc_attr( $options['cart']['maxitemscart'] ); ?&gt;&quot; size=&quot;2&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('You can specify the maximum of items allowed in woocommerce customer carts. If you leave this blank 0 (=option deactivated) will be established.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Treat variation items like individual (different) product items when counting items in cart', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[cart][variationscountasproduct]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[cart][variationscountasproduct]&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php if (  1 == ($options['cart']['variationscountasproduct'])) echo &quot;checked='checked'&quot;; ?&gt; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('If you want to allow users to buy the maximum of variations allowed, even if the the product maximum is reached, do not check this option. Minimum handling takes this into account, too.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Maximum global cart quantity', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[cart][maxqtycart]&quot; type=&quot;text&quot; value=&quot;&lt;?php if (isset($options['cart']['maxqtycart'])) echo esc_attr( $options['cart']['maxqtycart'] ); ?&gt;&quot; size=&quot;3&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('You can specify the allowed overall maximum (sum of all item quantities). If you leave this blank, 0 (=option deactivated) will be established.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Minimum global cart quantity', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[cart][minqtycart]&quot; type=&quot;text&quot; value=&quot;&lt;?php if (isset($options['cart']['minqtycart'])) echo esc_attr( $options['cart']['minqtycart'] ); ?&gt;&quot; size=&quot;3&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('You can specify the required overall minimum (sum of all item quantities). If you leave this blank, 0 (=option deactivated) will be established.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Allow min/max/step configuration on per product basis', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[cart][minmaxstepproduct]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[cart][minmaxstepproduct]&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php if (  1 == ($options['cart']['minmaxstepproduct'])) echo &quot;checked='checked'&quot;; ?&gt; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('If you want to configure minimum/maximum and steps for item quantities, enable this checkbox. Individual product settings take precedence over the following global settings.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Switch off quantity input', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;?php&nbsp;</div></li><li><div>                                  $noquantity = __('No quantity input for', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                                  $quantity = __('Quantity input for', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                                  ?&gt;&nbsp;</div></li><li><div>                                  &lt;select name=&quot;wcpgsk_settings[cart][variationproductnoqty]&quot; class=&quot;wcpgsk_qty_select&quot;&gt;&nbsp;</div></li><li><div>                                      &lt;option value=&quot;1&quot; &lt;?php if ($options['cart']['variationproductnoqty'] == 1) echo &quot;selected&quot;; ?&gt; &gt;&lt;?php echo $noquantity . ' ' . __('Product Variation', WCPGSK_DOMAIN);?&gt;&lt;/option&gt;    &nbsp;</div></li><li><div>                                      &lt;option value=&quot;0&quot; &lt;?php if ($options['cart']['variationproductnoqty'] == 0) echo &quot;selected&quot;; ?&gt; &gt;&lt;?php echo $quantity . ' ' . __('Product Variation', WCPGSK_DOMAIN);?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                  &lt;/select&gt;&lt;br /&gt;&nbsp;</div></li><li><div>                                  &lt;select name=&quot;wcpgsk_settings[cart][variableproductnoqty]&quot; class=&quot;wcpgsk_qty_select&quot;&gt;&nbsp;</div></li><li><div>                                      &lt;option value=&quot;1&quot; &lt;?php if ($options['cart']['variableproductnoqty'] == 1) echo &quot;selected&quot;; ?&gt; &gt;&lt;?php echo $noquantity . ' ' . __('Variable Product', WCPGSK_DOMAIN);?&gt;&lt;/option&gt;    &nbsp;</div></li><li><div>                                      &lt;option value=&quot;0&quot; &lt;?php if ($options['cart']['variableproductnoqty'] == 0) echo &quot;selected&quot;; ?&gt; &gt;&lt;?php echo $quantity . ' ' . __('Variable Product', WCPGSK_DOMAIN);?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                  &lt;/select&gt;&lt;br /&gt;&nbsp;</div></li><li><div>                                  &lt;!-- Does not apply&nbsp;</div></li><li><div>                                  &lt;select name=&quot;wcpgsk_settings[cart][groupedproductnoqty]&quot; class=&quot;wcpgsk_qty_select&quot;&gt;&nbsp;</div></li><li><div>                                      &lt;option value=&quot;1&quot; &lt;?php <span class="comment">//if ($options['cart']['groupedproductnoqty'] == 1) echo &quot;selected&quot;; ?&gt; &gt;&lt;?php //echo $noquantity  . ' ' . __('Grouped Product', WCPGSK_DOMAIN);?&gt;&lt;/option&gt;    </span>&nbsp;</div></li><li><div>                                      &lt;option value=&quot;0&quot; &lt;?php <span class="comment">//if ($options['cart']['groupedproductnoqty'] == 0) echo &quot;selected&quot;; ?&gt; &gt;&lt;?php //echo $quantity . ' ' . __('Grouped Product', WCPGSK_DOMAIN);?&gt;&lt;/option&gt;</span>&nbsp;</div></li><li><div>                                  &lt;/select&gt;&lt;br /&gt;&nbsp;</div></li><li><div>                                  --&gt;&nbsp;</div></li><li><div>                                  &lt;select name=&quot;wcpgsk_settings[cart][externalproductnoqty]&quot; class=&quot;wcpgsk_qty_select&quot;&gt;&nbsp;</div></li><li><div>                                      &lt;option value=&quot;1&quot; &lt;?php if ($options['cart']['externalproductnoqty'] == 1) echo &quot;selected&quot;; ?&gt; &gt;&lt;?php echo $noquantity . ' ' . __('External Product', WCPGSK_DOMAIN);?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                      &lt;option value=&quot;0&quot; &lt;?php if ($options['cart']['externalproductnoqty'] == 0) echo &quot;selected&quot;; ?&gt; &gt;&lt;?php echo $quantity . ' ' . __('External Product', WCPGSK_DOMAIN);?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                  &lt;/select&gt;&lt;br /&gt;&nbsp;</div></li><li><div>                                  &nbsp;</div></li><li><div>                                  &lt;select name=&quot;wcpgsk_settings[cart][simpleproductnoqty]&quot; class=&quot;wcpgsk_qty_select&quot;&gt;&nbsp;</div></li><li><div>                                      &lt;option value=&quot;1&quot; &lt;?php if ($options['cart']['simpleproductnoqty'] == 1) echo &quot;selected&quot;; ?&gt; &gt;&lt;?php echo $noquantity . ' ' . __('Simple Product', WCPGSK_DOMAIN);?&gt;&lt;/option&gt;    &nbsp;</div></li><li><div>                                      &lt;option value=&quot;0&quot; &lt;?php if ($options['cart']['simpleproductnoqty'] == 0) echo &quot;selected&quot;; ?&gt; &gt;&lt;?php echo $quantity . ' ' . __('Simple Product', WCPGSK_DOMAIN);?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                  &lt;/select&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Switch off the quantity input field and set quantity automatically to one if a customer adds a product or product variation to his/her cart.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                      &lt;?php&nbsp;</div></li><li><div>                          $product_types = array('variation' =&gt; __('Set the minimum and maximum quantities allowed for each item that a customer can add to his/her cart', WCPGSK_DOMAIN), &nbsp;</div></li><li><div>                              'variable' =&gt; __('Please, you should not confuse product quantity and the allowed maximum and minimum of individual items in a cart.', WCPGSK_DOMAIN), &nbsp;</div></li><li><div>                              <span class="comment">//does not apply 'grouped' =&gt; __('The min and max quantity values only have effect if you enable quantity input for a given product type. To disable this functionality you can set this value to 0.', WCPGSK_DOMAIN), </span>&nbsp;</div></li><li><div>                              'external' =&gt; __('To squizze out more of WooCommerce you may want to upgrade to WooCommerce Rich Guys Swiss Knife :-).', WCPGSK_DOMAIN), &nbsp;</div></li><li><div>                              'simple' =&gt; __('Individual items can be personalized by Woocommerce Rich Guys Swiss Knife during checkout.', WCPGSK_DOMAIN));&nbsp;</div></li><li><div>                          foreach($product_types as $type =&gt; $descr) :&nbsp;</div></li><li><div>                              $minqty = !empty($options['cart']['minqty_' . $type]) ? $options['cart']['minqty_' . $type] : 0;&nbsp;</div></li><li><div>                              $maxqty = !empty($options['cart']['maxqty_' . $type]) ? $options['cart']['maxqty_' . $type] : 0;&nbsp;</div></li><li><div>                              $stepqty = !empty($options['cart']['stepqty_' . $type]) ? $options['cart']['stepqty_' . $type] : 0;&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                      ?&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Min/Max/Step quantity &lt;strong&gt;' . $type . ' products', WCPGSK_DOMAIN); ?&gt;&lt;/strong&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[cart][minqty_&lt;?php echo $type ; ?&gt;]&quot; type=&quot;text&quot; value=&quot;&lt;?php echo $minqty; ?&gt;&quot; size=&quot;2&quot; class=&quot;wcpgsk_textfield_short&quot; /&gt; |&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[cart][maxqty_&lt;?php echo $type ; ?&gt;]&quot; type=&quot;text&quot; value=&quot;&lt;?php echo $maxqty ; ?&gt;&quot; size=&quot;2&quot; class=&quot;wcpgsk_textfield_short&quot; /&gt; |&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[cart][stepqty_&lt;?php echo $type ; ?&gt;]&quot; type=&quot;text&quot; value=&quot;&lt;?php echo $stepqty ; ?&gt;&quot; size=&quot;2&quot; class=&quot;wcpgsk_textfield_short&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php echo $descr ; ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                      &lt;?php&nbsp;</div></li><li><div>                          endforeach;&nbsp;</div></li><li><div>                      ?&gt;&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                      &lt;?php do_action( 'wcpgsk_settings_cart_after', $options ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;/tbody&gt;&nbsp;</div></li><li><div>                      &lt;/table&gt;&nbsp;</div></li><li><div>                      &lt;?php submit_button( __( 'Save Changes', WCPGSK_DOMAIN ) ); ?&gt;&nbsp;</div></li><li><div>                  &lt;/div&gt;&nbsp;</div></li><li><div>                  &lt;?php do_action( 'wcpgsk_settings_page_four', $options ); ?&gt;&nbsp;</div></li><li><div>                      &lt;h3 class=&quot;wcpgsk_acc_header&quot;&gt;&lt;?php echo __('Checkout Settings', WCPGSK_DOMAIN); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                      &lt;div&gt;&nbsp;</div></li><li><div>                      &lt;table class=&quot;widefat&quot; border=&quot;1&quot; &gt;&nbsp;</div></li><li><div>                      &lt;thead&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;th&gt;&lt;?php _e('Settings Name', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                              &lt;th&gt;&lt;?php _e('Data', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;        &nbsp;</div></li><li><div>                              &lt;th&gt;&lt;?php _e('Comments', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                      &lt;/thead&gt;&nbsp;</div></li><li><div>                      &lt;tbody&gt;&nbsp;</div></li><li><div>                          &lt;?php do_action( 'wcpgsk_settings_checkout_before', $options ); ?&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Min date offset for date fields', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[checkoutform][mindate]&quot; type=&quot;text&quot; value=&quot;&lt;?php if (!empty($options['checkoutform']['mindate'])) echo esc_attr( $options['checkoutform']['mindate'] ); ?&gt;&quot; size=&quot;2&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('For date fields you can specify a minimum offset in number of days.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Max date offset for date fields', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[checkoutform][maxdate]&quot; type=&quot;text&quot; value=&quot;&lt;?php if (!empty($options['checkoutform']['maxdate'])) echo esc_attr( $options['checkoutform']['maxdate'] ); ?&gt;&quot; size=&quot;3&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('For date fields you can specify a maximum offset in number of days.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Use calendar style time picker', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[checkoutform][caltimepicker]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[checkoutform][caltimepicker]&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php if ( isset( $options['checkoutform']['caltimepicker'] ) && 1 == ($options['checkoutform']['caltimepicker'])) echo &quot;checked='checked'&quot;; ?&gt; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Use alternative presentation for time picker fields.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Css class', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[checkoutform][cssclass]&quot; type=&quot;text&quot; class=&quot;wcpgsk_textfield&quot; value=&quot;&lt;?php if (!empty($options['checkoutform']['cssclass'])) echo esc_attr( $options['checkoutform']['cssclass'] ); ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('You can add one or more css classes to custom fields. Use space as separator.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Additional billing fields title', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[checkoutform][morebillingtitle]&quot; type=&quot;text&quot; class=&quot;wcpgsk_textfield&quot; value=&quot;&lt;?php if (!empty($options['checkoutform']['morebillingtitle'])) echo esc_attr( $options['checkoutform']['morebillingtitle'] ); ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('You can set the additional billing information section title used in emails and order receipts. If you leave this field empty the section title will be omitted.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Additional shipping fields title', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[checkoutform][moreshippingtitle]&quot; type=&quot;text&quot; class=&quot;wcpgsk_textfield&quot; value=&quot;&lt;?php if (!empty($options['checkoutform']['moreshippingtitle'])) echo esc_attr( $options['checkoutform']['moreshippingtitle'] ); ?&gt;&quot; class=&quot;regular-text&quot; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('You can set the additional shipping information section title used in emails and order receipts. If you leave this field empty the section title will be omitted.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Add billing email validator', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[checkoutform][billingemailvalidator]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                                  &lt;input name=&quot;wcpgsk_settings[checkoutform][billingemailvalidator]&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php if (  1 == ($options['checkoutform']['billingemailvalidator'])) echo &quot;checked='checked'&quot;; ?&gt; /&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('If you want to oblige the user to input his/her email a second time and to assure that the email is valid, activate. This field will be added automatically.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;tr&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&lt;?php _e('Checkout Script', WCPGSK_DOMAIN); ?&gt;:&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;textarea name=&quot;wcpgsk_checkoutjs&quot; id=&quot;wcpgsk_checkoutjs&quot;&gt;&lt;?php echo get_option('wcpgsk_checkoutjs') ;?&gt;&lt;/textarea&gt;&nbsp;</div></li><li><div>                                  &lt;button onclick=&quot;save_checkoutjs();return false;&quot;&gt;&lt;?php _e('Save js', WCPGSK_DOMAIN); ?&gt;&lt;/button&gt;&nbsp;</div></li><li><div>                                  &lt;span id=&quot;result_save_checkoutjs&quot;&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('You can save your own js code for the checkout page here. Only code, no tags!', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                                  &lt;br /&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('Please use with care as this may break things if not handled with care.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                                  &lt;br /&gt;&nbsp;</div></li><li><div>                                  &lt;span class=&quot;description&quot;&gt;&lt;?php _e('You can include your script by editing wcpgsk_user.js too but you will have to restore your changes after every update of this plugin.', WCPGSK_DOMAIN); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                              &lt;/td&gt;&nbsp;</div></li><li><div>                          &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;?php do_action('wcpgsk_settings_checkout_after', $options); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      &lt;/tbody&gt;&nbsp;</div></li><li><div>                      &lt;/table&gt;&nbsp;</div></li><li><div>                      &lt;?php submit_button( __( 'Save Changes', WCPGSK_DOMAIN ) ); ?&gt;&nbsp;</div></li><li><div>                  &lt;/div&gt;&nbsp;</div></li><li><div>                  &lt;?php&nbsp;</div></li><li><div>                  do_action( 'wcpgsk_settings_page_six', $options );&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  <span class="comment">//if ( function_exists('WC') ) :</span>&nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>                      &lt;h3 class=&quot;wcpgsk_acc_header&quot;&gt;&lt;?php echo __('Woocommerce Checkout Localization', WCPGSK_DOMAIN); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                      &lt;div&gt;&nbsp;</div></li><li><div>                          &lt;table class=&quot;widefat&quot; border=&quot;1&quot; &gt;&nbsp;</div></li><li><div>                          &lt;thead&gt;&nbsp;</div></li><li><div>                              &lt;tr&gt;&nbsp;</div></li><li><div>                                  &lt;th&gt;&lt;?php _e('Field Name', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                                  &lt;th&gt;&lt;?php _e('Default Behaviour', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;        &nbsp;</div></li><li><div>                                  &lt;th&gt;&lt;?php _e('Comments', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                              &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;/thead&gt;&nbsp;</div></li><li><div>                          &lt;tbody&gt;&nbsp;</div></li><li><div>                              &lt;?php&nbsp;</div></li><li><div>                              $jsfields = $this-&gt;wcpgsk_get_country_locale_field_selectors();&nbsp;</div></li><li><div>                              foreach ($jsfields as $field =&gt; $fieldids) :&nbsp;</div></li><li><div>                              ?&gt;&nbsp;</div></li><li><div>                              &lt;tr&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&lt;?php echo $field; ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&nbsp;</div></li><li><div>                                      &lt;input name=&quot;wcpgsk_settings[checkoutform][default_&lt;?php echo $field; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                                      &lt;input name=&quot;wcpgsk_settings[checkoutform][default_&lt;?php echo $field; ?&gt;]&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php if ( isset($options['checkoutform']['default_' . $field]) && 1 == ($options['checkoutform']['default_' . $field])) echo &quot;checked='checked'&quot;; ?&gt; /&gt;&nbsp;</div></li><li><div>                                  &lt;/td&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&nbsp;</div></li><li><div>                                      &lt;span class=&quot;description&quot;&gt;&lt;?php echo __('Let WCPGSK handle localization for fields of type', WCPGSK_DOMAIN) . ' ' . $field; ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                                  &lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              &lt;?php&nbsp;</div></li><li><div>                              endforeach;&nbsp;</div></li><li><div>                              ?&gt;&nbsp;</div></li><li><div>                          &lt;/tbody&gt;&nbsp;</div></li><li><div>                          &lt;/table&gt;&nbsp;</div></li><li><div>                          &lt;table class=&quot;widefat&quot; border=&quot;1&quot; &gt;&nbsp;</div></li><li><div>                          &lt;thead&gt;&nbsp;</div></li><li><div>                              &lt;tr&gt;&nbsp;</div></li><li><div>                                  &lt;th&gt;&lt;?php _e('Field Name', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                                  &lt;th&gt;&lt;?php _e('Data', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;        &nbsp;</div></li><li><div>                                  &lt;th&gt;&lt;?php _e('Comments', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                              &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;/thead&gt;&nbsp;</div></li><li><div>                          &lt;tbody&gt;&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                              &lt;tr&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&lt;?php _e('Field Localization', WCPGSK_DOMAIN);  ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;select name=&quot;wcpgsk_configcountry&quot; id=&quot;wcpgsk_configcountry&quot; onChange=&quot;get_locale_fields_form()&quot;&gt; &nbsp;</div></li><li><div>                                      &lt;option value=&quot;&quot;&gt;&lt;?php echo __('Select Locale', WCPGSK_DOMAIN); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                      &lt;option value=&quot;default&quot;&gt;&lt;?php _e('Default Locale', WCPGSK_DOMAIN); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                  &lt;?php&nbsp;</div></li><li><div>                                      $countries = $this-&gt;wcpgsk_get_allowed_countries();<span class="comment">//WC()-&gt;countries-&gt;countries;</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                      foreach ($countries as $cc =&gt; $cn) :                            &nbsp;</div></li><li><div>                                      echo '&lt;option value=&quot;' . $cc . '&quot;&gt;' . $cn . '&lt;/option&gt;';&nbsp;</div></li><li><div>                                      endforeach;&nbsp;</div></li><li><div>                                  ?&gt;&nbsp;</div></li><li><div>                                  &lt;/select&gt;&nbsp;</div></li><li><div>                                  &lt;/td&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&nbsp;</div></li><li><div>                                  &lt;?php _e('Select country to configure', WCPGSK_DOMAIN);  ?&gt;&nbsp;</div></li><li><div>                                  &lt;/td&gt;&nbsp;</div></li><li><div>                                  &nbsp;</div></li><li><div>                              &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;/tbody&gt;&nbsp;</div></li><li><div>                          &lt;tbody id=&quot;locale_field_form&quot;&gt;&nbsp;</div></li><li><div>                          &lt;/tbody&gt;&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          &lt;/table&gt;&nbsp;</div></li><li><div>                          &lt;?php submit_button( __( 'Save Changes', WCPGSK_DOMAIN ) ); ?&gt;&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      &lt;/div&gt;&nbsp;</div></li><li><div>                  &lt;?php&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  $checkoutforms = array('billing' =&gt; 'Billing', 'shipping' =&gt; 'Shipping');&nbsp;</div></li><li><div>                  $checkoutforms = apply_filters( 'wcpgsk_checkoutforms', $checkoutforms );&nbsp;</div></li><li><div>                  foreach($checkoutforms as $section =&gt; $title) :&nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>                      &lt;h3 class=&quot;wcpgsk_acc_header&quot;&gt;&lt;?php echo __('Woocommerce Checkout ' . $title . ' Section', WCPGSK_DOMAIN); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                      &lt;div&gt;&nbsp;</div></li><li><div>                          &lt;table class=&quot;wcpgsk_fieldtable widefat&quot; id=&quot;wcpgsk_&lt;?php echo $section ;?&gt;_table&quot; border=&quot;1&quot; &gt;&nbsp;</div></li><li><div>                          &lt;thead&gt;&nbsp;</div></li><li><div>                              &lt;tr&gt;&nbsp;</div></li><li><div>                                  &lt;th class=&quot;wcpgsk_replace&quot;&gt;&lt;?php _e('Order', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                                  &lt;th&gt;&lt;?php _e('Field Name', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                                  &lt;th&gt;&lt;?php _e('Remove Field', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;        &nbsp;</div></li><li><div>                                  &lt;th&gt;&lt;?php _e('Required Field', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                                  &lt;th&gt;&lt;?php _e('Hide in Receipts', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                                  &lt;th&gt;&lt;span title=&quot;&lt;?php esc_attr_e('Store only in customer context, do not include in order', WCPGSK_DOMAIN); ?&gt;&quot;&gt;&lt;?php _e('Customer data', WCPGSK_DOMAIN);  ?&gt;&lt;/span&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                                  &lt;th class=&quot;wcpgsk_replace&quot;&gt;&lt;?php _e('Label', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                                  &lt;th class=&quot;wcpgsk_replace&quot;&gt;&lt;?php _e('Placeholder', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                                  &lt;th class=&quot;wcpgsk_replace&quot;&gt;&lt;?php _e('Display', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                                  &lt;th class=&quot;wcpgsk_replace&quot;&gt;&lt;?php _e('Type', WCPGSK_DOMAIN);  ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                              &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;/thead&gt;&nbsp;</div></li><li><div>                          &lt;tbody&gt;&nbsp;</div></li><li><div>                              &lt;tr&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&lt;input type=&quot;checkbox&quot; class=&quot;select_removes&quot; for=&quot;removes_&lt;?php echo $section ;?&gt;&quot; id=&quot;select_remove_&lt;?php echo $section ;?&gt;&quot; value=&quot;1&quot; /&gt; &lt;?php _e('Select All', WCPGSK_DOMAIN);  ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&lt;input type=&quot;checkbox&quot; class=&quot;select_required&quot; for=&quot;required_&lt;?php echo $section ;?&gt;&quot; id=&quot;select_required_&lt;?php echo $section ;?&gt;&quot; value=&quot;1&quot; /&gt; &lt;?php _e('Select All', WCPGSK_DOMAIN);  ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                  &lt;td&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                              &lt;/tr&gt;&nbsp;</div></li><li><div>                              &lt;?php &nbsp;</div></li><li><div>                              if ($section == 'order') :&nbsp;</div></li><li><div>                                  $checkout_fields = array();&nbsp;</div></li><li><div>                                  $checkout_fields = apply_filters( 'wcpgsk_order_checkout_fields', $checkout_fields, $options );&nbsp;</div></li><li><div>                              elseif ($section == 'shared') :&nbsp;</div></li><li><div>                                  $checkout_fields = array();&nbsp;</div></li><li><div>                                  $checkout_fields = apply_filters( 'wcpgsk_shared_checkout_fields', $checkout_fields, $options );&nbsp;</div></li><li><div>                              else:&nbsp;</div></li><li><div>                                  $checkout_fields = $woocommerce-&gt;countries-&gt;get_address_fields( $woocommerce-&gt;countries-&gt;get_base_country(), $section . '_' );&nbsp;</div></li><li><div>                                  $field_order = 1;&nbsp;</div></li><li><div>                                  foreach ($checkout_fields as $key =&gt; $field) :&nbsp;</div></li><li><div>                                      &nbsp;</div></li><li><div>                                      $checkout_fields[$key]['placeholder'] = isset($checkout_fields[$key]['placeholder']) ? $checkout_fields[$key]['placeholder'] : '';&nbsp;</div></li><li><div>                                      $checkout_fields[$key]['label'] = isset($checkout_fields[$key]['label']) ? $checkout_fields[$key]['label'] : '';&nbsp;</div></li><li><div>                                      $checkout_fields[$key]['required'] = isset($checkout_fields[$key]['required']) ? $checkout_fields[$key]['required'] : 0;&nbsp;</div></li><li><div>                                      &nbsp;</div></li><li><div>                                      $checkout_fields[$key]['fieldkey'] = $key;&nbsp;</div></li><li><div>                                      $checkout_fields[$key]['displaylabel'] = isset($options['woofields']['label_' . $key]) && !empty($field['label']) ? __($field['label'], WCPGSK_DOMAIN) : $key;&nbsp;</div></li><li><div>                                      $checkout_fields[$key]['order'] = ((isset($options['woofields']['order_' . $key]) && !empty($options['woofields']['order_' . $key]) && ctype_digit($options['woofields']['order_' . $key])) ? $options['woofields']['order_' . $key] : $field_order);&nbsp;</div></li><li><div>                                      <span class="comment">//$checkout_fields[$key]['placeholder'] = ((isset($options['woofields']['placeholder_' . $key]) && !empty($options['woofields']['placeholder_' . $key])) ? $options['woofields']['placeholder_' . $key] : $checkout_fields[$key]['placeholder']);</span>&nbsp;</div></li><li><div>                                      $checkout_fields[$key]['placeholder'] = ((isset($options['woofields']['placeholder_' . $key])) ? $options['woofields']['placeholder_' . $key] : $checkout_fields[$key]['placeholder']);&nbsp;</div></li><li><div>                                      $checkout_fields[$key]['label'] = ((isset($options['woofields']['label_' . $key])) ? $options['woofields']['label_' . $key] : $checkout_fields[$key]['label']);&nbsp;</div></li><li><div>                                      <span class="comment">//$checkout_fields[$key]['label'] = ((isset($options['woofields']['label_' . $key]) && !empty($options['woofields']['label_' . $key])) ? $options['woofields']['label_' . $key] : $checkout_fields[$key]['label']);</span>&nbsp;</div></li><li><div>                                      <span class="comment"><span class="comment"><span class="comment">//before required defreq</span></span></span>&nbsp;</div></li><li><div>                                      $checkout_fields[$key]['defreq'] = ((isset($checkout_fields[$key]['required']) && $checkout_fields[$key]['required'] == 1) ? $defchecked : $defunchecked);&nbsp;</div></li><li><div>                                      $checkout_fields[$key]['required'] = ((isset($options['woofields']['required_' . $key])) ? $options['woofields']['required_' . $key] : $checkout_fields[$key]['required']);&nbsp;</div></li><li><div>                                      $checkout_fields[$key]['customeronly'] = ((isset($options['woofields']['customeronly_' . $key])) ? $options['woofields']['customeronly_' . $key] : 0);&nbsp;</div></li><li><div>                                      $checkout_fields[$key]['hideorder'] = ((isset($options['woofields']['hideorder_' . $key])) ? $options['woofields']['hideorder_' . $key] : 0);&nbsp;</div></li><li><div>                                      $checkout_fields[$key]['type'] = ((isset($options['woofields']['type_' . $key]) && !empty($options['woofields']['type_' . $key])) ? $options['woofields']['type_' . $key] : ((!empty($checkout_fields[$key]['type'])) ? $checkout_fields[$key]['type'] : 'text') );&nbsp;</div></li><li><div>                                      &nbsp;</div></li><li><div>                                      $checkout_fields[$key]['classsel'] = ((isset($options['woofields']['class_' . $key]) && !empty($options['woofields']['class_' . $key])) ? $options['woofields']['class_' . $key] : ((isset($checkout_fields[$key]['class'])) ? $checkout_fields[$key]['class'][0] : 'form-row-wide') );&nbsp;</div></li><li><div>                                      $checkout_fields[$key]['settings'] = ((isset($options['woofields']['settings_' . $key]) && !empty($options['woofields']['settings_' . $key])) ? $options['woofields']['settings_' . $key] : '' );&nbsp;</div></li><li><div>                                      $field_order++;&nbsp;</div></li><li><div>                                  endforeach;&nbsp;</div></li><li><div>                              endif;&nbsp;</div></li><li><div>                              $checkout_fields = apply_filters( 'wcpgsk_checkout_fields', $checkout_fields, $options );&nbsp;</div></li><li><div>                              uasort( $checkout_fields, array($this, &quot;compareFieldOrder&quot;) );                        &nbsp;</div></li><li><div>                              $field_order = 1;&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                              foreach ($checkout_fields as $key =&gt; $field) : &nbsp;</div></li><li><div>                                  $fieldLabel = $field['displaylabel'];&nbsp;</div></li><li><div>                                  $options['woofields'][$section][$key]['custom_' . $key] = isset($options['woofields'][$section][$key]['custom_' . $key]) ? $options['woofields'][$section][$key]['custom_' . $key] : '';&nbsp;</div></li><li><div>                              ?&gt;&nbsp;</div></li><li><div>                                  &lt;tr class=&quot;wcpgsk_order_row&quot;&gt;&nbsp;</div></li><li><div>                                      &lt;td class=&quot;wcpgsk_order_col&quot;&gt;&lt;span class=&quot;ui-icon ui-icon-arrow-4&quot;&gt;&lt;/span&gt;&lt;span class=&quot;wcpgsk_order_span&quot;&gt;&lt;?php echo $field['order']; ?&gt;&lt;/span&gt;&lt;input type=&quot;hidden&quot;  class=&quot;wcpgsk_order_input&quot; name=&quot;wcpgsk_settings[woofields][order_&lt;?php echo $field['fieldkey']; ?&gt;]&quot; value=&quot;&lt;?php echo $field['order']; ?&gt;&quot; /&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&nbsp;</div></li><li><div>                                          &lt;?php&nbsp;</div></li><li><div>                                              if ($options['woofields'][$section][$key]['custom_' . $key] == $key && $key != 'order_comments') :&nbsp;</div></li><li><div>                                          ?&gt;&nbsp;</div></li><li><div>                                              &lt;input name=&quot;wcpgsk_settings[woofields][&lt;?php echo $section ;?&gt;][&lt;?php echo $key; ?&gt;][custom_&lt;?php echo $key; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;&lt;?php echo $key; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                                              &lt;button class=&quot;wcpgsk_remove_field&quot; for=&quot;wcpgsk_&lt;?php echo $section ;?&gt;_table&quot; name=&quot;wcpgsk_settings[woofields][&lt;?php echo $section ;?&gt;][&lt;?php echo $key; ?&gt;][fieldname_&lt;?php echo $key; ?&gt;]&quot;&gt;&lt;?php _e('X', WCPGSK_DOMAIN) ; ?&gt;&lt;/button&gt; &lt;?php echo $key; ?&gt;&nbsp;</div></li><li><div>                                          &lt;?php&nbsp;</div></li><li><div>                                              else :&nbsp;</div></li><li><div>                                                  if ($section == 'order' && $key == 'order_comments') :&nbsp;</div></li><li><div>                                                  ?&gt;&nbsp;</div></li><li><div>                                                      &lt;input name=&quot;wcpgsk_settings[woofields][&lt;?php echo $section ;?&gt;][&lt;?php echo $key; ?&gt;][custom_&lt;?php echo $key; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;&lt;?php echo $key; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                                                  &lt;?php&nbsp;</div></li><li><div>                                                  endif;&nbsp;</div></li><li><div>                                                  echo $fieldLabel; &nbsp;</div></li><li><div>                                              endif;&nbsp;</div></li><li><div>                                          ?&gt;&nbsp;</div></li><li><div>                                      &lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&lt;input name=&quot;wcpgsk_settings[woofields][remove_&lt;?php echo $field['fieldkey']; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                                          &lt;input name=&quot;wcpgsk_settings[woofields][remove_&lt;?php echo $field['fieldkey']; ?&gt;]&quot; type=&quot;checkbox&quot; class=&quot;removes_&lt;?php echo $section ;?&gt;&quot; value=&quot;1&quot; &nbsp;</div></li><li><div>                                          &lt;?php if ( isset($options['woofields']['remove_' . $field['fieldkey']]) && 1 == ($options['woofields']['remove_' . $field['fieldkey']]) ) echo 'checked=&quot;checked&quot;'; ?&gt;   /&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&lt;input name=&quot;wcpgsk_settings[woofields][required_&lt;?php echo $field['fieldkey']; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                                          &lt;input name=&quot;wcpgsk_settings[woofields][required_&lt;?php echo $field['fieldkey']; ?&gt;]&quot; type=&quot;checkbox&quot; class=&quot;required_&lt;?php echo $section ;?&gt;&quot; value=&quot;1&quot; &lt;?php if (  1 == $field['required'] ) echo &quot;checked='checked'&quot;; ?&gt; /&gt;&nbsp;</div></li><li><div>                                          &lt;small&gt; &lt;?php echo $field['defreq']; ?&gt;&lt;/small&gt;&nbsp;</div></li><li><div>                                      &lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&lt;input name=&quot;wcpgsk_settings[woofields][hideorder_&lt;?php echo $field['fieldkey']; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                                          &lt;input name=&quot;wcpgsk_settings[woofields][hideorder_&lt;?php echo $field['fieldkey']; ?&gt;]&quot; type=&quot;checkbox&quot; class=&quot;hideorder_&lt;?php echo $section ;?&gt;&quot; value=&quot;1&quot; &lt;?php if (  1 == $field['hideorder'] ) echo &quot;checked='checked'&quot;; ?&gt; /&gt;&nbsp;</div></li><li><div>                                      &lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&lt;input name=&quot;wcpgsk_settings[woofields][customeronly_&lt;?php echo $field['fieldkey']; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                                          &lt;input name=&quot;wcpgsk_settings[woofields][customeronly_&lt;?php echo $field['fieldkey']; ?&gt;]&quot; type=&quot;checkbox&quot; class=&quot;customeronly_&lt;?php echo $section ;?&gt;&quot; value=&quot;1&quot; &lt;?php if ( isset( $field['customeronly'] ) && 1 == $field['customeronly'] ) echo &quot;checked='checked'&quot;; ?&gt; /&gt;&nbsp;</div></li><li><div>                                      &lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;wcpgsk_settings[woofields][label_&lt;?php echo $field['fieldkey']; ?&gt;]&quot; class=&quot;wcpgsk_textfield&quot; &nbsp;</div></li><li><div>                                          value=&quot;&lt;?php echo esc_attr( $field['label'] ); ?&gt;&quot; /&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;wcpgsk_settings[woofields][placeholder_&lt;?php echo $field['fieldkey']; ?&gt;]&quot; class=&quot;wcpgsk_textfield&quot; &nbsp;</div></li><li><div>                                          value=&quot;&lt;?php echo esc_attr( $field['placeholder'] ); ?&gt;&quot; /&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&nbsp;</div></li><li><div>                                          &lt;select name=&quot;wcpgsk_settings[woofields][class_&lt;?php echo $field['fieldkey']; ?&gt;]&quot;&gt;&nbsp;</div></li><li><div>                                              &lt;option value=&quot;form-row-wide&quot; &nbsp;</div></li><li><div>                                              &lt;?php if (  'form-row-wide' == ($field['classsel']) ) echo 'selected=&quot;selected&quot;'; ?&gt;&gt;&lt;?php echo $placeWide; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                              &lt;option value=&quot;form-row-first&quot; &nbsp;</div></li><li><div>                                              &lt;?php if (  'form-row-first' == ($field['classsel']) ) echo 'selected=&quot;selected&quot;'; ?&gt;&gt;&lt;?php echo $placeFirst; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                              &lt;option value=&quot;form-row-last&quot; &nbsp;</div></li><li><div>                                              &lt;?php if (  'form-row-last' == ($field['classsel']) ) echo 'selected=&quot;selected&quot;'; ?&gt;&gt;&lt;?php echo $placeLast; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                          &lt;/select&gt;&nbsp;</div></li><li><div>                                      &lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td class=&quot;wcpgsk_functions_col&quot;&gt;&nbsp;</div></li><li><div>                                          &lt;?php&nbsp;</div></li><li><div>                                              if ($options['woofields'][$section][$key]['custom_' . $key] == $key && $key != 'order_comments') :&nbsp;</div></li><li><div>                                          ?&gt;&nbsp;</div></li><li><div>                                              &lt;button class=&quot;wcpgsk_configure_field&quot; table=&quot;wcpgsk_&lt;?php echo $section ;?&gt;_table&quot; for=&quot;&lt;?php echo $key ; ?&gt;&quot; type=&quot;&lt;?php echo $field['type'] ; ?&gt;&quot; name=&quot;wcpgsk_settings[woofields][button_&lt;?php echo $key ; ?&gt;]&quot;&gt;&lt;?php echo $field['type'] ; ?&gt;&lt;/button&gt;&nbsp;</div></li><li><div>                                              &lt;input name=&quot;wcpgsk_settings[woofields][type_&lt;?php echo $key; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;&lt;?php echo $field['type'] ; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                                              &lt;input name=&quot;wcpgsk_settings[woofields][settings_&lt;?php echo $key; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;&lt;?php echo $field['settings'] ; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                                          &lt;?php&nbsp;</div></li><li><div>                                              else :&nbsp;</div></li><li><div>                                                  echo $field['type']; &nbsp;</div></li><li><div>                                              endif;&nbsp;</div></li><li><div>                                          ?&gt;&nbsp;</div></li><li><div>                                      &lt;/td&gt;&nbsp;</div></li><li><div>                                  &lt;/tr&gt;&nbsp;</div></li><li><div>                              &lt;?php &nbsp;</div></li><li><div>                                  $field_order++;&nbsp;</div></li><li><div>                              endforeach; &nbsp;</div></li><li><div>                              $custom = 'nn2id';&nbsp;</div></li><li><div>                              $newField = __('New Field', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                              ?&gt;&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                              &lt;tr valign=&quot;top&quot; class=&quot;wcpgsk_add_field_row&quot; id=&quot;wcpgsk_add_&lt;?php echo $section ;?&gt;_field_row&quot;&gt;&nbsp;</div></li><li><div>                                      &lt;td class=&quot;wcpgsk_order_col&quot;&gt;&lt;span class=&quot;ui-icon ui-icon-arrow-4&quot;&gt;&lt;/span&gt;&lt;span class=&quot;wcpgsk_order_span&quot;&gt;&lt;?php echo $custom; ?&gt;&lt;/span&gt;&lt;input type=&quot;hidden&quot;  class=&quot;wcpgsk_order_input&quot; convert=&quot;wcpgsk_settings[woofields][order_&lt;?php echo $custom ; ?&gt;]&quot; value=&quot;&lt;?php echo $custom; ?&gt;&quot; /&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td class=&quot;wcpgsk_fieldname_col&quot;&gt;&nbsp;</div></li><li><div>                                          &lt;input convert=&quot;wcpgsk_settings[woofields][&lt;?php echo $section ;?&gt;][&lt;?php echo $custom; ?&gt;][custom_&lt;?php echo $custom; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;&lt;?php echo $custom; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                                          &nbsp;</div></li><li><div>                                          &lt;button class=&quot;wcpgsk_remove_field&quot; for=&quot;wcpgsk_&lt;?php echo $section ;?&gt;_table&quot; convert=&quot;wcpgsk_settings[woofields][fieldname_&lt;?php echo $custom; ?&gt;]&quot;&gt;&lt;?php _e('X', WCPGSK_DOMAIN) ; ?&gt;&lt;/button&gt; &lt;span convert=&quot;wcpgsk_settings[woofields][ident_&lt;?php echo $custom; ?&gt;]&quot;&gt;&lt;?php echo $custom; ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                                      &lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&lt;input convert=&quot;wcpgsk_settings[woofields][remove_&lt;?php echo $custom; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                                          &lt;input convert=&quot;wcpgsk_settings[woofields][remove_&lt;?php echo $custom; ?&gt;]&quot; type=&quot;checkbox&quot; class=&quot;removes_&lt;?php echo $section ;?&gt;&quot; value=&quot;1&quot; /&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&lt;input convert=&quot;wcpgsk_settings[woofields][required_&lt;?php echo $custom; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                                          &lt;input convert=&quot;wcpgsk_settings[woofields][required_&lt;?php echo $custom; ?&gt;]&quot; type=&quot;checkbox&quot; class=&quot;required_&lt;?php echo $section ;?&gt;&quot; value=&quot;1&quot; /&gt;&nbsp;</div></li><li><div>                                      &lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&lt;input convert=&quot;wcpgsk_settings[woofields][hideorder_&lt;?php echo $custom; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                                          &lt;input convert=&quot;wcpgsk_settings[woofields][hideorder_&lt;?php echo $custom; ?&gt;]&quot; type=&quot;checkbox&quot; class=&quot;hideorder_&lt;?php echo $section ;?&gt;&quot; value=&quot;1&quot; /&gt;&nbsp;</div></li><li><div>                                      &lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&lt;input convert=&quot;wcpgsk_settings[woofields][customeronly_&lt;?php echo $custom; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;0&quot; /&gt;&nbsp;</div></li><li><div>                                          &lt;input convert=&quot;wcpgsk_settings[woofields][customeronly_&lt;?php echo $custom; ?&gt;]&quot; type=&quot;checkbox&quot; class=&quot;customeronly_&lt;?php echo $section ;?&gt;&quot; value=&quot;1&quot; /&gt;&nbsp;</div></li><li><div>                                      &lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&lt;input type=&quot;text&quot; convert=&quot;wcpgsk_settings[woofields][label_&lt;?php echo $custom; ?&gt;]&quot; class=&quot;wcpgsk_textfield&quot; value=&quot;&lt;?php echo $newField; ?&gt;&quot; /&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&lt;input type=&quot;text&quot; convert=&quot;wcpgsk_settings[woofields][placeholder_&lt;?php echo $custom; ?&gt;]&quot; class=&quot;wcpgsk_textfield&quot; value=&quot;&lt;?php echo $newField; ?&gt;&quot; /&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td&gt;&nbsp;</div></li><li><div>                                          &lt;select convert=&quot;wcpgsk_settings[woofields][class_&lt;?php echo $custom; ?&gt;]&quot;&gt;&nbsp;</div></li><li><div>                                              &lt;option value=&quot;form-row-wide&quot;&gt;&lt;?php echo $placeWide ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                              &lt;option value=&quot;form-row-first&quot;&gt;&lt;?php echo $placeFirst ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                              &lt;option value=&quot;form-row-last&quot; &gt;&lt;?php echo $placeLast ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                          &lt;/select&gt;&nbsp;</div></li><li><div>                                      &lt;/td&gt;&nbsp;</div></li><li><div>                                      &lt;td class=&quot;wcpgsk_functions_col&quot;&gt;&nbsp;</div></li><li><div>                                          &lt;button convert=&quot;wcpgsk_settings[woofields][button_&lt;?php echo $custom; ?&gt;]&quot;&gt;&lt;/button&gt;&nbsp;</div></li><li><div>                                          &lt;input convert=&quot;wcpgsk_settings[woofields][type_&lt;?php echo $custom; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>                                          &lt;input convert=&quot;wcpgsk_settings[woofields][settings_&lt;?php echo $custom; ?&gt;]&quot; type=&quot;hidden&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>                                      &lt;/td&gt;&nbsp;</div></li><li><div>                                 &lt;/tr&gt;&nbsp;</div></li><li><div>                          &lt;/tbody&gt;&nbsp;</div></li><li><div>                          &lt;/table&gt;&nbsp;</div></li><li><div>                          Select type: &lt;select id=&quot;wcpgsk_&lt;?php echo $section ;?&gt;_table_type&quot;&gt;&nbsp;</div></li><li><div>                              &lt;option value=&quot;text&quot;&gt;text&lt;/option&gt;&nbsp;</div></li><li><div>                              &lt;option value=&quot;textarea&quot;&gt;textarea&lt;/option&gt;&nbsp;</div></li><li><div>                              &lt;option value=&quot;date&quot;&gt;date&lt;/option&gt;&nbsp;</div></li><li><div>                              &lt;option value=&quot;time&quot; &gt;time&lt;/option&gt;&nbsp;</div></li><li><div>                              &lt;option value=&quot;number&quot; &gt;number&lt;/option&gt;&nbsp;</div></li><li><div>                              &lt;option value=&quot;select&quot; &gt;select&lt;/option&gt;&nbsp;</div></li><li><div>                              &lt;?php&nbsp;</div></li><li><div>                                  do_action( 'wcpgsk_settings_form_field_types', $options );                                &nbsp;</div></li><li><div>                              ?&gt;&nbsp;</div></li><li><div>                          &lt;/select&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          Identifier New Field: &lt;input type=&quot;text&quot; id=&quot;wcpgsk_&lt;?php echo $section ;?&gt;_table_fieldid&quot; value=&quot;&quot; maxlength=&quot;25&quot; size=&quot;12&quot; /&gt; &lt;a href=&quot;javascript:;&quot; class=&quot;add_custom_field button-primary&quot; id=&quot;add_custom_&lt;?php echo $section ;?&gt;_btn&quot; for=&quot;wcpgsk_&lt;?php echo $section ;?&gt;_table&quot; placeholder=&quot;&lt;?php echo $section ;?&gt;&quot;&gt;&lt;?php _e( 'New ' . $title . ' Field' , WCPGSK_DOMAIN ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                          &lt;?php submit_button( __( 'Save Changes', WCPGSK_DOMAIN ) ); ?&gt;&nbsp;</div></li><li><div>                      &lt;/div&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &lt;?php&nbsp;</div></li><li><div>                  endforeach;&nbsp;</div></li><li><div>                  do_action( 'wcpgsk_settings_page_eight', $options );&nbsp;</div></li><li><div>                  do_action( 'wcpgsk_settings_page_about', $options );&nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;/div&gt;&nbsp;</div></li><li><div>              &lt;p class=&quot;submit&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; id=&quot;submit&quot; class=&quot;button-primary&quot; value=&quot;&lt;?php _e('Save Changes'); ?&gt;&quot; /&gt;&lt;/p&gt;&nbsp;</div></li><li><div>          &lt;/form&gt;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          &lt;div id=&quot;wcpgsk_error_dialog&quot; title=&quot;WC Poor Guys Swiss Knife Error&quot;&gt;&nbsp;</div></li><li><div>              &lt;p id=&quot;wcpgsk_error_message&quot;&gt;&lt;/p&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>              do_action( 'wcpgsk_settings_page_dialogs_one', $options );&nbsp;</div></li><li><div>              $validateTip = __('Required form fields are marked with *.', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>          &lt;div id=&quot;wcpgsk_dialog_form_container&quot; title=&quot;&lt;?php _e('Configure your custom field', WCPGSK_DOMAIN) ; ?&gt;&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;div id=&quot;wcpgsk_dialog_form_select&quot; title=&quot;Configure Select Field&quot; class=&quot;wcpgsk_dialog_forms&quot;&gt;&nbsp;</div></li><li><div>          &lt;p class=&quot;validateTips&quot;&gt;&lt;?php echo $validateTip ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>          &lt;form for=&quot;wcpgsk_dlg_form_select&quot; accept-charset=&quot;utf-8&quot;&gt;&nbsp;</div></li><li><div>          &lt;table class=&quot;wcpgsfieldkconfig&quot;&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option field_option_choices&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Options', WCPGSK_DOMAIN) ; ?&gt;*&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Enter each option on a new line.', WCPGSK_DOMAIN) ; ?&gt;&nbsp;</div></li><li><div>                  &lt;br /&gt;&lt;?php _e('You can specify value and label for each option like this:', WCPGSK_DOMAIN) ; ?&gt;&nbsp;</div></li><li><div>                  &lt;/p&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;strong&gt;jazz : Charles Mingus&lt;br&gt;blues : John Lee Hooker&lt;/strong&gt;&lt;/p&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;textarea rows=&quot;6&quot; for=&quot;wcpgsk_add_options&quot; class=&quot;textarea field_option-choices&quot; autocomplete=&quot;off&quot; defaultValue=&quot;&quot; placeholder=&quot;&quot;&gt;&lt;/textarea&gt;    &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option field_option_select&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Default Value', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Specify default values, one per line.', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;textarea rows=&quot;3&quot; for=&quot;wcpgsk_add_selected&quot; class=&quot;textarea&quot; defaultValue=&quot;&quot; placeholder=&quot;&quot;&gt;&lt;/textarea&gt;    &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option field_option_select&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Allow Null?', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;ul class=&quot;wcpgsk-radio-list radio horizontal&quot;&gt;&lt;li&gt;&lt;label&gt;&lt;input id=&quot;wcpgsk_add_allow_null_1&quot; for=&quot;wcpgsk_add_allow_null&quot; value=&quot;1&quot; type=&quot;radio&quot;&gt;&lt;?php _e('Yes', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&lt;/li&gt;&lt;li&gt;&lt;label&gt;&lt;input id=&quot;wcpgsk_add_allow_null_0&quot; for=&quot;wcpgsk_add_allow_null&quot; value=&quot;0&quot; checked=&quot;&quot;checked&quot;&quot; data-checked=&quot;&quot;checked&quot;&quot; type=&quot;radio&quot;&gt;&lt;?php _e('No', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&lt;/li&gt;&lt;/ul&gt;    &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option field_option_select&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Select multiple values?', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;ul class=&quot;wcpgsk-radio-list radio horizontal&quot;&gt;&lt;li&gt;&lt;label&gt;&lt;input id=&quot;wcpgsk_add_multiple_1&quot; for=&quot;wcpgsk_add_multiple&quot; value=&quot;1&quot; type=&quot;radio&quot;&gt;&lt;?php _e('Yes', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&lt;/li&gt;&lt;li&gt;&lt;label&gt;&lt;input id=&quot;wcpgsk_add_multiple_0&quot; for=&quot;wcpgsk_add_multiple&quot; value=&quot;0&quot; checked=&quot;&quot;checked&quot;&quot; data-checked=&quot;&quot;checked&quot;&quot; type=&quot;radio&quot;&gt;&lt;?php _e('No', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&lt;/li&gt;&lt;/ul&gt;    &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Presentation', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;select for=&quot;wcpgsk_add_presentation&quot;&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;select&quot;&gt;&lt;?php _e('As select list', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;radio&quot;&gt;&lt;?php _e('As radio buttons', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;checkbox&quot;&gt;&lt;?php _e('As checkboxes', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;/select&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/table&gt;&nbsp;</div></li><li><div>          &lt;/form&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;div id=&quot;wcpgsk_dialog_form_text&quot; title=&quot;Configure Text Field&quot; class=&quot;wcpgsk_dialog_forms&quot;&gt;&nbsp;</div></li><li><div>          &lt;form for=&quot;wcpgsk_dlg_form_text&quot;&gt;&nbsp;</div></li><li><div>          &lt;table class=&quot;wcpgsfieldkconfig&quot;&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Maximum characters', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Maxlength attribute for input tag. Value has to be a number.', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_maxlength&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Size', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Size attribute for input tag. Value has to be a number.', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_size&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Pattern attribute', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Value has to be a regular expression. A regular expression can be used to establish or substitute validation. Example: .{3, 5} will require at least 3 characters and allow for a maximum of five. Examples for html5 pattern attributes can be found &lt;a href=&quot;http:<span class="comment">//html5pattern.com/&quot; target=&quot;_blank&quot;&gt;here&lt;/a&gt;. In some circumstances, the symbols ^ in front and $ at the end provide some magical improvements for your regular expressions. Please test on all browsers!', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;                    </span>&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_pattern&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Validation', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;select for=&quot;wcpgsk_add_validate&quot;&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;none&quot;&gt;&lt;?php _e('No validation', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;email&quot;&gt;&lt;?php _e('Email validation', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;                &nbsp;</div></li><li><div>                      &lt;option value=&quot;date&quot;&gt;&lt;?php _e('Date', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;time&quot;&gt;&lt;?php _e('Time', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;password&quot;&gt;&lt;?php _e('Password', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;number&quot;&gt;&lt;?php _e('Number', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;integer&quot;&gt;&lt;?php _e('Integer', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;float&quot;&gt;&lt;?php _e('Float', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;custom1&quot;&gt;&lt;?php _e('Custom1', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;custom2&quot;&gt;&lt;?php _e('Custom2', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;custom3&quot;&gt;&lt;?php _e('Custom3', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;/select&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option field_option_select&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Add repeat input for validation, e.g. email or password fields?', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;ul class=&quot;wcpgsk-radio-list radio horizontal&quot;&gt;&lt;li&gt;&lt;label&gt;&lt;input id=&quot;wcpgsk_add_repeat_field_0&quot; for=&quot;wcpgsk_add_repeat_field&quot; value=&quot;0&quot; type=&quot;radio&quot; checked=&quot;&quot;checked&quot;&quot; data-checked=&quot;&quot;checked&quot;&quot; &gt;&lt;?php _e('No', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&lt;/li&gt;&lt;li&gt;&lt;label&gt;&lt;input id=&quot;wcpgsk_add_repeat_field_1&quot; for=&quot;wcpgsk_add_repeat_field&quot; value=&quot;1&quot; type=&quot;radio&quot;&gt;&lt;?php _e('Yes', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&lt;/li&gt;&lt;/ul&gt;    &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Minimum characters', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Minlength attribute of the input tag. Value has to be a number. (In the Html5 specification but not supported by most browsers)', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_minlength&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/table&gt;&nbsp;</div></li><li><div>          &lt;/form&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;div id=&quot;wcpgsk_dialog_form_textarea&quot; title=&quot;Configure Textarea Field&quot; class=&quot;wcpgsk_dialog_forms&quot;&gt;&nbsp;</div></li><li><div>          &lt;p class=&quot;validateTips&quot;&gt;&lt;?php echo $validateTip ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>          &lt;form for=&quot;wcpgsk_dlg_form_textarea&quot;&gt;&nbsp;</div></li><li><div>          &lt;table class=&quot;wcpgsfieldkconfig&quot;&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Textarea rows', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Value has to be a number', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_rows&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Textarea cols', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Value has to be a number', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_cols&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;/table&gt;&nbsp;</div></li><li><div>          &lt;/form&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;div id=&quot;wcpgsk_dialog_form_date&quot; title=&quot;Configure Date Field&quot; class=&quot;wcpgsk_dialog_forms&quot;&gt;&nbsp;</div></li><li><div>          &lt;p class=&quot;validateTips&quot;&gt;&lt;?php echo $validateTip ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>          &lt;form for=&quot;wcpgsk_dlg_form_date&quot;&gt;&nbsp;</div></li><li><div>          &lt;table class=&quot;wcpgsfieldkconfig&quot;&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Minimum offset in days', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Value has to be a number for dynamic calculation or a fix date in the format specified in Date format', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;                    &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_mindays&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Maximum offset in days', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Value has to be a number for dynamic calculation or a fix date in the format specified in Date format', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_maxdays&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Date format', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Please select a date format.', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;select for=&quot;wcpgsk_add_dateformat&quot;&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;yy/mm/dd&quot;&gt;yyyy/mm/dd&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;mm/dd/yy&quot;&gt;mm/dd/yyyy&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;dd/mm/yy&quot;&gt;dd/mm/yyyy&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;/select&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Exclude weekends', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('If you want to exclude weekends, please check.', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;ul class=&quot;wcpgsk-radio-list radio horizontal&quot;&gt;&nbsp;</div></li><li><div>                  &lt;li&gt;&lt;label&gt;&lt;input id=&quot;wcpgsk_add_exweekend_0&quot; for=&quot;wcpgsk_add_exweekend&quot; value=&quot;0&quot; type=&quot;radio&quot; checked=&quot;checked&quot; data-checked=&quot;checked&quot; &gt;&lt;?php _e('No', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&lt;/li&gt;&nbsp;</div></li><li><div>                  &lt;li&gt;&lt;label&gt;&lt;input id=&quot;wcpgsk_add_exweekend_1&quot; for=&quot;wcpgsk_add_exweekend&quot; value=&quot;1&quot; type=&quot;radio&quot;&gt;&lt;?php _e('Yes', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&lt;/li&gt;&nbsp;</div></li><li><div>                  &lt;/ul&gt;    &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Exclude week days', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Please specify weekdays to exclude using integers separated by coma.', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_daysexcluded&quot; style=&quot;width:100%&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Exclude dates', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Please specify dates like holidays you want to exclude from selection separated by coma.', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_datesexcluded&quot; style=&quot;width:100%&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;/table&gt;&nbsp;</div></li><li><div>          &lt;/form&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;div id=&quot;wcpgsk_dialog_form_time&quot; title=&quot;Configure Time Field&quot; class=&quot;wcpgsk_dialog_forms&quot;&gt;&nbsp;</div></li><li><div>          &lt;p class=&quot;validateTips&quot;&gt;&lt;?php echo $validateTip ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>          &lt;form for=&quot;wcpgsk_dlg_form_time&quot;&gt;&nbsp;</div></li><li><div>          &lt;table class=&quot;wcpgsfieldkconfig&quot;&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Minimum hour', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Value has to be a number', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_minhour&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Maximum hour', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Value has to be a number', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_maxhour&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Hour steps', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Value has to be a number', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_hoursteps&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Minute steps', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Value has to be a number', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_minutesteps&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;/table&gt;&nbsp;</div></li><li><div>          &lt;/form&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;div id=&quot;wcpgsk_dialog_form_number&quot; title=&quot;Configure Number Field&quot; class=&quot;wcpgsk_dialog_forms&quot;&gt;&nbsp;</div></li><li><div>          &lt;p class=&quot;validateTips&quot;&gt;&lt;?php echo $validateTip ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>          &lt;form for=&quot;wcpgsk_dlg_form_number&quot;&gt;&nbsp;</div></li><li><div>          &lt;table class=&quot;wcpgsfieldkconfig&quot;&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Default value', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Value has to be a number', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_value&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Default upper range value', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Value has to be a number', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_rangemax&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Minimum value', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Value has to be a number', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_minvalue&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Maximum value', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Value has to be a number', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_maxvalue&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Number step', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;?php _e('Value has to be a number', WCPGSK_DOMAIN) ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;text&quot; for=&quot;wcpgsk_add_numstep&quot; value=&quot;&quot; /&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;tr class=&quot;field_option&quot;&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;label&quot;&gt;&nbsp;</div></li><li><div>                  &lt;label&gt;&lt;?php _e('Presentation', WCPGSK_DOMAIN) ; ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&nbsp;</div></li><li><div>                  &lt;select for=&quot;wcpgsk_add_numpres&quot;&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;false&quot;&gt;&lt;?php _e('Default', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;true&quot;&gt;&lt;?php _e('Range with minimum and maximum', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;min&quot;&gt;&lt;?php _e('Range with minimum', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                      &lt;option value=&quot;max&quot;&gt;&lt;?php _e('Range with maximum', WCPGSK_DOMAIN) ; ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                  &lt;/select&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;/table&gt;&nbsp;</div></li><li><div>          &lt;/form&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>          do_action( 'wcpgsk_settings_form_field_dialogs', $options );                                &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          echo '&lt;/div&gt;';&nbsp;</div></li><li><div>          echo '&lt;!--unit test options page end--&gt;';&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Helper function to order array.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $a</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $b</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return $input (validated)</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      public function compareFieldOrder($a, $b) {&nbsp;</div></li><li><div>          if ($a['order'] == $b['order']) {&nbsp;</div></li><li><div>              return 0;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return ($a['order'] &lt; $b['order']) ? -1 : 1;&nbsp;</div></li><li><div>      }        &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Our Validation for submitted Settings Page.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return $input (validated)</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      public function wcpgsk_options_validate( $input ) {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          <span class="comment">//$wcpgsk_options = get_option( 'wcpgsk_settings' );</span>&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          if ( empty($input['cart']['minitemscart']) ) $input['cart']['minitemscart'] = 0;&nbsp;</div></li><li><div>          if ( !ctype_digit($input['cart']['minitemscart']) ) $input['cart']['minitemscart'] = 0;&nbsp;</div></li><li><div>          if ( empty($input['cart']['maxitemscart'] ) ) $input['cart']['maxitemscart'] = 0;&nbsp;</div></li><li><div>          if ( !ctype_digit($input['cart']['maxitemscart']) ) $input['cart']['maxitemscart'] = 0;&nbsp;</div></li><li><div>          $mincart = $input['cart']['minitemscart'];&nbsp;</div></li><li><div>          $maxcart = $input['cart']['maxitemscart'];&nbsp;</div></li><li><div>          if ($mincart &gt; $maxcart && $maxcart &gt; 0) $input['cart']['minitemscart'] = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty($input['cart']['minqtycart']) ) $input['cart']['minqtycart'] = 0;&nbsp;</div></li><li><div>          if ( !ctype_digit($input['cart']['minqtycart']) ) $input['cart']['minqtycart'] = 0;&nbsp;</div></li><li><div>          if ( empty($input['cart']['maxqtycart'] ) ) $input['cart']['maxqtycart'] = 0;&nbsp;</div></li><li><div>          if ( !ctype_digit($input['cart']['maxqtycart']) ) $input['cart']['maxqtycart'] = 0;&nbsp;</div></li><li><div>          $minqtycart = $input['cart']['minqtycart'];&nbsp;</div></li><li><div>          $maxqtycart = $input['cart']['maxqtycart'];&nbsp;</div></li><li><div>          if ($minqtycart &gt; $maxqtycart && $maxqtycart &gt; 0) $input['cart']['minqtycart'] = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          <span class="comment">//@todo:could be a string, but not vital</span>&nbsp;</div></li><li><div>          if (empty($input['checkoutform']['mindate']) || !ctype_digit($input['checkoutform']['mindate'])) $input['checkoutform']['mindate'] = 0;&nbsp;</div></li><li><div>          if (empty($input['checkoutform']['maxdate']) || !ctype_digit($input['checkoutform']['maxdate'])) $input['checkoutform']['maxdate'] = 365;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          $checkout_fields = $woocommerce-&gt;countries-&gt;get_address_fields( $woocommerce-&gt;countries-&gt;get_base_country(), 'billing_' );&nbsp;</div></li><li><div>          $field_order = 1;    &nbsp;</div></li><li><div>          foreach ($checkout_fields as $key =&gt; $field) : &nbsp;</div></li><li><div>              if (empty($input['woofields']['order_' . $key]) || !ctype_digit($input['woofields']['order_' . $key])) $input['woofields']['order_' . $key] = $field_order;&nbsp;</div></li><li><div>              $field_order++;&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $checkout_fields = $woocommerce-&gt;countries-&gt;get_address_fields( $woocommerce-&gt;countries-&gt;get_base_country(), 'shipping_' );&nbsp;</div></li><li><div>          $field_order = 1;    &nbsp;</div></li><li><div>          foreach ($checkout_fields as $key =&gt; $field) : &nbsp;</div></li><li><div>              if (empty($input['woofields']['order_' . $key]) || !ctype_digit($input['woofields']['order_' . $key])) $input['woofields']['order_' . $key] = $field_order;&nbsp;</div></li><li><div>              $field_order++;&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( isset( $input['process']['fastcart'] ) && $input['process']['fastcart'] == 1 && $input['process']['fastcheckout'] == 1) $input['process']['fastcheckout'] = 0;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          <span class="comment">//$product_types = array('variation', 'variable', 'grouped', 'external', 'simple');</span>&nbsp;</div></li><li><div>          $product_types = array('variation', 'variable', 'external', 'simple');&nbsp;</div></li><li><div>          foreach($product_types as $type) :&nbsp;</div></li><li><div>              if ( empty($input['cart']['maxqty_' . $type]) ) $input['cart']['maxqty_' . $type] = 0;&nbsp;</div></li><li><div>              if ( !ctype_digit($input['cart']['maxqty_' . $type]) ) $input['cart']['maxqty_' . $type] = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( empty($input['cart']['stepqty_' . $type]) ) $input['cart']['stepqty_' . $type] = 0;&nbsp;</div></li><li><div>              if ( !ctype_digit($input['cart']['stepqty_' . $type]) ) $input['cart']['stepqty_' . $type] = 0;&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if ( empty($input['cart']['minqty_' . $type]) ) $input['cart']['minqty_' . $type] = 0;&nbsp;</div></li><li><div>              if ( !ctype_digit($input['cart']['minqty_' . $type]) ) $input['cart']['minqty_' . $type] = 0;&nbsp;</div></li><li><div>              <span class="comment">//very basic consistency check for quantity settings</span>&nbsp;</div></li><li><div>              if ( $input['cart']['minqty_' . $type] &gt; $input['cart']['maxqty_' . $type] && $input['cart']['maxqty_' . $type] &gt; 0 ) $input['cart']['minqty_' . $type] = 1;&nbsp;</div></li><li><div>              if ($input['cart']['maxqty_' . $type] == 1) $input['cart'][$type . 'productnoqty'] = 1;&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          $input = apply_filters('wcpgsk_validate_settings', $input);&nbsp;</div></li><li><div>          return $input;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Our filter for customer editing billing and shipping address.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $address</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.1</span>&nbsp;</div></li><li><div><span class="comment">       * @return array $address (processed)</span>&nbsp;</div></li><li><div><span class="comment">       * @TODO elaborate on this and billing and shipping custom fields, WooCommerce needs the country field present but nothing else... We have ways to improve this.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>                        &nbsp;</div></li><li><div>      public function wcpgsk_address_to_edit($address) {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $field_order = 1;    &nbsp;</div></li><li><div>          $locale = get_option( 'wcpgsk_locale', array() );&nbsp;</div></li><li><div>          $wc_locale = $this-&gt;wcpgsk_get_country_locale();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ($address as $key =&gt; $field) :&nbsp;</div></li><li><div>              $address[$key]['order'] = ((!empty($options['woofields']['order_' . $key]) && ctype_digit($options['woofields']['order_' . $key])) ? $options['woofields']['order_' . $key] : $field_order);            &nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if ( isset($options['woofields']['remove_' . $key]) && $options['woofields']['remove_' . $key] == 1) :&nbsp;</div></li><li><div>                  $address[$key]['custom_attributes'] = array('style' =&gt; 'display:none');&nbsp;</div></li><li><div>                  $address[$key]['label'] = '';&nbsp;</div></li><li><div>                  $address[$key]['required'] = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment">//else</span></span>if ( $key == 'billing_email_validator' ) :</span>&nbsp;</div></li><li><div>                  <span class="comment">//$address[$key]['custom_attributes'] = array('style' =&gt; 'display:none');</span>&nbsp;</div></li><li><div>                  <span class="comment">//$address[$key]['label'] = '';</span>&nbsp;</div></li><li><div>                  <span class="comment">//$address[$key]['required'] = false;</span>&nbsp;</div></li><li><div>              else :&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  $is_billing = strpos($key, 'billing_');&nbsp;</div></li><li><div>                  $cc = false;&nbsp;</div></li><li><div>                  $wc_field_handle = false;&nbsp;</div></li><li><div>                  if ( $is_billing !== false ) :&nbsp;</div></li><li><div>                      $wc_field_handle = str_replace('billing_', '', $key);&nbsp;</div></li><li><div>                      if ( isset($address['billing_country']['value']) ) :&nbsp;</div></li><li><div>                          $cc = $address['billing_country']['value'];&nbsp;</div></li><li><div>                      else :&nbsp;</div></li><li><div>                          $cc = $this-&gt;wcpgsk_load_address_value($key);&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                  else : &nbsp;</div></li><li><div>                      $wc_field_handle = str_replace('shipping_', '', $key);                    &nbsp;</div></li><li><div>                      if ( isset($address['shipping_country']['value']) ) :&nbsp;</div></li><li><div>                          $cc = $address['shipping_country']['value'];&nbsp;</div></li><li><div>                      else :&nbsp;</div></li><li><div>                          $cc = $this-&gt;wcpgsk_load_address_value($key);&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>                  if ( $cc && $wc_field_handle && isset($options['checkoutform']['default_' . $wc_field_handle]) && $options['checkoutform']['default_' . $wc_field_handle] ) :&nbsp;</div></li><li><div>                      $address[$key] = $this-&gt;wcpgsk_config_locale_field($address[$key], $wc_field_handle, $cc, $wc_locale, $locale);&nbsp;</div></li><li><div>                  else :&nbsp;</div></li><li><div>                      if ( isset($options['woofields']['label_' . $key]) ) :    &nbsp;</div></li><li><div>                          $address[$key]['label'] = __( $options['woofields']['label_' . $key], WCPGSK_DOMAIN );&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      if ( isset($options['woofields']['placeholder_' . $key]) ) :    &nbsp;</div></li><li><div>                          $address[$key]['placeholder'] = __( $options['woofields']['placeholder_' . $key], WCPGSK_DOMAIN );&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      if ( isset($options['woofields']['required_' . $key]) ) :&nbsp;</div></li><li><div>                          $address[$key]['required'] = ((isset($options['woofields']['required_' . $key])) ? $options['woofields']['required_' . $key] : ( isset($address[$key]['required']) ? $address[$key]['required'] : false ) );&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      <span class="comment">//if (!empty($options['woofields']['class_' . $key])) {</span>&nbsp;</div></li><li><div>                      if (!empty($address[$key]['class']) && is_array($address[$key]['class'])) :&nbsp;</div></li><li><div>                          $address[$key]['class'][0] = 'form-row-wide';&nbsp;</div></li><li><div>                      else :&nbsp;</div></li><li><div>                          $address[$key]['class'] = array ('form-row-wide');&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              $field_order++;                &nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          uasort($address, array($this, &quot;compareFieldOrder&quot;));                        &nbsp;</div></li><li><div>          return $address;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      public function wcpgsk_load_address_value($key) {&nbsp;</div></li><li><div>          global $woocommerce, $current_user;&nbsp;</div></li><li><div>          get_currentuserinfo();&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          $value = get_user_meta( get_current_user_id(), $key, true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! $value ) {&nbsp;</div></li><li><div>              switch( $key ) {&nbsp;</div></li><li><div>                  case 'billing_email' :&nbsp;</div></li><li><div>                  case 'shipping_email' :&nbsp;</div></li><li><div>                      $value = $current_user-&gt;user_email;&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  case 'billing_country' :&nbsp;</div></li><li><div>                  case 'shipping_country' :&nbsp;</div></li><li><div>                      $value = $woocommerce-&gt;countries-&gt;get_base_country();&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  case 'billing_state' :&nbsp;</div></li><li><div>                  case 'shipping_state' :&nbsp;</div></li><li><div>                      $value = $woocommerce-&gt;countries-&gt;get_base_state();&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $value;        &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      public function wcpgsk_config_locale_field($address_field, $wc_field_handle, $countrycode, $wc_locale, $locale) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $default_required = isset($locale['default']['required_' . $wc_field_handle]) ? $locale['default']['required_' . $wc_field_handle] : '0';&nbsp;</div></li><li><div>          $wc_localerequired = isset($wc_locale[$countrycode]) && isset($wc_locale[$countrycode][$wc_field_handle]) && isset($wc_locale[$countrycode][$wc_field_handle]['required']) ? ( $wc_locale[$countrycode][$wc_field_handle]['required'] ? '1' : '0' ) : ( isset($wc_locale['default'][$wc_field_handle]['required']) && $wc_locale['default'][$wc_field_handle]['required'] ? '1' : $default_required );&nbsp;</div></li><li><div>          $locale[$countrycode]['required_' . $wc_field_handle] = isset($locale[$countrycode]['required_' . $wc_field_handle]) ? $locale[$countrycode]['required_' . $wc_field_handle] : $wc_localerequired;&nbsp;</div></li><li><div>          $address_field['required'] = $locale[$countrycode]['required_' . $wc_field_handle] ? true : false;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          $default_label = isset($locale['default']['label_' . $wc_field_handle]) ? $locale['default']['label_' . $wc_field_handle] : '';&nbsp;</div></li><li><div>          $wc_localelabel = isset($wc_locale[$countrycode]) && isset($wc_locale[$countrycode][$wc_field_handle]) && isset($wc_locale[$countrycode][$wc_field_handle]['label']) ? $wc_locale[$countrycode][$wc_field_handle]['label'] : ( isset($wc_locale['default'][$wc_field_handle]['label']) ? $wc_locale['default'][$wc_field_handle]['label'] : $default_label );                        &nbsp;</div></li><li><div>          $locale[$countrycode]['label_' . $wc_field_handle] = isset($locale[$countrycode]['label_' . $wc_field_handle]) ? $locale[$countrycode]['label_' . $wc_field_handle] : $wc_localelabel;&nbsp;</div></li><li><div>          $address_field['label'] = __($locale[$countrycode]['label_' . $wc_field_handle], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          $default_placeholder = isset($locale['default']['placeholder_' . $wc_field_handle]) ? $locale['default']['placeholder_' . $wc_field_handle] : '';&nbsp;</div></li><li><div>          $wc_localeplaceholder = isset($wc_locale[$countrycode]) && isset($wc_locale[$countrycode][$wc_field_handle]) && isset($wc_locale[$countrycode][$wc_field_handle]['placeholder']) ? $wc_locale[$countrycode][$wc_field_handle]['placeholder'] : ( isset($wc_locale['default'][$wc_field_handle]['placeholder']) ? $wc_locale['default'][$wc_field_handle]['placeholder'] : $default_placeholder );&nbsp;</div></li><li><div>          $locale[$countrycode]['placeholder_' . $wc_field_handle] = isset($locale[$countrycode]['placeholder_' . $wc_field_handle]) ? $locale[$countrycode]['placeholder_' . $wc_field_handle] : $wc_localeplaceholder;&nbsp;</div></li><li><div>          $address_field['placeholder'] = __($locale[$countrycode]['placeholder_' . $wc_field_handle], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $default_hidden = isset($locale['default']['hidden_' . $wc_field_handle]) ? $locale['default']['hidden_' . $wc_field_handle] : '0';&nbsp;</div></li><li><div>          $wc_localehidden = isset($wc_locale[$countrycode]) && isset($wc_locale[$countrycode][$wc_field_handle]) && isset($wc_locale[$countrycode][$wc_field_handle]['hidden']) ? ( $wc_locale[$countrycode][$wc_field_handle]['hidden'] ? '1' : '0' ) : ( isset($wc_locale['default'][$wc_field_handle]['hidden']) && $wc_locale['default'][$wc_field_handle]['hidden'] ? '1' : $default_hidden );&nbsp;</div></li><li><div>          $locale[$countrycode]['hidden_' . $wc_field_handle] = isset($locale[$countrycode]['hidden_' . $wc_field_handle]) ? $locale[$countrycode]['hidden_' . $wc_field_handle] : $wc_localehidden;&nbsp;</div></li><li><div>          $address_field['hidden'] = $locale[$countrycode]['hidden_' . $wc_field_handle] == '1' ? true : false;            &nbsp;</div></li><li><div>          return $address_field;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter fields for admin user page.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $show_fields</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.3</span>&nbsp;</div></li><li><div><span class="comment">       * @changed 1.6.2</span>&nbsp;</div></li><li><div><span class="comment">       * @return array $show_fields (processed)</span>&nbsp;</div></li><li><div><span class="comment">       */</span>                        &nbsp;</div></li><li><div>      public function wcpgsk_customer_meta_fields($show_fields) {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $field_order = 1;    &nbsp;</div></li><li><div>          $address = $show_fields['billing']['fields'];&nbsp;</div></li><li><div>          foreach ($address as $key =&gt; $field) :&nbsp;</div></li><li><div>              $address[$key]['order'] = ((!empty($options['woofields']['order_' . $key]) && ctype_digit($options['woofields']['order_' . $key])) ? $options['woofields']['order_' . $key] : $field_order);            &nbsp;</div></li><li><div>              if ( isset($options['woofields']['remove_' . $key]) && $options['woofields']['remove_' . $key] == 1) :&nbsp;</div></li><li><div>                  unset($address[$key]);&nbsp;</div></li><li><div>              else :&nbsp;</div></li><li><div>                  if ( isset($options['woofields']['label_' . $key]) && !empty($options['woofields']['label_' . $key]) ) :&nbsp;</div></li><li><div>                      $address[$key]['label'] = __($options['woofields']['label_' . $key], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                  elseif ( empty($options['woofields']['label_' . $key]) ) :&nbsp;</div></li><li><div>                      $address[$key]['label'] = '';&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>                  if ( isset($options['woofields']['placeholder_' . $key]) && !empty($options['woofields']['placeholder_' . $key]) ) :&nbsp;</div></li><li><div>                      $address[$key]['description'] = __($options['woofields']['placeholder_' . $key], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              $field_order++;                &nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          uasort($address, array($this, &quot;compareFieldOrder&quot;));                        &nbsp;</div></li><li><div>          $show_fields['billing']['fields'] = $address;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $field_order = 1;    &nbsp;</div></li><li><div>          $address = $show_fields['shipping']['fields'];&nbsp;</div></li><li><div>          foreach ($address as $key =&gt; $field) :&nbsp;</div></li><li><div>              $address[$key]['order'] = ((!empty($options['woofields']['order_' . $key]) && ctype_digit($options['woofields']['order_' . $key])) ? $options['woofields']['order_' . $key] : $field_order);            &nbsp;</div></li><li><div>              if ( isset($options['woofields']['remove_' . $key]) && $options['woofields']['remove_' . $key] == 1) :&nbsp;</div></li><li><div>                  unset($address[$key]);&nbsp;</div></li><li><div>              else :&nbsp;</div></li><li><div>                  if ( isset($options['woofields']['label_' . $key]) && !empty($options['woofields']['label_' . $key]) ) :&nbsp;</div></li><li><div>                      $address[$key]['label'] = __($options['woofields']['label_' . $key], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                  elseif ( empty($options['woofields']['label_' . $key]) ) : &nbsp;</div></li><li><div>                      $address[$key]['label'] = '';&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>                  if ( isset($options['woofields']['placeholder_' . $key]) && !empty($options['woofields']['placeholder_' . $key]) ) :&nbsp;</div></li><li><div>                      $address[$key]['description'] = __($options['woofields']['placeholder_' . $key], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                  endif;                &nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              $field_order++;                &nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          uasort($address, array($this, &quot;compareFieldOrder&quot;));                        &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $show_fields['shipping']['fields'] = $address;&nbsp;</div></li><li><div>          return $show_fields;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Handle zip/postcode if postcode field has been removed.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $postval</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.3</span>&nbsp;</div></li><li><div><span class="comment">       * @return string $postval (processed)</span>&nbsp;</div></li><li><div><span class="comment">       */</span>                        &nbsp;</div></li><li><div>      public function wcpgsk_process_myaccount_field_billing_postcode($postval) {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          if ( isset($options['woofields']['remove_billing_postcode']) && $options['woofields']['remove_billing_postcode'] == 1 && isset($_POST['billing_country']) && !empty($_POST['billing_country']) ) :&nbsp;</div></li><li><div>              $country = $_POST['billing_country'];&nbsp;</div></li><li><div>              switch ( $country ) :&nbsp;</div></li><li><div>                  case &quot;GB&quot; :&nbsp;</div></li><li><div>                      $postval = 'bfpo0000';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  case &quot;US&quot; :&nbsp;</div></li><li><div>                      $postval = '00000-0000';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  case &quot;CH&quot; :&nbsp;</div></li><li><div>                      $postval = '0000';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  default:&nbsp;</div></li><li><div>                      $postval = '0000';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              endswitch;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          return $postval;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Handle zip/postcode if postcode field has been removed.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $postval</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.3</span>&nbsp;</div></li><li><div><span class="comment">       * @return string $postval (processed)</span>&nbsp;</div></li><li><div><span class="comment">       */</span>                        &nbsp;</div></li><li><div>      public function wcpgsk_process_myaccount_field_shipping_postcode($postval) {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          if ( isset($options['woofields']['remove_shipping_postcode']) && $options['woofields']['remove_shipping_postcode'] == 1 && isset($_POST['shipping_country']) && !empty($_POST['shipping_country']) ) :&nbsp;</div></li><li><div>              $country = $_POST['shipping_country'];&nbsp;</div></li><li><div>              switch ( $country ) :&nbsp;</div></li><li><div>                  case &quot;GB&quot; :&nbsp;</div></li><li><div>                      $postval = 'bfpo0000';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  case &quot;US&quot; :&nbsp;</div></li><li><div>                      $postval = '00000-0000';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  case &quot;CH&quot; :&nbsp;</div></li><li><div>                      $postval = '0000';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  default:&nbsp;</div></li><li><div>                      $postval = '0000';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              endswitch;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          return $postval;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Assure that templates provide our WCPGSK Funtionality correctly.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $template_name</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $template_path</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $located</span>&nbsp;</div></li><li><div><span class="comment">       * @param mixed $args</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.2</span>&nbsp;</div></li><li><div><span class="comment">       * @return array $fields (processed)</span>&nbsp;</div></li><li><div><span class="comment">       */</span>                        &nbsp;</div></li><li><div>      function wcpgsk_after_template_part( $template_name, $template_path, $located, $args ) {&nbsp;</div></li><li><div>          if ( $template_name == 'myaccount/form-edit-address.php' ) :&nbsp;</div></li><li><div>              wcpgsk_after_checkout_form($template_name);&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Update our order shipping address.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.3</span>&nbsp;</div></li><li><div><span class="comment">       * @output Settings page</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      public function wcpgsk_order_formatted_shipping_address($address) {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $field_order = 1;&nbsp;</div></li><li><div>          $new_address = array();&nbsp;</div></li><li><div>          if ( !isset($address['first_name']) ) $address['first_name'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['last_name']) ) $address['last_name'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['company']) ) $address['company'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['address_1']) ) $address['address_1'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['address_2']) ) $address['address_2'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['city']) ) $address['city'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['state']) ) $address['state'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['postcode']) ) $address['postcode'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['country']) ) $address['country'] = '';&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          foreach ($address as $key =&gt; $field) :&nbsp;</div></li><li><div>              $keycheck = 'shipping_' . $key;&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if ( isset($options['woofields']['remove_' . $keycheck]) && $options['woofields']['remove_' . $keycheck] == 1) :&nbsp;</div></li><li><div>                  $new_address[$key]['order'] = ((!empty($options['woofields']['order_' . $keycheck]) && ctype_digit($options['woofields']['order_' . $keycheck])) ? $options['woofields']['order_' . $keycheck] : $field_order);            &nbsp;</div></li><li><div>                  $new_address[$key]['value'] = '';&nbsp;</div></li><li><div>              else :&nbsp;</div></li><li><div>                  $new_address[$key]['order'] = ((!empty($options['woofields']['order_' . $keycheck]) && ctype_digit($options['woofields']['order_' . $keycheck])) ? $options['woofields']['order_' . $keycheck] : $field_order);            &nbsp;</div></li><li><div>                  $new_address[$key]['value'] = $address[$key];&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              $field_order++;                &nbsp;</div></li><li><div>          endforeach;            &nbsp;</div></li><li><div>          uasort($new_address, array($this, &quot;compareFieldOrder&quot;));&nbsp;</div></li><li><div>          $address = array();&nbsp;</div></li><li><div>          foreach ($new_address as $key =&gt; $field) :&nbsp;</div></li><li><div>              $address[$key] = $new_address[$key]['value'];&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          return $address;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Update our order billing address.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.5.3</span>&nbsp;</div></li><li><div><span class="comment">       * @output Settings page</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      public function wcpgsk_order_formatted_billing_address($address) {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $field_order = 1;&nbsp;</div></li><li><div>          $new_address = array();&nbsp;</div></li><li><div>          if ( !isset($address['first_name']) ) $address['first_name'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['last_name']) ) $address['last_name'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['company']) ) $address['company'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['address_1']) ) $address['address_1'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['address_2']) ) $address['address_2'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['city']) ) $address['city'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['state']) ) $address['state'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['postcode']) ) $address['postcode'] = '';&nbsp;</div></li><li><div>          if ( !isset($address['country']) ) $address['country'] = '';&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          foreach ($address as $key =&gt; $field) :&nbsp;</div></li><li><div>              $keycheck = 'billing_' . $key;&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if ( isset($options['woofields']['remove_' . $keycheck]) && $options['woofields']['remove_' . $keycheck] == 1) :&nbsp;</div></li><li><div>                  $new_address[$key]['order'] = ((!empty($options['woofields']['order_' . $keycheck]) && ctype_digit($options['woofields']['order_' . $keycheck])) ? $options['woofields']['order_' . $keycheck] : $field_order);            &nbsp;</div></li><li><div>                  $new_address[$key]['value'] = '';&nbsp;</div></li><li><div>              else :&nbsp;</div></li><li><div>                  $new_address[$key]['order'] = ((!empty($options['woofields']['order_' . $keycheck]) && ctype_digit($options['woofields']['order_' . $keycheck])) ? $options['woofields']['order_' . $keycheck] : $field_order);            &nbsp;</div></li><li><div>                  $new_address[$key]['value'] = $address[$key];&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              $field_order++;                &nbsp;</div></li><li><div>          endforeach;            &nbsp;</div></li><li><div>          uasort($new_address, array($this, &quot;compareFieldOrder&quot;));&nbsp;</div></li><li><div>          $address = array();&nbsp;</div></li><li><div>          foreach ($new_address as $key =&gt; $field) :&nbsp;</div></li><li><div>              $address[$key] = $new_address[$key]['value'];&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          return $address;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Our filter to add billing fields.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $fields</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return array $fields (processed)</span>&nbsp;</div></li><li><div><span class="comment">       */</span>                        &nbsp;</div></li><li><div>      function add_billing_custom_fields( $fields ) {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $options['woofields']['label_billing_email_validator'] = !empty($options['woofields']['label_billing_email_validator']) ? $options['woofields']['label_billing_email_validator'] : '';&nbsp;</div></li><li><div>          $options['woofields']['placehoder_billing_email_validator'] = !empty($options['woofields']['placehoder_billing_email_validator']) ? $options['woofields']['placehoder_billing_email_validator'] : '';&nbsp;</div></li><li><div>          $options['woofields']['required_billing_email_validator'] = isset($options['woofields']['required_billing_email_validator']) ? $options['woofields']['required_billing_email_validator'] : 1;&nbsp;</div></li><li><div>          if ( !is_user_logged_in() ) :            &nbsp;</div></li><li><div>              if (isset($options['checkoutform']['billingemailvalidator']) && $options['checkoutform']['billingemailvalidator'] == 1) {&nbsp;</div></li><li><div>                  $fields['billing_email_validator'] = array(&nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div>                      'label' =&gt; __( $options['woofields']['label_billing_email_validator'], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                      'placeholder' =&gt; __( $options['woofields']['placehoder_billing_email_validator'], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                      'required' =&gt; (($options['woofields']['required_billing_email_validator'] == 1) ? true : false), &nbsp;</div></li><li><div>                      <span class="comment">//not necessary... 'validate' =&gt; 'email'</span>&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          if (isset($options['woofields']['billing']) && is_array($options['woofields']['billing'])) {&nbsp;</div></li><li><div>              foreach($options['woofields']['billing'] as $customkey =&gt; $customconfig) {&nbsp;</div></li><li><div>                  <span class="comment">//$fieldrepeater = null;</span>&nbsp;</div></li><li><div>                  $fields[$customkey] = $this-&gt;createCustomStandardField($customkey, 'billing', $options['woofields']['type_' . $customkey]);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $field_order = 1;&nbsp;</div></li><li><div>          foreach ($fields as $key =&gt; $field) :&nbsp;</div></li><li><div>              $fields[$key]['order'] = ((!empty($options['woofields']['order_' . $key]) && ctype_digit($options['woofields']['order_' . $key])) ? $options['woofields']['order_' . $key] : $field_order);            &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>              if ( isset($options['woofields']['remove_' . $key]) && $options['woofields']['remove_' . $key] == 1) :&nbsp;</div></li><li><div>                  $fields[$key]['required'] = false;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              if ( isset($options['woofields']['required_' . $key]) && $options['woofields']['required_' . $key] != 1) :&nbsp;</div></li><li><div>                  $fields[$key]['required'] = false;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              $field_order++;&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          uasort($fields, array($this, &quot;compareFieldOrder&quot;));                        &nbsp;</div></li><li><div>          return $fields;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Our filter to add shipping fields.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $fields</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return array $fields (processed)</span>&nbsp;</div></li><li><div><span class="comment">       */</span>                        &nbsp;</div></li><li><div>      function add_shipping_custom_fields( $fields ) {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          if (isset($options['woofields']['shipping']) && is_array($options['woofields']['shipping'])) {&nbsp;</div></li><li><div>              foreach($options['woofields']['shipping'] as $customkey =&gt; $customconfig) {&nbsp;</div></li><li><div>                  $fields[$customkey] = $this-&gt;createCustomStandardField($customkey, 'shipping', $options['woofields']['type_' . $customkey]);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $field_order = 1;&nbsp;</div></li><li><div>          foreach ($fields as $key =&gt; $field) :&nbsp;</div></li><li><div>              $fields[$key]['order'] = ((!empty($options['woofields']['order_' . $key]) && ctype_digit($options['woofields']['order_' . $key])) ? $options['woofields']['order_' . $key] : $field_order);            &nbsp;</div></li><li><div>              if ( isset($options['woofields']['remove_' . $key]) && $options['woofields']['remove_' . $key] == 1) :&nbsp;</div></li><li><div>                  $fields[$key]['required'] = false;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              $field_order++;&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          uasort($fields, array($this, &quot;compareFieldOrder&quot;));                        &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          return $fields;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Our filter for billing fields.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $fields</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return array $fields (processed)</span>&nbsp;</div></li><li><div><span class="comment">       */</span>                        &nbsp;</div></li><li><div>      public function wcpgsk_admin_billing_fields($fields) {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $billing_fields = array();&nbsp;</div></li><li><div>          $field_order = 1;    &nbsp;</div></li><li><div>          $checkout_fields = $woocommerce-&gt;countries-&gt;get_address_fields( $woocommerce-&gt;countries-&gt;get_base_country(), 'billing_' );&nbsp;</div></li><li><div>          $defchecked = __('Default: checked', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>          $defunchecked = __('Default: unchecked', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ($checkout_fields as $key =&gt; $field) :&nbsp;</div></li><li><div>              $checkout_fields[$key]['required'] = isset( $checkout_fields[$key]['required'] ) ?  $checkout_fields[$key]['required'] : 0;&nbsp;</div></li><li><div>              $checkout_fields[$key]['label'] = !empty($checkout_fields[$key]['label']) ? $checkout_fields[$key]['label'] : '';&nbsp;</div></li><li><div>              $checkout_fields[$key]['placeholder'] = !empty($checkout_fields[$key]['placeholder']) ? $checkout_fields[$key]['placeholder'] : '';&nbsp;</div></li><li><div>              $checkout_fields[$key]['fieldkey'] = $key;&nbsp;</div></li><li><div>              $checkout_fields[$key]['displaylabel'] = !empty($field['label']) ? __($field['label'], WCPGSK_DOMAIN) : $key;&nbsp;</div></li><li><div>              $checkout_fields[$key]['order'] = ((!empty($options['woofields']['order_' . $key]) && ctype_digit($options['woofields']['order_' . $key])) ? $options['woofields']['order_' . $key] : $field_order);&nbsp;</div></li><li><div>              $checkout_fields[$key]['placeholder'] = ((!empty($options['woofields']['placeholder_' . $key])) ? $options['woofields']['placeholder_' . $key] : $checkout_fields[$key]['placeholder']);&nbsp;</div></li><li><div>              $checkout_fields[$key]['label'] = ((!empty($options['woofields']['label_' . $key])) ? $options['woofields']['label_' . $key] : $checkout_fields[$key]['label']);&nbsp;</div></li><li><div>              <span class="comment">//$checkout_fields[$key]['label'] = ((isset($options['woofields']['label_' . $key])) ? $options['woofields']['label_' . $key] : $checkout_fields[$key]['label']);</span>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment">//before required defreq</span></span></span>&nbsp;</div></li><li><div>              $checkout_fields[$key]['defreq'] = ((isset($checkout_fields[$key]['required']) && $checkout_fields[$key]['required'] == 1) ? $defchecked : $defunchecked);&nbsp;</div></li><li><div>              $checkout_fields[$key]['required'] = ((isset($options['woofields']['required_' . $key])) ? $options['woofields']['required_' . $key] : $checkout_fields[$key]['required']);&nbsp;</div></li><li><div>              $checkout_fields[$key]['hideorder'] = ((isset($options['woofields']['hideorder_' . $key])) ? $options['woofields']['hideorder_' . $key] : 0);&nbsp;</div></li><li><div>              $checkout_fields[$key]['type'] = ((!empty($options['woofields']['type_' . $key])) ? $options['woofields']['type_' . $key] : ((!empty($checkout_fields[$key]['type'])) ? $checkout_fields[$key]['type'] : 'text') );&nbsp;</div></li><li><div>              $checkout_fields[$key]['classsel'] = ((!empty($options['woofields']['class_' . $key])) ? $options['woofields']['class_' . $key] : ((isset($checkout_fields[$key]['class'])) ? $checkout_fields[$key]['class'][0] : 'form-row-wide') );&nbsp;</div></li><li><div>              $checkout_fields[$key]['settings'] = ((!empty($options['woofields']['settings_' . $key])) ? $options['woofields']['settings_' . $key] : '' );&nbsp;</div></li><li><div>              $field_order++;&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          uasort($checkout_fields, array($this, &quot;compareFieldOrder&quot;));                        &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ($checkout_fields as $key =&gt; $field) : &nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment"><span class="comment">//$fieldLabel = $field['displaylabel'];</span></span></span></span>&nbsp;</div></li><li><div>              $fieldkey = str_replace('billing_', '', $key);&nbsp;</div></li><li><div>              if (isset($fields[$fieldkey])): &nbsp;</div></li><li><div>                  <span class="comment">//@TODO: this will never return nothing as $fields does not hold any keys according to $fieldkey</span>&nbsp;</div></li><li><div>                  $billing_fields[$fieldkey] = $fields[$fieldkey];&nbsp;</div></li><li><div>              else:&nbsp;</div></li><li><div>                  <span class="comment">//if ($key != 'billing_email_validator' && $field['hideorder'] == 0) :</span>&nbsp;</div></li><li><div>                  if ($key != 'billing_email_validator') :&nbsp;</div></li><li><div>                      if ( isset( $options['woofields']['billing'][$key]['custom_' . $key] ) && $options['woofields']['billing'][$key]['custom_' . $key] ) :&nbsp;</div></li><li><div>                          $configField = $this-&gt;createCustomStandardField($key, 'billing', $options['woofields']['type_' . $key]);&nbsp;</div></li><li><div>                          if (isset($configField['class'])) unset($configField['class']);&nbsp;</div></li><li><div>                          if (isset($configField['clear'])) unset($configField['clear']);&nbsp;</div></li><li><div>                          if (isset($configField['placeholder'])) unset($configField['placeholder']);&nbsp;</div></li><li><div>                          if (isset($configField['required'])) unset($configField['required']);&nbsp;</div></li><li><div>                          if (isset($configField['validate'])) unset($configField['validate']);&nbsp;</div></li><li><div>                          if (isset($configField['custom_attributes'])) unset($configField['custom_attributes']);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if (!isset($configField['label'])) $configField['label'] = __($checkout_fields[$key]['label'], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          <span class="comment"><span class="comment"><span class="comment">//show select values as text in this case</span></span></span>&nbsp;</div></li><li><div>                          if ( !empty($configField['type']) && $configField['type'] == 'select' ) $configField['type'] = 'text';&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//textarea is not recognized by woocommerce in order billing address context</span></span>&nbsp;</div></li><li><div>                          if ( !empty($configField['type']) && $configField['type'] == 'textarea' ) $configField['type'] = 'text';&nbsp;</div></li><li><div>                          <span class="comment">//if ( !empty($configField['type']) && $configField['type'] == 'fileupload' ) $configField['type'] = 'text';</span>&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//if ($field['hideorder'] == 0)</span></span>&nbsp;</div></li><li><div>                              $configField['show'] = true;&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//else</span></span>&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//    $configField['show'] = false;</span></span>&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                          $billing_fields[$fieldkey] = $configField;&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          return apply_filters( 'wcpgsk_admin_billing_fields', $billing_fields );    &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Our filter for shipping fields.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $fields</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return array $fields (processed)</span>&nbsp;</div></li><li><div><span class="comment">       */</span>                        &nbsp;</div></li><li><div>      public function wcpgsk_admin_shipping_fields($fields) {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          $defchecked = __('Default: checked', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>          $defunchecked = __('Default: unchecked', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $shipping_fields = array();&nbsp;</div></li><li><div>          $field_order = 1;    &nbsp;</div></li><li><div>          $checkout_fields = $woocommerce-&gt;countries-&gt;get_address_fields( $woocommerce-&gt;countries-&gt;get_base_country(), 'shipping_' );&nbsp;</div></li><li><div>          $field_order = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ($checkout_fields as $key =&gt; $field) :&nbsp;</div></li><li><div>              $checkout_fields[$key]['required'] = isset( $checkout_fields[$key]['required'] ) ?  $checkout_fields[$key]['required'] : 0;&nbsp;</div></li><li><div>              $checkout_fields[$key]['label'] = !empty($checkout_fields[$key]['label']) ? $checkout_fields[$key]['label'] : '';&nbsp;</div></li><li><div>              $checkout_fields[$key]['placeholder'] = !empty($checkout_fields[$key]['placeholder']) ? $checkout_fields[$key]['placeholder'] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $checkout_fields[$key]['fieldkey'] = $key;&nbsp;</div></li><li><div>              $checkout_fields[$key]['displaylabel'] = !empty($field['label']) ? __($field['label'], WCPGSK_DOMAIN) : $key;&nbsp;</div></li><li><div>              $checkout_fields[$key]['order'] = ((!empty($options['woofields']['order_' . $key]) && ctype_digit($options['woofields']['order_' . $key])) ? $options['woofields']['order_' . $key] : $field_order);&nbsp;</div></li><li><div>              $checkout_fields[$key]['placeholder'] = ((!empty($options['woofields']['placeholder_' . $key])) ? $options['woofields']['placeholder_' . $key] : $checkout_fields[$key]['placeholder']);&nbsp;</div></li><li><div>              $checkout_fields[$key]['label'] = ((!empty($options['woofields']['label_' . $key])) ? $options['woofields']['label_' . $key] : $checkout_fields[$key]['label']);&nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment">//before required defreq</span></span></span>&nbsp;</div></li><li><div>              $checkout_fields[$key]['defreq'] = ((isset($checkout_fields[$key]['required']) && $checkout_fields[$key]['required'] == 1) ? $defchecked : $defunchecked);&nbsp;</div></li><li><div>              $checkout_fields[$key]['required'] = ((isset($options['woofields']['required_' . $key])) ? $options['woofields']['required_' . $key] : $checkout_fields[$key]['required']);&nbsp;</div></li><li><div>              $checkout_fields[$key]['hideorder'] = ((isset($options['woofields']['hideorder_' . $key])) ? $options['woofields']['hideorder_' . $key] : 0);&nbsp;</div></li><li><div>              $checkout_fields[$key]['type'] = ((!empty($options['woofields']['type_' . $key])) ? $options['woofields']['type_' . $key] : ((!empty($checkout_fields[$key]['type'])) ? $checkout_fields[$key]['type'] : 'text') );&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              $checkout_fields[$key]['classsel'] = ((!empty($options['woofields']['class_' . $key])) ? $options['woofields']['class_' . $key] : ((isset($checkout_fields[$key]['class'])) ? $checkout_fields[$key]['class'][0] : 'form-row-wide') );&nbsp;</div></li><li><div>              $checkout_fields[$key]['settings'] = ((!empty($options['woofields']['settings_' . $key])) ? $options['woofields']['settings_' . $key] : '' );&nbsp;</div></li><li><div>              $field_order++;&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          uasort($checkout_fields, array($this, &quot;compareFieldOrder&quot;));                        &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ($checkout_fields as $key =&gt; $field) : &nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment"><span class="comment">//$fieldLabel = $field['displaylabel'];</span></span></span></span>&nbsp;</div></li><li><div>              $fieldkey = str_replace('shipping_', '', $key);&nbsp;</div></li><li><div>              if (isset($fields[$fieldkey])): &nbsp;</div></li><li><div>                  $shipping_fields[$fieldkey] = $fields[$fieldkey];&nbsp;</div></li><li><div>              else:&nbsp;</div></li><li><div>                  if ($key != 'shipping_email_validator') :&nbsp;</div></li><li><div>                      if ( isset( $options['woofields']['shipping'][$key]['custom_' . $key] ) && $options['woofields']['shipping'][$key]['custom_' . $key] ) :&nbsp;</div></li><li><div>                          $configField = $this-&gt;createCustomStandardField($key, 'shipping', $options['woofields']['type_' . $key]);&nbsp;</div></li><li><div>                          <span class="comment">//unset(configField['placeholder']);</span>&nbsp;</div></li><li><div>                          if (isset($configField['class'])) unset($configField['class']);&nbsp;</div></li><li><div>                          if (isset($configField['clear'])) unset($configField['clear']);&nbsp;</div></li><li><div>                          if (isset($configField['placeholder'])) unset($configField['placeholder']);&nbsp;</div></li><li><div>                          if (isset($configField['required'])) unset($configField['required']);&nbsp;</div></li><li><div>                          if (isset($configField['validate'])) unset($configField['validate']);&nbsp;</div></li><li><div>                          if (isset($configField['custom_attributes'])) unset($configField['custom_attributes']);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if (!isset($configField['label'])) $configField['label'] = __($checkout_fields[$key]['label'], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment"><span class="comment">//show select values as text in this case</span></span></span>&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment"><span class="comment">//show select values as text in this case</span></span></span>&nbsp;</div></li><li><div>                          if ( !empty($configField['type']) && $configField['type'] == 'select' ) $configField['type'] = 'text';&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//textarea is not recognized by woocommerce in order billing address context</span></span>&nbsp;</div></li><li><div>                          if ( !empty($configField['type']) && $configField['type'] == 'textarea' ) $configField['type'] = 'text';&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//if ($field['hideorder'] == 0)</span></span>&nbsp;</div></li><li><div>                              $configField['show'] = true;&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//else</span></span>&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//    $configField['show'] = false;</span></span>&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          $shipping_fields[$fieldkey] = $configField;&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          return apply_filters( 'wcpgsk_admin_shipping_fields', $shipping_fields );    &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Handle WooCommerce js overwrites of field labels, placeholders, hidden and required status.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $params</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.7.1</span>&nbsp;</div></li><li><div><span class="comment">       * @return array $params</span>&nbsp;</div></li><li><div><span class="comment">       */</span>                        &nbsp;</div></li><li><div>      public function wcpgsk_address_i18n_params($params) {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $locale = get_option( 'wcpgsk_locale', array() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $wc_locale = $this-&gt;wcpgsk_get_country_locale();&nbsp;</div></li><li><div>          $jsfields = $this-&gt;wcpgsk_get_country_locale_field_selectors();&nbsp;</div></li><li><div>          $countrycodes = $this-&gt;wcpgsk_get_allowed_countries();&nbsp;</div></li><li><div>          foreach($countrycodes as $countrycode =&gt; $cn) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $default_postcode = isset($locale['default']['postcode_before_city']) ? $locale['default']['postcode_before_city'] : '0';&nbsp;</div></li><li><div>              $wc_localepostcode = isset($wc_locale[$countrycode]) && isset($wc_locale[$countrycode]['postcode_before_city']) && $wc_locale[$countrycode]['postcode_before_city'] ? 1 : ( isset($wc_locale['default']['postcode_before_city']) && $wc_locale['default']['postcode_before_city'] ? 1 : $default_postcode );&nbsp;</div></li><li><div>              $locale[$countrycode]['postcode_before_city'] = isset($locale[$countrycode]['postcode_before_city']) ? $locale[$countrycode]['postcode_before_city'] : $wc_localepostcode;&nbsp;</div></li><li><div>              $wc_locale[$countrycode]['postcode_before_city'] = $locale[$countrycode]['postcode_before_city'] ? true : false;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>              foreach ($jsfields as $fieldkey =&gt; $config) :&nbsp;</div></li><li><div>                  if ( isset($jsfields[$fieldkey]) && !empty($jsfields[$fieldkey]) ) :&nbsp;</div></li><li><div>                      <span class="comment">//use wcpgsk billing fields configuration</span>&nbsp;</div></li><li><div>                      if ( isset($options['checkoutform']['default_' . $fieldkey]) && $options['checkoutform']['default_' . $fieldkey] ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $default_label = isset($locale['default']['label_' . $fieldkey]) ? $locale['default']['label_' . $fieldkey] : '';&nbsp;</div></li><li><div>                          $wc_localelabel = isset($wc_locale[$countrycode]) && isset($wc_locale[$countrycode][$fieldkey]) && isset($wc_locale[$countrycode][$fieldkey]['label']) ? $wc_locale[$countrycode][$fieldkey]['label'] : ( isset($wc_locale['default'][$fieldkey]['label']) ? $wc_locale['default'][$fieldkey]['label'] : $default_label );&nbsp;</div></li><li><div>                          $locale[$countrycode]['label_' . $fieldkey] = isset($locale[$countrycode]['label_' . $fieldkey]) ? $locale[$countrycode]['label_' . $fieldkey] : $wc_localelabel;&nbsp;</div></li><li><div>                          $wc_locale[$countrycode][$fieldkey]['label'] = __($locale[$countrycode]['label_' . $fieldkey], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          $default_placeholder = isset($locale['default']['placeholder_' . $fieldkey]) ? $locale['default']['placeholder_' . $fieldkey] : '';&nbsp;</div></li><li><div>                          $wc_localeplaceholder = isset($wc_locale[$countrycode]) && isset($wc_locale[$countrycode][$fieldkey]) && isset($wc_locale[$countrycode][$fieldkey]['placeholder']) ? $wc_locale[$countrycode][$fieldkey]['placeholder'] : ( isset($wc_locale['default'][$fieldkey]['placeholder']) ? $wc_locale['default'][$fieldkey]['placeholder'] : $default_placeholder );&nbsp;</div></li><li><div>                          $locale[$countrycode]['placeholder_' . $fieldkey] = isset($locale[$countrycode]['placeholder_' . $fieldkey]) ? $locale[$countrycode]['placeholder_' . $fieldkey] : $wc_localeplaceholder;&nbsp;</div></li><li><div>                          $wc_locale[$countrycode][$fieldkey]['placeholder'] = __($locale[$countrycode]['placeholder_' . $fieldkey], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $default_required = isset($locale['default']['required_' . $fieldkey]) ? $locale['default']['required_' . $fieldkey] : '0';&nbsp;</div></li><li><div>                          $wc_localerequired = isset($wc_locale[$countrycode]) && isset($wc_locale[$countrycode][$fieldkey]) && isset($wc_locale[$countrycode][$fieldkey]['required']) ? ( $wc_locale[$countrycode][$fieldkey]['required'] ? '1' : '0' ) : ( isset($wc_locale['default'][$fieldkey]['required']) && $wc_locale['default'][$fieldkey]['required'] ? '1' : $default_required );&nbsp;</div></li><li><div>                          $locale[$countrycode]['required_' . $fieldkey] = isset($locale[$countrycode]['required_' . $fieldkey]) ? $locale[$countrycode]['required_' . $fieldkey] : $wc_localerequired;&nbsp;</div></li><li><div>                          $wc_locale[$countrycode][$fieldkey]['required'] = $locale[$countrycode]['required_' . $fieldkey] == '1' ? true : false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $default_hidden = isset($locale['default']['hidden_' . $fieldkey]) ? $locale['default']['hidden_' . $fieldkey] : '0';&nbsp;</div></li><li><div>                          $wc_localehidden = isset($wc_locale[$countrycode]) && isset($wc_locale[$countrycode][$fieldkey]) && isset($wc_locale[$countrycode][$fieldkey]['hidden']) ? ( $wc_locale[$countrycode][$fieldkey]['hidden'] ? '1' : '0' ) : ( isset($wc_locale['default'][$fieldkey]['hidden']) && $wc_locale['default'][$fieldkey]['hidden'] ? '1' : $default_hidden );&nbsp;</div></li><li><div>                          $locale[$countrycode]['hidden_' . $fieldkey] = isset($locale[$countrycode]['hidden_' . $fieldkey]) ? $locale[$countrycode]['hidden_' . $fieldkey] : $wc_localehidden;&nbsp;</div></li><li><div>                          $wc_locale[$countrycode][$fieldkey]['hidden'] = $locale[$countrycode]['hidden_' . $fieldkey] == '1' ? true : false;&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      else :&nbsp;</div></li><li><div>                          $wc_locale[$countrycode][$fieldkey]['required'] = false;                    &nbsp;</div></li><li><div>                          if (isset($options['woofields']['required_billing_' . $fieldkey]) && $options['woofields']['required_billing_' . $fieldkey] == 1) :&nbsp;</div></li><li><div>                              $wc_locale[$countrycode][$fieldkey]['required'] = true;&nbsp;</div></li><li><div>                          else :&nbsp;</div></li><li><div>                              $wc_locale[$countrycode][$fieldkey]['required'] = false;                            &nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                          if (isset($options['woofields']['remove_billing_' . $fieldkey]) && $options['woofields']['remove_billing_' . $fieldkey] == 1) :&nbsp;</div></li><li><div>                              $wc_locale[$countrycode][$fieldkey]['required'] = false;&nbsp;</div></li><li><div>                              $wc_locale[$countrycode][$fieldkey]['hidden'] = true;&nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                          if ( isset($options['woofields']['label_billing_' . $fieldkey]) ) :&nbsp;</div></li><li><div>                              $wc_locale[$countrycode][$fieldkey]['label'] = __($options['woofields']['label_billing_' . $fieldkey], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                          if ( isset($options['woofields']['placeholder_billing_' . $fieldkey]) ) :&nbsp;</div></li><li><div>                              $wc_locale[$countrycode][$fieldkey]['placeholder'] = __($options['woofields']['placeholder_billing_' . $fieldkey], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>              endforeach;&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          if ( function_exists('WC') ) :&nbsp;</div></li><li><div>              return array(&nbsp;</div></li><li><div>                  'locale' =&gt; json_encode( $wc_locale ), &nbsp;</div></li><li><div>                  'locale_fields' =&gt; json_encode( WC()-&gt;countries-&gt;get_country_locale_field_selectors() ), &nbsp;</div></li><li><div>                  'i18n_required_text' =&gt; esc_attr__( 'required', 'woocommerce' ), &nbsp;</div></li><li><div> );        &nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              <span class="comment">//locale fields exist hardcoded in wc js file for WC versions below 2.1</span>&nbsp;</div></li><li><div>              $params['locale'] = json_encode( $wc_locale );&nbsp;</div></li><li><div>              return $params;            &nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Handle WooCommerce js overwrites of field labels, placeholders, hidden and required status.</span>&nbsp;</div></li><li><div><span class="comment">       * </span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $locale_fields</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.7.1</span>&nbsp;</div></li><li><div><span class="comment">       * @return array $locale_fields</span>&nbsp;</div></li><li><div><span class="comment">       */</span>                                &nbsp;</div></li><li><div>      public function wcpgsk_country_locale_field_selectors($locale_fields) {&nbsp;</div></li><li><div>          $options = get_option('wcpgsk_settings');&nbsp;</div></li><li><div>          foreach($locale_fields as $field =&gt; $selectors) :&nbsp;</div></li><li><div>              $selarray = array();&nbsp;</div></li><li><div>              if ( isset($options['checkoutform']['default_' . $field]) && $options['checkoutform']['default_' . $field] ) :&nbsp;</div></li><li><div>                  $selarray[] = '#billing_' . $field . '_field';&nbsp;</div></li><li><div>                  $selarray[] = '#shipping_' . $field . '_field';                    &nbsp;</div></li><li><div>              else :&nbsp;</div></li><li><div>                  $selarray[] = '#no_wc_billing_' . $field . '_handle';&nbsp;</div></li><li><div>                  $selarray[] = '#no_wc_shipping_' . $field . '_handle';&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              $locale_fields[$field] = implode(', ', $selarray);&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>          return $locale_fields;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Our filter for billing fields.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $fields</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @modified 1.7.1</span>&nbsp;</div></li><li><div><span class="comment">       * @return array $fields (processed)</span>&nbsp;</div></li><li><div><span class="comment">       */</span>                        &nbsp;</div></li><li><div>      public function wcpgsk_checkout_fields_billing($fields) {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          $field_order = 1;    &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          $orderfields = array();&nbsp;</div></li><li><div>          $lastClass = array();&nbsp;</div></li><li><div>          foreach ($fields['billing'] as $key =&gt; $field) {&nbsp;</div></li><li><div>              if (isset($options['woofields']['remove_' . $key]) && $options['woofields']['remove_' . $key] == 1) {&nbsp;</div></li><li><div>                  if ( $key == 'billing_country' ) :&nbsp;</div></li><li><div>                      $countries = $woocommerce-&gt;countries-&gt;get_allowed_countries();&nbsp;</div></li><li><div>                      if ( isset( $countries ) && is_array( $countries ) && count( $countries ) == 1 ) :&nbsp;</div></li><li><div>                          $fields['billing'][$key]['class'] = array('hidecountry');&nbsp;</div></li><li><div>                      elseif ( isset( $countries ) && is_array( $countries ) && count( $countries ) &gt; 2 ) :&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//incorrect admin setting, do nothing</span></span>&nbsp;</div></li><li><div>                      endif;                        &nbsp;</div></li><li><div>                  else :&nbsp;</div></li><li><div>                      unset($fields['billing'][$key]);                    &nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              else {&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>                  $orderfields[$key] = $fields['billing'][$key];&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if ( isset($options['woofields']['settings_' . $key]) && $options['woofields']['settings_' . $key]) :&nbsp;</div></li><li><div>                      $orderfields[$key] = $this-&gt;createCustomStandardField($key, 'billing', $options['woofields']['type_' . $key]);&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">//cosmetic stuff</span></span>&nbsp;</div></li><li><div>                  if (!empty($options['woofields']['class_' . $key])) {&nbsp;</div></li><li><div>                      if (!empty($orderfields[$key]['class']) && is_array($orderfields[$key]['class']))&nbsp;</div></li><li><div>                          $orderfields[$key]['class'][0] = $options['woofields']['class_' . $key];&nbsp;</div></li><li><div>                      else&nbsp;</div></li><li><div>                          $orderfields[$key]['class'] = array ($options['woofields']['class_' . $key]);&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  <span class="comment"><span class="comment"><span class="comment"><span class="comment">//Respect WC handling if desired</span></span></span></span>&nbsp;</div></li><li><div>                  $wc_field_handle = str_replace('billing_', '', $key);                    &nbsp;</div></li><li><div>                  if ( isset($options['checkoutform']['default_' . $wc_field_handle]) && $options['checkoutform']['default_' . $wc_field_handle] ) :&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment">//do nothing</span> with required</span></span>&nbsp;</div></li><li><div>                      $orderfields[$key]['label'] = !empty($options['woofields']['label_' . $key]) ? __($options['woofields']['label_' . $key], WCPGSK_DOMAIN) : '';&nbsp;</div></li><li><div>                      $orderfields[$key]['placeholder'] = !empty($options['woofields']['placeholder_' . $key]) ? __($options['woofields']['placeholder_' . $key], WCPGSK_DOMAIN) : '';&nbsp;</div></li><li><div>                  else :    &nbsp;</div></li><li><div>                      $orderfields[$key]['label'] = !empty($options['woofields']['label_' . $key]) ? __($options['woofields']['label_' . $key], WCPGSK_DOMAIN) : '';&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                      if (isset($options['woofields']['required_' . $key]) && $options['woofields']['required_' . $key] != 1) :&nbsp;</div></li><li><div>                          $orderfields[$key]['required'] = false;&nbsp;</div></li><li><div>                      elseif (isset($options['woofields']['required_' . $key]) && $options['woofields']['required_' . $key] == 1) :&nbsp;</div></li><li><div>                          $orderfields[$key]['required'] = true;&nbsp;</div></li><li><div>                      else :&nbsp;</div></li><li><div>                          $orderfields[$key]['required'] = false;                    &nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      $orderfields[$key]['placeholder'] = !empty($options['woofields']['placeholder_' . $key]) ? __($options['woofields']['placeholder_' . $key], WCPGSK_DOMAIN) : '';&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment"><span class="comment"><span class="comment">//set the order data</span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if (empty($options['woofields']['order_' . $key]) || !ctype_digit($options['woofields']['order_' . $key])) {&nbsp;</div></li><li><div>                      $orderfields[$key]['order'] = $field_order;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  else {&nbsp;</div></li><li><div>                      $orderfields[$key]['order'] = $options['woofields']['order_' . $key];&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  if ( isset($options['woofields']['settings_' . $key]) && $options['woofields']['settings_' . $key]) :&nbsp;</div></li><li><div>                      $params = $this-&gt;explodeParameters($options['woofields']['settings_' . $key]);&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">//if ( strpos($key, '_wcpgsk_repeater') !== false ) :</span></span>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">//$testkey = str_replace('_wcpgsk_repeater', '', $key);</span></span>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">//if ( !empty($options['woofields']['settings_' . $testkey]) ) :</span></span>&nbsp;</div></li><li><div>                      if ( is_array($params) && !empty($params) && isset($params['repeat_field']) && $params['repeat_field'] == '1' ) :&nbsp;</div></li><li><div>                          $repkey = $key . '_wcpgsk_repeater';&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          $orderfields[$repkey] = $this-&gt;createCustomStandardFieldClone($key, 'billing', $options['woofields']['type_' . $key]);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//set all our other data</span></span>&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//unset required for repeater fields as this collides with WooCommerce</span></span>&nbsp;</div></li><li><div>                          if ( isset($orderfields[$repkey]['required']) ) unset($orderfields[$repkey]['required']);&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//check if repeater field</span></span>&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                          $orderfields[$repkey]['placeholder'] = !empty($options['woofields']['placeholder_' . $key]) ? __($options['woofields']['placeholder_' . $key], WCPGSK_DOMAIN) : '';&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment"><span class="comment"><span class="comment">//set the order data</span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          if (empty($options['woofields']['order_' . $key]) || !ctype_digit($options['woofields']['order_' . $key])) {&nbsp;</div></li><li><div>                              $orderfields[$repkey]['order'] = $field_order + 0.5;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          else {&nbsp;</div></li><li><div>                              $orderfields[$repkey]['order'] = intval($options['woofields']['order_' . $key]) + 0.5;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>                  unset($fields['billing'][$key]);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $field_order++;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">//order the fields</span></span>&nbsp;</div></li><li><div>          uasort($orderfields, array($this, &quot;compareFieldOrder&quot;));                        &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          <span class="comment"><span class="comment">//add the fields again</span></span>&nbsp;</div></li><li><div>          foreach ($orderfields as $key =&gt; $field) {&nbsp;</div></li><li><div>              if ($key == 'order')&nbsp;</div></li><li><div>                  unset($field['order']);&nbsp;</div></li><li><div>              else&nbsp;</div></li><li><div>                  $fields['billing'][$key] = $field;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $fields;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Our filter for shipping fields.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $fields</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return array $fields (processed)</span>&nbsp;</div></li><li><div><span class="comment">       */</span>                        &nbsp;</div></li><li><div>      public function wcpgsk_checkout_fields_shipping($fields) {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          $field_order = 1;    &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          $orderfields = array();&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          foreach ($fields['shipping'] as $key =&gt; $field) {&nbsp;</div></li><li><div>              if (isset($options['woofields']['remove_' . $key]) && $options['woofields']['remove_' . $key] == 1) {&nbsp;</div></li><li><div>                  if ( $key == 'shipping_country' ) :&nbsp;</div></li><li><div>                      $countries = $woocommerce-&gt;countries-&gt;get_shipping_countries();&nbsp;</div></li><li><div>                      if ( isset( $countries ) && is_array( $countries ) && count( $countries ) == 1 ) :&nbsp;</div></li><li><div>                          $fields['shipping'][$key]['class'] = array('hidecountry');&nbsp;</div></li><li><div>                      elseif ( isset( $countries ) && is_array( $countries ) && count( $countries ) &gt; 2 ) :&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//incorrect admin setting, do nothing</span></span>&nbsp;</div></li><li><div>                      endif;                        &nbsp;</div></li><li><div>                  else :&nbsp;</div></li><li><div>                      unset($fields['shipping'][$key]);&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              else {&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>                  $orderfields[$key] = $fields['shipping'][$key];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">//cosmetic stuff</span></span>&nbsp;</div></li><li><div>                  if (!empty($options['woofields']['class_' . $key])) {&nbsp;</div></li><li><div>                      if (!empty($orderfields[$key]['class']) && is_array($orderfields[$key]['class']))&nbsp;</div></li><li><div>                          $orderfields[$key]['class'][0] = $options['woofields']['class_' . $key];&nbsp;</div></li><li><div>                      else&nbsp;</div></li><li><div>                          $orderfields[$key]['class'] = array ($options['woofields']['class_' . $key]);&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  <span class="comment"><span class="comment"><span class="comment"><span class="comment">//Respect WC handling if desired</span></span></span></span>&nbsp;</div></li><li><div>                  $wc_field_handle = str_replace('shipping_', '', $key);                    &nbsp;</div></li><li><div>                  if ( isset($options['checkoutform']['default_' . $wc_field_handle]) && $options['checkoutform']['default_' . $wc_field_handle] ) :&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment">//do nothing</span> with required</span></span>&nbsp;</div></li><li><div>                      $orderfields[$key]['label'] = !empty($options['woofields']['label_' . $key]) ? __($options['woofields']['label_' . $key], WCPGSK_DOMAIN) : '';&nbsp;</div></li><li><div>                      $orderfields[$key]['placeholder'] = !empty($options['woofields']['placeholder_' . $key]) ? __($options['woofields']['placeholder_' . $key], WCPGSK_DOMAIN) : '';&nbsp;</div></li><li><div>                  else :    &nbsp;</div></li><li><div>                      $orderfields[$key]['label'] = !empty($options['woofields']['label_' . $key]) ? __($options['woofields']['label_' . $key], WCPGSK_DOMAIN) : '';&nbsp;</div></li><li><div>                      if (isset($options['woofields']['required_' . $key]) && $options['woofields']['required_' . $key] != 1) :&nbsp;</div></li><li><div>                          $orderfields[$key]['required'] = false;&nbsp;</div></li><li><div>                      elseif (isset($options['woofields']['required_' . $key]) && $options['woofields']['required_' . $key] == 1) :&nbsp;</div></li><li><div>                          $orderfields[$key]['required'] = true;&nbsp;</div></li><li><div>                      else :&nbsp;</div></li><li><div>                          $orderfields[$key]['required'] = false;                    &nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      $orderfields[$key]['placeholder'] = !empty($options['woofields']['placeholder_' . $key]) ? __($options['woofields']['placeholder_' . $key], WCPGSK_DOMAIN) : '';&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment"><span class="comment"><span class="comment">//set the order data</span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  if (empty($options['woofields']['order_' . $key]) || !ctype_digit($options['woofields']['order_' . $key])) {&nbsp;</div></li><li><div>                      $orderfields[$key]['order'] = $field_order;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  else {&nbsp;</div></li><li><div>                      $orderfields[$key]['order'] = $options['woofields']['order_' . $key];&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset($options['woofields']['settings_' . $key]) && $options['woofields']['settings_' . $key]) :&nbsp;</div></li><li><div>                      $params = $this-&gt;explodeParameters($options['woofields']['settings_' . $key]);&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">//if ( strpos($key, '_wcpgsk_repeater') !== false ) :</span></span>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">//$testkey = str_replace('_wcpgsk_repeater', '', $key);</span></span>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">//if ( !empty($options['woofields']['settings_' . $testkey]) ) :</span></span>&nbsp;</div></li><li><div>                      if ( is_array($params) && !empty($params) && isset($params['repeat_field']) && $params['repeat_field'] == '1' ) :&nbsp;</div></li><li><div>                          $repkey = $key . '_wcpgsk_repeater';&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          $orderfields[$repkey] = $this-&gt;createCustomStandardFieldClone($key, 'shipping', $options['woofields']['type_' . $key]);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//set all our other data</span></span>&nbsp;</div></li><li><div>                          <span class="comment">//woocommerce changed?</span>&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//unset required for repeater fields as this collides with WooCommerce</span></span>&nbsp;</div></li><li><div>                          if ( isset($orderfields[$repkey]['required']) ) unset($orderfields[$repkey]['required']);&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//check if repeater field</span></span>&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                          $orderfields[$repkey]['placeholder'] = !empty($options['woofields']['placeholder_' . $key]) ? __($options['woofields']['placeholder_' . $key], WCPGSK_DOMAIN) : '';&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment"><span class="comment"><span class="comment">//set the order data</span></span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          if (empty($options['woofields']['order_' . $key]) || !ctype_digit($options['woofields']['order_' . $key])) {&nbsp;</div></li><li><div>                              $orderfields[$repkey]['order'] = $field_order + 0.5;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          else {&nbsp;</div></li><li><div>                              $orderfields[$repkey]['order'] = intval($options['woofields']['order_' . $key]) + 0.5;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>                  unset($fields['shipping'][$key]);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $field_order++;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">//order the fields</span></span>&nbsp;</div></li><li><div>          uasort($orderfields, array($this, &quot;compareFieldOrder&quot;));                        &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          <span class="comment"><span class="comment">//add the fields again</span></span>&nbsp;</div></li><li><div>          foreach ($orderfields as $key =&gt; $field) {&nbsp;</div></li><li><div>              if ($key == 'order')&nbsp;</div></li><li><div>                  unset($field['order']);&nbsp;</div></li><li><div>              else&nbsp;</div></li><li><div>                  $fields['shipping'][$key] = $field;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $fields;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Process form data supplied via the checkout form.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @modified 1.7.1</span>&nbsp;</div></li><li><div><span class="comment">       * @return Raise errors and adjust values if necessary</span>&nbsp;</div></li><li><div><span class="comment">       */</span>                        &nbsp;</div></li><li><div>      public function wcpgsk_checkout_process() {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          global $wcpgsk_session;&nbsp;</div></li><li><div>          if ( function_exists('WC') ) :&nbsp;</div></li><li><div>              WC()-&gt;session-&gt;set('post', $_POST);&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              $wcpgsk_session-&gt;post = $_POST;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          <span class="comment">//$wcpgsk_session-&gt;post = $_POST;</span>&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          <span class="comment">//do_action('wcpgsk_checkout_process_action');</span>&nbsp;</div></li><li><div>          if ( !is_user_logged_in() ) :&nbsp;</div></li><li><div>              if (isset($options['checkoutform']['billingemailvalidator']) && $options['checkoutform']['billingemailvalidator'] == 1) {&nbsp;</div></li><li><div>                  if ($_POST[ 'billing_email' ] && $_POST[ 'billing_email_validator' ] && strtolower($_POST[ 'billing_email' ]) != strtolower($_POST[ 'billing_email_validator' ]))&nbsp;</div></li><li><div>                      wcpgsk_add_error(  '&lt;strong&gt;' . __('Email addresses do not match', WCPGSK_DOMAIN) . ': ' . $_POST[ 'billing_email' ] . ' : ' . (empty($_POST[ 'billing_email_validator' ]) ? __('Missing validation email', WCPGSK_DOMAIN) : $_POST[ 'billing_email_validator' ]) . '&lt;/strong&gt;');&nbsp;</div></li><li><div>                  elseif ($_POST[ 'billing_email' ] && !$_POST[ 'billing_email_validator' ])&nbsp;</div></li><li><div>                      wcpgsk_add_error(  '&lt;strong&gt;' . __('You have to supply a validation email for: ', WCPGSK_DOMAIN) . $_POST[ 'billing_email' ] . '&lt;/strong&gt;');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          <span class="comment">//Just communicate the required state to WC plus the label in billing context based on user choice and locale configuration</span>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">//WC will take care of the error handling</span></span>&nbsp;</div></li><li><div>          if ( isset($_POST['billing_country']) && $_POST['billing_country'] ) :&nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment"><span class="comment">//Respect WC handling if desired</span></span></span></span>&nbsp;</div></li><li><div>              $jsfields = $this-&gt;wcpgsk_get_country_locale_field_selectors();&nbsp;</div></li><li><div>              $locale = get_option( 'wcpgsk_locale', array() );&nbsp;</div></li><li><div>              $wc_locale = $this-&gt;wcpgsk_get_country_locale();&nbsp;</div></li><li><div>              $countrycode = $_POST['billing_country'];&nbsp;</div></li><li><div>              foreach ($jsfields as $wc_field_handle =&gt; $wc_field_config) :&nbsp;</div></li><li><div>                  if ( isset($options['checkoutform']['default_' . $wc_field_handle]) && $options['checkoutform']['default_' . $wc_field_handle] ) :&nbsp;</div></li><li><div>                      $default_required = isset($locale['default']['required_' . $wc_field_handle]) ? $locale['default']['required_' . $wc_field_handle] : '0';&nbsp;</div></li><li><div>                      $wc_localerequired = isset($wc_locale[$countrycode]) && isset($wc_locale[$countrycode][$wc_field_handle]) && isset($wc_locale[$countrycode][$wc_field_handle]['required']) ? ( $wc_locale[$countrycode][$wc_field_handle]['required'] ? '1' : '0' ) : ( isset($wc_locale['default'][$wc_field_handle]['required']) && $wc_locale['default'][$wc_field_handle]['required'] ? '1' : $default_required );&nbsp;</div></li><li><div>                      $locale[$countrycode]['required_' . $wc_field_handle] = isset($locale[$countrycode]['required_' . $wc_field_handle]) ? $locale[$countrycode]['required_' . $wc_field_handle] : $wc_localerequired;&nbsp;</div></li><li><div>                      $required_field = $locale[$countrycode]['required_' . $wc_field_handle] ? true : false;&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      $default_label = isset($locale['default']['label_' . $wc_field_handle]) ? $locale['default']['label_' . $wc_field_handle] : '';&nbsp;</div></li><li><div>                      $wc_localelabel = isset($wc_locale[$countrycode]) && isset($wc_locale[$countrycode][$wc_field_handle]) && isset($wc_locale[$countrycode][$wc_field_handle]['label']) ? $wc_locale[$countrycode][$wc_field_handle]['label'] : ( isset($wc_locale['default'][$wc_field_handle]['label']) ? $wc_locale['default'][$wc_field_handle]['label'] : $default_label );                        &nbsp;</div></li><li><div>                      $locale[$countrycode]['label_' . $wc_field_handle] = isset($locale[$countrycode]['label_' . $wc_field_handle]) ? $locale[$countrycode]['label_' . $wc_field_handle] : $wc_localelabel;&nbsp;</div></li><li><div>                      $required_label = $locale[$countrycode]['label_' . $wc_field_handle];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $woocommerce-&gt;checkout-&gt;checkout_fields['billing']['billing_' . $wc_field_handle]['required'] = $required_field;&nbsp;</div></li><li><div>                      $woocommerce-&gt;checkout-&gt;checkout_fields['billing']['billing_' . $wc_field_handle]['label'] = __($required_label, WCPGSK_DOMAIN);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>              endforeach;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">//Just communicate the required state to WC plus the label in shipping context based on user choice and locale configuration</span>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">//WC will take care of the error handling</span></span>&nbsp;</div></li><li><div>          if ( isset($_POST['shipping_country']) && $_POST['shipping_country'] ) :&nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment"><span class="comment">//Respect WC handling if desired</span></span></span></span>&nbsp;</div></li><li><div>              $jsfields = $this-&gt;wcpgsk_get_country_locale_field_selectors();&nbsp;</div></li><li><div>              $locale = get_option( 'wcpgsk_locale', array() );&nbsp;</div></li><li><div>              $wc_locale = $this-&gt;wcpgsk_get_country_locale();&nbsp;</div></li><li><div>              $countrycode = $_POST['shipping_country'];&nbsp;</div></li><li><div>              foreach ($jsfields as $wc_field_handle =&gt; $wc_field_config) :&nbsp;</div></li><li><div>                  if ( isset($options['checkoutform']['default_' . $wc_field_handle]) && $options['checkoutform']['default_' . $wc_field_handle] ) :&nbsp;</div></li><li><div>                      $default_required = isset($locale['default']['required_' . $wc_field_handle]) ? $locale['default']['required_' . $wc_field_handle] : '0';&nbsp;</div></li><li><div>                      $wc_localerequired = isset($wc_locale[$countrycode]) && isset($wc_locale[$countrycode][$wc_field_handle]) && isset($wc_locale[$countrycode][$wc_field_handle]['required']) ? ( $wc_locale[$countrycode][$wc_field_handle]['required'] ? '1' : '0' ) : ( isset($wc_locale['default'][$wc_field_handle]['required']) && $wc_locale['default'][$wc_field_handle]['required'] ? '1' : $default_required );&nbsp;</div></li><li><div>                      $locale[$countrycode]['required_' . $wc_field_handle] = isset($locale[$countrycode]['required_' . $wc_field_handle]) ? $locale[$countrycode]['required_' . $wc_field_handle] : $wc_localerequired;&nbsp;</div></li><li><div>                      $required_field = $locale[$countrycode]['required_' . $wc_field_handle] == '1' ? true : false;&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      $default_label = isset($locale['default']['label_' . $wc_field_handle]) ? $locale['default']['label_' . $wc_field_handle] : '';&nbsp;</div></li><li><div>                      $wc_localelabel = isset($wc_locale[$countrycode]) && isset($wc_locale[$countrycode][$wc_field_handle]) && isset($wc_locale[$countrycode][$wc_field_handle]['label']) ? $wc_locale[$countrycode][$wc_field_handle]['label'] : ( isset($wc_locale['default'][$wc_field_handle]['label']) ? $wc_locale['default'][$wc_field_handle]['label'] : $default_label );                        &nbsp;</div></li><li><div>                      $locale[$countrycode]['label_' . $wc_field_handle] = isset($locale[$countrycode]['label_' . $wc_field_handle]) ? $locale[$countrycode]['label_' . $wc_field_handle] : $wc_localelabel;&nbsp;</div></li><li><div>                      $required_label = $locale[$countrycode]['label_' . $wc_field_handle];&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      $woocommerce-&gt;checkout-&gt;checkout_fields['shipping']['shipping_' . $wc_field_handle]['required'] = $required_field;&nbsp;</div></li><li><div>                      $woocommerce-&gt;checkout-&gt;checkout_fields['shipping']['shipping_' . $wc_field_handle]['label'] = __($required_label, WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>              endforeach;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          $combine = array();&nbsp;</div></li><li><div>          foreach($_POST as $key =&gt; $val) {&nbsp;</div></li><li><div>              if ( strpos($key, '_wcpgsk_repeater') !== false ) :&nbsp;</div></li><li><div>                  $testkey = str_replace('_wcpgsk_repeater', '', $key);&nbsp;</div></li><li><div>                  if ( $_POST[$key] != $_POST[$testkey] ) :&nbsp;</div></li><li><div>                      $captured_value = $_POST[ $testkey ];&nbsp;</div></li><li><div>                      if ( isset($options['woofields']['settings_' . $testkey]) ) :&nbsp;</div></li><li><div>                          $params = $this-&gt;explodeParameters($options['woofields']['settings_' . $testkey]);&nbsp;</div></li><li><div>                          if ( isset($params) && isset($params['validate']) && !empty($params['validate']) && $params['validate'] == 'password' ) :&nbsp;</div></li><li><div>                              $captured_value = '*******';&nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      $forLabel = '';&nbsp;</div></li><li><div>                      if ( isset($options['woofields']['label_' . $testkey]) && !empty($options['woofields']['label_' . $testkey]) ) :&nbsp;</div></li><li><div>                          $forLabel = __($options['woofields']['label_' . $testkey], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      wcpgsk_add_error(  '&lt;strong&gt;' . sprintf(__('You have to validate the value &lt;em style=&quot;color:red&quot;&gt;%s&lt;/em&gt; for %s correctly! Please check your input.', WCPGSK_DOMAIN), $captured_value, $forLabel ) . '&lt;/strong&gt;');&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>                  unset($_POST[$key]);&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              elseif ( ( isset($options['woofields']['billing'][$key]['custom_' . $key]) && $options['woofields']['billing'][$key]['custom_' . $key] ) || ( isset( $options['woofields']['shipping'][$key]['custom_' . $key] ) && $options['woofields']['shipping'][$key]['custom_' . $key] ) ) :&nbsp;</div></li><li><div>                  if ( $options['woofields']['type_' . $key] == 'date' && !empty($_POST[$key]) ) :&nbsp;</div></li><li><div>                      <span class="comment">//transform back based on field setting</span>&nbsp;</div></li><li><div>                      $params = $this-&gt;explodeParameters($options['woofields']['settings_' . $key]);&nbsp;</div></li><li><div>                      $_POST[$key] = str_replace('-', '/', $_POST[$key]);&nbsp;</div></li><li><div>                      if ( isset($params['dateformat']) && !empty($params['dateformat']) ) :&nbsp;</div></li><li><div>                          if ( $params['dateformat'] == 'dd/mm/yy' ) :&nbsp;</div></li><li><div>                              $arrdate = explode('/', $_POST[$key]);&nbsp;</div></li><li><div>                              $_POST[$key] = $arrdate[2].'/'.$arrdate[1].'/'.$arrdate[0];&nbsp;</div></li><li><div>                          elseif ( $params['dateformat'] == 'mm/dd/yy' ) :&nbsp;</div></li><li><div>                              $arrdate = explode('/', $_POST[$key]);&nbsp;</div></li><li><div>                              $_POST[$key] = $arrdate[2].'/'.$arrdate[0].'/'.$arrdate[1];                                &nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                      if ( $this-&gt;ValidateDate($_POST[$key]) ) :&nbsp;</div></li><li><div>                          if ( isset($params) && isset($params['mindays']) && !empty($params['mindays']) && ( ctype_digit( strval( $params['mindays'] ) ) || is_numeric( strval( $params['mindays'] ) ) ) ) :    &nbsp;</div></li><li><div>                              $forLabel = '';&nbsp;</div></li><li><div>                              $daydiff = $this-&gt;datediffdays($_POST[$key]);&nbsp;</div></li><li><div>                              if ( $params['mindays'] &lt; 0 ) :&nbsp;</div></li><li><div>                                  if ( $daydiff &lt; $params['mindays'] ) :&nbsp;</div></li><li><div>                                      if ( isset($options['woofields']['label_' . $key]) && !empty($options['woofields']['label_' . $key]) ) :&nbsp;</div></li><li><div>                                          $forLabel = __($options['woofields']['label_' . $key], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                                      endif;&nbsp;</div></li><li><div>                                      $mindate = date('Y/m/d', strtotime(date(&quot;Y-m-d&quot;) . ' - ' . ( absint( $params['mindays'] ) - 1 ) . ' days'));&nbsp;</div></li><li><div>                                      wcpgsk_add_error(  '&lt;strong&gt;' . sprintf(__('Date value for &lt;em style=&quot;color:red&quot;&gt;%s&lt;/em&gt; has to be set at least to &lt;em&gt;%s&lt;/em&gt;!', WCPGSK_DOMAIN), $forLabel, $mindate ) . '&lt;/strong&gt;');                        &nbsp;</div></li><li><div>                                  endif;                                &nbsp;</div></li><li><div>                              else :    &nbsp;</div></li><li><div>                                  if ( $daydiff &lt; $params['mindays'] ) :&nbsp;</div></li><li><div>                                      if ( isset($options['woofields']['label_' . $key]) && !empty($options['woofields']['label_' . $key]) ) :&nbsp;</div></li><li><div>                                          $forLabel = __($options['woofields']['label_' . $key], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                                      endif;&nbsp;</div></li><li><div>                                      $mindate = date('Y/m/d', strtotime(date(&quot;Y-m-d&quot;) . ' + ' . $params['mindays'] . ' days'));&nbsp;</div></li><li><div>                                      wcpgsk_add_error(  '&lt;strong&gt;' . sprintf(__('Date value for &lt;em style=&quot;color:red&quot;&gt;%s&lt;/em&gt; has to be set at least to &lt;em&gt;%s&lt;/em&gt;!', WCPGSK_DOMAIN), $forLabel, $mindate ) . '&lt;/strong&gt;');                        &nbsp;</div></li><li><div>                                  endif;&nbsp;</div></li><li><div>                              endif;&nbsp;</div></li><li><div>                          elseif ( isset($params) && isset($params['mindays']) && !empty($params['mindays']) ) :&nbsp;</div></li><li><div>                              $forLabel = '';&nbsp;</div></li><li><div>                              $mindays = $params['mindays'];&nbsp;</div></li><li><div>                              if ( isset($params['dateformat']) && !empty($params['dateformat']) ) :&nbsp;</div></li><li><div>                                  if ( $params['dateformat'] == 'dd/mm/yy' ) :&nbsp;</div></li><li><div>                                      $arrdate = explode('/', $params['mindays']);&nbsp;</div></li><li><div>                                      $mindays = $arrdate[2].'/'.$arrdate[1].'/'.$arrdate[0];&nbsp;</div></li><li><div>                                  elseif ( $params['dateformat'] == 'mm/dd/yy' ) :&nbsp;</div></li><li><div>                                      $arrdate = explode('/', $params['mindays']);&nbsp;</div></li><li><div>                                      $mindays = $arrdate[2].'/'.$arrdate[0].'/'.$arrdate[1];                                &nbsp;</div></li><li><div>                                  endif;&nbsp;</div></li><li><div>                              endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( $_POST[$key] &lt; $mindays ) :&nbsp;</div></li><li><div>                                  if ( isset($options['woofields']['label_' . $key]) && !empty($options['woofields']['label_' . $key]) ) :&nbsp;</div></li><li><div>                                      $forLabel = __($options['woofields']['label_' . $key], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                                  endif;&nbsp;</div></li><li><div>                                  wcpgsk_add_error(  '&lt;strong&gt;' . sprintf(__('Date value for &lt;em style=&quot;color:red&quot;&gt;%s&lt;/em&gt; has to be set at least to &lt;em&gt;%s&lt;/em&gt;!', WCPGSK_DOMAIN), $forLabel, $params['mindays'] ) . '&lt;/strong&gt;');                        &nbsp;</div></li><li><div>                              endif;                                &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                          if ( isset($params) && isset($params['maxdays']) && !empty($params['maxdays']) && ( ctype_digit( strval( $params['maxdays'] ) ) || is_numeric( strval( $params['maxdays'] ) ) ) ) :&nbsp;</div></li><li><div>                              $forLabel = '';&nbsp;</div></li><li><div>                              $daydiff = $this-&gt;datediffdays($_POST[$key]);&nbsp;</div></li><li><div>                              if ( $params['maxdays'] &lt; 0 ) :&nbsp;</div></li><li><div>                                  if ( $daydiff &gt; $params['maxdays'] ) :&nbsp;</div></li><li><div>                                      if ( isset($options['woofields']['label_' . $key]) && !empty($options['woofields']['label_' . $key]) ) :&nbsp;</div></li><li><div>                                          $forLabel = __($options['woofields']['label_' . $key], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                                      endif;&nbsp;</div></li><li><div>                                      $maxdate = date('Y/m/d', strtotime(date(&quot;Y-m-d&quot;) . ' - ' . ( absint( $params['maxdays'] - 1 ) ) . ' days'));&nbsp;</div></li><li><div>                                      wcpgsk_add_error(  '&lt;strong&gt;' . sprintf(__('Date value for &lt;em style=&quot;color:red&quot;&gt;%s&lt;/em&gt; has to be priorrrr to &lt;em&gt;%s&lt;/em&gt;!', WCPGSK_DOMAIN), $forLabel, $maxdate ) . '&lt;/strong&gt;');&nbsp;</div></li><li><div>                                  endif;                                    &nbsp;</div></li><li><div>                              else :&nbsp;</div></li><li><div>                                  if ( $daydiff &gt; $params['maxdays'] ) :&nbsp;</div></li><li><div>                                      if ( isset($options['woofields']['label_' . $key]) && !empty($options['woofields']['label_' . $key]) ) :&nbsp;</div></li><li><div>                                          $forLabel = __($options['woofields']['label_' . $key], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                                      endif;&nbsp;</div></li><li><div>                                      $maxdate = date('Y/m/d', strtotime(date(&quot;Y-m-d&quot;) . ' + ' . ($params['maxdays'] + 1) . ' days'));&nbsp;</div></li><li><div>                                      wcpgsk_add_error(  '&lt;strong&gt;' . sprintf(__('Date value for &lt;em style=&quot;color:red&quot;&gt;%s&lt;/em&gt; has to be prior to &lt;em&gt;%s&lt;/em&gt;!', WCPGSK_DOMAIN), $forLabel, $maxdate ) . '&lt;/strong&gt;');                        &nbsp;</div></li><li><div>                                  endif;&nbsp;</div></li><li><div>                              endif;&nbsp;</div></li><li><div>                          elseif ( isset($params) && isset($params['maxdays']) && !empty($params['maxdays']) ) :&nbsp;</div></li><li><div>                              $forLabel = '';&nbsp;</div></li><li><div>                              $maxdays = $params['maxdays'];&nbsp;</div></li><li><div>                              if ( isset($params['dateformat']) && !empty($params['dateformat']) ) :&nbsp;</div></li><li><div>                                  if ( $params['dateformat'] == 'dd/mm/yy' ) :&nbsp;</div></li><li><div>                                      $arrdate = explode('/', $params['maxdays']);&nbsp;</div></li><li><div>                                      $maxdays = $arrdate[2].'/'.$arrdate[1].'/'.$arrdate[0];&nbsp;</div></li><li><div>                                  elseif ( $params['dateformat'] == 'mm/dd/yy' ) :&nbsp;</div></li><li><div>                                      $arrdate = explode('/', $params['maxdays']);&nbsp;</div></li><li><div>                                      $maxdays = $arrdate[2].'/'.$arrdate[0].'/'.$arrdate[1];                                &nbsp;</div></li><li><div>                                  endif;&nbsp;</div></li><li><div>                              endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                              if ( $_POST[$key] &gt; $maxdays ) :&nbsp;</div></li><li><div>                                  if ( isset($options['woofields']['label_' . $key]) && !empty($options['woofields']['label_' . $key]) ) :&nbsp;</div></li><li><div>                                      $forLabel = __($options['woofields']['label_' . $key], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                                  endif;&nbsp;</div></li><li><div>                                  wcpgsk_add_error(  '&lt;strong&gt;' . sprintf(__('Date value for &lt;em style=&quot;color:red&quot;&gt;%s&lt;/em&gt; has to be prior to &lt;em&gt;%s&lt;/em&gt;!', WCPGSK_DOMAIN), $forLabel, $params['maxdays'] ) . '&lt;/strong&gt;');                        &nbsp;</div></li><li><div>                              endif;                                &nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                      else :&nbsp;</div></li><li><div>                          $forLabel = '';&nbsp;</div></li><li><div>                          if ( isset($options['woofields']['label_' . $key]) && !empty($options['woofields']['label_' . $key]) ) :&nbsp;</div></li><li><div>                              $forLabel = __($options['woofields']['label_' . $key], WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                          endif;&nbsp;</div></li><li><div>                          wcpgsk_add_error(  '&lt;strong&gt;' . sprintf(__('You have to supply a valid date for &lt;em style=&quot;color:red&quot;&gt;%s&lt;/em&gt; using the format year/month/day, e.g. 2014/12/24', WCPGSK_DOMAIN), $forLabel ) . '&lt;/strong&gt;');                                                &nbsp;</div></li><li><div>                      endif;&nbsp;</div></li><li><div>                  elseif ( $options['woofields']['type_' . $key] == 'select' ) :&nbsp;</div></li><li><div>                      <span class="comment">//if ( is_array($key) ) :</span>&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment"><span class="comment">//endif;</span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  $combine[$key] = array();&nbsp;</div></li><li><div>                  if (is_array($_POST[$key])) {&nbsp;</div></li><li><div>                      foreach($_POST[$key] as $value) {&nbsp;</div></li><li><div>                          $combine[$key][] = esc_attr($value);&nbsp;</div></li><li><div>                      }                                    &nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  else $combine[$key][] = esc_attr($val);&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          foreach($combine as $key =&gt; $val) {&nbsp;</div></li><li><div>              $_POST[$key] = implode('|', $val);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      function wcpgsk_checkout_update_order_meta( $order_id, $posted ) {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          global $wcpgsk_session;&nbsp;</div></li><li><div>          if ( function_exists('WC') ) :&nbsp;</div></li><li><div>              WC()-&gt;session-&gt;set('post', $_POST);&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              $wcpgsk_session-&gt;post = $_POST;&nbsp;</div></li><li><div>          endif;            &nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          foreach($posted as $key =&gt; $val) :&nbsp;</div></li><li><div>              if ( ( isset($options['woofields']['billing'][$key]['custom_' . $key]) && $options['woofields']['billing'][$key]['custom_' . $key] ) || ( isset( $options['woofields']['shipping'][$key]['custom_' . $key] ) && $options['woofields']['shipping'][$key]['custom_' . $key] ) ) :&nbsp;</div></li><li><div>                  if ( !isset( $options['woofields']['customeronly_' . $key] ) || ( isset( $options['woofields']['customeronly_' . $key] ) && $options['woofields']['customeronly_' . $key] == 0 ) ) :&nbsp;</div></li><li><div>                      update_post_meta( $order_id, &quot;_&quot; . $key, $val );&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>          endforeach;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      public function createCustomStandardField($customkey, $context, $type) {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $clear = false;&nbsp;</div></li><li><div>          $field = array();&nbsp;</div></li><li><div>          if (isset($options['woofields'][$context]) && is_array($options['woofields'][$context])) {&nbsp;</div></li><li><div>              $params = $this-&gt;explodeParameters($options['woofields']['settings_' . $customkey]);&nbsp;</div></li><li><div>              $custom_attributes = array();&nbsp;</div></li><li><div>              $seloptions = array();&nbsp;</div></li><li><div>              $selected = null;&nbsp;</div></li><li><div>              $clear = $options['woofields']['class_' . $customkey] == 'form-row-last' ? true : false;&nbsp;</div></li><li><div>              $validate = array();&nbsp;</div></li><li><div>              $display = '';&nbsp;</div></li><li><div>              $default = '';&nbsp;</div></li><li><div>              $class = array( $options['woofields']['class_' . $customkey] );&nbsp;</div></li><li><div>              if ( isset( $options['checkoutform']['cssclass'] ) && !empty( $options['checkoutform']['cssclass'] ) ) :&nbsp;</div></li><li><div>                  $class = array_merge( $class, array_map( &quot;sanitize_html_class&quot;, explode( ' ', $options['checkoutform']['cssclass'] ) ) );&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              if (is_array($params) && !empty($params)) {&nbsp;</div></li><li><div>                  foreach($params as $key =&gt; $value) {&nbsp;</div></li><li><div>                      switch($key) {&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//does not make much sense as validation class is not really available in woocommerce</span></span>&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//we put this as a parameter</span></span>&nbsp;</div></li><li><div>                          case 'validate':&nbsp;</div></li><li><div>                              if ( $value && $value == 'password' ) :&nbsp;</div></li><li><div>                                  $type = 'password';&nbsp;</div></li><li><div>                                  $validate = array();&nbsp;</div></li><li><div>                              elseif ( !empty($value) ) :&nbsp;</div></li><li><div>                                  $custom_attributes[$key] = $value;&nbsp;</div></li><li><div>                                  $validate = array($value);&nbsp;</div></li><li><div>                              endif;&nbsp;</div></li><li><div>                              break;&nbsp;</div></li><li><div>                          case 'options':&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                              foreach($value as $keyval =&gt; $option) {&nbsp;</div></li><li><div>                                  $seloptions[$keyval] = __($option, WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              break;&nbsp;</div></li><li><div>                          case 'selected':&nbsp;</div></li><li><div>                              if ( !empty($value) ) :&nbsp;</div></li><li><div>                                  foreach($value as $keyval =&gt; $option) {&nbsp;</div></li><li><div>                                      <span class="comment"><span class="comment">//if (!empty($option) || $value == 0) $selected = $option;</span></span>&nbsp;</div></li><li><div>                                      if (!empty($keyval)) $selected = $keyval;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              endif;&nbsp;</div></li><li><div>                              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          case 'multiple':&nbsp;</div></li><li><div>                              if ($value == 1) $custom_attributes[$key] = 'multiple';&nbsp;</div></li><li><div>                              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          case 'value':&nbsp;</div></li><li><div>                              if (!empty($value) || $value === 0 || $value === '0') $default = $value;&nbsp;</div></li><li><div>                              break;&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          case 'repeat_field':&nbsp;</div></li><li><div>                              <span class="comment">//not necessary here?</span>&nbsp;</div></li><li><div>                              break;&nbsp;</div></li><li><div>                          default:&nbsp;</div></li><li><div>                              if (!empty($value) || $value === 0 || $value === '0')&nbsp;</div></li><li><div>                                  $custom_attributes[$key] = $value;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $options['woofields']['label_' . $customkey] = !empty($options['woofields']['label_' . $customkey]) ? $options['woofields']['label_' . $customkey] : '';&nbsp;</div></li><li><div>              $options['woofields']['placeholder_' . $customkey] = !empty($options['woofields']['placeholder_' . $customkey]) ? $options['woofields']['placeholder_' . $customkey] : '';&nbsp;</div></li><li><div>              $options['woofields']['required_' . $customkey] = isset($options['woofields']['required_' . $customkey]) && $options['woofields']['required_' . $customkey] == 1 ? 1 : 0; &nbsp;</div></li><li><div>              switch($type) {&nbsp;</div></li><li><div>                  case 'password':&nbsp;</div></li><li><div>                      $custom_attributes['display'] = 'text';&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'password', &nbsp;</div></li><li><div>                          'label' =&gt; __( $options['woofields']['label_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; (($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'class' =&gt; $class, &nbsp;</div></li><li><div>                          'validate' =&gt; $validate, &nbsp;</div></li><li><div>                          'clear' =&gt; $clear&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  case 'text':&nbsp;</div></li><li><div>                      $custom_attributes['display'] = 'text';&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'text', &nbsp;</div></li><li><div>                          'label' =&gt; __( $options['woofields']['label_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; (($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'class' =&gt; $class, &nbsp;</div></li><li><div>                          'validate' =&gt; $validate, &nbsp;</div></li><li><div>                          'clear' =&gt; $clear&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  case 'number':&nbsp;</div></li><li><div>                      $custom_attributes['display'] = 'number';&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'text', &nbsp;</div></li><li><div>                          'label' =&gt; __( $options['woofields']['label_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; ( ($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'default' =&gt; $default, &nbsp;</div></li><li><div>                          'class' =&gt; $class, &nbsp;</div></li><li><div>                          'validate' =&gt; $validate, &nbsp;</div></li><li><div>                          'clear' =&gt; $clear&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                  case 'date':&nbsp;</div></li><li><div>                      $custom_attributes['display'] = 'date';&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'text', &nbsp;</div></li><li><div>                          'label' =&gt; __( $options['woofields']['label_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; ( ($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'class' =&gt; $class, &nbsp;</div></li><li><div>                          'validate' =&gt; array('date'), &nbsp;</div></li><li><div>                          'clear' =&gt; $clear&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      case 'time':&nbsp;</div></li><li><div>                      $custom_attributes['display'] = 'time';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'text', &nbsp;</div></li><li><div>                          'label' =&gt; __( $options['woofields']['label_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; ( ($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'class' =&gt; $class, &nbsp;</div></li><li><div>                          'validate' =&gt; array('time'), &nbsp;</div></li><li><div>                          'clear' =&gt; $clear&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      case 'textarea':&nbsp;</div></li><li><div>                      $custom_attributes['display'] = 'textarea';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'textarea', &nbsp;</div></li><li><div>                          'label' =&gt; __( $options['woofields']['label_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; ( ($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'class' =&gt; $class, &nbsp;</div></li><li><div>                          'validate' =&gt; $validate, &nbsp;</div></li><li><div>                          'clear' =&gt; $clear&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      case 'select':&nbsp;</div></li><li><div>                      $custom_attributes['display'] = $display;&nbsp;</div></li><li><div>                      $custom_attributes['hasselected'] = !empty($selected) ? 'true' : 'false';&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'select', &nbsp;</div></li><li><div>                          'label' =&gt; __( $options['woofields']['label_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; ( ($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'options' =&gt; $seloptions, &nbsp;</div></li><li><div>                          'default' =&gt; $selected, &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'class' =&gt; $class, &nbsp;</div></li><li><div>                          'validate' =&gt; $validate, &nbsp;</div></li><li><div>                          'clear' =&gt; $clear                    &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                      default:&nbsp;</div></li><li><div>                      $custom_attributes['display'] = $display;&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; $type, &nbsp;</div></li><li><div>                          'label' =&gt; __( $options['woofields']['label_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; ( ($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'class' =&gt; $class, &nbsp;</div></li><li><div>                          'validate' =&gt; $validate, &nbsp;</div></li><li><div>                          'clear' =&gt; $clear&nbsp;</div></li><li><div> );                        &nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              <span class="comment">//apply_filters('wcpgsk_create_custom_standard_field', $field, </span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return apply_filters('wcpgsk_create_custom_standard_field', $field);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function createCustomStandardFieldClone($customkey, $context, $type) {&nbsp;</div></li><li><div>          $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          $clear = false;&nbsp;</div></li><li><div>          $field = array();&nbsp;</div></li><li><div>          if (isset($options['woofields'][$context]) && is_array($options['woofields'][$context])) {&nbsp;</div></li><li><div>              $params = $this-&gt;explodeParameters($options['woofields']['settings_' . $customkey]);&nbsp;</div></li><li><div>              $custom_attributes = array();&nbsp;</div></li><li><div>              $seloptions = array();&nbsp;</div></li><li><div>              $selected = null;&nbsp;</div></li><li><div>              $clear = $options['woofields']['class_' . $customkey] == 'form-row-first' ? true : false;&nbsp;</div></li><li><div>              $validate = array();&nbsp;</div></li><li><div>              $display = '';&nbsp;</div></li><li><div>              $default = '';&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if (is_array($params) && !empty($params)) {&nbsp;</div></li><li><div>                  foreach($params as $key =&gt; $value) {&nbsp;</div></li><li><div>                      switch($key) {&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//does not make much sense as validation class is not really available in woocommerce</span></span>&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//we put this as a parameter</span></span>&nbsp;</div></li><li><div>                          case 'validate':&nbsp;</div></li><li><div>                              if ( $value && $value == 'password' ) :&nbsp;</div></li><li><div>                                  $type = 'password';&nbsp;</div></li><li><div>                                  $validate = array();&nbsp;</div></li><li><div>                              elseif ( !empty($value) ) :&nbsp;</div></li><li><div>                                  $custom_attributes[$key] = $value;&nbsp;</div></li><li><div>                                  $validate = array($value);&nbsp;</div></li><li><div>                              endif;&nbsp;</div></li><li><div>                              break;&nbsp;</div></li><li><div>                          case 'options':&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>                              foreach($value as $keyval =&gt; $option) {&nbsp;</div></li><li><div>                                  $seloptions[$keyval] = __($option, WCPGSK_DOMAIN);&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              break;&nbsp;</div></li><li><div>                          case 'selected':&nbsp;</div></li><li><div>                              if ( !empty($value) ) :&nbsp;</div></li><li><div>                                  foreach($value as $keyval =&gt; $option) {&nbsp;</div></li><li><div>                                      <span class="comment"><span class="comment">//if (!empty($option) || $value == 0) $selected = $option;</span></span>&nbsp;</div></li><li><div>                                      if (!empty($keyval)) $selected = $keyval;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              endif;&nbsp;</div></li><li><div>                              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          case 'multiple':&nbsp;</div></li><li><div>                              if ($value == 1) $custom_attributes[$key] = 'multiple';&nbsp;</div></li><li><div>                              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          case 'value':&nbsp;</div></li><li><div>                              if (!empty($value) || $value === 0 || $value === '0') $default = $value;&nbsp;</div></li><li><div>                              break;&nbsp;</div></li><li><div>                          &nbsp;</div></li><li><div>                          default:&nbsp;</div></li><li><div>                              if (!empty($value) || $value === 0 || $value === '0')&nbsp;</div></li><li><div>                                  $custom_attributes[$key] = $value;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              <span class="comment">//$options['woofields']['label_' . $customkey] = !empty($options['woofields']['label_' . $customkey]) ? $options['woofields']['label_' . $customkey] : '';</span>&nbsp;</div></li><li><div>              $options['woofields']['placeholder_' . $customkey] = !empty($options['woofields']['placeholder_' . $customkey]) ? $options['woofields']['placeholder_' . $customkey] : '';&nbsp;</div></li><li><div>              $options['woofields']['required_' . $customkey] = isset($options['woofields']['required_' . $customkey]) && $options['woofields']['required_' . $customkey] == 1 ? 1 : 0; &nbsp;</div></li><li><div>              $clone_class = array( 'form-row-wide' );&nbsp;</div></li><li><div>              if ($options['woofields']['class_' . $customkey] == 'form-row-first') $clone_class = array( 'form-row-last' );&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if ( isset( $options['checkoutform']['cssclass'] ) && !empty( $options['checkoutform']['cssclass'] ) ) :&nbsp;</div></li><li><div>                  $clone_class = array_merge( $clone_class, array_map( &quot;sanitize_html_class&quot;, explode( ' ', $options['checkoutform']['cssclass'] ) ) );&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              $clone_label = __('Repeat value', WCPGSK_DOMAIN);&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              switch($type) {&nbsp;</div></li><li><div>                  case 'password':&nbsp;</div></li><li><div>                      $custom_attributes['display'] = 'text';&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'password', &nbsp;</div></li><li><div>                          'label' =&gt; $clone_label, &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; (($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'class' =&gt; $clone_class, &nbsp;</div></li><li><div>                          'validate' =&gt; $validate, &nbsp;</div></li><li><div>                          'clear' =&gt; $clear&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  case 'text':&nbsp;</div></li><li><div>                      $custom_attributes['display'] = 'text';&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'text', &nbsp;</div></li><li><div>                          'label' =&gt; $clone_label, &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; (($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'class' =&gt; $clone_class, &nbsp;</div></li><li><div>                          'validate' =&gt; $validate, &nbsp;</div></li><li><div>                          'clear' =&gt; $clear&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  case 'number':&nbsp;</div></li><li><div>                      $custom_attributes['display'] = 'number';&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'text', &nbsp;</div></li><li><div>                          'label' =&gt; $clone_label, &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; ( ($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'default' =&gt; $default, &nbsp;</div></li><li><div>                          'class' =&gt; $clone_class, &nbsp;</div></li><li><div>                          'validate' =&gt; $validate, &nbsp;</div></li><li><div>                          'clear' =&gt; $clear&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                  case 'date':&nbsp;</div></li><li><div>                      $custom_attributes['display'] = 'date';&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'text', &nbsp;</div></li><li><div>                          'label' =&gt; $clone_label, &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; ( ($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'class' =&gt; $clone_class, &nbsp;</div></li><li><div>                          'validate' =&gt; array('date'), &nbsp;</div></li><li><div>                          'clear' =&gt; $clear&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      case 'time':&nbsp;</div></li><li><div>                      $custom_attributes['display'] = 'time';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'text', &nbsp;</div></li><li><div>                          'label' =&gt; $clone_label, &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; ( ($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'class' =&gt; $clone_class, &nbsp;</div></li><li><div>                          'validate' =&gt; array('time'), &nbsp;</div></li><li><div>                          'clear' =&gt; $clear&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      case 'textarea':&nbsp;</div></li><li><div>                      $custom_attributes['display'] = 'textarea';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'textarea', &nbsp;</div></li><li><div>                          'label' =&gt; $clone_label, &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; ( ($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'class' =&gt; $clone_class, &nbsp;</div></li><li><div>                          'validate' =&gt; $validate, &nbsp;</div></li><li><div>                          'clear' =&gt; $clear&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      case 'select':&nbsp;</div></li><li><div>                      $custom_attributes['display'] = $display;&nbsp;</div></li><li><div>                      $field = array(&nbsp;</div></li><li><div>                          'type' =&gt; 'select', &nbsp;</div></li><li><div>                          'label' =&gt; $clone_label, &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( $options['woofields']['placeholder_' . $customkey], WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                          'required' =&gt; ( ($options['woofields']['required_' . $customkey] == 1) ? true : false), &nbsp;</div></li><li><div>                          'options' =&gt; $seloptions, &nbsp;</div></li><li><div>                          'default' =&gt; $selected, &nbsp;</div></li><li><div>                          'custom_attributes' =&gt; $custom_attributes, &nbsp;</div></li><li><div>                          'class' =&gt; $clone_class, &nbsp;</div></li><li><div>                          'validate' =&gt; $validate, &nbsp;</div></li><li><div>                          'clear' =&gt; $clear                    &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $field;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      private function explodeParameters($settings) {&nbsp;</div></li><li><div>          $params = array();&nbsp;</div></li><li><div>          foreach (explode('&', $settings) as $chunk) {&nbsp;</div></li><li><div>              $param = explode(&quot;=&quot;, $chunk);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ($param) {&nbsp;</div></li><li><div>                  $key =  str_replace('wcpgsk_add_', '', urldecode($param[0]));&nbsp;</div></li><li><div>                  if (!empty($key))&nbsp;</div></li><li><div>                      $params[$key] = urldecode($param[1]);&nbsp;</div></li><li><div>                  $new_choices = array();&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  <span class="comment">// explode choices from each line</span>&nbsp;</div></li><li><div>                  if( isset($params[$key]) && $params[$key] && (strpos($key, 'options') !== false || strpos($key, 'selected') !== false) )&nbsp;</div></li><li><div>                  {&nbsp;</div></li><li><div>                      <span class="comment">// stripslashes (&quot;&quot;)</span>&nbsp;</div></li><li><div>                      $params[$key] = stripslashes_deep($params[$key]);&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                      if(strpos($params[$key], &quot;\n&quot;) !== false)&nbsp;</div></li><li><div>                      {&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">// found multiple lines, explode it</span></span>&nbsp;</div></li><li><div>                          $params[$key] = explode(&quot;\n&quot;, $params[$key]);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      else&nbsp;</div></li><li><div>                      {&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">// no multiple lines! </span></span>&nbsp;</div></li><li><div>                          $params[$key] = array($params[$key]);&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                                      &nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">// key =&gt; value</span></span>&nbsp;</div></li><li><div>                      foreach($params[$key] as $line)&nbsp;</div></li><li><div>                      {&nbsp;</div></li><li><div>                          if(strpos($line, ' : ') !== false)&nbsp;</div></li><li><div>                          {&nbsp;</div></li><li><div>                              $option = explode(' : ', $line);&nbsp;</div></li><li><div>                              $new_choices[ trim($option[0]) ] = trim($option[1]);&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          else&nbsp;</div></li><li><div>                          {&nbsp;</div></li><li><div>                              $new_choices[ trim($line) ] = trim($line);&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      <span class="comment"><span class="comment">// update options</span></span>&nbsp;</div></li><li><div>                      $params[$key] = $new_choices;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $params;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function explodeAttribute($param) {&nbsp;</div></li><li><div>          $params = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ($param) {&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if(strpos($param, &quot;\n&quot;) !== false)&nbsp;</div></li><li><div>              {&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// found multiple lines, explode it</span></span>&nbsp;</div></li><li><div>                  $params[0] = explode(&quot;\n&quot;, $param);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              else&nbsp;</div></li><li><div>              {&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// no multiple lines! </span></span>&nbsp;</div></li><li><div>                  $params[0] = array($param);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>                              &nbsp;</div></li><li><div>              <span class="comment"><span class="comment">// key =&gt; value</span></span>&nbsp;</div></li><li><div>              foreach($params[0] as $line)&nbsp;</div></li><li><div>              {&nbsp;</div></li><li><div>                  if(strpos($line, ' : ') !== false)&nbsp;</div></li><li><div>                  {&nbsp;</div></li><li><div>                      $option = explode(' : ', $line);&nbsp;</div></li><li><div>                      $new_choices[ trim($option[0]) ] = trim($option[1]);&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  else&nbsp;</div></li><li><div>                  {&nbsp;</div></li><li><div>                      $new_choices[ trim($line) ] = trim($line);&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              <span class="comment"><span class="comment">// update options</span></span>&nbsp;</div></li><li><div>              $params[0] = $new_choices;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $params;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Helper function to calculate difference in days (php &lt; 5.3 compatible) </span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $formdate </span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.7.1</span>&nbsp;</div></li><li><div><span class="comment">       * @return int $days</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      public function datediffdays($formdate) {&nbsp;</div></li><li><div>          $dateSplits = explode(&quot;/&quot;, $formdate);&nbsp;</div></li><li><div>          $date1 =  strtotime(date('Y-m-d'));&nbsp;</div></li><li><div>          $date2 =  mktime(0, 0, 0, (int)$dateSplits[1], (int)$dateSplits[2], (int)$dateSplits[0]);&nbsp;</div></li><li><div>          $days = ($date2 - $date1)/(3600*24);&nbsp;</div></li><li><div>          <span class="comment">// returns numberofdays</span>&nbsp;</div></li><li><div>          return $days;         &nbsp;</div></li><li><div>      }     &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Helper function to validate a date (php &lt; 5.3 compatible) </span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $formdate </span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.7.1</span>&nbsp;</div></li><li><div><span class="comment">       * @return int $days</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      function ValidateDate($formdate, $format = 'Y-m-d') {&nbsp;</div></li><li><div>          $version = explode('.', phpversion());&nbsp;</div></li><li><div>          $dateSplits = explode(&quot;/&quot;, $formdate);&nbsp;</div></li><li><div>          if ( count($dateSplits) == 3 ) :&nbsp;</div></li><li><div>              return checkdate($dateSplits[1], $dateSplits[2], $dateSplits[0]);&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              return false;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }        &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Our admin menu and admin scripts</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return void</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_admin_menu() {&nbsp;</div></li><li><div>          <span class="comment">// Add a new submenu under Woocommerce:</span>&nbsp;</div></li><li><div>          global $wcpgsk_name;&nbsp;</div></li><li><div>          $wcpgsk_name = apply_filters('wcpgsk_plus_name', $wcpgsk_name);&nbsp;</div></li><li><div>          add_submenu_page( 'woocommerce' , __( $wcpgsk_name, WCPGSK_DOMAIN ), __( $wcpgsk_name, WCPGSK_DOMAIN ), 'manage_options', WCPGSK_DOMAIN, array($this, 'wcpgsk__options_page') );&nbsp;</div></li><li><div>          add_action( 'admin_enqueue_scripts', array($this, 'wcpgsk_admin_scripts') );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Our admin scripts</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return void</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_admin_scripts( $hook_suffix ) {&nbsp;</div></li><li><div>          if ( $hook_suffix == 'woocommerce_page_wcpgsk' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if( !wp_script_is('jquery-ui-accordion', 'queue') ) {&nbsp;</div></li><li><div>                  wp_enqueue_script('jquery-ui-accordion');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              wp_enqueue_script( 'wcpgsk_admin', plugins_url( '/assets/js/wcpgsk_admin.js', $this-&gt;file ), '', '' );&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if(!wp_script_is('jquery-ui-sortable', 'queue')) {&nbsp;</div></li><li><div>                      wp_enqueue_script('jquery-ui-sortable');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if(!wp_script_is('jquery-ui-dialog', 'queue')) {&nbsp;</div></li><li><div>                      wp_enqueue_script('jquery-ui-dialog');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              wp_enqueue_script( 'chosen-order', plugins_url( '/assets/js/chosen.order.jquery.min.js', $this-&gt;file ), '', '' );&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              wp_register_script('accordion-js', plugins_url( '/assets/js/accordion.js', $this-&gt;file ), '', '', false);&nbsp;</div></li><li><div>              wp_register_style('accordion-styles', plugins_url( '/assets/css/accordion_styles.css', $this-&gt;file ), '', '');&nbsp;</div></li><li><div>              wp_register_style('wcpgsk-styles', plugins_url( '/assets/css/wcpgsk_styles.css', $this-&gt;file ), '', '');&nbsp;</div></li><li><div>       &nbsp;</div></li><li><div>              wp_enqueue_script( 'accordion-js' );&nbsp;</div></li><li><div>              wp_enqueue_style( 'accordion-styles' );&nbsp;</div></li><li><div>              wp_enqueue_style( 'wcpgsk-styles' );&nbsp;</div></li><li><div>              <span class="comment">// Include in admin_enqueue_scripts action hook</span>&nbsp;</div></li><li><div>              wp_enqueue_media();&nbsp;</div></li><li><div>              wp_enqueue_script( 'custom-header' );        &nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Run on activation.</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return void</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function activation() {&nbsp;</div></li><li><div>          $this-&gt;register_plugin_version();&nbsp;</div></li><li><div>          global $wcpgsk_options;&nbsp;</div></li><li><div>          $this-&gt;wcpgsk_initial_settings();            &nbsp;</div></li><li><div>      } <span class="comment">// End activation()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Register the plugin's version.</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return void</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      private function register_plugin_version () {&nbsp;</div></li><li><div>          if ( $this-&gt;version != '' ) {&nbsp;</div></li><li><div>              update_option( WCPGSK_DOMAIN . '-version', $this-&gt;version );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      } <span class="comment">// End register_plugin_version()</span>&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">// Plugin links</span>&nbsp;</div></li><li><div>      public function wcpgsk_admin_plugin_actions($links) {&nbsp;</div></li><li><div>          $wcpgsk_links = array(&nbsp;</div></li><li><div>              '&lt;a href=&quot;admin.php?page=' . WCPGSK_DOMAIN . '&quot;&gt;'.__('Settings').'&lt;/a&gt;', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          return array_merge( $wcpgsk_links, $links );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Initial settings for our plugin</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @changed 1.6.2 add wcpgsk default settings for billing and shipping fields</span>&nbsp;</div></li><li><div><span class="comment">       * @return void</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      private function wcpgsk_initial_settings() {&nbsp;</div></li><li><div>          global $woocommerce;&nbsp;</div></li><li><div>          $options = get_option('wcpgsk_settings');&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          if ( !$options ) :&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              $defaults = array( &nbsp;</div></li><li><div>                  'filters' =&gt; array(&nbsp;</div></li><li><div>                      'loop_shop_per_page' =&gt; get_option( 'posts_per_page' ), &nbsp;</div></li><li><div>                      'loop_shop_columns' =&gt; '4', &nbsp;</div></li><li><div>                      'woocommerce_product_thumbnails_columns' =&gt; '3', &nbsp;</div></li><li><div>                      'woocommerce_product_description_tab_title' =&gt; __('Description', 'woocommerce'), &nbsp;</div></li><li><div>                      'woocommerce_product_description_heading' =&gt; __( 'Product Description', 'woocommerce' ), &nbsp;</div></li><li><div>                      'woocommerce_product_additional_information_tab_title' =&gt; __('Additional Information', 'woocommerce'), &nbsp;</div></li><li><div>                      'woocommerce_product_additional_information_heading' =&gt; __( 'Additional Information', 'woocommerce' ), &nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      'woocommerce_checkout_must_be_logged_in_message' =&gt; __( 'You must be logged in to checkout.', 'woocommerce' ), &nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      'woocommerce_checkout_login_message' =&gt; __( 'Returning customer?', 'woocommerce' ), &nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      'woocommerce_checkout_coupon_message' =&gt; __( 'Have a coupon?', 'woocommerce' ), &nbsp;</div></li><li><div>                      'woocommerce_checkout_coupon_link_message' =&gt; __( 'Click here to enter your code', 'woocommerce' ), &nbsp;</div></li><li><div>                      &nbsp;</div></li><li><div>                      'woocommerce_order_button_text' =&gt; __( 'Place order', 'woocommerce' ), &nbsp;</div></li><li><div>                      'woocommerce_pay_order_button_text' =&gt; __( 'Pay for order', 'woocommerce' ), &nbsp;</div></li><li><div>                      'woocommerce_thankyou_order_received_text' =&gt; __( 'Thank you. Your order has been received.', 'woocommerce' ), &nbsp;</div></li><li><div>                      'woocommerce_countries_tax_or_vat' =&gt; $this-&gt;WC()-&gt;countries-&gt;tax_or_vat(), &nbsp;</div></li><li><div>                      'woocommerce_countries_inc_tax_or_vat' =&gt; $this-&gt;WC()-&gt;countries-&gt;inc_tax_or_vat(), &nbsp;</div></li><li><div>                      'woocommerce_countries_ex_tax_or_vat' =&gt; $this-&gt;WC()-&gt;countries-&gt;ex_tax_or_vat(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'wcpgsk_forms' =&gt; array( array(&nbsp;</div></li><li><div>                      'label' =&gt; __( 'Label', WCPGSK_DOMAIN ), &nbsp;</div></li><li><div>                      'placeholder' =&gt; __( 'Placeholder', WCPGSK_DOMAIN ))), &nbsp;</div></li><li><div>                  'cart' =&gt; array(&nbsp;</div></li><li><div>                      'addemptycart' =&gt; 0, &nbsp;</div></li><li><div>                      'minmaxstepproduct' =&gt; 0, &nbsp;</div></li><li><div>                      'minitemscart' =&gt; 1, &nbsp;</div></li><li><div>                      'maxitemscart' =&gt; 3, &nbsp;</div></li><li><div>                      'minqtycart' =&gt; 0, &nbsp;</div></li><li><div>                      'maxqtycart' =&gt; 0, &nbsp;</div></li><li><div>                      'minvariationperproduct' =&gt; 1, &nbsp;</div></li><li><div>                      'maxvariationperproduct' =&gt; 1, &nbsp;</div></li><li><div>                      'maxqty_variation' =&gt; 0, &nbsp;</div></li><li><div>                      'minqty_variation' =&gt; 0, &nbsp;</div></li><li><div>                      'maxqty_variable' =&gt; 0, &nbsp;</div></li><li><div>                      'minqty_variable' =&gt; 0, &nbsp;</div></li><li><div>                      'maxqty_grouped' =&gt; 0, &nbsp;</div></li><li><div>                      'minqty_grouped' =&gt; 0, &nbsp;</div></li><li><div>                      'maxqty_external' =&gt; 0, &nbsp;</div></li><li><div>                      'minqty_external' =&gt; 0, &nbsp;</div></li><li><div>                      'maxqty_simple' =&gt; 0, &nbsp;</div></li><li><div>                      'minqty_simple' =&gt; 0, &nbsp;</div></li><li><div>                      'variationscountasproduct' =&gt; 0, &nbsp;</div></li><li><div>                      'variationproductnoqty' =&gt; 0, &nbsp;</div></li><li><div>                      'variableproductnoqty' =&gt; 0, &nbsp;</div></li><li><div>                      'groupedproductnoqty' =&gt; 0, &nbsp;</div></li><li><div>                      'externalproductnoqty' =&gt; 0, &nbsp;</div></li><li><div>                      'simpleproductnoqty' =&gt; 0), &nbsp;</div></li><li><div>                  'checkoutform' =&gt; array(&nbsp;</div></li><li><div>                      'cartitemforms' =&gt; 1, &nbsp;</div></li><li><div>                      'servicetitle' =&gt; __('Service data', WCPGSK_DOMAIN), &nbsp;</div></li><li><div>                      'serviceformmerge' =&gt; 'woocommerce_before_order_notes', &nbsp;</div></li><li><div>                      'sharedtitle' =&gt; __('Additional Information', WCPGSK_DOMAIN), &nbsp;</div></li><li><div>                      'sharedformmerge' =&gt; 'woocommerce_after_checkout_billing_form', &nbsp;</div></li><li><div>                      'tooltippersonalization' =&gt; '', &nbsp;</div></li><li><div>                      'billingemailvalidator' =&gt; 0, &nbsp;</div></li><li><div>                      'mindate' =&gt; 2, &nbsp;</div></li><li><div>                      'maxdate' =&gt; 450, &nbsp;</div></li><li><div>                      'caltimepicker' =&gt; 0, &nbsp;</div></li><li><div>                      'enabletooltips' =&gt; 1, &nbsp;</div></li><li><div>                      'enabletimesliders' =&gt; 1, &nbsp;</div></li><li><div>                      'cssclass' =&gt; ''), &nbsp;</div></li><li><div>                  'variations' =&gt; array(&nbsp;</div></li><li><div>                      'extendattributes' =&gt; 1, &nbsp;</div></li><li><div>                      'sortextendattributes' =&gt; 1), &nbsp;</div></li><li><div>                  'process' =&gt; array(&nbsp;</div></li><li><div>                      'fastcheckoutbtn' =&gt; '', &nbsp;</div></li><li><div>                      'fastcart' =&gt; 0, &nbsp;</div></li><li><div>                      'fastcheckout' =&gt; 0, &nbsp;</div></li><li><div>                      'paymentgateways' =&gt; 0, &nbsp;</div></li><li><div>                      'onsalelabel' =&gt; 'Sale!', &nbsp;</div></li><li><div>                      'backorderlabel' =&gt; '', &nbsp;</div></li><li><div>                      'emptycartlabel' =&gt; 'Empty cart?', &nbsp;</div></li><li><div>                      'confirmemptycart' =&gt; 'Yes, empty cart', &nbsp;</div></li><li><div>                      'empty_price_html' =&gt; ''), &nbsp;</div></li><li><div>                  'email' =&gt; array(&nbsp;</div></li><li><div>                      'wc_cc_email' =&gt; '', &nbsp;</div></li><li><div>                      'wc_bcc_email' =&gt; ''), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              <span class="comment">//add default woocommerce billing and shipping field settings to wcpgsk settings to fix the problem of fields not showing up after activation of our plugin</span>&nbsp;</div></li><li><div>              $checkout_fields = array_merge($woocommerce-&gt;countries-&gt;get_address_fields( $woocommerce-&gt;countries-&gt;get_base_country(), 'billing_' ), $woocommerce-&gt;countries-&gt;get_address_fields( $woocommerce-&gt;countries-&gt;get_base_country(), 'shipping_' ));&nbsp;</div></li><li><div>              foreach ($checkout_fields as $key =&gt; $field) : &nbsp;</div></li><li><div>                  $defaults['woofields']['placeholder_' . $key] = isset($checkout_fields[$key]['placeholder']) ? $checkout_fields[$key]['placeholder'] : '';&nbsp;</div></li><li><div>                  $defaults['woofields']['label_' . $key] = isset($checkout_fields[$key]['label']) ? $checkout_fields[$key]['label'] : '';&nbsp;</div></li><li><div>                  $defaults['woofields']['required_' . $key] = isset($checkout_fields[$key]['required']) ? $checkout_fields[$key]['required'] : 0;&nbsp;</div></li><li><div>                  $defaults['woofields']['remove_' . $key] = 0;&nbsp;</div></li><li><div>                  $defaults['woofields']['class_' . $key] = isset($checkout_fields[$key]['class']) ? $checkout_fields[$key]['class'][0] : 'form-row-wide';                &nbsp;</div></li><li><div>                  $defaults['woofields']['settings_' . $key] = '';&nbsp;</div></li><li><div>              endforeach;&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>              add_option( 'wcpgsk_settings', apply_filters( 'wcpgsk_defaults', $defaults ) );&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Load the plugin's localisation file.</span>&nbsp;</div></li><li><div><span class="comment">       * @access public</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return void</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function load_localisation () {&nbsp;</div></li><li><div>          load_plugin_textdomain( WCPGSK_DOMAIN, false, dirname( plugin_basename( $this-&gt;file ) ) . '/lang/' );&nbsp;</div></li><li><div>      } <span class="comment">// End load_localisation()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Load the plugin textdomain from the main WordPress &quot;languages&quot; folder.</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.1.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return  void</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function load_plugin_textdomain () {&nbsp;</div></li><li><div>          $domain = WCPGSK_DOMAIN;&nbsp;</div></li><li><div>          <span class="comment">// The &quot;plugin_locale&quot; filter is also used in load_plugin_textdomain()</span>&nbsp;</div></li><li><div>          $locale = apply_filters( 'plugin_locale', get_locale(), $domain );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          load_textdomain( $domain, WP_LANG_DIR . '/' . $domain . '/' . $domain . '-' . $locale . '.mo' );&nbsp;</div></li><li><div>          load_plugin_textdomain( $domain, FALSE, dirname( plugin_basename( $this-&gt;file ) ) . '/lang/' );&nbsp;</div></li><li><div>      } <span class="comment">// End load_plugin_textdomain()</span>&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      public function phpdie() {&nbsp;</div></li><li><div>          if (defined('PHPUNIT_TESTING')) {&nbsp;</div></li><li><div>              <span class="comment">//do nothing</span>&nbsp;</div></li><li><div>              <span class="comment">//throw new TestingPhpDieException();</span>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              die();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }    &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Optimize load by dequeue if not necessary.</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.9.0</span>&nbsp;</div></li><li><div><span class="comment">       * @changed 1.9.8</span>&nbsp;</div></li><li><div><span class="comment">       * @return  void</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function wcpgsk_handle_scripts() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }                &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Returns the WooCommerce instance</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.9.2</span>&nbsp;</div></li><li><div><span class="comment">       * @return WooCommerce woocommerce instance</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      private function WC() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( function_exists( 'WC' ) && !is_null( WC() ) ) :&nbsp;</div></li><li><div>              return WC();&nbsp;</div></li><li><div>          else :&nbsp;</div></li><li><div>              global $woocommerce;&nbsp;</div></li><li><div>              return $woocommerce;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Try to get rid of generator if not a WooCommerce page</span>&nbsp;</div></li><li><div><span class="comment">       * @since 1.9.0</span>&nbsp;</div></li><li><div><span class="comment">       * @return  void</span>&nbsp;</div></li><li><div><span class="comment">       */</span>        &nbsp;</div></li><li><div>      public function wcpgsk_degenerate() { &nbsp;</div></li><li><div>          global $wp_scripts;        &nbsp;</div></li><li><div>          <span class="comment">//first check that woo exists to prevent fatal errors</span>&nbsp;</div></li><li><div>          if ( function_exists( 'is_woocommerce' ) ) :&nbsp;</div></li><li><div>              $options = get_option( 'wcpgsk_settings' );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>              <span class="comment">//dequeue scripts and styles</span>&nbsp;</div></li><li><div>              if ( is_cart() ) :&nbsp;</div></li><li><div>                  wp_enqueue_script( 'wcpgsk-cart', plugins_url('/assets/js/wcpgsk-cart.js', $this-&gt;file) , array('jquery'), '', false);&nbsp;</div></li><li><div>                  wp_enqueue_style( 'wcpgsk-cart-css', plugins_url('/assets/css/wcpgsk-cart.css', $this-&gt;file) , array(), '');&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>              if ( is_checkout() || is_account_page() ) :&nbsp;</div></li><li><div>                  wp_enqueue_script( 'jquery-ui-dialog' );&nbsp;</div></li><li><div>                  wp_enqueue_script( 'jquery-ui-datepicker' );&nbsp;</div></li><li><div>                  wp_enqueue_script( 'jquery-ui-slider' );&nbsp;</div></li><li><div>                  wp_enqueue_script( 'jquery-ui-button' );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>                  wp_enqueue_script( 'jquery-ui-sliderAccess', plugins_url('/assets/js/jquery-ui-sliderAccess.js', $this-&gt;file) , '', '', false);&nbsp;</div></li><li><div>                  if ( isset( $options['checkoutform']['caltimepicker'] ) && 1 == $options['checkoutform']['caltimepicker'] ) :&nbsp;</div></li><li><div>                      wp_enqueue_style( 'jquery-ui-timepicker-css', plugins_url('/assets/css/jquery.ui.timepicker.css', $this-&gt;file) , array(), '');&nbsp;</div></li><li><div>                      wp_enqueue_script( 'jquery-ui-timepicker-addon', plugins_url('/assets/js/jquery.ui.timepicker.js', $this-&gt;file) , array('jquery'), '', true);                                            &nbsp;</div></li><li><div>                  else :&nbsp;</div></li><li><div>                      wp_enqueue_script( 'jquery-ui-timepicker-addon', plugins_url('/assets/js/jquery-ui-timepicker-addon.js', $this-&gt;file) , array('jquery'), '', true);&nbsp;</div></li><li><div>                  endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  wp_enqueue_script( 'wcpgsk-validate', plugins_url('/assets/js/wcpgsk-validate.js', $this-&gt;file) , '', '', false);&nbsp;</div></li><li><div>                  wp_enqueue_script( 'wcpgsk-userjs', plugins_url('wcpgsk-user.js', $this-&gt;file) , '', '', false);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $jquery_version = isset( $wp_scripts-&gt;registered['jquery-ui-core']-&gt;ver ) ? $wp_scripts-&gt;registered['jquery-ui-core']-&gt;ver : '1.9.2';&nbsp;</div></li><li><div>                  wp_enqueue_style( 'jquery-ui-style', apply_filters('wcpgsk_jquery_ui', '<span class="comment">//ajax.googleapis.com/ajax/libs/jqueryui/' . $jquery_version . '/themes/smoothness/jquery-ui.css', plugins_url('/assets/css/jquery-ui.css', $this-&gt;file) ), array(), '');</span>&nbsp;</div></li><li><div>                  &nbsp;</div></li><li><div>                  wp_enqueue_style( 'jquery-ui-timepicker-addon', plugins_url('/assets/css/jquery-ui-timepicker-addon.css', $this-&gt;file) , array(), '');&nbsp;</div></li><li><div>                  wp_enqueue_style( 'wcpgsk-country', plugins_url('/assets/css/wcpgsk-checkout.css', $this-&gt;file) , array(), '');&nbsp;</div></li><li><div>              endif;&nbsp;</div></li><li><div>          endif;&nbsp;</div></li><li><div>      }        &nbsp;</div></li><li><div>  }    &nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>Woocommerce Poor Guys Swiss Knife</li><li><span></span>2.2.1</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>