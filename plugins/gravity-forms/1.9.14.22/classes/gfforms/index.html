<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="1.9.14.22" data-slug="gravity-forms" data-type="class" data-id="72799"><head xmlns="http://www.w3.org/1999/xhtml"><title> gfforms | class | Gravity Forms | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="GFForms, class, plugin, gravity-forms, 1.9.14.22" /><meta name="description" content="The Gravity Forms GFForms class." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.10"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=3283e8511b204cd251b7e949d624a270' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.10' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/gfforms/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fgfforms%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fgfforms%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-gravity-forms-1.9.14.22-class-gfforms","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="gfforms" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to gravity-forms." href="http://hookr.io/plugins/gravity-forms/" class="plugin"><span property="name">gravity-forms</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 1.9.14.22." href="http://hookr.io/plugins/gravity-forms/1.9.14.22/" class="H_VERSION"><span property="name">1.9.14.22</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/gravity-forms/1.9.14.22/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">gfforms</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="793"><a href="http://hookr.io/plugins/gravity-forms/1.9.14.22/all/" title="All">All <span class="count badge">793</span></a></li><li class="" data-id="new" data-count="458"><a href="http://hookr.io/plugins/gravity-forms/1.9.14.22/new/" title="New">New <span class="count badge">458</span></a></li><li class="" data-id="hooks" data-count="603"><a href="http://hookr.io/plugins/gravity-forms/1.9.14.22/hooks/" title="Hooks">Hooks <span class="count badge">603</span></a></li><li class="" data-id="action" data-count="198"><a href="http://hookr.io/plugins/gravity-forms/1.9.14.22/actions/" title="Actions">Actions <span class="count badge">198</span></a></li><li class="" data-id="filter" data-count="405"><a href="http://hookr.io/plugins/gravity-forms/1.9.14.22/filters/" title="Filters">Filters <span class="count badge">405</span></a></li><li class="active" data-id="class" data-count="107"><a href="http://hookr.io/plugins/gravity-forms/1.9.14.22/classes/" title="Classes">Classes <span class="count badge">107</span></a></li><li class="" data-id="constant" data-count="48"><a href="http://hookr.io/plugins/gravity-forms/1.9.14.22/constants/" title="Constants">Constants <span class="count badge">48</span></a></li><li class="" data-id="function" data-count="33"><a href="http://hookr.io/plugins/gravity-forms/1.9.14.22/functions/" title="Functions">Functions <span class="count badge">33</span></a></li><li class="" data-id="shortcode" data-count="2"><a href="http://hookr.io/plugins/gravity-forms/1.9.14.22/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">2</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>GFForms</strong></h1><p>The Gravity Forms <strong>GFForms</strong> class.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/gravity-forms/1.9.14.22/files/gravityforms/" class="file">/gravityforms.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="51" class="block" start="115"><li><div>class GFForms {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static $version = '1.9.14.22';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function loaded() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * Fires when Gravity Forms has loaded. When developing Add-Ons, use this hook to initialize any functionality that depends on Gravity Forms functionality&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        do_action( 'gform_loaded' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //initializing Add-Ons if necessary&nbsp;</div></li><li><div>        if ( class_exists( 'GFAddOn' ) ) {&nbsp;</div></li><li><div>            GFAddOn::init_addons();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function has_members_plugin() {&nbsp;</div></li><li><div>        return function_exists( 'members_get_capabilities' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Plugin starting point. Will load appropriate files&nbsp;</div></li><li><div>    public static function init() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //load text domains&nbsp;</div></li><li><div>        GFCommon::load_gf_text_domain( 'gravityforms' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_filter( 'gform_logging_supported', array( 'RGForms', 'set_logging_supported' ) );&nbsp;</div></li><li><div>        add_action( 'admin_head', array( 'GFCommon', 'maybe_output_gf_vars' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        self::register_scripts();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //Maybe set up Gravity Forms: only on admin requests for single site installation and always for multisite&nbsp;</div></li><li><div>        if ( ( IS_ADMIN && false === ( defined( 'DOING_AJAX' ) && true === DOING_AJAX ) ) || is_multisite() ) {&nbsp;</div></li><li><div>            self::setup();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //Plugin update actions&nbsp;</div></li><li><div>        add_filter( 'transient_update_plugins', array( 'GFForms', 'check_update' ) );&nbsp;</div></li><li><div>        add_filter( 'site_transient_update_plugins', array( 'GFForms', 'check_update' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_filter( 'auto_update_plugin', array( 'GFForms', 'maybe_auto_update' ), 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( IS_ADMIN ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            global $current_user;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            add_filter( 'pre_update_option_rg_gforms_key', array( 'GFSettings', 'filter_pre_update_option_rg_gforms_key' ), 10, 2 );&nbsp;</div></li><li><div>            add_action( 'delete_option_rg_gforms_key', array( 'GFSettings', 'action_delete_option_rg_gforms_key' ), 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            //Members plugin integration. Adding Gravity Forms roles to the checkbox list&nbsp;</div></li><li><div>            if ( self::has_members_plugin() ) {&nbsp;</div></li><li><div>                add_filter( 'members_get_capabilities', array( 'RGForms', 'members_get_capabilities' ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( is_multisite() ) {&nbsp;</div></li><li><div>                add_filter( 'wpmu_drop_tables', array( 'GFFormsModel', 'mu_drop_tables' ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            add_action( 'admin_enqueue_scripts', array( 'GFForms', 'enqueue_admin_scripts' ) );&nbsp;</div></li><li><div>            add_action( 'print_media_templates', array( 'GFForms', 'action_print_media_templates' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( defined( 'WP_DEBUG' ) && WP_DEBUG ) {&nbsp;</div></li><li><div>                add_action( 'admin_footer', array( 'GFForms', 'deprecate_add_on_methods' ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            //Loading Gravity Forms if user has access to any functionality&nbsp;</div></li><li><div>            if ( GFCommon::current_user_can_any( GFCommon::all_caps() ) ) {&nbsp;</div></li><li><div>                require_once( GFCommon::get_base_path() . '/export.php' );&nbsp;</div></li><li><div>                GFExport::maybe_export();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                //imports theme forms if configured to be automatic imported&nbsp;</div></li><li><div>                self::maybe_import_theme_forms();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                //creates the &quot;Forms&quot; left menu&nbsp;</div></li><li><div>                add_action( 'admin_menu', array( 'RGForms', 'create_menu' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( GF_SUPPORTED_WP_VERSION ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    add_action( 'admin_footer', array( 'RGForms', 'check_upload_folder' ) );&nbsp;</div></li><li><div>                    add_action( 'wp_dashboard_setup', array( 'RGForms', 'dashboard_setup' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    // Support modifying the admin page title for settings&nbsp;</div></li><li><div>                    add_filter( 'admin_title', array( __class__, 'modify_admin_title' ), 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    //Adding &quot;embed form&quot; button&nbsp;</div></li><li><div>                    add_action( 'media_buttons', array( 'RGForms', 'add_form_button' ), 20 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    require_once( GFCommon::get_base_path() . '/includes/locking/locking.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( self::page_supports_add_form_button() ) {&nbsp;</div></li><li><div>                        add_action( 'admin_footer', array( 'RGForms', 'add_mce_popup' ) );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( self::is_gravity_page() ) {&nbsp;</div></li><li><div>                        require_once( GFCommon::get_base_path() . '/tooltips.php' );&nbsp;</div></li><li><div>                    } else if ( RG_CURRENT_PAGE == 'media-upload.php' ) {&nbsp;</div></li><li><div>                        require_once( GFCommon::get_base_path() . '/entry_list.php' );&nbsp;</div></li><li><div>                    } else if ( in_array( RG_CURRENT_PAGE, array( 'admin.php', 'admin-ajax.php' ) ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_save_form', array( 'RGForms', 'save_form' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_change_input_type', array( 'RGForms', 'change_input_type' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_refresh_field_preview', array( 'RGForms', 'refresh_field_preview' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_add_field', array( 'RGForms', 'add_field' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_duplicate_field', array( 'RGForms', 'duplicate_field' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_delete_field', array( 'RGForms', 'delete_field' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_delete_file', array( 'RGForms', 'delete_file' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_select_export_form', array( 'RGForms', 'select_export_form' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_start_export', array( 'RGForms', 'start_export' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_gf_upgrade_license', array( 'RGForms', 'upgrade_license' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_gf_delete_custom_choice', array( 'RGForms', 'delete_custom_choice' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_gf_save_custom_choice', array( 'RGForms', 'save_custom_choice' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_gf_get_post_categories', array( 'RGForms', 'get_post_category_values' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_gf_get_notification_post_categories', array( 'RGForms', 'get_notification_post_category_values' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_gf_save_confirmation', array( 'RGForms', 'save_confirmation' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_gf_delete_confirmation', array( 'RGForms', 'delete_confirmation' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_gf_save_new_form', array( 'RGForms', 'save_new_form' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        //entry list ajax operations&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_update_lead_property', array( 'RGForms', 'update_lead_property' ) );&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_delete-gf_entry', array( 'RGForms', 'update_lead_status' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        //form list ajax operations&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_update_form_active', array( 'RGForms', 'update_form_active' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        //notification list ajax operations&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_update_notification_active', array( 'RGForms', 'update_notification_active' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        //confirmation list ajax operations&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_update_confirmation_active', array( 'RGForms', 'update_confirmation_active' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        //dynamic captcha image&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_captcha_image', array( 'RGForms', 'captcha_image' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        //dashboard message &quot;dismiss upgrade&quot; link&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_rg_dismiss_upgrade', array( 'RGForms', 'dashboard_dismiss_upgrade' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        // entry detail: resend notifications&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_gf_resend_notifications', array( 'RGForms', 'resend_notifications' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        // Shortcode UI&nbsp;</div></li><li><div>                        add_action( 'wp_ajax_gf_do_shortcode', array( 'GFForms', 'handle_ajax_do_shortcode' ) );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    add_filter( 'plugins_api', array( 'RGForms', 'get_addon_info' ), 100, 3 );&nbsp;</div></li><li><div>                    add_action( 'after_plugin_row_gravityforms/gravityforms.php', array( 'RGForms', 'plugin_row' ) );&nbsp;</div></li><li><div>                    add_action( 'install_plugins_pre_plugin-information', array( 'RGForms', 'display_changelog' ) );&nbsp;</div></li><li><div>                    add_filter( 'plugin_action_links', array( 'RGForms', 'plugin_settings_link' ), 10, 2 );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            add_action( 'admin_init', array( 'RGForms', 'ajax_parse_request' ), 10 );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            add_action( 'wp_enqueue_scripts', array( 'RGForms', 'enqueue_scripts' ), 11 );&nbsp;</div></li><li><div>            add_action( 'wp', array( 'RGForms', 'ajax_parse_request' ), 10 );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add &quot;Form&quot; to the &quot;New&quot; menu in WP admin bar&nbsp;</div></li><li><div>        add_action( 'wp_before_admin_bar_render', array( 'GFForms', 'admin_bar' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_shortcode( 'gravityform', array( 'RGForms', 'parse_shortcode' ) );&nbsp;</div></li><li><div>        add_shortcode( 'gravityforms', array( 'RGForms', 'parse_shortcode' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // ManageWP premium update filters&nbsp;</div></li><li><div>        add_filter( 'mwp_premium_update_notification', array( 'RGForms', 'premium_update_push' ) );&nbsp;</div></li><li><div>        add_filter( 'mwp_premium_perform_update', array( 'RGForms', 'premium_update' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Push Gravity Forms to the top of the list of plugins to make sure it's loaded before any add-ons&nbsp;</div></li><li><div>        add_action( 'activated_plugin', array( 'GFForms', 'load_first' ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function load_first() {&nbsp;</div></li><li><div>        $plugin_path = basename( dirname( __FILE__ ) ) . '/gravityforms.php';&nbsp;</div></li><li><div>        $active_plugins = get_option( 'active_plugins' );&nbsp;</div></li><li><div>        $key = array_search( $plugin_path, $active_plugins );&nbsp;</div></li><li><div>        if ( $key &gt; 0 ) {&nbsp;</div></li><li><div>            array_splice( $active_plugins, $key, 1 );&nbsp;</div></li><li><div>            array_unshift( $active_plugins, $plugin_path );&nbsp;</div></li><li><div>            update_option( 'active_plugins', $active_plugins );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function deactivation_hook() {&nbsp;</div></li><li><div>        GFCache::flush( true );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function set_logging_supported( $plugins ) {&nbsp;</div></li><li><div>        $plugins['gravityforms'] = 'Gravity Forms Core';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $plugins;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function maybe_process_form() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $form_id = isset( $_POST['gform_submit'] ) ? absint( $_POST['gform_submit'] ) : 0;&nbsp;</div></li><li><div>        if ( $form_id ) {&nbsp;</div></li><li><div>            $form_info = RGFormsModel::get_form( $form_id );&nbsp;</div></li><li><div>            $is_valid_form = $form_info && $form_info-&gt;is_active;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $is_valid_form ) {&nbsp;</div></li><li><div>                require_once( GFCommon::get_base_path() . '/form_display.php' );&nbsp;</div></li><li><div>                GFFormDisplay::process_form( $form_id );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } elseif ( isset( $_POST['gform_send_resume_link'] ) ) {&nbsp;</div></li><li><div>            require_once( GFCommon::get_base_path() . '/form_display.php' );&nbsp;</div></li><li><div>            GFFormDisplay::process_send_resume_link();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function process_exterior_pages() {&nbsp;</div></li><li><div>        if ( rgempty( 'gf_page', $_GET ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $page = rgget( 'gf_page' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $is_legacy_upload_page = $_SERVER['REQUEST_METHOD'] == 'POST' && $page == 'upload';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $is_legacy_upload_page && ( ! defined( 'DOING_AJAX' ) || ! DOING_AJAX ) ) {&nbsp;</div></li><li><div>            _doing_it_wrong( 'gf_page=upload', 'gf_page=upload is now deprecated. Use GFCommon::get_upload_page_slug() instead', '1.9.6.13' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $is_upload_page = $_SERVER['REQUEST_METHOD'] == 'POST' && $page == GFCommon::get_upload_page_slug();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $is_upload_page || $is_legacy_upload_page ) {&nbsp;</div></li><li><div>            require_once( GFCommon::get_base_path() . '/includes/upload.php' );&nbsp;</div></li><li><div>            exit();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //ensure users are logged in&nbsp;</div></li><li><div>        if ( ! is_user_logged_in() ) {&nbsp;</div></li><li><div>            auth_redirect();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        switch ( $page ) {&nbsp;</div></li><li><div>            case 'preview':&nbsp;</div></li><li><div>                require_once( GFCommon::get_base_path() . '/preview.php' );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'print-entry' :&nbsp;</div></li><li><div>                require_once( GFCommon::get_base_path() . '/print-entry.php' );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'select_columns' :&nbsp;</div></li><li><div>                require_once( GFCommon::get_base_path() . '/select_columns.php' );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        exit();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function check_update( $update_plugins_option ) {&nbsp;</div></li><li><div>        if ( ! class_exists( 'GFCommon' ) ) {&nbsp;</div></li><li><div>            require_once( 'common.php' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return GFCommon::check_update( $update_plugins_option, true );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Creates or updates database tables. Will only run when version changes&nbsp;</div></li><li><div>    public static function setup( $force_setup = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $current_version = get_option( 'rg_form_version' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $current_version === false ) {&nbsp;</div></li><li><div>            // Show installation wizard for all new installations&nbsp;</div></li><li><div>            update_option( 'gform_pending_installation', true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Turn background updates on by default for all new installations.&nbsp;</div></li><li><div>            update_option( 'gform_enable_background_updates', true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // All new installations are ready for the value column of the lead_detail table to be longtext.&nbsp;</div></li><li><div>            update_option( 'gform_longtext_ready', true );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $has_version_changed = $current_version != GFCommon::$version;&nbsp;</div></li><li><div>        if ( $has_version_changed ) {&nbsp;</div></li><li><div>            //Making sure version has really changed. Gets around aggressive caching issue on some sites that cause setup to run multiple times.&nbsp;</div></li><li><div>            $has_version_changed = self::get_wp_option( 'rg_form_version' ) != GFCommon::$version;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $has_version_changed || $force_setup ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $blog_id = get_current_blog_id();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            GFCommon::log_debug( &quot;GFForms::setup(): Blog {$blog_id} - Beginning of setup. From version &quot; . get_option( 'rg_form_version' ) . ' to version ' . GFCommon::$version );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            //setting up database structure&nbsp;</div></li><li><div>            self::setup_database();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            //auto-setting and auto-validating license key based on value configured via the GF_LICENSE_KEY constant or the gf_license_key variable&nbsp;</div></li><li><div>            //auto-populating reCAPTCHA keys base on constant&nbsp;</div></li><li><div>            self::maybe_populate_keys();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            //Auto-importing forms based on GF_IMPORT_FILE AND GF_THEME_IMPORT_FILE&nbsp;</div></li><li><div>            self::maybe_import_forms();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            self::add_security_files();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            self::do_self_healing();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            //The format the version info changed to JSON. Make sure the old format is not cached.&nbsp;</div></li><li><div>            if ( version_compare( get_option( 'rg_form_version' ), '1.8.0.3', '&lt;' ) ) {&nbsp;</div></li><li><div>                delete_transient( 'gform_update_info' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            update_option( 'rg_form_version', GFCommon::$version );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            GFCommon::log_debug( &quot;GFForms::setup(): Blog {$blog_id} - End of setup.&quot; );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function setup_database() {&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        require_once( ABSPATH . '/wp-admin/includes/upgrade.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $wpdb-&gt;charset ) ) {&nbsp;</div></li><li><div>            $charset_collate = &quot;DEFAULT CHARACTER SET $wpdb-&gt;charset&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( ! empty( $wpdb-&gt;collate ) ) {&nbsp;</div></li><li><div>            $charset_collate .= &quot; COLLATE $wpdb-&gt;collate&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //Fixes issue with dbDelta lower-casing table names, which cause problems on case sensitive DB servers.&nbsp;</div></li><li><div>        add_filter( 'dbdelta_create_queries', array( 'RGForms', 'dbdelta_fix_case' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * Indexes have a maximum size of 767 bytes. Historically, we haven't need to be concerned about that.&nbsp;</div></li><li><div>         * As of 4.2, however, WP core moved to utf8mb4, which uses 4 bytes per character. This means that an index which&nbsp;</div></li><li><div>         * used to have room for floor(767/3) = 255 characters, now only has room for floor(767/4) = 191 characters.&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        $max_index_length = 191;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //------ FORM -----------------------------------------------&nbsp;</div></li><li><div>        $form_table_name = RGFormsModel::get_form_table_name();&nbsp;</div></li><li><div>        $sql = 'CREATE TABLE ' . $form_table_name . &quot; (&nbsp;</div></li><li><div>              id mediumint(8) unsigned not null auto_increment, &nbsp;</div></li><li><div>              title varchar(150) not null, &nbsp;</div></li><li><div>              date_created datetime not null, &nbsp;</div></li><li><div>              is_active tinyint(1) not null default 1, &nbsp;</div></li><li><div>              is_trash tinyint(1) not null default 0, &nbsp;</div></li><li><div>              PRIMARY KEY  (id)&nbsp;</div></li><li><div> ) $charset_collate;&quot;;&nbsp;</div></li><li><div>        dbDelta( $sql );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //droping table that was created by mistake in version 1.6.3.2&nbsp;</div></li><li><div>        $wpdb-&gt;query( 'DROP TABLE IF EXISTS A' . $form_table_name );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //------ META -----------------------------------------------&nbsp;</div></li><li><div>        $meta_table_name = RGFormsModel::get_meta_table_name();&nbsp;</div></li><li><div>        $sql = 'CREATE TABLE ' . $meta_table_name . &quot; (&nbsp;</div></li><li><div>              form_id mediumint(8) unsigned not null, &nbsp;</div></li><li><div>              display_meta longtext, &nbsp;</div></li><li><div>              entries_grid_meta longtext, &nbsp;</div></li><li><div>              confirmations longtext, &nbsp;</div></li><li><div>              notifications longtext, &nbsp;</div></li><li><div>              PRIMARY KEY  (form_id)&nbsp;</div></li><li><div> ) $charset_collate;&quot;;&nbsp;</div></li><li><div>        dbDelta( $sql );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //droping outdated form_id index (if one exists)&nbsp;</div></li><li><div>        self::drop_index( $meta_table_name, 'form_id' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //------ FORM VIEW -----------------------------------------------&nbsp;</div></li><li><div>        $form_view_table_name = RGFormsModel::get_form_view_table_name();&nbsp;</div></li><li><div>        $sql = 'CREATE TABLE ' . $form_view_table_name . &quot; (&nbsp;</div></li><li><div>              id bigint(20) unsigned not null auto_increment, &nbsp;</div></li><li><div>              form_id mediumint(8) unsigned not null, &nbsp;</div></li><li><div>              date_created datetime not null, &nbsp;</div></li><li><div>              ip char(15), &nbsp;</div></li><li><div>              count mediumint(8) unsigned not null default 1, &nbsp;</div></li><li><div>              PRIMARY KEY  (id), &nbsp;</div></li><li><div>              KEY form_id (form_id)&nbsp;</div></li><li><div> ) $charset_collate;&quot;;&nbsp;</div></li><li><div>        dbDelta( $sql );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //------ LEAD -----------------------------------------------&nbsp;</div></li><li><div>        $lead_table_name = RGFormsModel::get_lead_table_name();&nbsp;</div></li><li><div>        $sql = 'CREATE TABLE ' . $lead_table_name . &quot; (&nbsp;</div></li><li><div>              id int(10) unsigned not null auto_increment, &nbsp;</div></li><li><div>              form_id mediumint(8) unsigned not null, &nbsp;</div></li><li><div>              post_id bigint(20) unsigned, &nbsp;</div></li><li><div>              date_created datetime not null, &nbsp;</div></li><li><div>              is_starred tinyint(1) not null default 0, &nbsp;</div></li><li><div>              is_read tinyint(1) not null default 0, &nbsp;</div></li><li><div>              ip varchar(39) not null, &nbsp;</div></li><li><div>              source_url varchar(200) not null default '', &nbsp;</div></li><li><div>              user_agent varchar(250) not null default '', &nbsp;</div></li><li><div>              currency varchar(5), &nbsp;</div></li><li><div>              payment_status varchar(15), &nbsp;</div></li><li><div>              payment_date datetime, &nbsp;</div></li><li><div>              payment_amount decimal(19, 2), &nbsp;</div></li><li><div>              payment_method varchar(30), &nbsp;</div></li><li><div>              transaction_id varchar(50), &nbsp;</div></li><li><div>              is_fulfilled tinyint(1), &nbsp;</div></li><li><div>              created_by bigint(20) unsigned, &nbsp;</div></li><li><div>              transaction_type tinyint(1), &nbsp;</div></li><li><div>              status varchar(20) not null default 'active', &nbsp;</div></li><li><div>              PRIMARY KEY  (id), &nbsp;</div></li><li><div>              KEY form_id (form_id), &nbsp;</div></li><li><div>              KEY status (status)&nbsp;</div></li><li><div> ) $charset_collate;&quot;;&nbsp;</div></li><li><div>        dbDelta( $sql );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //------ LEAD NOTES ------------------------------------------&nbsp;</div></li><li><div>        $lead_notes_table_name = RGFormsModel::get_lead_notes_table_name();&nbsp;</div></li><li><div>        $sql = 'CREATE TABLE ' . $lead_notes_table_name . &quot; (&nbsp;</div></li><li><div>              id int(10) unsigned not null auto_increment, &nbsp;</div></li><li><div>              lead_id int(10) unsigned not null, &nbsp;</div></li><li><div>              user_name varchar(250), &nbsp;</div></li><li><div>              user_id bigint(20), &nbsp;</div></li><li><div>              date_created datetime not null, &nbsp;</div></li><li><div>              value longtext, &nbsp;</div></li><li><div>              note_type varchar(50), &nbsp;</div></li><li><div>              PRIMARY KEY  (id), &nbsp;</div></li><li><div>              KEY lead_id (lead_id), &nbsp;</div></li><li><div>              KEY lead_user_key (lead_id, user_id)&nbsp;</div></li><li><div> ) $charset_collate;&quot;;&nbsp;</div></li><li><div>        dbDelta( $sql );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $value_column_type = get_option( 'gform_longtext_ready' ) ? 'longtext' : 'varchar(' . GFORMS_MAX_FIELD_LENGTH . ')';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //------ LEAD DETAIL -----------------------------------------&nbsp;</div></li><li><div>        $lead_detail_table_name = RGFormsModel::get_lead_details_table_name();&nbsp;</div></li><li><div>        $sql = 'CREATE TABLE ' . $lead_detail_table_name . ' (&nbsp;</div></li><li><div>              id bigint(20) unsigned not null auto_increment, &nbsp;</div></li><li><div>              lead_id int(10) unsigned not null, &nbsp;</div></li><li><div>              form_id mediumint(8) unsigned not null, &nbsp;</div></li><li><div>              field_number float not null, &nbsp;</div></li><li><div>              value ' . $value_column_type . &quot;, &nbsp;</div></li><li><div>              PRIMARY KEY  (id), &nbsp;</div></li><li><div>              KEY form_id (form_id), &nbsp;</div></li><li><div>              KEY lead_id (lead_id), &nbsp;</div></li><li><div>              KEY lead_field_number (lead_id, field_number), &nbsp;</div></li><li><div>              KEY lead_field_value (value($max_index_length))&nbsp;</div></li><li><div> ) $charset_collate;&quot;;&nbsp;</div></li><li><div>        dbDelta( $sql );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //------ LEAD DETAIL LONG -----------------------------------&nbsp;</div></li><li><div>        $lead_detail_long_table_name = RGFormsModel::get_lead_details_long_table_name();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $sql = 'CREATE TABLE ' . $lead_detail_long_table_name . &quot; (&nbsp;</div></li><li><div>              lead_detail_id bigint(20) unsigned not null, &nbsp;</div></li><li><div>              value longtext, &nbsp;</div></li><li><div>              PRIMARY KEY  (lead_detail_id)&nbsp;</div></li><li><div> ) $charset_collate;&quot;;&nbsp;</div></li><li><div>        dbDelta( $sql );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // dropping outdated form_id index (if one exists)&nbsp;</div></li><li><div>        self::drop_index( $lead_detail_long_table_name, 'lead_detail_key' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //------ LEAD META ------------------------------------------&nbsp;</div></li><li><div>        $lead_meta_table_name = RGFormsModel::get_lead_meta_table_name();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // dropping meta_key and form_id_meta_key (if they exist) to prevent duplicate keys error on upgrade&nbsp;</div></li><li><div>        if ( version_compare( get_option( 'rg_form_version' ), '1.9.8.12', '&lt;' ) ) {&nbsp;</div></li><li><div>            self::drop_index( $lead_meta_table_name, 'meta_key' );&nbsp;</div></li><li><div>            self::drop_index( $lead_meta_table_name, 'form_id_meta_key' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $sql = 'CREATE TABLE ' . $lead_meta_table_name . &quot; (&nbsp;</div></li><li><div>              id bigint(20) unsigned not null auto_increment, &nbsp;</div></li><li><div>              form_id mediumint(8) unsigned not null default 0, &nbsp;</div></li><li><div>              lead_id bigint(20) unsigned not null, &nbsp;</div></li><li><div>              meta_key varchar(255), &nbsp;</div></li><li><div>              meta_value longtext, &nbsp;</div></li><li><div>              PRIMARY KEY  (id), &nbsp;</div></li><li><div>              KEY meta_key (meta_key($max_index_length)), &nbsp;</div></li><li><div>              KEY lead_id (lead_id), &nbsp;</div></li><li><div>              KEY form_id_meta_key (form_id, meta_key($max_index_length))&nbsp;</div></li><li><div> ) $charset_collate;&quot;;&nbsp;</div></li><li><div>        dbDelta( $sql );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //------ INCOMPLETE SUBMISSIONS -------------------------------&nbsp;</div></li><li><div>        $incomplete_submissions_table_name = RGFormsModel::get_incomplete_submissions_table_name();&nbsp;</div></li><li><div>        $sql = 'CREATE TABLE ' . $incomplete_submissions_table_name . &quot; (&nbsp;</div></li><li><div>              uuid char(32) not null, &nbsp;</div></li><li><div>              email varchar(255), &nbsp;</div></li><li><div>              form_id mediumint(8) unsigned not null, &nbsp;</div></li><li><div>              date_created datetime not null, &nbsp;</div></li><li><div>              ip varchar(39) not null, &nbsp;</div></li><li><div>              source_url longtext not null, &nbsp;</div></li><li><div>              submission longtext not null, &nbsp;</div></li><li><div>              PRIMARY KEY  (uuid), &nbsp;</div></li><li><div>              KEY form_id (form_id)&nbsp;</div></li><li><div> ) $charset_collate;&quot;;&nbsp;</div></li><li><div>        dbDelta( $sql );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        remove_filter( 'dbdelta_create_queries', array( 'RGForms', 'dbdelta_fix_case' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //fix form_id value needed to update from version 1.6.11&nbsp;</div></li><li><div>        self::fix_lead_meta_form_id_values();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //fix checkbox value. needed for version 1.0 and below but won't hurt for higher versions&nbsp;</div></li><li><div>        self::fix_checkbox_value();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //fix leading and trailing spaces in Form objects and entry values&nbsp;</div></li><li><div>        if ( version_compare( get_option( 'rg_form_version' ), '1.8.3.1', '&lt;' ) ) {&nbsp;</div></li><li><div>            self::fix_leading_and_trailing_spaces();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function add_security_files() {&nbsp;</div></li><li><div>        $upload_root = GFFormsModel::get_upload_root();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! is_dir( $upload_root ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        GFCommon::recursive_add_index_file( $upload_root );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        GFCommon::add_htaccess_file();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private static function do_self_healing() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $flag_security_alert = self::heal_wp_upload_dir();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $gf_upload_root = GFFormsModel::get_upload_root();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! is_dir( $gf_upload_root ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $flag_security_alert = self::rename_suspicious_files_recursive( $gf_upload_root, $flag_security_alert );&nbsp;</div></li><li><div>        if ( $flag_security_alert ) {&nbsp;</div></li><li><div>            update_option( 'gform_security_alert', $flag_security_alert );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Renames files with a .bak extension if they have a file extension that is not allowed in the Gravity Forms uploads folder.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private static function rename_suspicious_files_recursive( $dir, $flag_security_alert = false ) {&nbsp;</div></li><li><div>        if ( ! is_dir( $dir ) || is_link( $dir ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! ( $dir_handle = opendir( $dir ) ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // ignores all errors&nbsp;</div></li><li><div>        set_error_handler( create_function( '', 'return 0;' ), E_ALL );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        while ( false !== ( $file = readdir( $dir_handle ) ) ) {&nbsp;</div></li><li><div>            if ( is_dir( $dir . DIRECTORY_SEPARATOR . $file ) && $file != '.' && $file != '..' ) {&nbsp;</div></li><li><div>                $flag_security_alert = self::rename_suspicious_files_recursive( $dir . DIRECTORY_SEPARATOR . $file, $flag_security_alert );&nbsp;</div></li><li><div>            } elseif ( GFCommon::file_name_has_disallowed_extension( $file )&nbsp;</div></li><li><div>                       && ! GFCommon::match_file_extension( $file, array( 'htaccess', 'bak', 'html' ) ) ) {&nbsp;</div></li><li><div>                $mini_hash = substr( wp_hash( $file ), 0, 6 );&nbsp;</div></li><li><div>                $newName = sprintf( '%s/%s.%s.bak', $dir, $file, $mini_hash );&nbsp;</div></li><li><div>                rename( $dir . '/' . $file, $newName );&nbsp;</div></li><li><div>                $flag_security_alert = true;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        closedir( $dir_handle );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $flag_security_alert;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private static function heal_wp_upload_dir() {&nbsp;</div></li><li><div>        $wp_upload_dir = wp_upload_dir();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $wp_upload_path = $wp_upload_dir['basedir'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! is_dir( $wp_upload_path ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $flag_security_alert = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // ignores all errors&nbsp;</div></li><li><div>        set_error_handler( create_function( '', 'return 0;' ), E_ALL );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( glob( $wp_upload_path . DIRECTORY_SEPARATOR . '*_input_*.{php, php5}', GLOB_BRACE ) as $filename ) {&nbsp;</div></li><li><div>            $mini_hash = substr( wp_hash( $filename ), 0, 6 );&nbsp;</div></li><li><div>            $newName = sprintf( '%s.%s.bak', $filename, $mini_hash );&nbsp;</div></li><li><div>            rename( $filename, $newName );&nbsp;</div></li><li><div>            $flag_security_alert = true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $flag_security_alert;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private static function fix_leading_and_trailing_spaces() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $meta_table_name = GFFormsModel::get_meta_table_name();&nbsp;</div></li><li><div>        $lead_details_table = GFFormsModel::get_lead_details_table_name();&nbsp;</div></li><li><div>        $lead_details_long_table = GFFormsModel::get_lead_details_long_table_name();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $result = $wpdb-&gt;query( &quot;UPDATE $lead_details_table SET value = TRIM(value)&quot; );&nbsp;</div></li><li><div>        $result = $wpdb-&gt;query( &quot;UPDATE $lead_details_long_table SET value = TRIM(value)&quot; );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $results = $wpdb-&gt;get_results( &quot;SELECT form_id, display_meta, confirmations, notifications FROM {$meta_table_name}&quot;, ARRAY_A );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $results as &$result ) {&nbsp;</div></li><li><div>            $form_id = $result['form_id'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $form = GFFormsModel::unserialize( $result['display_meta'] );&nbsp;</div></li><li><div>            $form_updated = false;&nbsp;</div></li><li><div>            $form = GFFormsModel::trim_form_meta_values( $form, $form_updated );&nbsp;</div></li><li><div>            if ( $form_updated ) {&nbsp;</div></li><li><div>                GFFormsModel::update_form_meta( $form_id, $form );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $confirmations = GFFormsModel::unserialize( $result['confirmations'] );&nbsp;</div></li><li><div>            $confirmations_updated = false;&nbsp;</div></li><li><div>            $confirmations = GFFormsModel::trim_conditional_logic_values( $confirmations, $form, $confirmations_updated );&nbsp;</div></li><li><div>            if ( $confirmations_updated ) {&nbsp;</div></li><li><div>                GFFormsModel::update_form_meta( $form_id, $confirmations, 'confirmations' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $notifications = GFFormsModel::unserialize( $result['notifications'] );&nbsp;</div></li><li><div>            $notifications_updated = false;&nbsp;</div></li><li><div>            $notifications = GFFormsModel::trim_conditional_logic_values( $notifications, $form, $notifications_updated );&nbsp;</div></li><li><div>            if ( $notifications_updated ) {&nbsp;</div></li><li><div>                GFFormsModel::update_form_meta( $form_id, $notifications, 'notifications' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $results;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private static function maybe_import_forms() {&nbsp;</div></li><li><div>        if ( defined( 'GF_IMPORT_FILE' ) && ! get_option( 'gf_imported_file' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            require_once( GFCommon::get_base_path() . '/export.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            GFExport::import_file( GF_IMPORT_FILE );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            update_option( 'gf_imported_file', true );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private static function maybe_import_theme_forms() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //Import theme specific forms if configured. Will only import forms once per theme.&nbsp;</div></li><li><div>        if ( defined( 'GF_THEME_IMPORT_FILE' ) ) {&nbsp;</div></li><li><div>            $themes = get_option( 'gf_imported_theme_file' );&nbsp;</div></li><li><div>            if ( ! is_array( $themes ) ) {&nbsp;</div></li><li><div>                $themes = array();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            //if current theme has already imported it's forms, don't import again&nbsp;</div></li><li><div>            $theme = get_template();&nbsp;</div></li><li><div>            if ( ! isset( $themes[ $theme ] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                require_once( GFCommon::get_base_path() . '/export.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                //importing forms&nbsp;</div></li><li><div>                GFExport::import_file( get_stylesheet_directory() . '/' . GF_THEME_IMPORT_FILE );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                //adding current theme to the list of imported themes. So that forms are not imported again for it.&nbsp;</div></li><li><div>                $themes[ $theme ] = true;&nbsp;</div></li><li><div>                update_option( 'gf_imported_theme_file', $themes );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private static function maybe_populate_keys() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        global $gf_license_key;&nbsp;</div></li><li><div>        $license_key = defined( 'GF_LICENSE_KEY' ) && empty( $gf_license_key ) ? GF_LICENSE_KEY : $gf_license_key;&nbsp;</div></li><li><div>        if ( ! empty( $license_key ) ) {&nbsp;</div></li><li><div>            RGFormsModel::save_key( $license_key );&nbsp;</div></li><li><div>            GFCommon::cache_remote_message();&nbsp;</div></li><li><div>            GFCommon::get_version_info( false );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //auto-setting recaptcha keys based on value configured via the constant or global variable&nbsp;</div></li><li><div>        global $gf_recaptcha_public_key, $gf_recaptcha_private_key;&nbsp;</div></li><li><div>        $private_key = defined( 'GF_RECAPTCHA_PRIVATE_KEY' ) && empty( $gf_recaptcha_private_key ) ? GF_RECAPTCHA_PRIVATE_KEY : $gf_recaptcha_private_key;&nbsp;</div></li><li><div>        if ( ! empty( $private_key ) ) {&nbsp;</div></li><li><div>            update_option( 'rg_gforms_captcha_private_key', $private_key );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $public_key = defined( 'GF_RECAPTCHA_PUBLIC_KEY' ) && empty( $gf_recaptcha_public_key ) ? GF_RECAPTCHA_PUBLIC_KEY : $gf_recaptcha_public_key;&nbsp;</div></li><li><div>        if ( ! empty( $public_key ) ) {&nbsp;</div></li><li><div>            update_option( 'rg_gforms_captcha_public_key', $public_key );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function get_wp_option( $option_name ) {&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $wpdb-&gt;get_var( $wpdb-&gt;prepare( &quot;SELECT option_value FROM {$wpdb-&gt;prefix}options WHERE option_name=%s&quot;, $option_name ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Changes form_id values from default value &quot;0&quot; to the correct value. Needed when upgrading users from 1.6.11&nbsp;</div></li><li><div>    private static function fix_lead_meta_form_id_values() {&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $lead_meta_table_name = RGFormsModel::get_lead_meta_table_name();&nbsp;</div></li><li><div>        $lead_table_name = RGFormsModel::get_lead_table_name();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $sql = &quot;UPDATE $lead_meta_table_name lm, $lead_table_name l SET lm.form_id = l.form_id&nbsp;</div></li><li><div>                WHERE lm.form_id=0 AND lm.lead_id = l.id;&nbsp;</div></li><li><div>                &quot;;&nbsp;</div></li><li><div>        $wpdb-&gt;get_results( $sql );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function dbdelta_fix_case( $cqueries ) {&nbsp;</div></li><li><div>        foreach ( $cqueries as $table =&gt; $qry ) {&nbsp;</div></li><li><div>            $table_name = $table;&nbsp;</div></li><li><div>            if ( preg_match( &quot;|CREATE TABLE ([^ ]*)|&quot;, $qry, $matches ) ) {&nbsp;</div></li><li><div>                $query_table_name = trim( $matches[1], '`' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                //fix table names that are different just by their casing&nbsp;</div></li><li><div>                if ( strtolower( $query_table_name ) == $table ) {&nbsp;</div></li><li><div>                    $table_name = $query_table_name;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $queries[ $table_name ] = $qry;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $queries;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function no_conflict_mode_style() {&nbsp;</div></li><li><div>        if ( ! get_option( 'gform_enable_noconflict' ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        global $wp_styles;&nbsp;</div></li><li><div>        $wp_required_styles = array( 'admin-bar', 'colors', 'ie', 'wp-admin', 'editor-style' );&nbsp;</div></li><li><div>        $gf_required_styles = array(&nbsp;</div></li><li><div>            'common' =&gt; array(), &nbsp;</div></li><li><div>            'gf_edit_forms' =&gt; array( 'thickbox', 'editor-buttons', 'wp-jquery-ui-dialog', 'media-views', 'buttons', 'wp-pointer' ), &nbsp;</div></li><li><div>            'gf_edit_forms_notification' =&gt; array( 'thickbox', 'editor-buttons', 'wp-jquery-ui-dialog', 'media-views', 'buttons' ), &nbsp;</div></li><li><div>            'gf_new_form' =&gt; array( 'thickbox' ), &nbsp;</div></li><li><div>            'gf_entries' =&gt; array( 'thickbox' ), &nbsp;</div></li><li><div>            'gf_settings' =&gt; array(), &nbsp;</div></li><li><div>            'gf_export' =&gt; array(), &nbsp;</div></li><li><div>            'gf_help' =&gt; array()&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        self::no_conflict_mode( $wp_styles, $wp_required_styles, $gf_required_styles, 'styles' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function no_conflict_mode_script() {&nbsp;</div></li><li><div>        if ( ! get_option( 'gform_enable_noconflict' ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        global $wp_scripts;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $wp_required_scripts = array( 'admin-bar', 'common', 'jquery-color', 'utils', 'svg-painter' );&nbsp;</div></li><li><div>        $gf_required_scripts = array(&nbsp;</div></li><li><div>            'common' =&gt; array( 'gform_tooltip_init', 'sack' ), &nbsp;</div></li><li><div>            'gf_edit_forms' =&gt; array( 'backbone', 'editor', 'gform_floatmenu', 'gform_forms', 'gform_form_admin', 'gform_form_editor', 'gform_gravityforms', 'gform_json', 'gform_menu', 'gform_placeholder', 'jquery-ui-autocomplete', 'jquery-ui-core', 'jquery-ui-datepicker', 'jquery-ui-sortable', 'jquery-ui-draggable', 'jquery-ui-droppable', 'jquery-ui-tabs', 'json2', 'media-editor', 'media-models', 'media-upload', 'media-views', 'plupload', 'plupload-flash', 'plupload-html4', 'plupload-html5', 'quicktags', 'rg_currency', 'thickbox', 'word-count', 'wp-plupload', 'wpdialogs-popup', 'wplink', 'wp-pointer' ), &nbsp;</div></li><li><div>            'gf_edit_forms_notification' =&gt; array( 'editor', 'word-count', 'quicktags', 'wpdialogs-popup', 'media-upload', 'wplink', 'backbone', 'jquery-ui-sortable', 'json2', 'media-editor', 'media-models', 'media-views', 'plupload', 'plupload-flash', 'plupload-html4', 'plupload-html5', 'plupload-silverlight', 'wp-plupload', 'gform_placeholder', 'gform_json', 'jquery-ui-autocomplete' ), &nbsp;</div></li><li><div>            'gf_new_form' =&gt; array( 'thickbox', 'jquery-ui-core', 'jquery-ui-sortable', 'jquery-ui-tabs', 'rg_currency', 'gform_gravityforms', 'gform_json', 'gform_form_admin' ), &nbsp;</div></li><li><div>            'gf_entries' =&gt; array( 'thickbox', 'gform_gravityforms', 'wp-lists', 'gform_json', 'gform_field_filter', 'plupload-all' ), &nbsp;</div></li><li><div>            'gf_settings' =&gt; array(), &nbsp;</div></li><li><div>            'gf_export' =&gt; array( 'gform_form_admin', 'jquery-ui-datepicker', 'gform_field_filter' ), &nbsp;</div></li><li><div>            'gf_help' =&gt; array(), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        self::no_conflict_mode( $wp_scripts, $wp_required_scripts, $gf_required_scripts, 'scripts' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private static function no_conflict_mode( &$wp_objects, $wp_required_objects, $gf_required_objects, $type = 'scripts' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $current_page = trim( strtolower( rgget( 'page' ) ) );&nbsp;</div></li><li><div>        if ( empty( $current_page ) ) {&nbsp;</div></li><li><div>            $current_page = trim( strtolower( rgget( 'gf_page' ) ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( empty( $current_page ) ) {&nbsp;</div></li><li><div>            $current_page = RG_CURRENT_PAGE;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $view = rgempty( 'view', $_GET ) ? 'default' : rgget( 'view' );&nbsp;</div></li><li><div>        $page_objects = isset( $gf_required_objects[ $current_page . '_' . $view ] ) ? $gf_required_objects[ $current_page . '_' . $view ] : rgar( $gf_required_objects, $current_page );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //disable no-conflict if $page_objects is false&nbsp;</div></li><li><div>        if ( $page_objects === false ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! is_array( $page_objects ) ) {&nbsp;</div></li><li><div>            $page_objects = array();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //merging wp scripts with gravity forms scripts&nbsp;</div></li><li><div>        $required_objects = array_merge( $wp_required_objects, $gf_required_objects['common'], $page_objects );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //allowing addons or other products to change the list of no conflict scripts&nbsp;</div></li><li><div>        $required_objects = apply_filters( &quot;gform_noconflict_{$type}&quot;, $required_objects );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $queue = array();&nbsp;</div></li><li><div>        foreach ( $wp_objects-&gt;queue as $object ) {&nbsp;</div></li><li><div>            if ( in_array( $object, $required_objects ) ) {&nbsp;</div></li><li><div>                $queue[] = $object;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $wp_objects-&gt;queue = $queue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $required_objects = self::add_script_dependencies( $wp_objects-&gt;registered, $required_objects );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //unregistering scripts&nbsp;</div></li><li><div>        $registered = array();&nbsp;</div></li><li><div>        foreach ( $wp_objects-&gt;registered as $script_name =&gt; $script_registration ) {&nbsp;</div></li><li><div>            if ( in_array( $script_name, $required_objects ) ) {&nbsp;</div></li><li><div>                $registered[ $script_name ] = $script_registration;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $wp_objects-&gt;registered = $registered;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private static function add_script_dependencies( $registered, $scripts ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //gets all dependent scripts linked to the $scripts array passed&nbsp;</div></li><li><div>        do {&nbsp;</div></li><li><div>            $dependents = array();&nbsp;</div></li><li><div>            foreach ( $scripts as $script ) {&nbsp;</div></li><li><div>                $deps = isset( $registered[ $script ] ) && is_array( $registered[ $script ]-&gt;deps ) ? $registered[ $script ]-&gt;deps : array();&nbsp;</div></li><li><div>                foreach ( $deps as $dep ) {&nbsp;</div></li><li><div>                    if ( ! in_array( $dep, $scripts ) && ! in_array( $dep, $dependents ) ) {&nbsp;</div></li><li><div>                        $dependents[] = $dep;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $scripts = array_merge( $scripts, $dependents );&nbsp;</div></li><li><div>        } while ( ! empty( $dependents ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $scripts;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Integration with ManageWP&nbsp;</div></li><li><div>    public static function premium_update_push( $premium_update ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! function_exists( 'get_plugin_data' ) ) {&nbsp;</div></li><li><div>            include_once( ABSPATH . 'wp-admin/includes/plugin.php' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $update = GFCommon::get_version_info();&nbsp;</div></li><li><div>        if ( rgar( $update, 'is_valid_key' ) == true && version_compare( GFCommon::$version, $update['version'], '&lt;' ) ) {&nbsp;</div></li><li><div>            $gforms = get_plugin_data( __FILE__ );&nbsp;</div></li><li><div>            $gforms['type'] = 'plugin';&nbsp;</div></li><li><div>            $gforms['slug'] = 'gravityforms/gravityforms.php';&nbsp;</div></li><li><div>            $gforms['new_version'] = ! rgempty( 'version', $update ) ? $update['version'] : false;&nbsp;</div></li><li><div>            $premium_update[] = $gforms;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $premium_update;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Integration with ManageWP&nbsp;</div></li><li><div>    public static function premium_update( $premium_update ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! function_exists( 'get_plugin_data' ) ) {&nbsp;</div></li><li><div>            include_once( ABSPATH . 'wp-admin/includes/plugin.php' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $update = GFCommon::get_version_info();&nbsp;</div></li><li><div>        if ( rgar( $update, 'is_valid_key' ) == true && version_compare( GFCommon::$version, $update['version'], '&lt;' ) ) {&nbsp;</div></li><li><div>            $gforms = get_plugin_data( __FILE__ );&nbsp;</div></li><li><div>            $gforms['slug'] = 'gravityforms/gravityforms.php'; // If not set by default, always pass theme template&nbsp;</div></li><li><div>            $gforms['type'] = 'plugin';&nbsp;</div></li><li><div>            $gforms['url'] = ! rgempty( 'url', $update ) ? $update['url'] : false; // OR provide your own callback function for managing the update&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            array_push( $premium_update, $gforms );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $premium_update;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function drop_index( $table, $index ) {&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! GFFormsModel::is_valid_table( $table ) || ! GFFormsModel::is_valid_index( $index ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // check first if the table exists to prevent errors on first install&nbsp;</div></li><li><div>        $has_table = $wpdb-&gt;get_var( $wpdb-&gt;prepare( 'SHOW TABLES LIKE %s', $table ) );&nbsp;</div></li><li><div>        if ( $has_table ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $has_index = $wpdb-&gt;get_var( $wpdb-&gt;prepare( &quot;SHOW INDEX FROM {$table} WHERE Key_name=%s&quot;, $index ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $has_index ) {&nbsp;</div></li><li><div>                $wpdb-&gt;query( &quot;DROP INDEX {$index} ON {$table}&quot; );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function validate_upgrade( $do_upgrade, $hook_extra ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgar( $hook_extra, 'plugin' ) == 'gravityforms/gravityforms.php' && ! GFForms::has_database_permission( $error ) ) {&nbsp;</div></li><li><div>            return new WP_Error( 'no_db_permission', $error );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return true;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private static function has_database_permission( &$error ) {&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $wpdb-&gt;hide_errors();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $has_permission = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $sql = &quot;CREATE TABLE IF NOT EXISTS {$wpdb-&gt;prefix}rg_test ( col1 int )&quot;;&nbsp;</div></li><li><div>        $wpdb-&gt;query( $sql );&nbsp;</div></li><li><div>        $error = 'Current database user does not have necessary permissions to create tables. Gravity Forms requires that the database user has CREATE and ALTER permissions. If you need assistance in changing database user permissions, contact your hosting provider.';&nbsp;</div></li><li><div>        if ( ! empty( $wpdb-&gt;last_error ) ) {&nbsp;</div></li><li><div>            $has_permission = false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $has_permission ) {&nbsp;</div></li><li><div>            $sql = &quot;ALTER TABLE {$wpdb-&gt;prefix}rg_test ADD COLUMN a&quot; . uniqid() . ' int';&nbsp;</div></li><li><div>            $wpdb-&gt;query( $sql );&nbsp;</div></li><li><div>            $error = 'Current database user does not have necessary permissions to modify (ALTER) tables. Gravity Forms requires that the database user has CREATE and ALTER permissions. If you need assistance in changing database user permissions, contact your hosting provider.';&nbsp;</div></li><li><div>            if ( ! empty( $wpdb-&gt;last_error ) ) {&nbsp;</div></li><li><div>                $has_permission = false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $sql = &quot;DROP TABLE {$wpdb-&gt;prefix}rg_test&quot;;&nbsp;</div></li><li><div>            $wpdb-&gt;query( $sql );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $wpdb-&gt;show_errors();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $has_permission;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Changes checkbox entry values from &quot;!&quot; to the current choice text. Needed when upgrading users from 1.0&nbsp;</div></li><li><div>    private static function fix_checkbox_value() {&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $table_name = RGFormsModel::get_lead_details_table_name();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $sql = &quot;select * from $table_name where value= '!'&quot;;&nbsp;</div></li><li><div>        $results = $wpdb-&gt;get_results( $sql );&nbsp;</div></li><li><div>        foreach ( $results as $result ) {&nbsp;</div></li><li><div>            $form = RGFormsModel::get_form_meta( $result-&gt;form_id );&nbsp;</div></li><li><div>            $field = RGFormsModel::get_field( $form, $result-&gt;field_number );&nbsp;</div></li><li><div>            if ( $field-&gt;type == 'checkbox' ) {&nbsp;</div></li><li><div>                $input = GFCommon::get_input( $field, $result-&gt;field_number );&nbsp;</div></li><li><div>                $wpdb-&gt;update( $table_name, array( 'value' =&gt; $input['label'] ), array( 'id' =&gt; $result-&gt;id ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function user_has_cap( $all_caps, $cap, $args ) {&nbsp;</div></li><li><div>        $gf_caps = GFCommon::all_caps();&nbsp;</div></li><li><div>        $capability = rgar( $cap, 0 );&nbsp;</div></li><li><div>        if ( $capability != 'gform_full_access' ) {&nbsp;</div></li><li><div>            return $all_caps;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! self::has_members_plugin() ) {&nbsp;</div></li><li><div>            //give full access to administrators if the members plugin is not installed&nbsp;</div></li><li><div>            if ( current_user_can( 'administrator' ) || is_super_admin() ) {&nbsp;</div></li><li><div>                $all_caps['gform_full_access'] = true;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else if ( current_user_can( 'administrator' ) || is_super_admin() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            //checking if user has any GF permission.&nbsp;</div></li><li><div>            $has_gf_cap = false;&nbsp;</div></li><li><div>            foreach ( $gf_caps as $gf_cap ) {&nbsp;</div></li><li><div>                if ( rgar( $all_caps, $gf_cap ) ) {&nbsp;</div></li><li><div>                    $has_gf_cap = true;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( ! $has_gf_cap ) {&nbsp;</div></li><li><div>                //give full access to administrators if none of the GF permissions are active by the Members plugin&nbsp;</div></li><li><div>                $all_caps['gform_full_access'] = true;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $all_caps;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Target of Member plugin filter. Provides the plugin with Gravity Forms lists of capabilities&nbsp;</div></li><li><div>    public static function members_get_capabilities( $caps ) {&nbsp;</div></li><li><div>        return array_merge( $caps, GFCommon::all_caps() );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Tests if the upload folder is writable and displays an error message if not&nbsp;</div></li><li><div>    public static function check_upload_folder() {&nbsp;</div></li><li><div>        //check if upload folder is writable&nbsp;</div></li><li><div>        $folder = RGFormsModel::get_upload_root();&nbsp;</div></li><li><div>        if ( empty( $folder ) ) {&nbsp;</div></li><li><div>            echo &quot;&lt;div class='error'&gt;Upload folder is not writable. Export and file upload features will not be functional.&lt;/div&gt;&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function is_gravity_ajax_action() {&nbsp;</div></li><li><div>        //Gravity Forms AJAX requests&nbsp;</div></li><li><div>        $current_action = self::post( 'action' );&nbsp;</div></li><li><div>        $gf_ajax_actions = array(&nbsp;</div></li><li><div>            'rg_save_form', 'rg_change_input_type', 'rg_refresh_field_preview', 'rg_add_field', 'rg_duplicate_field', &nbsp;</div></li><li><div>            'rg_delete_field', 'rg_select_export_form', 'rg_start_export', 'gf_upgrade_license', &nbsp;</div></li><li><div>            'gf_delete_custom_choice', 'gf_save_custom_choice', 'gf_get_notification_post_categories', &nbsp;</div></li><li><div>            'rg_update_lead_property', 'delete-gf_entry', 'rg_update_form_active', 'rg_update_notification_active', &nbsp;</div></li><li><div>            'rg_update_confirmation_active', 'gf_resend_notifications', 'rg_dismiss_upgrade', 'gf_save_confirmation', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( defined( 'DOING_AJAX' ) && DOING_AJAX && in_array( $current_action, $gf_ajax_actions ) ) {&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //not a gravity forms ajax request.&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Returns true if the current page is one of Gravity Forms pages. Returns false if not&nbsp;</div></li><li><div>    public static function is_gravity_page() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //Gravity Forms pages&nbsp;</div></li><li><div>        $current_page = trim( strtolower( self::get( 'page' ) ) );&nbsp;</div></li><li><div>        $gf_pages = array( 'gf_edit_forms', 'gf_new_form', 'gf_entries', 'gf_settings', 'gf_export', 'gf_help' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return in_array( $current_page, $gf_pages );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Creates &quot;Forms&quot; left nav&nbsp;</div></li><li><div>    public static function create_menu() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $has_full_access = current_user_can( 'gform_full_access' );&nbsp;</div></li><li><div>        $min_cap = GFCommon::current_user_can_which( GFCommon::all_caps() );&nbsp;</div></li><li><div>        if ( empty( $min_cap ) ) {&nbsp;</div></li><li><div>            $min_cap = 'gform_full_access';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $addon_menus = array();&nbsp;</div></li><li><div>        $addon_menus = apply_filters( 'gform_addon_navigation', $addon_menus );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $parent_menu = self::get_parent_menu( $addon_menus );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add a top-level left nav&nbsp;</div></li><li><div>        $update_icon = GFCommon::has_update() && current_user_can( 'install_plugins' ) ? &quot;&lt;span title='&quot; . esc_attr( __( 'Update Available', 'gravityforms' ) ) . &quot;' class='update-plugins count-1'&gt;&lt;span class='update-count'&gt;1&lt;/span&gt;&lt;/span&gt;&quot; : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $admin_icon = self::get_admin_icon_b64( GFForms::is_gravity_page() ? '#fff' : false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_menu_page( __( 'Forms', 'gravityforms' ), __( 'Forms', 'gravityforms' ) . $update_icon, $has_full_access ? 'gform_full_access' : $min_cap, $parent_menu['name'], $parent_menu['callback'], $admin_icon, apply_filters( 'gform_menu_position', '16.9' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Adding submenu pages&nbsp;</div></li><li><div>        add_submenu_page( $parent_menu['name'], __( 'Forms', 'gravityforms' ), __( 'Forms', 'gravityforms' ), $has_full_access ? 'gform_full_access' : 'gravityforms_edit_forms', 'gf_edit_forms', array( 'RGForms', 'forms' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_submenu_page( $parent_menu['name'], __( 'New Form', 'gravityforms' ), __( 'New Form', 'gravityforms' ), $has_full_access ? 'gform_full_access' : 'gravityforms_create_form', 'gf_new_form', array( 'RGForms', 'new_form' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_submenu_page( $parent_menu['name'], __( 'Entries', 'gravityforms' ), __( 'Entries', 'gravityforms' ), $has_full_access ? 'gform_full_access' : 'gravityforms_view_entries', 'gf_entries', array( 'RGForms', 'all_leads_page' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_array( $addon_menus ) ) {&nbsp;</div></li><li><div>            foreach ( $addon_menus as $addon_menu ) {&nbsp;</div></li><li><div>                add_submenu_page( esc_html( $parent_menu['name'] ), esc_html( $addon_menu['label'] ), esc_html( $addon_menu['label'] ), $has_full_access ? 'gform_full_access' : $addon_menu['permission'], esc_html( $addon_menu['name'] ), $addon_menu['callback'] );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_submenu_page( $parent_menu['name'], __( 'Settings', 'gravityforms' ), __( 'Settings', 'gravityforms' ), $has_full_access ? 'gform_full_access' : 'gravityforms_view_settings', 'gf_settings', array( 'RGForms', 'settings_page' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_submenu_page( $parent_menu['name'], __( 'Import/Export', 'gravityforms' ), __( 'Import/Export', 'gravityforms' ), $has_full_access ? 'gform_full_access' : 'gravityforms_export_entries', 'gf_export', array( 'RGForms', 'export_page' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( current_user_can( 'install_plugins' ) ) {&nbsp;</div></li><li><div>            add_submenu_page( $parent_menu['name'], __( 'Updates', 'gravityforms' ), __( 'Updates', 'gravityforms' ), $has_full_access ? 'gform_full_access' : 'gravityforms_view_updates', 'gf_update', array( 'RGForms', 'update_page' ) );&nbsp;</div></li><li><div>            add_submenu_page( $parent_menu['name'], __( 'Add-Ons', 'gravityforms' ), __( 'Add-Ons', 'gravityforms' ), $has_full_access ? 'gform_full_access' : 'gravityforms_view_addons', 'gf_addons', array( 'RGForms', 'addons_page' ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_submenu_page( $parent_menu['name'], __( 'Help', 'gravityforms' ), __( 'Help', 'gravityforms' ), $has_full_access ? 'gform_full_access' : $min_cap, 'gf_help', array( 'RGForms', 'help_page' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function get_admin_icon_b64( $color = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // replace the hex color (default was #999999) to %s; it will be replaced by the passed $color&nbsp;</div></li><li><div>        $svg_xml = '&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;svg version=&quot;1.1&quot; id=&quot;Layer_1&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; x=&quot;0px&quot; y=&quot;0px&quot; viewBox=&quot;-15 77 581 640&quot; enable-background=&quot;new -15 77 581 640&quot; xml:space=&quot;preserve&quot;&gt;&lt;g id=&quot;Layer_2&quot;&gt;&lt;path fill=&quot;%s&quot; d=&quot;M489.5, 227L489.5, 227L315.9, 126.8c-22.1-12.8-58.4-12.8-80.5, 0L61.8, 227c-22.1, 12.8-40.3, 44.2-40.3, 69.7v200.5c0, 25.6, 18.1, 56.9, 40.3, 69.7l173.6, 100.2c22.1, 12.8, 58.4, 12.8, 80.5, 0L489.5, 567c22.2-12.8, 40.3-44.2, 40.3-69.7V296.8C529.8, 271.2, 511.7, 239.8, 489.5, 227z M401, 300.4v59.3H241v-59.3H401z M163.3, 490.9c-16.4, 0-29.6-13.3-29.6-29.6c0-16.4, 13.3-29.6, 29.6-29.6s29.6, 13.3, 29.6, 29.6C192.9, 477.6, 179.6, 490.9, 163.3, 490.9z M163.3, 359.7c-16.4, 0-29.6-13.3-29.6-29.6s13.3-29.6, 29.6-29.6s29.6, 13.3, 29.6, 29.6S179.6, 359.7, 163.3, 359.7z M241, 490.9v-59.3h160v59.3H241z&quot;/&gt;&lt;/g&gt;&lt;/svg&gt;';&nbsp;</div></li><li><div>        $svg_b64 = 'PD94&lt;BASE64_ENCODED&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( $color ) {&nbsp;</div></li><li><div>            $icon = sprintf( 'data:image/svg+xml;base64, %s', base64_encode( sprintf( $svg_xml, $color ) ) );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $icon = 'data:image/svg+xml;base64, ' . $svg_b64;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $icon;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Returns the parent menu item. It needs to be the same as the first sub-menu (otherwise WP will duplicate the main menu as a sub-menu)&nbsp;</div></li><li><div>    public static function get_parent_menu( $addon_menus ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( GFCommon::current_user_can_any( 'gravityforms_edit_forms' ) ) {&nbsp;</div></li><li><div>            $parent = array( 'name' =&gt; 'gf_edit_forms', 'callback' =&gt; array( 'RGForms', 'forms' ) );&nbsp;</div></li><li><div>        } else if ( GFCommon::current_user_can_any( 'gravityforms_create_form' ) ) {&nbsp;</div></li><li><div>            $parent = array( 'name' =&gt; 'gf_new_form', 'callback' =&gt; array( 'RGForms', 'new_form' ) );&nbsp;</div></li><li><div>        } else if ( GFCommon::current_user_can_any( 'gravityforms_view_entries' ) ) {&nbsp;</div></li><li><div>            $parent = array( 'name' =&gt; 'gf_entries', 'callback' =&gt; array( 'RGForms', 'all_leads_page' ) );&nbsp;</div></li><li><div>        } else if ( is_array( $addon_menus ) && sizeof( $addon_menus ) &gt; 0 ) {&nbsp;</div></li><li><div>            foreach ( $addon_menus as $addon_menu ) {&nbsp;</div></li><li><div>                if ( GFCommon::current_user_can_any( $addon_menu['permission'] ) ) {&nbsp;</div></li><li><div>                    $parent = array( 'name' =&gt; $addon_menu['name'], 'callback' =&gt; $addon_menu['callback'] );&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else if ( GFCommon::current_user_can_any( 'gravityforms_view_settings' ) ) {&nbsp;</div></li><li><div>            $parent = array( 'name' =&gt; 'gf_settings', 'callback' =&gt; array( 'RGForms', 'settings_page' ) );&nbsp;</div></li><li><div>        } else if ( GFCommon::current_user_can_any( 'gravityforms_export_entries' ) ) {&nbsp;</div></li><li><div>            $parent = array( 'name' =&gt; 'gf_export', 'callback' =&gt; array( 'RGForms', 'export_page' ) );&nbsp;</div></li><li><div>        } else if ( GFCommon::current_user_can_any( 'gravityforms_view_updates' ) ) {&nbsp;</div></li><li><div>            $parent = array( 'name' =&gt; 'gf_update', 'callback' =&gt; array( 'RGForms', 'update_page' ) );&nbsp;</div></li><li><div>        } else if ( GFCommon::current_user_can_any( 'gravityforms_view_addons' ) ) {&nbsp;</div></li><li><div>            $parent = array( 'name' =&gt; 'gf_addons', 'callback' =&gt; array( 'RGForms', 'addons_page' ) );&nbsp;</div></li><li><div>        } else if ( GFCommon::current_user_can_any( GFCommon::all_caps() ) ) {&nbsp;</div></li><li><div>            $parent = array( 'name' =&gt; 'gf_help', 'callback' =&gt; array( 'RGForms', 'help_page' ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $parent;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function modify_admin_title( $admin_title, $title ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $subview = rgget( 'subview' );&nbsp;</div></li><li><div>        $form_id = rgget( 'id' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! $form_id || rgget( 'page' ) != 'gf_edit_forms' || rgget( 'view' ) != 'settings' ) {&nbsp;</div></li><li><div>            return $admin_title;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_settings.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $setting_tabs = GFFormSettings::get_tabs( $form_id );&nbsp;</div></li><li><div>        $page_title = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $setting_tabs as $tab ) {&nbsp;</div></li><li><div>            if ( $tab['name'] == $subview ) {&nbsp;</div></li><li><div>                $page_title = $tab['label'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $page_title ) {&nbsp;</div></li><li><div>            $admin_title = sprintf( __( '%1$s &lsaquo; %2$s &#8212; WordPress', 'gravityforms' ), esc_html( $page_title ), $admin_title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $admin_title;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Parses the [gravityform shortcode and returns the front end form UI&nbsp;</div></li><li><div>    public static function parse_shortcode( $attributes, $content = null ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        extract(&nbsp;</div></li><li><div>            shortcode_atts(&nbsp;</div></li><li><div>                array(&nbsp;</div></li><li><div>                    'title' =&gt; true, &nbsp;</div></li><li><div>                    'description' =&gt; true, &nbsp;</div></li><li><div>                    'id' =&gt; 0, &nbsp;</div></li><li><div>                    'name' =&gt; '', &nbsp;</div></li><li><div>                    'field_values' =&gt; '', &nbsp;</div></li><li><div>                    'ajax' =&gt; false, &nbsp;</div></li><li><div>                    'tabindex' =&gt; 1, &nbsp;</div></li><li><div>                    'action' =&gt; 'form', &nbsp;</div></li><li><div> ), $attributes, 'gravityforms'&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $shortcode_string = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        switch ( $action ) {&nbsp;</div></li><li><div>            case 'conditional':&nbsp;</div></li><li><div>                $shortcode_string = GFCommon::conditional_shortcode( $attributes, $content );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            default:&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // don't retrieve form markup for custom actions&nbsp;</div></li><li><div>                if( $action && $action != 'form' ) {&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                //displaying form&nbsp;</div></li><li><div>                $title = strtolower( $title ) == 'false' ? false : true;&nbsp;</div></li><li><div>                $description = strtolower( $description ) == 'false' ? false : true;&nbsp;</div></li><li><div>                $field_values = htmlspecialchars_decode( $field_values );&nbsp;</div></li><li><div>                $field_values = str_replace( '&#038;', '&', $field_values );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $ajax = strtolower( $ajax ) == 'true' ? true : false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                //using name to lookup form if id is not specified&nbsp;</div></li><li><div>                if ( empty( $id ) ) {&nbsp;</div></li><li><div>                    $id = $name;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                parse_str( $field_values, $field_value_array ); //parsing query string like string for field values and placing them into an associative array&nbsp;</div></li><li><div>                $field_value_array = stripslashes_deep( $field_value_array );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $shortcode_string = self::get_form( $id, $title, $description, false, $field_value_array, $ajax, $tabindex );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $shortcode_string = apply_filters( &quot;gform_shortcode_{$action}&quot;, $shortcode_string, $attributes, $content );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $shortcode_string;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function include_addon_framework() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/includes/addon/class-gf-addon.php' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function include_feed_addon_framework() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/includes/addon/class-gf-feed-addon.php' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function include_payment_addon_framework() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/includes/addon/class-gf-payment-addon.php' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function include_gravity_api() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/includes/class-gravity-api.php' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //-------------------------------------------------&nbsp;</div></li><li><div>    //----------- AJAX --------------------------------&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function ajax_parse_request( $wp ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( isset( $_POST['gform_ajax'] ) ) {&nbsp;</div></li><li><div>            parse_str( $_POST['gform_ajax'] );&nbsp;</div></li><li><div>            $tabindex = isset( $tabindex ) ? absint( $tabindex ) : 1;&nbsp;</div></li><li><div>            require_once( GFCommon::get_base_path() . '/form_display.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $form_id = absint( $form_id );&nbsp;</div></li><li><div>            $display_title = (bool) $title;&nbsp;</div></li><li><div>            $display_description = (bool) $description;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $result = GFFormDisplay::get_form( $form_id, $display_title, $display_description, false, $_POST['gform_field_values'], true, $tabindex );&nbsp;</div></li><li><div>            die( $result );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //------------------------------------------------------&nbsp;</div></li><li><div>    //------------- PAGE/POST EDIT PAGE ---------------------&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function page_supports_add_form_button() {&nbsp;</div></li><li><div>        $is_post_edit_page = in_array( RG_CURRENT_PAGE, array( 'post.php', 'page.php', 'page-new.php', 'post-new.php' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $display_add_form_button = apply_filters( 'gform_display_add_form_button', $is_post_edit_page );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $display_add_form_button;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Action target that adds the 'Insert Form' button to the post/page edit screen&nbsp;</div></li><li><div>    public static function add_form_button() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $is_add_form_page = self::page_supports_add_form_button();&nbsp;</div></li><li><div>        if ( ! $is_add_form_page ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // do a version check for the new 3.5 UI&nbsp;</div></li><li><div>        $version = get_bloginfo( 'version' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $version &lt; 3.5 ) {&nbsp;</div></li><li><div>            // show button for v 3.4 and below&nbsp;</div></li><li><div>            $image_btn = GFCommon::get_base_url() . '/images/form-button.png';&nbsp;</div></li><li><div>            echo '&lt;a href=&quot;#TB_inline?width=480&inlineId=select_gravity_form&quot; class=&quot;thickbox&quot; id=&quot;add_gform&quot; title=&quot;' . esc_attr__( 'Add Gravity Form', 'gravityforms' ) . '&quot;&gt;&lt;img src=&quot;' . esc_url( $image_btn ) . '&quot; alt=&quot;' . esc_attr__( 'Add Gravity Form', 'gravityforms' ) . '&quot; /&gt;&lt;/a&gt;';&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            // display button matching new UI&nbsp;</div></li><li><div>            echo '&lt;style&gt;.gform_media_icon{&nbsp;</div></li><li><div>                    background-position: center center;&nbsp;</div></li><li><div>                    background-repeat: no-repeat;&nbsp;</div></li><li><div>                    background-size: 16px auto;&nbsp;</div></li><li><div>                    float: left;&nbsp;</div></li><li><div>                    height: 16px;&nbsp;</div></li><li><div>                    margin: 0;&nbsp;</div></li><li><div>                    text-align: center;&nbsp;</div></li><li><div>                    width: 16px;&nbsp;</div></li><li><div>                    padding-top:10px;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    .gform_media_icon:before{&nbsp;</div></li><li><div>                    color: #999;&nbsp;</div></li><li><div>                    padding: 7px 0;&nbsp;</div></li><li><div>                    transition: all 0.1s ease-in-out 0s;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    .wp-core-ui a.gform_media_link{&nbsp;</div></li><li><div>                     padding-left: 0.4em;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                 &lt;/style&gt;&nbsp;</div></li><li><div>                  &lt;a href=&quot;#&quot; class=&quot;button gform_media_link&quot; id=&quot;add_gform&quot; title=&quot;' . esc_attr__( 'Add Gravity Form', 'gravityforms' ) . '&quot;&gt;&lt;div class=&quot;gform_media_icon svg&quot; style=&quot;background-image: url(\'' . self::get_admin_icon_b64()  . '\')&quot;&gt;&lt;br /&gt;&lt;/div&gt;&lt;div style=&quot;padding-left: 20px;&quot;&gt;' . esc_html__( 'Add Form', 'gravityforms' ) . '&lt;/div&gt;&lt;/a&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Action target that displays the popup to insert a form to a post/page&nbsp;</div></li><li><div>    public static function add_mce_popup() {&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;script&gt;&nbsp;</div></li><li><div>            function InsertForm() {&nbsp;</div></li><li><div>                var form_id = jQuery(&quot;#add_form_id&quot;).val();&nbsp;</div></li><li><div>                if (form_id == &quot;&quot;) {&nbsp;</div></li><li><div>                    alert(&lt;?php echo json_encode( __( 'Please select a form', 'gravityforms' ) ); ?&gt;);&nbsp;</div></li><li><div>                    return;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                var form_name = jQuery(&quot;#add_form_id option[value='&quot; + form_id + &quot;']&quot;).text().replace(/[\[\]]/g, '');&nbsp;</div></li><li><div>                var display_title = jQuery(&quot;#display_title&quot;).is(&quot;:checked&quot;);&nbsp;</div></li><li><div>                var display_description = jQuery(&quot;#display_description&quot;).is(&quot;:checked&quot;);&nbsp;</div></li><li><div>                var ajax = jQuery(&quot;#gform_ajax&quot;).is(&quot;:checked&quot;);&nbsp;</div></li><li><div>                var title_qs = !display_title ? &quot; title=\&quot;false\&quot;&quot; : &quot;&quot;;&nbsp;</div></li><li><div>                var description_qs = !display_description ? &quot; description=\&quot;false\&quot;&quot; : &quot;&quot;;&nbsp;</div></li><li><div>                var ajax_qs = ajax ? &quot; ajax=\&quot;true\&quot;&quot; : &quot;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                window.send_to_editor(&quot;[gravityform id=\&quot;&quot; + form_id + &quot;\&quot; name=\&quot;&quot; + form_name + &quot;\&quot;&quot; + title_qs + description_qs + ajax_qs + &quot;]&quot;);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        &lt;/script&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;div id=&quot;select_gravity_form&quot; style=&quot;display:none;&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;div id=&quot;gform-shortcode-ui-wrap&quot; class=&quot;wrap &lt;?php echo GFCommon::get_browser_class() ?&gt;&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;div id=&quot;gform-shortcode-ui-container&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //------------------------------------------------------&nbsp;</div></li><li><div>    //------------- PLUGINS PAGE ---------------------------&nbsp;</div></li><li><div>    //------------------------------------------------------&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function plugin_settings_link( $links, $file ) {&nbsp;</div></li><li><div>        if ( $file != plugin_basename( __FILE__ ) ) {&nbsp;</div></li><li><div>            return $links;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_unshift( $links, '&lt;a href=&quot;' . esc_url( admin_url( 'admin.php' ) ) . '?page=gf_settings&quot;&gt;' . esc_html__( 'Settings', 'gravityforms' ) . '&lt;/a&gt;' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $links;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Displays message on Plugin's page&nbsp;</div></li><li><div>    public static function plugin_row( $plugin_name ) {&nbsp;</div></li><li><div>        $key = GFCommon::get_key();&nbsp;</div></li><li><div>        $version_info = GFCommon::get_version_info();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! rgar( $version_info, 'is_valid_key' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $plugin_name = 'gravityforms/gravityforms.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $new_version = version_compare( GFCommon::$version, $version_info['version'], '&lt;' ) ? esc_html__( 'There is a new version of Gravity Forms available.', 'gravityforms' ) . ' &lt;a class=&quot;thickbox&quot; title=&quot;Gravity Forms&quot; href=&quot;plugin-install.php?tab=plugin-information&plugin=gravityforms&TB_iframe=true&width=640&height=808&quot;&gt;' . sprintf( esc_html__( 'View version %s Details', 'gravityforms' ), $version_info['version'] ) . '&lt;/a&gt;. ' : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            echo '&lt;/tr&gt;&lt;tr class=&quot;plugin-update-tr&quot;&gt;&lt;td colspan=&quot;3&quot; class=&quot;plugin-update&quot;&gt;&lt;div class=&quot;update-message&quot;&gt;' . $new_version . sprintf( esc_html__( '%sRegister%s your copy of Gravity Forms to receive access to automatic upgrades and support. Need a license key? %sPurchase one now%s.', 'gravityforms' ), '&lt;a href=&quot;' . admin_url() . 'admin.php?page=gf_settings&quot;&gt;', '&lt;/a&gt;', '&lt;a href=&quot;http://www.gravityforms.com&quot;&gt;', '&lt;/a&gt;' ) . '&lt;/div&gt;&lt;/td&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Displays current version details on Plugin's page&nbsp;</div></li><li><div>    public static function display_changelog() {&nbsp;</div></li><li><div>        if ( $_REQUEST['plugin'] != 'gravityforms' ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $page_text = self::get_changelog();&nbsp;</div></li><li><div>        echo $page_text;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        exit;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function get_changelog() {&nbsp;</div></li><li><div>        $key = GFCommon::get_key();&nbsp;</div></li><li><div>        $body = &quot;key=$key&quot;;&nbsp;</div></li><li><div>        $options = array( 'method' =&gt; 'POST', 'timeout' =&gt; 3, 'body' =&gt; $body );&nbsp;</div></li><li><div>        $options['headers'] = array(&nbsp;</div></li><li><div>            'Content-Type' =&gt; 'application/x-www-form-urlencoded; charset=' . get_option( 'blog_charset' ), &nbsp;</div></li><li><div>            'Content-Length' =&gt; strlen( $body ), &nbsp;</div></li><li><div>            'User-Agent' =&gt; 'WordPress/' . get_bloginfo( 'version' ), &nbsp;</div></li><li><div>            'Referer' =&gt; get_bloginfo( 'url' )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $raw_response = GFCommon::post_to_manager( 'changelog.php', GFCommon::get_remote_request_params(), $options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_wp_error( $raw_response ) || 200 != $raw_response['response']['code'] ) {&nbsp;</div></li><li><div>            $page_text = sprintf( esc_html__( 'Oops!! Something went wrong. %sPlease try again or %scontact us%s.', 'gravityforms' ), '&lt;br/&gt;', &quot;&lt;a href='http://www.gravityforms.com'&gt;&quot;, '&lt;/a&gt;' );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $page_text = $raw_response['body'];&nbsp;</div></li><li><div>            if ( substr( $page_text, 0, 10 ) != '&lt;!--GFM--&gt;' ) {&nbsp;</div></li><li><div>                $page_text = '';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            else {&nbsp;</div></li><li><div>                $page_text = '&lt;div style=&quot;background-color:white&quot;&gt;' . $page_text . '&lt;div&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return stripslashes( $page_text );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //------------------------------------------------------&nbsp;</div></li><li><div>    //-------------- DASHBOARD PAGE -------------------------&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Registers the dashboard widget&nbsp;</div></li><li><div>    public static function dashboard_setup() {&nbsp;</div></li><li><div>        $dashboard_title = apply_filters( 'gform_dashboard_title', __( 'Forms', 'gravityforms' ) );&nbsp;</div></li><li><div>        wp_add_dashboard_widget( 'rg_forms_dashboard', $dashboard_title, array( 'RGForms', 'dashboard' ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //Displays the dashboard UI&nbsp;</div></li><li><div>    public static function dashboard() {&nbsp;</div></li><li><div>        $forms = RGFormsModel::get_form_summary();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( sizeof( $forms ) &gt; 0 ) {&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>            &lt;table class=&quot;widefat gf_dashboard_view&quot; cellspacing=&quot;0&quot; style=&quot;border:0px;&quot;&gt;&nbsp;</div></li><li><div>                &lt;thead&gt;&nbsp;</div></li><li><div>                &lt;tr&gt;&nbsp;</div></li><li><div>                    &lt;td class=&quot;gf_dashboard_form_title_header&quot; style=&quot;text-align:left; padding:8px 18px!important; font-weight:bold;&quot;&gt;&nbsp;</div></li><li><div>                        &lt;i&gt;&lt;?php esc_html_e( 'Title', 'gravityforms' ) ?&gt;&lt;/i&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                    &lt;td class=&quot;gf_dashboard_entries_unread_header&quot; style=&quot;text-align:center; padding:8px 18px!important; font-weight:bold;&quot;&gt;&nbsp;</div></li><li><div>                        &lt;i&gt;&lt;?php esc_html_e( 'Unread', 'gravityforms' ) ?&gt;&lt;/i&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                    &lt;td class=&quot;gf_dashboard_entries_total_header&quot; style=&quot;text-align:center; padding:8px 18px!important; font-weight:bold;&quot;&gt;&nbsp;</div></li><li><div>                        &lt;i&gt;&lt;?php esc_html_e( 'Total', 'gravityforms' ) ?&gt;&lt;/i&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                &lt;/tr&gt;&nbsp;</div></li><li><div>                &lt;/thead&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;tbody class=&quot;list:user user-list&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                foreach ( $forms as $form ) {&nbsp;</div></li><li><div>                    $date_display = GFCommon::format_date( $form['last_lead_date'] );&nbsp;</div></li><li><div>                    if ( ! empty( $form['total_leads'] ) ) {&nbsp;</div></li><li><div>                        ?&gt;&nbsp;</div></li><li><div>                        &lt;tr class='author-self status-inherit' valign=&quot;top&quot;&gt;&nbsp;</div></li><li><div>                            &lt;td class=&quot;gf_dashboard_form_title column-title&quot; style=&quot;padding:8px 18px;&quot;&gt;&nbsp;</div></li><li><div>                                &lt;a &lt;?php echo $form['unread_count'] &gt; 0 ? &quot;class='form_title_unread' style='font-weight:bold;'&quot; : '' ?&gt; href=&quot;admin.php?page=gf_entries&view=entries&id=&lt;?php echo absint( $form['id'] ) ?&gt;&quot; title=&quot;&lt;?php echo esc_attr( $form['title'] ) ?&gt; : &lt;?php esc_attr_e( 'View All Entries', 'gravityforms' ) ?&gt;&quot;&gt;&lt;?php echo esc_html( $form['title'] ) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                            &lt;/td&gt;&nbsp;</div></li><li><div>                            &lt;td class=&quot;gf_dashboard_entries_unread column-date&quot; style=&quot;padding:8px 18px; text-align:center;&quot;&gt;&nbsp;</div></li><li><div>                                &lt;a &lt;?php echo $form['unread_count'] &gt; 0 ? &quot;class='form_entries_unread' style='font-weight:bold;'&quot; : '' ?&gt; href=&quot;admin.php?page=gf_entries&view=entries&filter=unread&id=&lt;?php echo absint( $form['id'] ) ?&gt;&quot; title=&quot;&lt;?php printf( esc_attr__( 'Last Entry: %s', 'gravityforms' ), $date_display ); ?&gt;&quot;&gt;&lt;?php echo absint( $form['unread_count'] ) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                            &lt;/td&gt;&nbsp;</div></li><li><div>                            &lt;td class=&quot;gf_dashboard_entries_total column-date&quot; style=&quot;padding:8px 18px; text-align:center;&quot;&gt;&nbsp;</div></li><li><div>                                &lt;a href=&quot;admin.php?page=gf_entries&view=entries&id=&lt;?php echo absint( $form['id'] ) ?&gt;&quot; title=&quot;&lt;?php esc_attr_e( 'View All Entries', 'gravityforms' ) ?&gt;&quot;&gt;&lt;?php echo absint( $form['total_leads'] ) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                            &lt;/td&gt;&nbsp;</div></li><li><div>                        &lt;/tr&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                &lt;/tbody&gt;&nbsp;</div></li><li><div>            &lt;/table&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;?php if ( GFCommon::current_user_can_any( 'gravityforms_edit_forms' ) ) : ?&gt;&nbsp;</div></li><li><div>                &lt;p class=&quot;textright&quot;&gt;&nbsp;</div></li><li><div>                &lt;a class=&quot;gf_dashboard_button button&quot; href=&quot;admin.php?page=gf_edit_forms&quot;&gt;&lt;?php esc_html_e( 'View All Forms', 'gravityforms' ) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>            &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>            &lt;/p&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;gf_dashboard_noforms_notice&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php echo sprintf( esc_html__( &quot;You don't have any forms. Let's go %s create one %s!&quot;, 'gravityforms' ), '&lt;a href=&quot;admin.php?page=gf_new_form&quot;&gt;', '&lt;/a&gt;' ); ?&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( GFCommon::current_user_can_any( 'gravityforms_view_updates' ) && ( ! function_exists( 'is_multisite' ) || ! is_multisite() || is_super_admin() ) ) {&nbsp;</div></li><li><div>            //displaying update message if there is an update and user has permission&nbsp;</div></li><li><div>            self::dashboard_update_message();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function dashboard_update_message() {&nbsp;</div></li><li><div>        $version_info = GFCommon::get_version_info();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //don't display a message if use has dismissed the message for this version&nbsp;</div></li><li><div>        $ary_dismissed = get_option( 'gf_dismissed_upgrades' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $is_dismissed = ! empty( $ary_dismissed ) && in_array( $version_info['version'], $ary_dismissed );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $is_dismissed ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( version_compare( GFCommon::$version, $version_info['version'], '&lt;' ) ) {&nbsp;</div></li><li><div>            $auto_upgrade = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            /**if($version_info['is_valid_key']) {&nbsp;</div></li><li><div>                $plugin_file = 'gravityforms/gravityforms.php';&nbsp;</div></li><li><div>                $upgrade_url = wp_nonce_url('update.php?action=upgrade-plugin&amp;plugin=' . urlencode($plugin_file), 'upgrade-plugin_' . $plugin_file);&nbsp;</div></li><li><div>                $auto_upgrade = sprintf(__(&quot; or %sUpgrade Automatically%s&quot;, 'gravityforms'), &quot;&lt;a href='{$upgrade_url}'&gt;&quot;, '&lt;/a&gt;');&nbsp;</div></li><li><div>            }*/&nbsp;</div></li><li><div>            $message = sprintf( esc_html__( 'There is an update available for Gravity Forms. %sView Details%s %s', 'gravityforms' ), &quot;&lt;a href='admin.php?page=gf_update'&gt;&quot;, '&lt;/a&gt;', $auto_upgrade );&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>            &lt;div class='updated' style='padding:15px; position:relative;' id='gf_dashboard_message'&gt;&lt;?php echo $message ?&gt;&nbsp;</div></li><li><div>                &lt;a href=&quot;javascript:void(0);&quot; onclick=&quot;GFDismissUpgrade();&quot; style='float:right;'&gt;&lt;?php esc_html_e( 'Dismiss', 'gravityforms' ) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>            &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>                function GFDismissUpgrade() {&nbsp;</div></li><li><div>                    jQuery(&quot;#gf_dashboard_message&quot;).slideUp();&nbsp;</div></li><li><div>                    jQuery.post(ajaxurl, {action: 'rg_dismiss_upgrade', version: &lt;?php echo json_encode( $version_info['version'] ); ?&gt;});&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            &lt;/script&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function dashboard_dismiss_upgrade() {&nbsp;</div></li><li><div>        $ary = get_option( 'gf_dismissed_upgrades' );&nbsp;</div></li><li><div>        if ( ! is_array( $ary ) ) {&nbsp;</div></li><li><div>            $ary = array();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $ary[] = $_POST['version'];&nbsp;</div></li><li><div>        update_option( 'gf_dismissed_upgrades', $ary );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //------------------------------------------------------&nbsp;</div></li><li><div>    //--------------- ALL OTHER PAGES ----------------------&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function register_scripts() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $base_url = GFCommon::get_base_url();&nbsp;</div></li><li><div>        $version = GFForms::$version;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $min = defined( 'SCRIPT_DEBUG' ) && SCRIPT_DEBUG || isset( $_GET['gform_debug'] ) ? '' : '.min';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        wp_register_script( 'gform_chosen', $base_url . '/js/chosen.jquery.min.js', array( 'jquery' ), $version );&nbsp;</div></li><li><div>        wp_register_script( 'gform_conditional_logic', $base_url . &quot;/js/conditional_logic{$min}.js&quot;, array( 'jquery', 'gform_gravityforms' ), $version );&nbsp;</div></li><li><div>        wp_register_script( 'gform_datepicker_init', $base_url . &quot;/js/datepicker{$min}.js&quot;, array( 'jquery', 'jquery-ui-datepicker', 'gform_gravityforms' ), $version, true );&nbsp;</div></li><li><div>        wp_register_script( 'gform_floatmenu', $base_url . &quot;/js/floatmenu_init{$min}.js&quot;, array( 'jquery' ), $version );&nbsp;</div></li><li><div>        wp_register_script( 'gform_form_admin', $base_url . &quot;/js/form_admin{$min}.js&quot;, array( 'jquery', 'jquery-ui-autocomplete', 'gform_placeholder' ), $version );&nbsp;</div></li><li><div>        wp_register_script( 'gform_form_editor', $base_url . &quot;/js/form_editor{$min}.js&quot;, array( 'jquery', 'gform_json', 'gform_placeholder' ), $version );&nbsp;</div></li><li><div>        wp_register_script( 'gform_forms', $base_url . &quot;/js/forms{$min}.js&quot;, array( 'jquery' ), $version );&nbsp;</div></li><li><div>        wp_register_script( 'gform_gravityforms', $base_url . &quot;/js/gravityforms{$min}.js&quot;, array( 'jquery', 'gform_json' ), $version );&nbsp;</div></li><li><div>        wp_register_script( 'gform_json', $base_url . '/js/jquery.json.js', array( 'jquery' ), $version, true );&nbsp;</div></li><li><div>        wp_register_script( 'gform_masked_input', $base_url . '/js/jquery.maskedinput.min.js', array( 'jquery' ), $version );&nbsp;</div></li><li><div>        wp_register_script( 'gform_menu', $base_url . &quot;/js/menu{$min}.js&quot;, array( 'jquery' ), $version );&nbsp;</div></li><li><div>        wp_register_script( 'gform_placeholder', $base_url . '/js/placeholders.jquery.min.js', array( 'jquery' ), $version );&nbsp;</div></li><li><div>        wp_register_script( 'gform_tooltip_init', $base_url . &quot;/js/tooltip_init{$min}.js&quot;, array( 'jquery-ui-tooltip' ), $version );&nbsp;</div></li><li><div>        wp_register_script( 'gform_textarea_counter', $base_url . '/js/jquery.textareaCounter.plugin.js', array( 'jquery' ), $version );&nbsp;</div></li><li><div>        wp_register_script( 'gform_field_filter', $base_url . &quot;/js/gf_field_filter{$min}.js&quot;, array( 'jquery', 'gform_datepicker_init' ), $version );&nbsp;</div></li><li><div>        wp_register_script( 'gform_shortcode_ui', $base_url . &quot;/js/shortcode-ui{$min}.js&quot;, array( 'jquery', 'wp-backbone' ), $version, true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        wp_register_style( 'gform_shortcode_ui', $base_url . &quot;/css/shortcode-ui{$min}.css&quot;, array(), $version );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // only required for WP versions prior to 3.3&nbsp;</div></li><li><div>        wp_register_script( 'gf_thickbox', $base_url . '/js/thickbox.js', array(), $version );&nbsp;</div></li><li><div>        wp_register_style( 'gf_thickbox', $base_url . '/js/thickbox.css', array(), $version );&nbsp;</div></li><li><div>        wp_localize_script(&nbsp;</div></li><li><div>            'gf_thickbox', 'thickboxL10n', array(&nbsp;</div></li><li><div>                'next' =&gt; esc_html__( 'Next &gt;', 'gravityforms' ), &nbsp;</div></li><li><div>                'prev' =&gt; esc_html__( '&lt; Prev', 'gravityforms' ), &nbsp;</div></li><li><div>                'image' =&gt; esc_html__( 'Image', 'gravityforms' ), &nbsp;</div></li><li><div>                'of' =&gt; esc_html__( 'of', 'gravityforms' ), &nbsp;</div></li><li><div>                'close' =&gt; esc_html__( 'Close', 'gravityforms' ), &nbsp;</div></li><li><div>                'noiframes' =&gt; esc_html__( 'This feature requires inline frames. You have iframes disabled or your browser does not support them.', 'gravityforms' ), &nbsp;</div></li><li><div>                'loadingAnimation' =&gt; includes_url( 'js/thickbox/loadingAnimation.gif' ), &nbsp;</div></li><li><div>                'closeImage' =&gt; includes_url( 'js/thickbox/tb-close.png' )&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function enqueue_admin_scripts( $hook ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $scripts = array();&nbsp;</div></li><li><div>        $page = self::get_page();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        switch ( $page ) {&nbsp;</div></li><li><div>            case 'new_form' :&nbsp;</div></li><li><div>            case 'form_list':&nbsp;</div></li><li><div>                $scripts = array(&nbsp;</div></li><li><div>                    'gform_gravityforms', &nbsp;</div></li><li><div>                    'gform_json', &nbsp;</div></li><li><div>                    'gform_form_admin', &nbsp;</div></li><li><div>                    'thickbox', &nbsp;</div></li><li><div>                    'sack', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'form_settings':&nbsp;</div></li><li><div>                $scripts = array(&nbsp;</div></li><li><div>                    'gform_gravityforms', &nbsp;</div></li><li><div>                    'gform_forms', &nbsp;</div></li><li><div>                    'gform_json', &nbsp;</div></li><li><div>                    'gform_form_admin', &nbsp;</div></li><li><div>                    'gform_placeholder', &nbsp;</div></li><li><div>                    'jquery-ui-datepicker', &nbsp;</div></li><li><div>                    'gform_masked_input', &nbsp;</div></li><li><div>                    'jquery-ui-sortable', &nbsp;</div></li><li><div>                    'sack', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'form_editor':&nbsp;</div></li><li><div>                $thickbox = ! GFCommon::is_wp_version( '3.3' ) ? 'gf_thickbox' : 'thickbox';&nbsp;</div></li><li><div>                $scripts = array(&nbsp;</div></li><li><div>                    $thickbox, &nbsp;</div></li><li><div>                    'jquery-ui-core', &nbsp;</div></li><li><div>                    'jquery-ui-sortable', &nbsp;</div></li><li><div>                    'jquery-ui-draggable', &nbsp;</div></li><li><div>                    'jquery-ui-droppable', &nbsp;</div></li><li><div>                    'jquery-ui-tabs', &nbsp;</div></li><li><div>                    'gform_gravityforms', &nbsp;</div></li><li><div>                    'gform_forms', &nbsp;</div></li><li><div>                    'gform_json', &nbsp;</div></li><li><div>                    'gform_form_admin', &nbsp;</div></li><li><div>                    'gform_floatmenu', &nbsp;</div></li><li><div>                    'gform_menu', &nbsp;</div></li><li><div>                    'gform_placeholder', &nbsp;</div></li><li><div>                    'jquery-ui-autocomplete', &nbsp;</div></li><li><div>                    'sack', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( wp_is_mobile() ) {&nbsp;</div></li><li><div>                    $scripts[] = 'jquery-touch-punch';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'entry_detail':&nbsp;</div></li><li><div>                $scripts = array(&nbsp;</div></li><li><div>                    'gform_json', &nbsp;</div></li><li><div>                    'sack', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'entry_detail_edit':&nbsp;</div></li><li><div>                $scripts = array(&nbsp;</div></li><li><div>                    'gform_gravityforms', &nbsp;</div></li><li><div>                    'plupload-all', &nbsp;</div></li><li><div>                    'sack', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'entry_list':&nbsp;</div></li><li><div>                $scripts = array(&nbsp;</div></li><li><div>                    'wp-lists', &nbsp;</div></li><li><div>                    'wp-ajax-response', &nbsp;</div></li><li><div>                    'thickbox', &nbsp;</div></li><li><div>                    'gform_json', &nbsp;</div></li><li><div>                    'thickbox', &nbsp;</div></li><li><div>                    'gform_field_filter', &nbsp;</div></li><li><div>                    'sack', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'notification_list':&nbsp;</div></li><li><div>                $scripts = array(&nbsp;</div></li><li><div>                    'gform_forms', &nbsp;</div></li><li><div>                    'gform_json', &nbsp;</div></li><li><div>                    'gform_form_admin', &nbsp;</div></li><li><div>                    'sack', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'notification_new':&nbsp;</div></li><li><div>            case 'notification_edit':&nbsp;</div></li><li><div>                $scripts = array(&nbsp;</div></li><li><div>                    'jquery-ui-autocomplete', &nbsp;</div></li><li><div>                    'gform_gravityforms', &nbsp;</div></li><li><div>                    'gform_placeholder', &nbsp;</div></li><li><div>                    'gform_form_admin', &nbsp;</div></li><li><div>                    'gform_forms', &nbsp;</div></li><li><div>                    'gform_json', &nbsp;</div></li><li><div>                    'sack', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'confirmation':&nbsp;</div></li><li><div>                $scripts = array(&nbsp;</div></li><li><div>                    'gform_form_admin', &nbsp;</div></li><li><div>                    'gform_forms', &nbsp;</div></li><li><div>                    'gform_gravityforms', &nbsp;</div></li><li><div>                    'gform_placeholder', &nbsp;</div></li><li><div>                    'gform_json', &nbsp;</div></li><li><div>                    'wp-pointer', &nbsp;</div></li><li><div>                    'sack', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'addons':&nbsp;</div></li><li><div>                $scripts = array(&nbsp;</div></li><li><div>                    'thickbox', &nbsp;</div></li><li><div>                    'sack', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'export_entry':&nbsp;</div></li><li><div>                $scripts = array(&nbsp;</div></li><li><div>                    'jquery-ui-datepicker', &nbsp;</div></li><li><div>                    'gform_form_admin', &nbsp;</div></li><li><div>                    'gform_field_filter', &nbsp;</div></li><li><div>                    'sack', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'updates' :&nbsp;</div></li><li><div>                $scripts = array(&nbsp;</div></li><li><div>                    'thickbox', &nbsp;</div></li><li><div>                    'sack', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( self::page_supports_add_form_button() ) {&nbsp;</div></li><li><div>            require_once( GFCommon::get_base_path() . '/tooltips.php' );&nbsp;</div></li><li><div>            wp_enqueue_script( 'gform_shortcode_ui' );&nbsp;</div></li><li><div>            wp_enqueue_style( 'gform_shortcode_ui' );&nbsp;</div></li><li><div>            wp_localize_script( 'gform_shortcode_ui', 'gfShortcodeUIData', array(&nbsp;</div></li><li><div>                'shortcodes' =&gt; self::get_shortcodes(), &nbsp;</div></li><li><div>                'previewNonce' =&gt; wp_create_nonce( 'gf-shortcode-ui-preview' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                /**&nbsp;</div></li><li><div>                 * A filter that allows the enabling (false) or disabling (true) of a shortcode preview of a form&nbsp;</div></li><li><div>                 */&nbsp;</div></li><li><div>                'previewDisabled' =&gt; apply_filters( 'gform_shortcode_preview_disabled', true ), &nbsp;</div></li><li><div>                'strings' =&gt; array(&nbsp;</div></li><li><div>                    'pleaseSelectAForm' =&gt; esc_html__( 'Please select a form.', 'gravityforms' ), &nbsp;</div></li><li><div>                    'errorLoadingPreview' =&gt; esc_html__( 'Failed to load the preview for this form.', 'gravityforms' ), &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $scripts ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $scripts as $script ) {&nbsp;</div></li><li><div>            wp_enqueue_script( $script );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        GFCommon::localize_gform_gravityforms_multifile();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Gets current page name&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return bool|string Page name or false&nbsp;</div></li><li><div>     *   Page names:&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     *   new_form&nbsp;</div></li><li><div>     *   form_list&nbsp;</div></li><li><div>     *   form_editor&nbsp;</div></li><li><div>     *   form_settings&nbsp;</div></li><li><div>     *   confirmation&nbsp;</div></li><li><div>     *   notification_list&nbsp;</div></li><li><div>     *   notification_new&nbsp;</div></li><li><div>     *   notification_edit&nbsp;</div></li><li><div>     *   entry_list&nbsp;</div></li><li><div>     *   entry_detail&nbsp;</div></li><li><div>     *   entry_detail_edit&nbsp;</div></li><li><div>     *   settings&nbsp;</div></li><li><div>     *   addons&nbsp;</div></li><li><div>     *   export_entry&nbsp;</div></li><li><div>     *   export_form&nbsp;</div></li><li><div>     *   import_form&nbsp;</div></li><li><div>     *   updates&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function get_page() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_new_form' ) {&nbsp;</div></li><li><div>            return 'new_form';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_edit_forms' && ! rgget( 'id' ) ) {&nbsp;</div></li><li><div>            return 'form_list';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_edit_forms' && ! rgget( 'view' ) ) {&nbsp;</div></li><li><div>            return 'form_editor';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_edit_forms' && rgget( 'view' ) == 'settings' && ( ! rgget( 'subview' ) || rgget( 'subview' ) == 'settings' ) ) {&nbsp;</div></li><li><div>            return 'form_settings';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_edit_forms' && rgget( 'view' ) == 'settings' && rgget( 'subview' ) == 'confirmation' ) {&nbsp;</div></li><li><div>            return 'confirmation';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_edit_forms' && rgget( 'view' ) == 'settings' && rgget( 'subview' ) == 'notification' && rgget( 'nid' ) ) {&nbsp;</div></li><li><div>            return 'notification_edit';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_edit_forms' && rgget( 'view' ) == 'settings' && rgget( 'subview' ) == 'notification' && isset( $_GET['nid'] ) ) {&nbsp;</div></li><li><div>            return 'notification_edit';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_edit_forms' && rgget( 'view' ) == 'settings' && rgget( 'subview' ) == 'notification' ) {&nbsp;</div></li><li><div>            return 'notification_list';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_entries' && ( ! rgget( 'view' ) || rgget( 'view' ) == 'entries' ) ) {&nbsp;</div></li><li><div>            return 'entry_list';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_entries' && rgget( 'view' ) == 'entry' && isset( $_POST['screen_mode'] ) && $_POST['screen_mode'] == 'edit' ) {&nbsp;</div></li><li><div>            return 'entry_detail_edit';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_entries' && rgget( 'view' ) == 'entry' ) {&nbsp;</div></li><li><div>            return 'entry_detail';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_settings' ) {&nbsp;</div></li><li><div>            return 'settings';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_addons' ) {&nbsp;</div></li><li><div>            return 'addons';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_export' && ( rgget( 'view' ) == 'export_entry' || ! isset( $_GET['view'] ) ) ) {&nbsp;</div></li><li><div>            return 'export_entry';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_export' && rgget( 'view' ) == 'export_form' ) {&nbsp;</div></li><li><div>            return 'export_form';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_export' && rgget( 'view' ) == 'import_form' ) {&nbsp;</div></li><li><div>            return 'import_form';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( rgget( 'page' ) == 'gf_update' ) {&nbsp;</div></li><li><div>            return 'updates';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function get_form( $form_id, $display_title = true, $display_description = true, $force_display = false, $field_values = null, $ajax = false, $tabindex = 1 ) {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_display.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return GFFormDisplay::get_form( $form_id, $display_title, $display_description, $force_display, $field_values, $ajax, $tabindex );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function new_form() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( self::maybe_display_installation_wizard() ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        };&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        self::form_list_page();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function enqueue_scripts() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_display.php' );&nbsp;</div></li><li><div>        GFFormDisplay::enqueue_scripts();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function print_form_scripts( $form, $ajax ) {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_display.php' );&nbsp;</div></li><li><div>        GFFormDisplay::print_form_scripts( $form, $ajax );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function forms_page( $form_id ) {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_detail.php' );&nbsp;</div></li><li><div>        GFFormDetail::forms_page( $form_id );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function settings_page() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( self::maybe_display_installation_wizard() ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        };&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/settings.php' );&nbsp;</div></li><li><div>        GFSettings::settings_page();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function add_settings_page( $name, $handle = '', $icon_path = '' ) {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/settings.php' );&nbsp;</div></li><li><div>        GFSettings::add_settings_page( $name, $handle, $icon_path );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function help_page() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/help.php' );&nbsp;</div></li><li><div>        GFHelp::help_page();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function export_page() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( self::maybe_display_installation_wizard() ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        };&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/export.php' );&nbsp;</div></li><li><div>        GFExport::export_page();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function update_page() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/update.php' );&nbsp;</div></li><li><div>        GFUpdate::update_page();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function addons_page() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( self::maybe_display_installation_wizard() ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        };&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        wp_print_styles( array( 'thickbox' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $plugins = get_plugins();&nbsp;</div></li><li><div>        $installed_plugins = array();&nbsp;</div></li><li><div>        foreach ( $plugins as $key =&gt; $plugin ) {&nbsp;</div></li><li><div>            $is_active = is_plugin_active( $key );&nbsp;</div></li><li><div>            $installed_plugin = array( 'plugin' =&gt; $key, 'name' =&gt; $plugin['Name'], 'is_active' =&gt; $is_active );&nbsp;</div></li><li><div>            $installed_plugin['activation_url'] = $is_active ? '' : wp_nonce_url( &quot;plugins.php?action=activate&plugin={$key}&quot;, &quot;activate-plugin_{$key}&quot; );&nbsp;</div></li><li><div>            $installed_plugin['deactivation_url'] = ! $is_active ? '' : wp_nonce_url( &quot;plugins.php?action=deactivate&plugin={$key}&quot;, &quot;deactivate-plugin_{$key}&quot; );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $installed_plugins[] = $installed_plugin;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $nonces = self::get_addon_nonces();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $body = array( 'plugins' =&gt; urlencode( serialize( $installed_plugins ) ), 'nonces' =&gt; urlencode( serialize( $nonces ) ), 'key' =&gt; GFCommon::get_key() );&nbsp;</div></li><li><div>        $options = array( 'body' =&gt; $body, 'headers' =&gt; array( 'Referer' =&gt; get_bloginfo( 'url' ) ), 'timeout' =&gt; 15 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $raw_response = GFCommon::post_to_manager( 'api.php', &quot;op=plugin_browser&{$_SERVER['QUERY_STRING']}&quot;, $options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_wp_error( $raw_response ) || $raw_response['response']['code'] != 200 ) {&nbsp;</div></li><li><div>            echo &quot;&lt;div class='error' style='margin-top:50px; padding:20px;'&gt;&quot; . esc_html__( 'Add-On browser is currently unavailable. Please try again later.', 'gravityforms' ) . '&lt;/div&gt;';&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            echo GFCommon::get_remote_message();&nbsp;</div></li><li><div>            echo $raw_response['body'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function get_addon_info( $api, $action, $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $action == 'plugin_information' && empty( $api ) && ( ! rgempty( 'rg', $_GET ) || $args-&gt;slug == 'gravityforms' ) ) {&nbsp;</div></li><li><div>            $key = GFCommon::get_key();&nbsp;</div></li><li><div>            $raw_response = GFCommon::post_to_manager( 'api.php', &quot;op=get_plugin&slug={$args-&gt;slug}&key={$key}&quot;, array() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( is_wp_error( $raw_response ) || $raw_response['response']['code'] != 200 ) {&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $plugin = unserialize( $raw_response['body'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $api = new stdClass();&nbsp;</div></li><li><div>            $api-&gt;name = $plugin['title'];&nbsp;</div></li><li><div>            $api-&gt;version = $plugin['version'];&nbsp;</div></li><li><div>            $api-&gt;download_link = $plugin['download_url'];&nbsp;</div></li><li><div>            $api-&gt;tested = '10.0';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $api;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function get_addon_nonces() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $raw_response = GFCommon::post_to_manager( 'api.php', 'op=get_plugins', array() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_wp_error( $raw_response ) || $raw_response['response']['code'] != 200 ) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $addons = unserialize( $raw_response['body'] );&nbsp;</div></li><li><div>        $nonces = array();&nbsp;</div></li><li><div>        foreach ( $addons as $addon ) {&nbsp;</div></li><li><div>            $nonces[ $addon['key'] ] = wp_create_nonce( &quot;install-plugin_{$addon['key']}&quot; );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $nonces;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function start_export() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/export.php' );&nbsp;</div></li><li><div>        GFExport::start_export();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function get_post_category_values() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_detail.php' );&nbsp;</div></li><li><div>        GFFormDetail::get_post_category_values();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function get_notification_post_category_values() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/notification.php' );&nbsp;</div></li><li><div>        GFNotification::get_post_category_values();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function all_leads_page() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( self::maybe_display_installation_wizard() ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        };&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $view = rgget( 'view' );&nbsp;</div></li><li><div>        $lead_id = rgget( 'lid' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $view == 'entry' && ( rgget( 'lid' ) || ! rgblank( rgget( 'pos' ) ) ) ) {&nbsp;</div></li><li><div>            require_once( GFCommon::get_base_path() . '/entry_detail.php' );&nbsp;</div></li><li><div>            GFEntryDetail::lead_detail_page();&nbsp;</div></li><li><div>        } else if ( $view == 'entries' || empty( $view ) ) {&nbsp;</div></li><li><div>            require_once( GFCommon::get_base_path() . '/entry_list.php' );&nbsp;</div></li><li><div>            GFEntryList::all_leads_page();&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $form_id = rgget( 'id' );&nbsp;</div></li><li><div>            /**&nbsp;</div></li><li><div>             * Fires when viewing entries of a certain form&nbsp;</div></li><li><div>             *&nbsp;</div></li><li><div>             */&nbsp;</div></li><li><div>            do_action( 'gform_entries_view', $view, $form_id, $lead_id );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function form_list_page() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_list.php' );&nbsp;</div></li><li><div>        GFFormList::form_list_page();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function forms() {&nbsp;</div></li><li><div>        if ( ! GFCommon::ensure_wp_version() ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( self::maybe_display_installation_wizard() ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        };&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $id = RGForms::get( 'id' );&nbsp;</div></li><li><div>        $view = RGForms::get( 'view' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $view == 'entries' ) {&nbsp;</div></li><li><div>            require_once( GFCommon::get_base_path() . '/entry_list.php' );&nbsp;</div></li><li><div>            GFEntryList::leads_page( $id );&nbsp;</div></li><li><div>        } else if ( $view == 'entry' ) {&nbsp;</div></li><li><div>            require_once( GFCommon::get_base_path() . '/entry_detail.php' );&nbsp;</div></li><li><div>            GFEntryDetail::lead_detail_page();&nbsp;</div></li><li><div>        } else if ( $view == 'notification' ) {&nbsp;</div></li><li><div>            require_once( GFCommon::get_base_path() . '/notification.php' );&nbsp;</div></li><li><div>            //GFNotification::notification_page($id);&nbsp;</div></li><li><div>        } else if ( $view == 'settings' ) {&nbsp;</div></li><li><div>            require_once( GFCommon::get_base_path() . '/form_settings.php' );&nbsp;</div></li><li><div>            GFFormSettings::form_settings_page( $id );&nbsp;</div></li><li><div>        } else if ( empty( $view ) ) {&nbsp;</div></li><li><div>            if ( is_numeric( $id ) ) {&nbsp;</div></li><li><div>                self::forms_page( $id );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                self::form_list_page();&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action( 'gform_view', $view, $id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function get( $name, $array = null ) {&nbsp;</div></li><li><div>        if ( ! isset( $array ) ) {&nbsp;</div></li><li><div>            $array = $_GET;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( isset( $array[ $name ] ) ) {&nbsp;</div></li><li><div>            return $array[ $name ];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return '';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function post( $name, $do_stripslashes = true ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( isset( $_POST[ $name ] ) ) {&nbsp;</div></li><li><div>            return $do_stripslashes ? stripslashes_deep( $_POST[ $name ] ) : $_POST[ $name ];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return '';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // AJAX Function&nbsp;</div></li><li><div>    public static function resend_notifications() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        check_admin_referer( 'gf_resend_notifications', 'gf_resend_notifications' );&nbsp;</div></li><li><div>        $form_id = absint( rgpost( 'formId' ) );&nbsp;</div></li><li><div>        $leads = rgpost( 'leadIds' ); // may be a single ID or an array of IDs&nbsp;</div></li><li><div>        if ( 0 == $leads ) {&nbsp;</div></li><li><div>            // get all the lead ids for the current filter / search&nbsp;</div></li><li><div>            $filter = rgpost( 'filter' );&nbsp;</div></li><li><div>            $search = rgpost( 'search' );&nbsp;</div></li><li><div>            $star = $filter == 'star' ? 1 : null;&nbsp;</div></li><li><div>            $read = $filter == 'unread' ? 0 : null;&nbsp;</div></li><li><div>            $status = in_array( $filter, array( 'trash', 'spam' ) ) ? $filter : 'active';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $search_criteria['status'] = $status;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $star ) {&nbsp;</div></li><li><div>                $search_criteria['field_filters'][] = array( 'key' =&gt; 'is_starred', 'value' =&gt; (bool) $star );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( ! is_null( $read ) ) {&nbsp;</div></li><li><div>                $search_criteria['field_filters'][] = array( 'key' =&gt; 'is_read', 'value' =&gt; (bool) $read );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $search_field_id = rgpost( 'fieldId' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( isset( $_POST['fieldId'] ) && $_POST['fieldId'] !== '' ) {&nbsp;</div></li><li><div>                $key = $search_field_id;&nbsp;</div></li><li><div>                $val = $search;&nbsp;</div></li><li><div>                $strpos_row_key = strpos( $search_field_id, '|' );&nbsp;</div></li><li><div>                if ( $strpos_row_key !== false ) { //multi-row&nbsp;</div></li><li><div>                    $key_array = explode( '|', $search_field_id );&nbsp;</div></li><li><div>                    $key = $key_array[0];&nbsp;</div></li><li><div>                    $val = $key_array[1] . ':' . $val;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $search_criteria['field_filters'][] = array(&nbsp;</div></li><li><div>                    'key' =&gt; $key, &nbsp;</div></li><li><div>                    'operator' =&gt; rgempty( 'operator', $_POST ) ? 'is' : rgpost( 'operator' ), &nbsp;</div></li><li><div>                    'value' =&gt; $val, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $leads = GFFormsModel::search_lead_ids( $form_id, $search_criteria );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $leads = ! is_array( $leads ) ? array( $leads ) : $leads;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $form = gf_apply_filters( array( 'gform_before_resend_notifications', $form_id ), RGFormsModel::get_form_meta( $form_id ), $leads );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $leads ) || empty( $form ) ) {&nbsp;</div></li><li><div>            _e( 'There was an error while resending the notifications.', 'gravityforms' );&nbsp;</div></li><li><div>            die();&nbsp;</div></li><li><div>        };&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $notifications = json_decode( rgpost( 'notifications' ) );&nbsp;</div></li><li><div>        if ( ! is_array( $notifications ) ) {&nbsp;</div></li><li><div>            die( esc_html__( 'No notifications have been selected. Please select a notification to be sent.', 'gravityforms' ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! rgempty( 'sendTo', $_POST ) && ! GFCommon::is_valid_email_list( rgpost( 'sendTo' ) ) ) {&nbsp;</div></li><li><div>            die( sprintf( esc_html__( 'The %sSend To%s email address provided is not valid.', 'gravityforms' ), '&lt;strong&gt;', '&lt;/strong&gt;' ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $leads as $lead_id ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $lead = RGFormsModel::get_lead( $lead_id );&nbsp;</div></li><li><div>            foreach ( $notifications as $notification_id ) {&nbsp;</div></li><li><div>                $notification = $form['notifications'][ $notification_id ];&nbsp;</div></li><li><div>                if ( ! $notification ) {&nbsp;</div></li><li><div>                    continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                //overriding To email if one was specified&nbsp;</div></li><li><div>                if ( rgpost( 'sendTo' ) ) {&nbsp;</div></li><li><div>                    $notification['to'] = rgpost( 'sendTo' );&nbsp;</div></li><li><div>                    $notification['toType'] = 'email';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                GFCommon::send_notification( $notification, $form, $lead );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        die();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //-------------------------------------------------&nbsp;</div></li><li><div>    //----------- AJAX CALLS --------------------------&nbsp;</div></li><li><div>    //captcha image&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function captcha_image() {&nbsp;</div></li><li><div>        $field_properties = array( 'type' =&gt; 'captcha', 'simpleCaptchaSize' =&gt; $_GET['size'], 'simpleCaptchaFontColor' =&gt; $_GET['fg'], 'simpleCaptchaBackgroundColor' =&gt; $_GET['bg'] );&nbsp;</div></li><li><div>        /** @var GF_Field_CAPTCHA $field */&nbsp;</div></li><li><div>        $field = GF_Fields::create( $field_properties );&nbsp;</div></li><li><div>        if ( $_GET['type'] == 'math' ) {&nbsp;</div></li><li><div>            $captcha = $field-&gt;get_math_captcha( $_GET['pos'] );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $captcha = $field-&gt;get_captcha();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        @ini_set( 'memory_limit', '256M' );&nbsp;</div></li><li><div>        $image = imagecreatefrompng( $captcha['path'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        include_once( ABSPATH . 'wp-admin/includes/image-edit.php' );&nbsp;</div></li><li><div>        wp_stream_image( $image, 'image/png', 0 );&nbsp;</div></li><li><div>        imagedestroy( $image );&nbsp;</div></li><li><div>        die();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function update_form_active() {&nbsp;</div></li><li><div>        check_ajax_referer( 'rg_update_form_active', 'rg_update_form_active' );&nbsp;</div></li><li><div>        RGFormsModel::update_form_active( $_POST['form_id'], $_POST['is_active'] );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function update_notification_active() {&nbsp;</div></li><li><div>        check_ajax_referer( 'rg_update_notification_active', 'rg_update_notification_active' );&nbsp;</div></li><li><div>        RGFormsModel::update_notification_active( $_POST['form_id'], $_POST['notification_id'], $_POST['is_active'] );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function update_confirmation_active() {&nbsp;</div></li><li><div>        check_ajax_referer( 'rg_update_confirmation_active', 'rg_update_confirmation_active' );&nbsp;</div></li><li><div>        RGFormsModel::update_confirmation_active( $_POST['form_id'], $_POST['confirmation_id'], $_POST['is_active'] );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function update_lead_property() {&nbsp;</div></li><li><div>        check_ajax_referer( 'rg_update_lead_property', 'rg_update_lead_property' );&nbsp;</div></li><li><div>        RGFormsModel::update_lead_property( $_POST['lead_id'], $_POST['name'], $_POST['value'] );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function update_lead_status() {&nbsp;</div></li><li><div>        check_ajax_referer( 'gf_delete_entry' );&nbsp;</div></li><li><div>        $status = rgpost( 'status' );&nbsp;</div></li><li><div>        $lead_id = rgpost( 'entry' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $entry = GFAPI::get_entry( $lead_id );&nbsp;</div></li><li><div>        $form = GFAPI::get_form( $entry['form_id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        switch ( $status ) {&nbsp;</div></li><li><div>            case 'unspam' :&nbsp;</div></li><li><div>                RGFormsModel::update_lead_property( $lead_id, 'status', 'active' );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'delete' :&nbsp;</div></li><li><div>                if ( GFCommon::current_user_can_any( 'gravityforms_delete_entries' ) ) {&nbsp;</div></li><li><div>                    RGFormsModel::delete_lead( $lead_id );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            default :&nbsp;</div></li><li><div>                RGFormsModel::update_lead_property( $lead_id, 'status', $status );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        require_once( 'entry_list.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $filter_links = GFEntryList::get_filter_links( $form );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $counts = array();&nbsp;</div></li><li><div>        foreach ( $filter_links as $filter_link ) {&nbsp;</div></li><li><div>            $id = $filter_link['id'] == '' ? 'all' : $filter_link['id'];&nbsp;</div></li><li><div>            $counts[ $id . '_count' ] = $filter_link['count'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $x = new WP_Ajax_Response();&nbsp;</div></li><li><div>        $x-&gt;add( array(&nbsp;</div></li><li><div>            'what' =&gt; 'gf_entry', &nbsp;</div></li><li><div>            'id' =&gt; $lead_id, &nbsp;</div></li><li><div>            'supplemental' =&gt; $counts, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>        $x-&gt;send();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //settings&nbsp;</div></li><li><div>    public static function upgrade_license() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/settings.php' );&nbsp;</div></li><li><div>        GFSettings::upgrade_license();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //form detail&nbsp;</div></li><li><div>    public static function save_form() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_detail.php' );&nbsp;</div></li><li><div>        GFFormDetail::save_form();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function add_field() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_detail.php' );&nbsp;</div></li><li><div>        GFFormDetail::add_field();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function duplicate_field() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_detail.php' );&nbsp;</div></li><li><div>        GFFormDetail::duplicate_field();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function delete_field() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_detail.php' );&nbsp;</div></li><li><div>        GFFormDetail::delete_field();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function change_input_type() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_detail.php' );&nbsp;</div></li><li><div>        GFFormDetail::change_input_type();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function refresh_field_preview() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_detail.php' );&nbsp;</div></li><li><div>        GFFormDetail::refresh_field_preview();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function delete_custom_choice() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_detail.php' );&nbsp;</div></li><li><div>        GFFormDetail::delete_custom_choice();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function save_custom_choice() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_detail.php' );&nbsp;</div></li><li><div>        GFFormDetail::save_custom_choice();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //entry detail&nbsp;</div></li><li><div>    public static function delete_file() {&nbsp;</div></li><li><div>        check_ajax_referer( 'rg_delete_file', 'rg_delete_file' );&nbsp;</div></li><li><div>        $lead_id = intval( $_POST['lead_id'] );&nbsp;</div></li><li><div>        $field_id = intval( $_POST['field_id'] );&nbsp;</div></li><li><div>        $file_index = intval( $_POST['file_index'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        RGFormsModel::delete_file( $lead_id, $field_id, $file_index );&nbsp;</div></li><li><div>        die( &quot;EndDeleteFile($field_id, $file_index);&quot; );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //export&nbsp;</div></li><li><div>    public static function select_export_form() {&nbsp;</div></li><li><div>        check_ajax_referer( 'rg_select_export_form', 'rg_select_export_form' );&nbsp;</div></li><li><div>        $form_id = intval( $_POST['form_id'] );&nbsp;</div></li><li><div>        $form = RGFormsModel::get_form_meta( $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * Filters through the Form Export Page&nbsp;</div></li><li><div>         *&nbsp;</div></li><li><div>         * @param int $form_id The ID of the form to export&nbsp;</div></li><li><div>         * @param int $form The Form Object of the form to export&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        $form = gf_apply_filters( array( 'gform_form_export_page', $form_id ), $form );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $filter_settings = GFCommon::get_field_filter_settings( $form );&nbsp;</div></li><li><div>        $filter_settings_json = json_encode( $filter_settings );&nbsp;</div></li><li><div>        $fields = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $form = GFExport::add_default_export_fields( $form );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( is_array( $form['fields'] ) ) {&nbsp;</div></li><li><div>            /** @var GF_Field $field */&nbsp;</div></li><li><div>            foreach ( $form['fields'] as $field ) {&nbsp;</div></li><li><div>                $inputs = $field-&gt;get_entry_inputs();&nbsp;</div></li><li><div>                if ( is_array( $inputs ) ) {&nbsp;</div></li><li><div>                    foreach ( $inputs as $input ) {&nbsp;</div></li><li><div>                        $fields[] = array( $input['id'], GFCommon::get_label( $field, $input['id'] ) );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                } else if ( ! $field-&gt;displayOnly ) {&nbsp;</div></li><li><div>                    $fields[] = array( $field-&gt;id, GFCommon::get_label( $field ) );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $field_json = GFCommon::json_encode( $fields );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        die( &quot;EndSelectExportForm($field_json, $filter_settings_json);&quot; );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // form settings&nbsp;</div></li><li><div>    public static function save_confirmation() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_settings.php' );&nbsp;</div></li><li><div>        GFFormSettings::save_confirmation();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function delete_confirmation() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_settings.php' );&nbsp;</div></li><li><div>        GFFormSettings::delete_confirmation();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // form list&nbsp;</div></li><li><div>    public static function save_new_form() {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_list.php' );&nbsp;</div></li><li><div>        GFFormList::save_new_form();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function top_toolbar() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $forms = RGFormsModel::get_forms( null, 'title' );&nbsp;</div></li><li><div>        $id = rgempty( 'id', $_GET ) ? count( $forms ) &gt; 0 ? $forms[0]-&gt;id : '0' : rgget( 'id' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>            function GF_ReplaceQuery(key, newValue) {&nbsp;</div></li><li><div>                var new_query = &quot;&quot;;&nbsp;</div></li><li><div>                var query = document.location.search.substring(1);&nbsp;</div></li><li><div>                var ary = query.split(&quot;&&quot;);&nbsp;</div></li><li><div>                var has_key = false;&nbsp;</div></li><li><div>                for (i = 0; i &lt; ary.length; i++) {&nbsp;</div></li><li><div>                    var key_value = ary[i].split(&quot;=&quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if (key_value[0] == key) {&nbsp;</div></li><li><div>                        new_query += key + &quot;=&quot; + newValue + &quot;&&quot;;&nbsp;</div></li><li><div>                        has_key = true;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    else if (key_value[0] != &quot;display_settings&quot;) {&nbsp;</div></li><li><div>                        new_query += key_value[0] + &quot;=&quot; + key_value[1] + &quot;&&quot;;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if (new_query.length &gt; 0)&nbsp;</div></li><li><div>                    new_query = new_query.substring(0, new_query.length - 1);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if (!has_key)&nbsp;</div></li><li><div>                    new_query += new_query.length &gt; 0 ? &quot;&&quot; + key + &quot;=&quot; + newValue : &quot;?&quot; + key + &quot;=&quot; + newValue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                return new_query;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function GF_RemoveQuery(key, query) {&nbsp;</div></li><li><div>                var new_query = &quot;&quot;;&nbsp;</div></li><li><div>                if (query == &quot;&quot;) {&nbsp;</div></li><li><div>                    query = document.location.search.substring(1);&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                var ary = query.split(&quot;&&quot;);&nbsp;</div></li><li><div>                for (i = 0; i &lt; ary.length; i++) {&nbsp;</div></li><li><div>                    var key_value = ary[i].split(&quot;=&quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if (key_value[0] != key) {&nbsp;</div></li><li><div>                        new_query += key_value[0] + &quot;=&quot; + key_value[1] + &quot;&&quot;;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if (new_query.length &gt; 0)&nbsp;</div></li><li><div>                    new_query = new_query.substring(0, new_query.length - 1);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                return new_query;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function GF_SwitchForm(id) {&nbsp;</div></li><li><div>                if (id.length &gt; 0) {&nbsp;</div></li><li><div>                    query = GF_ReplaceQuery(&quot;id&quot;, id);&nbsp;</div></li><li><div>                    //remove paging from querystring when changing forms&nbsp;</div></li><li><div>                    new_query = GF_RemoveQuery(&quot;paged&quot;, query);&nbsp;</div></li><li><div>                    new_query = new_query.replace(&quot;gf_new_form&quot;, &quot;gf_edit_forms&quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    //remove filter vars from querystring when changing forms&nbsp;</div></li><li><div>                    new_query = GF_RemoveQuery(&quot;s&quot;, new_query);&nbsp;</div></li><li><div>                    new_query = GF_RemoveQuery(&quot;operator&quot;, new_query);&nbsp;</div></li><li><div>                    new_query = GF_RemoveQuery(&quot;type&quot;, new_query);&nbsp;</div></li><li><div>                    new_query = GF_RemoveQuery(&quot;field_id&quot;, new_query);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    //When switching forms within any form settings tab, go back to main form settings tab&nbsp;</div></li><li><div>                    var is_form_settings = new_query.indexOf(&quot;page=gf_edit_forms&quot;) &gt;= 0 && new_query.indexOf(&quot;view=settings&quot;);&nbsp;</div></li><li><div>                    if (is_form_settings) {&nbsp;</div></li><li><div>                        //going back to main form settings tab&nbsp;</div></li><li><div>                        new_query = &quot;page=gf_edit_forms&view=settings&id=&quot; + id;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    document.location = &quot;?&quot; + new_query;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function ToggleFormSettings() {&nbsp;</div></li><li><div>                FieldClick(jQuery('#gform_heading')[0]);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            jQuery(document).ready(function () {&nbsp;</div></li><li><div>                if (document.location.search.indexOf(&quot;display_settings&quot;) &gt; 0)&nbsp;</div></li><li><div>                    ToggleFormSettings()&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                jQuery('a.gf_toolbar_disabled').click(function (event) {&nbsp;</div></li><li><div>                    event.preventDefault();&nbsp;</div></li><li><div>                });&nbsp;</div></li><li><div>            });&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;/script&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;div id=&quot;gf_form_toolbar&quot;&gt;&nbsp;</div></li><li><div>            &lt;ul id=&quot;gf_form_toolbar_links&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                $menu_items = apply_filters( 'gform_toolbar_menu', self::get_toolbar_menu_items( $id ), $id );&nbsp;</div></li><li><div>                echo self::format_toolbar_menu_items( $menu_items );&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;li class=&quot;gf_form_switcher&quot;&gt;&nbsp;</div></li><li><div>                    &lt;label for=&quot;export_form&quot;&gt;&lt;?php esc_html_e( 'Select A Form', 'gravityforms' ) ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    if ( RG_CURRENT_VIEW != 'entry' ) {&nbsp;</div></li><li><div>                        ?&gt;&nbsp;</div></li><li><div>                        &lt;select name=&quot;form_switcher&quot; id=&quot;form_switcher&quot; onchange=&quot;GF_SwitchForm(jQuery(this).val());&quot;&gt;&nbsp;</div></li><li><div>                            &lt;option value=&quot;&quot;&gt;&lt;?php esc_html_e( 'Switch Form', 'gravityforms' ) ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                            &lt;?php&nbsp;</div></li><li><div>                            foreach ( $forms as $form_info ) {&nbsp;</div></li><li><div>                                ?&gt;&nbsp;</div></li><li><div>                                &lt;option value=&quot;&lt;?php echo absint( $form_info-&gt;id ); ?&gt;&quot;&gt;&lt;?php echo esc_html( $form_info-&gt;title )?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                            &lt;?php&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                            ?&gt;&nbsp;</div></li><li><div>                        &lt;/select&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    } // end view check&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;/li&gt;&nbsp;</div></li><li><div>            &lt;/ul&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function format_toolbar_menu_items( $menu_items, $compact = false ) {&nbsp;</div></li><li><div>        if ( empty( $menu_items ) ) {&nbsp;</div></li><li><div>            return '';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $priorities = array();&nbsp;</div></li><li><div>        foreach ( $menu_items as $k =&gt; $menu_item ) {&nbsp;</div></li><li><div>            $priorities[ $k ] = rgar( $menu_item, 'priority' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        array_multisort( $priorities, SORT_DESC, $menu_items );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $keys = array_keys( $menu_items );&nbsp;</div></li><li><div>        $last_key = array_pop( $keys ); // array_pop(array_keys($menu_items)) causes a Strict Standards warning in WP 3.6 on PHP 5.4&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $menu_items as $key =&gt; $menu_item ) {&nbsp;</div></li><li><div>            if ( is_array( $menu_item ) ) {&nbsp;</div></li><li><div>                if ( GFCommon::current_user_can_any( rgar( $menu_item, 'capabilities' ) ) ) {&nbsp;</div></li><li><div>                    $sub_menu_str = '';&nbsp;</div></li><li><div>                    $count_sub_menu_items = 0;&nbsp;</div></li><li><div>                    $sub_menu_items = rgar( $menu_item, 'sub_menu_items' );&nbsp;</div></li><li><div>                    if ( is_array( $sub_menu_items ) ) {&nbsp;</div></li><li><div>                        foreach ( $sub_menu_items as $k =&gt; $val ) {&nbsp;</div></li><li><div>                            if ( false === GFCommon::current_user_can_any( rgar( $sub_menu_items[ $k ], 'capabilities' ) ) ) {&nbsp;</div></li><li><div>                                unset( $sub_menu_items[ $k ] );&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        $sub_menu_items = array_values( $sub_menu_items ); //reset numeric keys&nbsp;</div></li><li><div>                        $count_sub_menu_items = count( $sub_menu_items );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $menu_class = rgar( $menu_item, 'menu_class' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( $count_sub_menu_items == 1 ) {&nbsp;</div></li><li><div>                        $label = $compact ? rgar( $menu_item, 'label' ) : rgar( $sub_menu_items[0], 'label' );&nbsp;</div></li><li><div>                        $menu_item = $sub_menu_items[0];&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $label = rgar( $menu_item, 'label' );&nbsp;</div></li><li><div>                        $sub_menu_str = self::toolbar_sub_menu_items( $sub_menu_items, $compact );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $link_class = esc_attr( rgar( $menu_item, 'link_class' ) );&nbsp;</div></li><li><div>                    $icon = rgar( $menu_item, 'icon' );&nbsp;</div></li><li><div>                    $url = esc_url( rgar( $menu_item, 'url' ) );&nbsp;</div></li><li><div>                    $title = esc_attr( rgar( $menu_item, 'title' ) );&nbsp;</div></li><li><div>                    $onclick = esc_js( rgar( $menu_item, 'onclick' ) );&nbsp;</div></li><li><div>                    $label = esc_html( $label );&nbsp;</div></li><li><div>                    $target = rgar( $menu_item, 'target' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $link = &quot;&lt;a class='{$link_class}' onclick='{$onclick}' title='{$title}' href='{$url}' target='{$target}'&gt;{$icon} {$label}&lt;/a&gt;&quot; . $sub_menu_str;&nbsp;</div></li><li><div>                    if ( $compact ) {&nbsp;</div></li><li><div>                        if ( $key == 'delete' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            /**&nbsp;</div></li><li><div>                             * A filter to allow the modification of the HTML link to delete a form&nbsp;</div></li><li><div>                             *&nbsp;</div></li><li><div>                             * @param string $link The HTML &quot;Delete Form&quot; Link&nbsp;</div></li><li><div>                             */&nbsp;</div></li><li><div>                            $link = apply_filters( 'gform_form_delete_link', $link );&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        $divider = $key == $last_key ? '' : ' | ';&nbsp;</div></li><li><div>                        if ( $count_sub_menu_items &gt; 0 ) {&nbsp;</div></li><li><div>                            $menu_class .= ' gf_form_action_has_submenu';&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        $output .= '&lt;span class=&quot;' . $menu_class . '&quot;&gt;' . $link . $divider . '&lt;/span&gt;';&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        $output .= &quot;&lt;li class='{$menu_class}'&gt;{$link}&lt;/li&gt;&quot;;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } elseif ( $compact ) {&nbsp;</div></li><li><div>                //for backwards compatibility &lt;1.7: form actions only&nbsp;</div></li><li><div>                $divider = $key == $last_key ? '' : ' | ';&nbsp;</div></li><li><div>                $output .= '&lt;span class=&quot;edit&quot;&gt;' . $menu_item . $divider . '&lt;/span&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $output;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function get_toolbar_menu_items( $form_id, $compact = false ) {&nbsp;</div></li><li><div>        $menu_items = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $form_id = absint( $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //---- Form Editor ----&nbsp;</div></li><li><div>        $edit_capabilities = array( 'gravityforms_edit_forms' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $menu_items['edit'] = array(&nbsp;</div></li><li><div>            'label' =&gt; $compact ? __( 'Edit', 'gravityforms' ) : __( 'Form Editor', 'gravityforms' ), &nbsp;</div></li><li><div>            'icon' =&gt; '&lt;i class=&quot;fa fa-pencil-square-o fa-lg&quot;&gt;&lt;/i&gt;', &nbsp;</div></li><li><div>            'title' =&gt; __( 'Edit this form', 'gravityforms' ), &nbsp;</div></li><li><div>            'url' =&gt; '?page=gf_edit_forms&id=' . $form_id, &nbsp;</div></li><li><div>            'menu_class' =&gt; 'gf_form_toolbar_editor', &nbsp;</div></li><li><div>            'link_class' =&gt; self::toolbar_class( 'editor' ), &nbsp;</div></li><li><div>            'capabilities' =&gt; $edit_capabilities, &nbsp;</div></li><li><div>            'priority' =&gt; 1000, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //---- Form Settings ----&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $sub_menu_items = self::get_form_settings_sub_menu_items( $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $menu_items['settings'] = array(&nbsp;</div></li><li><div>            'label' =&gt; $compact ? __( 'Settings', 'gravityforms' ) : __( 'Form Settings', 'gravityforms' ), &nbsp;</div></li><li><div>            'icon' =&gt; '&lt;i class=&quot;fa fa-cogs fa-lg&quot;&gt;&lt;/i&gt;', &nbsp;</div></li><li><div>            'title' =&gt; __( 'Edit settings for this form', 'gravityforms' ), &nbsp;</div></li><li><div>            'url' =&gt; '?page=gf_edit_forms&view=settings&id=' . $form_id, &nbsp;</div></li><li><div>            'menu_class' =&gt; 'gf_form_toolbar_settings', &nbsp;</div></li><li><div>            'link_class' =&gt; self::toolbar_class( 'settings' ), &nbsp;</div></li><li><div>            'sub_menu_items' =&gt; $sub_menu_items, &nbsp;</div></li><li><div>            'capabilities' =&gt; $edit_capabilities, &nbsp;</div></li><li><div>            'priority' =&gt; 900, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //---- Entries ----&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $entries_capabilities = array( 'gravityforms_view_entries', 'gravityforms_edit_entries', 'gravityforms_delete_entries' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $menu_items['entries'] = array(&nbsp;</div></li><li><div>            'label' =&gt; __( 'Entries', 'gravityforms' ), &nbsp;</div></li><li><div>            'icon' =&gt; '&lt;i class=&quot;fa fa-comment-o fa-lg&quot;&gt;&lt;/i&gt;', &nbsp;</div></li><li><div>            'title' =&gt; __( 'View entries generated by this form', 'gravityforms' ), &nbsp;</div></li><li><div>            'url' =&gt; '?page=gf_entries&id=' . $form_id, &nbsp;</div></li><li><div>            'menu_class' =&gt; 'gf_form_toolbar_entries', &nbsp;</div></li><li><div>            'link_class' =&gt; self::toolbar_class( 'entries' ), &nbsp;</div></li><li><div>            'capabilities' =&gt; $entries_capabilities, &nbsp;</div></li><li><div>            'priority' =&gt; 800, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //---- Preview ----&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $preview_capabilities = array( 'gravityforms_edit_forms', 'gravityforms_create_form', 'gravityforms_preview_forms' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $menu_items['preview'] = array(&nbsp;</div></li><li><div>            'label' =&gt; __( 'Preview', 'gravityforms' ), &nbsp;</div></li><li><div>            'icon' =&gt; '&lt;i class=&quot;fa fa-eye fa-lg&quot;&gt;&lt;/i&gt;', &nbsp;</div></li><li><div>            'title' =&gt; __( 'Preview this form', 'gravityforms' ), &nbsp;</div></li><li><div>            'url' =&gt; trailingslashit( site_url() ) . '?gf_page=preview&id=' . $form_id, &nbsp;</div></li><li><div>            'menu_class' =&gt; 'gf_form_toolbar_preview', &nbsp;</div></li><li><div>            'link_class' =&gt; self::toolbar_class( 'preview' ), &nbsp;</div></li><li><div>            'target' =&gt; '_blank', &nbsp;</div></li><li><div>            'capabilities' =&gt; $preview_capabilities, &nbsp;</div></li><li><div>            'priority' =&gt; 700, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $menu_items;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function toolbar_sub_menu_items( $menu_items, $compact = false ) {&nbsp;</div></li><li><div>        if ( empty( $menu_items ) ) {&nbsp;</div></li><li><div>            return '';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $sub_menu_items_string = '';&nbsp;</div></li><li><div>        foreach ( $menu_items as $menu_item ) {&nbsp;</div></li><li><div>            if ( GFCommon::current_user_can_any( rgar( $menu_item, 'capabilities' ) ) ) {&nbsp;</div></li><li><div>                $menu_class = esc_attr( rgar( $menu_item, 'menu_class' ) );&nbsp;</div></li><li><div>                $link_class = esc_attr( rgar( $menu_item, 'link_class' ) );&nbsp;</div></li><li><div>                $url = esc_url( rgar( $menu_item, 'url' ) );&nbsp;</div></li><li><div>                $label = esc_html( rgar( $menu_item, 'label' ) );&nbsp;</div></li><li><div>                $target = esc_attr( rgar( $menu_item, 'target' ) );&nbsp;</div></li><li><div>                $sub_menu_items_string .= &quot;&lt;li class='{$menu_class}'&gt;&lt;a href='{$url}' class='{$link_class}' target='{$target}'&gt;{$label}&lt;/a&gt;&lt;/li&gt;&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $compact ) {&nbsp;</div></li><li><div>            $sub_menu_items_string = '&lt;div class=&quot;gf_submenu&quot;&gt;&lt;ul&gt;' . $sub_menu_items_string . '&lt;/ul&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $sub_menu_items_string = '&lt;div class=&quot;gf_submenu&quot;&gt;&lt;ul&gt;' . $sub_menu_items_string . '&lt;/ul&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $sub_menu_items_string;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function get_form_settings_sub_menu_items( $form_id ) {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_settings.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $sub_menu_items = array();&nbsp;</div></li><li><div>        $tabs = GFFormSettings::get_tabs( $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $tabs as $tab ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $tab['name'] == 'settings' ) {&nbsp;</div></li><li><div>                $form_setting_menu_item['label'] = 'Settings';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $sub_menu_items[] = array(&nbsp;</div></li><li><div>                'url' =&gt; admin_url( &quot;admin.php?page=gf_edit_forms&view=settings&subview={$tab['name']}&id={$form_id}&quot; ), &nbsp;</div></li><li><div>                'label' =&gt; $tab['label'], &nbsp;</div></li><li><div>                'capabilities' =&gt; array( 'gravityforms_edit_forms' )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $sub_menu_items;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private static function toolbar_class( $item ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        switch ( $item ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'editor':&nbsp;</div></li><li><div>                if ( in_array( rgget( 'page' ), array( 'gf_edit_forms', 'gf_new_form' ) ) && rgempty( 'view', $_GET ) ) {&nbsp;</div></li><li><div>                    return 'gf_toolbar_active';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'settings':&nbsp;</div></li><li><div>                if ( rgget( 'view' ) == 'settings' ) {&nbsp;</div></li><li><div>                    return 'gf_toolbar_active';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'notifications' :&nbsp;</div></li><li><div>                if ( rgget( 'page' ) == 'gf_new_form' ) {&nbsp;</div></li><li><div>                    return 'gf_toolbar_disabled';&nbsp;</div></li><li><div>                } else if ( rgget( 'page' ) == 'gf_edit_forms' && rgget( 'view' ) == 'notification' ) {&nbsp;</div></li><li><div>                    return 'gf_toolbar_active';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'entries' :&nbsp;</div></li><li><div>                if ( rgget( 'page' ) == 'gf_new_form' ) {&nbsp;</div></li><li><div>                    return 'gf_toolbar_disabled';&nbsp;</div></li><li><div>                } else if ( rgget( 'page' ) == 'gf_entries' && rgempty( 'view', $_GET ) ) {&nbsp;</div></li><li><div>                    return 'gf_toolbar_active';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'preview' :&nbsp;</div></li><li><div>                if ( rgget( 'page' ) == 'gf_new_form' ) {&nbsp;</div></li><li><div>                    return 'gf_toolbar_disabled';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return '';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function admin_bar() {&nbsp;</div></li><li><div>        global $wp_admin_bar;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! GFCommon::current_user_can_any( 'gravityforms_create_form' ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $wp_admin_bar-&gt;add_menu(&nbsp;</div></li><li><div>            array(&nbsp;</div></li><li><div>                'id' =&gt; 'gravityforms-new-form', &nbsp;</div></li><li><div>                'parent' =&gt; 'new-content', &nbsp;</div></li><li><div>                'title' =&gt; esc_attr__( 'Form', 'gravityforms' ), &nbsp;</div></li><li><div>                'href' =&gt; admin_url( 'admin.php?page=&quot;gf_new_form' )&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function maybe_auto_update( $update, $item ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( isset($item-&gt;slug) && $item-&gt;slug == 'gravityforms' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            GFCommon::log_debug( 'GFForms::maybe_auto_update() - Starting auto-update for gravityforms.' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $auto_update_disabled = self::is_auto_update_disabled();&nbsp;</div></li><li><div>            GFCommon::log_debug( 'GFForms::maybe_auto_update() - $auto_update_disabled: ' . var_export( $auto_update_disabled, true ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $auto_update_disabled || version_compare( GFForms::$version, $item-&gt;new_version, '=&gt;' ) ) {&nbsp;</div></li><li><div>                GFCommon::log_debug( 'GFForms::maybe_auto_update() - Aborting update.' );&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $current_major = implode( '.', array_slice( preg_split( '/[.-]/', GFForms::$version ), 0, 1 ) );&nbsp;</div></li><li><div>            $new_major = implode( '.', array_slice( preg_split( '/[.-]/', $item-&gt;new_version ), 0, 1 ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $current_branch = implode( '.', array_slice( preg_split( '/[.-]/', GFForms::$version ), 0, 2 ) );&nbsp;</div></li><li><div>            $new_branch = implode( '.', array_slice( preg_split( '/[.-]/', $item-&gt;new_version ), 0, 2 ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $current_major == $new_major && $current_branch == $new_branch ) {&nbsp;</div></li><li><div>                GFCommon::log_debug( 'GFForms::maybe_auto_update() - OK to update.' );&nbsp;</div></li><li><div>                return true;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $update;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function is_auto_update_disabled() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Currently WordPress won't ask Gravity Forms to update if background updates are disabled.&nbsp;</div></li><li><div>        // Let's double check anyway.&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // WordPress background updates are disabled if you don't want file changes.&nbsp;</div></li><li><div>        if ( defined( 'DISALLOW_FILE_MODS' ) && DISALLOW_FILE_MODS ) {&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( defined( 'WP_INSTALLING' ) ) {&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $wp_updates_disabled = defined( 'AUTOMATIC_UPDATER_DISABLED' ) && AUTOMATIC_UPDATER_DISABLED;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $wp_updates_disabled = apply_filters( 'automatic_updater_disabled', $wp_updates_disabled );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $wp_updates_disabled ) {&nbsp;</div></li><li><div>            GFCommon::log_debug( __METHOD__ . '() - Background updates are disabled in WordPress.' );&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Now check Gravity Forms Background Update Settings&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $enabled = get_option( 'gform_enable_background_updates' );&nbsp;</div></li><li><div>        GFCommon::log_debug( 'GFForms::is_auto_update_disabled() - $enabled: ' . var_export( $enabled, true ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * Filter to disable Gravity Forms Automatic updates&nbsp;</div></li><li><div>         *&nbsp;</div></li><li><div>         * @param bool $enabled Check if automatic updates are enabled, and then disable it&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        $disabled = apply_filters( 'gform_disable_auto_update', ! $enabled );&nbsp;</div></li><li><div>        GFCommon::log_debug( 'GFForms::is_auto_update_disabled() - $disabled: ' . var_export( $disabled, true ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! $disabled ) {&nbsp;</div></li><li><div>            $disabled = defined( 'GFORM_DISABLE_AUTO_UPDATE' ) && GFORM_DISABLE_AUTO_UPDATE;&nbsp;</div></li><li><div>            GFCommon::log_debug( 'GFForms::is_auto_update_disabled() - GFORM_DISABLE_AUTO_UPDATE: ' . var_export( $disabled, true ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $disabled;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function deprecate_add_on_methods() {&nbsp;</div></li><li><div>        if ( ( defined( 'DOING_AJAX' ) && DOING_AJAX ) || ( defined( 'DOING_CRON' ) && DOING_CRON ) || ( defined( 'WP_INSTALLING' ) && WP_INSTALLING ) ) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $deprecated = GFAddOn::get_all_deprecated_protected_methods();&nbsp;</div></li><li><div>        if ( ! empty( $deprecated ) ) {&nbsp;</div></li><li><div>            foreach ( $deprecated as $method ) {&nbsp;</div></li><li><div>                _deprecated_function( $method, '1.9', 'public access level' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Shortcode UI&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Output a shortcode.&nbsp;</div></li><li><div>     * ajax callback for displaying the shortcode in the TinyMCE editor.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return null&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function handle_ajax_do_shortcode( ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $shortcode = ! empty( $_POST['shortcode'] ) ? sanitize_text_field( stripslashes( $_POST['shortcode'] ) ) : null;&nbsp;</div></li><li><div>        $post_id = ! empty( $_POST['post_id'] ) ? intval( $_POST['post_id'] ) : null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! current_user_can( 'edit_post', $post_id ) || ! wp_verify_nonce( $_POST['nonce'], 'gf-shortcode-ui-preview' ) ) {&nbsp;</div></li><li><div>            echo esc_html__( 'Error', 'gravityforms' );&nbsp;</div></li><li><div>            exit;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $form_id = ! empty( $_POST['form_id'] ) ? intval( $_POST['form_id'] ) : null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        global $post;&nbsp;</div></li><li><div>        $post = get_post( $post_id );&nbsp;</div></li><li><div>        setup_postdata( $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        self::enqueue_form_scripts( $form_id, true );&nbsp;</div></li><li><div>        wp_print_scripts();&nbsp;</div></li><li><div>        wp_print_styles();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo do_shortcode( $shortcode );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Disable the elements on the form&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>            jQuery('.gform_wrapper input, .gform_wrapper select, .gform_wrapper textarea').prop('disabled', true);&nbsp;</div></li><li><div>            jQuery('a img').each(function () {&nbsp;</div></li><li><div>                var image = this.src;&nbsp;</div></li><li><div>                var img = jQuery('&lt;img&gt;', { src: image });&nbsp;</div></li><li><div>                $(this).parent().replaceWith(img);&nbsp;</div></li><li><div>            });&nbsp;</div></li><li><div>            jQuery('a').each(function () {&nbsp;</div></li><li><div>                jQuery(this).replaceWith(jQuery(this).text());&nbsp;</div></li><li><div>            });&nbsp;</div></li><li><div>        &lt;/script&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        exit;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function action_print_media_templates() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo GFForms::get_view( 'edit-shortcode-form' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function get_view( $template ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! file_exists( $template ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $template_dir = GFCommon::get_base_path() . '/includes/templates/';&nbsp;</div></li><li><div>            $template = $template_dir . $template . '.tpl.php';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( ! file_exists( $template ) ) {&nbsp;</div></li><li><div>                return '';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        ob_start();&nbsp;</div></li><li><div>        include $template;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return ob_get_clean();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function modify_tiny_mce_4( $init ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Hack to fix compatibility issue with ACF PRO&nbsp;</div></li><li><div>        if ( ! isset( $init['content_css'] ) ) {&nbsp;</div></li><li><div>            return $init;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $base_url = GFCommon::get_base_url();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $min = defined( 'SCRIPT_DEBUG' ) && SCRIPT_DEBUG || isset( $_GET['gform_debug'] ) ? '' : '.min';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $editor_styles = $base_url . &quot;/css/shortcode-ui-editor-styles{$min}.css, &quot;;&nbsp;</div></li><li><div>        $form_styles = $base_url . &quot;/css/formsmain{$min}.css&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( isset( $init['content_css'] ) ) {&nbsp;</div></li><li><div>            if ( empty( $init['content_css'] ) ) {&nbsp;</div></li><li><div>                $init['content_css'] = '';&nbsp;</div></li><li><div>            } elseif ( is_array( $init['content_css'] ) ) {&nbsp;</div></li><li><div>                $init['content_css'][] = $editor_styles;&nbsp;</div></li><li><div>                $init['content_css'][] = $form_styles;&nbsp;</div></li><li><div>                return $init;&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $init['content_css'] = $init['content_css'] . ', ';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Note: Using .= here can trigger a fatal error&nbsp;</div></li><li><div>        $init['content_css'] = $init['content_css'] . $editor_styles . $form_styles;&nbsp;</div></li><li><div>        return $init;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function get_shortcodes() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $forms = RGFormsModel::get_forms( 1, 'title' );&nbsp;</div></li><li><div>        $forms_options[''] = __( 'Select a Form', 'gravityforms' );&nbsp;</div></li><li><div>        foreach ( $forms as $form ) {&nbsp;</div></li><li><div>            $forms_options[ absint( $form-&gt;id ) ] = esc_html( $form-&gt;title );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $default_attrs = array(&nbsp;</div></li><li><div>            array(&nbsp;</div></li><li><div>                'label' =&gt; __( 'Select a form below to add it to your post or page.', 'gravityforms' ), &nbsp;</div></li><li><div>                'tooltip' =&gt; __( 'Select a form from the list to add it to your post or page.', 'gravityforms' ), &nbsp;</div></li><li><div>                'attr' =&gt; 'id', &nbsp;</div></li><li><div>                'type' =&gt; 'select', &nbsp;</div></li><li><div>                'section' =&gt; 'required', &nbsp;</div></li><li><div>                'description' =&gt; __( &quot;Can't find your form? Make sure it is active.&quot;, 'gravityforms' ), &nbsp;</div></li><li><div>                'options' =&gt; $forms_options, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            array(&nbsp;</div></li><li><div>                'label' =&gt; __( 'Display form title', 'gravityforms' ), &nbsp;</div></li><li><div>                'attr' =&gt; 'title', &nbsp;</div></li><li><div>                'default' =&gt; 'true', &nbsp;</div></li><li><div>                'section' =&gt; 'standard', &nbsp;</div></li><li><div>                'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                'tooltip' =&gt; __( 'Whether or not do display the form title.', 'gravityforms' )&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            array(&nbsp;</div></li><li><div>                'label' =&gt; __( 'Display form description', 'gravityforms' ), &nbsp;</div></li><li><div>                'attr' =&gt; 'description', &nbsp;</div></li><li><div>                'default' =&gt; 'true', &nbsp;</div></li><li><div>                'section' =&gt; 'standard', &nbsp;</div></li><li><div>                'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                'tooltip' =&gt; __( 'Whether or not do display the form description.', 'gravityforms' )&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            array(&nbsp;</div></li><li><div>                'label' =&gt; __( 'Enable AJAX', 'gravityforms' ), &nbsp;</div></li><li><div>                'attr' =&gt; 'ajax', &nbsp;</div></li><li><div>                'section' =&gt; 'standard', &nbsp;</div></li><li><div>                'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                'tooltip' =&gt; __( 'Specify whether or not to use AJAX to submit the form.', 'gravityforms' )&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            array(&nbsp;</div></li><li><div>                'label' =&gt; 'Tabindex', &nbsp;</div></li><li><div>                'attr' =&gt; 'tabindex', &nbsp;</div></li><li><div>                'type' =&gt; 'number', &nbsp;</div></li><li><div>                'tooltip' =&gt; __( 'Specify the starting tab index for the fields of this form.', 'gravityforms' )&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * Filters through the shortcode builder actions (ajax, tabeindex, form title) for adding a new form to a post, page, etc.&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        $add_on_actions = apply_filters( 'gform_shortcode_builder_actions', array() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $add_on_actions ) ) {&nbsp;</div></li><li><div>            $action_options = array( '' =&gt; __( 'Select an action', 'gravityforms' ) );&nbsp;</div></li><li><div>            foreach ( $add_on_actions as $add_on_action ) {&nbsp;</div></li><li><div>                foreach ( $add_on_action as $key =&gt; $array ) {&nbsp;</div></li><li><div>                    $action_options[ $key ] = $array['label'];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $default_attrs[] = array(&nbsp;</div></li><li><div>                'label' =&gt; 'Action', &nbsp;</div></li><li><div>                'attr' =&gt; 'action', &nbsp;</div></li><li><div>                'type' =&gt; 'select', &nbsp;</div></li><li><div>                'options' =&gt; $action_options, &nbsp;</div></li><li><div>                'tooltip' =&gt; __( 'Select an action for this shortcode. Actions are added by some add-ons.', 'gravityforms' )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $shortcode = array(&nbsp;</div></li><li><div>            'shortcode_tag' =&gt; 'gravityform', &nbsp;</div></li><li><div>            'action_tag' =&gt; '', &nbsp;</div></li><li><div>            'label' =&gt; 'Gravity Forms', &nbsp;</div></li><li><div>            'attrs' =&gt; $default_attrs, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $shortcodes[] = $shortcode;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! empty( $add_on_actions ) ) {&nbsp;</div></li><li><div>            foreach ( $add_on_actions as $add_on_action ) {&nbsp;</div></li><li><div>                foreach ( $add_on_action as $key =&gt; $array ) {&nbsp;</div></li><li><div>                    $attrs = array_merge( $default_attrs, $array['attrs'] );&nbsp;</div></li><li><div>                    $shortcode = array(&nbsp;</div></li><li><div>                        'shortcode_tag' =&gt; 'gravityform', &nbsp;</div></li><li><div>                        'action_tag' =&gt; $key, &nbsp;</div></li><li><div>                        'label' =&gt; rgar( $array, 'label' ), &nbsp;</div></li><li><div>                        'attrs' =&gt; $attrs, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $shortcodes[] = $shortcode;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $shortcodes;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static function enqueue_form_scripts( $form_id, $is_ajax = false ) {&nbsp;</div></li><li><div>        require_once( GFCommon::get_base_path() . '/form_display.php' );&nbsp;</div></li><li><div>        $form = RGFormsModel::get_form_meta( $form_id );&nbsp;</div></li><li><div>        GFFormDisplay::enqueue_form_scripts( $form, $is_ajax );&nbsp;</div></li><li><div>        $addons = GFAddOn::get_registered_addons();&nbsp;</div></li><li><div>        foreach ( $addons as $addon ) {&nbsp;</div></li><li><div>            $a = call_user_func( array( $addon, 'get_instance' ) );&nbsp;</div></li><li><div>            $a-&gt;enqueue_scripts( $form, $is_ajax );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Displays the installation wizard on single site installations and on multisite&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return bool Was the installation wizard displayed?&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public static function maybe_display_installation_wizard() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( defined( 'GF_LICENSE_KEY' ) && is_multisite() && ! is_main_site() ) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pending_installation = get_option( 'gform_pending_installation' ) || isset( $_GET['gform_installation_wizard'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $pending_installation ) {&nbsp;</div></li><li><div>            require_once( GFCommon::get_base_path() . '/includes/wizard/class-gf-installation-wizard.php' );&nbsp;</div></li><li><div>            $wizard = new GF_Installation_Wizard;&nbsp;</div></li><li><div>            $result = $wizard-&gt;display();&nbsp;</div></li><li><div>            return $result;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd> <a href="http://hookr.io/plugins/gravity-forms/1.9.14.22/classes/gfforms/">1.9.14.22</a></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>GFForms</li><li><span></span>Gravity Forms</li><li><span></span>1.9.14.22</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>