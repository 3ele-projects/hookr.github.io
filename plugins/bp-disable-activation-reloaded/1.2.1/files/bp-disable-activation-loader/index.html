<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="1.2.1" data-slug="bp-disable-activation-reloaded" data-type="file" data-id="87415"><head xmlns="http://www.w3.org/1999/xhtml"><title> bp-disable-activation-loader | file | Bp Disable Activation Reloaded | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, bp-disable-activation-reloaded, 1.2.1" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=e9658441ca43bd6eca324ac2c1e57645' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/bp-disable-activation-loader/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fbp-disable-activation-loader%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fbp-disable-activation-loader%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-bp-disable-activation-reloaded-1.2.1-file-bp-disable-activation-loader","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="bp-disable-activation-loader" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to bp-disable-activation-reloaded." href="http://hookr.io/plugins/bp-disable-activation-reloaded/" class="plugin"><span property="name">bp-disable-activation-reloaded</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 1.2.1." href="http://hookr.io/plugins/bp-disable-activation-reloaded/1.2.1/" class="H_VERSION"><span property="name">1.2.1</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/bp-disable-activation-reloaded/1.2.1/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">bp-disable-activation-loader</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="19"><a href="http://hookr.io/plugins/bp-disable-activation-reloaded/1.2.1/all/" title="All">All <span class="count badge">19</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/bp-disable-activation-reloaded/1.2.1/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="17"><a href="http://hookr.io/plugins/bp-disable-activation-reloaded/1.2.1/hooks/" title="Hooks">Hooks <span class="count badge">17</span></a></li><li class="" data-id="action" data-count="12"><a href="http://hookr.io/plugins/bp-disable-activation-reloaded/1.2.1/actions/" title="Actions">Actions <span class="count badge">12</span></a></li><li class="" data-id="filter" data-count="5"><a href="http://hookr.io/plugins/bp-disable-activation-reloaded/1.2.1/filters/" title="Filters">Filters <span class="count badge">5</span></a></li><li class="" data-id="class" data-count="2"><a href="http://hookr.io/plugins/bp-disable-activation-reloaded/1.2.1/classes/" title="Classes">Classes <span class="count badge">2</span></a></li><li class="" data-id="constant" data-count="0"><a href="http://hookr.io/plugins/bp-disable-activation-reloaded/1.2.1/constants/" title="Constants">Constants <span class="count badge">0</span></a></li><li class="" data-id="function" data-count="0"><a href="http://hookr.io/plugins/bp-disable-activation-reloaded/1.2.1/functions/" title="Functions">Functions <span class="count badge">0</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/plugins/bp-disable-activation-reloaded/1.2.1/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/bp-disable-activation-loader.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">Plugin Name: BP Disable Activation Reloaded</span>&nbsp;</div></li><li><div><span class="comment">Plugin URI: http://www.timersys.com/plugins-wordpress/bp-disable-activation-reloaded</span>&nbsp;</div></li><li><div><span class="comment">Description: Disable the activation email and authentificate the user. Also redirect to a page if selected . Based on BP Disable Activation from John Lynn</span>&nbsp;</div></li><li><div><span class="comment">Version: 1.2.1</span>&nbsp;</div></li><li><div><span class="comment">Author: timersys</span>&nbsp;</div></li><li><div><span class="comment">Author URI: http://www.timersys.com</span>&nbsp;</div></li><li><div><span class="comment">Requires at least: BuddyPress 1.7</span>&nbsp;</div></li><li><div><span class="comment">Tested up to: BuddyPress 2.0.2+wp 3.9.2</span>&nbsp;</div></li><li><div><span class="comment">License: MIT License</span>&nbsp;</div></li><li><div><span class="comment">Text Domain: dar</span>&nbsp;</div></li><li><div><span class="comment">Domain Path: languages</span>&nbsp;</div></li><li><div><span class="comment">*/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">**********</span>&nbsp;</div></li><li><div><span class="comment">* License</span>&nbsp;</div></li><li><div><span class="comment">****************************************************************************</span>&nbsp;</div></li><li><div><span class="comment">*    Copyright (C) 2011-2013 Damian Logghe and contributors</span>&nbsp;</div></li><li><div><span class="comment">*</span>&nbsp;</div></li><li><div><span class="comment">*    Permission is hereby granted, free of charge, to any person obtaining</span>&nbsp;</div></li><li><div><span class="comment">*    a copy of this software and associated documentation files (the</span>&nbsp;</div></li><li><div><span class="comment">*    &quot;Software&quot;), to deal in the Software without restriction, including</span>&nbsp;</div></li><li><div><span class="comment">*    without limitation the rights to use, copy, modify, merge, publish, </span>&nbsp;</div></li><li><div><span class="comment">*    distribute, sublicense, and/or sell copies of the Software, and to</span>&nbsp;</div></li><li><div><span class="comment">*    permit persons to whom the Software is furnished to do so, subject to</span>&nbsp;</div></li><li><div><span class="comment">*    the following conditions:</span>&nbsp;</div></li><li><div><span class="comment">*</span>&nbsp;</div></li><li><div><span class="comment">*    The above copyright notice and this permission notice shall be</span>&nbsp;</div></li><li><div><span class="comment">*    included in all copies or substantial portions of the Software.</span>&nbsp;</div></li><li><div><span class="comment">*</span>&nbsp;</div></li><li><div><span class="comment">*    THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, </span>&nbsp;</div></li><li><div><span class="comment">*    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</span>&nbsp;</div></li><li><div><span class="comment">*    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND</span>&nbsp;</div></li><li><div><span class="comment">*    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE</span>&nbsp;</div></li><li><div><span class="comment">*    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION</span>&nbsp;</div></li><li><div><span class="comment">*    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION</span>&nbsp;</div></li><li><div><span class="comment">*    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span>&nbsp;</div></li><li><div><span class="comment">****************************************************************************/</span>&nbsp;</div></li><li><div><span class="comment">/***</span>&nbsp;</div></li><li><div><span class="comment">  Copyright (C) 2009 John Lynn(crashutah.com)</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">  This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or  any later version.</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">  You should have received a copy of the GNU General Public License along with this program; if not, see &lt;http://www.gnu.org/licenses&gt;.</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div><span class="comment">/***</span>&nbsp;</div></li><li><div><span class="comment">  Credit goes to AndyPeatling for most of the initial code</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div><span class="comment">/***</span>&nbsp;</div></li><li><div><span class="comment">  Word of Caution: Use this Plugin at your own risk.  The email activation can be one way to keep spammers from registering on your site.  Make sure you're looking at other options to prevent spammers if you use this plugin to remove the email activation.</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Exit if accessed directly</span>&nbsp;</div></li><li><div>if ( !defined( 'ABSPATH' ) ) exit;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>require(dirname (__FILE__).'/WP_Plugin_Base.class.php');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>class BP_Disable_Activation_Reloaded extends WP_Plugin_Base&nbsp;</div></li><li><div>{&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  protected $_options;&nbsp;</div></li><li><div>  var $_credits;&nbsp;</div></li><li><div>  var $_defaults;&nbsp;</div></li><li><div>  protected $sections;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  private static $instance = null;&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>  <span class="comment">/**--------------------------------------------*</span>&nbsp;</div></li><li><div><span class="comment">   * Constructor</span>&nbsp;</div></li><li><div><span class="comment">   *--------------------------------------------*/</span>&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Creates or returns an instance of this class.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  Foo A single instance of this class.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public static function get_instance() {&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>      if ( null == self::$instance ) {&nbsp;</div></li><li><div>          self::$instance = new self;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>      return self::$instance;&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>  } <span class="comment">// end get_instance;</span>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  function __construct() {&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      $this-&gt;WPB_PREFIX =    'dar';&nbsp;</div></li><li><div>      $this-&gt;WPB_SLUG =    'bp-disable-activation-reloaded'; <span class="comment">// Need to match plugin folder name</span>&nbsp;</div></li><li><div>      $this-&gt;WPB_PLUGIN_NAME =    'BP Disable Activation Reloaded';&nbsp;</div></li><li><div>      $this-&gt;WPB_VERSION =    '1.2.1';&nbsp;</div></li><li><div>      $this-&gt;PLUGIN_FILE =   plugin_basename(__FILE__);&nbsp;</div></li><li><div>      $this-&gt;options_name =   'dar_settings';&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      $this-&gt;sections['general'] = __( 'Main Settings', $this-&gt;WPB_PREFIX );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">//activation hook</span>&nbsp;</div></li><li><div>      register_activation_hook( __FILE__, array(&$this, 'activate' ));        &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">//deactivation hook</span>&nbsp;</div></li><li><div>      register_deactivation_hook( __FILE__, array(&$this, 'deactivate' ));   &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">//admin menu</span>&nbsp;</div></li><li><div>      add_action( 'admin_menu', array(&$this, 'register_menu' ) );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">//load js and css </span>&nbsp;</div></li><li><div>      add_action( 'init', array(&$this, 'load_scripts' ), 50 );    &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      add_action( 'bp_init', array(&$this, 'my_plugin_init' ));&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      $this-&gt;loadOptions();&nbsp;</div></li><li><div>      #$this-&gt;upgradePlugin();&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>      #$this-&gt;setDefaults();&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>      parent::__construct();&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  }    &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">  * Load the plugin once BuddyPress is loaded</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>  function my_plugin_init() {&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**The Functions to automatically activate for Single WP Installs*/</span>&nbsp;</div></li><li><div>      if ( !is_multisite() ) {&nbsp;</div></li><li><div>          add_action( 'bp_core_signup_user' , array(&$this, 'disable_validation' ));&nbsp;</div></li><li><div>          add_filter( 'bp_registration_needs_activation' , array(&$this, 'fix_signup_form_validation_text' ));&nbsp;</div></li><li><div>          add_filter( 'bp_core_signup_send_activation_key', array(&$this, 'disable_activation_email' ));&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          <span class="comment">//Remove filters which notifies users</span>&nbsp;</div></li><li><div>          remove_filter( 'wpmu_signup_user_notification' , 'bp_core_activation_signup_user_notification', 1, 4 );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          add_filter( 'wpmu_signup_user_notification' , array(&$this, 'cc_auto_activate_on_user_signup'), 1, 4 );&nbsp;</div></li><li><div>      #    add_action( 'signup_finished' , array(&$this, &quot;cc_auto_activate_finished&quot;);&nbsp;</div></li><li><div>      }    &nbsp;</div></li><li><div>      if( isset($_GET['page']) && 'bp-disable-activation-reloaded' == $_GET['page'] && !empty( $_GET['fix_pending_users'] ) ) {&nbsp;</div></li><li><div>          global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $users = $wpdb-&gt;get_results( &quot;SELECT activation_key, user_login FROM {$wpdb-&gt;prefix}signups WHERE active = '0' &quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ($users as $user) {&nbsp;</div></li><li><div>              bp_core_activate_signup($user-&gt;activation_key);&nbsp;</div></li><li><div>              BP_Signup::validate($user-&gt;activation_key);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">//fix roles</span>&nbsp;</div></li><li><div>              $user_id = $wpdb-&gt;get_var( &quot;SELECT ID FROM $wpdb-&gt;users WHERE user_login = '$user-&gt;user_login'&quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $u = new WP_User( $user_id );&nbsp;</div></li><li><div>              $u-&gt;add_role( 'subscriber' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }    &nbsp;</div></li><li><div>  function disable_validation( $user_id ) {&nbsp;</div></li><li><div>      global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $options = $this-&gt;_options;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">//Hook if you want to do something before the activation</span>&nbsp;</div></li><li><div>      do_action('bp_disable_activation_before_activation');&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      $activation_key = get_user_meta($user_id, 'activation_key', true);&nbsp;</div></li><li><div>      $activate = apply_filters('bp_core_activate_account', bp_core_activate_signup($activation_key));&nbsp;</div></li><li><div>      BP_Signup::validate($activation_key);&nbsp;</div></li><li><div>      $wpdb-&gt;query( $wpdb-&gt;prepare( &quot;UPDATE $wpdb-&gt;users SET user_status = 0 WHERE ID = %d&quot;, $user_id ) );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">//Add note on Activity Stream</span>&nbsp;</div></li><li><div>      if ( function_exists( 'bp_activity_add' ) ) {&nbsp;</div></li><li><div>          $userlink = bp_core_get_userlink( $user_id );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          bp_activity_add( array(&nbsp;</div></li><li><div>              'user_id' =&gt; $user_id, &nbsp;</div></li><li><div>              'action' =&gt; apply_filters( 'bp_core_activity_registered_member', sprintf( __( '%s became a registered member', 'buddypress' ), $userlink ), $user_id ), &nbsp;</div></li><li><div>              'component' =&gt; 'profile', &nbsp;</div></li><li><div>              'type' =&gt; 'new_member'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      <span class="comment">//Send email to admin</span>&nbsp;</div></li><li><div>      wp_new_user_notification( $user_id );&nbsp;</div></li><li><div>      <span class="comment">// Remove the activation key meta</span>&nbsp;</div></li><li><div>      delete_user_meta( $user_id, 'activation_key' );&nbsp;</div></li><li><div>      <span class="comment">// Delete the total member cache</span>&nbsp;</div></li><li><div>      wp_cache_delete( 'bp_total_member_count', 'bp' );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>      <span class="comment">//Hook if you want to do something before the login</span>&nbsp;</div></li><li><div>      do_action('bp_disable_activation_before_login');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( $options['enable_login'] == 'true' )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">//Automatically log the user in    .</span></span>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">//Thanks to Justin Klein's  wp-fb-autoconnect plugin for the basic code to login automatically</span></span>&nbsp;</div></li><li><div>          $user_info = get_userdata($user_id);&nbsp;</div></li><li><div>          wp_set_auth_cookie($user_id);&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>          do_action('wp_signon', $user_info-&gt;user_login);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment"><span class="comment">//Hook if you want to do something after the login</span></span>&nbsp;</div></li><li><div>      do_action('bp_disable_activation_after_login');&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      $redirection = apply_filters('dar_redirection_url', $options['redirection']);&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( $redirection != '' )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          wp_safe_redirect($redirection);&nbsp;</div></li><li><div>          die();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  function fix_signup_form_validation_text() {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  function disable_activation_email() {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**START Functions to automatically activate for WPMU (multi-site)  Installs (Activates User and Blogs)*/</span>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   Credit for most of the WPMU code goes to Brajesh Singh and his plugin &quot;BP Auto activate User and Blog at Signup&quot;</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  function cc_auto_activate_on_user_signup($user, $user_email, $key, $meta) {&nbsp;</div></li><li><div>      <span class="comment">//only multisite part will be executed</span>&nbsp;</div></li><li><div>      $user_id = bp_core_activate_signup($key);&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      $options = $this-&gt;_options;&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( $options['enable_login'] == 'true' )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">//Automatically log the user in    .</span></span>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">//Thanks to Justin Klein's  wp-fb-autoconnect plugin for the basic code to login automatically</span></span>&nbsp;</div></li><li><div>          $user_info = get_userdata($user_id);&nbsp;</div></li><li><div>          wp_set_auth_cookie($user_id);&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>          do_action('wp_signon', $user_info-&gt;user_login);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment"><span class="comment">//Hook if you want to do something after the login</span></span>&nbsp;</div></li><li><div>      do_action('bp_disable_activation_after_login');&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      $redirection = apply_filters('dar_redirection_url', $options['redirection']);&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      if( $redirection != '' )&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          wp_safe_redirect($redirection);&nbsp;</div></li><li><div>          die();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">  * Check technical requirements before activating the plugin. </span>&nbsp;</div></li><li><div><span class="comment">  * WordPress 3.0 or newer required</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>  function activate()&nbsp;</div></li><li><div>  {&nbsp;</div></li><li><div>      parent::activate();&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      do_action( $this-&gt;WPB_PREFIX.'_activate' );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  }    &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">  * Run when plugin is deactivated</span>&nbsp;</div></li><li><div><span class="comment">  * WordPress 3.0 or newer required</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>  function deactivate()&nbsp;</div></li><li><div>  {&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      do_action( $this-&gt;WPB_PREFIX.'_deactivate' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">  * function that register the menu link in the settings menu    and editor section inside the option page</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>   function register_menu()&nbsp;</div></li><li><div>  {&nbsp;</div></li><li><div>      #add_options_page( 'WP Plugin Base', 'WP Plugin Base', 'manage_options', WPB_SLUG , array(&$this, 'options_page') );&nbsp;</div></li><li><div>      add_menu_page( 'BP DAR', 'BP DAR', 'manage_options', $this-&gt;WPB_SLUG , array(&$this, 'display_page') );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">  * Load scripts and styles</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>  function load_scripts()&nbsp;</div></li><li><div>  {&nbsp;</div></li><li><div>      if(!is_admin())&nbsp;</div></li><li><div>      {&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          #wp_enqueue_script('wsi-js', plugins_url( 'assets/js/wsi.js', __FILE__ ), array('jquery'), $this-&gt;WPB_VERSION, true);&nbsp;</div></li><li><div>          #wp_enqueue_style('wsi-css', plugins_url( 'assets/css/style.css', __FILE__ ) , '', $this-&gt;WPB_VERSION, 'all' );&nbsp;</div></li><li><div>          #wp_localize_script( 'jquery', 'WsiMyAjax', array( 'url' =&gt; site_url( 'wp-login.php' ), 'admin_url' =&gt; admin_url( 'admin-ajax.php' ), 'nonce' =&gt; wp_create_nonce( 'wsi-ajax-nonce' ) ) );&nbsp;</div></li><li><div>          #wp_enqueue('codemirror');&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">  * Load options to use later</span>&nbsp;</div></li><li><div><span class="comment">  */</span>    &nbsp;</div></li><li><div>  function loadOptions()&nbsp;</div></li><li><div>  {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;_options = get_option($this-&gt;WPB_PREFIX.'_settings', $this-&gt;_defaults);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">  * loads plugins defaults</span>&nbsp;</div></li><li><div><span class="comment">  */</span>&nbsp;</div></li><li><div>  function setDefaults()&nbsp;</div></li><li><div>  {&nbsp;</div></li><li><div>      $this-&gt;_defaults = array( 'version' =&gt; $this-&gt;WPB_VERSION );        &nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>BP_Disable_Activation_Reloaded::get_instance();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>BP Disable Activation Reloaded</li><li><span></span>1.2.1</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>