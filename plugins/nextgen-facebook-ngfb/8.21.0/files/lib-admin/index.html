<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="8.21.0" data-slug="nextgen-facebook-ngfb" data-type="file" data-id="7615"><head xmlns="http://www.w3.org/1999/xhtml"><title> lib-admin | file | Nextgen Facebook Ngfb | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, nextgen-facebook-ngfb, 8.21.0" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.24"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=4f8438eda1c5ed96d29226d48e7ddf4a' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.24' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/lib-admin/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Flib-admin%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Flib-admin%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-nextgen-facebook-ngfb-8.21.0-file-lib-admin","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="lib-admin" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to nextgen-facebook-ngfb." href="http://hookr.io/plugins/nextgen-facebook-ngfb/" class="plugin"><span property="name">nextgen-facebook-ngfb</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 8.21.0." href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.21.0/" class="H_VERSION"><span property="name">8.21.0</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.21.0/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">lib-admin</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="327"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.21.0/all/" title="All">All <span class="count badge">327</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.21.0/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="218"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.21.0/hooks/" title="Hooks">Hooks <span class="count badge">218</span></a></li><li class="" data-id="action" data-count="12"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.21.0/actions/" title="Actions">Actions <span class="count badge">12</span></a></li><li class="" data-id="filter" data-count="206"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.21.0/filters/" title="Filters">Filters <span class="count badge">206</span></a></li><li class="" data-id="class" data-count="89"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.21.0/classes/" title="Classes">Classes <span class="count badge">89</span></a></li><li class="" data-id="constant" data-count="13"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.21.0/constants/" title="Constants">Constants <span class="count badge">13</span></a></li><li class="" data-id="function" data-count="6"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.21.0/functions/" title="Functions">Functions <span class="count badge">6</span></a></li><li class="" data-id="shortcode" data-count="1"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.21.0/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">1</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/lib/admin.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * License: GPLv3</span>&nbsp;</div></li><li><div><span class="comment"> * License URI: http://www.gnu.org/licenses/gpl.txt</span>&nbsp;</div></li><li><div><span class="comment"> * Copyright 2012-2015 - Jean-Sebastien Morisset - http://surniaulula.com/</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( ! defined( 'ABSPATH' ) ) &nbsp;</div></li><li><div>  die( 'These aren\'t the droids you\'re looking for...' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( ! class_exists( 'NgfbAdmin' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  class NgfbAdmin {&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>      protected $p;&nbsp;</div></li><li><div>      protected $menu_id;&nbsp;</div></li><li><div>      protected $menu_name;&nbsp;</div></li><li><div>      protected $menu_lib;&nbsp;</div></li><li><div>      protected $pagehook;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public static $is_suffix;&nbsp;</div></li><li><div>      public static $readme_info = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public $form;&nbsp;</div></li><li><div>      public $lang = array();&nbsp;</div></li><li><div>      public $submenu = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function __construct( &$plugin ) {&nbsp;</div></li><li><div>          $this-&gt;p =& $plugin;&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( defined( 'DOING_AJAX' ) && DOING_AJAX ) {&nbsp;</div></li><li><div>              <span class="comment">// nothing to do</span>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              load_plugin_textdomain( 'nextgen-facebook', false, 'nextgen-facebook/languages/' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;set_objects();&nbsp;</div></li><li><div>              $this-&gt;pro_req_notices();&nbsp;</div></li><li><div>              $this-&gt;conflict_warnings();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              add_action( 'admin_init', array( &$this, 'register_setting' ) );&nbsp;</div></li><li><div>              add_action( 'admin_menu', array( &$this, 'add_admin_menus' ), NGFB_ADD_MENU_PRIORITY );&nbsp;</div></li><li><div>              <span class="comment">// add settings and users submenu items</span>&nbsp;</div></li><li><div>              add_action( 'admin_menu', array( &$this, 'add_admin_submenus' ), NGFB_ADD_SUBMENU_PRIORITY );&nbsp;</div></li><li><div>              add_action( 'activated_plugin', array( &$this, 'check_activated_plugin' ), 10, 2 );&nbsp;</div></li><li><div>              add_action( 'after_switch_theme', array( &$this, 'check_tmpl_head_elements' ) );&nbsp;</div></li><li><div>              add_action( 'upgrader_process_complete', array( &$this, 'check_tmpl_head_elements' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              add_filter( 'plugin_action_links', array( &$this, 'add_plugin_action_links' ), 10, 2 );&nbsp;</div></li><li><div>              add_filter( 'wp_redirect', array( &$this, 'wp_profile_updated_redirect' ), -100, 2 );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>              if ( is_multisite() ) {&nbsp;</div></li><li><div>                  add_action( 'network_admin_menu', array( &$this, 'add_network_admin_menus' ), NGFB_ADD_MENU_PRIORITY );&nbsp;</div></li><li><div>                  add_action( 'network_admin_edit_'.NGFB_SITE_OPTIONS_NAME, array( &$this, 'save_site_options' ) );&nbsp;</div></li><li><div>                  add_filter( 'network_admin_plugin_action_links', array( &$this, 'add_plugin_action_links' ), 10, 2 );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              add_filter( 'get_user_option_wpseo_dismissed_conflicts', &nbsp;</div></li><li><div>                  array( &$this, 'dismiss_wpseo_notice' ), 10, 3 );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// load all submenu classes into the $this-&gt;submenu array</span>&nbsp;</div></li><li><div>      <span class="comment">// the id of each submenu item must be unique</span>&nbsp;</div></li><li><div>      private function set_objects() {&nbsp;</div></li><li><div>          self::$is_suffix = ' '.( $this-&gt;p-&gt;check-&gt;aop( $this-&gt;p-&gt;cf['lca'], &nbsp;</div></li><li><div>              true, $this-&gt;p-&gt;is_avail['aop'] ) ? &nbsp;</div></li><li><div>                  _x( 'Pro', 'package type', 'nextgen-facebook' ) :&nbsp;</div></li><li><div>                  _x( 'Free', 'package type', 'nextgen-facebook' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $menu_libs = array( &nbsp;</div></li><li><div>              'submenu', &nbsp;</div></li><li><div>              'setting', <span class="comment">// setting must be after submenu to extend submenu/advanced.php</span>&nbsp;</div></li><li><div>              'profile', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( is_multisite() )&nbsp;</div></li><li><div>              $menu_libs[] = 'sitesubmenu';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $menu_libs as $menu_lib ) {&nbsp;</div></li><li><div>              foreach ( $this-&gt;p-&gt;cf['plugin'] as $ext =&gt; $info ) {&nbsp;</div></li><li><div>                  if ( isset( $info['lib'][$menu_lib] ) ) {&nbsp;</div></li><li><div>                      foreach ( $info['lib'][$menu_lib] as $menu_id =&gt; $menu_name ) {&nbsp;</div></li><li><div>                          if ( strpos( $menu_id, 'separator' ) !== false ) &nbsp;</div></li><li><div>                              continue;&nbsp;</div></li><li><div>                          $classname = apply_filters( $ext.'_load_lib', false, $menu_lib.'/'.$menu_id );&nbsp;</div></li><li><div>                          if ( $classname !== false && class_exists( $classname ) ) {&nbsp;</div></li><li><div>                              if ( ! empty( $info['text_domain'] ) )&nbsp;</div></li><li><div>                                  $menu_name = _x( $menu_name, 'lib file description', $info['text_domain'] );&nbsp;</div></li><li><div>                              $this-&gt;submenu[$menu_id] = new $classname( $this-&gt;p, $menu_id, $menu_name, $menu_lib );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      private function pro_req_notices() {&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;is_avail['aop'] === true && &nbsp;</div></li><li><div>              empty( $this-&gt;p-&gt;options['plugin_'.$lca.'_tid'] ) && &nbsp;</div></li><li><div>                  ( empty( $this-&gt;p-&gt;options['plugin_'.$lca.'_tid:is'] ) || &nbsp;</div></li><li><div>                      $this-&gt;p-&gt;options['plugin_'.$lca.'_tid:is'] !== 'disabled' ) )&nbsp;</div></li><li><div>                          $this-&gt;p-&gt;notice-&gt;nag( $this-&gt;p-&gt;msgs-&gt;get( 'notice-pro-tid-missing' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $has_tid = false;&nbsp;</div></li><li><div>          foreach ( $this-&gt;p-&gt;cf['plugin'] as $ext =&gt; $info ) {&nbsp;</div></li><li><div>              if ( ! empty( $this-&gt;p-&gt;options['plugin_'.$ext.'_tid'] ) &&&nbsp;</div></li><li><div>                  isset( $info['base'] ) && SucomUtil::active_plugins( $info['base'] ) ) {&nbsp;</div></li><li><div>                  $has_tid = true;&nbsp;</div></li><li><div>                  if ( ! $this-&gt;p-&gt;check-&gt;aop( $ext, false ) )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;notice-&gt;err( $this-&gt;p-&gt;msgs-&gt;get( 'notice-pro-not-installed', &nbsp;</div></li><li><div>                          array( 'lca' =&gt; $ext ) ), true );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $has_tid === true && ! $this-&gt;p-&gt;is_avail['util']['um'] ) {&nbsp;</div></li><li><div>              if ( ! function_exists( 'get_plugins' ) )&nbsp;</div></li><li><div>                  require_once( ABSPATH.'wp-admin/includes/plugin.php' );&nbsp;</div></li><li><div>              $installed_plugins = get_plugins();&nbsp;</div></li><li><div>              if ( ! empty( $this-&gt;p-&gt;cf['plugin']['ngfbum']['base'] ) &&&nbsp;</div></li><li><div>                  is_array( $installed_plugins[$this-&gt;p-&gt;cf['plugin']['ngfbum']['base']] ) )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;notice-&gt;nag( $this-&gt;p-&gt;msgs-&gt;get( 'notice-um-activate-extension' ), true );&nbsp;</div></li><li><div>              else $this-&gt;p-&gt;notice-&gt;nag( $this-&gt;p-&gt;msgs-&gt;get( 'notice-um-extension-required' ), true );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function check_activated_plugin( $plugin = false, $sitewide = false ) {&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          switch ( $plugin ) {&nbsp;</div></li><li><div>              case $this-&gt;p-&gt;cf['plugin'][$lca.'um']['base']:&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;trunc( 'nag' );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function set_form_property() {&nbsp;</div></li><li><div>          $def_opts = $this-&gt;p-&gt;opt-&gt;get_defaults();&nbsp;</div></li><li><div>          $this-&gt;form = new SucomForm( $this-&gt;p, NGFB_OPTIONS_NAME, $this-&gt;p-&gt;options, $def_opts );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function &get_form_reference() {    <span class="comment">// returns a reference</span>&nbsp;</div></li><li><div>          return $this-&gt;form;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function register_setting() {&nbsp;</div></li><li><div>          register_setting( $this-&gt;p-&gt;cf['lca'].'_setting', &nbsp;</div></li><li><div>              NGFB_OPTIONS_NAME, array( &$this, 'registered_setting_sanitation' ) );&nbsp;</div></li><li><div>      } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function set_readme_info( $expire_secs = 86400 ) {&nbsp;</div></li><li><div>          foreach ( array_keys( $this-&gt;p-&gt;cf['plugin'] ) as $ext ) {&nbsp;</div></li><li><div>              if ( empty( self::$readme_info[$ext] ) )&nbsp;</div></li><li><div>                  self::$readme_info[$ext] = $this-&gt;p-&gt;util-&gt;parse_readme( $ext, $expire_secs );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function add_admin_submenus() {&nbsp;</div></li><li><div>          foreach ( array( 'profile', 'setting' ) as $menu_lib ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment">// match wordpress behavior (users page for admins, profile page for everyone else)</span></span></span>&nbsp;</div></li><li><div>              if ( $menu_lib === 'profile' && current_user_can( 'list_users' ) )&nbsp;</div></li><li><div>                  $parent_slug = $this-&gt;p-&gt;cf['wp']['admin']['users']['page'];&nbsp;</div></li><li><div>              else $parent_slug = $this-&gt;p-&gt;cf['wp']['admin'][$menu_lib]['page'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( $this-&gt;p-&gt;cf['*']['lib'][$menu_lib] as $menu_id =&gt; $menu_name ) {&nbsp;</div></li><li><div>                  if ( isset( $this-&gt;submenu[$menu_id] ) )&nbsp;</div></li><li><div>                      $this-&gt;submenu[$menu_id]-&gt;add_submenu_page( $parent_slug );&nbsp;</div></li><li><div>                  else $this-&gt;add_submenu_page( $parent_slug, $menu_id, $menu_name, $menu_lib );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function add_network_admin_menus() {&nbsp;</div></li><li><div>          $this-&gt;add_admin_menus( 'sitesubmenu' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function add_admin_menus( $menu_lib = '' ) {&nbsp;</div></li><li><div>          $menu_lib = empty( $menu_lib ) ?&nbsp;</div></li><li><div>              'submenu' : $menu_lib;&nbsp;</div></li><li><div>          $libs = $this-&gt;p-&gt;cf['*']['lib'][$menu_lib];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;menu_id = key( $libs );&nbsp;</div></li><li><div>          $this-&gt;menu_name = $libs[$this-&gt;menu_id];&nbsp;</div></li><li><div>          $this-&gt;menu_lib = $menu_lib;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( isset( $this-&gt;submenu[$this-&gt;menu_id] ) ) {&nbsp;</div></li><li><div>              $menu_slug = $this-&gt;p-&gt;cf['lca'].'-'.$this-&gt;menu_id;&nbsp;</div></li><li><div>              $this-&gt;submenu[$this-&gt;menu_id]-&gt;add_menu_page( $menu_slug );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $libs as $menu_id =&gt; $menu_name ) {&nbsp;</div></li><li><div>              $parent_slug = $this-&gt;p-&gt;cf['lca'].'-'.$this-&gt;menu_id;&nbsp;</div></li><li><div>              if ( isset( $this-&gt;submenu[$menu_id] ) )&nbsp;</div></li><li><div>                  $this-&gt;submenu[$menu_id]-&gt;add_submenu_page( $parent_slug );&nbsp;</div></li><li><div>              else $this-&gt;add_submenu_page( $parent_slug, $menu_id, $menu_name, $menu_lib );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function add_menu_page( $menu_slug ) {&nbsp;</div></li><li><div>          global $wp_version;&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $short = $this-&gt;p-&gt;cf['plugin'][$lca]['short'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// add_menu_page( $page_title, $menu_title, $capability, $menu_slug, $function, $icon_url, $position );</span>&nbsp;</div></li><li><div>          $this-&gt;pagehook = add_menu_page( &nbsp;</div></li><li><div>              $short.self::$is_suffix.' &mdash; '.$this-&gt;menu_name, &nbsp;</div></li><li><div>              $this-&gt;p-&gt;cf['menu'].self::$is_suffix, &nbsp;</div></li><li><div>              ( isset( $this-&gt;p-&gt;cf['wp']['admin'][$this-&gt;menu_lib]['cap'] ) ?&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;cf['wp']['admin'][$this-&gt;menu_lib]['cap'] :&nbsp;</div></li><li><div>                  'manage_options' ), <span class="comment"><span class="comment">// fallback to manage_options capability</span></span>&nbsp;</div></li><li><div>              $menu_slug, &nbsp;</div></li><li><div>              array( &$this, 'show_setting_page' ), &nbsp;</div></li><li><div>              ( version_compare( $wp_version, 3.8, '&lt;' ) ? null : 'dashicons-share' ), &nbsp;</div></li><li><div>              NGFB_MENU_ORDER&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          add_action( 'load-'.$this-&gt;pagehook, array( &$this, 'load_setting_page' ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function add_submenu_page( $parent_slug, $menu_id = '', $menu_name = '', $menu_lib = '' ) {&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $short = $this-&gt;p-&gt;cf['plugin'][$lca]['short'];&nbsp;</div></li><li><div>          $menu_id = empty( $menu_id ) ?&nbsp;</div></li><li><div>              $this-&gt;menu_id : $menu_id;&nbsp;</div></li><li><div>          $menu_name = empty( $menu_name ) ?&nbsp;</div></li><li><div>              $this-&gt;menu_name : $menu_name;&nbsp;</div></li><li><div>          $menu_lib = empty( $menu_lib ) ?&nbsp;</div></li><li><div>              $this-&gt;menu_lib : $menu_lib;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( strpos( $menu_id, 'separator' ) !== false ) {&nbsp;</div></li><li><div>              $menu_title = '&lt;div style=&quot;z-index:999;&nbsp;</div></li><li><div>                  padding:2px 0;&nbsp;</div></li><li><div>                  margin:0;&nbsp;</div></li><li><div>                  cursor:default;&nbsp;</div></li><li><div>                  border-bottom:1px dotted;&nbsp;</div></li><li><div>                  color:#666;&quot; onclick=&quot;return false;&quot;&gt;'.&nbsp;</div></li><li><div>                      ( $menu_name === $this-&gt;p-&gt;cf['menu'] ? &nbsp;</div></li><li><div>                          $menu_name.self::$is_suffix : $menu_name ).'&lt;/div&gt;';&nbsp;</div></li><li><div>              $menu_slug = '';&nbsp;</div></li><li><div>              $page_title = '';&nbsp;</div></li><li><div>              $function = '';&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              <span class="comment">// highlight the &quot;extension plugins&quot; part of the menu title</span>&nbsp;</div></li><li><div>              if ( strpos( $menu_id, 'licenses' ) !== false )&nbsp;</div></li><li><div>                  $menu_title = preg_replace( '/^&lt;span&gt;/', &nbsp;</div></li><li><div>                      '&lt;span style=&quot;color:#'.$this-&gt;p-&gt;cf['color'].';&quot;&gt;', $menu_name );&nbsp;</div></li><li><div>              else $menu_title = $menu_name;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $menu_slug = $lca.'-'.$menu_id;&nbsp;</div></li><li><div>              $page_title = $short.self::$is_suffix.' &mdash; '.$menu_title;&nbsp;</div></li><li><div>              $function = array( &$this, 'show_setting_page' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// add_submenu_page( $parent_slug, $page_title, $menu_title, $capability, $menu_slug, $function );</span>&nbsp;</div></li><li><div>          $this-&gt;pagehook = add_submenu_page( $parent_slug, $page_title, $menu_title, &nbsp;</div></li><li><div>              ( isset( $this-&gt;p-&gt;cf['wp']['admin'][$menu_lib]['cap'] ) ?&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;cf['wp']['admin'][$menu_lib]['cap'] :&nbsp;</div></li><li><div>                  'manage_options' ), $menu_slug, $function );    <span class="comment"><span class="comment">// fallback to manage_options capability</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $function )&nbsp;</div></li><li><div>              add_action( 'load-'.$this-&gt;pagehook, array( &$this, 'load_setting_page' ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// add links on the main plugins page</span>&nbsp;</div></li><li><div>      public function add_plugin_action_links( $links, $file ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! isset( $this-&gt;p-&gt;cf['*']['base'][$file] ) )&nbsp;</div></li><li><div>              return $links;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $ext = $this-&gt;p-&gt;cf['*']['base'][$file];&nbsp;</div></li><li><div>          $info = $this-&gt;p-&gt;cf['plugin'][$ext];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $links as $num =&gt; $val )&nbsp;</div></li><li><div>              if ( strpos( $val, '&gt;Edit&lt;' ) !== false )&nbsp;</div></li><li><div>                  unset ( $links[$num] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! empty( $info['url']['faq'] ) )&nbsp;</div></li><li><div>              $links[] = '&lt;a href=&quot;'.$info['url']['faq'].'&quot;&gt;'.&nbsp;</div></li><li><div>                  _x( 'FAQ', 'plugin action link', 'nextgen-facebook' ).'&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! empty( $info['url']['notes'] ) )&nbsp;</div></li><li><div>              $links[] = '&lt;a href=&quot;'.$info['url']['notes'].'&quot;&gt;'.&nbsp;</div></li><li><div>                  _x( 'Notes', 'plugin action link', 'nextgen-facebook' ).'&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! empty( $info['url']['latest_zip'] ) )&nbsp;</div></li><li><div>              $links[] = '&lt;a href=&quot;'.$info['url']['latest_zip'].'&quot;&gt;'.&nbsp;</div></li><li><div>                  _x( 'Download Latest', 'plugin action link', 'nextgen-facebook' ).'&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! empty( $info['url']['pro_support'] ) &&&nbsp;</div></li><li><div>              $this-&gt;p-&gt;check-&gt;aop( $ext, true, $this-&gt;p-&gt;is_avail['aop'] ) ) {&nbsp;</div></li><li><div>                  $links[] = '&lt;a href=&quot;'.$info['url']['pro_support'].'&quot;&gt;'.&nbsp;</div></li><li><div>                      _x( 'Pro Support', 'plugin action link', 'nextgen-facebook' ).'&lt;/a&gt;';&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              if ( ! empty( $info['url']['wp_support'] ) )&nbsp;</div></li><li><div>                  $links[] = '&lt;a href=&quot;'.$info['url']['wp_support'].'&quot;&gt;'.&nbsp;</div></li><li><div>                      _x( 'Support Forum', 'plugin action link', 'nextgen-facebook' ).'&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $info['url']['purchase'] ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;check-&gt;aop( $ext, false, $this-&gt;p-&gt;is_avail['aop'] ) )&nbsp;</div></li><li><div>                      $links[] = '&lt;a href=&quot;'.$info['url']['purchase'].'&quot;&gt;'.&nbsp;</div></li><li><div>                          _x( 'Purchase Pro License(s)', 'plugin action link', 'nextgen-facebook' ).'&lt;/a&gt;';&nbsp;</div></li><li><div>                  else $links[] = '&lt;a href=&quot;'.$info['url']['purchase'].'&quot;&gt;'.&nbsp;</div></li><li><div>                      _x( 'Purchase Pro Version', 'plugin action link', 'nextgen-facebook' ).'&lt;/a&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $links;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// this method receives only a partial options array, so re-create a full one</span>&nbsp;</div></li><li><div>      <span class="comment">// wordpress handles the actual saving of the options</span>&nbsp;</div></li><li><div>      public function registered_setting_sanitation( $opts ) {&nbsp;</div></li><li><div>          $network = false;&nbsp;</div></li><li><div>          if ( ! is_array( $opts ) ) {&nbsp;</div></li><li><div>              add_settings_error( NGFB_OPTIONS_NAME, 'notarray', '&lt;b&gt;'.$this-&gt;p-&gt;cf['uca'].' Error&lt;/b&gt; : '.&nbsp;</div></li><li><div>                  __( 'Submitted options are not an array.', 'nextgen-facebook' ), 'error' );&nbsp;</div></li><li><div>              return $opts;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">// get default values, including css from default stylesheets</span>&nbsp;</div></li><li><div>          $def_opts = $this-&gt;p-&gt;opt-&gt;get_defaults();&nbsp;</div></li><li><div>          $opts = SucomUtil::restore_checkboxes( $opts );&nbsp;</div></li><li><div>          $opts = array_merge( $this-&gt;p-&gt;options, $opts );&nbsp;</div></li><li><div>          $this-&gt;p-&gt;notice-&gt;trunc();    <span class="comment"><span class="comment">// clear all messages before sanitation checks</span></span>&nbsp;</div></li><li><div>          $opts = $this-&gt;p-&gt;opt-&gt;sanitize( $opts, $def_opts, $network );&nbsp;</div></li><li><div>          $opts = apply_filters( $this-&gt;p-&gt;cf['lca'].'_save_options', $opts, NGFB_OPTIONS_NAME, $network );&nbsp;</div></li><li><div>          $clear_cache_link = wp_nonce_url( $this-&gt;p-&gt;util-&gt;get_admin_url( '?'.$this-&gt;p-&gt;cf['lca'].&nbsp;</div></li><li><div>              '-action=clear_all_cache' ), self::get_nonce(), NGFB_NONCE );&nbsp;</div></li><li><div>          $this-&gt;p-&gt;notice-&gt;inf( __( 'Plugin settings have been saved.', 'nextgen-facebook' ).' '.&nbsp;</div></li><li><div>              sprintf( __( 'Wait %1$d seconds for cache objects to expire or &lt;a href=&quot;%2$s&quot;&gt;%3$s&lt;/a&gt; now.', &nbsp;</div></li><li><div>                  'nextgen-facebook' ), $this-&gt;p-&gt;options['plugin_object_cache_exp'], $clear_cache_link, &nbsp;</div></li><li><div>                      _x( 'Clear All Cache(s)', 'submit button', 'nextgen-facebook' ) ), true );&nbsp;</div></li><li><div>          $this-&gt;check_tmpl_head_elements();&nbsp;</div></li><li><div>          return $opts;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function save_site_options() {&nbsp;</div></li><li><div>          $network = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $page = empty( $_POST['page'] ) ? &nbsp;</div></li><li><div>              key( $this-&gt;p-&gt;cf['*']['lib']['sitesubmenu'] ) :&nbsp;</div></li><li><div>              $_POST['page'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( $_POST[ NGFB_NONCE ] ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'nonce token validation post field missing' );&nbsp;</div></li><li><div>              wp_redirect( $this-&gt;p-&gt;util-&gt;get_admin_url( $page ) );&nbsp;</div></li><li><div>              exit;&nbsp;</div></li><li><div>          } elseif ( ! wp_verify_nonce( $_POST[ NGFB_NONCE ], self::get_nonce() ) ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;notice-&gt;err( __( 'Nonce token validation failed for network options (update ignored).', &nbsp;</div></li><li><div>                  'nextgen-facebook' ), true );&nbsp;</div></li><li><div>              wp_redirect( $this-&gt;p-&gt;util-&gt;get_admin_url( $page ) );&nbsp;</div></li><li><div>              exit;&nbsp;</div></li><li><div>          } elseif ( ! current_user_can( 'manage_network_options' ) ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;notice-&gt;err( __( 'Insufficient privileges to modify network options.', &nbsp;</div></li><li><div>                  'nextgen-facebook' ), true );&nbsp;</div></li><li><div>              wp_redirect( $this-&gt;p-&gt;util-&gt;get_admin_url( $page ) );&nbsp;</div></li><li><div>              exit;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $def_opts = $this-&gt;p-&gt;opt-&gt;get_site_defaults();&nbsp;</div></li><li><div>          $opts = empty( $_POST[NGFB_SITE_OPTIONS_NAME] ) ? $def_opts : &nbsp;</div></li><li><div>              SucomUtil::restore_checkboxes( $_POST[NGFB_SITE_OPTIONS_NAME] );&nbsp;</div></li><li><div>          $opts = array_merge( $this-&gt;p-&gt;site_options, $opts );&nbsp;</div></li><li><div>          $this-&gt;p-&gt;notice-&gt;trunc();    <span class="comment"><span class="comment">// clear all messages before sanitation checks</span></span>&nbsp;</div></li><li><div>          $opts = $this-&gt;p-&gt;opt-&gt;sanitize( $opts, $def_opts, $network );&nbsp;</div></li><li><div>          $opts = apply_filters( $this-&gt;p-&gt;cf['lca'].'_save_site_options', $opts, $def_opts, $network );&nbsp;</div></li><li><div>          update_site_option( NGFB_SITE_OPTIONS_NAME, $opts );&nbsp;</div></li><li><div>          $this-&gt;p-&gt;notice-&gt;inf( __( 'Plugin settings have been saved.', 'nextgen-facebook' ), true );&nbsp;</div></li><li><div>          wp_redirect( $this-&gt;p-&gt;util-&gt;get_admin_url( $page ).'&settings-updated=true' );&nbsp;</div></li><li><div>          exit;    <span class="comment">// stop here</span>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function load_single_page() {&nbsp;</div></li><li><div>          wp_enqueue_script( 'postbox' );&nbsp;</div></li><li><div>          $this-&gt;p-&gt;admin-&gt;submenu[$this-&gt;menu_id]-&gt;add_meta_boxes();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function load_setting_page() {&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $action_query = $lca.'-action';&nbsp;</div></li><li><div>          wp_enqueue_script( 'postbox' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! empty( $_GET[$action_query] ) ) {&nbsp;</div></li><li><div>              $action_name = SucomUtil::sanitize_hookname( $_GET[$action_query] );&nbsp;</div></li><li><div>              if ( empty( $_GET[ NGFB_NONCE ] ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'nonce token validation query field missing' );&nbsp;</div></li><li><div>              } elseif ( ! wp_verify_nonce( $_GET[ NGFB_NONCE ], self::get_nonce() ) ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( __( 'Nonce token validation failed for action \&quot;'.$action_name.'\&quot;.', 'nextgen-facebook' ) );&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $_SERVER['REQUEST_URI'] = remove_query_arg( array( $action_query, NGFB_NONCE ) );&nbsp;</div></li><li><div>                  switch ( $action_name ) {&nbsp;</div></li><li><div>                      case 'check_for_updates': &nbsp;</div></li><li><div>                          if ( $this-&gt;p-&gt;is_avail['util']['um'] ) {&nbsp;</div></li><li><div>                              self::$readme_info = array();&nbsp;</div></li><li><div>                              $ngfbum = NgfbUm::get_instance();&nbsp;</div></li><li><div>                              $ngfbum-&gt;update-&gt;check_for_updates( null, true, false );&nbsp;</div></li><li><div>                          } else {&nbsp;</div></li><li><div>                              $this-&gt;p-&gt;notice-&gt;err( sprintf( __( 'The &lt;b&gt;%s&lt;/b&gt; extension is required to check for Pro version updates.', &nbsp;</div></li><li><div>                                  'nextgen-facebook' ), $this-&gt;p-&gt;cf['plugin'][$lca.'um']['name'] ) );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      case 'clear_all_cache': &nbsp;</div></li><li><div>                          $this-&gt;p-&gt;util-&gt;clear_all_cache();&nbsp;</div></li><li><div>                          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      case 'clear_metabox_prefs': &nbsp;</div></li><li><div>                          $user_id = get_current_user_id();&nbsp;</div></li><li><div>                          $user = get_userdata( $user_id );&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//$user_name = trim( $user-&gt;first_name.' '.$user-&gt;last_name );</span></span>&nbsp;</div></li><li><div>                          $user_name = $user-&gt;display_name;&nbsp;</div></li><li><div>                          NgfbUser::delete_metabox_prefs( $user_id );&nbsp;</div></li><li><div>                          $this-&gt;p-&gt;notice-&gt;inf( sprintf( __( 'Metabox layout preferences for user ID #%d &quot;%s&quot; have been reset.', &nbsp;</div></li><li><div>                              'nextgen-facebook' ), $user_id, $user_name ) );&nbsp;</div></li><li><div>                          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      case 'clear_hidden_notices': &nbsp;</div></li><li><div>                          $user_id = get_current_user_id();&nbsp;</div></li><li><div>                          $user = get_userdata( $user_id );&nbsp;</div></li><li><div>                          <span class="comment"><span class="comment">//$user_name = trim( $user-&gt;first_name.' '.$user-&gt;last_name );</span></span>&nbsp;</div></li><li><div>                          $user_name = $user-&gt;display_name;&nbsp;</div></li><li><div>                          delete_user_option( $user_id, NGFB_DISMISS_NAME );&nbsp;</div></li><li><div>                          $this-&gt;p-&gt;notice-&gt;inf( sprintf( __( 'Hidden notices for user ID #%d &quot;%s&quot; have been cleared.', &nbsp;</div></li><li><div>                              'nextgen-facebook' ), $user_id, $user_name ) );&nbsp;</div></li><li><div>                          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      case 'change_show_options': &nbsp;</div></li><li><div>                          if ( isset( $this-&gt;p-&gt;cf['form']['show_options'][$_GET['show-opts']] ) ) {&nbsp;</div></li><li><div>                              $this-&gt;p-&gt;notice-&gt;inf( sprintf( 'Option preference saved &mdash; viewing &quot;%s&quot; by default.', &nbsp;</div></li><li><div>                                  $this-&gt;p-&gt;cf['form']['show_options'][$_GET['show-opts']] ) );&nbsp;</div></li><li><div>                              NgfbUser::save_pref( array( 'show_opts' =&gt; $_GET['show-opts'] ) );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          $_SERVER['REQUEST_URI'] = remove_query_arg( array( 'show-opts' ) );&nbsp;</div></li><li><div>                          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      case 'modify_tmpl_head_elements': &nbsp;</div></li><li><div>                          $this-&gt;modify_tmpl_head_elements();&nbsp;</div></li><li><div>                          break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      default: &nbsp;</div></li><li><div>                          do_action( $lca.'_load_setting_page_'.$action_name, &nbsp;</div></li><li><div>                              $this-&gt;pagehook, $this-&gt;menu_id, $this-&gt;menu_name, $this-&gt;menu_lib );&nbsp;</div></li><li><div>                          break;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// the plugin information metabox on all settings pages needs this</span>&nbsp;</div></li><li><div>          $this-&gt;p-&gt;admin-&gt;set_readme_info( $this-&gt;p-&gt;cf['feed_cache_exp'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// add child metaboxes first, since they contain the default reset_metabox_prefs()</span>&nbsp;</div></li><li><div>          $this-&gt;p-&gt;admin-&gt;submenu[ $this-&gt;menu_id ]-&gt;add_meta_boxes();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( $this-&gt;p-&gt;options['plugin_'.$lca.'_tid'] ) || &nbsp;</div></li><li><div>              ! $this-&gt;p-&gt;check-&gt;aop( $lca, true, $this-&gt;p-&gt;is_avail['aop'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              add_meta_box( $this-&gt;pagehook.'_purchase', &nbsp;</div></li><li><div>                  _x( 'Pro / Power-User Version', 'metabox title (side)', 'nextgen-facebook' ), &nbsp;</div></li><li><div>                      array( &$this, 'show_metabox_purchase' ), $this-&gt;pagehook, 'side' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;p-&gt;mods['util']['user']-&gt;reset_metabox_prefs( $this-&gt;pagehook, &nbsp;</div></li><li><div>                  array( 'purchase' ), null, 'side', true );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_meta_box( $this-&gt;pagehook.'_help', &nbsp;</div></li><li><div>              _x( 'Help and Support', 'metabox title (side)', 'nextgen-facebook' ), &nbsp;</div></li><li><div>                  array( &$this, 'show_metabox_help' ), $this-&gt;pagehook, 'side' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;menu_lib === 'submenu' ) {&nbsp;</div></li><li><div>              add_meta_box( $this-&gt;pagehook.'_status_gpl', &nbsp;</div></li><li><div>                  _x( 'Standard Features', 'metabox title (side)', 'nextgen-facebook' ), &nbsp;</div></li><li><div>                      array( &$this, 'show_metabox_status_gpl' ), $this-&gt;pagehook, 'side' );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>              add_meta_box( $this-&gt;pagehook.'_status_pro', &nbsp;</div></li><li><div>                  _x( 'Pro Version Features', 'metabox title (side)', 'nextgen-facebook' ), &nbsp;</div></li><li><div>                      array( &$this, 'show_metabox_status_pro' ), $this-&gt;pagehook, 'side' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;menu_lib === 'submenu' || $this-&gt;menu_lib === 'sitesubmenu' ) {&nbsp;</div></li><li><div>              add_meta_box( $this-&gt;pagehook.'_version_info', &nbsp;</div></li><li><div>                  _x( 'Version Information', 'metabox title (side)', 'nextgen-facebook' ), &nbsp;</div></li><li><div>                      array( &$this, 'show_metabox_version_info' ), $this-&gt;pagehook, 'side' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function add_meta_boxes() {&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function show_setting_page( $sidebar = true ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! $this-&gt;is_setting() )&nbsp;</div></li><li><div>              settings_errors( NGFB_OPTIONS_NAME );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;set_form_property();            <span class="comment">// set form for side boxes and show_form_content()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;show_html( print_r( $this-&gt;p-&gt;is_avail, true ), 'available features' );&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;show_html( print_r( NgfbUtil::active_plugins(), true ), 'active plugins' );&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;show_html( null, 'debug log' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>          echo '&lt;div class=&quot;wrap&quot; id=&quot;'.$this-&gt;pagehook.'&quot;&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>          echo '&lt;h1&gt;'.$this-&gt;p-&gt;cf['plugin'][$this-&gt;p-&gt;cf['lca']]['short'].&nbsp;</div></li><li><div>              self::$is_suffix.' &ndash; '.$this-&gt;menu_name.'&lt;/h1&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $sidebar === false ) {&nbsp;</div></li><li><div>              echo '&lt;div id=&quot;poststuff&quot; class=&quot;metabox-holder&quot;&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;div id=&quot;post-body&quot;&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;div id=&quot;post-body-content&quot;&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              echo '&lt;div id=&quot;poststuff&quot; class=&quot;metabox-holder has-right-sidebar&quot;&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;div id=&quot;side-info-column&quot; class=&quot;inner-sidebar&quot;&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              do_meta_boxes( $this-&gt;pagehook, 'side', null );&nbsp;</div></li><li><div>              echo '&lt;/div&gt;&lt;!-- .inner-sidebar --&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;div id=&quot;post-body&quot; class=&quot;has-sidebar&quot;&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;div id=&quot;post-body-content&quot; class=&quot;has-sidebar-content&quot;&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;show_form_content();&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>                      &lt;/div&gt;&lt;!-- .post-body-content --&gt;&nbsp;</div></li><li><div>                  &lt;/div&gt;&lt;!-- .post-body --&gt;&nbsp;</div></li><li><div>              &lt;/div&gt;&lt;!-- .metabox-holder --&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&lt;!-- .wrap --&gt;&nbsp;</div></li><li><div>          &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>              <span class="comment">//&lt;![CDATA[</span>&nbsp;</div></li><li><div>              jQuery(document).ready( &nbsp;</div></li><li><div>                  function($) {&nbsp;</div></li><li><div>                      <span class="comment">// close postboxes that should be closed</span>&nbsp;</div></li><li><div>                      $('.if-js-closed').removeClass('if-js-closed').addClass('closed');&nbsp;</div></li><li><div>                      <span class="comment">// postboxes setup</span>&nbsp;</div></li><li><div>                      postboxes.add_postbox_toggles('&lt;?php echo $this-&gt;pagehook; ?&gt;');&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              <span class="comment">//]]&gt;</span>&nbsp;</div></li><li><div>          &lt;/script&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function wp_profile_updated_redirect( $location, $status ) {&nbsp;</div></li><li><div>          if ( strpos( $location, 'updated=' ) !== false && &nbsp;</div></li><li><div>              strpos( $location, 'wp_http_referer=' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment">// match wordpress behavior (users page for admins, profile page for everyone else)</span></span></span>&nbsp;</div></li><li><div>              $menu_lib = current_user_can( 'list_users' ) ? 'users' : 'profile';&nbsp;</div></li><li><div>              $parent_slug = $this-&gt;p-&gt;cf['wp']['admin'][$menu_lib]['page'];&nbsp;</div></li><li><div>              $referer_match = '/'.$parent_slug.'?page='.$this-&gt;p-&gt;cf['lca'].'-';&nbsp;</div></li><li><div>              parse_str( parse_url( $location, PHP_URL_QUERY ), $parts );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( strpos( $parts['wp_http_referer'], $referer_match ) ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;inf( __( 'Profile updated.' ), true );&nbsp;</div></li><li><div>                  return add_query_arg( 'updated', true, $parts['wp_http_referer'] );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $location;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function show_form_content() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;menu_lib === 'profile' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $user_id = get_current_user_id();&nbsp;</div></li><li><div>              $profileuser = get_user_to_edit( $user_id );&nbsp;</div></li><li><div>              $current_color = get_user_option( 'admin_color', $user_id );&nbsp;</div></li><li><div>              if ( empty( $current_color ) )&nbsp;</div></li><li><div>                  $current_color = 'fresh';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment">// match wordpress behavior (users page for admins, profile page for everyone else)</span></span></span>&nbsp;</div></li><li><div>              $admin_url = current_user_can( 'list_users' ) ? &nbsp;</div></li><li><div>                  $this-&gt;p-&gt;util-&gt;get_admin_url( $this-&gt;menu_id, null, 'users' ) :&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;util-&gt;get_admin_url( $this-&gt;menu_id, null, $this-&gt;menu_lib );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              echo '&lt;form name=&quot;'.$lca.'&quot; id=&quot;'.$lca.'_setting_form&quot; action=&quot;user-edit.php&quot; method=&quot;post&quot;&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;input type=&quot;hidden&quot; name=&quot;wp_http_referer&quot; value=&quot;'.$admin_url.'&quot; /&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;update&quot; /&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;input type=&quot;hidden&quot; name=&quot;user_id&quot; value=&quot;'.$user_id.'&quot; /&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;input type=&quot;hidden&quot; name=&quot;nickname&quot; value=&quot;'.$profileuser-&gt;nickname.'&quot; /&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;'.$profileuser-&gt;user_email.'&quot; /&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;input type=&quot;hidden&quot; name=&quot;admin_color&quot; value=&quot;'.$current_color.'&quot; /&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;input type=&quot;hidden&quot; name=&quot;rich_editing&quot; value=&quot;'.$profileuser-&gt;rich_editing.'&quot; /&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;input type=&quot;hidden&quot; name=&quot;comment_shortcuts&quot; value=&quot;'.$profileuser-&gt;comment_shortcuts.'&quot; /&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;input type=&quot;hidden&quot; name=&quot;admin_bar_front&quot; value=&quot;'._get_admin_bar_pref( 'front', $user_id ).'&quot; /&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              wp_nonce_field( 'update-user_'.$user_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          } elseif ( $this-&gt;menu_lib === 'setting' || $this-&gt;menu_lib === 'submenu' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              echo '&lt;form name=&quot;'.$lca.'&quot; id=&quot;'.$lca.'_setting_form&quot; action=&quot;options.php&quot; method=&quot;post&quot;&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              settings_fields( $lca.'_setting' ); &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          } elseif ( $this-&gt;menu_lib === 'sitesubmenu' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              echo '&lt;form name=&quot;'.$lca.'&quot; id=&quot;'.$lca.'_setting_form&quot; action=&quot;edit.php?action='.&nbsp;</div></li><li><div>                  NGFB_SITE_OPTIONS_NAME.'&quot; method=&quot;post&quot;&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;input type=&quot;hidden&quot; name=&quot;page&quot; value=&quot;'.$this-&gt;menu_id.'&quot; /&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          } else return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          wp_nonce_field( self::get_nonce(), NGFB_NONCE );&nbsp;</div></li><li><div>          wp_nonce_field( 'closedpostboxes', 'closedpostboxesnonce', false );&nbsp;</div></li><li><div>          wp_nonce_field( 'meta-box-order', 'meta-box-order-nonce', false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          do_meta_boxes( $this-&gt;pagehook, 'normal', null ); &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          do_action( $this-&gt;p-&gt;cf['lca'].'_form_content_metaboxes_'.&nbsp;</div></li><li><div>              SucomUtil::sanitize_hookname( $this-&gt;menu_id ), $this-&gt;pagehook );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          switch ( $this-&gt;menu_id ) {&nbsp;</div></li><li><div>              case 'readme':&nbsp;</div></li><li><div>              case 'setup':&nbsp;</div></li><li><div>              case 'sitereadme':&nbsp;</div></li><li><div>              case 'sitesetup':&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              default:&nbsp;</div></li><li><div>                  if ( $this-&gt;menu_lib === 'profile' )&nbsp;</div></li><li><div>                      echo $this-&gt;get_submit_buttons( _x( 'Save All Profile Settings', &nbsp;</div></li><li><div>                          'submit button', 'nextgen-facebook' ) );&nbsp;</div></li><li><div>                  else echo $this-&gt;get_submit_buttons();&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          echo '&lt;/form&gt;', &quot;\n&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function get_submit_buttons( $submit_text = '', $class = 'submit-buttons' ) {&nbsp;</div></li><li><div>          if ( empty( $submit_text ) ) &nbsp;</div></li><li><div>              $submit_text = _x( 'Save All Plugin Settings', 'submit button', 'nextgen-facebook' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $show_opts_next = SucomUtil::next_key( NgfbUser::show_opts(), $this-&gt;p-&gt;cf['form']['show_options'] );&nbsp;</div></li><li><div>          $show_opts_text = sprintf( _x( 'View %s by Default', 'submit button', 'nextgen-facebook' ), &nbsp;</div></li><li><div>              _x( $this-&gt;p-&gt;cf['form']['show_options'][$show_opts_next], &nbsp;</div></li><li><div>                  'option value', 'nextgen-facebook' ) );&nbsp;</div></li><li><div>          $show_opts_url = $this-&gt;p-&gt;util-&gt;get_admin_url( '?'.$this-&gt;p-&gt;cf['lca'].&nbsp;</div></li><li><div>              '-action=change_show_options&show-opts='.$show_opts_next );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $action_buttons = '&lt;input type=&quot;submit&quot; class=&quot;button-primary&quot; value=&quot;'.$submit_text.'&quot; /&gt;'.&nbsp;</div></li><li><div>              $this-&gt;form-&gt;get_button( $show_opts_text, 'button-secondary button-highlight', null, &nbsp;</div></li><li><div>                  wp_nonce_url( $show_opts_url, self::get_nonce(), NGFB_NONCE ) ).'&lt;br/&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;menu_lib === 'setting' || $this-&gt;menu_lib === 'submenu' )&nbsp;</div></li><li><div>              $action_buttons .= $this-&gt;form-&gt;get_button( _x( 'Clear All Cache(s)', 'submit button', 'nextgen-facebook' ), &nbsp;</div></li><li><div>                  'button-secondary', null, wp_nonce_url( $this-&gt;p-&gt;util-&gt;get_admin_url( '?'.$this-&gt;p-&gt;cf['lca'].&nbsp;</div></li><li><div>                      '-action=clear_all_cache' ), self::get_nonce(), NGFB_NONCE ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;menu_lib !== 'profile' )        <span class="comment">// don't show on profile pages</span>&nbsp;</div></li><li><div>              $action_buttons .= $this-&gt;form-&gt;get_button( _x( 'Check for Pro Update(s)', 'submit button', 'nextgen-facebook' ), &nbsp;</div></li><li><div>                  'button-secondary', null, wp_nonce_url( $this-&gt;p-&gt;util-&gt;get_admin_url( '?'.$this-&gt;p-&gt;cf['lca'].&nbsp;</div></li><li><div>                      '-action=check_for_updates' ), self::get_nonce(), NGFB_NONCE ), false, &nbsp;</div></li><li><div>                          ( $this-&gt;p-&gt;is_avail['util']['um'] ? false : true ) );    <span class="comment">// disable button if um not available</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $action_buttons .= $this-&gt;form-&gt;get_button( _x( 'Reset Metabox Layout', 'submit button', 'nextgen-facebook' ), &nbsp;</div></li><li><div>              'button-secondary', null, wp_nonce_url( $this-&gt;p-&gt;util-&gt;get_admin_url( '?'.$this-&gt;p-&gt;cf['lca'].&nbsp;</div></li><li><div>                  '-action=clear_metabox_prefs' ), self::get_nonce(), NGFB_NONCE ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $action_buttons .= $this-&gt;form-&gt;get_button( _x( 'Reset Hidden Notices', 'submit button', 'nextgen-facebook' ), &nbsp;</div></li><li><div>              'button-secondary', null, wp_nonce_url( $this-&gt;p-&gt;util-&gt;get_admin_url( '?'.$this-&gt;p-&gt;cf['lca'].&nbsp;</div></li><li><div>                  '-action=clear_hidden_notices' ), self::get_nonce(), NGFB_NONCE ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return '&lt;div class=&quot;'.$class.'&quot;&gt;'.$action_buttons.'&lt;/div&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function show_metabox_version_info() {&nbsp;</div></li><li><div>          echo '&lt;table class=&quot;sucom-setting '.$this-&gt;p-&gt;cf['lca'].' side&quot;&gt;';&nbsp;</div></li><li><div>          foreach ( $this-&gt;p-&gt;cf['plugin'] as $ext =&gt; $info ) {&nbsp;</div></li><li><div>              if ( empty( $info['version'] ) )    <span class="comment">// filter out extensions that are not active</span>&nbsp;</div></li><li><div>                  continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $stable_version = __( 'N/A', 'nextgen-facebook' );&nbsp;</div></li><li><div>              $latest_version = __( 'N/A', 'nextgen-facebook' );&nbsp;</div></li><li><div>              $installed_version = $info['version'];&nbsp;</div></li><li><div>              $installed_style = '';&nbsp;</div></li><li><div>              $latest_notice = '';&nbsp;</div></li><li><div>              $changelog_url = $info['url']['changelog'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// the readme_info array is populated by set_readme_info(), which is called from load_setting_page()</span>&nbsp;</div></li><li><div>              if ( ! empty( self::$readme_info[$ext]['stable_tag'] ) ) {&nbsp;</div></li><li><div>                  $stable_version = self::$readme_info[$ext]['stable_tag'];&nbsp;</div></li><li><div>                  $upgrade_notice = self::$readme_info[$ext]['upgrade_notice'];&nbsp;</div></li><li><div>                  if ( is_array( $upgrade_notice ) ) {&nbsp;</div></li><li><div>                      reset( $upgrade_notice );&nbsp;</div></li><li><div>                      $latest_version = key( $upgrade_notice );&nbsp;</div></li><li><div>                      $latest_notice = $upgrade_notice[$latest_version];&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  $installed_style = version_compare( $installed_version, $stable_version, '&lt;' ) ?&nbsp;</div></li><li><div>                      'style=&quot;background-color:#f00;&quot;' : &nbsp;</div></li><li><div>                      'style=&quot;background-color:#0f0;&quot;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              echo '&lt;tr&gt;&lt;td colspan=&quot;2&quot;&gt;&lt;h4&gt;'.$info['short'].' '.&nbsp;</div></li><li><div>                  ( $this-&gt;p-&gt;check-&gt;aop( $ext, true, $this-&gt;p-&gt;is_avail['aop'] ) ?&nbsp;</div></li><li><div>                      _x( 'Pro', 'package type', 'nextgen-facebook' ) :&nbsp;</div></li><li><div>                      _x( 'Free', 'package type', 'nextgen-facebook' ) ).'&lt;/h4&gt;&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>              echo '&lt;tr&gt;&lt;th class=&quot;side&quot;&gt;'._x( 'Installed', &nbsp;</div></li><li><div>                  'plugin status label', 'nextgen-facebook' ).':&lt;/th&gt;&nbsp;</div></li><li><div>                  &lt;td class=&quot;side_version&quot; '.$installed_style.'&gt;'.$installed_version.'&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>              echo '&lt;tr&gt;&lt;th class=&quot;side&quot;&gt;'._x( 'Stable', &nbsp;</div></li><li><div>                  'plugin status label', 'nextgen-facebook' ).':&lt;/th&gt;&nbsp;</div></li><li><div>                  &lt;td class=&quot;side_version&quot;&gt;'.$stable_version.'&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>              echo '&lt;tr&gt;&lt;th class=&quot;side&quot;&gt;'._x( 'Latest', &nbsp;</div></li><li><div>                  'plugin status label', 'nextgen-facebook' ).':&lt;/th&gt;&nbsp;</div></li><li><div>                  &lt;td class=&quot;side_version&quot;&gt;'.$latest_version.'&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>              echo '&lt;tr&gt;&lt;td colspan=&quot;2&quot; id=&quot;latest_notice&quot;&gt;&lt;p&gt;'.$latest_notice.'&lt;/p&gt;'.&nbsp;</div></li><li><div>                  '&lt;p&gt;&lt;a href=&quot;'.$changelog_url.'&quot; target=&quot;_blank&quot;&gt;'.&nbsp;</div></li><li><div>                      sprintf( _x( 'View %s changelog...', 'following plugin status version numbers', &nbsp;</div></li><li><div>                          'nextgen-facebook' ), $info['short'] ).'&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          echo '&lt;/table&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function show_metabox_status_gpl() {&nbsp;</div></li><li><div>          $metabox = 'status';&nbsp;</div></li><li><div>          $plugin_count = 0;&nbsp;</div></li><li><div>          foreach ( $this-&gt;p-&gt;cf['plugin'] as $ext =&gt; $info )&nbsp;</div></li><li><div>              if ( isset( $info['lib']['gpl'] ) )&nbsp;</div></li><li><div>                  $plugin_count++;&nbsp;</div></li><li><div>          echo '&lt;table class=&quot;sucom-setting '.$this-&gt;p-&gt;cf['lca'].' side&quot;&nbsp;</div></li><li><div>              style=&quot;margin-bottom:10px;&quot;&gt;';&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * GPL version features</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          foreach ( $this-&gt;p-&gt;cf['plugin'] as $ext =&gt; $info ) {&nbsp;</div></li><li><div>              if ( ! isset( $info['lib']['gpl'] ) )&nbsp;</div></li><li><div>                  continue;&nbsp;</div></li><li><div>              if ( $ext === $this-&gt;p-&gt;cf['lca'] )    <span class="comment">// features for this plugin</span>&nbsp;</div></li><li><div>                  $features = array(&nbsp;</div></li><li><div>                      'Author JSON-LD' =&gt; array( &nbsp;</div></li><li><div>                          'status' =&gt; $this-&gt;p-&gt;options['schema_author_json'] ?&nbsp;</div></li><li><div>                              'on' : 'rec', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                      'Debug Messages' =&gt; array(&nbsp;</div></li><li><div>                          'classname' =&gt; 'SucomDebug', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                      'Non-Persistant Cache' =&gt; array(&nbsp;</div></li><li><div>                          'status' =&gt; $this-&gt;p-&gt;is_avail['cache']['object'] ?&nbsp;</div></li><li><div>                              'on' : 'rec', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                      'Open Graph / Rich Pin' =&gt; array( &nbsp;</div></li><li><div>                          'status' =&gt; class_exists( $this-&gt;p-&gt;cf['lca'].'opengraph' ) ?&nbsp;</div></li><li><div>                              'on' : 'rec', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                      'Publisher JSON-LD' =&gt; array(&nbsp;</div></li><li><div>                          'status' =&gt; $this-&gt;p-&gt;options['schema_publisher_json'] ?&nbsp;</div></li><li><div>                              'on' : 'rec', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                      'Transient Cache' =&gt; array(&nbsp;</div></li><li><div>                          'status' =&gt; $this-&gt;p-&gt;is_avail['cache']['transient'] ?&nbsp;</div></li><li><div>                              'on' : 'rec', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                      'Twitter Cards' =&gt; array( &nbsp;</div></li><li><div>                          'status' =&gt; class_exists( $this-&gt;p-&gt;cf['lca'].'twittercard' ) ?&nbsp;</div></li><li><div>                              'on' : 'rec', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              else $features = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $features = apply_filters( $ext.'_'.$metabox.'_gpl_features', $features, $ext, $info );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $features ) ) {&nbsp;</div></li><li><div>                  if ( $plugin_count &gt; 1 )&nbsp;</div></li><li><div>                      echo '&lt;tr&gt;&lt;td&gt;&lt;h4&gt;'.$this-&gt;p-&gt;cf['plugin'][$ext]['short'].'&lt;/h4&gt;&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>                  $this-&gt;show_plugin_status( $features );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          echo '&lt;/table&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function show_metabox_status_pro() {&nbsp;</div></li><li><div>          $metabox = 'status';&nbsp;</div></li><li><div>          $plugin_count = 0;&nbsp;</div></li><li><div>          foreach ( $this-&gt;p-&gt;cf['plugin'] as $ext =&gt; $info )&nbsp;</div></li><li><div>              if ( isset( $info['lib']['pro'] ) )&nbsp;</div></li><li><div>                  $plugin_count++;&nbsp;</div></li><li><div>          echo '&lt;table class=&quot;sucom-setting '.$this-&gt;p-&gt;cf['lca'].' side&quot;&nbsp;</div></li><li><div>              style=&quot;margin-bottom:10px;&quot;&gt;';&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Pro version features</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          foreach ( $this-&gt;p-&gt;cf['plugin'] as $ext =&gt; $info ) {&nbsp;</div></li><li><div>              if ( ! isset( $info['lib']['pro'] ) )&nbsp;</div></li><li><div>                  continue;&nbsp;</div></li><li><div>              $features = array();&nbsp;</div></li><li><div>              $short = $this-&gt;p-&gt;cf['plugin'][$ext]['short'];&nbsp;</div></li><li><div>              $short_pro = $short.' Pro';&nbsp;</div></li><li><div>              $aop = $this-&gt;p-&gt;check-&gt;aop( $ext, true, $this-&gt;p-&gt;is_avail['aop'] );&nbsp;</div></li><li><div>              foreach ( $info['lib']['pro'] as $sub =&gt; $libs ) {&nbsp;</div></li><li><div>                  if ( $sub === 'admin' ) &nbsp;</div></li><li><div>                      continue;    <span class="comment">// skip status for admin menus and tabs</span>&nbsp;</div></li><li><div>                  foreach ( $libs as $id =&gt; $name ) {&nbsp;</div></li><li><div>                      $off = $this-&gt;p-&gt;is_avail[$sub][$id] ? 'rec' : 'off';&nbsp;</div></li><li><div>                      $features[$name] = array( &nbsp;</div></li><li><div>                          'status' =&gt; class_exists( $ext.'pro'.$sub.$id ) ?&nbsp;</div></li><li><div>                              ( $aop ? 'on' : $off ) : $off, &nbsp;</div></li><li><div>                          'tooltip' =&gt; sprintf( __( 'If the %1$s plugin is detected, %2$s will load additional '.&nbsp;</div></li><li><div>                              'integration modules to provide enhanced support and features for %3$s.', &nbsp;</div></li><li><div>                                  'nextgen-facebook'), $name, $short_pro, $name ), &nbsp;</div></li><li><div>                          'td_class' =&gt; $aop ? '' : 'blank', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $features = apply_filters( $ext.'_'.$metabox.'_pro_features', $features, $ext, $info );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $features ) ) {&nbsp;</div></li><li><div>                  if ( $plugin_count &gt; 1 )&nbsp;</div></li><li><div>                      echo '&lt;tr&gt;&lt;td&gt;&lt;h4&gt;'.$this-&gt;p-&gt;cf['plugin'][$ext]['short'].'&lt;/h4&gt;&lt;/td&gt;&lt;/tr&gt;';&nbsp;</div></li><li><div>                  $this-&gt;show_plugin_status( $features );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          echo '&lt;/table&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      private function show_plugin_status( $features = array() ) {&nbsp;</div></li><li><div>          $images = array( &nbsp;</div></li><li><div>              'on' =&gt; 'green-circle.png', &nbsp;</div></li><li><div>              'off' =&gt; 'gray-circle.png', &nbsp;</div></li><li><div>              'rec' =&gt; 'red-circle.png', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          uksort( $features, 'strcasecmp' );&nbsp;</div></li><li><div>          $first = key( $features );&nbsp;</div></li><li><div>          foreach ( $features as $name =&gt; $arr ) {&nbsp;</div></li><li><div>              $td_class = empty( $arr['td_class'] ) ?&nbsp;</div></li><li><div>                  '' : ' '.$arr['td_class'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( array_key_exists( 'classname', $arr ) )&nbsp;</div></li><li><div>                  $status = class_exists( $arr['classname'] ) ? 'on' : 'off';&nbsp;</div></li><li><div>              elseif ( array_key_exists( 'status', $arr ) )&nbsp;</div></li><li><div>                  $status = $arr['status'];&nbsp;</div></li><li><div>              else $status = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $status ) ) {&nbsp;</div></li><li><div>                  $tooltip_text = empty( $arr['tooltip'] ) ?&nbsp;</div></li><li><div>                      '' : $arr['tooltip'];&nbsp;</div></li><li><div>                  $tooltip_text = $this-&gt;p-&gt;msgs-&gt;get( 'tooltip-side-'.$name, &nbsp;</div></li><li><div>                      array( 'text' =&gt; $tooltip_text, 'class' =&gt; 'sucom_tooltip_side' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  echo '&lt;tr&gt;&lt;td class=&quot;side'.$td_class.'&quot;&gt;'.&nbsp;</div></li><li><div>                  $tooltip_text.( $status == 'rec' ? '&lt;strong&gt;'.$name.'&lt;/strong&gt;' : $name ).&nbsp;</div></li><li><div>                  '&lt;/td&gt;&lt;td style=&quot;min-width:0;text-align:center;&quot; class=&quot;'.$td_class.'&quot;&gt;&nbsp;</div></li><li><div>                  &lt;img src=&quot;'.NGFB_URLPATH.'images/'.$images[$status].&nbsp;</div></li><li><div>                      '&quot; width=&quot;12&quot; height=&quot;12&quot; /&gt;&lt;/td&gt;&lt;/tr&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function show_metabox_purchase() {&nbsp;</div></li><li><div>          $purchase_url = $this-&gt;p-&gt;cf['plugin'][$this-&gt;p-&gt;cf['lca']]['url']['purchase'];&nbsp;</div></li><li><div>          echo '&lt;table class=&quot;sucom-setting '.$this-&gt;p-&gt;cf['lca'].'&quot; side&gt;&lt;tr&gt;&lt;td&gt;';&nbsp;</div></li><li><div>          echo $this-&gt;p-&gt;msgs-&gt;get( 'side-purchase' );&nbsp;</div></li><li><div>          echo '&lt;p class=&quot;centered&quot;&gt;';&nbsp;</div></li><li><div>          echo $this-&gt;form-&gt;get_button( ( $this-&gt;p-&gt;is_avail['aop'] ? &nbsp;</div></li><li><div>              _x( 'Purchase Pro License(s)', 'submit button', 'nextgen-facebook' ) :&nbsp;</div></li><li><div>              _x( 'Purchase Pro Version', 'submit button', 'nextgen-facebook' ) ), &nbsp;</div></li><li><div>                  'button-primary', null, $purchase_url, true );&nbsp;</div></li><li><div>          echo '&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function show_metabox_help() {&nbsp;</div></li><li><div>          echo '&lt;table class=&quot;sucom-setting '.$this-&gt;p-&gt;cf['lca'].'&quot; side&gt;&lt;tr&gt;&lt;td&gt;';&nbsp;</div></li><li><div>          <span class="comment">//echo $this-&gt;p-&gt;msgs-&gt;get( 'side-help' );</span>&nbsp;</div></li><li><div>          $this-&gt;show_follow_icons();&nbsp;</div></li><li><div>          foreach ( $this-&gt;p-&gt;cf['plugin'] as $ext =&gt; $info ) {&nbsp;</div></li><li><div>              if ( empty( $info['version'] ) )    <span class="comment">// filter out extensions that are not installed</span>&nbsp;</div></li><li><div>                  continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $help_links = '';&nbsp;</div></li><li><div>              $aop = $this-&gt;p-&gt;check-&gt;aop( $ext, true, $this-&gt;p-&gt;is_avail['aop'] );&nbsp;</div></li><li><div>              if ( ! empty( $info['url']['faq'] ) ) {&nbsp;</div></li><li><div>                  $help_links .= '&lt;li&gt;'.sprintf( __( 'Review the &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;Frequently Asked Questions&lt;/a&gt;', &nbsp;</div></li><li><div>                      'nextgen-facebook' ), $info['url']['faq'] );&nbsp;</div></li><li><div>                  if ( ! empty( $info['url']['notes'] ) )&nbsp;</div></li><li><div>                      $help_links .= ' '.sprintf( __( 'and &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;Other Notes&lt;/a&gt;', &nbsp;</div></li><li><div>                          'nextgen-facebook' ), $info['url']['notes'] );&nbsp;</div></li><li><div>                  $help_links .= '&lt;/li&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( ! empty( $info['url']['pro_support'] ) && $aop )&nbsp;</div></li><li><div>                  $help_links .= '&lt;li&gt;'.sprintf( __( 'Open a &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;Support Ticket&lt;/a&gt;', &nbsp;</div></li><li><div>                      'nextgen-facebook' ), $info['url']['pro_support'] ).'&lt;/li&gt;';&nbsp;</div></li><li><div>              elseif ( ! empty( $info['url']['wp_support'] ) )&nbsp;</div></li><li><div>                  $help_links .= '&lt;li&gt;'.sprintf( __( 'Post in &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;Support Forum&lt;/a&gt;', &nbsp;</div></li><li><div>                      'nextgen-facebook' ), $info['url']['wp_support'] ).'&lt;/li&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $help_links ) ) {&nbsp;</div></li><li><div>                  echo '&lt;p&gt;&lt;strong&gt;'.sprintf( _x( '%s Support', &nbsp;</div></li><li><div>                      'metabox title (side)', 'nextgen-facebook' ), $info['short'].self::$is_suffix ).'&lt;/strong&gt;&lt;/p&gt;';&nbsp;</div></li><li><div>                  echo '&lt;ul&gt;'.$help_links.'&lt;/ul&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          echo '&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function show_follow_icons() {&nbsp;</div></li><li><div>          echo '&lt;div class=&quot;follow_icons&quot;&gt;';&nbsp;</div></li><li><div>          $img_size = $this-&gt;p-&gt;cf['follow']['size'];&nbsp;</div></li><li><div>          foreach ( $this-&gt;p-&gt;cf['follow']['src'] as $img_rel =&gt; $url )&nbsp;</div></li><li><div>              echo '&lt;a href=&quot;'.$url.'&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;'.NGFB_URLPATH.$img_rel.'&quot; &nbsp;</div></li><li><div>                  width=&quot;'.$img_size.'&quot; height=&quot;'.$img_size.'&quot; border=&quot;0&quot; /&gt;&lt;/a&gt; ';&nbsp;</div></li><li><div>          echo '&lt;/div&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public static function get_nonce() {&nbsp;</div></li><li><div>          return ( defined( 'NONCE_KEY' ) ? NONCE_KEY : '' ).plugin_basename( __FILE__ );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      private function is_profile( $menu_id = false ) {&nbsp;</div></li><li><div>          return $this-&gt;is_lib( 'profile', $menu_id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      private function is_setting( $menu_id = false ) {&nbsp;</div></li><li><div>          return $this-&gt;is_lib( 'setting', $menu_id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      private function is_submenu( $menu_id = false ) {&nbsp;</div></li><li><div>          return $this-&gt;is_lib( 'submenu', $menu_id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      private function is_sitesubmenu( $menu_id = false ) {&nbsp;</div></li><li><div>          return $this-&gt;is_lib( 'sitesubmenu', $menu_id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      private function is_lib( $lib_name, $menu_id = false ) {&nbsp;</div></li><li><div>          if ( $menu_id === false )&nbsp;</div></li><li><div>              $menu_id = $this-&gt;menu_id;&nbsp;</div></li><li><div>          return isset( $this-&gt;p-&gt;cf['*']['lib'][$lib_name][$menu_id] ) ? true : false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function licenses_metabox_content( $network = false ) {&nbsp;</div></li><li><div>          echo '&lt;table class=&quot;sucom-setting '.$this-&gt;p-&gt;cf['lca'].' licenses-metabox&quot;&nbsp;</div></li><li><div>              style=&quot;padding-bottom:10px&quot;&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>          echo '&lt;tr&gt;&lt;td colspan=&quot;'.( $network ? 5 : 4 ).'&quot;&gt;'.&nbsp;</div></li><li><div>              $this-&gt;p-&gt;msgs-&gt;get( 'info-plugin-tid'.&nbsp;</div></li><li><div>                  ( $network ? '-network' : '' ) ).'&lt;/td&gt;&lt;/tr&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $num = 0;&nbsp;</div></li><li><div>          $total = count( $this-&gt;p-&gt;cf['plugin'] );&nbsp;</div></li><li><div>          foreach ( $this-&gt;p-&gt;cf['plugin'] as $ext =&gt; $info ) {&nbsp;</div></li><li><div>              $num++;&nbsp;</div></li><li><div>              $links = '';&nbsp;</div></li><li><div>              $img_href = '';&nbsp;</div></li><li><div>              $view_text = _x( 'View Plugin Details', 'plugin action link', 'nextgen-facebook' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $info['slug'] ) && &nbsp;</div></li><li><div>                  ( empty( $info['url']['latest_zip'] ) ||&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;is_avail['util']['um'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $img_href = add_query_arg( array(&nbsp;</div></li><li><div>                      'tab' =&gt; 'plugin-information', &nbsp;</div></li><li><div>                      'plugin' =&gt; $info['slug'], &nbsp;</div></li><li><div>                      'TB_iframe' =&gt; 'true', &nbsp;</div></li><li><div>                      'width' =&gt; 600, &nbsp;</div></li><li><div>                      'height' =&gt; 550&nbsp;</div></li><li><div> ), get_admin_url( null, 'plugin-install.php' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// check to see if plugin is installed or not</span>&nbsp;</div></li><li><div>                  if ( is_dir( WP_PLUGIN_DIR.'/'.$info['slug'] ) ) {&nbsp;</div></li><li><div>                      $update_plugins = get_site_transient('update_plugins');&nbsp;</div></li><li><div>                      if ( isset( $update_plugins-&gt;response ) ) {&nbsp;</div></li><li><div>                          foreach ( (array) $update_plugins-&gt;response as $file =&gt; $plugin ) {&nbsp;</div></li><li><div>                              if ( $plugin-&gt;slug === $info['slug'] ) {&nbsp;</div></li><li><div>                                  $view_text = '&lt;font color=&quot;red&quot;&gt;'._x( 'View Plugin Details + Update', &nbsp;</div></li><li><div>                                      'plugin action link', 'nextgen-facebook' ).'&lt;/font&gt;';&nbsp;</div></li><li><div>                                  break;&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  } else $view_text = _x( 'View Plugin Details + Install', 'plugin action link', 'nextgen-facebook' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $links .= ' | &lt;a href=&quot;'.$img_href.'&quot; class=&quot;thickbox&quot;&gt;'.$view_text.'&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } elseif ( ! empty( $info['url']['download'] ) ) {&nbsp;</div></li><li><div>                  $img_href = $info['url']['download'];&nbsp;</div></li><li><div>                  $links .= ' | &lt;a href=&quot;'.$img_href.'&quot; target=&quot;_blank&quot;&gt;'._x( 'Plugin Description Page', &nbsp;</div></li><li><div>                      'plugin action link', 'nextgen-facebook' ).'&lt;/a&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $info['url']['latest_zip'] ) )&nbsp;</div></li><li><div>                  $links .= ' | &lt;a href=&quot;'.$info['url']['latest_zip'].'&quot;&gt;'._x( 'Download Latest Version', &nbsp;</div></li><li><div>                      'plugin action link', 'nextgen-facebook' ).'&lt;/a&gt; (ZIP)';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $info['url']['purchase'] ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;cf['lca'] === $ext || &nbsp;</div></li><li><div>                      $this-&gt;p-&gt;check-&gt;aop( $this-&gt;p-&gt;cf['lca'], false, $this-&gt;p-&gt;is_avail['aop'] ) )&nbsp;</div></li><li><div>                          $links .= ' | &lt;a href=&quot;'.$info['url']['purchase'].'&quot; target=&quot;_blank&quot;&gt;'.&nbsp;</div></li><li><div>                              _x( 'Purchase Pro License(s)', 'plugin action link', 'nextgen-facebook' ).'&lt;/a&gt;';&nbsp;</div></li><li><div>                  else $links .= ' | &lt;em&gt;'._x( 'Purchase Pro License(s)', 'plugin action link', 'nextgen-facebook' ).'&lt;/em&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $info['img']['icon_small'] ) )&nbsp;</div></li><li><div>                  $img_src = 'src=&quot;'.$info['img']['icon_small'].'&quot;';&nbsp;</div></li><li><div>              else $img_src = 'src=&quot;data:image/gif;base64, R0lGODlhAQABAIAAAP<span class="comment">///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==&quot;';</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $info['img']['icon_medium'] ) )&nbsp;</div></li><li><div>                  $img_src .= ' srcset=&quot;'.$info['img']['icon_medium'].' 256w&quot;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// logo image</span>&nbsp;</div></li><li><div>              echo '&lt;tr&gt;&lt;td style=&quot;width:148px; padding:10px;&quot; rowspan=&quot;3&quot; valign=&quot;top&quot; align=&quot;left&quot;&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              if ( ! empty( $img_href ) ) &nbsp;</div></li><li><div>                  echo '&lt;a href=&quot;'.$img_href.'&quot;'.( strpos( $img_href, 'TB_iframe' ) ?&nbsp;</div></li><li><div>                      ' class=&quot;thickbox&quot;' : ' target=&quot;_blank&quot;' ).'&gt;';&nbsp;</div></li><li><div>              echo '&lt;img '.$img_src.' width=&quot;128&quot; height=&quot;128&quot;&gt;';&nbsp;</div></li><li><div>              if ( ! empty( $img_href ) ) &nbsp;</div></li><li><div>                  echo '&lt;/a&gt;';&nbsp;</div></li><li><div>              echo '&lt;/td&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// plugin name</span>&nbsp;</div></li><li><div>              echo '&lt;td colspan=&quot;'.( $network ? 4 : 3 ).'&quot; style=&quot;padding:10px 0 0 0;&quot;&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&lt;strong&gt;'.$info['name'].'&lt;/strong&gt;&lt;/p&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $info['desc'] ) )&nbsp;</div></li><li><div>                  echo '&lt;p&gt;'._x( $info['desc'], 'plugin description', 'nextgen-facebook' ).'&lt;/p&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $links ) )&nbsp;</div></li><li><div>                  echo '&lt;p&gt;'.trim( $links, ' |' ).'&lt;/p&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              echo '&lt;/td&gt;&lt;/tr&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $network ) {&nbsp;</div></li><li><div>                  if ( ! empty( $info['update_auth'] ) || &nbsp;</div></li><li><div>                      ! empty( $this-&gt;p-&gt;options['plugin_'.$ext.'_tid'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $this-&gt;p-&gt;cf['lca'] === $ext || &nbsp;</div></li><li><div>                          $this-&gt;p-&gt;check-&gt;aop( $this-&gt;p-&gt;cf['lca'], &nbsp;</div></li><li><div>                              true, $this-&gt;p-&gt;is_avail['aop'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          echo '&lt;tr&gt;'.$this-&gt;p-&gt;util-&gt;get_th( _x( 'Pro Authentication ID', &nbsp;</div></li><li><div>                              'option label', 'nextgen-facebook' ), 'medium nowrap' ).&nbsp;</div></li><li><div>                          '&lt;td class=&quot;tid&quot;&gt;'.$this-&gt;form-&gt;get_input( 'plugin_'.$ext.'_tid', 'tid mono' ).'&lt;/td&gt;'.&nbsp;</div></li><li><div>                          $this-&gt;p-&gt;admin-&gt;get_site_use( $this-&gt;form, true, 'plugin_'.$ext.'_tid' );&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          echo '&lt;tr&gt;'.$this-&gt;p-&gt;util-&gt;get_th( _x( 'Pro Authentication ID', &nbsp;</div></li><li><div>                              'option label', 'nextgen-facebook' ), 'medium nowrap' ).&nbsp;</div></li><li><div>                          '&lt;td class=&quot;blank&quot;&gt;'.( empty( $this-&gt;p-&gt;options['plugin_'.$ext.'_tid'] ) ?&nbsp;</div></li><li><div>                              $this-&gt;form-&gt;get_no_input( 'plugin_'.$ext.'_tid', 'tid mono' ) :&nbsp;</div></li><li><div>                              $this-&gt;form-&gt;get_input( 'plugin_'.$ext.'_tid', 'tid mono' ) ).&nbsp;</div></li><li><div>                          '&lt;/td&gt;&lt;td colspan=&quot;2&quot;&gt;'.( $this-&gt;p-&gt;check-&gt;aop( $this-&gt;p-&gt;cf['lca'], &nbsp;</div></li><li><div>                              true, $this-&gt;p-&gt;is_avail['aop'] ) ?&nbsp;</div></li><li><div>                                  '' : $this-&gt;p-&gt;msgs-&gt;get( 'pro-option-msg' ) ).'&lt;/td&gt;&lt;/tr&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  } else echo '&lt;tr&gt;&lt;td&gt;&nbsp;&lt;/td&gt;&lt;td&gt;&nbsp;&lt;/td&gt;&lt;td&gt;&nbsp;&lt;/td&gt;&lt;td&gt;&nbsp;&lt;/td&gt;&lt;/tr&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  if ( ! empty( $info['update_auth'] ) || &nbsp;</div></li><li><div>                      ! empty( $this-&gt;p-&gt;options['plugin_'.$ext.'_tid'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $this-&gt;p-&gt;cf['lca'] === $ext || &nbsp;</div></li><li><div>                          $this-&gt;p-&gt;check-&gt;aop( $this-&gt;p-&gt;cf['lca'], &nbsp;</div></li><li><div>                              true, $this-&gt;p-&gt;is_avail['aop'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $qty_used = class_exists( 'SucomUpdate' ) ?&nbsp;</div></li><li><div>                              SucomUpdate::get_option( $ext, 'qty_used' ) : false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          echo '&lt;tr&gt;'.$this-&gt;p-&gt;util-&gt;get_th( _x( 'Pro Authentication ID', &nbsp;</div></li><li><div>                              'option label', 'nextgen-facebook' ), 'medium nowrap' ).&nbsp;</div></li><li><div>                          '&lt;td class=&quot;tid&quot;&gt;'.$this-&gt;form-&gt;get_input( 'plugin_'.$ext.'_tid', 'tid mono' ).&nbsp;</div></li><li><div>                          '&lt;/td&gt;&lt;td&gt;&lt;p&gt;'.( empty( $qty_used ) ? &nbsp;</div></li><li><div>                              '' : $qty_used.' Licenses Assigned' ).'&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>                          echo '&lt;tr&gt;'.$this-&gt;p-&gt;util-&gt;get_th( _x( 'Pro Authentication ID', &nbsp;</div></li><li><div>                              'option label', 'nextgen-facebook' ), 'medium nowrap' ).&nbsp;</div></li><li><div>                          '&lt;td class=&quot;blank&quot;&gt;'.( empty( $this-&gt;p-&gt;options['plugin_'.$ext.'_tid'] ) ?&nbsp;</div></li><li><div>                              $this-&gt;form-&gt;get_no_input( 'plugin_'.$ext.'_tid', 'tid mono' ) :&nbsp;</div></li><li><div>                              $this-&gt;form-&gt;get_input( 'plugin_'.$ext.'_tid', 'tid mono' ) ).&nbsp;</div></li><li><div>                          '&lt;/td&gt;&lt;td&gt;'.( $this-&gt;p-&gt;check-&gt;aop( $this-&gt;p-&gt;cf['lca'], &nbsp;</div></li><li><div>                              true, $this-&gt;p-&gt;is_avail['aop'] ) ? &nbsp;</div></li><li><div>                                  '' : $this-&gt;p-&gt;msgs-&gt;get( 'pro-option-msg' ) ).'&lt;/td&gt;&lt;/tr&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  } else echo '&lt;tr&gt;&lt;td&gt;&nbsp;&lt;/td&gt;&lt;td&gt;&nbsp;&lt;/td&gt;&lt;td&gt;&nbsp;&lt;/tr&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              echo '&lt;tr&gt;&lt;td'.( $num &lt; $total ? ' style=&quot;border-bottom:1px dotted #ddd;&quot;' : '' ).&nbsp;</div></li><li><div>                  ' colspan=&quot;'.( $network ? 4 : 3 ).'&quot;&gt;&nbsp;&lt;/td&gt;&lt;/tr&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          echo '&lt;/table&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function conflict_warnings() {&nbsp;</div></li><li><div>          if ( ! is_admin() )     <span class="comment"><span class="comment">// just in case</span></span>&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $base = $this-&gt;p-&gt;cf['plugin'][$lca]['base'];&nbsp;</div></li><li><div>          $short = $this-&gt;p-&gt;cf['plugin'][$lca]['short'];&nbsp;</div></li><li><div>          $short_pro = $short.' Pro';&nbsp;</div></li><li><div>          $purchase_url = $this-&gt;p-&gt;cf['plugin'][$lca]['url']['purchase'];&nbsp;</div></li><li><div>          $err_pre =  __( 'Plugin conflict detected', 'nextgen-facebook' ) . ' - ';&nbsp;</div></li><li><div>          $log_pre = 'plugin conflict detected - ';    <span class="comment">// don't translate the debug </span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// PHP</span>&nbsp;</div></li><li><div>          if ( empty( $this-&gt;p-&gt;is_avail['curl'] ) ) {&nbsp;</div></li><li><div>              if ( ! empty( $this-&gt;p-&gt;options['plugin_shortener'] ) && &nbsp;</div></li><li><div>                  $this-&gt;p-&gt;options['plugin_shortener'] !== 'none' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'url shortening is enabled but curl function is missing' );&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( sprintf( __( 'URL shortening has been enabled, but PHP\'s &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;Client URL Library&lt;/a&gt; (cURL) is missing.', 'nextgen-facebook' ), 'http:<span class="comment">//ca3.php.net/curl' ).' '.__( 'Please contact your hosting provider to have the missing cURL library files installed.', 'nextgen-facebook' ) );</span>&nbsp;</div></li><li><div>              } elseif ( ! empty( $this-&gt;p-&gt;options['plugin_file_cache_exp'] ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'file caching is enabled but curl function is missing' );&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( sprintf( __( 'The file caching feature has been enabled but PHP\'s &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;Client URL Library&lt;/a&gt; (cURL) is missing.', 'nextgen-facebook' ), 'http:<span class="comment">//ca3.php.net/curl' ).' '.__( 'Please contact your hosting provider to have the missing library installed.', 'nextgen-facebook' ) );</span>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          if ( empty( $this-&gt;p-&gt;is_avail['mbstring'] ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'php mbstring extension is missing' );&nbsp;</div></li><li><div>              $this-&gt;p-&gt;notice-&gt;err( sprintf( __( 'PHP\'s &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;Multibyte String&lt;/a&gt; extension is missing.', 'nextgen-facebook' ), 'http:<span class="comment">//php.net/manual/en/book.mbstring.php' ).' '.__( 'Please contact your hosting provider to have the missing extension installed.', 'nextgen-facebook' ) );</span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Yoast SEO</span>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;is_avail['seo']['wpseo'] ) {&nbsp;</div></li><li><div>              $opts = get_option( 'wpseo_social' );&nbsp;</div></li><li><div>              if ( ! empty( $opts['opengraph'] ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( $log_pre.'wpseo opengraph meta data option is enabled' );&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( $err_pre.sprintf( __( 'Please uncheck the \'&lt;em&gt;Add Open Graph meta data&lt;/em&gt;\' option under the &lt;a href=&quot;%s&quot;&gt;Yoast SEO / Social / Facebook&lt;/a&gt; settings tab.', 'nextgen-facebook' ), get_admin_url( null, 'admin.php?page=wpseo_social#top#facebook' ) ) );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( ! empty( $opts['twitter'] ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( $log_pre.'wpseo twitter meta data option is enabled' );&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( $err_pre.sprintf( __( 'Please uncheck the \'&lt;em&gt;Add Twitter card meta data&lt;/em&gt;\' option under the &lt;a href=&quot;%s&quot;&gt;Yoast SEO / Social / Twitter&lt;/a&gt; settings tab.', 'nextgen-facebook' ), get_admin_url( null, 'admin.php?page=wpseo_social#top#twitterbox' ) ) );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( ! empty( $opts['googleplus'] ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( $log_pre.'wpseo googleplus meta data option is enabled' );&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( $err_pre.sprintf( __( 'Please uncheck the \'&lt;em&gt;Add Google+ specific post meta data&lt;/em&gt;\' option under the &lt;a href=&quot;%s&quot;&gt;Yoast SEO / Social / Google+&lt;/a&gt; settings tab.', 'nextgen-facebook' ), get_admin_url( null, 'admin.php?page=wpseo_social#top#google' ) ) );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( ! empty( $opts['plus-publisher'] ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( $log_pre.'wpseo google plus publisher option is defined' );&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( $err_pre.sprintf( __( 'Please remove the \'&lt;em&gt;Google Publisher Page&lt;/em&gt;\' value entered under the &lt;a href=&quot;%s&quot;&gt;Yoast SEO / Social / Google+&lt;/a&gt; settings tab.', 'nextgen-facebook' ), get_admin_url( null, 'admin.php?page=wpseo_social#top#google' ) ) );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// SEO Ultimate</span>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;is_avail['seo']['seou'] === true ) {&nbsp;</div></li><li><div>              $opts = get_option( 'seo_ultimate' );&nbsp;</div></li><li><div>              if ( ! empty( $opts['modules'] ) && is_array( $opts['modules'] ) ) {&nbsp;</div></li><li><div>                  if ( array_key_exists( 'opengraph', $opts['modules'] ) && $opts['modules']['opengraph'] !== -10 ) {&nbsp;</div></li><li><div>                      if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                          $this-&gt;p-&gt;debug-&gt;log( $log_pre.'seo ultimate opengraph module is enabled' );&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;notice-&gt;err( $err_pre.sprintf( __( 'Please disable the \'&lt;em&gt;Open Graph Integrator&lt;/em&gt;\' module in the &lt;a href=&quot;%s&quot;&gt;SEO Ultimate Module Manager&lt;/a&gt;.', 'nextgen-facebook' ), get_admin_url( null, 'admin.php?page=seo' ) ) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// All in One SEO Pack</span>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;is_avail['seo']['aioseop'] === true ) {&nbsp;</div></li><li><div>              $opts = get_option( 'aioseop_options' );&nbsp;</div></li><li><div>              if ( ! empty( $opts['modules']['aiosp_feature_manager_options']['aiosp_feature_manager_enable_opengraph'] ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( $log_pre.'aioseop social meta fetaure is enabled' );&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( $err_pre.sprintf( __( 'Please deactivate the \'&lt;em&gt;Social Meta&lt;/em&gt;\' feature in the &lt;a href=&quot;%s&quot;&gt;All in One SEO Pack Feature Manager&lt;/a&gt;.', 'nextgen-facebook' ), get_admin_url( null, 'admin.php?page=all-in-one-seo-pack/aioseop_feature_manager.php' ) ) );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( array_key_exists( 'aiosp_google_disable_profile', $opts ) && empty( $opts['aiosp_google_disable_profile'] ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( $log_pre.'aioseop google plus profile is enabled' );&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( $err_pre.sprintf( __( 'Please check the \'&lt;em&gt;Disable Google Plus Profile&lt;/em&gt;\' option in the &lt;a href=&quot;%s&quot;&gt;All in One SEO Pack Plugin Options&lt;/a&gt;.', 'nextgen-facebook' ), get_admin_url( null, 'admin.php?page=all-in-one-seo-pack/aioseop_class.php' ) ) );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// JetPack Photon</span>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;is_avail['media']['photon'] === true && &nbsp;</div></li><li><div>              ! $this-&gt;p-&gt;check-&gt;aop( $this-&gt;p-&gt;cf['lca'], true, $this-&gt;p-&gt;is_avail['aop'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( $log_pre.'jetpack photon is enabled' );&nbsp;</div></li><li><div>              $this-&gt;p-&gt;notice-&gt;err( $err_pre.'&lt;strong&gt;'.__( 'JetPack\'s Photon module purposefully cripples the WordPress image size functions.', 'nextgen-facebook' ).'&lt;/strong&gt; '.sprintf( __( 'Please &lt;a href=&quot;%s&quot;&gt;deactivate the JetPack Photon module&lt;/a&gt; or deactivate the %s Free plugin.', 'nextgen-facebook' ), get_admin_url( null, 'admin.php?page=jetpack' ), $short ).' '.sprintf( __( 'You may also upgrade to the &lt;a href=&quot;%1$s&quot;&gt;%2$s version&lt;/a&gt; which includes an &lt;a href=&quot;%3$s&quot;&gt;integration module for JetPack Photon&lt;/a&gt; to re-enable image size functions specifically for %4$s images.', 'nextgen-facebook' ), $purchase_url, $short_pro, 'http:<span class="comment">//surniaulula.com/codex/plugins/nextgen-facebook/notes/modules/jetpack-photon/', $short ) );</span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function check_tmpl_head_elements() {&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// only check if using the default filter name</span>&nbsp;</div></li><li><div>          if ( empty( $this-&gt;p-&gt;options['plugin_head_attr_filter_name'] ) ||&nbsp;</div></li><li><div>              $this-&gt;p-&gt;options['plugin_head_attr_filter_name'] !== 'head_attributes' )&nbsp;</div></li><li><div>                  return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $headers = glob( get_stylesheet_directory().'/header*.php' );&nbsp;</div></li><li><div>          foreach ( $headers as $file ) {&nbsp;</div></li><li><div>              if ( ( $html = SucomUtil::get_stripped_php( $file ) ) === false )&nbsp;</div></li><li><div>                  continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( strpos( $html, '&lt;head&gt;' ) !== false ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( $this-&gt;p-&gt;msgs-&gt;get( 'notice-header-tmpl-no-head-attr' ), &nbsp;</div></li><li><div>                      true, true, 'notice-header-tmpl-no-head-attr', false );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function modify_tmpl_head_elements() {&nbsp;</div></li><li><div>          $headers = glob( get_stylesheet_directory().'/header*.php' );&nbsp;</div></li><li><div>          foreach ( $headers as $file ) {&nbsp;</div></li><li><div>              $base = basename( $file );&nbsp;</div></li><li><div>              $backup = $file.'~backup-'.date( 'Ymd-His' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// double check in case of reloads etc.</span>&nbsp;</div></li><li><div>              if ( ( $html = SucomUtil::get_stripped_php( $file ) ) === false ||&nbsp;</div></li><li><div>                  strpos( $html, '&lt;head&gt;' ) === false ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( sprintf( __( '&lt;head&gt; element not found in %s.', &nbsp;</div></li><li><div>                      'nextgen-facebook' ), $file ), true );&nbsp;</div></li><li><div>                  continue;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// make a backup of the original</span>&nbsp;</div></li><li><div>              if ( ! copy( $file, $backup ) ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( sprintf( __( 'Error copying %1$s to %2$s.', &nbsp;</div></li><li><div>                      'nextgen-facebook' ), 'header.php', $backup ), true );&nbsp;</div></li><li><div>                  continue;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $php = file_get_contents( $file );&nbsp;</div></li><li><div>              $php = str_replace( '&lt;head&gt;', '&lt;head &lt;?php do_action( \'add_head_attributes\' ); ?&gt;&gt;', $php );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! $fh = @fopen( $file, 'wb' ) ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( sprintf( __( 'Failed to open file %s for writing.', &nbsp;</div></li><li><div>                      'nextgen-facebook' ), $file ), true );&nbsp;</div></li><li><div>                  continue;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>              if ( fwrite( $fh, $php ) ) {&nbsp;</div></li><li><div>                  fclose( $fh );&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;inf( sprintf( __( 'The %1$s template has been successfully updated and saved. A backup copy of the original template is available in %2$s.', 'nextgen-facebook' ), $base, $backup ), true );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $this-&gt;p-&gt;notice-&gt;trunc_id( 'notice-header-tmpl-no-head-attr' );    <span class="comment"><span class="comment">// just in case</span></span>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// dismiss an incorrect yoast seo conflict notification</span>&nbsp;</div></li><li><div>      public function dismiss_wpseo_notice( $dismissed, $opt_name, $user_obj ) {&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $base = $this-&gt;p-&gt;cf['plugin'][$lca]['base'];&nbsp;</div></li><li><div>          if ( ! is_array( $dismissed['open_graph'] ) ||&nbsp;</div></li><li><div>              ! in_array( $base, $dismissed['open_graph'] ) )&nbsp;</div></li><li><div>                  $dismissed['open_graph'][] = $base;&nbsp;</div></li><li><div>          return $dismissed;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function get_site_use( &$form, $network = false, $name ) {&nbsp;</div></li><li><div>          if ( $network !== true )&nbsp;</div></li><li><div>              return '';&nbsp;</div></li><li><div>          return $this-&gt;p-&gt;util-&gt;get_th( _x( 'Site Use', &nbsp;</div></li><li><div>              'option label (very short)', 'nextgen-facebook' ), 'site_use' ).&nbsp;</div></li><li><div>          ( $this-&gt;p-&gt;check-&gt;aop( $this-&gt;p-&gt;cf['lca'], true, $this-&gt;p-&gt;is_avail['aop'] ) ?&nbsp;</div></li><li><div>              '&lt;td&gt;'.$form-&gt;get_select( $name.':use', $this-&gt;p-&gt;cf['form']['site_option_use'], 'site_use' ).'&lt;/td&gt;' :&nbsp;</div></li><li><div>              '&lt;td class=&quot;site_use blank&quot;&gt;'.$form-&gt;get_select( $name.':use', &nbsp;</div></li><li><div>                  $this-&gt;p-&gt;cf['form']['site_option_use'], 'site_use', null, true, true ).'&lt;/td&gt;' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>NextGEN Facebook (NGFB)</li><li><span></span>8.43.0</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2021 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>