<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="8.43.0" data-slug="nextgen-facebook-ngfb" data-type="file" data-id="7654"><head xmlns="http://www.w3.org/1999/xhtml"><title> lib-post | file | Nextgen Facebook Ngfb | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, nextgen-facebook-ngfb, 8.43.0" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.24"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=a572f1a63b6bb53d1fcb049c2810a0b9' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.24' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/lib-post/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Flib-post%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Flib-post%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-nextgen-facebook-ngfb-8.43.0-file-lib-post","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="lib-post" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to nextgen-facebook-ngfb." href="http://hookr.io/plugins/nextgen-facebook-ngfb/" class="plugin"><span property="name">nextgen-facebook-ngfb</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 8.43.0." href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/" class="H_VERSION"><span property="name">8.43.0</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">lib-post</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="406"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/all/" title="All">All <span class="count badge">406</span></a></li><li class="" data-id="new" data-count="86"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/new/" title="New">New <span class="count badge">86</span></a></li><li class="" data-id="hooks" data-count="283"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/hooks/" title="Hooks">Hooks <span class="count badge">283</span></a></li><li class="" data-id="action" data-count="12"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/actions/" title="Actions">Actions <span class="count badge">12</span></a></li><li class="" data-id="filter" data-count="271"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/filters/" title="Filters">Filters <span class="count badge">271</span></a></li><li class="" data-id="class" data-count="95"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/classes/" title="Classes">Classes <span class="count badge">95</span></a></li><li class="" data-id="constant" data-count="14"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/constants/" title="Constants">Constants <span class="count badge">14</span></a></li><li class="" data-id="function" data-count="13"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/functions/" title="Functions">Functions <span class="count badge">13</span></a></li><li class="" data-id="shortcode" data-count="1"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">1</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/lib/post.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * License: GPLv3</span>&nbsp;</div></li><li><div><span class="comment"> * License URI: https://www.gnu.org/licenses/gpl.txt</span>&nbsp;</div></li><li><div><span class="comment"> * Copyright 2012-2017 Jean-Sebastien Morisset (https://surniaulula.com/)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( ! defined( 'ABSPATH' ) ) {&nbsp;</div></li><li><div>  die( 'These aren\'t the droids you\'re looking for...' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( ! class_exists( 'NgfbPost' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * This class is extended by gpl/util/post.php or pro/util/post.php</span>&nbsp;</div></li><li><div><span class="comment">   * and the class object is created as $this-&gt;p-&gt;m['util']['post'].</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  class NgfbPost extends NgfbMeta {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function __construct() {&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function add_actions() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( is_admin() ) {&nbsp;</div></li><li><div>              if ( ! empty( $_GET ) || basename( $_SERVER['PHP_SELF'] ) === 'post-new.php' ) {&nbsp;</div></li><li><div>                  <span class="comment">// load_meta_page() priorities: 100 post, 200 user, 300 term</span>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// sets the NgfbMeta::$head_meta_tags and NgfbMeta::$head_meta_info class properties</span></span>&nbsp;</div></li><li><div>                  add_action( 'current_screen', array( &$this, 'load_meta_page' ), 100, 1 );&nbsp;</div></li><li><div>                  add_action( 'add_meta_boxes', array( &$this, 'add_metaboxes' ) );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              add_action( 'save_post', array( &$this, 'save_options' ), NGFB_META_SAVE_PRIORITY );&nbsp;</div></li><li><div>              add_action( 'save_post', array( &$this, 'clear_cache' ), NGFB_META_CACHE_PRIORITY );&nbsp;</div></li><li><div>              add_action( 'edit_attachment', array( &$this, 'save_options' ), NGFB_META_SAVE_PRIORITY );&nbsp;</div></li><li><div>              add_action( 'edit_attachment', array( &$this, 'clear_cache' ), NGFB_META_CACHE_PRIORITY );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// add the columns when doing AJAX as well to allow Quick Edit to add the required columns</span>&nbsp;</div></li><li><div>          if ( is_admin() || SucomUtil::get_const( 'DOING_AJAX' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// only use public post types (to avoid menu items, product variations, etc.)</span>&nbsp;</div></li><li><div>              $post_type_names = $this-&gt;p-&gt;util-&gt;get_post_types( 'names' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( is_array( $post_type_names ) ) {&nbsp;</div></li><li><div>                  foreach ( $post_type_names as $post_type ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                          $this-&gt;p-&gt;debug-&gt;log( 'adding column filters for post type '.$post_type );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">// https://codex.wordpress.org/Plugin_API/Filter_Reference/manage_$post_type_posts_columns</span>&nbsp;</div></li><li><div>                      add_filter( 'manage_'.$post_type.'_posts_columns', &nbsp;</div></li><li><div>                          array( &$this, 'add_post_column_headings' ), NGFB_ADD_COLUMN_PRIORITY, 1 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      add_filter( 'manage_edit-'.$post_type.'_sortable_columns', &nbsp;</div></li><li><div>                          array( &$this, 'add_sortable_columns' ), 10, 1 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">// https://codex.wordpress.org/Plugin_API/Action_Reference/manage_$post_type_posts_custom_column</span>&nbsp;</div></li><li><div>                      add_action( 'manage_'.$post_type.'_posts_custom_column', &nbsp;</div></li><li><div>                          array( &$this, 'show_column_content' ), 10, 2 );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'adding column filters for media library' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              add_filter( 'manage_media_columns', array( &$this, 'add_media_column_headings' ), NGFB_ADD_COLUMN_PRIORITY, 1 );&nbsp;</div></li><li><div>              add_filter( 'manage_upload_sortable_columns', array( &$this, 'add_sortable_columns' ), 10, 1 );&nbsp;</div></li><li><div>              add_action( 'manage_media_custom_column', array( &$this, 'show_column_content' ), 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * The 'parse_query' action is hooked ONCE in the NgfbPost class</span>&nbsp;</div></li><li><div><span class="comment">               * to set the column orderby for post, term, and user edit tables.</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              add_action( 'parse_query', array( &$this, 'set_column_orderby' ), 10, 1 );&nbsp;</div></li><li><div>              add_action( 'get_post_metadata', array( &$this, 'check_sortable_metadata' ), 10, 4 );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! empty( $this-&gt;p-&gt;options['plugin_shortlink'] ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'adding get_shortlink filter' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              <span class="comment"><span class="comment">// filters the shortlink for a post</span></span>&nbsp;</div></li><li><div>              add_filter( 'get_shortlink', array( &$this, 'get_shortlink' ), 9000, 4 );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! empty( $this-&gt;p-&gt;options['plugin_clear_for_comment'] ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'adding clear cache for comment actions' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              <span class="comment">// fires when a comment is inserted into the database</span>&nbsp;</div></li><li><div>              add_action ( 'comment_post', array( &$this, 'clear_cache_for_new_comment' ), 10, 2 );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>              <span class="comment">// fires before transitioning a comment's status from one to another</span>&nbsp;</div></li><li><div>              add_action ( 'wp_set_comment_status', array( &$this, 'clear_cache_for_comment_status' ), 10, 2 );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function get_mod( $mod_id ) {&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $mod = NgfbMeta::$mod_defaults;&nbsp;</div></li><li><div>          $mod['id'] = (int) $mod_id;&nbsp;</div></li><li><div>          $mod['name'] = 'post';&nbsp;</div></li><li><div>          $mod['obj'] =& $this;&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Post</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          $mod['is_post'] = true;&nbsp;</div></li><li><div>          $mod['is_home_page'] = SucomUtil::is_home_page( $mod_id );&nbsp;</div></li><li><div>          $mod['is_home_index'] = $mod['is_home_page'] ? false : SucomUtil::is_home_index( $mod_id );&nbsp;</div></li><li><div>          $mod['is_home'] = $mod['is_home_page'] || $mod['is_home_index'] ? true : false;&nbsp;</div></li><li><div>          $mod['post_type'] = get_post_type( $mod_id );                    <span class="comment">// post type name</span>&nbsp;</div></li><li><div>          $mod['post_status'] = get_post_status( $mod_id );                <span class="comment">// post status name</span>&nbsp;</div></li><li><div>          $mod['post_author'] = (int) get_post_field( 'post_author', $mod_id );        <span class="comment">// post author id</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// hooked by the 'coauthors' pro module</span>&nbsp;</div></li><li><div>          return apply_filters( $this-&gt;p-&gt;cf['lca'].'_get_post_mod', $mod, $mod_id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function get_posts( array $mod, $posts_per_page = false, $paged = false ) {&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $posts_per_page === false )&nbsp;</div></li><li><div>              $posts_per_page = apply_filters( $lca.'_posts_per_page', &nbsp;</div></li><li><div>                  get_option( 'posts_per_page' ), $mod );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $paged === false )&nbsp;</div></li><li><div>              $paged = get_query_var( 'paged' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! $paged &gt; 1 )&nbsp;</div></li><li><div>              $paged = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return get_posts( array(&nbsp;</div></li><li><div>              'posts_per_page' =&gt; $posts_per_page, &nbsp;</div></li><li><div>              'paged' =&gt; $paged, &nbsp;</div></li><li><div>              'post_status' =&gt; 'publish', &nbsp;</div></li><li><div>              'has_password' =&gt; false, <span class="comment">// since wp 3.9</span>&nbsp;</div></li><li><div>              'post_parent' =&gt; $mod['id'] ? $mod['id'] : null, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// filters the shortlink for a post</span></span>&nbsp;</div></li><li><div>      public function get_shortlink( $shortlink, $post_id, $context, $allow_slugs ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log_args( array( &nbsp;</div></li><li><div>                  'shortlink' =&gt; $shortlink, &nbsp;</div></li><li><div>                  'post_id' =&gt; $post_id, &nbsp;</div></li><li><div>                  'context' =&gt; $context, &nbsp;</div></li><li><div>                  'allow_slugs' =&gt; $allow_slugs, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( isset( $this-&gt;p-&gt;options['plugin_shortener'] ) &&&nbsp;</div></li><li><div>              $this-&gt;p-&gt;options['plugin_shortener'] !== 'none' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $mod = $this-&gt;get_mod( $post_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( empty( $mod['post_type'] ) ) {&nbsp;</div></li><li><div>                      if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                          $this-&gt;p-&gt;debug-&gt;log( 'exiting early: post_type is empty' );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      return $shortlink;&nbsp;</div></li><li><div>                  } elseif ( empty( $mod['post_status'] ) ) {&nbsp;</div></li><li><div>                      if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                          $this-&gt;p-&gt;debug-&gt;log( 'exiting early: post_status is empty' );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      return $shortlink;&nbsp;</div></li><li><div>                  } elseif ( $mod['post_status'] === 'auto-draft' ) {&nbsp;</div></li><li><div>                      if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                          $this-&gt;p-&gt;debug-&gt;log( 'exiting early: post_status is auto-draft' );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      return $shortlink;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $long_url = $this-&gt;p-&gt;util-&gt;get_sharing_url( $mod, false );    <span class="comment">// $add_page = false</span>&nbsp;</div></li><li><div>                  $short_url = apply_filters( $this-&gt;p-&gt;cf['lca'].'_shorten_url', &nbsp;</div></li><li><div>                      $long_url, $this-&gt;p-&gt;options['plugin_shortener'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $long_url !== $short_url ) {    <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// just in case</span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                      return $short_url;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>          } elseif ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'no shortener defined for shortlinks' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $shortlink;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function add_post_column_headings( $columns ) { &nbsp;</div></li><li><div>          return $this-&gt;add_mod_column_headings( $columns, 'post' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function add_media_column_headings( $columns ) { &nbsp;</div></li><li><div>          return $this-&gt;add_mod_column_headings( $columns, 'media' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function show_column_content( $column_name, $post_id ) {&nbsp;</div></li><li><div>          echo $this-&gt;get_column_content( '', $column_name, $post_id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function get_column_content( $value, $column_name, $post_id ) {&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          if ( ! empty( $post_id ) ) {    <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// just in case</span></span></span></span></span></span></span>&nbsp;</div></li><li><div>              $col_idx = str_replace( $lca.'_', '', $column_name );&nbsp;</div></li><li><div>              if ( ( $col_info = self::get_sortable_columns( $col_idx ) ) !== null ) {&nbsp;</div></li><li><div>                  if ( isset( $col_info['meta_key'] ) ) {    <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// just in case</span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                      $value = (string) get_post_meta( $post_id, $col_info['meta_key'], true );    <span class="comment">// $single = true</span>&nbsp;</div></li><li><div>                      if ( $value === 'none' ) {&nbsp;</div></li><li><div>                          $value = '';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $value;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function update_sortable_meta( $post_id, $col_idx, $content ) { &nbsp;</div></li><li><div>          if ( ! empty( $post_id ) ) {    <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// just in case</span></span></span></span></span></span></span>&nbsp;</div></li><li><div>              if ( ( $col_info = self::get_sortable_columns( $col_idx ) ) !== null ) {&nbsp;</div></li><li><div>                  if ( isset( $col_info['meta_key'] ) ) {    <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// just in case</span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                      update_post_meta( $post_id, $col_info['meta_key'], $content );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function check_sortable_metadata( $value, $post_id, $meta_key, $single ) {&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          if ( strpos( $meta_key, '_'.$lca.'_head_info_' ) !== 0 )    <span class="comment">// example: _ngfb_head_info_og_img_thumb</span>&nbsp;</div></li><li><div>              return $value;    <span class="comment"><span class="comment"><span class="comment">// return null</span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          static $checked_metadata = array();&nbsp;</div></li><li><div>          if ( isset( $checked_metadata[$post_id][$meta_key] ) )&nbsp;</div></li><li><div>              return $value;    <span class="comment"><span class="comment"><span class="comment">// return null</span></span></span>&nbsp;</div></li><li><div>          else $checked_metadata[$post_id][$meta_key] = true;    <span class="comment">// prevent recursion</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( get_post_meta( $post_id, $meta_key, true ) === '' ) {    <span class="comment">// returns empty string if meta not found</span>&nbsp;</div></li><li><div>              $mod = $this-&gt;get_mod( $post_id );&nbsp;</div></li><li><div>              $head_meta_tags = $this-&gt;p-&gt;head-&gt;get_head_array( $post_id, $mod, true );    <span class="comment">// $read_cache = true</span>&nbsp;</div></li><li><div>              $head_meta_info = $this-&gt;p-&gt;head-&gt;extract_head_info( $mod, $head_meta_tags );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $value;    <span class="comment"><span class="comment"><span class="comment">// return null</span></span></span>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// hooked into the current_screen action</span>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// sets the NgfbMeta::$head_meta_tags and NgfbMeta::$head_meta_info class properties</span></span>&nbsp;</div></li><li><div>      public function load_meta_page( $screen = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// all meta modules set this property, so use it to optimize code execution</span>&nbsp;</div></li><li><div>          if ( NgfbMeta::$head_meta_tags !== false || ! isset( $screen-&gt;id ) ) {&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'screen id: '.$screen-&gt;id );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          switch ( $screen-&gt;id ) {&nbsp;</div></li><li><div>              case 'upload':&nbsp;</div></li><li><div>              case ( strpos( $screen-&gt;id, 'edit-' ) === 0 ? true : false ):    <span class="comment">// posts list table</span>&nbsp;</div></li><li><div>                  return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $post_obj = SucomUtil::get_post_object( true );&nbsp;</div></li><li><div>          $post_id = empty( $post_obj-&gt;ID ) ? 0 : $post_obj-&gt;ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// make sure we have at least a post type and status</span>&nbsp;</div></li><li><div>          if ( ! is_object( $post_obj ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'exiting early: post_obj is not an object' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          } elseif ( empty( $post_obj-&gt;post_type ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'exiting early: post_type is empty' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          } elseif ( empty( $post_obj-&gt;post_status ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'exiting early: post_status is empty' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $mod = $this-&gt;get_mod( $post_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'home url = '.get_option( 'home' ) );&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'locale default = '.SucomUtil::get_locale( 'default' ) );&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'locale current = '.SucomUtil::get_locale( 'current' ) );&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'locale mod = '.SucomUtil::get_locale( $mod ) );&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( SucomDebug::pretty_array( $mod ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $post_obj-&gt;post_status === 'auto-draft' ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'head meta skipped: post_status is auto-draft' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              NgfbMeta::$head_meta_tags = array();&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $add_metabox = empty( $this-&gt;p-&gt;options['plugin_add_to_'.$post_obj-&gt;post_type] ) ? false : true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( apply_filters( $lca.'_add_metabox_post', $add_metabox, $post_id, $post_obj-&gt;post_type ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// hooked by woocommerce module to load front-end libraries and start a session</span>&nbsp;</div></li><li><div>                  do_action( $lca.'_admin_post_head', $mod, $screen-&gt;id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'setting head_meta_info static property' );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// $read_cache is false to generate notices etc.</span>&nbsp;</div></li><li><div>                  NgfbMeta::$head_meta_tags = $this-&gt;p-&gt;head-&gt;get_head_array( $post_id, $mod, false );&nbsp;</div></li><li><div>                  NgfbMeta::$head_meta_info = $this-&gt;p-&gt;head-&gt;extract_head_info( $mod, NgfbMeta::$head_meta_tags );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $post_obj-&gt;post_status === 'publish' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">// check for missing open graph image and description values</span>&nbsp;</div></li><li><div>                      foreach ( array( 'image', 'description' ) as $mt_suffix ) {&nbsp;</div></li><li><div>                          if ( empty( NgfbMeta::$head_meta_info['og:'.$mt_suffix] ) ) {&nbsp;</div></li><li><div>                              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                                  $this-&gt;p-&gt;debug-&gt;log( 'og:'.$mt_suffix.' meta tag is value empty and required' );&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                              if ( $this-&gt;p-&gt;notice-&gt;is_admin_pre_notices() ) {    <span class="comment">// skip if notices already shown</span>&nbsp;</div></li><li><div>                                  $this-&gt;p-&gt;notice-&gt;err( $this-&gt;p-&gt;msgs-&gt;get( 'notice-missing-og-'.$mt_suffix ) );&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      <span class="comment">// check duplicates only when the post is available publicly and we have a valid permalink</span>&nbsp;</div></li><li><div>                      if ( current_user_can( 'manage_options' ) ) {&nbsp;</div></li><li><div>                          if ( apply_filters( $lca.'_check_post_head', &nbsp;</div></li><li><div>                              $this-&gt;p-&gt;options['plugin_check_head'], $post_id, $post_obj ) ) {&nbsp;</div></li><li><div>                              $this-&gt;check_post_head_duplicates( $post_id, $post_obj );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $action_query = $lca.'-action';&nbsp;</div></li><li><div>          if ( ! empty( $_GET[$action_query] ) ) {&nbsp;</div></li><li><div>              $action_name = SucomUtil::sanitize_hookname( $_GET[$action_query] );&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'found action query: '.$action_name );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( empty( $_GET[ NGFB_NONCE ] ) ) {    <span class="comment">// NGFB_NONCE is an md5() string</span>&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'nonce token query field missing' );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              } elseif ( ! wp_verify_nonce( $_GET[ NGFB_NONCE ], NgfbAdmin::get_nonce() ) ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( sprintf( __( 'Nonce token validation failed for %1$s action &quot;%2$s&quot;.', &nbsp;</div></li><li><div>                      'nextgen-facebook' ), 'post', $action_name ) );&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $_SERVER['REQUEST_URI'] = remove_query_arg( array( $action_query, NGFB_NONCE ) );&nbsp;</div></li><li><div>                  switch ( $action_name ) {&nbsp;</div></li><li><div>                      default: &nbsp;</div></li><li><div>                          do_action( $lca.'_load_meta_page_post_'.$action_name, $post_id, $post_obj );&nbsp;</div></li><li><div>                          break;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function check_post_head_duplicates( $post_id = true, $post_obj = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( $this-&gt;p-&gt;options['plugin_check_head'] ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;mark( 'exiting early: plugin_check_head option is disabled');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              return $post_id;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! apply_filters( $lca.'_add_meta_name_'.$lca.':mark', true ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;mark( 'exiting early: '.$lca.':mark meta tags are disabled');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              return $post_id;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! is_object( $post_obj ) && ( $post_obj = SucomUtil::get_post_object( $post_id ) ) === false ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;mark( 'exiting early: unable to determine the post_id');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              return $post_id;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// only check publicly available posts</span>&nbsp;</div></li><li><div>          if ( ! isset( $post_obj-&gt;post_status ) || $post_obj-&gt;post_status !== 'publish' ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;mark( 'exiting early: post_status \''.$post_obj-&gt;post_status.'\' not published');&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              return $post_id;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// only check public post types (to avoid menu items, product variations, etc.)</span>&nbsp;</div></li><li><div>          $post_type_names = $this-&gt;p-&gt;util-&gt;get_post_types( 'names' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( $post_obj-&gt;post_type ) || ! in_array( $post_obj-&gt;post_type, $post_type_names ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;mark( 'exiting early: post_type \''.$post_obj-&gt;post_type.'\' not public' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              return $post_id;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $exec_count = (int) get_option( NGFB_POST_CHECK_NAME );    <span class="comment">// changes false to 0</span>&nbsp;</div></li><li><div>          $max_count = (int) SucomUtil::get_const( 'NGFB_CHECK_HEADER_COUNT', 10 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $exec_count &gt;= $max_count ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;mark( 'exiting early: exec_count of '.$exec_count.' exceeds max_count of '.$max_count );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              return $post_id;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark( 'check head meta' );    <span class="comment">// begin timer</span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $charset = get_bloginfo( 'charset' );&nbsp;</div></li><li><div>          $shortlink = wp_get_shortlink( $post_id, 'post' );    <span class="comment"><span class="comment">// $context = post</span></span>&nbsp;</div></li><li><div>          $shortlink_encoded = SucomUtil::encode_emoji( htmlentities( urldecode( $shortlink ), ENT_QUOTES, $charset, false ) );    <span class="comment">// double_encode = false</span>&nbsp;</div></li><li><div>          $check_opts = SucomUtil::preg_grep_keys( '/^add_/', $this-&gt;p-&gt;options, false, '' );&nbsp;</div></li><li><div>          $conflicts_found = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark( 'checking '.$shortlink.' head meta for duplicates' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( is_admin() ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;notice-&gt;inf( sprintf( __( 'Checking %1$s for duplicate meta tags', 'nextgen-facebook' ), &nbsp;</div></li><li><div>                  '&lt;a href=&quot;'.$shortlink.'&quot;&gt;'.$shortlink_encoded.'&lt;/a&gt;' ).'...' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// use the shortlink and have get_head_meta() remove our own meta tags</span>&nbsp;</div></li><li><div>          <span class="comment">// to avoid issues with caching plugins that ignore query arguments</span>&nbsp;</div></li><li><div>          if ( ( $metas = $this-&gt;p-&gt;util-&gt;get_head_meta( $shortlink, '/html/head/link|/html/head/meta', true ) ) !== false ) {&nbsp;</div></li><li><div>              foreach( array(&nbsp;</div></li><li><div>                  'link' =&gt; array( 'rel' ), &nbsp;</div></li><li><div>                  'meta' =&gt; array( 'name', 'property', 'itemprop' ), &nbsp;</div></li><li><div> ) as $tag =&gt; $types ) {&nbsp;</div></li><li><div>                  if ( isset( $metas[$tag] ) ) {&nbsp;</div></li><li><div>                      foreach( $metas[$tag] as $meta ) {&nbsp;</div></li><li><div>                          foreach( $types as $type ) {&nbsp;</div></li><li><div>                              if ( isset( $meta[$type] ) && $meta[$type] !== 'generator' && &nbsp;</div></li><li><div>                                  ! empty( $check_opts[$tag.'_'.$type.'_'.$meta[$type]] ) ) {&nbsp;</div></li><li><div>                                  $conflicts_found++;&nbsp;</div></li><li><div>                                  $this-&gt;p-&gt;notice-&gt;err( sprintf( __( 'Possible conflict detected &mdash; your theme or another plugin is adding a &lt;code&gt;%1$s&lt;/code&gt; HTML tag to the head section of this webpage.', 'nextgen-facebook' ), $tag.' '.$type.'=&quot;'.$meta[$type].'&quot;' ) );&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! $conflicts_found ) {&nbsp;</div></li><li><div>                  update_option( NGFB_POST_CHECK_NAME, ++$exec_count, false );    <span class="comment">// autoload = false</span>&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;inf( sprintf( __( 'Awesome! No duplicate meta tags found. :-) %s more checks to go...', &nbsp;</div></li><li><div>                      'nextgen-facebook' ), $max_count - $exec_count ) );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          } elseif ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark( 'returned head meta for '.$shortlink.' is false' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark( 'check head meta' );    <span class="comment"><span class="comment">// end timer</span></span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $post_id;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function add_metaboxes() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ( $post_obj = SucomUtil::get_post_object( true ) ) === false || empty( $post_obj-&gt;post_type ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'exiting early: object without post type' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $post_id = empty( $post_obj-&gt;ID ) ? 0 : $post_obj-&gt;ID;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ( $post_obj-&gt;post_type === 'page' && ! current_user_can( 'edit_page', $post_id ) ) || &nbsp;</div></li><li><div>              ! current_user_can( 'edit_post', $post_id ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'insufficient privileges to add metabox for '.$post_obj-&gt;post_type.' ID '.$post_id );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $add_metabox = empty( $this-&gt;p-&gt;options[ 'plugin_add_to_'.$post_obj-&gt;post_type ] ) ? false : true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( apply_filters( $lca.'_add_metabox_post', $add_metabox, $post_id, $post_obj-&gt;post_type ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'adding metabox '.$lca.'_social_settings' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              add_meta_box( $lca.'_social_settings', _x( 'Social Settings', 'metabox title', 'nextgen-facebook' ), &nbsp;</div></li><li><div>                  array( &$this, 'show_metabox_social_settings' ), $post_obj-&gt;post_type, 'normal', 'low' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          } elseif ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'skipped metabox '.$lca.'_social_settings' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function show_metabox_social_settings( $post_obj ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'post id = '.( empty( $post_obj-&gt;ID ) ? 0 : $post_obj-&gt;ID ) );&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'post type = '.( empty( $post_obj-&gt;post_type ) ? 'empty' : $post_obj-&gt;post_type ) );&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'post status = '.( empty( $post_obj-&gt;post_status ) ? 'empty' : $post_obj-&gt;post_status ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $metabox = 'social_settings';&nbsp;</div></li><li><div>          $mod = $this-&gt;get_mod( $post_obj-&gt;ID );&nbsp;</div></li><li><div>          $tabs = $this-&gt;get_social_tabs( $metabox, $mod );&nbsp;</div></li><li><div>          $opts = $this-&gt;get_options( $post_obj-&gt;ID );&nbsp;</div></li><li><div>          $def_opts = $this-&gt;get_defaults( $post_obj-&gt;ID );&nbsp;</div></li><li><div>          $this-&gt;form = new SucomForm( $this-&gt;p, NGFB_META_NAME, $opts, $def_opts );&nbsp;</div></li><li><div>          wp_nonce_field( NgfbAdmin::get_nonce(), NGFB_NONCE );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark( $metabox.' table rows' );    <span class="comment">// start timer</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $table_rows = array();&nbsp;</div></li><li><div>          foreach ( $tabs as $key =&gt; $title ) {&nbsp;</div></li><li><div>              $table_rows[$key] = array_merge( $this-&gt;get_table_rows( $metabox, $key, NgfbMeta::$head_meta_info, $mod ), &nbsp;</div></li><li><div>                  apply_filters( $lca.'_'.$mod['name'].'_'.$key.'_rows', array(), $this-&gt;form, NgfbMeta::$head_meta_info, $mod ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $this-&gt;p-&gt;util-&gt;do_metabox_tabs( $metabox, $tabs, $table_rows );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark( $metabox.' table rows' );    <span class="comment"><span class="comment">// end timer</span></span>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function get_table_rows( &$metabox, &$key, &$head, &$mod ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $is_auto_draft = empty( $mod['post_status'] ) || &nbsp;</div></li><li><div>              $mod['post_status'] === 'auto-draft' ? true : false;&nbsp;</div></li><li><div>          $auto_draft_msg = sprintf( __( 'Save a draft version or publish the %s to update this value.', &nbsp;</div></li><li><div>              'nextgen-facebook' ), SucomUtil::titleize( $mod['post_type'] ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $table_rows = array();&nbsp;</div></li><li><div>          switch ( $key ) {&nbsp;</div></li><li><div>              case 'preview':&nbsp;</div></li><li><div>                  $table_rows = $this-&gt;get_rows_social_preview( $this-&gt;form, $head, $mod );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              case 'tags':    &nbsp;</div></li><li><div>                  if ( $is_auto_draft ) {&nbsp;</div></li><li><div>                      $table_rows[] = '&lt;td&gt;&lt;blockquote class=&quot;status-info&quot;&gt;&lt;p class=&quot;centered&quot;&gt;'.&nbsp;</div></li><li><div>                          $auto_draft_msg.'&lt;/p&gt;&lt;/blockquote&gt;&lt;/td&gt;';&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $table_rows = $this-&gt;get_rows_head_tags( $this-&gt;form, $head, $mod );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  break; &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              case 'validate':&nbsp;</div></li><li><div>                  if ( $is_auto_draft ) {&nbsp;</div></li><li><div>                      $table_rows[] = '&lt;td&gt;&lt;blockquote class=&quot;status-info&quot;&gt;&lt;p class=&quot;centered&quot;&gt;'.&nbsp;</div></li><li><div>                          $auto_draft_msg.'&lt;/p&gt;&lt;/blockquote&gt;&lt;/td&gt;';&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $table_rows = $this-&gt;get_rows_validate( $this-&gt;form, $head, $mod );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  break; &nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $table_rows;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function clear_cache_for_new_comment( $comment_id, $comment_approved ) {&nbsp;</div></li><li><div>          if ( $comment_id && $comment_approved === 1 ) {&nbsp;</div></li><li><div>              if ( ( $comment = get_comment( $comment_id ) ) && $comment-&gt;comment_post_ID ) {&nbsp;</div></li><li><div>                  $post_id = $comment-&gt;comment_post_ID;&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'clearing post_id '.$post_id.' cache for comment_id '.$comment_id );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  $this-&gt;clear_cache( $post_id );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function clear_cache_for_comment_status( $comment_id, $comment_status ) {&nbsp;</div></li><li><div>          if ( $comment_id ) {    <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// just in case</span></span></span></span></span></span></span>&nbsp;</div></li><li><div>              if ( ( $comment = get_comment( $comment_id ) ) && $comment-&gt;comment_post_ID ) {&nbsp;</div></li><li><div>                  $post_id = $comment-&gt;comment_post_ID;&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'clearing post_id '.$post_id.' cache for comment_id '.$comment_id );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  $this-&gt;clear_cache( $post_id );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function clear_cache( $post_id, $rel_id = false ) {&nbsp;</div></li><li><div>          switch ( get_post_status( $post_id ) ) {&nbsp;</div></li><li><div>              case 'draft':&nbsp;</div></li><li><div>              case 'pending':&nbsp;</div></li><li><div>              case 'future':&nbsp;</div></li><li><div>              case 'private':&nbsp;</div></li><li><div>              case 'publish':&nbsp;</div></li><li><div>                  $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>                  $mod = $this-&gt;get_mod( $post_id );&nbsp;</div></li><li><div>                  $sharing_url = $this-&gt;p-&gt;util-&gt;get_sharing_url( $mod );&nbsp;</div></li><li><div>                  $cache_salt = SucomUtil::get_mod_salt( $mod, $sharing_url );&nbsp;</div></li><li><div>                  $permalink = get_permalink( $post_id );&nbsp;</div></li><li><div>                  $shortlink = wp_get_shortlink( $post_id, 'post' );    <span class="comment"><span class="comment">// $context = post</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $transients = array(&nbsp;</div></li><li><div>                      'NgfbHead::get_head_array' =&gt; array( $cache_salt ), &nbsp;</div></li><li><div>                      'SucomCache::get' =&gt; array( 'url:'.$permalink, 'url:'.$shortlink ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                  $transients = apply_filters( $lca.'_post_cache_transients', $transients, $mod, $sharing_url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $wp_objects = array( 'NgfbPage::get_content' =&gt; array( $cache_salt ) );&nbsp;</div></li><li><div>                  $wp_objects = apply_filters( $lca.'_post_cache_objects', $wp_objects, $mod, $sharing_url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $deleted = $this-&gt;p-&gt;util-&gt;clear_cache_objects( $transients, $wp_objects );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( ! empty( $this-&gt;p-&gt;options['plugin_show_purge_count'] ) && $deleted &gt; 0 ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;notice-&gt;inf( $deleted.' items removed from the WordPress object and transient caches.', &nbsp;</div></li><li><div>                          true, __FUNCTION__.'_show_purge_count', true );    <span class="comment">// can be dismissed</span>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( function_exists( 'w3tc_pgcache_flush_post' ) ) {    <span class="comment">// w3 total cache</span>&nbsp;</div></li><li><div>                      w3tc_pgcache_flush_post( $post_id );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( function_exists( 'wp_cache_post_change' ) ) {    <span class="comment">// wp super cache</span>&nbsp;</div></li><li><div>                      wp_cache_post_change( $post_id );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $post_id;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function get_og_type_reviews( $post_id, $og_type = 'product', $rating_meta = 'rating' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $ret = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( $post_id ) ) {&nbsp;</div></li><li><div>              return $ret;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $comments = get_comments( array(&nbsp;</div></li><li><div>              'post_id' =&gt; $post_id, &nbsp;</div></li><li><div>              'status' =&gt; 'approve', &nbsp;</div></li><li><div>              'parent' =&gt; 0, <span class="comment">// don't get replies</span>&nbsp;</div></li><li><div>              'order' =&gt; 'DESC', &nbsp;</div></li><li><div>              'number' =&gt; get_option( 'page_comments' ), <span class="comment">// limit number of comments</span>&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( is_array( $comments ) ) {&nbsp;</div></li><li><div>              foreach( $comments as $num =&gt; $comment_obj ) {&nbsp;</div></li><li><div>                  $og_review = $this-&gt;get_og_review_mt( $comment_obj, $og_type, $rating_meta );&nbsp;</div></li><li><div>                  if ( ! empty( $og_review ) ) {    <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// just in case</span></span></span></span></span></span></span>&nbsp;</div></li><li><div>                      $ret[] = $og_review;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $ret;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function get_og_review_mt( $comment_obj, $og_type = 'product', $rating_meta = 'rating' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $ret = array();&nbsp;</div></li><li><div>          $rating_value = (float) get_comment_meta( $comment_obj-&gt;comment_ID, $rating_meta, true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $ret[$og_type.':review:id'] = $comment_obj-&gt;comment_ID;&nbsp;</div></li><li><div>          $ret[$og_type.':review:url'] = get_comment_link( $comment_obj-&gt;comment_ID );&nbsp;</div></li><li><div>          $ret[$og_type.':review:author:id'] = $comment_obj-&gt;user_id;    <span class="comment">// author ID if registered (0 otherwise)</span>&nbsp;</div></li><li><div>          $ret[$og_type.':review:author:name'] = $comment_obj-&gt;comment_author;    <span class="comment">// author display name</span>&nbsp;</div></li><li><div>          $ret[$og_type.':review:created_time'] = mysql2date( 'c', $comment_obj-&gt;comment_date_gmt );&nbsp;</div></li><li><div>          $ret[$og_type.':review:excerpt'] = get_comment_excerpt( $comment_obj-&gt;comment_ID );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// rating values must be larger than 0 to include rating info</span>&nbsp;</div></li><li><div>          if ( $rating_value &gt; 0 ) {&nbsp;</div></li><li><div>              $ret[$og_type.':review:rating:value'] = $rating_value;&nbsp;</div></li><li><div>              $ret[$og_type.':review:rating:worst'] = 1;&nbsp;</div></li><li><div>              $ret[$og_type.':review:rating:best'] = 5;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $ret;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>NextGEN Facebook (NGFB)</li><li><span></span>8.43.0</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2021 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>