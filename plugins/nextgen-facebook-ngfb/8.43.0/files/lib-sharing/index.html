<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="8.43.0" data-slug="nextgen-facebook-ngfb" data-type="file" data-id="7662"><head xmlns="http://www.w3.org/1999/xhtml"><title> lib-sharing | file | Nextgen Facebook Ngfb | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, nextgen-facebook-ngfb, 8.43.0" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=be89d5ae67f3320803adeb019e6b93af' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/lib-sharing/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Flib-sharing%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Flib-sharing%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-nextgen-facebook-ngfb-8.43.0-file-lib-sharing","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="lib-sharing" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to nextgen-facebook-ngfb." href="http://hookr.io/plugins/nextgen-facebook-ngfb/" class="plugin"><span property="name">nextgen-facebook-ngfb</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 8.43.0." href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/" class="H_VERSION"><span property="name">8.43.0</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">lib-sharing</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="406"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/all/" title="All">All <span class="count badge">406</span></a></li><li class="" data-id="new" data-count="86"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/new/" title="New">New <span class="count badge">86</span></a></li><li class="" data-id="hooks" data-count="283"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/hooks/" title="Hooks">Hooks <span class="count badge">283</span></a></li><li class="" data-id="action" data-count="12"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/actions/" title="Actions">Actions <span class="count badge">12</span></a></li><li class="" data-id="filter" data-count="271"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/filters/" title="Filters">Filters <span class="count badge">271</span></a></li><li class="" data-id="class" data-count="95"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/classes/" title="Classes">Classes <span class="count badge">95</span></a></li><li class="" data-id="constant" data-count="14"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/constants/" title="Constants">Constants <span class="count badge">14</span></a></li><li class="" data-id="function" data-count="13"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/functions/" title="Functions">Functions <span class="count badge">13</span></a></li><li class="" data-id="shortcode" data-count="1"><a href="http://hookr.io/plugins/nextgen-facebook-ngfb/8.43.0/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">1</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/lib/sharing.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * License: GPLv3</span>&nbsp;</div></li><li><div><span class="comment"> * License URI: https://www.gnu.org/licenses/gpl.txt</span>&nbsp;</div></li><li><div><span class="comment"> * Copyright 2012-2017 Jean-Sebastien Morisset (https://surniaulula.com/)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( ! defined( 'ABSPATH' ) ) {&nbsp;</div></li><li><div>  die( 'These aren\'t the droids you\'re looking for...' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( ! class_exists( 'NgfbSharing' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  class NgfbSharing {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected $p;&nbsp;</div></li><li><div>      protected $website = array();&nbsp;</div></li><li><div>      protected $plugin_filepath = '';&nbsp;</div></li><li><div>      protected $buttons_for_type = array();        <span class="comment">// cache for have_buttons_for_type()</span>&nbsp;</div></li><li><div>      protected $post_buttons_disabled = array();    <span class="comment">// cache for is_post_buttons_disabled()</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public static $sharing_css_name = '';&nbsp;</div></li><li><div>      public static $sharing_css_file = '';&nbsp;</div></li><li><div>      public static $sharing_css_url = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public static $cf = array(&nbsp;</div></li><li><div>          'opt' =&gt; array(                <span class="comment">// options</span>&nbsp;</div></li><li><div>              'defaults' =&gt; array(&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * Advanced Settings</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  <span class="comment">// Cache Settings Tab</span>&nbsp;</div></li><li><div>                  'plugin_sharing_buttons_cache_exp' =&gt; WEEK_IN_SECONDS, <span class="comment"><span class="comment">// Sharing Buttons Cache Expiry (7 days)</span></span>&nbsp;</div></li><li><div>                  'plugin_social_file_cache_exp' =&gt; 0, <span class="comment"><span class="comment">// Social File Cache Expiry</span></span>&nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * Sharing Buttons</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  <span class="comment">// Include Buttons Tab</span>&nbsp;</div></li><li><div>                  'buttons_on_index' =&gt; 0, &nbsp;</div></li><li><div>                  'buttons_on_front' =&gt; 0, &nbsp;</div></li><li><div>                  'buttons_add_to_post' =&gt; 1, &nbsp;</div></li><li><div>                  'buttons_add_to_page' =&gt; 1, &nbsp;</div></li><li><div>                  'buttons_add_to_attachment' =&gt; 1, &nbsp;</div></li><li><div>                  <span class="comment">// Buttons Position Tab</span>&nbsp;</div></li><li><div>                  'buttons_pos_content' =&gt; 'bottom', &nbsp;</div></li><li><div>                  'buttons_pos_excerpt' =&gt; 'bottom', &nbsp;</div></li><li><div>                  <span class="comment">// Buttons Presets Tab</span>&nbsp;</div></li><li><div>                  'buttons_preset_content' =&gt; '', &nbsp;</div></li><li><div>                  'buttons_preset_excerpt' =&gt; '', &nbsp;</div></li><li><div>                  'buttons_preset_admin_edit' =&gt; 'small_share_count', &nbsp;</div></li><li><div>                  'buttons_preset_sidebar' =&gt; 'large_share_vertical', &nbsp;</div></li><li><div>                  'buttons_preset_shortcode' =&gt; '', &nbsp;</div></li><li><div>                  'buttons_preset_widget' =&gt; '', &nbsp;</div></li><li><div>                  <span class="comment">// Advanced Tab</span>&nbsp;</div></li><li><div>                  'buttons_force_prot' =&gt; '', &nbsp;</div></li><li><div>                  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">                   * Sharing Styles</span>&nbsp;</div></li><li><div><span class="comment">                   */</span>&nbsp;</div></li><li><div>                  'buttons_use_social_style' =&gt; 1, &nbsp;</div></li><li><div>                  'buttons_enqueue_social_style' =&gt; 1, &nbsp;</div></li><li><div>                  'buttons_css_sharing' =&gt; '', <span class="comment">// all buttons</span>&nbsp;</div></li><li><div>                  'buttons_css_content' =&gt; '', <span class="comment">// post/page content</span>&nbsp;</div></li><li><div>                  'buttons_css_excerpt' =&gt; '', <span class="comment">// post/page excerpt</span>&nbsp;</div></li><li><div>                  'buttons_css_admin_edit' =&gt; '', &nbsp;</div></li><li><div>                  'buttons_css_sidebar' =&gt; '', &nbsp;</div></li><li><div>                  'buttons_css_shortcode' =&gt; '', &nbsp;</div></li><li><div>                  'buttons_css_widget' =&gt; '', &nbsp;</div></li><li><div>                  'buttons_js_sidebar' =&gt; '<span class="comment">/* Save an empty style text box to reload the default javascript */</span>&nbsp;</div></li><li><div>jQuery(&quot;#ngfb-sidebar&quot;).mouseenter( function() { &nbsp;</div></li><li><div>  jQuery(&quot;#ngfb-sidebar-buttons&quot;).css({&nbsp;</div></li><li><div>      display:&quot;block&quot;, &nbsp;</div></li><li><div>      width:&quot;auto&quot;, &nbsp;</div></li><li><div>      height:&quot;auto&quot;, &nbsp;</div></li><li><div>      overflow:&quot;visible&quot;, &nbsp;</div></li><li><div>      &quot;border-style&quot;:&quot;solid&quot;, &nbsp;</div></li><li><div>  }); } );&nbsp;</div></li><li><div>jQuery(&quot;#ngfb-sidebar-header&quot;).click( function() { &nbsp;</div></li><li><div>  jQuery(&quot;#ngfb-sidebar-buttons&quot;).toggle(); } );', &nbsp;</div></li><li><div> ), <span class="comment">// end of defaults</span>&nbsp;</div></li><li><div>              'site_defaults' =&gt; array(&nbsp;</div></li><li><div>                  'plugin_sharing_buttons_cache_exp' =&gt; WEEK_IN_SECONDS, <span class="comment"><span class="comment">// Sharing Buttons Cache Expiry (7 days)</span></span>&nbsp;</div></li><li><div>                  'plugin_sharing_buttons_cache_exp:use' =&gt; 'default', &nbsp;</div></li><li><div>                  'plugin_social_file_cache_exp' =&gt; 0, <span class="comment"><span class="comment">// Social File Cache Expiry</span></span>&nbsp;</div></li><li><div>                  'plugin_social_file_cache_exp:use' =&gt; 'default', &nbsp;</div></li><li><div> ), <span class="comment">// end of site defaults</span>&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function __construct( &$plugin, $plugin_filepath = NGFB_FILEPATH ) {&nbsp;</div></li><li><div>          $this-&gt;p =& $plugin;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark( 'sharing action / filter setup' );    <span class="comment">// begin timer</span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;plugin_filepath = $plugin_filepath;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          self::$sharing_css_name = 'sharing-styles-id-'.get_current_blog_id().'.min.css';&nbsp;</div></li><li><div>          self::$sharing_css_file = NGFB_CACHEDIR.self::$sharing_css_name;&nbsp;</div></li><li><div>          self::$sharing_css_url = NGFB_CACHEURL.self::$sharing_css_name;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;set_objects();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_action( 'wp_enqueue_scripts', array( &$this, 'wp_enqueue_styles' ) );&nbsp;</div></li><li><div>          add_action( 'wp_head', array( &$this, 'show_head' ), NGFB_HEAD_PRIORITY );&nbsp;</div></li><li><div>          add_action( 'wp_footer', array( &$this, 'show_footer' ), NGFB_FOOTER_PRIORITY );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;have_buttons_for_type( 'content' ) ) {&nbsp;</div></li><li><div>              $this-&gt;add_buttons_filter( 'the_content' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;have_buttons_for_type( 'excerpt' ) ) {&nbsp;</div></li><li><div>              $this-&gt;add_buttons_filter( 'get_the_excerpt' );&nbsp;</div></li><li><div>              $this-&gt;add_buttons_filter( 'the_excerpt' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;p-&gt;util-&gt;add_plugin_filters( $this, array( &nbsp;</div></li><li><div>              'get_defaults' =&gt; 1, &nbsp;</div></li><li><div>              'get_site_defaults' =&gt; 1, &nbsp;</div></li><li><div>              'get_md_defaults' =&gt; 1, &nbsp;</div></li><li><div>              'text_filter_begin' =&gt; 2, &nbsp;</div></li><li><div>              'text_filter_end' =&gt; 2, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( is_admin() ) {&nbsp;</div></li><li><div>              if ( $this-&gt;have_buttons_for_type( 'admin_edit' ) ) {&nbsp;</div></li><li><div>                  add_action( 'add_meta_boxes', array( &$this, 'add_post_buttons_metabox' ) );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;p-&gt;util-&gt;add_plugin_filters( $this, array( &nbsp;</div></li><li><div>                  'save_options' =&gt; 3, <span class="comment">// update the sharing css file</span>&nbsp;</div></li><li><div>                  'option_type' =&gt; 2, <span class="comment">// identify option type for sanitation</span>&nbsp;</div></li><li><div>                  'post_social_settings_tabs' =&gt; 2, <span class="comment">// $tabs, $mod</span>&nbsp;</div></li><li><div>                  'post_cache_transients' =&gt; 3, <span class="comment">// clear transients on post save</span>&nbsp;</div></li><li><div>                  'messages_info' =&gt; 2, &nbsp;</div></li><li><div>                  'messages_tooltip' =&gt; 2, &nbsp;</div></li><li><div>                  'messages_tooltip_plugin' =&gt; 2, &nbsp;</div></li><li><div>                  'settings_page_custom_style_css' =&gt; 1, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;p-&gt;util-&gt;add_plugin_filters( $this, array( &nbsp;</div></li><li><div>                  'status_gpl_features' =&gt; 4, <span class="comment">// include sharing, shortcode, and widget status</span>&nbsp;</div></li><li><div>                  'status_pro_features' =&gt; 4, <span class="comment">// include social file cache status</span>&nbsp;</div></li><li><div> ), 10, 'ngfb' );                <span class="comment">// hook into the extension name instead</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;p-&gt;util-&gt;add_plugin_actions( $this, array( &nbsp;</div></li><li><div>                  'load_setting_page_reload_default_sharing_styles' =&gt; 4, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark( 'sharing action / filter setup' );    <span class="comment">// end timer</span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      private function set_objects() {&nbsp;</div></li><li><div>          foreach ( $this-&gt;p-&gt;cf['plugin']['ngfb']['lib']['website'] as $id =&gt; $name ) {&nbsp;</div></li><li><div>              $classname = NgfbConfig::load_lib( false, 'website/'.$id, 'ngfbwebsite'.$id );&nbsp;</div></li><li><div>              if ( $classname !== false && class_exists( $classname ) ) {&nbsp;</div></li><li><div>                  $this-&gt;website[$id] = new $classname( $this-&gt;p );&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( $classname.' class loaded' );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function filter_get_defaults( $def_opts ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $def_opts = array_merge( $def_opts, self::$cf['opt']['defaults'] );&nbsp;</div></li><li><div>          $def_opts = $this-&gt;p-&gt;util-&gt;add_ptns_to_opts( $def_opts, 'buttons_add_to', 1 );&nbsp;</div></li><li><div>          $plugin_dir = trailingslashit( realpath( dirname( $this-&gt;plugin_filepath ) ) );&nbsp;</div></li><li><div>          $url_path = parse_url( trailingslashit( plugins_url( '', $this-&gt;plugin_filepath ) ), PHP_URL_PATH );    <span class="comment">// relative URL</span>&nbsp;</div></li><li><div>          $tabs = apply_filters( $this-&gt;p-&gt;cf['lca'].'_sharing_styles_tabs', $this-&gt;p-&gt;cf['sharing']['styles'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $tabs as $id =&gt; $name ) {&nbsp;</div></li><li><div>              $buttons_css_file = $plugin_dir.'css/'.$id.'-buttons.css';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// css files are only loaded once (when variable is empty) into defaults to minimize disk i/o</span>&nbsp;</div></li><li><div>              if ( empty( $def_opts['buttons_css_'.$id] ) ) {&nbsp;</div></li><li><div>                  if ( ! file_exists( $buttons_css_file ) ) {&nbsp;</div></li><li><div>                      continue;&nbsp;</div></li><li><div>                  } elseif ( ! $fh = @fopen( $buttons_css_file, 'rb' ) ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;notice-&gt;err( sprintf( __( 'Failed to open the %s file for reading.', &nbsp;</div></li><li><div>                          'nextgen-facebook' ), $buttons_css_file ) );&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      $buttons_css_data = fread( $fh, filesize( $buttons_css_file ) );&nbsp;</div></li><li><div>                      fclose( $fh );&nbsp;</div></li><li><div>                      if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                          $this-&gt;p-&gt;debug-&gt;log( 'read css from file '.$buttons_css_file );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      foreach ( array( 'plugin_url_path' =&gt; $url_path ) as $macro =&gt; $value ) {&nbsp;</div></li><li><div>                          $buttons_css_data = preg_replace( '/%%'.$macro.'%%/', $value, $buttons_css_data );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      $def_opts['buttons_css_'.$id] = $buttons_css_data;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $def_opts;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function filter_get_site_defaults( $site_def_opts ) {&nbsp;</div></li><li><div>          return array_merge( $site_def_opts, self::$cf['opt']['site_defaults'] );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function filter_get_md_defaults( $md_defs ) {&nbsp;</div></li><li><div>          return array_merge( $md_defs, array(&nbsp;</div></li><li><div>              'email_title' =&gt; '', <span class="comment">// Email Subject</span>&nbsp;</div></li><li><div>              'email_desc' =&gt; '', <span class="comment">// Email Message</span>&nbsp;</div></li><li><div>              'twitter_desc' =&gt; '', <span class="comment">// Tweet Text</span>&nbsp;</div></li><li><div>              'pin_desc' =&gt; '', <span class="comment">// Pinterest Caption Text</span>&nbsp;</div></li><li><div>              'tumblr_img_desc' =&gt; '', <span class="comment">// Tumblr Image Caption</span>&nbsp;</div></li><li><div>              'tumblr_vid_desc' =&gt; '', <span class="comment">// Tumblr Video Caption</span>&nbsp;</div></li><li><div>              'buttons_disabled' =&gt; 0, <span class="comment">// Disable Sharing Buttons</span>&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function filter_save_options( $opts, $options_name, $network ) {&nbsp;</div></li><li><div>          <span class="comment">// update the combined and minimized social stylesheet</span>&nbsp;</div></li><li><div>          if ( $network === false ) {&nbsp;</div></li><li><div>              $this-&gt;update_sharing_css( $opts );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $opts;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function filter_option_type( $type, $key ) {&nbsp;</div></li><li><div>          if ( ! empty( $type ) ) {&nbsp;</div></li><li><div>              return $type;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          switch ( $key ) {&nbsp;</div></li><li><div>              <span class="comment">// integer options that must be 1 or more (not zero)</span>&nbsp;</div></li><li><div>              case 'stumble_badge':&nbsp;</div></li><li><div>              case ( preg_match( '/_order$/', $key ) ? true : false ):&nbsp;</div></li><li><div>                  return 'pos_int';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              <span class="comment">// text strings that can be blank</span>&nbsp;</div></li><li><div>              case 'buttons_force_prot':&nbsp;</div></li><li><div>              case 'gp_expandto':&nbsp;</div></li><li><div>              case 'pin_desc':&nbsp;</div></li><li><div>              case 'tumblr_img_desc':&nbsp;</div></li><li><div>              case 'tumblr_vid_desc':&nbsp;</div></li><li><div>              case 'twitter_desc':&nbsp;</div></li><li><div>                  return 'ok_blank';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              <span class="comment">// options</span> that cannot be blank&nbsp;</div></li><li><div>              case 'fb_platform': &nbsp;</div></li><li><div>              case 'fb_script_loc': &nbsp;</div></li><li><div>              case 'fb_lang': &nbsp;</div></li><li><div>              case 'fb_button': &nbsp;</div></li><li><div>              case 'fb_markup': &nbsp;</div></li><li><div>              case 'fb_layout': &nbsp;</div></li><li><div>              case 'fb_font': &nbsp;</div></li><li><div>              case 'fb_colorscheme': &nbsp;</div></li><li><div>              case 'fb_action': &nbsp;</div></li><li><div>              case 'fb_share_markup': &nbsp;</div></li><li><div>              case 'fb_share_layout': &nbsp;</div></li><li><div>              case 'fb_share_size': &nbsp;</div></li><li><div>              case 'gp_lang': &nbsp;</div></li><li><div>              case 'gp_action': &nbsp;</div></li><li><div>              case 'gp_size': &nbsp;</div></li><li><div>              case 'gp_annotation': &nbsp;</div></li><li><div>              case 'gp_expandto': &nbsp;</div></li><li><div>              case 'twitter_count': &nbsp;</div></li><li><div>              case 'twitter_size': &nbsp;</div></li><li><div>              case 'linkedin_counter':&nbsp;</div></li><li><div>              case 'managewp_type':&nbsp;</div></li><li><div>              case 'pin_button_lang':&nbsp;</div></li><li><div>              case 'pin_button_shape':&nbsp;</div></li><li><div>              case 'pin_button_color':&nbsp;</div></li><li><div>              case 'pin_button_height':&nbsp;</div></li><li><div>              case 'pin_count_layout':&nbsp;</div></li><li><div>              case 'pin_caption':&nbsp;</div></li><li><div>              case 'tumblr_button_style':&nbsp;</div></li><li><div>              case 'tumblr_caption':&nbsp;</div></li><li><div>              case ( strpos( $key, 'buttons_pos_' ) === 0 ? true : false ):&nbsp;</div></li><li><div>              case ( preg_match( '/^[a-z]+_script_loc$/', $key ) ? true : false ):&nbsp;</div></li><li><div>                  return 'not_blank';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $type;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function filter_post_social_settings_tabs( $tabs, $mod ) {&nbsp;</div></li><li><div>          return SucomUtil::get_after_key( $tabs, 'media', 'buttons', &nbsp;</div></li><li><div>              _x( 'Sharing Buttons', 'metabox tab', 'nextgen-facebook' ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function filter_post_cache_transients( $transients, $mod, $sharing_url ) {&nbsp;</div></li><li><div>          $cache_salt = SucomUtil::get_mod_salt( $mod, $sharing_url );&nbsp;</div></li><li><div>          $transients['NgfbSharing::get_buttons'][] = $cache_salt;&nbsp;</div></li><li><div>          $transients['NgfbShortcodeSharing::shortcode'][] = $cache_salt;&nbsp;</div></li><li><div>          $transients['NgfbWidgetSharing::widget'][] = $cache_salt;&nbsp;</div></li><li><div>          return $transients;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// hooked to 'ngfb_status_gpl_features'</span>&nbsp;</div></li><li><div>      public function filter_status_gpl_features( $features, $ext, $info, $pkg ) {&nbsp;</div></li><li><div>          if ( ! empty( $info['lib']['submenu']['buttons'] ) )&nbsp;</div></li><li><div>              $features['(sharing) Sharing Buttons'] = array(&nbsp;</div></li><li><div>                  'classname' =&gt; $ext.'Sharing', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          if ( ! empty( $info['lib']['submenu']['styles'] ) )&nbsp;</div></li><li><div>              $features['(sharing) Sharing Stylesheet'] = array(&nbsp;</div></li><li><div>                  'status' =&gt; empty( $this-&gt;p-&gt;options['buttons_use_social_style'] ) ? 'off' : 'on', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          if ( ! empty( $info['lib']['shortcode']['sharing'] ) )&nbsp;</div></li><li><div>              $features['(sharing) Sharing Shortcode'] = array(&nbsp;</div></li><li><div>                  'classname' =&gt; $ext.'ShortcodeSharing', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          if ( ! empty( $info['lib']['widget']['sharing'] ) )&nbsp;</div></li><li><div>              $features['(sharing) Sharing Widget'] = array(&nbsp;</div></li><li><div>                  'classname' =&gt; $ext.'WidgetSharing'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          return $features;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function filter_status_pro_features( $features, $ext, $info, $pkg ) {&nbsp;</div></li><li><div>          if ( ! empty( $info['lib']['submenu']['buttons'] ) ) {&nbsp;</div></li><li><div>              $features['(tool) Sharing Styles Editor'] = array( &nbsp;</div></li><li><div>                  'td_class' =&gt; $pkg['aop'] ? '' : 'blank', &nbsp;</div></li><li><div>                  'purchase' =&gt; $pkg['purchase'], &nbsp;</div></li><li><div>                  'status' =&gt; $pkg['aop'] ? 'on' : 'rec', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $features;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function action_load_setting_page_reload_default_sharing_styles( $pagehook, $menu_id, $menu_name, $menu_lib ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $opts =& $this-&gt;p-&gt;options;    <span class="comment">// update the existing options array</span>&nbsp;</div></li><li><div>          $def_opts = $this-&gt;p-&gt;opt-&gt;get_defaults();&nbsp;</div></li><li><div>          $tabs = apply_filters( $this-&gt;p-&gt;cf['lca'].'_sharing_styles_tabs', &nbsp;</div></li><li><div>              $this-&gt;p-&gt;cf['sharing']['styles'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $tabs as $id =&gt; $name ) {&nbsp;</div></li><li><div>              if ( isset( $opts['buttons_css_'.$id] ) && isset( $def_opts['buttons_css_'.$id] ) ) {&nbsp;</div></li><li><div>                  $opts['buttons_css_'.$id] = $def_opts['buttons_css_'.$id];&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;update_sharing_css( $opts );&nbsp;</div></li><li><div>          $this-&gt;p-&gt;opt-&gt;save_options( NGFB_OPTIONS_NAME, $opts, false );&nbsp;</div></li><li><div>          $this-&gt;p-&gt;notice-&gt;upd( __( 'All sharing styles have been reloaded with their default value and saved.', &nbsp;</div></li><li><div>              'nextgen-facebook' ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function wp_enqueue_styles() {&nbsp;</div></li><li><div>          if ( ! empty( $this-&gt;p-&gt;options['buttons_use_social_style'] ) ) {&nbsp;</div></li><li><div>              if ( ! file_exists( self::$sharing_css_file ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'updating '.self::$sharing_css_file );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  $this-&gt;update_sharing_css( $this-&gt;p-&gt;options );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( ! empty( $this-&gt;p-&gt;options['buttons_enqueue_social_style'] ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'wp_enqueue_style = '.$this-&gt;p-&gt;cf['lca'].'_sharing_css' );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  wp_enqueue_style( $this-&gt;p-&gt;cf['lca'].'_sharing_css', self::$sharing_css_url, &nbsp;</div></li><li><div>                      false, $this-&gt;p-&gt;cf['plugin'][$this-&gt;p-&gt;cf['lca']]['version'] );&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  if ( ! is_readable( self::$sharing_css_file ) ) {&nbsp;</div></li><li><div>                      if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                          $this-&gt;p-&gt;debug-&gt;log( self::$sharing_css_file.' is not readable' );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      if ( is_admin() ) {&nbsp;</div></li><li><div>                          $this-&gt;p-&gt;notice-&gt;err( sprintf( __( 'The %s file is not readable.', &nbsp;</div></li><li><div>                              'nextgen-facebook' ), self::$sharing_css_file ) );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  } elseif ( ( $fsize = @filesize( self::$sharing_css_file ) ) &gt; 0 &&&nbsp;</div></li><li><div>                      $fh = @fopen( self::$sharing_css_file, 'rb' ) ) {&nbsp;</div></li><li><div>                      echo '&lt;style type=&quot;text/css&quot;&gt;';&nbsp;</div></li><li><div>                      echo fread( $fh, $fsize );&nbsp;</div></li><li><div>                      echo '&lt;/style&gt;', &quot;\n&quot;;&nbsp;</div></li><li><div>                      fclose( $fh );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          } elseif ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'buttons_use_social_style option is disabled' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function update_sharing_css( &$opts ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( $opts['buttons_use_social_style'] ) ) {&nbsp;</div></li><li><div>              $this-&gt;unlink_sharing_css();&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $tabs = apply_filters( $lca.'_sharing_styles_tabs', $this-&gt;p-&gt;cf['sharing']['styles'] );&nbsp;</div></li><li><div>          $sharing_css_data = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $tabs as $id =&gt; $name ) {&nbsp;</div></li><li><div>              if ( isset( $opts['buttons_css_'.$id] ) ) {&nbsp;</div></li><li><div>                  $sharing_css_data .= $opts['buttons_css_'.$id];&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sharing_css_data = SucomUtil::minify_css( $sharing_css_data, $lca );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $fh = @fopen( self::$sharing_css_file, 'wb' ) ) {&nbsp;</div></li><li><div>              if ( ( $written = fwrite( $fh, $sharing_css_data ) ) === false ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'failed writing to '.self::$sharing_css_file );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  if ( is_admin() ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;notice-&gt;err( sprintf( __( 'Failed writing to the % file.', &nbsp;</div></li><li><div>                          'nextgen-facebook' ), self::$sharing_css_file ) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              } elseif ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'updated css file '.self::$sharing_css_file.' ('.$written.' bytes written)' );&nbsp;</div></li><li><div>                  if ( is_admin() ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;notice-&gt;upd( sprintf( __( 'Updated the &lt;a href=&quot;%1$s&quot;&gt;%2$s&lt;/a&gt; stylesheet (%3$d bytes written).', &nbsp;</div></li><li><div>                          'nextgen-facebook' ), self::$sharing_css_url, self::$sharing_css_file, $written ), &nbsp;</div></li><li><div>                              true, 'updated_'.self::$sharing_css_file, true );    <span class="comment">// allow dismiss</span>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              fclose( $fh );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              if ( ! is_writable( NGFB_CACHEDIR ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( NGFB_CACHEDIR.' is not writable', true );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  if ( is_admin() ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;notice-&gt;err( sprintf( __( 'The %s folder is not writable.', &nbsp;</div></li><li><div>                          'nextgen-facebook' ), NGFB_CACHEDIR ) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'failed opening '.self::$sharing_css_file.' for writing' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( is_admin() ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;notice-&gt;err( sprintf( __( 'Failed to open file %s for writing.', &nbsp;</div></li><li><div>                      'nextgen-facebook' ), self::$sharing_css_file ) );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function unlink_sharing_css() {&nbsp;</div></li><li><div>          if ( file_exists( self::$sharing_css_file ) ) {&nbsp;</div></li><li><div>              if ( ! @unlink( self::$sharing_css_file ) ) {&nbsp;</div></li><li><div>                  if ( is_admin() ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;notice-&gt;err( __( 'Error removing the minimized stylesheet &mdash; does the web server have sufficient privileges?', &nbsp;</div></li><li><div>                          'nextgen-facebook' ) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function add_post_buttons_metabox() {&nbsp;</div></li><li><div>          if ( ! is_admin() ) {    <span class="comment"><span class="comment">// just in case</span></span>&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// get the current object / post type</span>&nbsp;</div></li><li><div>          if ( ( $post_obj = SucomUtil::get_post_object() ) === false ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'exiting early: invalid post object' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! empty( $this-&gt;p-&gt;options['buttons_add_to_'.$post_obj-&gt;post_type] ) ) {&nbsp;</div></li><li><div>              <span class="comment">// add_meta_box( $id, $title, $callback, $post_type, $context, $priority, $callback_args );</span>&nbsp;</div></li><li><div>              add_meta_box( '_'.$this-&gt;p-&gt;cf['lca'].'_share', &nbsp;</div></li><li><div>                  _x( 'Sharing Buttons', 'metabox title', 'nextgen-facebook' ), &nbsp;</div></li><li><div>                      array( &$this, 'show_admin_sharing' ), $post_obj-&gt;post_type, 'side', 'high' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function filter_text_filter_begin( $bool, $filter_name ) {&nbsp;</div></li><li><div>          return $this-&gt;remove_buttons_filter( $filter_name ) ? true : $bool;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function filter_text_filter_end( $bool, $filter_name ) {&nbsp;</div></li><li><div>          return $this-&gt;add_buttons_filter( $filter_name ) ? true : $bool;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function show_head() {&nbsp;</div></li><li><div>          echo $this-&gt;get_script_loader();&nbsp;</div></li><li><div>          echo $this-&gt;get_script( 'header' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function show_footer() {&nbsp;</div></li><li><div>          if ( $this-&gt;have_buttons_for_type( 'sidebar' ) )&nbsp;</div></li><li><div>              echo $this-&gt;show_sidebar();&nbsp;</div></li><li><div>          elseif ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'no buttons enabled for sidebar' );&nbsp;</div></li><li><div>          echo $this-&gt;get_script( 'footer' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function show_sidebar() {&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $js = trim( preg_replace( '/\/\*.*\*\<span class="comment">//', '', $this-&gt;p-&gt;options['buttons_js_sidebar'] ) );</span>&nbsp;</div></li><li><div>          $text = $this-&gt;get_buttons( '', 'sidebar', false );    <span class="comment">// $use_post = false</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! empty( $text ) ) {&nbsp;</div></li><li><div>              echo '&lt;div id=&quot;'.$lca.'-sidebar&quot;&gt;';&nbsp;</div></li><li><div>              echo '&lt;div id=&quot;'.$lca.'-sidebar-header&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>              echo $text;&nbsp;</div></li><li><div>              echo '&lt;/div&gt;', &quot;\n&quot;;&nbsp;</div></li><li><div>              echo '&lt;script type=&quot;text/javascript&quot;&gt;'.$js.'&lt;/script&gt;', &quot;\n&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function show_admin_sharing( $post_obj ) {&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $sharing_css_data = $this-&gt;p-&gt;options['buttons_css_admin_edit'];&nbsp;</div></li><li><div>          $sharing_css_data = SucomUtil::minify_css( $sharing_css_data, $lca );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo '&lt;style type=&quot;text/css&quot;&gt;'.$sharing_css_data.'&lt;/style&gt;', &quot;\n&quot;;&nbsp;</div></li><li><div>          echo '&lt;table class=&quot;sucom-settings '.$lca.' post-side-metabox&quot;&gt;&lt;tr&gt;&lt;td&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( get_post_status( $post_obj-&gt;ID ) === 'publish' || $post_obj-&gt;post_type === 'attachment' ) {&nbsp;</div></li><li><div>              echo $this-&gt;get_script_loader();&nbsp;</div></li><li><div>              echo $this-&gt;get_script( 'header' );&nbsp;</div></li><li><div>              echo $this-&gt;get_buttons( '', 'admin_edit' );&nbsp;</div></li><li><div>              echo $this-&gt;get_script( 'footer' );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              echo '&lt;p class=&quot;centered&quot;&gt;'.sprintf( __( '%s must be published&lt;br/&gt;before it can be shared.', &nbsp;</div></li><li><div>                  'nextgen-facebook' ), SucomUtil::titleize( $post_obj-&gt;post_type ) ).'&lt;/p&gt;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo '&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function add_buttons_filter( $filter_name = 'the_content' ) {&nbsp;</div></li><li><div>          $added = false;&nbsp;</div></li><li><div>          if ( method_exists( $this, 'get_buttons_'.$filter_name ) ) {&nbsp;</div></li><li><div>              $added = add_filter( $filter_name, array( &$this, 'get_buttons_'.$filter_name ), NGFB_SOCIAL_PRIORITY );&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'buttons filter '.$filter_name.&nbsp;</div></li><li><div>                      ' added ('.( $added  ? 'true' : 'false' ).')' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          } elseif ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'get_buttons_'.$filter_name.' method is missing' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $added;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function remove_buttons_filter( $filter_name = 'the_content' ) {&nbsp;</div></li><li><div>          $removed = false;&nbsp;</div></li><li><div>          if ( method_exists( $this, 'get_buttons_'.$filter_name ) ) {&nbsp;</div></li><li><div>              $removed = remove_filter( $filter_name, array( &$this, 'get_buttons_'.$filter_name ), NGFB_SOCIAL_PRIORITY );&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'buttons filter '.$filter_name.&nbsp;</div></li><li><div>                      ' removed ('.( $removed  ? 'true' : 'false' ).')' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $removed;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function get_buttons_the_excerpt( $text ) {&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $css_type_name = 'excerpt-buttons';&nbsp;</div></li><li><div>          $text = preg_replace_callback( '/(&lt;!-- '.$lca.' '.$css_type_name.' begin --&gt;'.&nbsp;</div></li><li><div>              '.*&lt;!-- '.$lca.' '.$css_type_name.' end --&gt;)(&lt;\/p&gt;)?/Usi', &nbsp;</div></li><li><div>                  array( __CLASS__, 'remove_paragraph_tags' ), $text );&nbsp;</div></li><li><div>          return $text;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function get_buttons_get_the_excerpt( $text ) {&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $this-&gt;get_buttons( $text, 'excerpt' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function get_buttons_the_content( $text ) {&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $this-&gt;get_buttons( $text, 'content' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// $mod = true | false | post_id | $mod array</span></span></span>&nbsp;</div></li><li><div>      public function get_buttons( $text, $type = 'content', $mod = true, $location = '', $atts = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $error_msg = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( is_admin() ) {&nbsp;</div></li><li><div>              if ( strpos( $type, 'admin_' ) !== 0 ) {&nbsp;</div></li><li><div>                  $error_msg = $type.' ignored in back-end';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          } elseif ( SucomUtil::is_amp() ) {&nbsp;</div></li><li><div>              $error_msg = 'buttons not allowed in amp endpoint';&nbsp;</div></li><li><div>          } elseif ( is_feed() ) {&nbsp;</div></li><li><div>              $error_msg = 'buttons not allowed in rss feeds';&nbsp;</div></li><li><div>          } elseif ( ! is_singular() ) {&nbsp;</div></li><li><div>              if ( empty( $this-&gt;p-&gt;options['buttons_on_index'] ) ) {&nbsp;</div></li><li><div>                  $error_msg = 'buttons_on_index not enabled';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          } elseif ( is_front_page() ) {&nbsp;</div></li><li><div>              if ( empty( $this-&gt;p-&gt;options['buttons_on_front'] ) ) {&nbsp;</div></li><li><div>                  $error_msg = 'buttons_on_front not enabled';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          } elseif ( is_singular() ) {&nbsp;</div></li><li><div>              if ( $this-&gt;is_post_buttons_disabled() ) {&nbsp;</div></li><li><div>                  $error_msg = 'post buttons are disabled';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! $this-&gt;have_buttons_for_type( $type ) ) {&nbsp;</div></li><li><div>              $error_msg = 'no sharing buttons enabled';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $error_msg !== false ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( $type.' filter skipped: '.$error_msg );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              return $text.&quot;\n&quot;.'&lt;!-- '.__METHOD__.' '.$type.' filter skipped: '.$error_msg.' --&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">// $mod is preferred but not required</span></span>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment">// $mod = true | false | post_id | $mod array</span></span></span>&nbsp;</div></li><li><div>          if ( ! is_array( $mod ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'optional call to get_page_mod()' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $mod = $this-&gt;p-&gt;util-&gt;get_page_mod( $mod );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sharing_url = $this-&gt;p-&gt;util-&gt;get_sharing_url( $mod );&nbsp;</div></li><li><div>          $buttons_array = array();&nbsp;</div></li><li><div>          $buttons_index = $this-&gt;get_buttons_cache_index( $type );&nbsp;</div></li><li><div>          $cache_salt = __METHOD__.'('.SucomUtil::get_mod_salt( $mod, $sharing_url ).')';&nbsp;</div></li><li><div>          $cache_id = $lca.'_'.md5( $cache_salt );&nbsp;</div></li><li><div>          $cache_exp = (int) apply_filters( $lca.'_cache_expire_sharing_buttons', &nbsp;</div></li><li><div>              $this-&gt;p-&gt;options['plugin_sharing_buttons_cache_exp'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'sharing url = '.$sharing_url );&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'buttons index = '.$buttons_index );&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'transient expire = '.$cache_exp );&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'transient salt = '.$cache_salt );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $cache_exp &gt; 0 ) {&nbsp;</div></li><li><div>              $buttons_array = get_transient( $cache_id );&nbsp;</div></li><li><div>              if ( isset( $buttons_array[$buttons_index] ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( $type.' buttons index found in array from transient '.$cache_id );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              } elseif ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( $type.' buttons index not in array from transient '.$cache_id );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          } elseif ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( $type.' buttons array transient is disabled' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( $location ) ) {&nbsp;</div></li><li><div>              $location = empty( $this-&gt;p-&gt;options['buttons_pos_'.$type] ) ? &nbsp;</div></li><li><div>                  'bottom' : $this-&gt;p-&gt;options['buttons_pos_'.$type];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! isset( $buttons_array[$buttons_index] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// sort enabled sharing buttons by their preferred order</span>&nbsp;</div></li><li><div>              $sorted_ids = array();&nbsp;</div></li><li><div>              foreach ( $this-&gt;p-&gt;cf['opt']['cm_prefix'] as $id =&gt; $opt_pre ) {&nbsp;</div></li><li><div>                  if ( ! empty( $this-&gt;p-&gt;options[$opt_pre.'_on_'.$type] ) ) {&nbsp;</div></li><li><div>                      $sorted_ids[ zeroise( $this-&gt;p-&gt;options[$opt_pre.'_order'], 3 ).'-'.$id ] = $id;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              ksort( $sorted_ids );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $atts['use_post'] = $mod['use_post'];&nbsp;</div></li><li><div>              $atts['css_id'] = $css_type_name = $type.'-buttons';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $this-&gt;p-&gt;options['buttons_preset_'.$type] ) ) {&nbsp;</div></li><li><div>                  $atts['preset_id'] = $this-&gt;p-&gt;options['buttons_preset_'.$type];&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// returns html or an empty string</span>&nbsp;</div></li><li><div>              $buttons_array[$buttons_index] = $this-&gt;get_html( $sorted_ids, $atts, $mod );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( ! empty( $buttons_array[$buttons_index] ) ) {&nbsp;</div></li><li><div>                  $buttons_array[$buttons_index] = apply_filters( $lca.'_sharing_buttons_html', '&nbsp;</div></li><li><div>&lt;!-- '.$lca.' '.$css_type_name.' begin --&gt;&nbsp;</div></li><li><div>&lt;!-- generated on '.date( 'c' ).' --&gt;&nbsp;</div></li><li><div>&lt;div '.( $mod['use_post'] ? 'class=&quot;'.$lca.'-'.$css_type_name.'&quot;' : 'id=&quot;'.$lca.'-'.$css_type_name.'&quot;' ).'&gt;'.&quot;\n&quot;.&nbsp;</div></li><li><div>$buttons_array[$buttons_index].&nbsp;</div></li><li><div>'&lt;/div&gt;&lt;!-- '.( $mod['use_post'] ? '.' : '#' ).$lca.'-'.$css_type_name.' --&gt;&nbsp;</div></li><li><div>&lt;!-- '.$lca.' '.$css_type_name.' end --&gt;'.&quot;\n\n&quot;, $type, $mod, $location, $atts );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( $cache_exp &gt; 0 ) {&nbsp;</div></li><li><div>                      <span class="comment">// update the transient array and keep the original expiration time</span>&nbsp;</div></li><li><div>                      $cache_exp = SucomUtil::update_transient_array( $cache_id, $buttons_array, $cache_exp );&nbsp;</div></li><li><div>                      if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                          $this-&gt;p-&gt;debug-&gt;log( $type.' buttons html saved to transient '.&nbsp;</div></li><li><div>                              $cache_id.' ('.$cache_exp.' seconds)' );&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          switch ( $location ) {&nbsp;</div></li><li><div>              case 'top': &nbsp;</div></li><li><div>                  $text = $buttons_array[$buttons_index].$text; &nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'bottom': &nbsp;</div></li><li><div>                  $text = $text.$buttons_array[$buttons_index]; &nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'both': &nbsp;</div></li><li><div>                  $text = $buttons_array[$buttons_index].$text.$buttons_array[$buttons_index]; &nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $text;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function get_buttons_cache_index( $type, $atts = false, $ids = false ) {&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return 'locale:'.SucomUtil::get_locale( 'current' ).&nbsp;</div></li><li><div>              '_type:'.( empty( $type ) ? 'none' : $type ).&nbsp;</div></li><li><div>              '_https:'.( SucomUtil::is_https() ? 'true' : 'false' ).&nbsp;</div></li><li><div>              ( $this-&gt;p-&gt;avail['*']['vary_ua'] ? '_mobile:'.( SucomUtil::is_mobile() ? 'true' : 'false' ) : '' ).&nbsp;</div></li><li><div>              ( $atts !== false ? '_atts:'.http_build_query( $atts, '', '_' ) : '' ).&nbsp;</div></li><li><div>              ( $ids !== false ? '_ids:'.http_build_query( $ids, '', '_' ) : '' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// get_html() is called by the widget, shortcode, function, and perhaps some filter hooks</span>&nbsp;</div></li><li><div>      public function get_html( array $ids, array $atts, $mod = false ) {&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $atts['use_post'] = isset( $atts['use_post'] ) ? $atts['use_post'] : true;    <span class="comment">// maintain backwards compat</span>&nbsp;</div></li><li><div>          $atts['add_page'] = isset( $atts['add_page'] ) ? $atts['add_page'] : true;    <span class="comment"><span class="comment">// used by get_sharing_url()</span></span>&nbsp;</div></li><li><div>          $atts['preset_id'] = isset( $atts['preset_id'] ) ? SucomUtil::sanitize_key( $atts['preset_id'] ) : '';&nbsp;</div></li><li><div>          $atts['filter_id'] = isset( $atts['filter_id'] ) ? SucomUtil::sanitize_key( $atts['filter_id'] ) : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">// $mod is preferred but not required</span></span>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment">// $mod = true | false | post_id | $mod array</span></span></span>&nbsp;</div></li><li><div>          if ( ! is_array( $mod ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'optional call to get_page_mod()' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $mod = $this-&gt;p-&gt;util-&gt;get_page_mod( $atts['use_post'] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $buttons_html = '';&nbsp;</div></li><li><div>          $buttons_begin = ( empty( $atts['preset_id'] ) ? '' : '&lt;div class=&quot;ngfb-preset-'.$atts['preset_id'].'&quot;&gt;'.&quot;\n&quot; ).&nbsp;</div></li><li><div>              '&lt;div class=&quot;ngfb-buttons '.SucomUtil::get_locale( $mod ).'&quot;&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>          $buttons_end = '&lt;/div&gt;&lt;!-- .ngfb-buttons.'.SucomUtil::get_locale( $mod ).' --&gt;'.&quot;\n&quot;.&nbsp;</div></li><li><div>              ( empty( $atts['preset_id'] ) ? '' : '&lt;/div&gt;&lt;!-- .ngfb-preset-'.$atts['preset_id'].' --&gt;'.&quot;\n&quot; );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// possibly dereference the opts variable to prevent passing on changes</span>&nbsp;</div></li><li><div>          if ( empty( $atts['preset_id'] ) && empty( $atts['filter_id'] ) )&nbsp;</div></li><li><div>              $custom_opts =& $this-&gt;p-&gt;options;&nbsp;</div></li><li><div>          else $custom_opts = $this-&gt;p-&gt;options;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// apply the presets to $custom_opts</span>&nbsp;</div></li><li><div>          if ( ! empty( $atts['preset_id'] ) && ! empty( $this-&gt;p-&gt;cf['opt']['preset'] ) ) {&nbsp;</div></li><li><div>              if ( isset( $this-&gt;p-&gt;cf['opt']['preset'][$atts['preset_id']] ) &&&nbsp;</div></li><li><div>                  is_array( $this-&gt;p-&gt;cf['opt']['preset'][$atts['preset_id']] ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'applying preset_id '.$atts['preset_id'].' to options' );&nbsp;</div></li><li><div>                  $custom_opts = array_merge( $custom_opts, $this-&gt;p-&gt;cf['opt']['preset'][$atts['preset_id']] );&nbsp;</div></li><li><div>              } elseif ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( $atts['preset_id'].' preset_id missing or not array' );&nbsp;</div></li><li><div>          } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// apply the filter_id if the filter name has hooks</span>&nbsp;</div></li><li><div>          if ( ! empty( $atts['filter_id'] ) ) {&nbsp;</div></li><li><div>              $filter_name = $lca.'_sharing_html_'.$atts['filter_id'].'_options';&nbsp;</div></li><li><div>              if ( has_filter( $filter_name ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'applying filter_id '.$atts['filter_id'].' to options ('.$filter_name.')' );&nbsp;</div></li><li><div>                  $custom_opts = apply_filters( $filter_name, $custom_opts );&nbsp;</div></li><li><div>              } elseif ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'no filter(s) found for '.$filter_name );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $saved_atts = $atts;&nbsp;</div></li><li><div>          foreach ( $ids as $id ) {&nbsp;</div></li><li><div>              if ( isset( $this-&gt;website[$id] ) ) {&nbsp;</div></li><li><div>                  if ( method_exists( $this-&gt;website[$id], 'get_html' ) ) {&nbsp;</div></li><li><div>                      if ( $this-&gt;allow_for_platform( $id ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $atts['src_id'] = SucomUtil::get_atts_src_id( $atts, $id );    <span class="comment">// uses 'css_id' and 'use_post'</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $atts['url'] = empty( $atts['url'] ) ?                 <span class="comment">// used by get_inline_vals()</span>&nbsp;</div></li><li><div>                              $this-&gt;p-&gt;util-&gt;get_sharing_url( $mod, &nbsp;</div></li><li><div>                                  $atts['add_page'], $atts['src_id'] ) : &nbsp;</div></li><li><div>                              apply_filters( $lca.'_sharing_url', $atts['url'], &nbsp;</div></li><li><div>                                  $mod, $atts['add_page'], $atts['src_id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $force_prot = apply_filters( $lca.'_sharing_buttons_force_prot', &nbsp;</div></li><li><div>                              $this-&gt;p-&gt;options['buttons_force_prot'], $mod, $atts['url'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          if ( ! empty( $force_prot ) && $force_prot !== 'none' ) {&nbsp;</div></li><li><div>                              $atts['url'] = preg_replace( '/^.*:\/\<span class="comment">//', $force_prot.'://', $atts['url'] );</span>&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $buttons_html .= $this-&gt;website[$id]-&gt;get_html( $atts, $custom_opts, $mod ).&quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $atts = $saved_atts;    <span class="comment">// restore the common $atts array</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      } elseif ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                          $this-&gt;p-&gt;debug-&gt;log( $id.' not allowed for platform' );&nbsp;</div></li><li><div>                  } elseif ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'get_html method missing for '.$id );&nbsp;</div></li><li><div>              } elseif ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'website object missing for '.$id );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $buttons_html = trim( $buttons_html );&nbsp;</div></li><li><div>          return empty( $buttons_html ) ? '' :&nbsp;</div></li><li><div>              $buttons_begin.$buttons_html.$buttons_end;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// add javascript for enabled buttons in content, widget, shortcode, etc.</span>&nbsp;</div></li><li><div>      public function get_script( $pos = 'header', $request_ids = array() ) {&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;mark();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $enabled_ids = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// there are no widgets on the admin back-end, so don't bother checking</span>&nbsp;</div></li><li><div>          if ( ! is_admin() ) {&nbsp;</div></li><li><div>              if ( class_exists( 'NgfbWidgetSharing' ) ) {&nbsp;</div></li><li><div>                  $widget = new NgfbWidgetSharing();&nbsp;</div></li><li><div>                   $widget_settings = $widget-&gt;get_settings();&nbsp;</div></li><li><div>              } else $widget_settings = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// check for enabled buttons in ACTIVE widget(s)</span>&nbsp;</div></li><li><div>              foreach ( $widget_settings as $num =&gt; $instance ) {&nbsp;</div></li><li><div>                  if ( is_object( $widget ) && is_active_widget( false, &nbsp;</div></li><li><div>                      $widget-&gt;id_base.'-'.$num, $widget-&gt;id_base ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      foreach ( $this-&gt;p-&gt;cf['opt']['cm_prefix'] as $id =&gt; $opt_pre ) {&nbsp;</div></li><li><div>                          if ( array_key_exists( $id, $instance ) && &nbsp;</div></li><li><div>                              ! empty( $instance[$id] ) )&nbsp;</div></li><li><div>                                  $enabled_ids[] = $id;&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'enabled widget ids: '.&nbsp;</div></li><li><div>                      SucomDebug::pretty_array( $enabled_ids, true ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $exit_message = false;&nbsp;</div></li><li><div>          if ( is_admin() ) {&nbsp;</div></li><li><div>              if ( ( $post_obj = SucomUtil::get_post_object() ) === false ||&nbsp;</div></li><li><div>                  ( get_post_status( $post_obj-&gt;ID ) !== 'publish' && $post_obj-&gt;post_type !== 'attachment' ) )&nbsp;</div></li><li><div>                      $exit_message = 'must be published or attachment for admin buttons';&nbsp;</div></li><li><div>          } elseif ( ! is_singular() ) {&nbsp;</div></li><li><div>              if ( empty( $this-&gt;p-&gt;options['buttons_on_index'] ) )&nbsp;</div></li><li><div>                  $exit_message = 'buttons_on_index not enabled';&nbsp;</div></li><li><div>          } elseif ( is_front_page() ) {&nbsp;</div></li><li><div>              if ( empty( $this-&gt;p-&gt;options['buttons_on_front'] ) )&nbsp;</div></li><li><div>                  $exit_message = 'buttons_on_front not enabled';&nbsp;</div></li><li><div>          } elseif ( is_singular() ) {&nbsp;</div></li><li><div>              if ( $this-&gt;is_post_buttons_disabled() )&nbsp;</div></li><li><div>                  $exit_message = 'post buttons are disabled';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $exit_message ) {&nbsp;</div></li><li><div>              if ( empty( $request_ids ) && empty( $enabled_ids ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'exiting early: '.$exit_message );&nbsp;</div></li><li><div>                  return '&lt;!-- '.$this-&gt;p-&gt;cf['lca'].' '.$pos.': '.$exit_message.' --&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              } elseif ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'ignoring exit message: have requested or enabled ids' );&nbsp;</div></li><li><div>          } elseif ( is_admin() ) {&nbsp;</div></li><li><div>              foreach ( $this-&gt;p-&gt;cf['opt']['cm_prefix'] as $id =&gt; $opt_pre ) {&nbsp;</div></li><li><div>                  foreach ( SucomUtil::preg_grep_keys( '/^'.$opt_pre.'_on_admin_/', $this-&gt;p-&gt;options ) as $key =&gt; $val ) {&nbsp;</div></li><li><div>                      if ( ! empty( $val ) )&nbsp;</div></li><li><div>                          $enabled_ids[] = $id;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              foreach ( $this-&gt;p-&gt;cf['opt']['cm_prefix'] as $id =&gt; $opt_pre ) {&nbsp;</div></li><li><div>                  foreach ( SucomUtil::preg_grep_keys( '/^'.$opt_pre.'_on_/', $this-&gt;p-&gt;options ) as $key =&gt; $val ) {&nbsp;</div></li><li><div>                      <span class="comment">// exclude buttons enabled for admin editing pages</span>&nbsp;</div></li><li><div>                      if ( strpos( $key, $opt_pre.'_on_admin_' ) === false && ! empty( $val ) )&nbsp;</div></li><li><div>                          $enabled_ids[] = $id;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( $request_ids ) ) {&nbsp;</div></li><li><div>              if ( empty( $enabled_ids ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'exiting early: no buttons enabled or requested' );&nbsp;</div></li><li><div>                  return '&lt;!-- ngfb '.$pos.': no buttons enabled or requested --&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              } else $include_ids = $enabled_ids;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $include_ids = array_diff( $request_ids, $enabled_ids );&nbsp;</div></li><li><div>              if ( empty( $include_ids ) ) {&nbsp;</div></li><li><div>                  if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                      $this-&gt;p-&gt;debug-&gt;log( 'exiting early: no scripts after removing enabled buttons' );&nbsp;</div></li><li><div>                  return '&lt;!-- ngfb '.$pos.': no scripts after removing enabled buttons --&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          natsort( $include_ids );&nbsp;</div></li><li><div>          $include_ids = array_unique( $include_ids );&nbsp;</div></li><li><div>          $script_html = '&lt;!-- ngfb '.$pos.' javascript begin --&gt;'.&quot;\n&quot;.&nbsp;</div></li><li><div>              '&lt;!-- generated on '.date( 'c' ).' --&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( strpos( $pos, '-header' ) ) &nbsp;</div></li><li><div>              $script_loc = 'header';&nbsp;</div></li><li><div>          elseif ( strpos( $pos, '-footer' ) ) &nbsp;</div></li><li><div>              $script_loc = 'footer';&nbsp;</div></li><li><div>          else $script_loc = $pos;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ! empty( $include_ids ) ) {&nbsp;</div></li><li><div>              foreach ( $include_ids as $id ) {&nbsp;</div></li><li><div>                  $id = preg_replace( '/[^a-z]/', '', $id );&nbsp;</div></li><li><div>                  $opt_name = $this-&gt;p-&gt;cf['opt']['cm_prefix'][$id].'_script_loc';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if ( isset( $this-&gt;website[$id] ) &&&nbsp;</div></li><li><div>                      method_exists( $this-&gt;website[$id], 'get_script' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if ( isset( $this-&gt;p-&gt;options[$opt_name] ) && &nbsp;</div></li><li><div>                          $this-&gt;p-&gt;options[$opt_name] === $script_loc )&nbsp;</div></li><li><div>                              $script_html .= $this-&gt;website[$id]-&gt;get_script( $pos ).&quot;\n&quot;;&nbsp;</div></li><li><div>                      else $script_html .= '&lt;!-- ngfb '.$pos.': '.$id.' script location is '.$this-&gt;p-&gt;options[$opt_name].' --&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $script_html .= '&lt;!-- ngfb '.$pos.' javascript end --&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $script_html;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function get_script_loader( $pos = 'id' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $lang = empty( $this-&gt;p-&gt;options['gp_lang'] ) ? 'en-US' : $this-&gt;p-&gt;options['gp_lang'];&nbsp;</div></li><li><div>          $lang = apply_filters( $this-&gt;p-&gt;cf['lca'].'_pub_lang', $lang, 'google', 'current' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return '&lt;script type=&quot;text/javascript&quot; id=&quot;ngfb-header-script&quot;&gt;&nbsp;</div></li><li><div>  window.___gcfg = { lang: &quot;'.$lang.'&quot; };&nbsp;</div></li><li><div>  function '.$this-&gt;p-&gt;cf['lca'].'_insert_js( script_id, url, async ) {&nbsp;</div></li><li><div>      if ( document.getElementById( script_id + &quot;-js&quot; ) ) return;&nbsp;</div></li><li><div>      var async = typeof async !== &quot;undefined&quot; ? async : true;&nbsp;</div></li><li><div>      var script_pos = document.getElementById( script_id );&nbsp;</div></li><li><div>      var js = document.createElement( &quot;script&quot; );&nbsp;</div></li><li><div>      js.id = script_id + &quot;-js&quot;;&nbsp;</div></li><li><div>      js.async = async;&nbsp;</div></li><li><div>      js.type = &quot;text/javascript&quot;;&nbsp;</div></li><li><div>      js.language = &quot;JavaScript&quot;;&nbsp;</div></li><li><div>      js.src = url;&nbsp;</div></li><li><div>      script_pos.parentNode.insertBefore( js, script_pos );&nbsp;</div></li><li><div>  };&nbsp;</div></li><li><div>&lt;/script&gt;'.&quot;\n&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function have_buttons_for_type( $type ) {&nbsp;</div></li><li><div>          if ( isset( $this-&gt;buttons_for_type[$type] ) ) {&nbsp;</div></li><li><div>              return $this-&gt;buttons_for_type[$type];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $this-&gt;p-&gt;cf['opt']['cm_prefix'] as $id =&gt; $opt_pre ) {&nbsp;</div></li><li><div>              if ( ! empty( $this-&gt;p-&gt;options[$opt_pre.'_on_'.$type] ) &&    <span class="comment">// check if button is enabled</span>&nbsp;</div></li><li><div>                  $this-&gt;allow_for_platform( $id ) )            <span class="comment">// check if allowed on platform</span>&nbsp;</div></li><li><div>                      return $this-&gt;buttons_for_type[$type] = true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $this-&gt;buttons_for_type[$type] = false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function allow_for_platform( $id ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// always allow if the content does not vary by user agent</span>&nbsp;</div></li><li><div>          if ( ! $this-&gt;p-&gt;avail['*']['vary_ua'] ) {&nbsp;</div></li><li><div>              return true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $opt_pre = isset( $this-&gt;p-&gt;cf['opt']['cm_prefix'][$id] ) ?&nbsp;</div></li><li><div>              $this-&gt;p-&gt;cf['opt']['cm_prefix'][$id] : $id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( isset( $this-&gt;p-&gt;options[$opt_pre.'_platform'] ) ) {&nbsp;</div></li><li><div>              switch( $this-&gt;p-&gt;options[$opt_pre.'_platform'] ) {&nbsp;</div></li><li><div>                  case 'any':&nbsp;</div></li><li><div>                      return true;&nbsp;</div></li><li><div>                  case 'desktop':&nbsp;</div></li><li><div>                      return SucomUtil::is_desktop();&nbsp;</div></li><li><div>                  case 'mobile':&nbsp;</div></li><li><div>                      return SucomUtil::is_mobile();&nbsp;</div></li><li><div>                  default:&nbsp;</div></li><li><div>                      return true;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function is_post_buttons_disabled() {&nbsp;</div></li><li><div>          $ret = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ( $post_obj = SucomUtil::get_post_object() ) === false ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'exiting early: invalid post object' );&nbsp;</div></li><li><div>              return $ret;&nbsp;</div></li><li><div>          } else $post_id = empty( $post_obj-&gt;ID ) ? 0 : $post_obj-&gt;ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( $post_id ) )&nbsp;</div></li><li><div>              return $ret;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( isset( $this-&gt;post_buttons_disabled[$post_id] ) )&nbsp;</div></li><li><div>              return $this-&gt;post_buttons_disabled[$post_id];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// get_options() returns null if an index key is not found</span>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;m['util']['post']-&gt;get_options( $post_id, 'buttons_disabled' ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'post '.$post_id.': sharing buttons disabled by meta data option' );&nbsp;</div></li><li><div>              $ret = true;&nbsp;</div></li><li><div>          } elseif ( ! empty( $post_obj-&gt;post_type ) && &nbsp;</div></li><li><div>              empty( $this-&gt;p-&gt;options['buttons_add_to_'.$post_obj-&gt;post_type] ) ) {&nbsp;</div></li><li><div>              if ( $this-&gt;p-&gt;debug-&gt;enabled )&nbsp;</div></li><li><div>                  $this-&gt;p-&gt;debug-&gt;log( 'post '.$post_id.': sharing buttons not enabled for post type '.$post_obj-&gt;post_type );&nbsp;</div></li><li><div>              $ret = true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $this-&gt;post_buttons_disabled[$post_id] = apply_filters( $this-&gt;p-&gt;cf['lca'].'_post_buttons_disabled', $ret, $post_id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function remove_paragraph_tags( $match = array() ) {&nbsp;</div></li><li><div>          if ( empty( $match ) || ! is_array( $match ) ) return;&nbsp;</div></li><li><div>          $text = empty( $match[1] ) ? '' : $match[1];&nbsp;</div></li><li><div>          $suff = empty( $match[2] ) ? '' : $match[2];&nbsp;</div></li><li><div>          $ret = preg_replace( '/(&lt;\/*[pP]&gt;|\n)/', '', $text );&nbsp;</div></li><li><div>          return $suff.$ret; &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function get_website_object_ids( $website = array() ) {&nbsp;</div></li><li><div>          $website_ids = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( $website ) ) {&nbsp;</div></li><li><div>              $keys = array_keys( $this-&gt;website );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $keys = array_keys( $website );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $website_lib = $this-&gt;p-&gt;cf['plugin']['ngfb']['lib']['website'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $keys as $id ) {&nbsp;</div></li><li><div>              $website_ids[$id] = isset( $website_lib[$id] ) ?&nbsp;</div></li><li><div>                  $website_lib[$id] : ucfirst( $id );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $website_ids;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function get_tweet_text( array $mod, $atts = array(), $opt_pre = 'twitter', $md_pre = 'twitter' ) {&nbsp;</div></li><li><div>          if ( ! isset( $atts['tweet'] ) ) {    <span class="comment"><span class="comment">// just in case</span></span>&nbsp;</div></li><li><div>              $atts['use_post'] = isset( $atts['use_post'] ) ? $atts['use_post'] : true;&nbsp;</div></li><li><div>              $atts['add_page'] = isset( $atts['add_page'] ) ? $atts['add_page'] : true;    <span class="comment"><span class="comment">// used by get_sharing_url()</span></span>&nbsp;</div></li><li><div>              $atts['add_hashtags'] = isset( $atts['add_hashtags'] ) ? $atts['add_hashtags'] : true;&nbsp;</div></li><li><div>              return $this-&gt;p-&gt;page-&gt;get_caption( ( empty( $this-&gt;p-&gt;options[$opt_pre.'_caption'] ) ?&nbsp;</div></li><li><div>                  'title' : $this-&gt;p-&gt;options[$opt_pre.'_caption'] ), $this-&gt;get_tweet_max_len( $opt_pre ), &nbsp;</div></li><li><div>                      $mod, true, $atts['add_hashtags'], false, $md_pre.'_desc' );&nbsp;</div></li><li><div>          } else return $atts['tweet'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// $opt_pre can be twitter, buffer, etc.</span>&nbsp;</div></li><li><div>      public function get_tweet_max_len( $opt_pre = 'twitter' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $short_len = 23;    <span class="comment">// twitter counts 23 characters for any url</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( isset( $this-&gt;p-&gt;options['tc_site'] ) && ! empty( $this-&gt;p-&gt;options[$opt_pre.'_via'] ) ) {&nbsp;</div></li><li><div>              $tc_site = preg_replace( '/^@/', '', $this-&gt;p-&gt;options['tc_site'] );&nbsp;</div></li><li><div>              $site_len = empty( $tc_site ) ? 0 : strlen( $tc_site ) + 6;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $site_len = 0;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $max_len = $this-&gt;p-&gt;options[$opt_pre.'_cap_len'] - $site_len - $short_len;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;p-&gt;debug-&gt;enabled ) {&nbsp;</div></li><li><div>              $this-&gt;p-&gt;debug-&gt;log( 'max tweet length is '.$max_len.' chars ('.$this-&gt;p-&gt;options[$opt_pre.'_cap_len'].&nbsp;</div></li><li><div>                  ' less '.$site_len.' for site name and '.$short_len.' for url)' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $max_len;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function get_social_file_cache_url( $url, $url_ext = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $lca = $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $cache_exp = (int) apply_filters( $lca.'_cache_expire_social_file', &nbsp;</div></li><li><div>              $this-&gt;p-&gt;options['plugin_social_file_cache_exp'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $cache_exp &gt; 0 && isset( $this-&gt;p-&gt;cache-&gt;base_dir ) ) {&nbsp;</div></li><li><div>              $url = $this-&gt;p-&gt;cache-&gt;get( $url, 'url', 'file', $cache_exp, false, $url_ext );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return apply_filters( $lca.'_rewrite_cache_url', $url );    <span class="comment">// social file cache url</span>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function filter_messages_tooltip( $text, $idx ) {&nbsp;</div></li><li><div>          if ( strpos( $idx, 'tooltip-buttons_' ) !== 0 ) {&nbsp;</div></li><li><div>              return $text;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          switch ( $idx ) {&nbsp;</div></li><li><div>              case ( strpos( $idx, 'tooltip-buttons_pos_' ) === false ? false : true ):&nbsp;</div></li><li><div>                  $text = sprintf( __( 'Social sharing buttons can be added to the top, bottom, or both. Each sharing button must also be enabled below (see the &lt;em&gt;%s&lt;/em&gt; options).', 'nextgen-facebook' ), _x( 'Show Button in', 'option label', 'nextgen-facebook' ) );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'tooltip-buttons_on_index':&nbsp;</div></li><li><div>                  $text = __( 'Add the social sharing buttons to each entry of an index webpage (blog front page, category, archive, etc.). Social sharing buttons are not included on index webpages by default.', 'nextgen-facebook' );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'tooltip-buttons_on_front':&nbsp;</div></li><li><div>                  $text = __( 'If a static Post or Page has been selected for the front page, you can add the social sharing buttons to that static front page as well (default is unchecked).', 'nextgen-facebook' );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'tooltip-buttons_add_to':&nbsp;</div></li><li><div>                  $text = __( 'Enabled social sharing buttons are added to the Post, Page, Media, and Product webpages by default. If your theme (or another plugin) supports additional custom post types, and you would like to include social sharing buttons on these webpages, check the appropriate option(s) here.', 'nextgen-facebook' );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'tooltip-buttons_preset':&nbsp;</div></li><li><div>                  $text = __( 'Select a pre-defined set of option values for sharing buttons in this location.', 'nextgen-facebook' );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'tooltip-buttons_force_prot':&nbsp;</div></li><li><div>                  $text = __( 'Modify URLs shared by the sharing buttons to use a specific protocol. This option can be useful to retain the share count of HTTP URLs after moving your site to HTTPS.', 'nextgen-facebook' );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'tooltip-buttons_use_social_style':&nbsp;</div></li><li><div>                  $text = sprintf( __( 'Add the CSS of all &lt;em&gt;%1$s&lt;/em&gt; to webpages (default is checked). The CSS will be &lt;strong&gt;minimized&lt;/strong&gt;, and saved to a single stylesheet with a URL of &lt;a href=&quot;%2$s&quot;&gt;%3$s&lt;/a&gt;. The minimized stylesheet can be enqueued or added directly to the webpage HTML.', 'nextgen-facebook' ), _x( 'Sharing Styles', 'lib file description', 'nextgen-facebook' ), NgfbSharing::$sharing_css_url, NgfbSharing::$sharing_css_url );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'tooltip-buttons_enqueue_social_style':&nbsp;</div></li><li><div>                  $text = __( 'Have WordPress enqueue the social stylesheet instead of adding the CSS to in the webpage HTML (default is unchecked). Enqueueing the stylesheet may be desirable if you use a plugin to concatenate all enqueued styles into a single stylesheet URL.', 'nextgen-facebook' );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'tooltip-buttons_js_sidebar':&nbsp;</div></li><li><div>                  $text = __( 'JavaScript added to webpages for the social sharing sidebar.' );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'tooltip-buttons_add_via':&nbsp;</div></li><li><div>                  $text = sprintf( __( 'Append the %1$s to the tweet (see &lt;a href=&quot;%2$s&quot;&gt;the Twitter options tab&lt;/a&gt; in the %3$s settings page). The %1$s will be displayed and recommended after the webpage is shared.', 'nextgen-facebook' ), _x( 'Twitter Business @username', 'option label', 'nextgen-facebook' ), $this-&gt;p-&gt;util-&gt;get_admin_url( 'general#sucom-tabset_pub-tab_twitter' ), _x( 'General', 'lib file description', 'nextgen-facebook' ) );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'tooltip-buttons_rec_author':&nbsp;</div></li><li><div>                  $text = sprintf( __( 'Recommend following the author\'s Twitter @username after sharing a webpage. If the %1$s option (above) is also checked, the %2$s is suggested first.', 'nextgen-facebook' ), _x( 'Add via @username', 'option label (short)', 'nextgen-facebook' ), _x( 'Twitter Business @username', 'option label', 'nextgen-facebook' ) );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $text;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function filter_messages_tooltip_plugin( $text, $idx ) {&nbsp;</div></li><li><div>          switch ( $idx ) {&nbsp;</div></li><li><div>              case 'tooltip-plugin_sharing_buttons_cache_exp':&nbsp;</div></li><li><div>                  $cache_exp = NgfbSharing::$cf['opt']['defaults']['plugin_sharing_buttons_cache_exp'];    <span class="comment"><span class="comment">// use original un-filtered value</span></span>&nbsp;</div></li><li><div>                  $cache_diff = $cache_exp ? human_time_diff( 0, $cache_exp ) : _x( 'disabled', 'option comment', 'nextgen-facebook' );&nbsp;</div></li><li><div>                  $text = __( 'The rendered HTML for social sharing buttons is saved to the WordPress transient cache to optimize performance.', &nbsp;</div></li><li><div>                      'nextgen-facebook' ).' '.sprintf( __( 'The suggested cache expiration value is %1$s seconds (%2$s).', &nbsp;</div></li><li><div>                          'nextgen-facebook' ), $cache_exp, $cache_diff );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'tooltip-plugin_social_file_cache_exp':&nbsp;</div></li><li><div>                  $cache_exp = NgfbSharing::$cf['opt']['defaults']['plugin_social_file_cache_exp'];    <span class="comment"><span class="comment">// use original un-filtered value</span></span>&nbsp;</div></li><li><div>                  $cache_diff = $cache_exp ? human_time_diff( 0, $cache_exp ) : _x( 'disabled', 'option comment', 'nextgen-facebook' );&nbsp;</div></li><li><div>                  $text = __( 'The JavaScript of most social sharing buttons can be saved locally to cache folder in order to provide cached URLs instead of the originals.', 'nextgen-facebook' ).' '.__( 'If your hosting infrastructure performs reasonably well, this option can improve page load times significantly.', 'nextgen-facebook' ).' '.sprintf( __( 'The suggested cache expiration value is %1$s seconds (%2$s).', 'nextgen-facebook' ), $cache_exp, $cache_diff );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $text;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function filter_messages_info( $text, $idx ) {&nbsp;</div></li><li><div>          if ( strpos( $idx, 'info-styles-' ) !== 0 )&nbsp;</div></li><li><div>              return $text;&nbsp;</div></li><li><div>          $lca =  $this-&gt;p-&gt;cf['lca'];&nbsp;</div></li><li><div>          $short = $this-&gt;p-&gt;cf['plugin'][$lca]['short'];&nbsp;</div></li><li><div>          switch ( $idx ) {&nbsp;</div></li><li><div>              case 'info-styles-sharing':&nbsp;</div></li><li><div>                  $notes_url = $this-&gt;p-&gt;cf['plugin'][$lca]['url']['notes'];&nbsp;</div></li><li><div>                  $text = '&lt;p&gt;'.$short.' uses the \''.$lca.'-buttons\' class to wrap all its sharing buttons, and each button has it\'s own individual class name as well. Refer to the &lt;a href=&quot;'.$notes_url.'&quot; target=&quot;_blank&quot;&gt;Notes&lt;/a&gt; webpage for additional stylesheet information, including how to hide the sharing buttons for specific Posts, Pages, categories, tags, etc.&lt;/p&gt;';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'info-styles-content':&nbsp;</div></li><li><div>                  $text = '&lt;p&gt;Social sharing buttons, enabled / added to the content text from the '.$this-&gt;p-&gt;util-&gt;get_admin_url( 'buttons', 'Sharing Buttons' ).' settings page, are assigned the \''.$lca.'-content-buttons\' class, which itself contains the \''.$lca.'-buttons\' class -- a common class for all buttons (see the All Buttons tab).&lt;/p&gt; &nbsp;</div></li><li><div>                  &lt;p&gt;Example:&lt;/p&gt;&lt;pre&gt;&nbsp;</div></li><li><div>.'.$lca.'-content-buttons &nbsp;</div></li><li><div>  .'.$lca.'-buttons&nbsp;</div></li><li><div>      .facebook-button { }&lt;/pre&gt;';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'info-styles-excerpt':&nbsp;</div></li><li><div>                  $text = '&lt;p&gt;Social sharing buttons, enabled / added to the excerpt text from the '.$this-&gt;p-&gt;util-&gt;get_admin_url( 'buttons', 'Sharing Buttons' ).' settings page, are assigned the \''.$lca.'-excerpt-buttons\' class, which itself contains the \''.$lca.'-buttons\' class -- a common class for all buttons (see the All Buttons tab).&lt;/p&gt; &nbsp;</div></li><li><div>                  &lt;p&gt;Example:&lt;/p&gt;&lt;pre&gt;&nbsp;</div></li><li><div>.'.$lca.'-excerpt-buttons &nbsp;</div></li><li><div>  .'.$lca.'-buttons&nbsp;</div></li><li><div>      .facebook-button { }&lt;/pre&gt;';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'info-styles-sidebar':&nbsp;</div></li><li><div>                  $text = '&lt;p&gt;Social sharing buttons added to the sidebar are assigned the \'#'.$lca.'-sidebar\' CSS id, which itself contains \'#'.$lca.'-sidebar-header\', \'#'.$lca.'-sidebar-buttons\' and the \''.$lca.'-buttons\' class -- a common class for all buttons (see the All Buttons tab).&lt;/p&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;Example:&lt;/p&gt;&lt;pre&gt;&nbsp;</div></li><li><div>#'.$lca.'-sidebar&nbsp;</div></li><li><div>  #'.$lca.'-sidebar-header { }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>#'.$lca.'-sidebar&nbsp;</div></li><li><div>  #'.$lca.'-sidebar-buttons&nbsp;</div></li><li><div>      .'.$lca.'-buttons&nbsp;</div></li><li><div>      .facebook-button { }&lt;/pre&gt;';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'info-styles-shortcode':&nbsp;</div></li><li><div>                  $text = '&lt;p&gt;Social sharing buttons added from a shortcode are assigned the \''.$lca.'-shortcode-buttons\' class, which itself contains the \''.$lca.'-buttons\' class -- a common class for all buttons (see the All Buttons tab).&lt;/p&gt; &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  &lt;p&gt;Example:&lt;/p&gt;&lt;pre&gt;&nbsp;</div></li><li><div>.'.$lca.'-shortcode-buttons &nbsp;</div></li><li><div>  .'.$lca.'-buttons&nbsp;</div></li><li><div>      .facebook-button { }&lt;/pre&gt;';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'info-styles-widget':&nbsp;</div></li><li><div>                  $text = '&lt;p&gt;Social sharing buttons within the social sharing buttons widget are assigned the \''.$lca.'-widget-buttons\' class, which itself contains the \''.$lca.'-buttons\' class -- a common class for all buttons (see the All Buttons tab).&lt;/p&gt; &nbsp;</div></li><li><div>                  &lt;p&gt;Example:&lt;/p&gt;&lt;pre&gt;&nbsp;</div></li><li><div>.'.$lca.'-widget-buttons &nbsp;</div></li><li><div>  .'.$lca.'-buttons&nbsp;</div></li><li><div>      .facebook-button { }&lt;/pre&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;The social sharing buttons widget also has an id of \''.$lca.'-widget-buttons-&lt;em&gt;#&lt;/em&gt;\', and the buttons have an id of \'&lt;em&gt;name&lt;/em&gt;-'.$lca.'-widget-buttons-&lt;em&gt;#&lt;/em&gt;\'.&lt;/p&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;Example:&lt;/p&gt;&lt;pre&gt;&nbsp;</div></li><li><div>#'.$lca.'-widget-buttons-2&nbsp;</div></li><li><div>  .'.$lca.'-buttons&nbsp;</div></li><li><div>      #facebook-'.$lca.'-widget-buttons-2 { }&lt;/pre&gt;';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              case 'info-styles-admin_edit':&nbsp;</div></li><li><div>                  $text = '&lt;p&gt;Social sharing buttons within the Admin Post / Page Edit metabox are assigned the \''.$lca.'-admin_edit-buttons\' class, which itself contains the \''.$lca.'-buttons\' class -- a common class for all buttons (see the All Buttons tab).&lt;/p&gt; &nbsp;</div></li><li><div>                  &lt;p&gt;Example:&lt;/p&gt;&lt;pre&gt;&nbsp;</div></li><li><div>.'.$lca.'-admin_edit-buttons &nbsp;</div></li><li><div>  .'.$lca.'-buttons&nbsp;</div></li><li><div>      .facebook-button { }&lt;/pre&gt;';&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $text;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function filter_settings_page_custom_style_css( $custom_style_css ) {&nbsp;</div></li><li><div>          $custom_style_css .= '&nbsp;</div></li><li><div>              .website_col {&nbsp;</div></li><li><div>                  float:left;&nbsp;</div></li><li><div>                  min-height:50px;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              .max_cols_1.website_col {&nbsp;</div></li><li><div>                  width:100%;&nbsp;</div></li><li><div>                  min-width:100%;&nbsp;</div></li><li><div>                  max-width:100%;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              .max_cols_2.website_col {&nbsp;</div></li><li><div>                  width:50%;&nbsp;</div></li><li><div>                  min-width:50%;&nbsp;</div></li><li><div>                  max-width:50%;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              .max_cols_3.website_col {&nbsp;</div></li><li><div>                  width:33.3333%;&nbsp;</div></li><li><div>                  min-width:33.3333%;&nbsp;</div></li><li><div>                  max-width:33.3333%;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              .max_cols_4.website_col {&nbsp;</div></li><li><div>                  width:25%;&nbsp;</div></li><li><div>                  min-width:25%;&nbsp;</div></li><li><div>                  max-width:25%;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              .website_col .postbox {&nbsp;</div></li><li><div>                  overflow-x:hidden;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              .postbox-website {&nbsp;</div></li><li><div>                  min-width:452px;&nbsp;</div></li><li><div>                  overflow-y:auto;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              .postbox-website .metabox-website {&nbsp;</div></li><li><div>                  min-height:565px;&nbsp;</div></li><li><div>                  overflow-y:auto;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              .postbox-website.postbox-show_basic .metabox-website {&nbsp;</div></li><li><div>                  min-height:435px;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              .postbox-website div.sucom-metabox-tabs div.sucom-tabset.active {&nbsp;</div></li><li><div>                  min-height:519px;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              .postbox-website.postbox-show_basic div.sucom-metabox-tabs div.sucom-tabset.active {&nbsp;</div></li><li><div>                  min-height:389px;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              .postbox-website.closed, &nbsp;</div></li><li><div>              .postbox-website.closed .metabox-website, &nbsp;</div></li><li><div>              .postbox-website.postbox-show_basic.closed .metabox-website {&nbsp;</div></li><li><div>                  height:auto;&nbsp;</div></li><li><div>                  min-height:0;&nbsp;</div></li><li><div>                  overflow:hidden;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          ';&nbsp;</div></li><li><div>          return $custom_style_css;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>NextGEN Facebook (NGFB)</li><li><span></span>8.43.0</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>