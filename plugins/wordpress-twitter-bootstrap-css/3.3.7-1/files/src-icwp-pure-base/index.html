<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="3.3.7-1" data-slug="wordpress-twitter-bootstrap-css" data-type="file" data-id="31952"><head xmlns="http://www.w3.org/1999/xhtml"><title> src-icwp-pure-base | file | WordPress Twitter Bootstrap Css | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, wordpress-twitter-bootstrap-css, 3.3.7-1" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.10"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=8ae74418b0f1ac349f96dd9a9d3bb346' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.10' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/src-icwp-pure-base/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fsrc-icwp-pure-base%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fsrc-icwp-pure-base%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-wordpress-twitter-bootstrap-css-3.3.7-1-file-src-icwp-pure-base","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="src-icwp-pure-base" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to wordpress-twitter-bootstrap-c&hellip;." href="http://hookr.io/plugins/wordpress-twitter-bootstrap-css/" class="plugin"><span property="name">wordpress-twitter-bootstrap-c&hellip;</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 3.3.7-1." href="http://hookr.io/plugins/wordpress-twitter-bootstrap-css/3.3.7-1/" class="H_VERSION"><span property="name">3.3.7-1</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/wordpress-twitter-bootstrap-css/3.3.7-1/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">src-icwp-pure-base</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="116"><a href="http://hookr.io/plugins/wordpress-twitter-bootstrap-css/3.3.7-1/all/" title="All">All <span class="count badge">116</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/wordpress-twitter-bootstrap-css/3.3.7-1/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="17"><a href="http://hookr.io/plugins/wordpress-twitter-bootstrap-css/3.3.7-1/hooks/" title="Hooks">Hooks <span class="count badge">17</span></a></li><li class="" data-id="action" data-count="4"><a href="http://hookr.io/plugins/wordpress-twitter-bootstrap-css/3.3.7-1/actions/" title="Actions">Actions <span class="count badge">4</span></a></li><li class="" data-id="filter" data-count="13"><a href="http://hookr.io/plugins/wordpress-twitter-bootstrap-css/3.3.7-1/filters/" title="Filters">Filters <span class="count badge">13</span></a></li><li class="" data-id="class" data-count="88"><a href="http://hookr.io/plugins/wordpress-twitter-bootstrap-css/3.3.7-1/classes/" title="Classes">Classes <span class="count badge">88</span></a></li><li class="" data-id="constant" data-count="1"><a href="http://hookr.io/plugins/wordpress-twitter-bootstrap-css/3.3.7-1/constants/" title="Constants">Constants <span class="count badge">1</span></a></li><li class="" data-id="function" data-count="8"><a href="http://hookr.io/plugins/wordpress-twitter-bootstrap-css/3.3.7-1/functions/" title="Functions">Functions <span class="count badge">8</span></a></li><li class="" data-id="shortcode" data-count="2"><a href="http://hookr.io/plugins/wordpress-twitter-bootstrap-css/3.3.7-1/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">2</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/src/icwp-pure-base.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div>require_once( dirname(__FILE__).'/icwp-wpfunctions.php' );&nbsp;</div></li><li><div>require_once( dirname(__FILE__).'/icwp-wpfilesystem.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !class_exists('ICWP_WPTB_Pure_Base_V1') ):&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  class ICWP_WPTB_Pure_Base_V1 {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      const ViewExt = '.php';&nbsp;</div></li><li><div>      const ViewDir = 'views';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @var ICWP_Wordpress_Twitter_Bootstrap_Plugin</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected $oPluginVo;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Set to true if it should never be shown in the dashboard</span>&nbsp;</div></li><li><div><span class="comment">       * @var string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected $fHeadless = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Set to true if this contains components from another plugin to stand alone</span>&nbsp;</div></li><li><div><span class="comment">       * @var string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected $m_sAutoUpdateUrl = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @var string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected $sPluginRootFile;&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @var string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected $sPluginFileName;&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @var string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected $sPluginRootDir;&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @var string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected $sPluginBaseFile;&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @var string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected $sPluginUrl;&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @var string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected static $sOptionPrefix = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected $aPluginMenu;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected $sPluginSlug;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected $fShowMarketing;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @var ICWP_WPTB_WpFilesystem;</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected $oWpFunctions;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function __construct( ICWP_Wordpress_Twitter_Bootstrap_Plugin $oPluginVo ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// All core values of the plugin are derived from the values stored in this value object.</span>&nbsp;</div></li><li><div>          $this-&gt;oPluginVo = $oPluginVo;&nbsp;</div></li><li><div>          $this-&gt;sPluginRootFile = $this-&gt;oPluginVo-&gt;getRootFile();&nbsp;</div></li><li><div>          $this-&gt;sPluginSlug = $this-&gt;oPluginVo-&gt;getPluginSlug();&nbsp;</div></li><li><div>          self::$sOptionPrefix = $this-&gt;oPluginVo-&gt;getOptionStoragePrefix();&nbsp;</div></li><li><div>          $this-&gt;setPaths();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_action( 'plugins_loaded', array( $this, 'onWpPluginsLoaded' ) );&nbsp;</div></li><li><div>          add_action( 'init', array( $this, 'onWpInit' ), 0 );&nbsp;</div></li><li><div>          if ( $this-&gt;isValidAdminArea() ) {&nbsp;</div></li><li><div>              add_action( 'admin_init', array( $this, 'onWpAdminInit' ) );&nbsp;</div></li><li><div>              add_action( 'admin_notices', array( $this, 'onWpAdminNotices' ) );&nbsp;</div></li><li><div>              add_action( 'network_admin_notices', array( $this, 'onWpAdminNotices' ) );&nbsp;</div></li><li><div>              add_action( 'admin_menu', array( $this, 'onWpAdminMenu' ) );&nbsp;</div></li><li><div>              add_action(    'network_admin_menu', array( $this, 'onWpAdminMenu' ) );&nbsp;</div></li><li><div>              add_action( 'plugin_action_links', array( $this, 'onWpPluginActionLinks' ), 10, 4 );&nbsp;</div></li><li><div>              add_action( 'wp_before_admin_bar_render', array( $this, 'onWpAdminBar' ), 1, 9999 );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          add_action( 'in_plugin_update_message-'.$this-&gt;getPluginBaseFile(), array( $this, 'onWpPluginUpdateMessage' ) );&nbsp;</div></li><li><div>          add_action( 'shutdown', array( $this, 'onWpShutdown' ) );&nbsp;</div></li><li><div>          add_action( $this-&gt;doPluginPrefix( 'plugin_shutdown' ), array( $this, 'doPluginShutdown' ) );&nbsp;</div></li><li><div>          $this-&gt;registerActivationHooks();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Returns this unique plugin prefix</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $sGlue</span>&nbsp;</div></li><li><div><span class="comment">       * @return string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function getPluginPrefix( $sGlue = '-' ) {&nbsp;</div></li><li><div>          return $this-&gt;oPluginVo-&gt;getFullPluginPrefix( $sGlue );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Will prefix and return any string with the unique plugin prefix.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $sSuffix</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $sGlue</span>&nbsp;</div></li><li><div><span class="comment">       * @return string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function doPluginPrefix( $sSuffix = '', $sGlue = '-' ) {&nbsp;</div></li><li><div>          $sPrefix = $this-&gt;oPluginVo-&gt;getFullPluginPrefix( $sGlue );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $sSuffix == $sPrefix || strpos( $sSuffix, $sPrefix.$sGlue ) === 0 ) { <span class="comment">//it already has the prefix</span>&nbsp;</div></li><li><div>              return $sSuffix;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return sprintf( '%s%s%s', $sPrefix, empty($sSuffix)? '' : $sGlue, empty($sSuffix)? '' : $sSuffix );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Will prefix and return any string with the unique plugin options prefix.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $sSuffix</span>&nbsp;</div></li><li><div><span class="comment">       * @return string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function doPluginOptionPrefix( $sSuffix = '' ) {&nbsp;</div></li><li><div>          return $this-&gt;doPluginPrefix( $sSuffix, '_' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function isValidAdminArea() {&nbsp;</div></li><li><div>          $oWp = $this-&gt;loadWpFunctions();&nbsp;</div></li><li><div>          if ( !$oWp-&gt;isMultisite() && is_admin() ) {&nbsp;</div></li><li><div>              return true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          else if ( $oWp-&gt;isMultisite() && $this-&gt;oPluginVo-&gt;getIsWpmsNetworkAdminOnly() && is_network_admin() ) {&nbsp;</div></li><li><div>              return true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Registers the plugins activation, deactivate and uninstall hooks.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function registerActivationHooks() {&nbsp;</div></li><li><div>          register_activation_hook( $this-&gt;sPluginRootFile, array( $this, 'onWpActivatePlugin' ) );&nbsp;</div></li><li><div>          register_deactivation_hook( $this-&gt;sPluginRootFile, array( $this, 'onWpDeactivatePlugin' ) );&nbsp;</div></li><li><div>          <span class="comment">//    register_uninstall_hook( $this-&gt;sPluginRootFile, array( $this, 'onWpUninstallPlugin' ) );</span>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @since v3.0.0</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function setPaths() {&nbsp;</div></li><li><div>          if ( empty( $this-&gt;sPluginRootFile ) ) {&nbsp;</div></li><li><div>              $this-&gt;sPluginRootFile = __FILE__;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $this-&gt;sPluginFileName = basename( $this-&gt;sPluginRootFile );&nbsp;</div></li><li><div>          $this-&gt;getPluginBaseFile();&nbsp;</div></li><li><div>          $this-&gt;sPluginRootDir = dirname( $this-&gt;sPluginRootFile ).ICWP_DS;&nbsp;</div></li><li><div>          $this-&gt;sPluginUrl = plugins_url( '/', $this-&gt;sPluginRootFile ) ; <span class="comment">//this seems to use SSL more reliably than WP_PLUGIN_URL</span>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * This is the path to the main plugin file relative to the WordPress plugins directory.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @return string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function getPluginBaseFile() {&nbsp;</div></li><li><div>          if ( !isset( $this-&gt;sPluginBaseFile ) ) {&nbsp;</div></li><li><div>              $this-&gt;sPluginBaseFile = plugin_basename( $this-&gt;sPluginRootFile );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $this-&gt;sPluginBaseFile;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @param boolean $fHasPermission</span>&nbsp;</div></li><li><div><span class="comment">       * @return boolean</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function hasPermissionToView( $fHasPermission = true ) {&nbsp;</div></li><li><div>          return $this-&gt;hasPermissionToSubmit( $fHasPermission );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @param boolean $fHasPermission</span>&nbsp;</div></li><li><div><span class="comment">       * @return boolean</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function hasPermissionToSubmit( $fHasPermission = true ) {&nbsp;</div></li><li><div>          <span class="comment">// first a basic admin check</span>&nbsp;</div></li><li><div>          return $fHasPermission && is_super_admin() && current_user_can( $this-&gt;oPluginVo-&gt;getBasePermissions() );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function doPluginUpdateCheck() {&nbsp;</div></li><li><div>          $oWp = $this-&gt;loadWpFunctions();&nbsp;</div></li><li><div>          $oWp-&gt;getIsPluginUpdateAvailable( $this-&gt;getPluginBaseFile() );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function display( $insView, $inaData = array() ) {&nbsp;</div></li><li><div>          $sFile = $this-&gt;sPluginRootDir.self::ViewDir.ICWP_DS.$insView.self::ViewExt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( !is_file( $sFile ) ) {&nbsp;</div></li><li><div>              echo &quot;View not found: &quot;.$sFile;&nbsp;</div></li><li><div>              return false;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( count( $inaData ) &gt; 0 ) {&nbsp;</div></li><li><div>              extract( $inaData, EXTR_PREFIX_ALL, $this-&gt;oPluginVo-&gt;getParentSlug() ); <span class="comment">//slug being 'icwp'</span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          ob_start();&nbsp;</div></li><li><div>          include( $sFile );&nbsp;</div></li><li><div>          $sContents = ob_get_contents();&nbsp;</div></li><li><div>          ob_end_clean();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          echo $sContents;&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function getSubmenuId( $sId = '' ) {&nbsp;</div></li><li><div>          return $this-&gt;doPluginPrefix( $sId );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Hooked to 'plugins_loaded'</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function onWpPluginsLoaded() {&nbsp;</div></li><li><div>          if ( is_admin() ) {&nbsp;</div></li><li><div>              <span class="comment">//Handle plugin upgrades</span>&nbsp;</div></li><li><div>              $this-&gt;doPluginUpdateCheck();&nbsp;</div></li><li><div>              $this-&gt;load_textdomain();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $this-&gt;handlePluginFormSubmit();&nbsp;</div></li><li><div>          add_filter( 'all_plugins', array( $this, 'filter_hidePluginFromTableList' ) );&nbsp;</div></li><li><div>          add_filter( 'site_transient_update_plugins', array( $this, 'filter_hidePluginUpdatesFromUI' ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Added to a WordPress filter ('all_plugins') which will remove this particular plugin from the</span>&nbsp;</div></li><li><div><span class="comment">       * list of all plugins based on the &quot;plugin file&quot; name.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @uses $this-&gt;m_fHeadless if the plugin is headless, it is hidden</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $aPlugins</span>&nbsp;</div></li><li><div><span class="comment">       * @return array</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function filter_hidePluginFromTableList( $aPlugins ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( !$this-&gt;fHeadless ) {&nbsp;</div></li><li><div>              return $aPlugins;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sPluginBaseFileName = $this-&gt;getPluginBaseFile();&nbsp;</div></li><li><div>          if ( isset( $aPlugins[$sPluginBaseFileName] ) ) {&nbsp;</div></li><li><div>              unset( $aPlugins[$sPluginBaseFileName] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $aPlugins;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Added to the WordPress filter ('site_transient_update_plugins') in order to remove visibility of updates</span>&nbsp;</div></li><li><div><span class="comment">       * from the WordPress Admin UI.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * In order to ensure that WordPress still checks for plugin updates it will not remove this plugin from</span>&nbsp;</div></li><li><div><span class="comment">       * the list of plugins if DOING_CRON is set to true.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @uses $this-&gt;fHeadless if the plugin is headless, it is hidden</span>&nbsp;</div></li><li><div><span class="comment">       * @param StdClass $oPlugins</span>&nbsp;</div></li><li><div><span class="comment">       * @return StdClass</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function filter_hidePluginUpdatesFromUI( $oPlugins ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( ( defined( 'DOING_CRON' ) && DOING_CRON ) || !$this-&gt;fHeadless ) {&nbsp;</div></li><li><div>              return $oPlugins;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( !empty( $oPlugins-&gt;response[ $this-&gt;getPluginBaseFile() ] ) ) {&nbsp;</div></li><li><div>              unset( $oPlugins-&gt;response[ $this-&gt;getPluginBaseFile() ] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return $oPlugins;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Load the multilingual aspect of the plugin</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function load_textdomain() {&nbsp;</div></li><li><div>          <span class="comment">//TODO: Can replace with $this-&gt;sPluginRootDir ?</span>&nbsp;</div></li><li><div>          load_plugin_textdomain( $this-&gt;oPluginVo-&gt;getTextDomain(), false, dirname( $this-&gt;getPluginBaseFile() ) . '/languages/' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function onWpInit() { }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function onWpAdminInit() {&nbsp;</div></li><li><div>          <span class="comment">//Do Plugin-Specific Admin Work</span>&nbsp;</div></li><li><div>          if ( $this-&gt;getIsPage_PluginAdmin() ) {&nbsp;</div></li><li><div>              add_action( 'admin_enqueue_scripts', array( $this, 'enqueueBootstrapLegacyAdminCss' ), 99 );&nbsp;</div></li><li><div>              add_action( 'admin_enqueue_scripts', array( $this, 'enqueuePluginAdminCss' ), 99 );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function onWpAdminMenu() {&nbsp;</div></li><li><div>          if ( !$this-&gt;isValidAdminArea() ) {&nbsp;</div></li><li><div>              return true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $this-&gt;createMenu();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function createMenu() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;fHeadless ) {&nbsp;</div></li><li><div>              return true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sFullParentMenuId = $this-&gt;getPluginPrefix();&nbsp;</div></li><li><div>          add_menu_page( $this-&gt;oPluginVo-&gt;getHumanName(), $this-&gt;oPluginVo-&gt;getAdminMenuTitle(), $this-&gt;oPluginVo-&gt;getBasePermissions(), $sFullParentMenuId, array( $this, 'onDisplayAll' ), $this-&gt;getPluginLogoUrl16() );&nbsp;</div></li><li><div>          <span class="comment">//Create and Add the submenu items</span>&nbsp;</div></li><li><div><span class="comment">//        $this-&gt;createPluginSubMenuItems();</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// allow for any plugin menu items that don't come from filters</span>&nbsp;</div></li><li><div>          add_filter( $this-&gt;doPluginPrefix( 'filter_plugin_submenu_items' ), array( $this, 'filter_addExtraAdminMenuItems' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $aPluginMenuItems = apply_filters( $this-&gt;doPluginPrefix( 'filter_plugin_submenu_items' ), array() );&nbsp;</div></li><li><div>          if ( !empty( $aPluginMenuItems ) ) {&nbsp;</div></li><li><div>              foreach ( $aPluginMenuItems as $sMenuTitle =&gt; $aMenu ) {&nbsp;</div></li><li><div>                  list( $sMenuItemText, $sMenuItemId, $aMenuCallBack ) = $aMenu;&nbsp;</div></li><li><div>                  add_submenu_page(&nbsp;</div></li><li><div>                      $sFullParentMenuId, &nbsp;</div></li><li><div>                      $sMenuTitle, &nbsp;</div></li><li><div>                      $sMenuItemText, &nbsp;</div></li><li><div>                      $this-&gt;oPluginVo-&gt;getBasePermissions(), &nbsp;</div></li><li><div>                      $this-&gt;doPluginPrefix( $sMenuItemId ), &nbsp;</div></li><li><div>                      $aMenuCallBack&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div><span class="comment">//        if ( !empty($this-&gt;aPluginMenu) ) {</span>&nbsp;</div></li><li><div><span class="comment">//            foreach ( $this-&gt;aPluginMenu as $sMenuTitle =&gt; $aMenu ) {</span>&nbsp;</div></li><li><div><span class="comment">//                list( $sMenuItemText, $sMenuItemId, $sMenuCallBack ) = $aMenu;</span>&nbsp;</div></li><li><div><span class="comment">//                add_submenu_page( $sFullParentMenuId, $sMenuTitle, $sMenuItemText, $this-&gt;oPluginVo-&gt;getBasePermissions(), $sMenuItemId, array( $this, $sMenuCallBack ) );</span>&nbsp;</div></li><li><div><span class="comment">//            }</span>&nbsp;</div></li><li><div><span class="comment">//        }</span>&nbsp;</div></li><li><div>          $this-&gt;fixSubmenu();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $aItems</span>&nbsp;</div></li><li><div><span class="comment">       * @return array</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function filter_addExtraAdminMenuItems( $aItems ) {&nbsp;</div></li><li><div>          return $aItems;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * no longer used</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function createPluginSubMenuItems() { }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function fixSubmenu() {&nbsp;</div></li><li><div>          global $submenu;&nbsp;</div></li><li><div>          $sFullParentMenuId = $this-&gt;getPluginPrefix();&nbsp;</div></li><li><div>          if ( isset( $submenu[$sFullParentMenuId] ) ) {&nbsp;</div></li><li><div>              unset( $submenu[$sFullParentMenuId][0] );&nbsp;</div></li><li><div><span class="comment">//            $submenu[$sFullParentMenuId][0][0] = 'Dashboard';</span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Displaying all views now goes through this central function and we work out</span>&nbsp;</div></li><li><div><span class="comment">       * what to display based on the name of current hook/filter being processed.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function onDisplayAll() {&nbsp;</div></li><li><div>          $this-&gt;onDisplayMainMenu();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * The callback function for the main admin menu index page</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function onDisplayMainMenu() {&nbsp;</div></li><li><div>          $aData = array();&nbsp;</div></li><li><div>          $this-&gt;display( $this-&gt;doPluginPrefix( 'index', '_' ), $aData );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function getBaseDisplayData() {&nbsp;</div></li><li><div>          $oWp = $this-&gt;loadWpFunctions();&nbsp;</div></li><li><div>          return array(&nbsp;</div></li><li><div>              'plugin_url' =&gt; $this-&gt;sPluginUrl, &nbsp;</div></li><li><div>              'var_prefix' =&gt; $this-&gt;oPluginVo-&gt;getOptionStoragePrefix(), &nbsp;</div></li><li><div>              'sPluginName' =&gt; $this-&gt;oPluginVo-&gt;getHumanName(), &nbsp;</div></li><li><div>              'fShowAds' =&gt; $this-&gt;isShowMarketing(), &nbsp;</div></li><li><div>              'nonce_field' =&gt; $this-&gt;getPluginPrefix(), &nbsp;</div></li><li><div>              'form_action' =&gt; 'admin.php?page='.$oWp-&gt;getCurrentWpAdminPage()&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @return bool</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function getIsPage_PluginMainDashboard() {&nbsp;</div></li><li><div>          $oWp = $this-&gt;loadWpFunctions();&nbsp;</div></li><li><div>          return ( $oWp-&gt;getCurrentWpAdminPage() ==  $this-&gt;getPluginPrefix() );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @return bool</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function getIsPage_PluginAdmin() {&nbsp;</div></li><li><div>          $oWp = $this-&gt;loadWpFunctions();&nbsp;</div></li><li><div>          return ( strpos( $oWp-&gt;getCurrentWpAdminPage(), $this-&gt;getPluginPrefix() ) === 0 );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $sFeaturePage - leave empty to get the main dashboard</span>&nbsp;</div></li><li><div><span class="comment">       * @return mixed</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function getUrl_PluginDashboard( $sFeaturePage = '' ) {&nbsp;</div></li><li><div>          return network_admin_url( sprintf( 'admin.php?page=%s', $this-&gt;getSubmenuId( $sFeaturePage ) ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @return bool</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function isShowMarketing() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( isset($this-&gt;fShowMarketing) ) {&nbsp;</div></li><li><div>              return $this-&gt;fShowMarketing;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $this-&gt;fShowMarketing = true;&nbsp;</div></li><li><div>          if ( class_exists( 'Worpit_Plugin' ) ) {&nbsp;</div></li><li><div>              if ( method_exists( 'Worpit_Plugin', 'IsLinked' ) ) {&nbsp;</div></li><li><div>                  $this-&gt;fShowMarketing = !Worpit_Plugin::IsLinked();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              else if ( function_exists( 'get_option' )&nbsp;</div></li><li><div>                  && get_option( Worpit_Plugin::$VariablePrefix.'assigned' ) == 'Y'&nbsp;</div></li><li><div>                  && get_option( Worpit_Plugin::$VariablePrefix.'assigned_to' ) != '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $this-&gt;fShowMarketing = false;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $this-&gt;fShowMarketing ;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * On the plugins listing page, hides the edit and deactivate links</span>&nbsp;</div></li><li><div><span class="comment">       * for this plugin based on permissions</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @see ICWP_Pure_Base_V1::onWpPluginActionLinks()</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function onWpPluginActionLinks( $aActionLinks, $sPluginFile ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $sPluginFile == $this-&gt;getPluginBaseFile() ) {&nbsp;</div></li><li><div>              if ( !$this-&gt;hasPermissionToSubmit() ) {&nbsp;</div></li><li><div>                  if ( array_key_exists( 'edit', $aActionLinks ) ) {&nbsp;</div></li><li><div>                      unset( $aActionLinks['edit'] );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  if ( array_key_exists( 'deactivate', $aActionLinks ) ) {&nbsp;</div></li><li><div>                      unset( $aActionLinks['deactivate'] );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $sSettingsLink = sprintf( '&lt;a href=&quot;%s&quot;&gt;%s&lt;/a&gt;', $this-&gt;getUrl_PluginDashboard(), 'Dashboard' ); ;&nbsp;</div></li><li><div>              array_unshift( $aActionLinks, $sSettingsLink );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $aActionLinks;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Override this method to handle all the admin notices</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function onWpAdminNotices() {&nbsp;</div></li><li><div>          <span class="comment">// Do we have admin priviledges?</span>&nbsp;</div></li><li><div>          if ( !$this-&gt;isValidAdminArea() || !current_user_can( $this-&gt;oPluginVo-&gt;getBasePermissions() ) ) {&nbsp;</div></li><li><div>              return true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;doAdminNoticeOptionsUpdated();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// If we've set to not show admin notices ever</span>&nbsp;</div></li><li><div>          if ( $this-&gt;getShowAdminNotices() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( $this-&gt;hasPermissionToView() ) {&nbsp;</div></li><li><div>                  $this-&gt;doAdminNoticePostUpgrade();&nbsp;</div></li><li><div>                  $this-&gt;doAdminNoticeTranslations();&nbsp;</div></li><li><div>                  $this-&gt;doAdminNoticeMailingListSignup();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ( $this-&gt;hasPermissionToSubmit() ) {&nbsp;</div></li><li><div>                  $this-&gt;doAdminNoticePluginUpgradeAvailable();&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function doAdminNoticePluginUpgradeAvailable() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Don't show on the update page.</span>&nbsp;</div></li><li><div>          if ( isset( $GLOBALS['pagenow'] ) && $GLOBALS['pagenow'] == 'update.php' ) {&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $oWp = $this-&gt;loadWpFunctions();&nbsp;</div></li><li><div>          $oUpdate = $oWp-&gt;getIsPluginUpdateAvailable( $this-&gt;getPluginBaseFile() );&nbsp;</div></li><li><div>          if ( !$oUpdate ) {&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $sNotice = $this-&gt;getAdminNoticeHtml_PluginUpgradeAvailable();&nbsp;</div></li><li><div>          $this-&gt;getAdminNoticeHtml( $sNotice, 'updated', true );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function doAdminNoticeOptionsUpdated() {&nbsp;</div></li><li><div>          $sHtml = $this-&gt;getAdminNoticeHtml_OptionsUpdated();&nbsp;</div></li><li><div>          if ( !empty($sHtml) ) {&nbsp;</div></li><li><div>              $this-&gt;getAdminNoticeHtml( $sHtml, 'updated', true );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function doAdminNoticePostUpgrade() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sCurrentMetaValue = $this-&gt;getUserMeta( 'current_version' );&nbsp;</div></li><li><div>          if ( $sCurrentMetaValue === $this-&gt;oPluginVo-&gt;getVersion() ) {&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $sHtml = $this-&gt;getAdminNoticeHtml_VersionUpgrade();&nbsp;</div></li><li><div>          if ( !empty($sHtml) ) {&nbsp;</div></li><li><div>              $this-&gt;getAdminNoticeHtml( $sHtml, 'updated', true );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function doAdminNoticeTranslations() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sCurrentMetaValue = $this-&gt;getUserMeta( 'plugin_translation_notice' );&nbsp;</div></li><li><div>          if ( $sCurrentMetaValue === 'Y' ) {&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sHtml = $this-&gt;getAdminNoticeHtml_Translations();&nbsp;</div></li><li><div>          if ( !empty($sHtml) ) {&nbsp;</div></li><li><div>              $this-&gt;getAdminNoticeHtml( $sHtml, 'updated', true );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function doAdminNoticeMailingListSignup() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sCurrentMetaValue = $this-&gt;getUserMeta( 'plugin_mailing_list_signup' );&nbsp;</div></li><li><div>          if ( $sCurrentMetaValue == 'Y' ) {&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sHtml = $this-&gt;getAdminNoticeHtml_MailingListSignup();&nbsp;</div></li><li><div>          if ( !empty($sHtml) ) {&nbsp;</div></li><li><div>              $this-&gt;getAdminNoticeHtml( $sHtml, 'updated', true );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Override this to change the message for the particular plugin upgrade.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function getAdminNoticeHtml_PluginUpgradeAvailable() {&nbsp;</div></li><li><div>          $oWp = $this-&gt;loadWpFunctions();&nbsp;</div></li><li><div>          $sUpgradeLink = $oWp-&gt;getPluginUpgradeLink( $this-&gt;getPluginBaseFile() );&nbsp;</div></li><li><div>          $sNotice = '&lt;p&gt;There is an update available for the %s plugin. &lt;a href=&quot;%s&quot;&gt;Click to update immediately&lt;/a&gt;.&lt;/p&gt;';&nbsp;</div></li><li><div>          $sNotice = sprintf( $sNotice, $this-&gt;oPluginVo-&gt;getHumanName(), $sUpgradeLink );&nbsp;</div></li><li><div>          return $sNotice;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function getAdminNoticeHtml_OptionsUpdated() { }&nbsp;</div></li><li><div>      protected function getAdminNoticeHtml_VersionUpgrade() { }&nbsp;</div></li><li><div>      protected function getAdminNoticeHtml_Translations() { }&nbsp;</div></li><li><div>      protected function getAdminNoticeHtml_MailingListSignup() { }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Provides the basic HTML template for printing a WordPress Admin Notices</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param $insNotice - The message to be displayed.</span>&nbsp;</div></li><li><div><span class="comment">       * @param $insMessageClass - either error or updated</span>&nbsp;</div></li><li><div><span class="comment">       * @param $infPrint - if true, will echo. false will return the string</span>&nbsp;</div></li><li><div><span class="comment">       * @return boolean|string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function getAdminNoticeHtml( $insNotice = '', $insMessageClass = 'updated', $infPrint = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sFullNotice = '&nbsp;</div></li><li><div>          &lt;div id=&quot;message&quot; class=&quot;'.$insMessageClass.'&quot;&gt;&nbsp;</div></li><li><div>              &lt;style&gt;#message form { margin: 0px; padding-bottom: 8px; }&lt;/style&gt;&nbsp;</div></li><li><div>              '.$insNotice.'&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>      ';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $infPrint ) {&nbsp;</div></li><li><div>              echo $sFullNotice;&nbsp;</div></li><li><div>              return true;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              return $sFullNotice;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function getShowAdminNotices() {&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Updates the current (or supplied user ID) user meta data with the version of the plugin</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param $nId</span>&nbsp;</div></li><li><div><span class="comment">       * @param $sValue</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function updateTranslationNoticeShownUserMeta( $nId = '', $sValue = 'Y' ) {&nbsp;</div></li><li><div>          $this-&gt;updateUserMeta( 'plugin_translation_notice', $sValue, $nId );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Updates the current (or supplied user ID) user meta data with the version of the plugin</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param $nId</span>&nbsp;</div></li><li><div><span class="comment">       * @param $sValue</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function updateMailingListSignupShownUserMeta( $nId = '', $sValue = 'Y' ) {&nbsp;</div></li><li><div>          $this-&gt;updateUserMeta( 'plugin_mailing_list_signup', $sValue, $nId );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Updates the current (or supplied user ID) user meta data with the version of the plugin</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param integer $nId</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function updateVersionUserMeta( $nId = null ) {&nbsp;</div></li><li><div>          $this-&gt;updateUserMeta( 'current_version', $this-&gt;oPluginVo-&gt;getVersion(), $nId );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Updates the current (or supplied user ID) user meta data with the version of the plugin</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $sKey</span>&nbsp;</div></li><li><div><span class="comment">       * @param mixed $mValue</span>&nbsp;</div></li><li><div><span class="comment">       * @param integer $nId        -user ID</span>&nbsp;</div></li><li><div><span class="comment">       * @return boolean</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function updateUserMeta( $sKey, $mValue, $nId = null ) {&nbsp;</div></li><li><div>          if ( empty( $innId ) ) {&nbsp;</div></li><li><div>              $oWp = $this-&gt;loadWpFunctions();&nbsp;</div></li><li><div>              $oCurrentUser = $oWp-&gt;getCurrentWpUser();&nbsp;</div></li><li><div>              if ( is_null( $oCurrentUser ) ) {&nbsp;</div></li><li><div>                  return false;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              $nUserId = $oCurrentUser-&gt;ID;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          else {&nbsp;</div></li><li><div>              $nUserId = $nId;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return update_user_meta( $nUserId, $this-&gt;doPluginOptionPrefix( $sKey ), $mValue );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @param $sKey</span>&nbsp;</div></li><li><div><span class="comment">       * @return bool|string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function getUserMeta( $sKey ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $oWp = $this-&gt;loadWpFunctions();&nbsp;</div></li><li><div>          $oCurrentUser = $oWp-&gt;getCurrentWpUser();&nbsp;</div></li><li><div>          if ( is_null( $oCurrentUser ) ) {&nbsp;</div></li><li><div>              return false;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $nUserId = $oCurrentUser-&gt;ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sCurrentMetaValue = get_user_meta( $nUserId, $this-&gt;doPluginOptionPrefix( $sKey ), true );&nbsp;</div></li><li><div>          <span class="comment">// A guard whereby if we can't ever get a value for this meta, it means we can never set it.</span>&nbsp;</div></li><li><div>          if ( empty( $sCurrentMetaValue ) ) {&nbsp;</div></li><li><div>              <span class="comment">//the value has never been set, or it's been installed for the first time.</span>&nbsp;</div></li><li><div>              $this-&gt;updateUserMeta( $this-&gt;doPluginOptionPrefix( $sKey ), 'temp', $nUserId );&nbsp;</div></li><li><div>              return ''; <span class="comment">//meaning we don't show the update notice upon new installations and for those people who can't set the version in their meta.</span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return $sCurrentMetaValue;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function handlePluginFormSubmit() {&nbsp;</div></li><li><div>          if ( !$this-&gt;isIcwpPluginFormSubmit() ) {&nbsp;</div></li><li><div>              return false;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//            check_admin_referer( $this-&gt;getPluginPrefix() );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// do all the plugin feature/options saving</span>&nbsp;</div></li><li><div>          do_action( $this-&gt;doPluginPrefix( 'form_submit' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;getIsPage_PluginAdmin() ) {&nbsp;</div></li><li><div>              $oWp = $this-&gt;loadWpFunctions();&nbsp;</div></li><li><div>              wp_safe_redirect( $this-&gt;getUrl_PluginDashboard( $oWp-&gt;getCurrentWpAdminPage() ) );&nbsp;</div></li><li><div>              return true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @return bool</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function isIcwpPluginFormSubmit() {&nbsp;</div></li><li><div>          if ( empty($_POST) && empty($_GET) ) {&nbsp;</div></li><li><div>              return false;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $aFormSubmitOptions = array(&nbsp;</div></li><li><div>              $this-&gt;doPluginOptionPrefix( 'plugin_form_submit' ), &nbsp;</div></li><li><div>              'icwp_link_action'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $oDp = $this-&gt;loadDataProcessor();&nbsp;</div></li><li><div>          foreach( $aFormSubmitOptions as $sOption ) {&nbsp;</div></li><li><div>              if ( !is_null( $oDp-&gt;FetchRequest( $sOption ) ) ) {&nbsp;</div></li><li><div>                  return true;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function enqueueBootstrapAdminCss() {&nbsp;</div></li><li><div>          $sUnique = $this-&gt;doPluginPrefix( 'bootstrap_wpadmin_css' );&nbsp;</div></li><li><div>          wp_register_style( $sUnique, $this-&gt;getCssUrl( 'bootstrap-wpadmin.css' ), false, $this-&gt;oPluginVo-&gt;getVersion() );&nbsp;</div></li><li><div>          wp_enqueue_style( $sUnique );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function enqueueBootstrapLegacyAdminCss() {&nbsp;</div></li><li><div>          $sUnique = $this-&gt;doPluginPrefix( 'bootstrap_wpadmin_legacy_css' );&nbsp;</div></li><li><div>          wp_register_style( $sUnique, $this-&gt;getCssUrl( 'bootstrap-wpadmin-legacy.css' ), false, $this-&gt;oPluginVo-&gt;getVersion() );&nbsp;</div></li><li><div>          wp_enqueue_style( $sUnique );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $sUnique = $this-&gt;doPluginPrefix( 'bootstrap_wpadmin_css_fixes' );&nbsp;</div></li><li><div>          wp_register_style( $sUnique, $this-&gt;getCssUrl('bootstrap-wpadmin-fixes.css'), array( $this-&gt;doPluginPrefix( 'bootstrap_wpadmin_legacy_css' ) ), $this-&gt;oPluginVo-&gt;getVersion() );&nbsp;</div></li><li><div>          wp_enqueue_style( $sUnique );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function enqueuePluginAdminCss() {&nbsp;</div></li><li><div>          $sUnique = $this-&gt;doPluginPrefix( 'plugin_css' );&nbsp;</div></li><li><div>          wp_register_style( $sUnique, $this-&gt;getCssUrl('plugin.css'), array( $this-&gt;doPluginPrefix( 'bootstrap_wpadmin_css_fixes' ) ), $this-&gt;oPluginVo-&gt;getVersion() );&nbsp;</div></li><li><div>          wp_enqueue_style( $sUnique );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      protected function redirect( $insUrl, $innTimeout = 1 ) {&nbsp;</div></li><li><div>          echo '&nbsp;</div></li><li><div>          &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>              function redirect() {&nbsp;</div></li><li><div>                  window.location = &quot;'.$insUrl.'&quot;;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              var oTimer = setTimeout( &quot;redirect()&quot;, &quot;'.($innTimeout * 1000).'&quot; );&nbsp;</div></li><li><div>          &lt;/script&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Displays a message in the plugins listing when a plugin has an update available.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function onWpPluginUpdateMessage() {&nbsp;</div></li><li><div>          echo '&lt;div style=&quot;color: #dd3333;&quot;&gt;'&nbsp;</div></li><li><div>              .$this-&gt;getPluginsListUpdateMessage()&nbsp;</div></li><li><div>              . '&lt;/div&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function getPluginsListUpdateMessage() {&nbsp;</div></li><li><div>          return '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Hooked to 'deactivate_plugin' and can be used to interrupt the deactivation of this plugin.</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $insPlugin</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function onWpHookDeactivatePlugin( $insPlugin ) {&nbsp;</div></li><li><div>          if ( strpos( $insPlugin, $this-&gt;sPluginFileName ) !== false ) {&nbsp;</div></li><li><div>              $this-&gt;doPreventDeactivation( $insPlugin );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @param string $insPlugin - the path to the plugin file</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function doPreventDeactivation( $insPlugin ) {&nbsp;</div></li><li><div>          if ( !$this-&gt;hasPermissionToSubmit() ) {&nbsp;</div></li><li><div>              wp_die( 'Sorry, you do not have permission to disable this plugin. You need to authenticate first.' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Use this to wrap up the function when the PHP process is coming to an end.  Call from onWpShudown()</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function doPluginShutdown() { }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Hooked to 'shutdown'</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function onWpShutdown() {&nbsp;</div></li><li><div>          do_action( $this-&gt;doPluginPrefix( 'plugin_shutdown' ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function onWpActivatePlugin() { }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function onWpDeactivatePlugin() {&nbsp;</div></li><li><div>          if ( current_user_can( $this-&gt;oPluginVo-&gt;getBasePermissions() ) ) {&nbsp;</div></li><li><div>              do_action( $this-&gt;doPluginPrefix( 'delete_plugin_options' ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      public function onWpUninstallPlugin() { }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function flushCaches() {&nbsp;</div></li><li><div>          if (function_exists('w3tc_pgcache_flush')) {&nbsp;</div></li><li><div>              w3tc_pgcache_flush();&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function getImageUrl( $insImage ) {&nbsp;</div></li><li><div>          return $this-&gt;sPluginUrl.'resources/images/'.$insImage;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      protected function getCssUrl( $insCss ) {&nbsp;</div></li><li><div>          return $this-&gt;sPluginUrl.'resources/css/'.$insCss;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      protected function getJsUrl( $insJs ) {&nbsp;</div></li><li><div>          return $this-&gt;sPluginUrl.'resources/js/'.$insJs;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      public function onWpAdminBar() {&nbsp;</div></li><li><div>          $aNodes = $this-&gt;getAdminBarNodes();&nbsp;</div></li><li><div>          if ( !is_array( $aNodes ) ) {&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          foreach( $aNodes as $aNode )  {&nbsp;</div></li><li><div>              $this-&gt;addAdminBarNode( $aNode );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function getAdminBarNodes() { }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function addAdminBarNode( $aNode ) {&nbsp;</div></li><li><div>          global $wp_admin_bar;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( isset( $aNode['children'] ) ) {&nbsp;</div></li><li><div>              $aChildren = $aNode['children'];&nbsp;</div></li><li><div>              unset( $aNode['children'] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $wp_admin_bar-&gt;add_node( $aNode );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( !empty($aChildren) ) {&nbsp;</div></li><li><div>              foreach( $aChildren as $aChild ) {&nbsp;</div></li><li><div>                  $aChild['parent'] = $aNode['id'];&nbsp;</div></li><li><div>                  $this-&gt;addAdminBarNode( $aChild );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function getPluginLogoUrl16() {&nbsp;</div></li><li><div>          return $this-&gt;getImageUrl( 'pluginlogo_16x16.png' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      protected function getPluginLogoUrl32() {&nbsp;</div></li><li><div>          return $this-&gt;getImageUrl( 'pluginlogo_32x32.png' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @return ICWP_WPTB_DataProcessor</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function loadDataProcessor() {&nbsp;</div></li><li><div>          if ( !class_exists('ICWP_WPTB_DataProcessor') ) {&nbsp;</div></li><li><div>              require_once( dirname(__FILE__).'/icwp-data-processor.php' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          return ICWP_WPTB_DataProcessor::GetInstance();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @return ICWP_WPTB_WpFunctions</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function loadWpFunctions() {&nbsp;</div></li><li><div>          return ICWP_WPTB_WpFunctions::GetInstance();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * @return ICWP_WPTB_WpFilesystem</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      protected function loadWpFilesystem() {&nbsp;</div></li><li><div>          return ICWP_WPTB_WpFilesystem::GetInstance();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>endif;&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>WordPress Twitter Bootstrap CSS</li><li><span></span>3.3.7-1</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>