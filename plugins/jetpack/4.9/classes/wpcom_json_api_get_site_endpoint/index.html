<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="3.8.0" data-slug="jetpack-by-wordpress-com" data-type="class" data-id="13843"><head xmlns="http://www.w3.org/1999/xhtml"><title> wpcom_json_api_get_site_endpoint | class | Jetpack By WordPress Com | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="WPCOM_JSON_API_GET_Site_Endpoint, class, plugin, jetpack-by-wordpress-com, 3.8.0" /><meta name="description" content="The Jetpack by WordPress.com WPCOM JSON API GET Site Endpoint class." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.25"}};!function(e,n,t){var a;function i(e){var t=n.createElement("canvas"),a=t.getContext&&t.getContext("2d"),i=String.fromCharCode;return!(!a||!a.fillText)&&(a.textBaseline="top",a.font="600 32px Arial","flag"===e?(a.fillText(i(55356,56806,55356,56826),0,0),3e3<t.toDataURL().length):"diversity"===e?(a.fillText(i(55356,57221),0,0),t=a.getImageData(16,16,1,1).data,a.fillText(i(55356,57221,55356,57343),0,0),(t=a.getImageData(16,16,1,1).data)[0],t[1],t[2],t[3],!0):("simple"===e?a.fillText(i(55357,56835),0,0):a.fillText(i(55356,57135),0,0),0!==a.getImageData(16,16,1,1).data[0]))}function o(e){var t=n.createElement("script");t.src=e,t.type="text/javascript",n.getElementsByTagName("head")[0].appendChild(t)}t.supports={simple:i("simple"),flag:i("flag"),unicode8:i("unicode8"),diversity:i("diversity")},t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.simple&&t.supports.flag&&t.supports.unicode8&&t.supports.diversity||(a=function(){t.readyCallback()},n.addEventListener?(n.addEventListener("DOMContentLoaded",a,!1),e.addEventListener("load",a,!1)):(e.attachEvent("onload",a),n.attachEvent("onreadystatechange",function(){"complete"===n.readyState&&t.readyCallback()})),(a=t.source||{}).concatemoji?o(a.concatemoji):a.wpemoji&&a.twemoji&&(o(a.twemoji),o(a.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=57a07c5a5d5893d3a3c434e021694cd6' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.25' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/wpcom_json_api_get_site_endpoint/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fwpcom_json_api_get_site_endpoint%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fwpcom_json_api_get_site_endpoint%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-jetpack-by-wordpress-com-3.8.0-class-wpcom_json_api_get_site_endpoint","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wpcom_json_api_get_site_endpoint" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to jetpack-by-wordpress-com." href="http://hookr.io/plugins/jetpack-by-wordpress-com/" class="plugin"><span property="name">jetpack-by-wordpress-com</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 3.8.0." href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/" class="H_VERSION"><span property="name">3.8.0</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wpcom_json_api_get_site_endpo&hellip;</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="1499"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/all/" title="All">All <span class="count badge">1499</span></a></li><li class="" data-id="new" data-count="17"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/new/" title="New">New <span class="count badge">17</span></a></li><li class="" data-id="hooks" data-count="599"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/hooks/" title="Hooks">Hooks <span class="count badge">599</span></a></li><li class="" data-id="action" data-count="195"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/actions/" title="Actions">Actions <span class="count badge">195</span></a></li><li class="" data-id="filter" data-count="404"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/filters/" title="Filters">Filters <span class="count badge">404</span></a></li><li class="active" data-id="class" data-count="262"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/classes/" title="Classes">Classes <span class="count badge">262</span></a></li><li class="" data-id="constant" data-count="62"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/constants/" title="Constants">Constants <span class="count badge">62</span></a></li><li class="" data-id="function" data-count="530"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/functions/" title="Functions">Functions <span class="count badge">530</span></a></li><li class="" data-id="shortcode" data-count="46"><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">46</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>WPCOM_JSON_API_GET_Site_Endpoint</strong></h1><p>The Jetpack by WordPress.com <strong>WPCOM JSON API GET Site Endpoint</strong> class.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/files/json-endpoints-class-wpcom-json-api-get-site-endpoint/" class="file">/json-endpoints/class.wpcom-json-api-get-site-endpoint.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="3" class="block" start="3"><li><div>class WPCOM_JSON_API_GET_Site_Endpoint extends WPCOM_JSON_API_Endpoint {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public static $site_format = array(&nbsp;</div></li><li><div>         'ID' =&gt; '(int) Site ID', &nbsp;</div></li><li><div>         'name' =&gt; '(string) Title of site', &nbsp;</div></li><li><div>         'description' =&gt; '(string) Tagline or description of site', &nbsp;</div></li><li><div>         'URL' =&gt; '(string) Full URL to the site', &nbsp;</div></li><li><div>         'jetpack' =&gt; '(bool)  Whether the site is a Jetpack site or not', &nbsp;</div></li><li><div>         'post_count' =&gt; '(int) The number of posts the site has', &nbsp;</div></li><li><div>        'subscribers_count' =&gt; '(int) The number of subscribers the site has', &nbsp;</div></li><li><div>        'lang' =&gt; '(string) Primary language code of the site', &nbsp;</div></li><li><div>        'icon' =&gt; '(array) An array of icon formats for the site', &nbsp;</div></li><li><div>        'logo' =&gt; '(array) The site logo, set in the Customizer', &nbsp;</div></li><li><div>        'visible' =&gt; '(bool) If this site is visible in the user\'s site list', &nbsp;</div></li><li><div>        'is_private' =&gt; '(bool) If the site is a private site or not', &nbsp;</div></li><li><div>        'is_following' =&gt; '(bool) If the current user is subscribed to this site in the reader', &nbsp;</div></li><li><div>        'options' =&gt; '(array) An array of options/settings for the blog. Only viewable by users with post editing rights to the site. Note: Post formats is deprecated, please see /sites/$id/post-formats/', &nbsp;</div></li><li><div>        'updates' =&gt; '(array) An array of available updates for plugins, themes, wordpress, and languages.', &nbsp;</div></li><li><div>        'meta' =&gt; '(object) Meta data', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // /sites/mine&nbsp;</div></li><li><div>    // /sites/%s -&gt; $blog_id&nbsp;</div></li><li><div>    function callback( $path = '', $blog_id = 0 ) {&nbsp;</div></li><li><div>        global $wpdb;&nbsp;</div></li><li><div>        if ( 'mine' === $blog_id ) {&nbsp;</div></li><li><div>            $api = WPCOM_JSON_API::init();&nbsp;</div></li><li><div>            if ( !$api-&gt;token_details || empty( $api-&gt;token_details['blog_id'] ) ) {&nbsp;</div></li><li><div>                return new WP_Error( 'authorization_required', 'An active access token must be used to query information about the current blog.', 403 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $blog_id = $api-&gt;token_details['blog_id'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $blog_id = $this-&gt;api-&gt;switch_to_blog_and_validate_user( $this-&gt;api-&gt;get_blog_id( $blog_id ) );&nbsp;</div></li><li><div>        if ( is_wp_error( $blog_id ) ) {&nbsp;</div></li><li><div>            return $blog_id;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $response = $this-&gt;build_current_site_response();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /** This action is documented in json-endpoints/class.wpcom-json-api-site-settings-endpoint.php */&nbsp;</div></li><li><div>        do_action( 'wpcom_json_api_objects', 'sites' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $response;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Collects the necessary information to return for a site's response.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return (array)&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function build_current_site_response( ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        global $wpdb, $wp_version;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $response_format = self::$site_format;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $is_user_logged_in = is_user_logged_in();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $visible = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $is_user_logged_in ) {&nbsp;</div></li><li><div>            $current_user = wp_get_current_user();&nbsp;</div></li><li><div>            $visible = get_user_meta( $current_user-&gt;ID, 'blog_visibility', true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( !is_array( $visible ) )&nbsp;</div></li><li><div>                $visible = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $blog_id = (int) $this-&gt;api-&gt;get_blog_id_for_output();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /** This filter is documented in class.json-api-endpoints.php */&nbsp;</div></li><li><div>        $is_jetpack = true === apply_filters( 'is_jetpack_site', false, $blog_id );&nbsp;</div></li><li><div>        $site_url = get_option( 'siteurl' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $is_jetpack ) {&nbsp;</div></li><li><div>            remove_filter( 'option_stylesheet', 'fix_theme_location' );&nbsp;</div></li><li><div>            if ( 'https' !== parse_url( $site_url, PHP_URL_SCHEME ) ) {&nbsp;</div></li><li><div>                add_filter( 'set_url_scheme', array( $this, 'force_http' ), 10, 3 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        foreach ( array_keys( $response_format ) as $key ) {&nbsp;</div></li><li><div>            switch ( $key ) {&nbsp;</div></li><li><div>            case 'ID' :&nbsp;</div></li><li><div>                $response[$key] = $blog_id;&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'name' :&nbsp;</div></li><li><div>                $response[$key] = (string) htmlspecialchars_decode( get_bloginfo( 'name' ), ENT_QUOTES );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'description' :&nbsp;</div></li><li><div>                $response[$key] = (string) htmlspecialchars_decode( get_bloginfo( 'description' ), ENT_QUOTES );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'URL' :&nbsp;</div></li><li><div>                $response[$key] = (string) home_url();&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'jetpack' :&nbsp;</div></li><li><div>                $response[$key] = $is_jetpack; // jetpack magic affects this value&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'is_private' :&nbsp;</div></li><li><div>                if ( defined( 'IS_WPCOM' ) && IS_WPCOM ) {&nbsp;</div></li><li><div>                    $public_setting = get_option( 'blog_public' );&nbsp;</div></li><li><div>                    if ( -1 == $public_setting )&nbsp;</div></li><li><div>                        $response[$key] = true;&nbsp;</div></li><li><div>                    else&nbsp;</div></li><li><div>                        $response[$key] = false;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $response[$key] = false; // magic&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'visible' :&nbsp;</div></li><li><div>                if ( $is_user_logged_in ) {&nbsp;</div></li><li><div>                    $is_visible = true;&nbsp;</div></li><li><div>                    if ( isset( $visible[$blog_id] ) ) {&nbsp;</div></li><li><div>                        $is_visible = (bool) $visible[$blog_id];&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    // null and true are visible&nbsp;</div></li><li><div>                    $response[$key] = $is_visible;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'post_count' :&nbsp;</div></li><li><div>                if ( $is_user_logged_in )&nbsp;</div></li><li><div>                    $response[$key] = (int) $wpdb-&gt;get_var(&quot;SELECT COUNT(*) FROM $wpdb-&gt;posts WHERE post_status = 'publish'&quot;);&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'lang' :&nbsp;</div></li><li><div>                if ( $is_user_logged_in )&nbsp;</div></li><li><div>                    $response[$key] = (string) get_bloginfo( 'language' );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'icon' :&nbsp;</div></li><li><div>                if ( function_exists( 'blavatar_domain' ) && function_exists( 'blavatar_exists' ) && function_exists( 'blavatar_url' ) ) {&nbsp;</div></li><li><div>                    $domain = blavatar_domain( home_url() );&nbsp;</div></li><li><div>                    if ( blavatar_exists( $domain ) ) {&nbsp;</div></li><li><div>                        $response[ $key ] = array(&nbsp;</div></li><li><div>                            'img' =&gt; (string) remove_query_arg( 's', blavatar_url( $domain, 'img' ) ), &nbsp;</div></li><li><div>                            'ico' =&gt; (string) remove_query_arg( 's', blavatar_url( $domain, 'ico' ) ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        // This is done so that we can access the updated blavatar on .com via the /me/sites endpoint&nbsp;</div></li><li><div>                        if( is_jetpack_site() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            $site_icon_url = get_option( 'jetpack_site_icon_url' );&nbsp;</div></li><li><div>                            if( $site_icon_url ) {&nbsp;</div></li><li><div>                                $response[ $key ] = array(&nbsp;</div></li><li><div>                                    'img' =&gt; (string) jetpack_photon_url( $site_icon_url, array() , 'https' ), &nbsp;</div></li><li><div>                                    'ico' =&gt; (string) jetpack_photon_url( $site_icon_url, array( 'w' =&gt; 16 ), 'https' )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                   }&nbsp;</div></li><li><div>                } elseif ( function_exists( 'jetpack_site_icon_url' ) && function_exists( 'jetpack_photon_url' ) ) {&nbsp;</div></li><li><div>                    $response[ $key ] = array(&nbsp;</div></li><li><div>                        'img' =&gt; (string) jetpack_photon_url( jetpack_site_icon_url( get_current_blog_id() , 80 ), array( 'w' =&gt; 80 ), 'https' ), &nbsp;</div></li><li><div>                        'ico' =&gt; (string) jetpack_photon_url( jetpack_site_icon_url( get_current_blog_id() , 16 ), array( 'w' =&gt; 16 ), 'https' ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'logo' :&nbsp;</div></li><li><div>                // Set an empty response array.&nbsp;</div></li><li><div>                $response[$key] = array(&nbsp;</div></li><li><div>                    'id' =&gt; (int) 0, &nbsp;</div></li><li><div>                    'sizes' =&gt; array(), &nbsp;</div></li><li><div>                    'url' =&gt; '', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // Get current site logo values.&nbsp;</div></li><li><div>                $logo = get_option( 'site_logo' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // Update the response array if there's a site logo currenty active.&nbsp;</div></li><li><div>                if ( $logo && 0 != $logo['id'] ) {&nbsp;</div></li><li><div>                    $response[$key]['id'] = $logo['id'];&nbsp;</div></li><li><div>                    $response[$key]['url'] = $logo['url'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    foreach ( $logo['sizes'] as $size =&gt; $properties ) {&nbsp;</div></li><li><div>                        $response[$key]['sizes'][$size] = $properties;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'subscribers_count' :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( function_exists( 'wpcom_subs_total_wpcom_subscribers' ) ) {&nbsp;</div></li><li><div>                    $total_wpcom_subs = wpcom_subs_total_wpcom_subscribers(&nbsp;</div></li><li><div>                        array(&nbsp;</div></li><li><div>                            'blog_id' =&gt; $blog_id, &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                    $response[$key] = $total_wpcom_subs;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $response[$key] = 0; // magic&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'is_following':&nbsp;</div></li><li><div>                $response[$key] = (bool) $this-&gt;api-&gt;is_following( $blog_id );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'options':&nbsp;</div></li><li><div>                // Figure out if the blog supports VideoPress, have to do some extra checking for JP blogs&nbsp;</div></li><li><div>                $has_videopress = false;&nbsp;</div></li><li><div>                if ( get_option( 'video_upgrade' ) == '1' ) {&nbsp;</div></li><li><div>                    $has_videopress = true;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    if ( class_exists( 'Jetpack_Options' ) ) {&nbsp;</div></li><li><div>                        $videopress = Jetpack_Options::get_option( 'videopress', array() );&nbsp;</div></li><li><div>                        if ( isset( $videopress['blog_id'] ) && $videopress['blog_id'] &gt; 0 ) {&nbsp;</div></li><li><div>                            $has_videopress = true;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // deprecated - see separate endpoint. get a list of supported post formats&nbsp;</div></li><li><div>                $all_formats = get_post_format_strings();&nbsp;</div></li><li><div>                $supported = get_theme_support( 'post-formats' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $supported_formats = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( isset( $supported[0] ) ) {&nbsp;</div></li><li><div>                    foreach ( $supported[0] as $format ) {&nbsp;</div></li><li><div>                        $supported_formats[ $format ] = $all_formats[ $format ];&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // determine if sharing buttons should be visible by default&nbsp;</div></li><li><div>                $default_sharing_status = false;&nbsp;</div></li><li><div>                if ( class_exists( 'Sharing_Service' ) ) {&nbsp;</div></li><li><div>                    $ss = new Sharing_Service();&nbsp;</div></li><li><div>                    $blog_services = $ss-&gt;get_blog_services();&nbsp;</div></li><li><div>                    $default_sharing_status = ! empty( $blog_services['visible'] );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $is_mapped_domain = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( function_exists( 'get_primary_redirect' ) ) {&nbsp;</div></li><li><div>                    $primary_redirect = strtolower( get_primary_redirect() );&nbsp;</div></li><li><div>                    if ( false === strpos( $primary_redirect, '.wordpress.com' ) ) {&nbsp;</div></li><li><div>                        $is_mapped_domain = true;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $is_redirect = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( function_exists( 'get_primary_domain_mapping_record' ) ) {&nbsp;</div></li><li><div>                    if ( get_primary_domain_mapping_record()-&gt;type == 1 ) {&nbsp;</div></li><li><div>                        $is_redirect = true;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( function_exists( 'get_mime_types' ) ) {&nbsp;</div></li><li><div>                    $allowed_file_types = get_mime_types();&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    // http://codex.wordpress.org/Uploading_Files&nbsp;</div></li><li><div>                    $mime_types = get_allowed_mime_types();&nbsp;</div></li><li><div>                    foreach ( $mime_types as $type =&gt; $mime_type ) {&nbsp;</div></li><li><div>                        $extras = explode( '|', $type );&nbsp;</div></li><li><div>                        foreach ( $extras as $extra ) {&nbsp;</div></li><li><div>                            $allowed_file_types[] = $extra;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( function_exists( 'get_blog_details' ) ) {&nbsp;</div></li><li><div>                    $blog_details = get_blog_details();&nbsp;</div></li><li><div>                    if ( ! empty( $blog_details-&gt;registered ) ) {&nbsp;</div></li><li><div>                        $registered_date = $blog_details-&gt;registered;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $upgraded_filetypes_enabled = false;&nbsp;</div></li><li><div>                if ( $is_jetpack || get_option( 'use_upgraded_upload_filetypes' ) ) {&nbsp;</div></li><li><div>                    $upgraded_filetypes_enabled = true;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $wordads = false;&nbsp;</div></li><li><div>                if ( function_exists( 'has_any_blog_stickers' ) ) {&nbsp;</div></li><li><div>                    $wordads = has_any_blog_stickers( array( 'wordads-approved', 'wordads-approved-misfits' ), $blog_id );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $response[$key] = array(&nbsp;</div></li><li><div>                    'timezone' =&gt; (string) get_option( 'timezone_string' ), &nbsp;</div></li><li><div>                    'gmt_offset' =&gt; (float) get_option( 'gmt_offset' ), &nbsp;</div></li><li><div>                    'videopress_enabled' =&gt; $has_videopress, &nbsp;</div></li><li><div>                    'upgraded_filetypes_enabled' =&gt;  $upgraded_filetypes_enabled, &nbsp;</div></li><li><div>                    'login_url' =&gt; wp_login_url(), &nbsp;</div></li><li><div>                    'admin_url' =&gt; get_admin_url(), &nbsp;</div></li><li><div>                    'is_mapped_domain' =&gt; $is_mapped_domain, &nbsp;</div></li><li><div>                    'is_redirect' =&gt; $is_redirect, &nbsp;</div></li><li><div>                    'unmapped_url' =&gt; get_site_url( $blog_id ), &nbsp;</div></li><li><div>                    'featured_images_enabled' =&gt; current_theme_supports( 'post-thumbnails' ), &nbsp;</div></li><li><div>                    'theme_slug' =&gt; get_option( 'stylesheet' ), &nbsp;</div></li><li><div>                    'header_image' =&gt; get_theme_mod( 'header_image_data' ), &nbsp;</div></li><li><div>                    'background_color' =&gt; get_theme_mod( 'background_color' ), &nbsp;</div></li><li><div>                    'image_default_link_type' =&gt; get_option( 'image_default_link_type' ), &nbsp;</div></li><li><div>                    'image_thumbnail_width' =&gt; (int)  get_option( 'thumbnail_size_w' ), &nbsp;</div></li><li><div>                    'image_thumbnail_height' =&gt; (int)  get_option( 'thumbnail_size_h' ), &nbsp;</div></li><li><div>                    'image_thumbnail_crop' =&gt; get_option( 'thumbnail_crop' ), &nbsp;</div></li><li><div>                    'image_medium_width' =&gt; (int)  get_option( 'medium_size_w' ), &nbsp;</div></li><li><div>                    'image_medium_height' =&gt; (int)  get_option( 'medium_size_h' ), &nbsp;</div></li><li><div>                    'image_large_width' =&gt; (int)  get_option( 'large_size_w' ), &nbsp;</div></li><li><div>                    'image_large_height' =&gt; (int) get_option( 'large_size_h' ), &nbsp;</div></li><li><div>                    'permalink_structure' =&gt; get_option( 'permalink_structure' ), &nbsp;</div></li><li><div>                    'post_formats' =&gt; $supported_formats, &nbsp;</div></li><li><div>                    'default_post_format' =&gt; get_option( 'default_post_format' ), &nbsp;</div></li><li><div>                    'default_category' =&gt; (int) get_option( 'default_category' ), &nbsp;</div></li><li><div>                    'allowed_file_types' =&gt; $allowed_file_types, &nbsp;</div></li><li><div>                    'show_on_front' =&gt; get_option( 'show_on_front' ), &nbsp;</div></li><li><div>                    /** This filter is documented in modules/likes.php */&nbsp;</div></li><li><div>                    'default_likes_enabled' =&gt; (bool) apply_filters( 'wpl_is_enabled_sitewide', ! get_option( 'disabled_likes' ) ), &nbsp;</div></li><li><div>                    'default_sharing_status' =&gt; (bool) $default_sharing_status, &nbsp;</div></li><li><div>                    'default_comment_status' =&gt; ( 'closed' == get_option( 'default_comment_status' ) ? false : true ), &nbsp;</div></li><li><div>                    'default_ping_status' =&gt; ( 'closed' == get_option( 'default_ping_status' ) ? false : true ), &nbsp;</div></li><li><div>                    'software_version' =&gt; $wp_version, &nbsp;</div></li><li><div>                    'created_at' =&gt; ! empty( $registered_date ) ? $this-&gt;format_date( $registered_date ) : '0000-00-00T00:00:00+00:00', &nbsp;</div></li><li><div>                    'wordads' =&gt; $wordads, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( 'page' === get_option( 'show_on_front' ) ) {&nbsp;</div></li><li><div>                    $response['options']['page_on_front'] = (int) get_option( 'page_on_front' );&nbsp;</div></li><li><div>                    $response['options']['page_for_posts'] = (int) get_option( 'page_for_posts' );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( $is_jetpack ) {&nbsp;</div></li><li><div>                    $response['options']['jetpack_version'] = get_option( 'jetpack_version' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( get_option( 'jetpack_main_network_site' ) ) {&nbsp;</div></li><li><div>                        $response['options']['main_network_site'] = (string) rtrim( get_option( 'jetpack_main_network_site' ), '/' );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( is_array( Jetpack_Options::get_option( 'active_modules' ) ) ) {&nbsp;</div></li><li><div>                        $response['options']['active_modules'] = (array) array_values( Jetpack_Options::get_option( 'active_modules' ) );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( $jetpack_wp_version = get_option( 'jetpack_wp_version' ) ) {&nbsp;</div></li><li><div>                        $response['options']['software_version'] = (string) $jetpack_wp_version;&nbsp;</div></li><li><div>                    } else if ( $jetpack_update = get_option( 'jetpack_updates' ) ) {&nbsp;</div></li><li><div>                        if ( is_array( $jetpack_update ) && isset( $jetpack_update['wp_version'] ) ) {&nbsp;</div></li><li><div>                            $response['options']['software_version'] = (string) $jetpack_update['wp_version'];&nbsp;</div></li><li><div>                        } else {&nbsp;</div></li><li><div>                            $response[ 'options' ][ 'software_version' ] = null;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $response['options']['software_version'] = null;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $response['options']['max_upload_size'] = get_option( 'jetpack_max_upload_size', false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    // Sites have to prove that they are not main_network site.&nbsp;</div></li><li><div>                    // If the sync happends right then we should be able to see that we are not dealing with a network site&nbsp;</div></li><li><div>                    $response['options']['is_multi_network'] = (bool) get_option( 'jetpack_is_main_network', true );&nbsp;</div></li><li><div>                    $response['options']['is_multi_site'] = (bool) get_option( 'jetpack_is_multi_site', true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( ! current_user_can( 'edit_posts' ) )&nbsp;</div></li><li><div>                    unset( $response[$key] );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'meta' :&nbsp;</div></li><li><div>                /**&nbsp;</div></li><li><div>                 * Filters the URL scheme used when querying your site's REST API endpoint.&nbsp;</div></li><li><div>                 *&nbsp;</div></li><li><div>                 * @module json-api&nbsp;</div></li><li><div>                 *&nbsp;</div></li><li><div>                 * @since 3.2.0&nbsp;</div></li><li><div>                 *&nbsp;</div></li><li><div>                 * @param string parse_url( get_option( 'home' ), PHP_URL_SCHEME ) URL scheme parsed from home URL.&nbsp;</div></li><li><div>                 */&nbsp;</div></li><li><div>                $xmlrpc_scheme = apply_filters( 'wpcom_json_api_xmlrpc_scheme', parse_url( get_option( 'home' ), PHP_URL_SCHEME ) );&nbsp;</div></li><li><div>                $xmlrpc_url = site_url( 'xmlrpc.php', $xmlrpc_scheme );&nbsp;</div></li><li><div>                $response[$key] = (object) array(&nbsp;</div></li><li><div>                    'links' =&gt; (object) array(&nbsp;</div></li><li><div>                        'self' =&gt; (string) $this-&gt;get_site_link( $blog_id ), &nbsp;</div></li><li><div>                        'help' =&gt; (string) $this-&gt;get_site_link( $blog_id, 'help' ), &nbsp;</div></li><li><div>                        'posts' =&gt; (string) $this-&gt;get_site_link( $blog_id, 'posts/' ), &nbsp;</div></li><li><div>                        'comments' =&gt; (string) $this-&gt;get_site_link( $blog_id, 'comments/' ), &nbsp;</div></li><li><div>                        'xmlrpc' =&gt; (string) $xmlrpc_url, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $is_jetpack ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Add the updates only make them visible if the user has manage options permission.&nbsp;</div></li><li><div>            $jetpack_update = (array) get_option( 'jetpack_updates' );&nbsp;</div></li><li><div>            if ( ! empty( $jetpack_update ) && current_user_can( 'manage_options' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( isset( $jetpack_update['wp_version'] ) ) {&nbsp;</div></li><li><div>                    // In previous version of Jetpack 3.4, 3.5, 3.6 we synced the wp_version into to jetpack_updates&nbsp;</div></li><li><div>                    unset( $jetpack_update['wp_version'] );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( isset( $jetpack_update['site_is_version_controlled'] ) ) {&nbsp;</div></li><li><div>                    // In previous version of Jetpack 3.4, 3.5, 3.6 we synced the site_is_version_controlled into to jetpack_updates&nbsp;</div></li><li><div>                    unset( $jetpack_update['site_is_version_controlled'] );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $response['updates'] = (array) $jetpack_update;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            add_filter( 'option_stylesheet', 'fix_theme_location' );&nbsp;</div></li><li><div>            if ( 'https' !== parse_url( $site_url, PHP_URL_SCHEME ) ) {&nbsp;</div></li><li><div>                remove_filter( 'set_url_scheme', array( $this, 'force_http' ), 10, 3 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $response;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function force_http( $url, $scheme, $orig_scheme ) {&nbsp;</div></li><li><div>        return preg_replace('/^https:\/\//', 'http://', $url, 1 );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 3.7.1</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.2/classes/wpcom_json_api_get_site_endpoint/" class="">3.8.2</a></li><li><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.1/classes/wpcom_json_api_get_site_endpoint/" class="">3.8.1</a></li><li><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.8.0/classes/wpcom_json_api_get_site_endpoint/" class="active">3.8.0</a></li><li><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.7.2/classes/wpcom_json_api_get_site_endpoint/" class="">3.7.2</a></li><li><a href="http://hookr.io/plugins/jetpack-by-wordpress-com/3.7.1/classes/wpcom_json_api_get_site_endpoint/" class="">3.7.1</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>WPCOM_JSON_API_GET_Site_Endpoint</li><li><span></span>Jetpack by WordPress.com</li><li><span></span>3.8.2</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2021 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>