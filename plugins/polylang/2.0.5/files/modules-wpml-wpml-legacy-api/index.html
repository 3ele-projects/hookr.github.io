<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="2.0.5" data-slug="polylang" data-type="file" data-id="63846"><head xmlns="http://www.w3.org/1999/xhtml"><title> modules-wpml-wpml-legacy-api | file | Polylang | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, polylang, 2.0.5" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.8"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=4533fe65d37ec32aadde1e1af913e07d' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.8' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/modules-wpml-wpml-legacy-api/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fmodules-wpml-wpml-legacy-api%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fmodules-wpml-wpml-legacy-api%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-polylang-2.0.5-file-modules-wpml-wpml-legacy-api","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="modules-wpml-wpml-legacy-api" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to polylang." href="http://hookr.io/plugins/polylang/" class="plugin"><span property="name">polylang</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.0.5." href="http://hookr.io/plugins/polylang/2.0.5/" class="H_VERSION"><span property="name">2.0.5</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/polylang/2.0.5/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">modules-wpml-wpml-legacy-api</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="230"><a href="http://hookr.io/plugins/polylang/2.0.5/all/" title="All">All <span class="count badge">230</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/polylang/2.0.5/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="85"><a href="http://hookr.io/plugins/polylang/2.0.5/hooks/" title="Hooks">Hooks <span class="count badge">85</span></a></li><li class="" data-id="action" data-count="21"><a href="http://hookr.io/plugins/polylang/2.0.5/actions/" title="Actions">Actions <span class="count badge">21</span></a></li><li class="" data-id="filter" data-count="64"><a href="http://hookr.io/plugins/polylang/2.0.5/filters/" title="Filters">Filters <span class="count badge">64</span></a></li><li class="" data-id="class" data-count="83"><a href="http://hookr.io/plugins/polylang/2.0.5/classes/" title="Classes">Classes <span class="count badge">83</span></a></li><li class="" data-id="constant" data-count="23"><a href="http://hookr.io/plugins/polylang/2.0.5/constants/" title="Constants">Constants <span class="count badge">23</span></a></li><li class="" data-id="function" data-count="39"><a href="http://hookr.io/plugins/polylang/2.0.5/functions/" title="Functions">Functions <span class="count badge">39</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/plugins/polylang/2.0.5/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/modules/wpml/wpml-legacy-api.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Compatibility with WPML legacy API</span>&nbsp;</div></li><li><div><span class="comment"> * Deprecated since WPML 3.2 and no more documented</span>&nbsp;</div></li><li><div><span class="comment"> * But a lot of 3rd party plugins / themes are still using these functions</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Link to the home page in the active language</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 0.9.4</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'icl_get_home_url' ) ) {&nbsp;</div></li><li><div>  function icl_get_home_url() {&nbsp;</div></li><li><div>      return pll_home_url();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Used for building custom language selectors</span>&nbsp;</div></li><li><div><span class="comment"> * available only on frontend</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * list of paramaters accepted in $args</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * skip_missing =&gt; wether to skip missing translation or not, 0 or 1, defaults to 0</span>&nbsp;</div></li><li><div><span class="comment"> * orderby =&gt; 'id', 'code', 'name', defaults to 'id'</span>&nbsp;</div></li><li><div><span class="comment"> * order =&gt; 'ASC' or 'DESC', defaults to 'ASC'</span>&nbsp;</div></li><li><div><span class="comment"> * link_empty_to =&gt; link to use when the translation is missing {$lang} is replaced by the language code</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * list of parameters returned per language:</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * id =&gt; the language id</span>&nbsp;</div></li><li><div><span class="comment"> * active =&gt; wether this is the active language or no, 0 or 1</span>&nbsp;</div></li><li><div><span class="comment"> * native_name =&gt; the language name</span>&nbsp;</div></li><li><div><span class="comment"> * missing =&gt; wether the translation is missing or not, 0 or 1</span>&nbsp;</div></li><li><div><span class="comment"> * translated_name =&gt; empty, does not exist in Polylang</span>&nbsp;</div></li><li><div><span class="comment"> * language_code =&gt; the language code ( slug )</span>&nbsp;</div></li><li><div><span class="comment"> * country_flag_url =&gt; the url of the flag</span>&nbsp;</div></li><li><div><span class="comment"> * url =&gt; the url of the translation</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string|array $args optional</span>&nbsp;</div></li><li><div><span class="comment"> * @return array array of arrays per language</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'icl_get_languages' ) ) {&nbsp;</div></li><li><div>  function icl_get_languages( $args = '' ) {&nbsp;</div></li><li><div>      $args = wp_parse_args( $args, array( 'skip_missing' =&gt; 0, 'orderby' =&gt; 'id', 'order' =&gt; 'ASC' ) );&nbsp;</div></li><li><div>      $orderby = ( isset( $args['orderby'] ) && 'code' == $args['orderby'] ) ? 'slug' : ( isset( $args['orderby'] ) && 'name' == $args['orderby'] ? 'name' : 'id' );&nbsp;</div></li><li><div>      $order = ( ! empty( $args['order'] ) && 'desc' == $args['order'] ) ? 'DESC' : 'ASC';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $arr = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( PLL()-&gt;model-&gt;get_languages_list( array( 'hide_empty' =&gt; true, 'orderby' =&gt; $orderby, 'order' =&gt; $order ) ) as $lang ) {&nbsp;</div></li><li><div>          <span class="comment">// We can find a translation only on frontend</span>&nbsp;</div></li><li><div>          if ( method_exists( PLL()-&gt;links, 'get_translation_url' ) ) {&nbsp;</div></li><li><div>              $url = PLL()-&gt;links-&gt;get_translation_url( $lang );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// It seems that WPML does not bother of skip_missing parameter on admin side and before the $wp_query object has been filled</span>&nbsp;</div></li><li><div>          if ( empty( $url ) && ! empty( $args['skip_missing'] ) && ! is_admin() && did_action( 'parse_query' ) ) {&nbsp;</div></li><li><div>              continue;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $arr[ $lang-&gt;slug ] = array(&nbsp;</div></li><li><div>              'id' =&gt; $lang-&gt;term_id, &nbsp;</div></li><li><div>              'active' =&gt; isset( PLL()-&gt;curlang-&gt;slug ) && PLL()-&gt;curlang-&gt;slug == $lang-&gt;slug ? 1 : 0, &nbsp;</div></li><li><div>              'native_name' =&gt; $lang-&gt;name, &nbsp;</div></li><li><div>              'missing' =&gt; empty( $url ) ? 1 : 0, &nbsp;</div></li><li><div>              'translated_name' =&gt; '', <span class="comment">// Does not exist in Polylang</span>&nbsp;</div></li><li><div>              'language_code' =&gt; $lang-&gt;slug, &nbsp;</div></li><li><div>              'country_flag_url' =&gt; $lang-&gt;flag_url, &nbsp;</div></li><li><div>              'url' =&gt; ! empty( $url ) ? $url :&nbsp;</div></li><li><div>                  ( empty( $args['link_empty_to'] ) ? PLL()-&gt;links-&gt;get_home_url( $lang ) :&nbsp;</div></li><li><div>                  str_replace( '{$lang}', $lang-&gt;slug, $args['link_empty_to'] ) ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return $arr;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Used for creating language dependent links in themes</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0 add support for arguments 6 and 7</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $id                         object id</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $type                       optional, post type or taxonomy name of the object, defaults to 'post'</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $text                       optional, the link text. If not specified will produce the name of the element in the current language</span>&nbsp;</div></li><li><div><span class="comment"> * @param array  $args                       optional, an array of arguments to add to the link, defaults to empty</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $anchor                     optional, the anchor to add to the link, defaults to empty</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool   $echo                       optional, whether to echo the link, defaults to true</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool   $return_original_if_missing optional, whether to return a value if the translation is missing</span>&nbsp;</div></li><li><div><span class="comment"> * @return string a language dependent link</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'icl_link_to_element' ) ) {&nbsp;</div></li><li><div>  function icl_link_to_element( $id, $type = 'post', $text = '', $args = array(), $anchor = '', $echo = true, $return_original_if_missing = true ) {&nbsp;</div></li><li><div>      if ( 'tag' == $type ) {&nbsp;</div></li><li><div>          $type = 'post_tag';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $pll_type = ( 'post' == $type || pll_is_translated_post_type( $type ) ) ? 'post' : ( 'term' == $type || pll_is_translated_taxonomy( $type ) ? 'term' : false );&nbsp;</div></li><li><div>      if ( $pll_type && ( $lang = pll_current_language() ) && ( $tr_id = PLL()-&gt;model-&gt;$pll_type-&gt;get_translation( $id, $lang ) ) && PLL()-&gt;links-&gt;current_user_can_read( $tr_id ) ) {&nbsp;</div></li><li><div>          $id = $tr_id;&nbsp;</div></li><li><div>      } elseif ( ! $return_original_if_missing ) {&nbsp;</div></li><li><div>          return '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( post_type_exists( $type ) ) {&nbsp;</div></li><li><div>          $link = get_permalink( $id );&nbsp;</div></li><li><div>          if ( empty( $text ) ) {&nbsp;</div></li><li><div>              $text = get_the_title( $id );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      } elseif ( taxonomy_exists( $type ) ) {&nbsp;</div></li><li><div>          $link = wpcom_vip_get_term_link( $id, $type );&nbsp;</div></li><li><div>          if ( empty( $text ) && ( $term = get_term( $id, $type ) ) && ! empty( $term ) && ! is_wp_error( $term ) ) {&nbsp;</div></li><li><div>              $text = $term-&gt;name;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $link ) || is_wp_error( $link ) ) {&nbsp;</div></li><li><div>          return '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $args ) ) {&nbsp;</div></li><li><div>          $link .= ( false === strpos( $link, '?' ) ? '?' : '&' ) . http_build_query( $args );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $anchor ) ) {&nbsp;</div></li><li><div>          $link .= '#' . $anchor;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $link = sprintf( '&lt;a href=&quot;%s&quot;&gt;%s&lt;/a&gt;', esc_url( $link ), esc_html( $text ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $echo ) {&nbsp;</div></li><li><div>          echo $link;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $link;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Used for calculating the IDs of objects (usually categories) in the current language</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 0.9.5</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int    $id                         object id</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $type                       post type or taxonomy name of the object, defaults to 'post'</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool   $return_original_if_missing optional, true if Polylang should return the original id if the translation is missing, defaults to false</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $lang                       optional, language code, defaults to current language</span>&nbsp;</div></li><li><div><span class="comment"> * @return int|null the object id of the translation, null if the translation is missing and $return_original_if_missing set to false</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'icl_object_id' ) ) {&nbsp;</div></li><li><div>  function icl_object_id( $id, $type, $return_original_if_missing = false, $lang = false ) {&nbsp;</div></li><li><div>      $pll_type = ( 'post' === $type || pll_is_translated_post_type( $type ) ) ? 'post' : ( 'term' === $type || pll_is_translated_taxonomy( $type ) ? 'term' : false );&nbsp;</div></li><li><div>      return $pll_type && ( $lang = $lang ? $lang : pll_current_language() ) && ( $tr_id = PLL()-&gt;model-&gt;$pll_type-&gt;get_translation( $id, $lang ) ) ? $tr_id :&nbsp;</div></li><li><div>          ( $return_original_if_missing ? $id : null );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Undocumented function used by the theme Maya</span>&nbsp;</div></li><li><div><span class="comment"> * returns the post language</span>&nbsp;</div></li><li><div><span class="comment"> * @see original WPML code at https://wpml.org/forums/topic/canonical-urls-for-wpml-duplicated-posts/#post-52198</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.8</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param null $empty   optional, not used</span>&nbsp;</div></li><li><div><span class="comment"> * @param int  $post_id optional, post id, defaults to current post</span>&nbsp;</div></li><li><div><span class="comment"> * @return array</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'wpml_get_language_information' ) ) {&nbsp;</div></li><li><div>  function wpml_get_language_information( $empty = null, $post_id = null ) {&nbsp;</div></li><li><div>      if ( empty( $post_id ) ) {&nbsp;</div></li><li><div>          $post_id = get_the_ID();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// FIXME WPML may return a WP_Error object</span>&nbsp;</div></li><li><div>      return false === $lang = PLL()-&gt;model-&gt;post-&gt;get_language( $post_id ) ? array() : array(&nbsp;</div></li><li><div>          'locale' =&gt; $lang-&gt;locale, &nbsp;</div></li><li><div>          'text_direction' =&gt; $lang-&gt;is_rtl, &nbsp;</div></li><li><div>          'display_name' =&gt; $lang-&gt;name, <span class="comment">// Seems to be the post language name displayed in the current language, not a feature in Polylang</span>&nbsp;</div></li><li><div>          'native_name' =&gt; $lang-&gt;name, &nbsp;</div></li><li><div>          'different_language' =&gt; $lang-&gt;slug != pll_current_language(), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Registers a string for translation in the &quot;strings translation&quot; panel</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 0.9.3</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $context           the group in which the string is registered, defaults to 'polylang'</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $name              a unique name for the string</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $string            the string to register</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool   $allow_empty_value not used</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $source_lang       not used by Polylang</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'icl_register_string' ) ) {&nbsp;</div></li><li><div>  function icl_register_string( $context, $name, $string, $allow_empty_value = false, $source_lang = '' ) {&nbsp;</div></li><li><div>      PLL_WPML_Compat::instance()-&gt;register_string( $context, $name, $string );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Removes a string from the &quot;strings translation&quot; panel</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.2</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $context the group in which the string is registered, defaults to 'polylang'</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $name    a unique name for the string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'icl_unregister_string' ) ) {&nbsp;</div></li><li><div>  function icl_unregister_string( $context, $name ) {&nbsp;</div></li><li><div>      PLL_WPML_Compat::instance()-&gt;unregister_string( $context, $name );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Gets the translated value of a string ( previously registered with icl_register_string or pll_register_string )</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 0.9.3</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.9.2 argument 3 is optional</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0   add support for arguments 4 to 6</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string      $context         the group in which the string is registered</span>&nbsp;</div></li><li><div><span class="comment"> * @param string      $name            a unique name for the string</span>&nbsp;</div></li><li><div><span class="comment"> * @param string      $string          the string to translate, optional for strings registered with icl_register_string</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool|null   $has_translation optional, not supported in Polylang</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool        $bool            optional, not used</span>&nbsp;</div></li><li><div><span class="comment"> * @param string|null $lang            optional, return the translation in this language, defaults to current language</span>&nbsp;</div></li><li><div><span class="comment"> * @return string the translated string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'icl_t' ) ) {&nbsp;</div></li><li><div>  function icl_t( $context, $name, $string = false, &$has_translation = null, $bool = false, $lang = null ) {&nbsp;</div></li><li><div>      return icl_translate( $context, $name, $string, false, $has_translation, $lang );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Undocumented function used by NextGen Gallery</span>&nbsp;</div></li><li><div><span class="comment"> * used in PLL_Plugins_Compat for Jetpack with only 3 arguments</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.2</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.0   add support for arguments 5 and 6, strings are no more automatically registered</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string      $context         the group in which the string is registered</span>&nbsp;</div></li><li><div><span class="comment"> * @param string      $name            a unique name for the string</span>&nbsp;</div></li><li><div><span class="comment"> * @param string      $string          the string to translate, optional for strings registered with icl_register_string</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool        $bool            optional, not used</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool|null   $has_translation optional, not supported in Polylang</span>&nbsp;</div></li><li><div><span class="comment"> * @param string|null $lang            optional, return the translation in this language, defaults to current language</span>&nbsp;</div></li><li><div><span class="comment"> * @return string the translated string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'icl_translate' ) ) {&nbsp;</div></li><li><div>  function icl_translate( $context, $name, $string = false, $bool = false, &$has_translation = null, $lang = null ) {&nbsp;</div></li><li><div>      <span class="comment">// FIXME WPML can automatically registers the string based on an option</span>&nbsp;</div></li><li><div>      if ( empty( $string ) ) {&nbsp;</div></li><li><div>          $string = PLL_WPML_Compat::instance()-&gt;get_string_by_context_and_name( $context, $name );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      return empty( $lang ) ? pll__( $string ) : pll_translate_string( $string, $lang );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Undocumented function used by Types</span>&nbsp;</div></li><li><div><span class="comment"> * FIXME: tested only with Types</span>&nbsp;</div></li><li><div><span class="comment"> * probably incomplete as Types locks the custom fields for a new post, but not when edited</span>&nbsp;</div></li><li><div><span class="comment"> * This is probably linked to the fact that WPML has always an original post in the default language and not Polylang :)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.1.2</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return array</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'wpml_get_copied_fields_for_post_edit' ) ) {&nbsp;</div></li><li><div>  function wpml_get_copied_fields_for_post_edit() {&nbsp;</div></li><li><div>      if ( empty( $_GET['from_post'] ) ) {&nbsp;</div></li><li><div>          return array();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Don't know what WPML does but Polylang does copy all public meta keys by default</span>&nbsp;</div></li><li><div>      foreach ( $keys = array_unique( array_keys( get_post_custom( (int) $_GET['from_post'] ) ) ) as $k =&gt; $meta_key ) {&nbsp;</div></li><li><div>          if ( is_protected_meta( $meta_key ) ) {&nbsp;</div></li><li><div>              unset( $keys[ $k ] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Apply our filter and fill the expected output ( see /types/embedded/includes/fields-post.php )</span>&nbsp;</div></li><li><div>      <span class="comment">/** This filter is documented in modules/sync/admin-sync.php */</span>&nbsp;</div></li><li><div>      $arr['fields'] = array_unique( apply_filters( 'pll_copy_post_metas', empty( $keys ) ? array() : $keys, false ) );&nbsp;</div></li><li><div>      $arr['original_post_id'] = (int) $_GET['from_post'];&nbsp;</div></li><li><div>      return $arr;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Undocumented function used by Warp 6 by Yootheme</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.5</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return string default language code</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'icl_get_default_language' ) ) {&nbsp;</div></li><li><div>  function icl_get_default_language() {&nbsp;</div></li><li><div>      return pll_default_language();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Undocumented function reported to be used by Table Rate Shipping for WooCommerce</span>&nbsp;</div></li><li><div><span class="comment"> * @see https://wordpress.org/support/topic/add-wpml-compatibility-function</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.8.2</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return string default language code</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'wpml_get_default_language' ) ) {&nbsp;</div></li><li><div>  function wpml_get_default_language() {&nbsp;</div></li><li><div>      return pll_default_language();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>Polylang</li><li><span></span>2.0.5</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>