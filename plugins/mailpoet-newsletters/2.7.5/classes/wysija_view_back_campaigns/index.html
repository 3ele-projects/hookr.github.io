<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="2.7.5" data-slug="mailpoet-newsletters" data-type="class" data-id="41246"><head xmlns="http://www.w3.org/1999/xhtml"><title> wysija_view_back_campaigns | class | Mailpoet Newsletters | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="WYSIJA_view_back_campaigns, class, plugin, mailpoet-newsletters, 2.7.5" /><meta name="description" content="The MailPoet Newsletters WYSIJA view back campaigns class." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.8"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=c8cad880094bbfc091513c12fc49a1bf' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.8' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/wysija_view_back_campaigns/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fwysija_view_back_campaigns%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fwysija_view_back_campaigns%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-mailpoet-newsletters-2.7.5-class-wysija_view_back_campaigns","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wysija_view_back_campaigns" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to mailpoet-newsletters." href="http://hookr.io/plugins/mailpoet-newsletters/" class="plugin"><span property="name">mailpoet-newsletters</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.7.5." href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/" class="H_VERSION"><span property="name">2.7.5</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wysija_view_back_campaigns</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="299"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/all/" title="All">All <span class="count badge">299</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="104"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/hooks/" title="Hooks">Hooks <span class="count badge">104</span></a></li><li class="" data-id="action" data-count="30"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/actions/" title="Actions">Actions <span class="count badge">30</span></a></li><li class="" data-id="filter" data-count="74"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/filters/" title="Filters">Filters <span class="count badge">74</span></a></li><li class="active" data-id="class" data-count="132"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/classes/" title="Classes">Classes <span class="count badge">132</span></a></li><li class="" data-id="constant" data-count="52"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/constants/" title="Constants">Constants <span class="count badge">52</span></a></li><li class="" data-id="function" data-count="8"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/functions/" title="Functions">Functions <span class="count badge">8</span></a></li><li class="" data-id="shortcode" data-count="3"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">3</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>WYSIJA_view_back_campaigns</strong></h1><p>The MailPoet Newsletters <strong>WYSIJA view back campaigns</strong> class.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/files/views-back-campaigns/" class="file">/views/back/campaigns.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="4" class="block" start="4"><li><div>class WYSIJA_view_back_campaigns extends WYSIJA_view_back {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    var $icon = 'icon-edit-news';&nbsp;</div></li><li><div>    var $column_action_list = 'name';&nbsp;</div></li><li><div>    var $queuedemails = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function __construct() {&nbsp;</div></li><li><div>        $this-&gt;title = __('All Newsletters');&nbsp;</div></li><li><div>        parent::__construct();&nbsp;</div></li><li><div>        $this-&gt;jsTrans['selecmiss'] = __('Select at least 1 subscriber!', WYSIJA);&nbsp;</div></li><li><div>        $this-&gt;search = array('title' =&gt; __('Search newsletters', WYSIJA));&nbsp;</div></li><li><div>        $this-&gt;column_actions = array('editlist' =&gt; __('Edit', WYSIJA), 'duplicatelist' =&gt; __('Duplicate', WYSIJA), 'deletelist' =&gt; __('Delete', WYSIJA));&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function installation() {&nbsp;</div></li><li><div>        return '';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * @see parent::header()&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function header($data = '')&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    if (!empty($_REQUEST['action']))&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        switch (trim(strtolower($_REQUEST['action'])))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>        case 'viewstats':&nbsp;</div></li><li><div>            $this-&gt;icon = 'icon-stats';&nbsp;</div></li><li><div>            break;&nbsp;</div></li><li><div>        default:&nbsp;</div></li><li><div>            break;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    parent::header($data);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function main($data) {&nbsp;</div></li><li><div>        $this-&gt;menuTop($this-&gt;action);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo '&lt;form method=&quot;post&quot; action=&quot;&quot; id=&quot;posts-filter&quot;&gt;';&nbsp;</div></li><li><div>        $this-&gt;filtersLink($data);&nbsp;</div></li><li><div>        $this-&gt;filterDDP($data);&nbsp;</div></li><li><div>        $this-&gt;listing($data);&nbsp;</div></li><li><div>        echo '&lt;/form&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function menuTop($actionmenu = false, $data = false) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $array_translation = array(&nbsp;</div></li><li><div>            'back' =&gt; __('Back', WYSIJA), &nbsp;</div></li><li><div>            'add' =&gt; __('Create a new email', WYSIJA)&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $arrayMenus = array();&nbsp;</div></li><li><div>        switch ($actionmenu) {&nbsp;</div></li><li><div>            case 'main':&nbsp;</div></li><li><div>                $arrayMenus[] = 'add';&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'viewstats':&nbsp;</div></li><li><div>            case 'add':&nbsp;</div></li><li><div>            case 'edit':&nbsp;</div></li><li><div>            default:&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $menu = '';&nbsp;</div></li><li><div>        $classes = function_exists('wp_star_rating') ? 'add-new-h2' : 'button-secondary2';&nbsp;</div></li><li><div>        if ($arrayMenus) {&nbsp;</div></li><li><div>            $menu .= '&lt;span class=&quot;action_buttons&quot;&gt;';&nbsp;</div></li><li><div>            foreach ($arrayMenus as $action) {&nbsp;</div></li><li><div>                $action_params = $action;&nbsp;</div></li><li><div>                $extra_params = $link = '';&nbsp;</div></li><li><div>                if (empty($link))&nbsp;</div></li><li><div>                    $link = 'admin.php?page=wysija_campaigns&action=' . $action_params;&nbsp;</div></li><li><div>                $menu.= '&lt;a id=&quot;action-' . str_replace(&quot;_&quot;, &quot;-&quot;, $action) . '&quot; ' . $extra_params . ' href=&quot;' . $link . '&quot; class=&quot;action-' . str_replace(&quot;_&quot;, &quot;-&quot;, $action) . ' ' . $classes . '&quot;&gt;' . $array_translation[$action] . '&lt;/a&gt;';&nbsp;</div></li><li><div>                if ($actionmenu == 'main' && $action == 'add') {&nbsp;</div></li><li><div>                    $menu.='&lt;span class=&quot;description&quot; &gt; ' . __('... or duplicate one below to copy its design.', WYSIJA) . '&lt;/span&gt;';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $menu .= '&lt;/span&gt;';&nbsp;</div></li><li><div>            $menu .= '&lt;/h2&gt;';&nbsp;</div></li><li><div>            $menu .= '&lt;h2 class=&quot;hidden&quot;&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $menu;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function filterDDP($data) {&nbsp;</div></li><li><div>        if (empty($data['campaigns']))&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;ul class=&quot;subsubsub&quot;&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>            $total = count($data['counts']);&nbsp;</div></li><li><div>            $i = 1;&nbsp;</div></li><li><div>            foreach ($data['counts'] as $countType =&gt; $count) {&nbsp;</div></li><li><div>                if (!$count) {&nbsp;</div></li><li><div>                    $i++;&nbsp;</div></li><li><div>                    continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                switch ($countType) {&nbsp;</div></li><li><div>                    case 'all':&nbsp;</div></li><li><div>                        $tradText = __('All', WYSIJA);&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    case 'status-sent':&nbsp;</div></li><li><div>                        $tradText = __('Sent', WYSIJA);&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    case 'status-sending':&nbsp;</div></li><li><div>                        $tradText = __('Sending', WYSIJA);&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    case 'status-draft':&nbsp;</div></li><li><div>                        $tradText = __('Draft', WYSIJA);&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    case 'status-paused':&nbsp;</div></li><li><div>                        $tradText = __('Paused', WYSIJA);&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    case 'status-scheduled':&nbsp;</div></li><li><div>                        $tradText = __('Scheduled', WYSIJA);&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    case 'type-regular':&nbsp;</div></li><li><div>                        $tradText = __('Standard Newsletters', WYSIJA);&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    case 'type-autonl':&nbsp;</div></li><li><div>                        $tradText = __('Auto Newsletters', WYSIJA);&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $classcurrent = '';&nbsp;</div></li><li><div>                if ((isset($_REQUEST['link_filter']) && $_REQUEST['link_filter'] == $countType) || ($countType == 'all' && !isset($_REQUEST['link_filter'])))&nbsp;</div></li><li><div>                    $classcurrent = 'class=&quot;current&quot;';&nbsp;</div></li><li><div>                echo '&lt;li&gt;&lt;a ' . $classcurrent . ' href=&quot;admin.php?page=wysija_campaigns&link_filter=' . $countType . '&quot;&gt;' . $tradText . ' &lt;span class=&quot;count&quot;&gt;(' . $count . ')&lt;/span&gt;&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ($total != $i)&nbsp;</div></li><li><div>                    echo ' | ';&nbsp;</div></li><li><div>                echo '&lt;/li&gt;';&nbsp;</div></li><li><div>                $i++;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>        &lt;/ul&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;?php $this-&gt;searchBox(); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;div class=&quot;tablenav&quot;&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;alignleft actions&quot;&gt;&nbsp;</div></li><li><div>                &lt;span class=&quot;alignleft actions&quot; id=&quot;bulksubmit-area&quot; style=&quot;display:none;&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                        $action_locale = array(&nbsp;</div></li><li><div>                                'delete' =&gt; __('Delete this newsletter for ever?', WYSIJA), &nbsp;</div></li><li><div>                                'delete_bulk' =&gt; __('Delete these newsletters for ever?', WYSIJA)&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    /**&nbsp;</div></li><li><div>                    &lt;input type=&quot;submit&quot; class=&quot;bulksubmit-button button-secondary action&quot; name=&quot;doaction&quot; data-action=&quot;delete&quot;&nbsp;</div></li><li><div>                           data-locale='&lt;?php echo json_encode($action_locale); ?&gt;'&nbsp;</div></li><li><div>                           value=&quot;&lt;?php echo esc_attr(__('Delete selected', WYSIJA)); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                    */&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>            &lt;?php $this-&gt;secure('delete'); ?&gt;&nbsp;</div></li><li><div>                &lt;/span&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;select name=&quot;filter-date&quot; class=&quot;global-filter&quot;&gt;&nbsp;</div></li><li><div>                    &lt;option selected=&quot;selected&quot; value=&quot;&quot;&gt;&lt;?php echo esc_attr(__('Show all months', WYSIJA)); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    //echo $this-&gt;fieldListHTML_created_at($row[&quot;created_at&quot;])&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    foreach ($data['dates'] as $listK =&gt; $list) {&nbsp;</div></li><li><div>                        $selected = &quot;&quot;;&nbsp;</div></li><li><div>                        if (isset($_REQUEST['filter-date']) && $_REQUEST['filter-date'] == $listK)&nbsp;</div></li><li><div>                            $selected = ' selected=&quot;selected&quot; ';&nbsp;</div></li><li><div>                        echo '&lt;option ' . $selected . ' value=&quot;' . esc_attr($listK) . '&quot;&gt;' . $list . '&lt;/option&gt;';&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                &lt;/select&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;div class=&quot;alignleft actions&quot;&gt;&nbsp;</div></li><li><div>                &lt;select name=&quot;filter-list&quot; class=&quot;global-filter&quot;&gt;&nbsp;</div></li><li><div>                    &lt;option selected=&quot;selected&quot; value=&quot;&quot;&gt;&lt;?php _e('View by lists', WYSIJA); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    foreach ($data['lists'] as $listK =&gt; $list) {&nbsp;</div></li><li><div>                        $selected = &quot;&quot;;&nbsp;</div></li><li><div>                        if (isset($_REQUEST['filter-list']) && $_REQUEST['filter-list'] == $listK)&nbsp;</div></li><li><div>                            $selected = ' selected=&quot;selected&quot; ';&nbsp;</div></li><li><div>                        if ($list['users'] &gt; 0)&nbsp;</div></li><li><div>                            echo '&lt;option ' . $selected . ' value=&quot;' . $list['list_id'] . '&quot;&gt;' . $list['name'] . ' (' . $list['users'] . ')' . '&lt;/option&gt;';&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                &lt;/select&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;submit&quot; class=&quot;filtersubmit button-secondary action&quot; name=&quot;doaction&quot; value=&quot;&lt;?php echo esc_attr(__('Filter', WYSIJA)); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php $this-&gt;pagination(); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function getTransStatusEmail($status) {&nbsp;</div></li><li><div>        switch ($status) {&nbsp;</div></li><li><div>            case 'all':&nbsp;</div></li><li><div>                $tradText = __('All', WYSIJA);&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'allsent':&nbsp;</div></li><li><div>                $tradText = __('All Sent', WYSIJA);&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'inqueue':&nbsp;</div></li><li><div>                $tradText = __('In Queue', WYSIJA);&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'notsent':&nbsp;</div></li><li><div>                $tradText = __('Failed Send', WYSIJA);&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'sent':&nbsp;</div></li><li><div>                $tradText = __('Unopened', WYSIJA);&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'opened':&nbsp;</div></li><li><div>                $tradText = __('Opened', WYSIJA);&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'bounced':&nbsp;</div></li><li><div>                $tradText = __('Bounced', WYSIJA);&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'clicked':&nbsp;</div></li><li><div>                $tradText = __('Clicked', WYSIJA);&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'unsubscribe':&nbsp;</div></li><li><div>                $tradText = __('Unsubscribe', WYSIJA);&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            default:&nbsp;</div></li><li><div>                $tradText = 'status : ' . $status;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $tradText;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function filterDDPVIEW($data) {&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;ul class=&quot;subsubsub&quot;&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>            $total = count($data['counts']);&nbsp;</div></li><li><div>            $i = 1;&nbsp;</div></li><li><div>            foreach ($data['counts'] as $countType =&gt; $count) {&nbsp;</div></li><li><div>                if (!$count || $countType == 'all') {&nbsp;</div></li><li><div>                    $i++;&nbsp;</div></li><li><div>                    continue;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $tradText = $this-&gt;getTransStatusEmail($countType);&nbsp;</div></li><li><div>                $classcurrent = '';&nbsp;</div></li><li><div>                if ((isset($_REQUEST['link_filter']) && $_REQUEST['link_filter'] == $countType) || ($countType == 'allsent' && !isset($_REQUEST['link_filter'])))&nbsp;</div></li><li><div>                    $classcurrent = 'class=&quot;current&quot;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                echo '&lt;li&gt;&lt;a ' . $classcurrent . ' href=&quot;admin.php?page=wysija_campaigns&action=viewstats&id=' . $_REQUEST['id'] . '&link_filter=' . $countType . '&quot;&gt;' . $tradText . ' &lt;span class=&quot;count&quot;&gt;(' . $count . ')&lt;/span&gt;&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ($total != $i)&nbsp;</div></li><li><div>                    echo ' | ';&nbsp;</div></li><li><div>                echo '&lt;/li&gt;';&nbsp;</div></li><li><div>                $i++;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>        &lt;/ul&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;?php $this-&gt;searchBox(); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;div class=&quot;tablenav&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;div class=&quot;alignleft actions&quot;&gt;&nbsp;</div></li><li><div>                &lt;select name=&quot;action2&quot; class=&quot;global-action&quot; id=&quot;viewstats_ddp&quot;&gt;&nbsp;</div></li><li><div>                    &lt;option value=&quot;&quot; data-sort=&quot;0&quot;&gt;&lt;?php _e('With this segment', WYSIJA); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    if (isset($_REQUEST['link_filter']) && $_REQUEST['link_filter'] == 'notsent') {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            ?&gt;&nbsp;</div></li><li><div>                                            &lt;option value=&quot;removequeue&quot; data-nonce=&quot;&lt;?php echo $this-&gt;secure(array('action' =&gt; &quot;removequeue&quot;, 'id' =&gt; $_REQUEST['id']), true) ?&gt;&quot;&gt;&lt;?php _e('Remove from the queue', WYSIJA); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                            &lt;?php&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                    &lt;option value=&quot;createnewlist&quot; data-nonce=&quot;&lt;?php echo $this-&gt;secure(array('action' =&gt; &quot;createnewlist&quot;, 'id' =&gt; $_REQUEST['id']), true) ?&gt;&quot;&gt;&lt;?php _e('Create a new list', WYSIJA); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                    &lt;option value=&quot;unsubscribeall&quot; data-nonce=&quot;&lt;?php echo $this-&gt;secure(array('action' =&gt; &quot;unsubscribeall&quot;, 'id' =&gt; $_REQUEST['id']), true) ?&gt;&quot;&gt;&lt;?php _e('Unsubscribe from all lists', WYSIJA); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                                        &lt;?php&nbsp;</div></li><li><div>                                        foreach ($data['lists'] as $listK =&gt; $list) {&nbsp;</div></li><li><div>                                            if ($list['is_enabled']) {&nbsp;</div></li><li><div>                                                echo '&lt;option value=&quot;actionvar_unsubscribelist-listid_' . $list['list_id'] . '&quot; data-nonce=&quot;'. $this-&gt;secure(array('action' =&gt; &quot;actionvar_unsubscribelist-listid_&quot; . $list['list_id'], 'id' =&gt; $_REQUEST['id']), true).'&quot;&gt;' . sprintf(__('Unsubscribe from list: %1$s', WYSIJA), $list['name']) . ' (' . $list['users'] . ')' . '&lt;/option&gt;';&nbsp;</div></li><li><div>                                            }&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>                                        ?&gt;&nbsp;</div></li><li><div>                    &lt;option value=&quot;export&quot; data-nonce=&quot;&lt;?php echo $this-&gt;secure(array('action' =&gt; &quot;export&quot;, 'id' =&gt; $_REQUEST['id']), true) ?&gt;&quot;&gt;&lt;?php _e('Export to CSV', WYSIJA); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;/select&gt;&nbsp;</div></li><li><div>                                &lt;?php $this-&gt;secure(array('action' =&gt; &quot;bulkoptions&quot;, 'id' =&gt; $_REQUEST['id'])); ?&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;submit&quot; class=&quot;bulksubmitcamp button-secondary action&quot; name=&quot;doaction&quot; value=&quot;&lt;?php echo esc_attr(__('Apply', WYSIJA)); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php $this-&gt;pagination(); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * main view&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function listing($data, $simple = false) {&nbsp;</div></li><li><div>    if (empty($data['campaigns']))&nbsp;</div></li><li><div>        return;&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;list&quot;&gt;&nbsp;</div></li><li><div>            &lt;table cellspacing=&quot;0&quot; class=&quot;widefat fixed&quot;&gt;&nbsp;</div></li><li><div>                &lt;thead&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    $openedsorting = $statussorting = $namesorting = $datesorting = $datesorting2 = &quot; sortable desc&quot;;&nbsp;</div></li><li><div>                    $hiddenOrder = &quot;&quot;;&nbsp;</div></li><li><div>                    if (isset($_REQUEST[&quot;orderby&quot;])) {&nbsp;</div></li><li><div>                        switch ($_REQUEST[&quot;orderby&quot;]) {&nbsp;</div></li><li><div>                            case &quot;name&quot;:&nbsp;</div></li><li><div>                                $namesorting = &quot; sorted &quot; . $_REQUEST[&quot;ordert&quot;];&nbsp;</div></li><li><div>                                break;&nbsp;</div></li><li><div>                            case &quot;modified_at&quot;:&nbsp;</div></li><li><div>                                $datesorting = &quot; sorted &quot; . $_REQUEST[&quot;ordert&quot;];&nbsp;</div></li><li><div>                                break;&nbsp;</div></li><li><div>                            case &quot;sent_at&quot;:&nbsp;</div></li><li><div>                                $datesorting2 = &quot; sorted &quot; . $_REQUEST[&quot;ordert&quot;];&nbsp;</div></li><li><div>                                break;&nbsp;</div></li><li><div>                            case &quot;status&quot;:&nbsp;</div></li><li><div>                                $statussorting = &quot; sorted &quot; . $_REQUEST[&quot;ordert&quot;];&nbsp;</div></li><li><div>                                break;&nbsp;</div></li><li><div>                            case &quot;number_opened&quot;:&nbsp;</div></li><li><div>                                $openedsorting = &quot; sorted &quot; . $_REQUEST[&quot;ordert&quot;];&nbsp;</div></li><li><div>                                break;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        $hiddenOrder = '&lt;input type=&quot;hidden&quot; name=&quot;orderby&quot; id=&quot;wysija-orderby&quot; value=&quot;' . esc_attr($_REQUEST[&quot;orderby&quot;]) . '&quot;/&gt;';&nbsp;</div></li><li><div>                        $hiddenOrder.='&lt;input type=&quot;hidden&quot; name=&quot;ordert&quot; id=&quot;wysija-ordert&quot; value=&quot;' . esc_attr($_REQUEST[&quot;ordert&quot;]) . '&quot;/&gt;';&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $header = '&lt;tr class=&quot;thead&quot;&gt;&nbsp;</div></li><li><div>                            &lt;th scope=&quot;col&quot; id=&quot;campaign-id&quot; class=&quot;manage-column column-campaign-id check-column&quot;&gt;&lt;input type=&quot;checkbox&quot; /&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                            &lt;th class=&quot;manage-column column-name' . $namesorting . '&quot; id=&quot;name&quot; scope=&quot;col&quot; style=&quot;width:25%&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;' . __('Name', WYSIJA) . '&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>                    /** $header.='&lt;th class=&quot;manage-column column-fname'.$fnamesorting.'&quot; id=&quot;firstname&quot; scope=&quot;col&quot; style=&quot;width:80px;&quot;&gt;'.__('First name', WYSIJA).'&lt;/th&gt;&nbsp;</div></li><li><div>                      &lt;th class=&quot;manage-column column-lname'.$lnamesorting.'&quot; id=&quot;lastname&quot; scope=&quot;col&quot; style=&quot;width:80px;&quot;&gt;'.__('Last name', WYSIJA).'&lt;/th&gt;'; */&nbsp;</div></li><li><div>                    $header.='&lt;th class=&quot;manage-column column-status' . $statussorting . '&quot; id=&quot;status&quot; scope=&quot;col&quot; style=&quot;width:15%;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;' . __('Status', WYSIJA) . '&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>                    $header.='&lt;th class=&quot;manage-column column-list-names&quot; id=&quot;list-list&quot; scope=&quot;col&quot;&gt;' . __('Lists', WYSIJA) . '&lt;/th&gt;';&nbsp;</div></li><li><div>                    $header.='&lt;th class=&quot;manage-column column-opened' . $openedsorting . '&quot; id=&quot;number_opened&quot; scope=&quot;col&quot; style=&quot;width:15%;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;' . __('Open, clicks, unsubscribed', WYSIJA) . '&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    /** $header.='&lt;th class=&quot;manage-column column-emails&quot; id=&quot;emails-list&quot; scope=&quot;col&quot;&gt;'.__('Emails', WYSIJA).'&lt;/th&gt;&nbsp;</div></li><li><div>                      &lt;th class=&quot;manage-column column-opened&quot; id=&quot;opened-list&quot; scope=&quot;col&quot;&gt;'.__('Opened', WYSIJA).'&lt;/th&gt;&nbsp;</div></li><li><div>                      &lt;th class=&quot;manage-column column-clic&quot; id=&quot;clic-list&quot; scope=&quot;col&quot;&gt;'.__('Clicked', WYSIJA).'&lt;/th&gt;'; */&nbsp;</div></li><li><div>                    $header.='&lt;th class=&quot;manage-column column-date' . $datesorting . '&quot; id=&quot;modified_at&quot; scope=&quot;col&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;' . __('Modified On', WYSIJA) . '&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>                    $header.='&lt;th class=&quot;manage-column column-date' . $datesorting2 . '&quot; id=&quot;sent_at&quot; scope=&quot;col&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;' . __('Sent On', WYSIJA) . '&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                        &lt;/tr&gt;';&nbsp;</div></li><li><div>                    echo $header;&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                &lt;/thead&gt;&nbsp;</div></li><li><div>                &lt;tfoot&gt;&nbsp;</div></li><li><div>                       &lt;?php&nbsp;</div></li><li><div>                       echo $header;&nbsp;</div></li><li><div>                       ?&gt;&nbsp;</div></li><li><div>                &lt;/tfoot&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;tbody class=&quot;list:&lt;?php echo $this-&gt;model-&gt;table_name . ' ' . $this-&gt;model-&gt;table_name . '-list&quot; id=&quot;wysija-' . $this-&gt;model-&gt;table_name . '&quot;' ?&gt;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                       &lt;?php&nbsp;</div></li><li><div>                       $listingRows = '';&nbsp;</div></li><li><div>                       $alt = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                       $statuses = array('-1' =&gt; __('Sent to %1$s out of %2$s', WYSIJA), '0' =&gt; __('Draft', WYSIJA), '1' =&gt; __('%1$s out of %2$s sent.', WYSIJA), '3' =&gt; __('%1$s out of %2$s sent.', WYSIJA), '2' =&gt; __('Sent to %1$s out of %2$s', WYSIJA), '99' =&gt; __('%1$s out of %2$s sent.', WYSIJA));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                       foreach ($data['campaigns'] as $row) {&nbsp;</div></li><li><div>                           $classRow = $messageListEdit = '';&nbsp;</div></li><li><div>                           //check if lists have been removed in case of scheduled newsletter or  auto post notif&nbsp;</div></li><li><div>                           if (empty($row['name'])) {&nbsp;</div></li><li><div>                               $row['name'] = $row['campaign_name'];&nbsp;</div></li><li><div>                           }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                           if (isset($row['classRow'])) {&nbsp;</div></li><li><div>                               $classRow.=$row['classRow'];&nbsp;</div></li><li><div>                           }&nbsp;</div></li><li><div>                           if (isset($row['msgListEdit']))&nbsp;</div></li><li><div>                               $messageListEdit = $row['msgListEdit'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                           if ($alt)&nbsp;</div></li><li><div>                               $classRow.='alternate';&nbsp;</div></li><li><div>                           $editStep = 'editTemplate';&nbsp;</div></li><li><div>                           if ($row[&quot;type&quot;] == 2) {&nbsp;</div></li><li><div>                               $classRow.=&quot; autonl&quot;;&nbsp;</div></li><li><div>                               $editStep = 'edit';&nbsp;</div></li><li><div>                           }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                           if ((int) $row['status'] == 4 && isset($row['params']['schedule']['isscheduled'])) {&nbsp;</div></li><li><div>                               $classRow.=' scheduled';&nbsp;</div></li><li><div>                           }&nbsp;</div></li><li><div>                           if (in_array($row['status'], array(1, 3, 99)))&nbsp;</div></li><li><div>                               $classRow.=' sending';&nbsp;</div></li><li><div>                           if ($row['status'] == 2)&nbsp;</div></li><li><div>                               $classRow.=' sent';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                           //$row[&quot;params&quot;]=unserialize(base64_decode($row[&quot;params&quot;]));&nbsp;</div></li><li><div>                           ?&gt;&nbsp;</div></li><li><div>                           &lt;tr class=&quot;&lt;?php echo $classRow ?&gt;&quot; &gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;th scope=&quot;col&quot; class=&quot;check-column&quot; &gt;&nbsp;</div></li><li><div>                        &lt;input type=&quot;checkbox&quot; name=&quot;wysija[campaign][campaign_id][]&quot; id=&quot;campaign_id_&lt;?php echo $row[&quot;campaign_id&quot;] ?&gt;&quot; value=&quot;&lt;?php echo esc_attr($row[&quot;campaign_id&quot;]) ?&gt;&quot; class=&quot;checkboxselec&quot; /&gt;&nbsp;</div></li><li><div>                    &lt;/th&gt;&nbsp;</div></li><li><div>                    &lt;td class=&quot;name column-name&quot;&gt;&nbsp;</div></li><li><div>                        &lt;strong&gt;&nbsp;</div></li><li><div>                                &lt;?php&nbsp;</div></li><li><div>;&nbsp;</div></li><li><div>                                if (in_array($row['status'], array(0, 4, -1))) {&nbsp;</div></li><li><div>                                    $durationsent = $statusshared = '';&nbsp;</div></li><li><div>                                    ?&gt;&lt;a href=&quot;admin.php?page=wysija_campaigns&id=&lt;?php echo $row['email_id'] ?&gt;&action=edit&quot; class=&quot;row-title&quot;&gt;&lt;?php echo $row['name']; ?&gt;&lt;/a&gt; - &lt;span class=&quot;post-state&quot;&gt;&lt;?php&nbsp;</div></li><li><div>                                    if (isset($row['params']['schedule']['isscheduled']) && $row['status'] == 4) {&nbsp;</div></li><li><div>                                        $helper_toolbox = WYSIJA::get('toolbox', 'helper');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        //no recording just conversion&nbsp;</div></li><li><div>                                        $scheduletimenoffset = strtotime($row['params']['schedule']['day'] . ' ' . $row['params']['schedule']['time']);&nbsp;</div></li><li><div>                                        $timeleft = $helper_toolbox-&gt;localtime_to_servertime($scheduletimenoffset) - time();&nbsp;</div></li><li><div>                                        if ($timeleft &lt;= 0) {&nbsp;</div></li><li><div>                                            $autoNL = WYSIJA::get('autonews', 'helper');&nbsp;</div></li><li><div>                                            $autoNL-&gt;checkScheduled();&nbsp;</div></li><li><div>                                        } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            $scheduled_on = date_i18n(get_option('date_format') . ' ' . get_option('time_format'), $scheduletimenoffset);&nbsp;</div></li><li><div>                                            if ($timeleft &lt;= (60 * 60 * 24)) { // 1 day&nbsp;</div></li><li><div>                                                $timeleft = $helper_toolbox-&gt;duration_string($timeleft, true, 4);&nbsp;</div></li><li><div>                                                $durationsent = '&lt;span title=&quot;' . $scheduled_on . '&quot;&gt;' . sprintf(__('Scheduled to be sent in %1$s'), $timeleft) . '&lt;/span&gt;';&nbsp;</div></li><li><div>                                            } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                                $durationsent = sprintf(__('Scheduled to be sent on %1$s'), $scheduled_on);&nbsp;</div></li><li><div>                                            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        $statusshared = $durationsent;&nbsp;</div></li><li><div>                                        echo __('Scheduled', WYSIJA);&nbsp;</div></li><li><div>                                    } else {&nbsp;</div></li><li><div>                                        if ($row['type'] == 2)&nbsp;</div></li><li><div>                                            if ($row['status'] == -1)&nbsp;</div></li><li><div>                                                echo __('Paused', WYSIJA);&nbsp;</div></li><li><div>                                            else&nbsp;</div></li><li><div>                                                echo __('Draft', WYSIJA);&nbsp;</div></li><li><div>                                        else {&nbsp;</div></li><li><div>                                            if ((int) $row['status'] == -1)&nbsp;</div></li><li><div>                                                $resulttext = sprintf($statuses[(int) $row['status']], $data['sent'][$row[&quot;email_id&quot;]]['to'], $data['sent'][$row[&quot;email_id&quot;]]['total']);&nbsp;</div></li><li><div>                                            else&nbsp;</div></li><li><div>                                                $resulttext = $statuses[(int) $row['status']];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            echo $resulttext;&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>                                    }&nbsp;</div></li><li><div>                                    ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                &lt;?php&nbsp;</div></li><li><div>                            }else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                if (isset($data['sent'][$row['email_id']]['to']) && $data['sent'][$row['email_id']]['to'] &gt; 0) {&nbsp;</div></li><li><div>                                    ?&gt;&lt;a href=&quot;admin.php?page=wysija_campaigns&id=&lt;?php echo $row[&quot;email_id&quot;] ?&gt;&action=viewstats&quot; class=&quot;row-title&quot;&gt;&lt;?php echo $row['name']; ?&gt;&lt;/a&gt;&lt;?php&nbsp;</div></li><li><div>                                } else {&nbsp;</div></li><li><div>                                    if ($row[&quot;type&quot;] == 2) {&nbsp;</div></li><li><div>                                        ?&gt;&nbsp;</div></li><li><div>                                        &lt;a href=&quot;admin.php?page=wysija_campaigns&id=&lt;?php echo $row[&quot;email_id&quot;] ?&gt;&action=pause&_wpnonce=&lt;?php echo $this-&gt;secure(array('action' =&gt; 'pause' , 'id' =&gt; $row[&quot;email_id&quot;]), true); ?&gt;&quot; class=&quot;row-title pause-edit&quot;&gt;&nbsp;</div></li><li><div>                                        &lt;?php echo $row['name']; ?&gt;&nbsp;</div></li><li><div>                                        &lt;/a&gt;&lt;?php&nbsp;</div></li><li><div>                                    } else {&nbsp;</div></li><li><div>                                        echo $row['name'];&nbsp;</div></li><li><div>                                    }&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                            ?&gt;&lt;/strong&gt;&nbsp;</div></li><li><div>                        &lt;div class=&quot;row-actions&quot;&gt;&nbsp;</div></li><li><div>                            &lt;?php&nbsp;</div></li><li><div>                            $emailH = WYSIJA::get('email', 'helper');&nbsp;</div></li><li><div>                            $fullurl = $emailH-&gt;getVIB($row);&nbsp;</div></li><li><div>                            ?&gt;&lt;span class=&quot;viewnl&quot;&gt;&nbsp;</div></li><li><div>                                &lt;a href=&quot;&lt;?php echo $fullurl ?&gt;&quot; target=&quot;_blank&quot; class=&quot;viewnews&quot; title=&quot;&lt;?php _e('Preview in new tab', WYSIJA) ?&gt;&quot;&gt;&lt;?php _e('Preview', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                            &lt;/span&gt;&lt;?php&nbsp;</div></li><li><div>                            $deleteAction = '';&nbsp;</div></li><li><div>                            $dupid = $deleteId = $row['campaign_id'];&nbsp;</div></li><li><div>                            if (isset($row['params']['autonl']['parent']) || ((int) $row['type'] === 2 && $row['params']['autonl']['event'] == 'new-articles')) {&nbsp;</div></li><li><div>                                $deleteAction = 'Email';&nbsp;</div></li><li><div>                                $deleteId = $row['email_id'];&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            if ($row['status'] == 0 || $row['status'] == 4) {&nbsp;</div></li><li><div>                                ?&gt;&nbsp;</div></li><li><div>                                | &lt;span class=&quot;edit&quot;&gt;&nbsp;</div></li><li><div>                                    &lt;a href=&quot;admin.php?page=wysija_campaigns&id=&lt;?php echo $row['email_id'] ?&gt;&action=&lt;?php echo $editStep ?&gt;&quot; class=&quot;submitedit&quot;&gt;&lt;?php _e('Edit', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                                &lt;/span&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                if (isset($data['sent'][$row[&quot;email_id&quot;]]['to']) && $data['sent'][$row[&quot;email_id&quot;]]['to'] &gt; 0) {&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                    | &lt;span class=&quot;viewstats&quot;&gt;&nbsp;</div></li><li><div>                                        &lt;a href=&quot;admin.php?page=wysija_campaigns&id=&lt;?php echo $row[&quot;email_id&quot;] ?&gt;&action=viewstats&quot; class=&quot;stats&quot;&gt;&lt;?php _e('Stats', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                                    &lt;/span&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                    &lt;?php&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>                                ?&gt;&nbsp;</div></li><li><div>                                | &lt;span class=&quot;duplicate&quot;&gt;&nbsp;</div></li><li><div>                                    &lt;a href=&quot;admin.php?page=wysija_campaigns&id=&lt;?php echo $dupid ?&gt;&email_id=&lt;?php echo $row['email_id'] ?&gt;&action=duplicate&_wpnonce=&lt;?php echo $this-&gt;secure(array(&quot;action&quot; =&gt; &quot;duplicate&quot;, &quot;id&quot; =&gt; $dupid), true); ?&gt;&quot; class=&quot;submitedit&quot;&gt;&lt;?php _e('Duplicate', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                                &lt;/span&gt;&nbsp;</div></li><li><div>                                | &lt;span class=&quot;delete&quot;&gt;&nbsp;</div></li><li><div>                                    &lt;a href=&quot;&lt;?php echo $data['base_url'] ?&gt;&id=&lt;?php echo $deleteId ?&gt;&action=delete&lt;?php echo $deleteAction ?&gt;&_wpnonce=&lt;?php echo $this-&gt;secure(array('action' =&gt; 'delete' . $deleteAction, 'id' =&gt; $deleteId), true); ?&gt;&quot; class=&quot;submitdelete&quot;&gt;&lt;?php _e('Delete', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                                &lt;/span&gt;&nbsp;</div></li><li><div>                                &lt;?php&nbsp;</div></li><li><div>                            } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                if ($row[&quot;status&quot;] == -1) {&nbsp;</div></li><li><div>                                    ?&gt;&nbsp;</div></li><li><div>                                    | &lt;span class=&quot;edit&quot;&gt;&lt;a href=&quot;admin.php?page=wysija_campaigns&id=&lt;?php echo $row['email_id'] ?&gt;&action=&lt;?php echo $editStep ?&gt;&quot; class=&quot;submitedit&quot;&gt;&lt;?php _e('Edit', WYSIJA) ?&gt;&lt;/a&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                                    &lt;?php&nbsp;</div></li><li><div>                                    if (isset($data['sent'][$row[&quot;email_id&quot;]]['to']) && $data['sent'][$row[&quot;email_id&quot;]]['to'] &gt; 0) {&nbsp;</div></li><li><div>                                        ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        | &lt;span class=&quot;viewstats&quot;&gt;&nbsp;</div></li><li><div>                                            &lt;a href=&quot;admin.php?page=wysija_campaigns&id=&lt;?php echo $row[&quot;email_id&quot;] ?&gt;&action=viewstats&quot; class=&quot;stats&quot;&gt;&lt;?php _e('Stats', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                                        &lt;/span&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        &lt;?php }&nbsp;</div></li><li><div>                                    ?&gt;&nbsp;</div></li><li><div>                                    | &lt;span class=&quot;duplicate&quot;&gt;&nbsp;</div></li><li><div>                                        &lt;a href=&quot;admin.php?page=wysija_campaigns&id=&lt;?php echo $dupid ?&gt;&email_id=&lt;?php echo $row['email_id'] ?&gt;&action=duplicate&_wpnonce=&lt;?php echo $this-&gt;secure(array(&quot;action&quot; =&gt; &quot;duplicate&quot;, &quot;id&quot; =&gt; $dupid), true); ?&gt;&quot; class=&quot;submitedit&quot;&gt;&lt;?php _e('Duplicate', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                                    &lt;/span&gt;&nbsp;</div></li><li><div>                                    | &lt;span class=&quot;delete&quot;&gt;&nbsp;</div></li><li><div>                                        &lt;a href=&quot;&lt;?php echo $data['base_url'] ?&gt;&id=&lt;?php echo $deleteId ?&gt;&action=delete&lt;?php echo $deleteAction ?&gt;&_wpnonce=&lt;?php echo $this-&gt;secure(array(&quot;action&quot; =&gt; &quot;delete&quot; . $deleteAction, &quot;id&quot; =&gt; $deleteId), true); ?&gt;&quot; class=&quot;submitdelete&quot;&gt;&lt;?php _e('Delete', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                                    &lt;/span&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    if ($row['type'] == 2) {&nbsp;</div></li><li><div>                        ?&gt;&nbsp;</div></li><li><div>                                        | &lt;span class=&quot;edit&quot;&gt;&nbsp;</div></li><li><div>                                            &lt;a href=&quot;admin.php?page=wysija_campaigns&id=&lt;?php echo $row[&quot;email_id&quot;] ?&gt;&action=pause&_wpnonce=&lt;?php echo $this-&gt;secure(array('action' =&gt; 'pause' , 'id' =&gt; $row[&quot;email_id&quot;]), true); ?&gt;&quot; class=&quot;submitedit pause-edit&quot;&gt;&lt;?php _e('Edit', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                                        &lt;/span&gt;&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (isset($data['sent'][$row[&quot;email_id&quot;]]['to']) && $data['sent'][$row[&quot;email_id&quot;]]['to'] &gt; 0) {&nbsp;</div></li><li><div>                        ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        | &lt;span class=&quot;viewstats&quot;&gt;&nbsp;</div></li><li><div>                                            &lt;a href=&quot;admin.php?page=wysija_campaigns&id=&lt;?php echo $row[&quot;email_id&quot;] ?&gt;&action=viewstats&quot; class=&quot;stats&quot;&gt;&lt;?php _e('Stats', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                                        &lt;/span&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                                    | &lt;span class=&quot;duplicate&quot;&gt;&nbsp;</div></li><li><div>                                        &lt;a href=&quot;admin.php?page=wysija_campaigns&id=&lt;?php echo $dupid ?&gt;&email_id=&lt;?php echo $row[&quot;email_id&quot;] ?&gt;&action=duplicate&_wpnonce=&lt;?php echo $this-&gt;secure(array(&quot;action&quot; =&gt; &quot;duplicate&quot;, &quot;id&quot; =&gt; $dupid), true); ?&gt;&quot; class=&quot;submitedit&quot;&gt;&lt;?php _e('Duplicate', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                                    &lt;/span&gt;&nbsp;</div></li><li><div>                                    | &lt;span class=&quot;delete&quot;&gt;&nbsp;</div></li><li><div>                                        &lt;a href=&quot;&lt;?php echo $data['base_url'] ?&gt;&id=&lt;?php echo $deleteId ?&gt;&action=delete&lt;?php echo $deleteAction ?&gt;&_wpnonce=&lt;?php echo $this-&gt;secure(array(&quot;action&quot; =&gt; &quot;delete&quot; . $deleteAction, &quot;id&quot; =&gt; $deleteId), true); ?&gt;&quot; class=&quot;submitdelete&quot;&gt;&lt;?php _e('Delete', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                                    &lt;/span&gt;&nbsp;</div></li><li><div>                                &lt;?php&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        ?&gt;&nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;/td&gt;&nbsp;</div></li><li><div>                    &lt;td&gt;&lt;?php&nbsp;</div></li><li><div>                        switch ((int) $row['status']) {&nbsp;</div></li><li><div>                            case 99:&nbsp;</div></li><li><div>                            case 3:&nbsp;</div></li><li><div>                            case 2:&nbsp;</div></li><li><div>                            case 1:&nbsp;</div></li><li><div>                                // automatic newsletters&nbsp;</div></li><li><div>                                if ($row['type'] == 2) {&nbsp;</div></li><li><div>                                    $pause = '';&nbsp;</div></li><li><div>                                    // non immediate post notifications&nbsp;</div></li><li><div>                                    if (isset($row['params']['autonl']['event']) && $row['params']['autonl']['event'] == 'new-articles' && $row['params']['autonl']['when-article'] != 'immediate') {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        //if the next send value of the post notification newsletter is not set or&nbsp;</div></li><li><div>                                        if (!isset($row['params']['autonl']['nextSend'])) {&nbsp;</div></li><li><div>                                            $nextSend = false;&nbsp;</div></li><li><div>                                            //find a way to update the missing next send without triggerring a give_birth&nbsp;</div></li><li><div>                                        } else {&nbsp;</div></li><li><div>                                            $nextSend = $row['params']['autonl']['nextSend'];&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        $helper_toolbox = WYSIJA::get('toolbox', 'helper');&nbsp;</div></li><li><div>                                        $time = $helper_toolbox-&gt;localtime($row['params']['autonl']['time'], true);&nbsp;</div></li><li><div>                                        $dayname = $helper_toolbox-&gt;getday($row['params']['autonl']['dayname']);&nbsp;</div></li><li><div>                                        $daynumber = $helper_toolbox-&gt;getdaynumber($row['params']['autonl']['daynumber']);&nbsp;</div></li><li><div>                                        $weeknumber = $helper_toolbox-&gt;getweeksnumber($row['params']['autonl']['dayevery']);&nbsp;</div></li><li><div>                                        $durationsent = '';&nbsp;</div></li><li><div>                                        if ($nextSend) {&nbsp;</div></li><li><div>                                            $timeleft = $helper_toolbox-&gt;localtime_to_servertime($nextSend) - time();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            $scheduled_on = date_i18n(get_option('date_format') . ' ' . get_option('time_format'), $nextSend);&nbsp;</div></li><li><div>                                            if ($timeleft &lt; (3600 * 24)) {&nbsp;</div></li><li><div>                                                $timeleft = $helper_toolbox-&gt;duration_string($timeleft, true, 2);&nbsp;</div></li><li><div>                                                $durationsent = '&lt;span title=&quot;' . $scheduled_on . '&quot;&gt;' . sprintf(__('Next send out in %1$s', WYSIJA), $timeleft) . '&lt;/span&gt;';&nbsp;</div></li><li><div>                                            } else {&nbsp;</div></li><li><div>                                                $timeleft = date_i18n(get_option('date_format') . ' ' . get_option('time_format'), $nextSend);&nbsp;</div></li><li><div>                                                $durationsent = sprintf(__('Next send out on %1$s', WYSIJA), $timeleft);&nbsp;</div></li><li><div>                                            }&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        switch ($row['params']['autonl']['when-article']) {&nbsp;</div></li><li><div>                                            case 'daily':&nbsp;</div></li><li><div>                                                $statussent = sprintf(__('Sent daily at %1$s.', WYSIJA), $time);&nbsp;</div></li><li><div>                                                break;&nbsp;</div></li><li><div>                                            case 'weekly':&nbsp;</div></li><li><div>                                                $statussent = sprintf(__('Sent weekly on %1$s at %2$s', WYSIJA), $dayname, $time);&nbsp;</div></li><li><div>                                                break;&nbsp;</div></li><li><div>                                            case 'monthly':&nbsp;</div></li><li><div>                                                $statussent = sprintf(__('Sent monthly on the %1$s at %2$s', WYSIJA), $daynumber, $time);&nbsp;</div></li><li><div>                                                break;&nbsp;</div></li><li><div>                                            case 'monthlyevery':&nbsp;</div></li><li><div>                                                $statussent = sprintf(__('Sent monthly on the %1$s %2$s at %3$s', WYSIJA), $weeknumber, $dayname, $time);&nbsp;</div></li><li><div>                                                break;&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        echo '&lt;p&gt;' . $statussent . '&lt;/p&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        echo '&lt;p&gt;' . $durationsent . ' (' . __('if there\'s new content', WYSIJA) . ')&lt;/p&gt;';&nbsp;</div></li><li><div>                                        if (isset($row['params']['autonl']['late_send']) && WYSIJA_DBG &gt; 1) {&nbsp;</div></li><li><div>                                            $last_send = $late_send = 0;&nbsp;</div></li><li><div>                                            if(!empty($row['params']['autonl']['late_send'])) $late_send = $row['params']['autonl']['late_send'];&nbsp;</div></li><li><div>                                            $late_send = date_i18n(get_option('date_format') . ' ' . get_option('time_format'), $late_send);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            if(!empty($row['params']['autonl']['lastSend'])) $last_send = $row['params']['autonl']['lastSend'];&nbsp;</div></li><li><div>                                            $last_send = date_i18n(get_option('date_format') . ' ' . get_option('time_format'), $last_send);&nbsp;</div></li><li><div>                                            echo '&lt;p&gt;' . sprintf('The last scheduled send due on %1$s was late and postponed.', $late_send) . '&lt;/p&gt;';&nbsp;</div></li><li><div>                                            echo '&lt;p&gt;' . sprintf('The last executed send was on : %1$s ', $last_send) . '&lt;/p&gt;';&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        echo $pause;&nbsp;</div></li><li><div>                                    } else {&nbsp;</div></li><li><div>                                        // autoresponders and immediate post notifications&nbsp;</div></li><li><div>                                        $delay = '';&nbsp;</div></li><li><div>                                        if (!isset($row['params']['autonl']['numberafter']))&nbsp;</div></li><li><div>                                            $numberafter = 0;&nbsp;</div></li><li><div>                                        else {&nbsp;</div></li><li><div>                                            $numberafter = (int) $row['params']['autonl']['numberafter'];&nbsp;</div></li><li><div>                                            $delay = $numberafter . ' ' . $data['autonl']['fields']['numberofwhat']['valuesunit'][$row['params']['autonl']['numberofwhat']];&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        $statustext = $this-&gt;getSendingStatus($row, $data, $numberafter, $delay);&nbsp;</div></li><li><div>                                        echo $statustext . $pause . $this-&gt;dataBatches($data, $row, $pause, $statuses, true);&nbsp;</div></li><li><div>                                    }&nbsp;</div></li><li><div>                                } else {&nbsp;</div></li><li><div>                                    // standard emails&nbsp;</div></li><li><div>                                    $pause = ' &lt;a href=&quot;admin.php?page=wysija_campaigns&id=' . $row['email_id'] . '&action=pause&_wpnonce='.$this-&gt;secure(array('action' =&gt; 'pause' , 'id' =&gt; $row[&quot;email_id&quot;]), true).'&quot; class=&quot;submitedit button&quot;&gt;' . __(&quot;Pause&quot;, WYSIJA) . '&lt;/a&gt;';&nbsp;</div></li><li><div>                                    echo $this-&gt;dataBatches($data, $row, $pause, $statuses);&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                break;&nbsp;</div></li><li><div>                            case -1:&nbsp;</div></li><li><div>                                if ($row['type'] == 2) {&nbsp;</div></li><li><div>                                    $resumelink = __('Not active.', WYSIJA) . ' | &lt;a href=&quot;admin.php?page=wysija_campaigns&id=' . $row['email_id'] . '&action=resume&_wpnonce='.$this-&gt;secure(array('action' =&gt; 'resume' , 'id' =&gt; $row[&quot;email_id&quot;]), true).'&quot; class=&quot;submitedit&quot;&gt;' . __('Activate', WYSIJA) . '&lt;/a&gt;';&nbsp;</div></li><li><div>                                    echo $resumelink;&nbsp;</div></li><li><div>                                } else {&nbsp;</div></li><li><div>                                    $resumelink = '&lt;a href=&quot;admin.php?page=wysija_campaigns&id=' . $row['email_id'] . '&action=resume&_wpnonce='.$this-&gt;secure(array('action' =&gt; 'resume' , 'id' =&gt; $row[&quot;email_id&quot;]), true).'&quot; class=&quot;submitedit&quot;&gt;' . __('Resume', WYSIJA) . '&lt;/a&gt;';&nbsp;</div></li><li><div>                                    echo sprintf($statuses[$row['status']], $data['sent'][$row['email_id']]['to'], $data['sent'][$row['email_id']]['total']);&nbsp;</div></li><li><div>                                    echo ' | ' . $resumelink;&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                break;&nbsp;</div></li><li><div>                            case 4:&nbsp;</div></li><li><div>                            case 0:&nbsp;</div></li><li><div>                                if ($statusshared)&nbsp;</div></li><li><div>                                    echo $statusshared;&nbsp;</div></li><li><div>                                else {&nbsp;</div></li><li><div>                                    if ($row[&quot;type&quot;] == 2)&nbsp;</div></li><li><div>                                        echo __('Not active.', WYSIJA);&nbsp;</div></li><li><div>                                    else&nbsp;</div></li><li><div>                                        echo __('Not sent yet.', WYSIJA); //$statuses[$row[&quot;status&quot;]];&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>                                break;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                    &lt;td&gt;&lt;?php&nbsp;</div></li><li><div>                        if (($row['type'] == 2 && isset($row['params']['autonl']['event']) && $row['params']['autonl']['event'] == 'subs-2-nl')) {&nbsp;</div></li><li><div>                            $row['lists'] = $data['lists'][$row['params']['autonl']['subscribetolist']]['name'];&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        if (isset($row['lists']))&nbsp;</div></li><li><div>                            echo $row['lists'];&nbsp;</div></li><li><div>                        else&nbsp;</div></li><li><div>                            echo $messageListEdit;&nbsp;</div></li><li><div>                        ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;td&gt;&nbsp;</div></li><li><div>                    &lt;?php if (isset($row['stats'])) echo $row['stats']; elseif ($row['status'] != 0) { ?&gt;&nbsp;</div></li><li><div>                            &lt;a href=&quot;admin.php?page=wysija_campaigns&id=&lt;?php echo $row[&quot;email_id&quot;] ?&gt;&action=viewstats&quot; class=&quot;stats&quot; title=&quot;&lt;?php echo $row['number_opened'] . ' - ' . $row['number_clicked'] . ' - ' . $row['number_unsub']; ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                        &lt;?php echo $row['rate_opened'] . '% - ' . $row['rate_clicked'] . '% - ' . $row['rate_unsub'] . '%'; ?&gt;&nbsp;</div></li><li><div>                            &lt;/a&gt;&nbsp;</div></li><li><div>                    &lt;?php } ?&gt;&nbsp;</div></li><li><div>                    &lt;/td&gt;&nbsp;</div></li><li><div>                    &lt;td title='&lt;?php echo $this-&gt;fieldListHTML_created_at_time($row['modified_at'], get_option('date_format') . ' ' . get_option('time_format')); ?&gt;'&gt;&lt;?php echo $this-&gt;fieldListHTML_created_at($row['modified_at']); ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                    &lt;td title='&lt;?php echo $this-&gt;fieldListHTML_created_at_time($row['sent_at'], get_option('date_format') . ' ' . get_option('time_format')); ?&gt;'&gt;&lt;?php echo $this-&gt;fieldListHTML_created_at($row['sent_at']); ?&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>            if (WYSIJA_DBG &gt; 1) {&nbsp;</div></li><li><div>                echo '&lt;p&gt;' . $row['sent_at'] . '&lt;/p&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                    &lt;/tr&gt;&lt;?php&nbsp;</div></li><li><div>            $alt = !$alt;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;/tbody&gt;&nbsp;</div></li><li><div>            &lt;/table&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        echo $hiddenOrder;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function getSendingStatus($row, $data, $numberafter, $delay) {&nbsp;</div></li><li><div>        $statustext = false;&nbsp;</div></li><li><div>        if (isset($row['msgSendSuspended'])) {&nbsp;</div></li><li><div>            $statustext = $row['msgSendSuspended'];&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            switch ($row[&quot;params&quot;]['autonl']['event']) {&nbsp;</div></li><li><div>                case 'new-articles':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $statustext = __('Send immediately.', WYSIJA);&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                case 'subs-2-nl':&nbsp;</div></li><li><div>                    $list = '';&nbsp;</div></li><li><div>                    if (isset($data['autonl']['fields']['subscribetolist']['values'][$row[&quot;params&quot;]['autonl']['subscribetolist']]))&nbsp;</div></li><li><div>                        $list = '&lt;em&gt;&quot;' . $data['autonl']['fields']['subscribetolist']['values'][$row[&quot;params&quot;]['autonl']['subscribetolist']] . '&quot;&lt;/em&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ($numberafter &lt; 1 || $row[&quot;params&quot;]['autonl']['numberofwhat'] == 'immediate')&nbsp;</div></li><li><div>                        $statustext = sprintf(__('Sending immediately after someone subscribes to the mailing list %1$s', WYSIJA), $list);&nbsp;</div></li><li><div>                    else&nbsp;</div></li><li><div>                        $statustext = sprintf(__('Sent %2$s after someone subscribes to the mailing list %1$s', WYSIJA), $list, '&lt;strong&gt;' . $delay . '&lt;/strong&gt;');&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                // Auto newsletter when new user is added to WordPress.&nbsp;</div></li><li><div>                case 'new-user':&nbsp;</div></li><li><div>                    // Make the &quot;any&quot; word translatable.&nbsp;</div></li><li><div>                    $roles = $row[&quot;params&quot;]['autonl']['roles'];&nbsp;</div></li><li><div>                    if ($roles === 'any') {&nbsp;</div></li><li><div>                        $roles = __('any role', WYSIJA);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ($numberafter &lt; 1 || $row[&quot;params&quot;]['autonl']['numberofwhat'] == 'immediate') {&nbsp;</div></li><li><div>                        // Send immediately on subscription.&nbsp;</div></li><li><div>                        $statustext = sprintf(__('Sent immediately after a new user is added to your site as %1$s.', WYSIJA), '&lt;b&gt;' . $roles . '&lt;/b&gt;');&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        // Send with delay.&nbsp;</div></li><li><div>                        $statustext = sprintf(__('Sent %2$s after a new user is added to your site as %1$s.', WYSIJA), '&lt;b&gt;' . $roles . '&lt;/b&gt;', '&lt;strong&gt;' . $delay . '&lt;/strong&gt;');&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                default:&nbsp;</div></li><li><div>                    //try to see if the plugin returns something&nbsp;</div></li><li><div>                    $functioname = str_replace('-', '_', $row[&quot;params&quot;]['autonl']['event']) . '_sendingStatus';&nbsp;</div></li><li><div>                    if (function_exists($functioname))&nbsp;</div></li><li><div>                        $statustext = call_user_func($functioname, $row[&quot;params&quot;]['autonl'], $numberafter, $delay);&nbsp;</div></li><li><div>                    if (!$statustext)&nbsp;</div></li><li><div>                        $statustext = __('Sending per event', WYSIJA);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $statustext;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function sending_process() {&nbsp;</div></li><li><div>        $config = WYSIJA::get(&quot;config&quot;, &quot;model&quot;);&nbsp;</div></li><li><div>        if ((int) $config-&gt;getValue('total_subscribers') &lt; 2000)&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function dataBatches($data, $row, $pause, $statuses, $pending = false) {&nbsp;</div></li><li><div>        $sentto = $senttotal = $sentleft = 0;&nbsp;</div></li><li><div>        $return = '&lt;div&gt;';&nbsp;</div></li><li><div>        if (isset($data['sent'][$row[&quot;email_id&quot;]]['to']))&nbsp;</div></li><li><div>            $sentto = $data['sent'][$row[&quot;email_id&quot;]]['to'];&nbsp;</div></li><li><div>        if (isset($data['sent'][$row[&quot;email_id&quot;]]['total']))&nbsp;</div></li><li><div>            $senttotal = $data['sent'][$row[&quot;email_id&quot;]]['total'];&nbsp;</div></li><li><div>        if (isset($data['sent'][$row[&quot;email_id&quot;]]['left']))&nbsp;</div></li><li><div>            $sentleft = $data['sent'][$row[&quot;email_id&quot;]]['left'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $statusdata = $senttohowmany = '';&nbsp;</div></li><li><div>        if ($row['type'] != 2)&nbsp;</div></li><li><div>            $statusdata = sprintf($statuses[$row[&quot;status&quot;]], $sentto, $senttotal);&nbsp;</div></li><li><div>        elseif ($row['params']['autonl']['event'] != 'new-articles')&nbsp;</div></li><li><div>            $return.=sprintf(__('Sent to %1$s subscribers.', WYSIJA), $sentto) . ' ';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ($sentleft &gt; 0) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $config = WYSIJA::get('config', 'model');&nbsp;</div></li><li><div>            add_filter('wysija_send_ok', array($this, 'sending_process'));&nbsp;</div></li><li><div>            $letsgo = apply_filters('wysija_send_ok', false);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ($letsgo) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $helper_toolbox = WYSIJA::get('toolbox', 'helper');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // Standard newsletter. Let's show the progress bar.&nbsp;</div></li><li><div>                if ($row['type'] != 2) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $percent_status = round(($sentto * 100) / $senttotal);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $return .= '&lt;p&gt;&lt;strong&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if($data['sent'][$row['email_id']]['remaining_time'] &lt; 1) {&nbsp;</div></li><li><div>                        $return .= __('The last batch of emails should start sending automatically in the next few minutes.', WYSIJA);&nbsp;</div></li><li><div>                    }else{&nbsp;</div></li><li><div>                        $return .= sprintf(__('Time remaining: %1$s', WYSIJA), $helper_toolbox-&gt;duration_string($data['sent'][$row['email_id']]['remaining_time'], true, 4, 4));&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $return .= '&lt;/strong&gt;&lt;/p&gt;';&nbsp;</div></li><li><div>                    $return .= '&lt;div class=&quot;progress_bar&quot;&gt;';&nbsp;</div></li><li><div>                    $return .= '&lt;div class=&quot;bar&quot;&gt;';&nbsp;</div></li><li><div>                    $return .= '&lt;div class=&quot;progress&quot; style=&quot;width: ' . $percent_status . '%&quot;&gt;';&nbsp;</div></li><li><div>                    $return .= '&lt;/div&gt;';&nbsp;</div></li><li><div>                    $return .= '&lt;div class=&quot;percent&quot;&gt;';&nbsp;</div></li><li><div>                    $return .= $sentto . ' / ' . $senttotal;&nbsp;</div></li><li><div>                    $return .= '&lt;/div&gt;';&nbsp;</div></li><li><div>                    $return .= '&lt;/div&gt;';&nbsp;</div></li><li><div>                    $return .= $pause;&nbsp;</div></li><li><div>                    $return .= '&lt;/div&gt;';&nbsp;</div></li><li><div>                    $return .= '&lt;div class=&quot;info-stats&quot;&gt;';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $is_multisite = is_multisite();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                //$is_multisite=true;//PROD comment that line&nbsp;</div></li><li><div>                if ($is_multisite && $config-&gt;getValue('sending_method') == 'network') {&nbsp;</div></li><li><div>                    $sending_emails_number = (int) $config-&gt;getValue('ms_sending_emails_number');&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $sending_emails_number = (int) $config-&gt;getValue('sending_emails_number');&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ($sentleft &gt; $sending_emails_number)&nbsp;</div></li><li><div>                    $nextBatchnumber = $sending_emails_number;&nbsp;</div></li><li><div>                else&nbsp;</div></li><li><div>                    $nextBatchnumber = (int) $sentleft;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                //Next batch of xx emails will be sent in xx minutes. Don't wait & send right now.&nbsp;</div></li><li><div>                if ($pending) {&nbsp;</div></li><li><div>                    $return.= '&lt;span style=&quot;color:#555&quot;&gt;&lt;a href=&quot;admin.php?page=wysija_campaigns&action=manual_send&emailid=' . $row['email_id'] . '&pending=1&_wpnonce='.$this-&gt;secure(array('action' =&gt; 'manual_send'), true).'&quot; title=&quot;view pending&quot; class=&quot;action-send-test-editor&quot; &gt;' . sprintf(__(' %1$s email(s) scheduled.', WYSIJA) . '&lt;/a&gt;', $sentleft);&nbsp;</div></li><li><div>                    $return.= '&lt;/span&gt;';&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    if ($data['sent'][$row['email_id']]['running_for']) {&nbsp;</div></li><li><div>                        $return.= sprintf(__('Latest batch was sent %1$s ago.', WYSIJA), $data['sent'][$row['email_id']]['running_for']);&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $time_remaining = trim($helper_toolbox-&gt;duration_string($data['sent'][$row['email_id']]['next_batch'], true, 4));&nbsp;</div></li><li><div>                        $return.= '&lt;a href=&quot;admin.php?page=wysija_campaigns&action=manual_send&emailid=' . $row['email_id'] . '&_wpnonce='.$this-&gt;secure(array('action' =&gt; 'manual_send'), true).'&quot; class=&quot;action-send-test-editor&quot; &gt;' . __('Don\'t wait & send right now.', WYSIJA) . '&lt;/a&gt;';&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $return.= $statusdata;&nbsp;</div></li><li><div>                $helper_licence = WYSIJA::get('licence', 'helper');&nbsp;</div></li><li><div>                $url_checkout = $helper_licence-&gt;get_url_checkout('resume_send');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $link = str_replace(&nbsp;</div></li><li><div>                        array('[link]', '[/link]'), array('&lt;a title=&quot;' . __('Get Premium now', WYSIJA) . '&quot; target=&quot;_blank&quot; href=&quot;' . $url_checkout . '&quot;&gt;', '&lt;/a&gt;'), __('To resume send [link]Go premium now![/link]', WYSIJA));&nbsp;</div></li><li><div>                $return.= '&lt;p&gt;' . $link . '&lt;/p&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $return.= $statusdata;&nbsp;</div></li><li><div>        $return.='&lt;/div&gt;';&nbsp;</div></li><li><div>        return $return;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function linkStats($result, $data) {&nbsp;</div></li><li><div>        $result = '&lt;ol&gt;';&nbsp;</div></li><li><div>        $countloop = 0;&nbsp;</div></li><li><div>        $helper_licence = WYSIJA::get('licence', 'helper');&nbsp;</div></li><li><div>        $url_checkout = $helper_licence-&gt;get_url_checkout('count_click_stats');&nbsp;</div></li><li><div>        foreach ($data['clicks'] as $click) {&nbsp;</div></li><li><div>            if ($countloop == 0)&nbsp;</div></li><li><div>                $label = str_replace(array('[link]', '[/link]'), array('&lt;a class=&quot;premium-tab&quot; target=&quot;_blank&quot; href=&quot;' . $url_checkout . '&quot;&gt;', '&lt;/a&gt;'), __('see links with a [link]Premium licence[/link].', WYSIJA));&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                $label = '...';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $css_class = 'stats-url-link';&nbsp;</div></li><li><div>            if (!empty($_REQUEST['url_id']) && $_REQUEST['url_id'] == $click['url_id'])&nbsp;</div></li><li><div>                $css_class .= ' select';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $link = 'admin.php?page=wysija_campaigns&action=viewstats&id=' . $_REQUEST['id'] . '&url_id=' . $click['url_id'];&nbsp;</div></li><li><div>            $result.='&lt;li&gt;&lt;a href=&quot;' . $link . '&quot; class=&quot;' . $css_class . '&quot;&gt;' . $click['name'] . '&lt;/a&gt; : ' . $label . '&lt;/li&gt;';&nbsp;</div></li><li><div>            $countloop++;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $result.='&lt;/ol&gt;';&nbsp;</div></li><li><div>        return $result;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * main view&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function viewstats($data) {&nbsp;</div></li><li><div>        $this-&gt;icon = 'icon-stats';&nbsp;</div></li><li><div>        $this-&gt;search['title'] = __('Search recipients', WYSIJA);&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>                    &lt;?php if (!empty($data['hooks']['hook_newsletter_top'])) { ?&gt;&nbsp;</div></li><li><div>            &lt;div id=&quot;hook_newsletter_top&quot; class=&quot;hook clear&quot;&gt;&lt;?php echo $data['hooks']['hook_newsletter_top']; ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;?php } ?&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    echo '&lt;div style=&quot;clear:both;&quot;&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>                    echo '&lt;form method=&quot;post&quot; action=&quot;&quot; id=&quot;posts-filter&quot;&gt;';&nbsp;</div></li><li><div>                    $this-&gt;filtersLink($data);&nbsp;</div></li><li><div>                    $this-&gt;filterDDPVIEW($data);&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;list&quot;&gt;&nbsp;</div></li><li><div>            &lt;table cellspacing=&quot;0&quot; class=&quot;widefat fixed&quot;&gt;&nbsp;</div></li><li><div>                &lt;thead&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    $umstatussorting = $statussorting = $fnamesorting = $lnamesorting = $usrsorting = $datesorting = &quot; sortable desc&quot;;&nbsp;</div></li><li><div>                    $hiddenOrder = &quot;&quot;;&nbsp;</div></li><li><div>                    if (isset($_REQUEST[&quot;orderby&quot;])) {&nbsp;</div></li><li><div>                        switch ($_REQUEST[&quot;orderby&quot;]) {&nbsp;</div></li><li><div>                            case &quot;email&quot;:&nbsp;</div></li><li><div>                                $usrsorting = &quot; sorted &quot; . $_REQUEST[&quot;ordert&quot;];&nbsp;</div></li><li><div>                                break;&nbsp;</div></li><li><div>                            case &quot;opened_at&quot;://default stat view&nbsp;</div></li><li><div>                            case &quot;created_at&quot;://queue stat view&nbsp;</div></li><li><div>                            case &quot;clicked_at&quot;://filter by url view&nbsp;</div></li><li><div>                                $datesorting = &quot; sorted &quot; . $_REQUEST[&quot;ordert&quot;];&nbsp;</div></li><li><div>                                break;&nbsp;</div></li><li><div>                            case &quot;ustatus&quot;:&nbsp;</div></li><li><div>                                $statussorting = &quot; sorted &quot; . $_REQUEST[&quot;ordert&quot;];&nbsp;</div></li><li><div>                                break;&nbsp;</div></li><li><div>                            case &quot;umstatus&quot;:&nbsp;</div></li><li><div>                                $umstatussorting = &quot; sorted &quot; . $_REQUEST[&quot;ordert&quot;];&nbsp;</div></li><li><div>                                break;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        $hiddenOrder = '&lt;input type=&quot;hidden&quot; name=&quot;orderby&quot; id=&quot;wysija-orderby&quot; value=&quot;' . esc_attr($_REQUEST[&quot;orderby&quot;]) . '&quot;/&gt;';&nbsp;</div></li><li><div>                        $hiddenOrder.='&lt;input type=&quot;hidden&quot; name=&quot;ordert&quot; id=&quot;wysija-ordert&quot; value=&quot;' . esc_attr($_REQUEST[&quot;ordert&quot;]) . '&quot;/&gt;';&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $header = '&lt;tr class=&quot;thead&quot;&gt;&nbsp;</div></li><li><div>                            &lt;th class=&quot;manage-column column-username' . $usrsorting . '&quot; id=&quot;email&quot; scope=&quot;col&quot; style=&quot;width:140px;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;' . __('Email', WYSIJA) . '&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>                    /** $header.='&lt;th class=&quot;manage-column column-fname'.$fnamesorting.'&quot; id=&quot;firstname&quot; scope=&quot;col&quot; style=&quot;width:80px;&quot;&gt;'.__('First name', WYSIJA).'&lt;/th&gt;&nbsp;</div></li><li><div>                      &lt;th class=&quot;manage-column column-lname'.$lnamesorting.'&quot; id=&quot;lastname&quot; scope=&quot;col&quot; style=&quot;width:80px;&quot;&gt;'.__('Last name', WYSIJA).'&lt;/th&gt;'; */&nbsp;</div></li><li><div>                    $header.='&lt;th class=&quot;manage-column column-umstatus' . $umstatussorting . '&quot; id=&quot;umstatus&quot; scope=&quot;col&quot; style=&quot;width:80px;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;' . __('Email Status', WYSIJA) . '&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>                    $header.='&lt;th class=&quot;manage-column column-list-names&quot; id=&quot;list-list&quot; scope=&quot;col&quot;&gt;' . __('Lists', WYSIJA) . '&lt;/th&gt;';&nbsp;</div></li><li><div>                    $header.='&lt;th class=&quot;manage-column column-ustatus' . $statussorting . '&quot; id=&quot;ustatus&quot; scope=&quot;col&quot; style=&quot;width:80px;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;' . __('Subscriber Status', WYSIJA) . '&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>                    /** $header.='&lt;th class=&quot;manage-column column-emails&quot; id=&quot;emails-list&quot; scope=&quot;col&quot;&gt;'.__('Emails', WYSIJA).'&lt;/th&gt;&nbsp;</div></li><li><div>                      &lt;th class=&quot;manage-column column-opened&quot; id=&quot;opened-list&quot; scope=&quot;col&quot;&gt;'.__('Opened', WYSIJA).'&lt;/th&gt;&nbsp;</div></li><li><div>                      &lt;th class=&quot;manage-column column-clic&quot; id=&quot;clic-list&quot; scope=&quot;col&quot;&gt;'.__('Clicked', WYSIJA).'&lt;/th&gt;'; */&nbsp;</div></li><li><div>                    if (empty($data['tableQuery']))&nbsp;</div></li><li><div>                        $data['tableQuery'] = '';&nbsp;</div></li><li><div>                    switch ($data['tableQuery']) {&nbsp;</div></li><li><div>                        case 'email_user_url':&nbsp;</div></li><li><div>                            $header.='&lt;th class=&quot;manage-column column-date' . $datesorting . '&quot; id=&quot;clicked_at&quot; scope=&quot;col&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;' . __('Clicked on', WYSIJA) . '&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>                            break;&nbsp;</div></li><li><div>                        case 'email_user_stat':&nbsp;</div></li><li><div>                            $label = __('Opened date', WYSIJA);&nbsp;</div></li><li><div>                            if (!empty($_REQUEST['link_filter']) && $_REQUEST['link_filter'] == 'clicked')&nbsp;</div></li><li><div>                                $label = __('Clicked on', WYSIJA);&nbsp;</div></li><li><div>                            $header.='&lt;th class=&quot;manage-column column-date' . $datesorting . '&quot; id=&quot;opened_at&quot; scope=&quot;col&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;' . $label . '&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>                            break;&nbsp;</div></li><li><div>                        case 'queue':&nbsp;</div></li><li><div>                        default:&nbsp;</div></li><li><div>                            $header.='&lt;th class=&quot;manage-column column-date' . $datesorting . '&quot; id=&quot;created_at&quot; scope=&quot;col&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;' . __('Subscribed on', WYSIJA) . '&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>                            break;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $header .= '&lt;/tr&gt;';&nbsp;</div></li><li><div>                    echo $header;&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                &lt;/thead&gt;&nbsp;</div></li><li><div>                &lt;tfoot&gt;&nbsp;</div></li><li><div>                       &lt;?php&nbsp;</div></li><li><div>                       echo $header;&nbsp;</div></li><li><div>                       ?&gt;&nbsp;</div></li><li><div>                &lt;/tfoot&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;tbody class=&quot;list:&lt;?php echo $this-&gt;model-&gt;table_name . ' ' . $this-&gt;model-&gt;table_name . '-list'; ?&gt;&quot; id=&quot;wysija-&lt;?php echo $this-&gt;model-&gt;table_name; ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                       &lt;?php&nbsp;</div></li><li><div>                       $listingRows = '';&nbsp;</div></li><li><div>                       $alt = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                       $statuses = array(&quot;-1&quot; =&gt; __(&quot;Unsubscribed&quot;, WYSIJA), &quot;0&quot; =&gt; __(&quot;Unconfirmed&quot;, WYSIJA), &quot;1&quot; =&gt; __(&quot;Subscribed&quot;, WYSIJA));&nbsp;</div></li><li><div>                       $config = WYSIJA::get(&quot;config&quot;, &quot;model&quot;);&nbsp;</div></li><li><div>                       if (!$config-&gt;getValue(&quot;confirm_dbleoptin&quot;))&nbsp;</div></li><li><div>                           $statuses[&quot;0&quot;] = $statuses[&quot;1&quot;];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                       $mstatuses = array('-2' =&gt; $this-&gt;getTransStatusEmail('notsent'), '-1' =&gt; $this-&gt;getTransStatusEmail('bounced'), '0' =&gt; $this-&gt;getTransStatusEmail('sent')&nbsp;</div></li><li><div> , '1' =&gt; $this-&gt;getTransStatusEmail('opened'), '2' =&gt; $this-&gt;getTransStatusEmail('clicked'), '3' =&gt; $this-&gt;getTransStatusEmail('unsubscribe'));&nbsp;</div></li><li><div>                       //dbg($data, false);&nbsp;</div></li><li><div>                       foreach ($data['subscribers'] as $row) {&nbsp;</div></li><li><div>                           $classRow = '';&nbsp;</div></li><li><div>                           if ($alt)&nbsp;</div></li><li><div>                               $classRow = ' class=&quot;alternate&quot; ';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                           echo '&lt;tr ' . $classRow . ' &gt;';&nbsp;</div></li><li><div>                           echo '&lt;td class=&quot;username column-username&quot;&gt;';&nbsp;</div></li><li><div>                           echo get_avatar($row['email'], 32);&nbsp;</div></li><li><div>                           echo '&lt;strong&gt;' . $row['email'] . '&lt;/strong&gt;';&nbsp;</div></li><li><div>                           echo '&lt;p style=&quot;margin:0;&quot;&gt;' . $row['lastname'] . ' ' . $row['firstname'] . '&lt;/p&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                           echo '&lt;div class=&quot;row-actions&quot;&gt;&nbsp;</div></li><li><div>                                            &lt;span class=&quot;edit&quot;&gt;&nbsp;</div></li><li><div>                                                &lt;a href=&quot;admin.php?page=wysija_subscribers&id=' . $row['user_id'] . '&action=edit&quot; class=&quot;submitedit&quot;&gt;' . __('View stats or edit', WYSIJA) . '&lt;/a&gt;&nbsp;</div></li><li><div>                                            &lt;/span&gt;&nbsp;</div></li><li><div>                                        &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                           echo '&lt;/td&gt;';&nbsp;</div></li><li><div>                           /** &lt;td&gt;&lt;?php echo $row[&quot;firstname&quot;] ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                             &lt;td&gt;&lt;?php  echo $row[&quot;lastname&quot;] ?&gt;&lt;/td&gt; */&nbsp;</div></li><li><div>                           ?&gt;&nbsp;</div></li><li><div>                           &lt;td&gt;&lt;?php echo $mstatuses[$row[&quot;umstatus&quot;]]; ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                           &lt;td&gt;&lt;?php if (isset($row[&quot;lists&quot;])) echo $row[&quot;lists&quot;] ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                           &lt;td&gt;&lt;?php echo $statuses[$row[&quot;ustatus&quot;]]; ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                           &lt;?php /** &lt;td&gt;&lt;?php echo $row[&quot;emails&quot;] ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                             &lt;td&gt;&lt;?php echo $row[&quot;opened&quot;] ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>                             &lt;td&gt;&lt;?php echo $row[&quot;clicked&quot;] ?&gt;&lt;/td&gt; */ ?&gt;&nbsp;</div></li><li><div>                           &lt;td&gt;&nbsp;</div></li><li><div>                           &lt;?php&nbsp;</div></li><li><div>                           if (empty($data['tableQuery']))&nbsp;</div></li><li><div>                               $data['tableQuery'] = '';&nbsp;</div></li><li><div>                           switch ($data['tableQuery']) {&nbsp;</div></li><li><div>                               case 'email_user_url':&nbsp;</div></li><li><div>                                   echo $this-&gt;fieldListHTML_created_at_time($row[&quot;clicked_at&quot;]);&nbsp;</div></li><li><div>                                   break;&nbsp;</div></li><li><div>                               case 'email_user_stat':&nbsp;</div></li><li><div>                                   echo $this-&gt;fieldListHTML_created_at_time($row[&quot;opened_at&quot;]);&nbsp;</div></li><li><div>                                   break;&nbsp;</div></li><li><div>                               case 'queue':&nbsp;</div></li><li><div>                               default:&nbsp;</div></li><li><div>                                   if (isset($row['created_at']))&nbsp;</div></li><li><div>                                       echo $this-&gt;fieldListHTML_created_at_time($row['created_at']);&nbsp;</div></li><li><div>                                   break;&nbsp;</div></li><li><div>                           }&nbsp;</div></li><li><div>                           ?&gt;&nbsp;</div></li><li><div>                           &lt;/td&gt;&nbsp;</div></li><li><div>                               &lt;?php&nbsp;</div></li><li><div>                               echo '&lt;/tr&gt;';&nbsp;</div></li><li><div>                               $alt = !$alt;&nbsp;</div></li><li><div>                           }&nbsp;</div></li><li><div>                           ?&gt;&nbsp;</div></li><li><div>                       &lt;/tbody&gt;&nbsp;</div></li><li><div>                       &lt;/table&gt;&nbsp;</div></li><li><div>                       &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                           &lt;?php&nbsp;</div></li><li><div>                           echo $hiddenOrder;&nbsp;</div></li><li><div>                           $this-&gt;limitPerPage();&nbsp;</div></li><li><div>                           echo '&lt;/form&gt;';&nbsp;</div></li><li><div>                           ?&gt;&nbsp;</div></li><li><div>                           &lt;?php if (!empty($data['hooks']['hook_newsletter_bottom'])) { ?&gt;&nbsp;</div></li><li><div>                           &lt;div id=&quot;hook_newsletter_bottom&quot; class=&quot;hook&quot;&gt;&nbsp;</div></li><li><div>                               &lt;?php echo $data['hooks']['hook_newsletter_bottom']; ?&gt;&nbsp;</div></li><li><div>                           &lt;/div&gt;&nbsp;</div></li><li><div>                           &lt;?php&nbsp;</div></li><li><div>                           }&nbsp;</div></li><li><div>                       }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                       /** when creating a newsletter or when editing as a draft */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                       function add($data = false) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                           $this-&gt;data = $data;&nbsp;</div></li><li><div>                           $step = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                           $step['type'] = array(&nbsp;</div></li><li><div>                               'type' =&gt; 'type_nl', &nbsp;</div></li><li><div>                               'class' =&gt; 'validate[required]', &nbsp;</div></li><li><div>                               'label' =&gt; __('What type of newsletter is this?', WYSIJA), &nbsp;</div></li><li><div>                               'labeloff' =&gt; 1, &nbsp;</div></li><li><div>                               'desc' =&gt; '');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                           $step['params'] = array(&nbsp;</div></li><li><div>                               'type' =&gt; 'frequencies', &nbsp;</div></li><li><div>                               'label' =&gt; __('Automatically sent...', WYSIJA), 'class' =&gt; 'validate[required]', &nbsp;</div></li><li><div>                               'desc' =&gt; '', &nbsp;</div></li><li><div>                               'labeloff' =&gt; 1, &nbsp;</div></li><li><div>                               'rowclass' =&gt; 'automatic-nl');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                           $step['subject'] = array(&nbsp;</div></li><li><div>                               'type' =&gt; 'subject', &nbsp;</div></li><li><div>                               'label' =&gt; __('Subject line', WYSIJA), &nbsp;</div></li><li><div>                               'class' =&gt; 'validate[required]', &nbsp;</div></li><li><div>                               'desc' =&gt; __(&quot;This is the subject of the email. Be creative since it's the first thing your subscribers will see.&quot;, WYSIJA));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                           if ($this-&gt;data['lists']) {&nbsp;</div></li><li><div>                               $step['lists'] = array(&nbsp;</div></li><li><div>                                   'type' =&gt; 'lists', &nbsp;</div></li><li><div>                                   'class' =&gt; 'validate[minCheckbox[1]] checkbox', &nbsp;</div></li><li><div>                                   'rowclass' =&gt; 'listcheckboxes', &nbsp;</div></li><li><div>                                   'label' =&gt; __('Lists', WYSIJA), &nbsp;</div></li><li><div>                                   'labeloff' =&gt; 1);&nbsp;</div></li><li><div>                           }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                           if (!isset($msg['browsermsg'])) {&nbsp;</div></li><li><div>                               ?&gt;&nbsp;</div></li><li><div>                    &lt;div id=&quot;browsernotsupported&quot; class=&quot;updated&quot; style=&quot;display:none;&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    echo str_replace(&nbsp;</div></li><li><div>                            array(&quot;[/linkchrome]&quot;, &quot;[/linkff]&quot;, &quot;[/linkie]&quot;, &quot;[/linksafari]&quot;, &quot;[/link_ignore]&quot;, &nbsp;</div></li><li><div>                        &quot;[linkchrome]&quot;, &quot;[linkff]&quot;, &quot;[linkie]&quot;, &quot;[linksafari]&quot;, &quot;[link_ignore]&quot;), array(&quot;&lt;/a&gt;&quot;, &quot;&lt;/a&gt;&quot;, &quot;&lt;/a&gt;&quot;, &quot;&lt;/a&gt;&quot;, &quot;&lt;/a&gt;&quot;, &nbsp;</div></li><li><div>                        '&lt;a href=&quot;http://www.google.com/chrome/&quot; target=&quot;_blank&quot;&gt;', '&lt;a href=&quot;http://www.getfirefox.com&quot; target=&quot;_blank&quot;&gt;', '&lt;a href=&quot;http://windows.microsoft.com/en-US/internet-explorer/products/ie/home&quot; target=&quot;_blank&quot;&gt;', '&lt;a href=&quot;http://www.apple.com/safari/download/&quot; target=&quot;_blank&quot;&gt;', '&lt;a class=&quot;linkignore browsermsg&quot; href=&quot;javascript:;&quot;&gt;'), __(&quot;Yikes! Your browser might not be supported. Get the latest [linkchrome]Chrome[/linkchrome], [linkff]Firefox[/linkff], [linkie]Internet Explorer[/linkie] or [linksafari]Safari[/linksafari]. It seems to work?[link_ignore]Dismiss[/link_ignore].&quot;, WYSIJA));&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                &lt;form name=&quot;step1&quot; method=&quot;post&quot; id=&quot;campaignstep3&quot; action=&quot;&quot; class=&quot;form-valid&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;table class=&quot;form-table&quot;&gt;&nbsp;</div></li><li><div>                        &lt;tbody&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                //dbg($data);&nbsp;</div></li><li><div>                echo $this-&gt;buildMyForm($step, $data, &quot;email&quot;, true);&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                        &lt;/tbody&gt;&nbsp;</div></li><li><div>                    &lt;/table&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        $this-&gt;model-&gt;table_name = 'email';&nbsp;</div></li><li><div>        $this-&gt;model-&gt;pk = 'email_id';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset($data['email']['type']) && $data['email']['type'] == 2)&nbsp;</div></li><li><div>            $this-&gt;immediatewarning = '&lt;input type=&quot;submit&quot; id=&quot;save-reactivate&quot; value=&quot;' . __(&quot;Save and reactivate&quot;, WYSIJA) . '&quot; name=&quot;save-reactivate&quot; class=&quot;button-primary wysija&quot;/&gt;' . $this-&gt;immediatewarning;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;_savebuttonsecure($data, &quot;savecamp&quot;, __(&quot;Next step&quot;, WYSIJA), $this-&gt;immediatewarning);&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;/form&gt;&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function editTemplate($data=false) {&nbsp;</div></li><li><div>        wp_print_styles('editor-buttons');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $wjEngine = WYSIJA::get('wj_engine', 'helper');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset($data['email']['wj_data'])) {&nbsp;</div></li><li><div>            $wjEngine-&gt;setData($data['email']['wj_data'], true);&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $wjEngine-&gt;setData();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if (isset($data['email']['wj_styles'])) {&nbsp;</div></li><li><div>            $wjEngine-&gt;setStyles($data['email']['wj_styles'], true);&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $wjEngine-&gt;setStyles();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;style type=&quot;text/css&quot; id=&quot;wj_css&quot;&gt;&nbsp;</div></li><li><div>        &lt;?php echo $wjEngine-&gt;renderStyles(); ?&gt;&nbsp;</div></li><li><div>        &lt;/style&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;!-- BEGIN: Wysija Editor --&gt;&nbsp;</div></li><li><div>        &lt;?php echo $wjEngine-&gt;renderEditor(); ?&gt;&nbsp;</div></li><li><div>        &lt;!-- END: Wysija Editor --&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;?php $defaultData = $wjEngine-&gt;getDefaultData(); ?&gt;&nbsp;</div></li><li><div>        &lt;div id=&quot;wysija_default_header&quot; style=&quot;display:none;&quot;&gt;&lt;?php echo $wjEngine-&gt;renderEditorHeader($defaultData['header']); ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;div id=&quot;wysija_default_footer&quot; style=&quot;display:none;&quot;&gt;&lt;?php echo $wjEngine-&gt;renderEditorFooter($defaultData['footer']); ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;div id=&quot;wysija_widgets_settings&quot; style=&quot;display:none;&quot;&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;autopost&quot;&gt;&lt;?php&nbsp;</div></li><li><div>            // if it's a post notification that should be sent immediately after an article is published, constrain to only 1 autopost with 1 post_limit&nbsp;</div></li><li><div>            if ((int) $data['email']['type'] === 2 && $data['email']['params']['autonl']['event'] === 'new-articles' && $data['email']['params']['autonl']['when-article'] === 'immediate') {&nbsp;</div></li><li><div>                print 'single';&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                print 'multiple';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;divider&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                $params = $data['email']['params'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if(is_array($params) and isset($params['divider'])) {&nbsp;</div></li><li><div>                    $divider = $params['divider'];&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $divider = $defaultData['widgets']['divider'];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                echo $wjEngine-&gt;renderEditorBlock(array_merge(array('type' =&gt; 'divider', 'no-block' =&gt; true), $divider));&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;image&quot;&gt;&lt;?php print WYSIJA_EDITOR_IMG . &quot;transparent.png&quot;; ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;theme&quot;&gt;&lt;?php if (isset($data['email']['params']['theme'])) {&nbsp;</div></li><li><div>                print $data['email']['params']['theme'];&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                print 'default';&nbsp;</div></li><li><div>            } ?&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;!-- BEGIN: Wysija Toolbar --&gt;&nbsp;</div></li><li><div>        &lt;div id=&quot;wysija_toolbar&quot;&gt;&nbsp;</div></li><li><div>            &lt;ul class=&quot;wysija_toolbar_tabs&quot;&gt;&nbsp;</div></li><li><div>                &lt;li class=&quot;wjt-content&quot;&gt;&nbsp;</div></li><li><div>                    &lt;a class=&quot;selected&quot; href=&quot;javascript:;&quot; rel=&quot;content&quot;&gt;&lt;?php _e(&quot;Content&quot;, WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                &lt;/li&gt;&nbsp;</div></li><li><div>                &lt;li class=&quot;wjt-images&quot;&gt;&lt;a href=&quot;javascript:;&quot; rel=&quot;images&quot;&gt;&lt;?php _e(&quot;Images&quot;, WYSIJA) ?&gt;&lt;/a&gt;&lt;/li&gt;&nbsp;</div></li><li><div>                    &lt;?php if (WYSIJA::current_user_can('wysija_style_tab')): ?&gt;&nbsp;</div></li><li><div>                    &lt;li class=&quot;wjt-styles&quot;&gt;&lt;a href=&quot;javascript:;&quot; rel=&quot;styles&quot;&gt;&lt;?php _e(&quot;Styles&quot;, WYSIJA) ?&gt;&lt;/a&gt;&lt;/li&gt;&nbsp;</div></li><li><div>                    &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>                    &lt;?php if (WYSIJA::current_user_can('wysija_theme_tab')): ?&gt;&nbsp;</div></li><li><div>                    &lt;li class=&quot;last wjt-themes&quot;&gt;&lt;a href=&quot;javascript:;&quot; rel=&quot;themes&quot;&gt;&lt;?php _e(&quot;Themes&quot;, WYSIJA) ?&gt;&lt;/a&gt;&lt;/li&gt;&nbsp;</div></li><li><div>                    &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>            &lt;/ul&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;!-- CONTENT BAR --&gt;&nbsp;</div></li><li><div>            &lt;ul class=&quot;wj_content&quot; style=&quot;display:block;&quot;&gt;&nbsp;</div></li><li><div>                &lt;li class=&quot;notice&quot;&gt;&lt;?php _e('Drag the widgets below into your newsletter.', WYSIJA) ?&gt;&lt;/li&gt;&nbsp;</div></li><li><div>                &lt;li&gt;&lt;a class=&quot;wysija_item&quot; wysija_type=&quot;text&quot;&gt;&lt;?php _e('Titles & text', WYSIJA) ?&gt;&lt;/a&gt;&lt;/li&gt;&nbsp;</div></li><li><div>                    &lt;?php if ((int) $data['email']['type'] === 1 || ((int) $data['email']['type'] === 2 && (empty($data['email']['params']['autonl']['event']) || $data['email']['params']['autonl']['event'] !== 'new-articles'))) { ?&gt;&lt;li&gt;&lt;a class=&quot;wysija_item&quot; wysija_type=&quot;post&quot;&gt;&lt;?php _e('WordPress post', WYSIJA) ?&gt;&lt;/a&gt;&lt;/li&gt;&lt;?php } ?&gt;&nbsp;</div></li><li><div>                    &lt;?php if ((int) $data['email']['type'] === 2) { ?&gt;&lt;li&gt;&lt;a class=&quot;wysija_item&quot; id=&quot;wysija-widget-autopost&quot; wysija_type=&quot;popup-auto-post&quot;&gt;&lt;?php _e('Automatic latest content', WYSIJA) ?&gt;&lt;/a&gt;&lt;/li&gt;&lt;?php } ?&gt;&nbsp;</div></li><li><div>                &lt;li&gt;&nbsp;</div></li><li><div>                    &lt;a class=&quot;wysija_item&quot; wysija_type=&quot;divider&quot; wysija_src=&quot;&lt;?php echo $divider['src'] ?&gt;&quot; wysija_width=&quot;&lt;?php echo $divider['width'] ?&gt;&quot; wysija_height=&quot;&lt;?php echo $divider['height'] ?&gt;&quot;&gt;&lt;?php _e('Divider', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                    &lt;a id=&quot;wysija_divider_settings&quot; class=&quot;wysija_item_settings settings&quot; title=&quot;&lt;?php _e('Edit', WYSIJA); ?&gt;&quot; href=&quot;javascript:;&quot; href2=&quot;admin.php?page=wysija_campaigns&action=dividers&tab=dividers&emailId=&lt;?php echo $_REQUEST['id'] ?&gt;&quot;&gt;&lt;span class=&quot;dashicons dashicons-admin-generic&quot;&gt;&lt;/span&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                &lt;/li&gt;&nbsp;</div></li><li><div>                &lt;li&gt;&lt;a class=&quot;wysija_item&quot; wysija_type=&quot;popup-bookmark&quot;&gt;&lt;?php _e('Social bookmarks', WYSIJA) ?&gt;&lt;/a&gt;&lt;/li&gt;&nbsp;</div></li><li><div>            &lt;/ul&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;!-- IMAGES BAR --&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;wj_images&quot; style=&quot;display:none;&quot;&gt;&nbsp;</div></li><li><div>                &lt;div class=&quot;wj_button&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    if (version_compare(get_bloginfo('version'), '3.3.0') &gt;= 0) {&nbsp;</div></li><li><div>                        $action = 'special_new_wordp_upload';&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $action = 'special_wordp_upload';&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                    &lt;a id=&quot;wysija-upload-browse&quot; class=&quot;button&quot; href=&quot;javascript:;&quot; href2=&quot;admin.php?page=wysija_campaigns&action=medias&tab=&lt;?php echo $action; ?&gt;&emailId=&lt;?php echo $_REQUEST['id'] ?&gt;&quot;&gt;&lt;?php _e('Add Images', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;ul id=&quot;wj-images-quick&quot; class=&quot;clearfix&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    //get list images from template&nbsp;</div></li><li><div>                    $helper_image = WYSIJA::get('image', 'helper');&nbsp;</div></li><li><div>                    $result = $helper_image-&gt;get_list_directory();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $quick_select = $data['email']['params'];&nbsp;</div></li><li><div>                    if(!isset($quick_select['quickselection'])) {&nbsp;</div></li><li><div>                        $quick_select['quickselection'] = array();&nbsp;</div></li><li><div>                    }else{&nbsp;</div></li><li><div>                        foreach($quick_select['quickselection'] as &$image) {&nbsp;</div></li><li><div>                            $image = $helper_image-&gt;valid_image($image);&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if($result && empty($quick_select['quickselection'])) {&nbsp;</div></li><li><div>                        echo $wjEngine-&gt;renderImages($result);&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        echo $wjEngine-&gt;renderImages($quick_select['quickselection']);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                &lt;/ul&gt;&nbsp;</div></li><li><div>                &lt;div id=&quot;wj_images_preview&quot; style=&quot;display:none;&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;!-- STYLES BAR --&gt;&nbsp;</div></li><li><div>            &lt;?php if (WYSIJA::current_user_can('wysija_style_tab')): ?&gt;&nbsp;</div></li><li><div>                    &lt;div class=&quot;wj_styles&quot; style=&quot;display:none;&quot;&gt;&nbsp;</div></li><li><div>                        &lt;form id=&quot;wj_styles_form&quot; action=&quot;&quot; method=&quot;post&quot; accept-charset=&quot;utf-8&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                echo $wjEngine-&gt;renderStylesBar();&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                        &lt;/form&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>            &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;!-- THEMES BAR --&gt;&nbsp;</div></li><li><div>            &lt;?php if (WYSIJA::current_user_can('wysija_theme_tab')): ?&gt;&nbsp;</div></li><li><div>                    &lt;div class=&quot;wj_themes&quot; style=&quot;display:none;&quot;&gt;&nbsp;</div></li><li><div>                        &lt;div class=&quot;wj_button&quot;&gt;&nbsp;</div></li><li><div>                            &lt;a id=&quot;wysija-themes-browse&quot; class=&quot;button&quot; href=&quot;javascript:;&quot; href2=&quot;admin.php?page=wysija_campaigns&action=themes&quot;&gt;&lt;?php _e('Add more themes', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>                        &lt;ul id=&quot;wj_themes_list&quot; class=&quot;clearfix&quot;&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>            //get themes&nbsp;</div></li><li><div>            echo $wjEngine-&gt;renderThemes();&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>                        &lt;/ul&gt;&nbsp;</div></li><li><div>                        &lt;div id=&quot;wj_themes_preview&quot; style=&quot;display:none;&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;div id=&quot;wysija_notices&quot;&gt;&nbsp;</div></li><li><div>                    &lt;span id=&quot;wysija_notice_msg&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php echo __('Our toolbar doesn\'t load?', WYSIJA) ?&gt;&nbsp;</div></li><li><div>                        &lt;br /&gt;&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                        echo str_replace(array('[link]', '[/link]'), array('&lt;a title=&quot;' . __('Conflict', WYSIJA) . '&quot; target=&quot;_blank&quot; href=&quot;http://support.mailpoet.com/knowledgebase/list-of-plugins-that-may-cause-conflict/&quot;&gt;', '&lt;/a&gt;'), __('There must be an active 3rd party plugin or theme breaking our interface. [link]Read more.[/link]', WYSIJA));&nbsp;</div></li><li><div>                        ?&gt;&nbsp;</div></li><li><div>                    &lt;/span&gt;&nbsp;</div></li><li><div>                    &lt;img alt=&quot;loader&quot; id=&quot;ajax-loading&quot; src=&quot;&lt;?php echo WYSIJA_URL ?&gt;img/wpspin_light.gif&quot; /&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>            &lt;!-- END: Wysija Toolbar --&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        global $current_user;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $emailuser = $current_user-&gt;data-&gt;user_email;&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>                &lt;p&gt;&lt;input type=&quot;text&quot; name=&quot;receiver-preview&quot; id=&quot;preview-receiver&quot; value=&quot;&lt;?php echo $emailuser ?&gt;&quot; /&gt; &lt;a href=&quot;javascript:;&quot; id=&quot;wj-send-preview&quot; class=&quot;button wysija&quot;&gt;&lt;?php _e(&quot;Send preview&quot;, WYSIJA) ?&gt;&lt;/a&gt;&lt;/p&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        echo apply_filters('wysija_howspammy', '');&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;p class=&quot;submit&quot;&gt;&nbsp;</div></li><li><div>            &lt;?php $this-&gt;secure(array('action' =&gt; &quot;saveemail&quot;, 'id' =&gt; $data['email']['email_id'])); ?&gt;&nbsp;</div></li><li><div>            &lt;input data-type=&quot;&lt;?php echo (int) $data['email']['type'] ?&gt;&quot; type=&quot;hidden&quot; name=&quot;wysija[email][email_id]&quot; id=&quot;email_id&quot; value=&quot;&lt;?php echo esc_attr($data['email']['email_id']) ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>            &lt;input type=&quot;hidden&quot; value=&quot;saveemail&quot; name=&quot;action&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;a id=&quot;wysija-do-save&quot; class=&quot;button-primary wysija&quot; href=&quot;javascript:;&quot;&gt;&lt;?php _e(&quot;Save changes&quot;, WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>            &lt;a id=&quot;wysija-next-step&quot; class=&quot;button-primary wysija&quot; href=&quot;admin.php?page=wysija_campaigns&action=editDetails&id=&lt;?php echo $data['email']['email_id'] ?&gt;&quot;&gt;&lt;?php _e(&quot;Next step&quot;, WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>            // we cannot have it everywhere&nbsp;</div></li><li><div>            if (false && $data && (int) $data['email']['type'] === 2) {&nbsp;</div></li><li><div>                echo '&lt;a id=&quot;save-reactivate&quot; class=&quot;button-primary wysija&quot; href=&quot;admin.php?page=wysija_campaigns&action=resume&id='.$data['email']['email_id'].'&_wpnonce='.$this-&gt;secure(array('action' =&gt; 'resume' , 'id' =&gt; $data['email'][&quot;email_id&quot;]), true).'&quot;&gt;'.__(&quot;Save and reactivate&quot;, WYSIJA).'&lt;/a&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>            &lt;?php echo '&lt;a href=&quot;admin.php?page=wysija_campaigns&action=edit&id=' . $data['email']['email_id'] . '&quot;&gt;' . __('go back to Step 1', WYSIJA) . '&lt;/a&gt;' ?&gt;&nbsp;</div></li><li><div>        &lt;/p&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;!-- BEGIN: Wysija Toolbar --&gt;&nbsp;</div></li><li><div>        &lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot;&gt;&nbsp;</div></li><li><div>            wysijaAJAX.id = &lt;?php echo (int) $_REQUEST['id'] ?&gt;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function saveWYSIJA(callback) {&nbsp;</div></li><li><div>                wysijaAJAX.task = 'save_editor';&nbsp;</div></li><li><div>                wysijaAJAX._wpnonce = wysijanonces.campaigns.save_editor;&nbsp;</div></li><li><div>                wysijaAJAX.wysijaData = Wysija.save();&nbsp;</div></li><li><div>                WYSIJA_SYNC_AJAX({success: callback});&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // trigger the save on these links/buttons (save, next step, view in browser, unsubscribe)&nbsp;</div></li><li><div>            $$('#wysija-do-save, #wysija-next-step, #wysija_viewbrowser a, #wysija_unsubscribe a').invoke('observe', 'click', function(e) {&nbsp;</div></li><li><div>                if (this.id === 'wysija-next-step') {&nbsp;</div></li><li><div>                    e.preventDefault();&nbsp;</div></li><li><div>                    var id = this.id, &nbsp;</div></li><li><div>                        href = this.href;&nbsp;</div></li><li><div>                    var callback = function () {&nbsp;</div></li><li><div>                        if (id === 'wysija-next-step') window.location.href = href&nbsp;</div></li><li><div>                    };&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                else var callback = function() {};&nbsp;</div></li><li><div>                saveWYSIJA(callback);&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            });&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function switchThemeWYSIJA(event) {&nbsp;</div></li><li><div>                // get event target&nbsp;</div></li><li><div>                var target = (event.currentTarget) ? event.currentTarget : event.srcElement.parentElement;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if(window.confirm(&quot;&lt;?php _e('If you confirm the theme switch, it will override your header, footer, dividers and styles', WYSIJA) ?&gt;&quot;)) {&nbsp;</div></li><li><div>                    wysijaAJAX.task = 'switch_theme';&nbsp;</div></li><li><div>                                        wysijaAJAX._wpnonce = wysijanonces.campaigns.switch_theme;&nbsp;</div></li><li><div>                    wysijaAJAX.wysijaData = Object.toJSON(new Hash({theme: $(target).readAttribute('rel')}));&nbsp;</div></li><li><div>                    wysijaAJAX.popTitle = &quot;Switch theme&quot;;&nbsp;</div></li><li><div>                    WYSIJA_AJAX_POST({&nbsp;</div></li><li><div>                        'success': function(response) {&nbsp;</div></li><li><div>                            // set theme name&nbsp;</div></li><li><div>                            $('wysija_widgets_settings').down('.theme').update(response.responseJSON.result.templates.theme);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            // set css&nbsp;</div></li><li><div>                            if(response.responseJSON.result.styles.css != null) {&nbsp;</div></li><li><div>                                // updateStyles(response.responseJSON.result.styles.css);&nbsp;</div></li><li><div>                                Wysija.updateCSS(response.responseJSON.result.styles.css.strip());&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                                        // update styles form&nbsp;</div></li><li><div>                            if(response.responseJSON.result.styles.form != null) {&nbsp;</div></li><li><div>                                // refresh styles form&nbsp;</div></li><li><div>                                $('wj_styles_form').innerHTML = response.responseJSON.result.styles.form;&nbsp;</div></li><li><div>                                // setup color pickers&nbsp;</div></li><li><div>                                setupColorPickers();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                // setup apply styles on value changed&nbsp;</div></li><li><div>                                setupStylesForm();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                // apply styles&nbsp;</div></li><li><div>                                applyStyles();&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            // set header&nbsp;</div></li><li><div>                            if (response.responseJSON.result.templates.header != undefined) {&nbsp;</div></li><li><div>                                $$('.' + Wysija.options.header)[0].replace(response.responseJSON.result.templates.header);&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                            // set footer&nbsp;</div></li><li><div>                            if (response.responseJSON.result.templates.footer != undefined) {&nbsp;</div></li><li><div>                                $$('.' + Wysija.options.footer)[0].replace(response.responseJSON.result.templates.footer);&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                            // set divider&nbsp;</div></li><li><div>                            if (response.responseJSON.result.templates.divider != undefined) {&nbsp;</div></li><li><div>                                Wysija.setDivider(response.responseJSON.result.templates.divider, response.responseJSON.result.templates.divider_options);&nbsp;</div></li><li><div>                                Wysija.replaceDividers();&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            Wysija.init();&nbsp;</div></li><li><div>                            saveWYSIJA();&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    });&nbsp;</div></li><li><div>                    return false;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    function applyStyles() {&nbsp;</div></li><li><div>                        wysijaAJAX.task = 'save_styles';&nbsp;</div></li><li><div>                                                wysijaAJAX._wpnonce = wysijanonces.campaigns.save_styles;&nbsp;</div></li><li><div>                        wysijaAJAX.wysijaStyles = Object.toJSON($('wj_styles_form').serialize(true));&nbsp;</div></li><li><div>                        wysijaAJAX.popTitle = &quot;Save styles&quot;;&nbsp;</div></li><li><div>                        WYSIJA_AJAX_POST({&nbsp;</div></li><li><div>                            'success': function(response) {&nbsp;</div></li><li><div>                                // remove fixed height for each text block&nbsp;</div></li><li><div>                                $$('.wysija_text').invoke('setStyle', {height: 'auto'});&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                // apply new styles&nbsp;</div></li><li><div>                                Wysija.updateCSS(response.responseJSON.result.styles.strip());&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        });&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        return false;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    function setupStylesForm() {&nbsp;</div></li><li><div>                        $$('#wj_styles_form select, #wj_styles_form input').invoke('observe', 'change', applyStyles);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    function setupColorPickers() {&nbsp;</div></li><li><div>                        jQuery(function($) {&nbsp;</div></li><li><div>                            $('.color').modcoder_excolor({&nbsp;</div></li><li><div>                                hue_bar: 1, &nbsp;</div></li><li><div>                                border_color: '#969696', &nbsp;</div></li><li><div>                                anim_speed: 'fast', &nbsp;</div></li><li><div>                                round_corners: false, &nbsp;</div></li><li><div>                                shadow_size: 2, &nbsp;</div></li><li><div>                                shadow_color: '#f0f0f0', &nbsp;</div></li><li><div>                                background_color: '#ececec', &nbsp;</div></li><li><div>                                backlight: false, &nbsp;</div></li><li><div>                                label_color: '#333333', &nbsp;</div></li><li><div>                                effect: 'fade', &nbsp;</div></li><li><div>                                show_input: false, &nbsp;</div></li><li><div>                                z_index: 20000, &nbsp;</div></li><li><div>                                hide_on_scroll: true, &nbsp;</div></li><li><div>                                callback_on_init: function() {&nbsp;</div></li><li><div>                                    Wysija.locks.selectingColor = true;&nbsp;</div></li><li><div>                                }, &nbsp;</div></li><li><div>                                callback_on_select: function(color, input) {&nbsp;</div></li><li><div>                                    Wysija.updateCSSColor(input, color);&nbsp;</div></li><li><div>                                }, &nbsp;</div></li><li><div>                                callback_on_ok: function(color, color_has_changed) {&nbsp;</div></li><li><div>                                    if (color_has_changed === true) {&nbsp;</div></li><li><div>                                        // apply styles only if the color has changed&nbsp;</div></li><li><div>                                        applyStyles();&nbsp;</div></li><li><div>                                    }&nbsp;</div></li><li><div>                                    // unlock editor&nbsp;</div></li><li><div>                                    Wysija.locks.selectingColor = false;&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>                            });&nbsp;</div></li><li><div>                        });&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    function saveIQS() {&nbsp;</div></li><li><div>                        wysijaAJAX.task = 'save_IQS';&nbsp;</div></li><li><div>                        wysijaAJAX._wpnonce = wysijanonces.campaigns.save_IQS;&nbsp;</div></li><li><div>                        wysijaAJAX.wysijaIMG = Object.toJSON(wysijaIMG);&nbsp;</div></li><li><div>                        WYSIJA_AJAX_POST();&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    // prototype on load&nbsp;</div></li><li><div>                    document.observe('dom:loaded', function() {&nbsp;</div></li><li><div>                        setupStylesForm();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        var konami = new Konami();&nbsp;</div></li><li><div>                        konami.code = function() {&nbsp;</div></li><li><div>                            Wysija.flyToTheMoon();&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        konami.load();&nbsp;</div></li><li><div>                    });&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    // jquery on load&nbsp;</div></li><li><div>                    jQuery(function($) {&nbsp;</div></li><li><div>                        $(function() {&nbsp;</div></li><li><div>                            setupColorPickers();&nbsp;</div></li><li><div>                        });&nbsp;</div></li><li><div>                    });&nbsp;</div></li><li><div>                &lt;/script&gt;&nbsp;</div></li><li><div>                &lt;!-- END: Wysija Toolbar --&gt;&nbsp;</div></li><li><div>                &lt;div id=&quot;wysija-konami&quot; &gt;&nbsp;</div></li><li><div>                    &lt;div id=&quot;wysija-konami-overlay&quot; style=&quot;display:none;width:100%; height:100%; position:fixed;top:0;left:0;background-color:#fff;z-index:99998;overflow:hidden;&quot;&gt;&nbsp;</div></li><li><div>                        &lt;img id=&quot;wysija-konami-bird&quot; src=&quot;&lt;?php echo WYSIJA_URL ?&gt;img/wysija_bird.jpg&quot; style=&quot;display:none;z-index:99999;position:absolute;top:100px;left:100px;&quot; width=&quot;597&quot; height=&quot;483&quot; /&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;div id=&quot;wysija-divider&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            /** when newsletter has been sent let's see the feedback */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function editDetails($data = false) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $this-&gt;data = $data;&nbsp;</div></li><li><div>                $step = array();&nbsp;</div></li><li><div>                $step['subject'] = array(&nbsp;</div></li><li><div>                    'type' =&gt; 'subject', &nbsp;</div></li><li><div>                    'label' =&gt; __('Subject line', WYSIJA), &nbsp;</div></li><li><div>                    'class' =&gt; 'validate[required]', &nbsp;</div></li><li><div>                    'desc' =&gt; __(&quot;Be creative! It's the first thing your subscribers see. Tempt them to open your email.&quot;, WYSIJA));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ((int) $data['email']['type'] === 2) {&nbsp;</div></li><li><div>                    $step['params'] = array(&nbsp;</div></li><li><div>                        'type' =&gt; 'frequencies', &nbsp;</div></li><li><div>                        'label' =&gt; __('When...', WYSIJA), 'class' =&gt; 'validate[required]', &nbsp;</div></li><li><div>                        'desc' =&gt; '', &nbsp;</div></li><li><div>                        'labeloff' =&gt; 1, &nbsp;</div></li><li><div>                        'rowclass' =&gt; 'automatic-nl');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $step['type'] = array(&nbsp;</div></li><li><div>                        'type' =&gt; 'type_nl', &nbsp;</div></li><li><div>                        'class' =&gt; 'validate[required]', &nbsp;</div></li><li><div>                        'labeloff' =&gt; 1, &nbsp;</div></li><li><div>                        'label' =&gt; __('What type of newsletter is this?', WYSIJA), &nbsp;</div></li><li><div>                        'rowclass' =&gt; 'hidden');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if (isset($data['email'][&quot;params&quot;]['autonl']['event']) && $data['email'][&quot;params&quot;]['autonl']['event'] == 'new-articles') {&nbsp;</div></li><li><div>                        $step['subject']['desc'] = str_replace(array('[newsletter:number]', '[newsletter:total]', '[newsletter:post_title]'), array('&lt;b&gt;[newsletter:number]&lt;/b&gt;', '&lt;b&gt;[newsletter:total]&lt;/b&gt;', '&lt;b&gt;[newsletter:post_title]&lt;/b&gt;'), __('Insert [newsletter:total] to show number of posts, [newsletter:post_title] to show the latest post\'s title & [newsletter:number] to display the issue number.', WYSIJA));&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ($this-&gt;data['lists']) {&nbsp;</div></li><li><div>                    $step['lists'] = array(&nbsp;</div></li><li><div>                        'type' =&gt; 'lists', &nbsp;</div></li><li><div>                        'class' =&gt; 'validate[minCheckbox[1]] checkbox', &nbsp;</div></li><li><div>                        'label' =&gt; __('Lists', WYSIJA), &nbsp;</div></li><li><div>                        'labeloff' =&gt; 1, &nbsp;</div></li><li><div>                        'rowclass' =&gt; 'listcheckboxes', &nbsp;</div></li><li><div>                        'desc' =&gt; __('The subscriber list that will be used for this campaign.', WYSIJA));&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $step['from_name'] = array(&nbsp;</div></li><li><div>                    'type' =&gt; 'fromname', &nbsp;</div></li><li><div>                    'class' =&gt; 'validate[required]', &nbsp;</div></li><li><div>                    'label' =&gt; __('Sender', WYSIJA), &nbsp;</div></li><li><div>                    'desc' =&gt; __('Name & email of yourself or your company.', WYSIJA));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $step['replyto_name'] = array(&nbsp;</div></li><li><div>                    'type' =&gt; 'fromname', &nbsp;</div></li><li><div>                    'class' =&gt; 'validate[required]', &nbsp;</div></li><li><div>                    'label' =&gt; __('Reply-to name & email', WYSIJA), &nbsp;</div></li><li><div>                    'desc' =&gt; __('When the subscribers hit &quot;reply&quot; this is who will receive their email.', WYSIJA));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $step = apply_filters('wysija_extend_step3', $step);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                //we schedule only the type 1 newsletter&nbsp;</div></li><li><div>                if ($data['email']['type'] == 1) {&nbsp;</div></li><li><div>                    $step['scheduleit'] = array(&nbsp;</div></li><li><div>                        'type' =&gt; 'scheduleit', &nbsp;</div></li><li><div>                        'class' =&gt; '', &nbsp;</div></li><li><div>                        'label' =&gt; __('Schedule it', WYSIJA), &nbsp;</div></li><li><div>                        'desc' =&gt; '');&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ((int) $data['email']['sent_at'] === 0 && isset($data['autoresponder'])) {&nbsp;</div></li><li><div>                    $step['ignore_subscribers'] = array(&nbsp;</div></li><li><div>                        'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                        'class' =&gt; '', &nbsp;</div></li><li><div>                        'label' =&gt; __('Ignore current subscribers', WYSIJA), &nbsp;</div></li><li><div>                        'desc' =&gt; __('Don\'t send to existing subscribers, only to future ones.', WYSIJA));&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                &lt;form name=&quot;step3&quot; method=&quot;post&quot; id=&quot;campaignstep3&quot; action=&quot;&quot; class=&quot;form-valid&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;table class=&quot;form-table&quot;&gt;&nbsp;</div></li><li><div>                        &lt;tbody&gt;&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                        echo $this-&gt;buildMyForm($step, $data, &quot;email&quot;);&nbsp;</div></li><li><div>                        ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;/tbody&gt;&nbsp;</div></li><li><div>                    &lt;/table&gt;&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                        global $current_user;&nbsp;</div></li><li><div>                        $emailuser = $current_user-&gt;data-&gt;user_email;&nbsp;</div></li><li><div>                        ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;p&gt;&lt;input type=&quot;text&quot; name=&quot;receiver-preview&quot; id=&quot;preview-receiver&quot; value=&quot;&lt;?php echo $emailuser ?&gt;&quot; /&gt; &lt;a href=&quot;javascript:;&quot; id=&quot;wj-send-preview&quot; class=&quot;button wysija&quot;&gt;&lt;?php _e(&quot;Send preview&quot;, WYSIJA) ?&gt;&lt;/a&gt;&lt;/p&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;p class=&quot;submit&quot;&gt;&nbsp;</div></li><li><div>        &lt;?php $this-&gt;secure(array('action' =&gt; &quot;savelast&quot;, 'id' =&gt; $_REQUEST['id'])); ?&gt;&nbsp;</div></li><li><div>                        &lt;input type=&quot;hidden&quot; name=&quot;wysija[email][email_id]&quot; id=&quot;email_id&quot; value=&quot;&lt;?php echo esc_attr($data['email']['email_id']) ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                        &lt;input type=&quot;hidden&quot; name=&quot;wysija[campaign][campaign_id]&quot; id=&quot;campaign_id&quot; value=&quot;&lt;?php echo esc_attr($data['email']['campaign_id']) ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                        &lt;input type=&quot;hidden&quot; value=&quot;savelast&quot; name=&quot;action&quot;  /&gt;&nbsp;</div></li><li><div>                        &lt;input type=&quot;hidden&quot; value=&quot;&quot; name=&quot;wj_redir&quot; id=&quot;hid-redir&quot; /&gt;&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                        if ((int) $this-&gt;data['email']['type'] == 2) {&nbsp;</div></li><li><div>                            $sendNow = esc_attr(__('Activate now', WYSIJA));&nbsp;</div></li><li><div>                            $saveresumesend = esc_attr(__('Activate now', WYSIJA));&nbsp;</div></li><li><div>                            $buttonsave = esc_attr(__('Save as draft and close', WYSIJA));&nbsp;</div></li><li><div>                            $buttonsendlater = $buttonsave;&nbsp;</div></li><li><div>                        } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            $sendNow = esc_attr(__('Send', WYSIJA));&nbsp;</div></li><li><div>                            $saveresumesend = esc_attr(__('Send', WYSIJA));&nbsp;</div></li><li><div>                            $buttonsave = esc_attr(__('Save & close', WYSIJA));&nbsp;</div></li><li><div>                            $buttonsendlater = esc_attr(__('Save as draft and close', WYSIJA));&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        if (in_array((int) $this-&gt;data['email']['status'], array(0, 4))) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            if ($this-&gt;data['lists']) {&nbsp;</div></li><li><div>                                ?&gt;&nbsp;</div></li><li><div>                                &lt;input type=&quot;submit&quot; value=&quot;&lt;?php echo $sendNow ?&gt;&quot; id=&quot;submit-send&quot; name=&quot;submit-send&quot; class=&quot;button-primary wysija&quot;/&gt;&nbsp;</div></li><li><div>                        &lt;?php }&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                            &lt;input type=&quot;submit&quot; value=&quot;&lt;?php echo $buttonsendlater ?&gt;&quot; id=&quot;submit-draft&quot; name=&quot;submit-draft&quot; class=&quot;button wysija&quot;/&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            &lt;input type=&quot;submit&quot; value=&quot;&lt;?php echo $saveresumesend ?&gt;&quot; id=&quot;submit-send&quot; name=&quot;submit-resume&quot; class=&quot;button-primary wysija&quot;/&gt;&nbsp;</div></li><li><div>                            &lt;input type=&quot;submit&quot; value=&quot;&lt;?php echo $buttonsave ?&gt;&quot; id=&quot;submit-draft&quot; name=&quot;submit-pause&quot; class=&quot;button wysija&quot;/&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                echo str_replace(&nbsp;</div></li><li><div>                        array('[link]', '[/link]'), array('&lt;a href=&quot;admin.php?page=wysija_campaigns&action=editTemplate&id=' . $data['email']['email_id'] . '&quot; id=&quot;link-back-step2&quot;&gt;', '&lt;/a&gt;'), __(&quot;or simply [link]go back to design[/link].&quot;, WYSIJA)&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                echo $this-&gt;immediatewarning;&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                    &lt;/p&gt;&nbsp;</div></li><li><div>                &lt;/form&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function fieldFormHTML_subject($key, $val, $model, $params) {&nbsp;</div></li><li><div>                $fieldHTML = '';&nbsp;</div></li><li><div>                $field = $key;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $formObj = WYSIJA::get(&quot;forms&quot;, &quot;helper&quot;);&nbsp;</div></li><li><div>                $fieldHTML = '&lt;div id=&quot;titlediv&quot;&gt;&nbsp;</div></li><li><div>            &lt;div id=&quot;titlewrap&quot; style=&quot;width:70%;&quot;&gt;&nbsp;</div></li><li><div>                    &lt;input class=&quot;titlebox ' . $params['class'] . '&quot; id=&quot;' . $key . '&quot; name=&quot;wysija[email][subject]&quot; size=&quot;30&quot; type=&quot;text&quot; autocomplete=&quot;off&quot; value=&quot;' . esc_attr($val) . '&quot; /&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                return $fieldHTML;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function fieldFormHTML_frequencies($key, $val, $model, $params) {&nbsp;</div></li><li><div>                $fieldHTML = '&lt;div class=&quot;frequencies&quot;&gt;';&nbsp;</div></li><li><div>                $field = $key;&nbsp;</div></li><li><div>                $id = $key;&nbsp;</div></li><li><div>                if (!$val) {&nbsp;</div></li><li><div>                    $val = array(&nbsp;</div></li><li><div>                        'autonl' =&gt;&nbsp;</div></li><li><div>                        array(&nbsp;</div></li><li><div>                            'event' =&gt; 'new-articles', &nbsp;</div></li><li><div>                            'day' =&gt; 'monday', &nbsp;</div></li><li><div>                            'time' =&gt; '00:00:00', &nbsp;</div></li><li><div>                            'when-article' =&gt; 'daily', &nbsp;</div></li><li><div>                            'when-subscribe' =&gt; 'daily', &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                } elseif (is_string($val)) {&nbsp;</div></li><li><div>                    $val = unserialize(base64_decode($val));&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if (!isset($val['autonl'])) {&nbsp;</div></li><li><div>                    $val = array(&nbsp;</div></li><li><div>                        'autonl' =&gt;&nbsp;</div></li><li><div>                        array(&nbsp;</div></li><li><div>                            'event' =&gt; 'new-articles', &nbsp;</div></li><li><div>                            'day' =&gt; 'monday', &nbsp;</div></li><li><div>                            'time' =&gt; '00:00:00', &nbsp;</div></li><li><div>                            'when-article' =&gt; 'daily', &nbsp;</div></li><li><div>                            'when-subscribe' =&gt; 'daily', &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $formsHelp = WYSIJA::get('forms', 'helper');&nbsp;</div></li><li><div>                foreach ($this-&gt;data['autonl']['fields'] as $fieldK =&gt; $field) {&nbsp;</div></li><li><div>                    $myval = '';&nbsp;</div></li><li><div>                    $singleFieldHtml = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    //dbg($field, 0);&nbsp;</div></li><li><div>                    if (isset($field['extend'])) {&nbsp;</div></li><li><div>                        $field = $this-&gt;data['autonl']['fields'][$field['extend']];&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (isset($val['autonl'][$fieldK]))&nbsp;</div></li><li><div>                        $myval = $val['autonl'][$fieldK];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $classDDP = '';&nbsp;</div></li><li><div>                    if (isset($field['class']))&nbsp;</div></li><li><div>                        $classDDP = $field['class'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $dataArray = array('name' =&gt; 'wysija[email][params][autonl][' . $fieldK . ']', 'id' =&gt; $id . '-' . $fieldK, 'class' =&gt; $classDDP);&nbsp;</div></li><li><div>                    if (isset($field['style'])) {&nbsp;</div></li><li><div>                        $dataArray['style'] = $field['style'];&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $arrayFields = array('event');&nbsp;</div></li><li><div>                    if (!in_array($fieldK, $arrayFields))&nbsp;</div></li><li><div>                        $classDDP.='sub-event';&nbsp;</div></li><li><div>                    $arrayFields[] = 'when-article';&nbsp;</div></li><li><div>                    if (!in_array($fieldK, $arrayFields))&nbsp;</div></li><li><div>                        $classDDP.=' sub-when-article';&nbsp;</div></li><li><div>                    $dataArray['class'] = $classDDP;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    //by default we return a dropdown&nbsp;</div></li><li><div>                    if (!isset($field['type'])) {&nbsp;</div></li><li><div>                        $singleFieldHtml.=$formsHelp-&gt;dropdown(&nbsp;</div></li><li><div>                                $dataArray, $field['values'], $myval);&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $typee = $field['type'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        if ($typee == 'checkbox') {&nbsp;</div></li><li><div>                            $singleFieldHtml.=$formsHelp-&gt;$typee($dataArray, '', $myval);&nbsp;</div></li><li><div>                        } else {&nbsp;</div></li><li><div>                            $singleFieldHtml.=$formsHelp-&gt;$typee($dataArray, $myval);&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if (isset($field['label_before']) || isset($field['label_after'])) {&nbsp;</div></li><li><div>                        $before = $after = '';&nbsp;</div></li><li><div>                        if (isset($field['label_before']))&nbsp;</div></li><li><div>                            $before = $field['label_before'];&nbsp;</div></li><li><div>                        if (isset($field['label_after']))&nbsp;</div></li><li><div>                            $after = $field['label_after'];&nbsp;</div></li><li><div>                        $singleFieldHtml = '&lt;label id=&quot;' . $id . '-label-' . $fieldK . '&quot; for=&quot;' . $id . '-' . $fieldK . '&quot; class=&quot;' . $classDDP . '&quot;&gt;' . $before . $singleFieldHtml . $after . '&lt;/label&gt;';&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $fieldHTML.=$singleFieldHtml;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $fieldHTML .= '&lt;/div&gt;';&nbsp;</div></li><li><div>                return $fieldHTML;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function local_time_is() {&nbsp;</div></li><li><div>                $helper_toolbox = WYSIJA::get('toolbox', 'helper');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                return '&lt;span class=&quot;local_time&quot;&gt;' . sprintf(__('Local time is &lt;code&gt;%1$s&lt;/code&gt;'), $helper_toolbox-&gt;site_current_time()) . '&lt;/span&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function fieldFormHTML_type_nl($key, $val, $model, $params) {&nbsp;</div></li><li><div>                $fieldHTML = '&lt;div class=&quot;list-radios&quot;&gt;';&nbsp;</div></li><li><div>                $field = $key;&nbsp;</div></li><li><div>                $valuefield = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $typesnl = array(&nbsp;</div></li><li><div>                    '1' =&gt; array(&nbsp;</div></li><li><div>                        'type' =&gt; 'standard', &nbsp;</div></li><li><div>                        'label' =&gt; __('Standard newsletter', WYSIJA), &nbsp;</div></li><li><div>                        'default' =&gt; 1&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    '2' =&gt; array(&nbsp;</div></li><li><div>                        'type' =&gt; 'automatic', &nbsp;</div></li><li><div>                        'label' =&gt; __('Automatic newsletter', WYSIJA), &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                foreach ($typesnl as $typenl =&gt; $paramstnl) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $checked = '';&nbsp;</div></li><li><div>                    if (($val && (int) $val == (int) $typenl) || (!$val && isset($paramstnl['default']))) {&nbsp;</div></li><li><div>                        $checked = ' checked=&quot;checked&quot; ';&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $fieldHTML.='&lt;label for=&quot;nl_type_' . $paramstnl['type'] . '&quot;&gt;' .&nbsp;</div></li><li><div>                            '&lt;input class=&quot;radiotype-nl&quot; id=&quot;nl_type_' . $paramstnl['type'] . '&quot; type=&quot;radio&quot; name=&quot;wysija[email][type]&quot; value=&quot;' . $typenl . '&quot; ' . $checked . ' /&gt;'&nbsp;</div></li><li><div>                            . $paramstnl['label'] . '&lt;/label&gt;';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $fieldHTML.='&lt;/div&gt;';&nbsp;</div></li><li><div>                return $fieldHTML;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function fieldFormHTML_lists($key, $val, $model, $params) {&nbsp;</div></li><li><div>                $fieldHTML = '&lt;div class=&quot;list-checkbox&quot;&gt;';&nbsp;</div></li><li><div>                $field = $key;&nbsp;</div></li><li><div>                $valuefield = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if (isset($this-&gt;data['campaign_list']) && $this-&gt;data['campaign_list']) {&nbsp;</div></li><li><div>                    foreach ($this-&gt;data['campaign_list'] as $list) {&nbsp;</div></li><li><div>                        $valuefield[$list['list_id']] = $list;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $formObj = WYSIJA::get(&quot;forms&quot;, &quot;helper&quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                usort( $this-&gt;data['lists'], array('WYSIJA_view_back_campaigns', 'sort_by_name' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                foreach ($this-&gt;data['lists'] as $list) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $checked = false;&nbsp;</div></li><li><div>                    if (isset($valuefield[$list['list_id']]))&nbsp;</div></li><li><div>                        $checked = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $fieldHTML.= '&lt;p&gt;&lt;label for=&quot;' . $field . $list['list_id'] . '&quot;&gt;';&nbsp;</div></li><li><div>                    $fieldHTML.=$formObj-&gt;checkbox(array('class' =&gt; $params['class'] . ' checklists', 'alt' =&gt; $list['name'], 'id' =&gt; $field . $list['list_id'], 'name' =&gt; &quot;wysija[campaign_list][list_id][]&quot;), $list['list_id'], $checked) . $list['name'] . ' (' . $list['count'] . ')';&nbsp;</div></li><li><div>                    $fieldHTML.='&lt;input type=&quot;hidden&quot; id=&quot;' . $field . $list['list_id'] . 'count&quot; value=&quot;' . $list['count'] . '&quot; /&gt;';&nbsp;</div></li><li><div>                    $fieldHTML.='&lt;/label&gt;&lt;/p&gt;';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $fieldHTML.=&quot;&lt;/div&gt;&quot;;&nbsp;</div></li><li><div>                return $fieldHTML;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function fieldFormHTML_scheduleit($key, $val, $model, $params) {&nbsp;</div></li><li><div>                $formObj = WYSIJA::get('forms', 'helper');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $valuescheduled = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if (isset($this-&gt;data['email']['params']['schedule']['isscheduled']))&nbsp;</div></li><li><div>                    $valuescheduled = $this-&gt;data['email']['params']['schedule']['isscheduled'];&nbsp;</div></li><li><div>                $data = $formObj-&gt;checkbox(array('class' =&gt; $params['class'], 'id' =&gt; $key, 'name' =&gt; 'wysija[email][params][schedule][isscheduled]'), true, $valuescheduled);&nbsp;</div></li><li><div>                $data .= $this-&gt;fieldFormHTML_datepicker('datepicker', $val, $model, $params);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                return $data;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            /**&nbsp;</div></li><li><div>             * @todo: move to top super class or heler&nbsp;</div></li><li><div>             */&nbsp;</div></li><li><div>            function fieldFormHTML_datepicker($key, $val, $model, $params) {&nbsp;</div></li><li><div>                if ((int) $this-&gt;data['email']['type'] == 2)&nbsp;</div></li><li><div>                    return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $fieldHTML = '&lt;span id=&quot;schedule-area&quot; class=&quot;schedule-row&quot; &gt;';&nbsp;</div></li><li><div>                $field = $key;&nbsp;</div></li><li><div>                $valuefield = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $formObj = WYSIJA::get(&quot;forms&quot;, &quot;helper&quot;);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $valuescheduled = $valuetime = '';&nbsp;</div></li><li><div>                $valueday = date(&quot;Y/m/d&quot;);&nbsp;</div></li><li><div>                if (isset($this-&gt;data['email']['params']['schedule']['day'])) {&nbsp;</div></li><li><div>                    $valueday = $this-&gt;data['email']['params']['schedule']['day'];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if (isset($this-&gt;data['email']['params']['schedule']['time'])) {&nbsp;</div></li><li><div>                    $valuetime = $this-&gt;data['email']['params']['schedule']['time'];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if (isset($this-&gt;data['email']['params']['schedule']['isscheduled'])) {&nbsp;</div></li><li><div>                    $valuescheduled = $this-&gt;data['email']['params']['schedule']['isscheduled'];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $fieldHTML.=$formObj-&gt;input(array('class' =&gt; $params['class'], 'id' =&gt; $field . '-day', 'name' =&gt; &quot;wysija[email][params][schedule][day]&quot;, 'size' =&gt; 8), $valueday);&nbsp;</div></li><li><div>                $fieldHTML.=' @ ';&nbsp;</div></li><li><div>                $fieldHTML.=$formObj-&gt;dropdown(&nbsp;</div></li><li><div>                    array(&nbsp;</div></li><li><div>                        'name' =&gt; 'wysija[email][params][schedule][time]', &nbsp;</div></li><li><div>                        'id' =&gt; $field.'-time'&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                    $this-&gt;data['autonl']['fields']['time']['values'], &nbsp;</div></li><li><div>                    $valuetime&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $fieldHTML .= $this-&gt;local_time_is();&nbsp;</div></li><li><div>                $fieldHTML.='&lt;/span&gt;';&nbsp;</div></li><li><div>                return $fieldHTML;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function edit($data) {&nbsp;</div></li><li><div>                //$this-&gt;menuTop(&quot;edit&quot;);&nbsp;</div></li><li><div>                $formid = 'wysija-' . $_REQUEST['action'];&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                &lt;div id=&quot;wysistats&quot;&gt;&nbsp;</div></li><li><div>                    &lt;div id=&quot;wysistats1&quot; class=&quot;left&quot;&gt;&nbsp;</div></li><li><div>                        &lt;div id=&quot;statscontainer&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                        &lt;h3&gt;&lt;?php _e(sprintf('%1$s emails received.', $data['user']['emails']), WYSIJA) ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;div id=&quot;wysistats2&quot; class=&quot;left&quot;&gt;&nbsp;</div></li><li><div>                        &lt;ul&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                foreach ($data['charts']['stats'] as $stats) {&nbsp;</div></li><li><div>                    echo &quot;&lt;li&gt;&quot; . $stats['name'] . &quot;: &quot; . $stats['number'] . &quot;&lt;/li&gt;&quot;;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                echo &quot;&lt;li&gt;&quot; . __('Added', WYSIJA) . &quot;:&quot; . $this-&gt;fieldListHTML_created_at($data['user']['details'][&quot;created_at&quot;]) . &quot;&lt;/li&gt;&quot;;&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;/ul&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;div id=&quot;wysistats3&quot; class=&quot;left&quot;&gt;&nbsp;</div></li><li><div>                        &lt;p class=&quot;title&quot;&gt;&lt;?php echo __(sprintf('Total of %1$d clicks:', count($data['clicks'])), WYSIJA); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                        &lt;ol&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        foreach ($data['clicks'] as $click) {&nbsp;</div></li><li><div>            echo &quot;&lt;li&gt;&quot; . $click['name'] . &quot; : &quot; . $click['url'] . &quot;&lt;/li&gt;&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;/ol&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        $this-&gt;buttonsave = __('Save', WYSIJA);&nbsp;</div></li><li><div>        $this-&gt;add($data);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function popup_image_data($data) {&nbsp;</div></li><li><div>        echo $this-&gt;messages(true);&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>                &lt;div class=&quot;popup_content addlink&quot;&gt;&nbsp;</div></li><li><div>                    &lt;form method=&quot;post&quot; action=&quot;&quot; class=&quot;image-data-form&quot; id=&quot;image-data-form&quot;&gt;&nbsp;</div></li><li><div>                        &lt;p&gt;&nbsp;</div></li><li><div>                            &lt;label for=&quot;url&quot;&gt;&lt;?php _e('Address:', WYSIJA) ?&gt;&lt;/label&gt;&lt;br/&gt;&nbsp;</div></li><li><div>                            &lt;input type=&quot;text&quot; name=&quot;url&quot; value=&quot;&lt;?php echo (!empty($data['url'])) ? esc_attr($data['url']) : 'http://' ?&gt;&quot; id=&quot;url&quot; /&gt;&nbsp;</div></li><li><div>                        &lt;/p&gt;&nbsp;</div></li><li><div>                        &lt;p&gt;&nbsp;</div></li><li><div>                            &lt;label for=&quot;alt&quot;&gt;&lt;?php _e('Alternative text:', WYSIJA) ?&gt;&lt;/label&gt;&lt;br/&gt;&nbsp;</div></li><li><div>                            &lt;input type=&quot;text&quot; name=&quot;alt&quot; value=&quot;&lt;?php echo (!empty($data['alt'])) ? esc_attr($data['alt']) : '' ?&gt;&quot; id=&quot;alt&quot; /&gt;&nbsp;</div></li><li><div>                        &lt;/p&gt;&nbsp;</div></li><li><div>                        &lt;p class=&quot;notice&quot;&gt;&lt;?php _e('This text is displayed when email clients block images, which is most of the time.', WYSIJA) ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                        &lt;p class=&quot;submit_button&quot;&gt;&lt;input id=&quot;image-data-submit&quot; class=&quot;button-primary&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;&lt;?php _e('Save', WYSIJA) ?&gt;&quot; /&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                    &lt;/form&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function popup_themes($errors) {&nbsp;</div></li><li><div>        echo $this-&gt;messages(true);&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;div id=&quot;overlay&quot;&gt;&lt;img id=&quot;loader&quot; src=&quot;&lt;?php echo WYSIJA_URL ?&gt;img/wpspin_light.gif&quot; /&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;popup_content themes&quot;&gt;&nbsp;</div></li><li><div>            &lt;form enctype=&quot;multipart/form-data&quot; method=&quot;post&quot; action=&quot;&quot; class=&quot;validate&quot;&gt;&nbsp;</div></li><li><div>                &lt;div id=&quot;search-view&quot; class=&quot;panel&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    if (isset($_REQUEST['reload']) && (int) $_REQUEST['reload'] === 1) {&nbsp;</div></li><li><div>                        echo '&lt;input type=&quot;hidden&quot; id=&quot;themes-reload&quot; name=&quot;themes-reload&quot; value=&quot;1&quot; /&gt;';&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                    &lt;div class=&quot;clearfix&quot;&gt;&nbsp;</div></li><li><div>                        &lt;input type=&quot;button&quot; id=&quot;sub-theme-box&quot; name=&quot;submit&quot; value=&quot;&lt;?php echo esc_attr(__('Upload Theme (.zip)', WYSIJA)); ?&gt;&quot; class=&quot;button-secondary&quot;/&gt;&nbsp;</div></li><li><div>                        &lt;span id=&quot;filter-selection&quot;&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                        &nbsp;&nbsp;&nbsp;</div></li><li><div>                        &lt;span&gt;&lt;?php echo str_replace(array('[link]', '[/link]'), array('&lt;a href=&quot;http://support.mailpoet.com/knowledgebase/guide-to-creating-your-own-mailpoet-theme?utm_source=wpadmin&utm_campaign=theme%20guide&quot; target=&quot;_blank&quot;&gt;', '&lt;/a&gt;'), __('[link]Guide[/link] to create your own theme.', WYSIJA)); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                        &lt;div id=&quot;wj_paginator&quot;&gt;&nbsp;</div></li><li><div>                            &lt;a class=&quot;selected&quot; href=&quot;javascript:;&quot; data-type=&quot;free&quot;&gt;&lt;?php _e('Free', WYSIJA); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                            &lt;a href=&quot;javascript:;&quot; data-type=&quot;premium&quot;&gt;&lt;?php _e('Premium', WYSIJA); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;ul id=&quot;themes-list&quot;&gt;&lt;/ul&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;div id=&quot;theme-view&quot; class=&quot;panel&quot; style=&quot;display:none;&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>            &lt;/form&gt;&nbsp;</div></li><li><div>            &lt;div id=&quot;theme-upload&quot; class=&quot;panel&quot;&gt;&nbsp;</div></li><li><div>                &lt;form enctype=&quot;multipart/form-data&quot; method=&quot;post&quot; action=&quot;&quot; class=&quot;validate&quot;&gt;&nbsp;</div></li><li><div>                    &lt;div class=&quot;wrap actions&quot;&gt;&nbsp;</div></li><li><div>                        &lt;a class=&quot;button-secondary2 theme-view-back&quot; href=&quot;javascript:;&quot;&gt;&lt;?php echo __(&quot;&lt;&lt; Back&quot;, WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;div class=&quot;form&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    $secure = array('action' =&gt; &quot;themeupload&quot;);&nbsp;</div></li><li><div>                    $this-&gt;secure($secure);&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                    &lt;p&gt;&lt;input type=&quot;file&quot; name=&quot;my-theme&quot;/&gt;( &lt;?php&nbsp;</div></li><li><div>                    $helperNumbers = WYSIJA::get('numbers', 'helper');&nbsp;</div></li><li><div>                    $data = $helperNumbers-&gt;get_max_file_upload();&nbsp;</div></li><li><div>                    $bytes = $data['maxmegas'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            echo sprintf(__('total max upload file size : %1$s', WYSIJA), $bytes); ?&gt; )&lt;/p&gt;&nbsp;</div></li><li><div>                &lt;p&gt;&lt;label for=&quot;overwrite&quot;&gt;&lt;input type=&quot;checkbox&quot; id=&quot;overwrite&quot; name=&quot;overwriteexistingtheme&quot; /&gt;&lt;?php echo __(&quot;If a theme with the same name exists, overwrite it.&quot;, WYSIJA); ?&gt;&lt;/label&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                &lt;p&gt;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;themeupload&quot; /&gt;&nbsp;</div></li><li><div>                    &lt;input type=&quot;submit&quot; class=&quot;button-primary&quot; name=&quot;submitter&quot; value=&quot;&lt;?php _e(&quot;Upload&quot;, WYSIJA) ?&gt;&quot; /&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>            &lt;/form&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function test_bounce() {&nbsp;</div></li><li><div>        exit;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function themeupload() {&nbsp;</div></li><li><div>        $this-&gt;popup_themes(false);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function popup_articles($data = array(), $errors = array()) {&nbsp;</div></li><li><div>        // get articles helper&nbsp;</div></li><li><div>        $helper_articles = WYSIJA::get('articles', 'helper');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo $this-&gt;messages(true);&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;popup_content inline_form articles&quot;&gt;&nbsp;</div></li><li><div>            &lt;form enctype=&quot;multipart/form-data&quot; method=&quot;post&quot; action=&quot;&quot; id=&quot;articles-form&quot;&gt;&nbsp;</div></li><li><div>                &lt;div id=&quot;basic&quot;&gt;&nbsp;</div></li><li><div>                    &lt;div class=&quot;clearfix&quot;&gt;&nbsp;</div></li><li><div>                        &lt;div class=&quot;filters-box&quot;&gt;&nbsp;</div></li><li><div>                            &lt;?php&nbsp;</div></li><li><div>                            echo $helper_articles-&gt;field_select_post_type(array('value' =&gt; $data['params']['post_type'], 'label' =&gt; __('Filter by type', WYSIJA)));&nbsp;</div></li><li><div>                            echo $helper_articles-&gt;field_select_terms();&nbsp;</div></li><li><div>                            echo $helper_articles-&gt;field_select_status();&nbsp;</div></li><li><div>                            ?&gt;&nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>                        &lt;div class=&quot;search-box&quot;&gt;&nbsp;</div></li><li><div>                            &lt;input type=&quot;text&quot; id=&quot;search&quot; name=&quot;search&quot; autocomplete=&quot;off&quot; /&gt;&nbsp;</div></li><li><div>                            &lt;input type=&quot;submit&quot; id=&quot;search-submit&quot; name=&quot;submit&quot; value=&quot;&lt;?php _e('Search', WYSIJA); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;div id=&quot;results&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;div id=&quot;advanced&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php echo $this-&gt;_post_display_options($data); ?&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;div class=&quot;submit-box&quot;&gt;&nbsp;</div></li><li><div>                    &lt;div id=&quot;loading-icon&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;div id=&quot;loading-message&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;a id=&quot;toggle-advanced&quot; href=&quot;javascript:;&quot;&gt;&lt;?php _e('Display and insert options', WYSIJA); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                    &lt;input id=&quot;insert-selection&quot; class=&quot;button-primary&quot; type=&quot;submit&quot; name=&quot;insert&quot; value=&quot;&lt;?php _e('Insert selected', WYSIJA); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                    &lt;input id=&quot;back-selection&quot; class=&quot;button-secondary&quot; type=&quot;button&quot; value=&quot;&lt;?php _e('Back to selection', WYSIJA); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>            &lt;/form&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private function _post_display_options($data) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // display option: excerpt / full post / title only&nbsp;</div></li><li><div>        $knowledgebase_url = str_replace(&nbsp;</div></li><li><div>            array('[link]', '[/link]'), &nbsp;</div></li><li><div>            array('&lt;a href=&quot;http://support.mailpoet.com/knowledgebase/excerpts-in-wysija/?utm_source=wpadmin&utm_campaign=editor&quot; target=&quot;_blank&quot;&gt;', '&lt;/a&gt;'), &nbsp;</div></li><li><div>            __('Which excerpt does it use? [link]Read more[/link]', WYSIJA)&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output .= '&lt;div class=&quot;block clearfix&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label&gt;'.__('Display...', WYSIJA);&nbsp;</div></li><li><div>        $output .= '        &lt;span class=&quot;label&quot;&gt;'.$knowledgebase_url.'&lt;/span&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;post_content&quot; value=&quot;excerpt&quot; '.(($data['params']['post_content'] === 'excerpt') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('excerpt', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;post_content&quot; value=&quot;full&quot; '.(($data['params']['post_content'] === 'full') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('full post', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;post_content&quot; value=&quot;title&quot; '.(($data['params']['post_content'] === 'title') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('title only', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // title format&nbsp;</div></li><li><div>        $output .= '&lt;div class=&quot;block clearfix alternate&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label&gt;'.__('Title format', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;title_tag&quot; value=&quot;h1&quot; '.(($data['params']['title_tag'] === 'h1') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('heading 1', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;title_tag&quot; value=&quot;h2&quot; '.(($data['params']['title_tag'] === 'h2') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('heading 2', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;title_tag&quot; value=&quot;h3&quot; '.(($data['params']['title_tag'] === 'h3') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('heading 3', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label id=&quot;title_tag_list&quot; class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;title_tag&quot; value=&quot;list&quot; '.(($data['params']['title_tag'] === 'list') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('show as list', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // title position&nbsp;</div></li><li><div>        $output .= '&lt;div id=&quot;title_position_block&quot; class=&quot;block clearfix&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label&gt;'.__('Title position', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;title_position&quot; value=&quot;inside&quot; '.(($data['params']['title_position'] === 'inside') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('in text block', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;title_position&quot; value=&quot;outside&quot; '.(($data['params']['title_position'] === 'outside') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('above text block and image', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // title alignment&nbsp;</div></li><li><div>        $output .= '&lt;div class=&quot;block clearfix alternate&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label&gt;'.__('Title alignment', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;title_alignment&quot; value=&quot;left&quot; '.(($data['params']['title_alignment'] === 'left') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('left', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;title_alignment&quot; value=&quot;center&quot; '.(($data['params']['title_alignment'] === 'center') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('center', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;title_alignment&quot; value=&quot;right&quot; '.(($data['params']['title_alignment'] === 'right') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('right', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // image alignment&nbsp;</div></li><li><div>        $output .= '&lt;div id=&quot;image_block&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;div class=&quot;block clearfix&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;label&gt;'.__('Image alignment', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output .= '        &lt;div class=&quot;group clearfix&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // display alternate only when multiple posts are allowed&nbsp;</div></li><li><div>        if($data['autopost_type'] !== 'single') {&nbsp;</div></li><li><div>            $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;image_alignment&quot; value=&quot;alternate&quot; '.(($data['params']['image_alignment'] === 'alternate') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('alternate left & right', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $output .= '        &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;image_alignment&quot; value=&quot;left&quot; '.(($data['params']['image_alignment'] === 'left') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('left', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;image_alignment&quot; value=&quot;center&quot; '.(($data['params']['image_alignment'] === 'center') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('center', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;image_alignment&quot; value=&quot;right&quot; '.(($data['params']['image_alignment'] === 'right') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('right', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;image_alignment&quot; value=&quot;none&quot; '.(($data['params']['image_alignment'] === 'none') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('no image', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output .= '    &lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // image width&nbsp;</div></li><li><div>        $output .= '    &lt;div id=&quot;image_width_block&quot; class=&quot;block clearfix&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;input id=&quot;image_width&quot; type=&quot;hidden&quot; name=&quot;image_width&quot; value=&quot;'.(int)$data['params']['image_width'].'&quot; /&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;label&gt;'.__('Image width', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;span id=&quot;image_width_slider&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '            &lt;span id=&quot;slider_handle&quot;&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;/span&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;span id=&quot;slider_info&quot;&gt;&lt;span&gt;'.(int)$data['params']['image_width'].'&lt;/span&gt; px&lt;/span&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;/div&gt;';&nbsp;</div></li><li><div>        $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // author options&nbsp;</div></li><li><div>        $output .= '&lt;div id=&quot;author-block&quot; class=&quot;block clearfix alternate&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label&gt;'.__('Include author', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;div class=&quot;group&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;p class=&quot;clearfix&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '            &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;author_show&quot; value=&quot;no&quot; '.(($data['params']['author_show'] === 'no') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('no', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '            &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;author_show&quot; value=&quot;above&quot; '.(($data['params']['author_show'] === 'above') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('above content', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '            &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;author_show&quot; value=&quot;below&quot; '.(($data['params']['author_show'] === 'below') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('below content', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;/p&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;p class=&quot;clearfix&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '            &lt;label&gt;'.__('Preceded by:', WYSIJA).'&nbsp;&lt;input type=&quot;text&quot; name=&quot;author_label&quot; value=&quot;'.stripslashes($data['params']['author_label']).'&quot; /&gt;&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;/p&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;/div&gt;';&nbsp;</div></li><li><div>        $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // categories options&nbsp;</div></li><li><div>        $output .= '&lt;div id=&quot;category-block&quot; class=&quot;block clearfix&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label&gt;'.__('Include categories', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;div class=&quot;group&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;p class=&quot;clearfix&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '            &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;category_show&quot; value=&quot;no&quot; '.(($data['params']['category_show'] === 'no') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('no', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '            &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;category_show&quot; value=&quot;above&quot; '.(($data['params']['category_show'] === 'above') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('above content', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '            &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;category_show&quot; value=&quot;below&quot; '.(($data['params']['category_show'] === 'below') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('below content', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;/p&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;p class=&quot;clearfix&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '            &lt;label&gt;'.__('Preceded by:', WYSIJA).'&nbsp;&lt;input type=&quot;text&quot; name=&quot;category_label&quot; value=&quot;'.stripslashes($data['params']['category_label']).'&quot; /&gt;&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '        &lt;/p&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;/div&gt;';&nbsp;</div></li><li><div>        $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // read more&nbsp;</div></li><li><div>        $output .= '&lt;div id=&quot;readmore-block&quot; class=&quot;block clearfix&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label for=&quot;readmore&quot;&gt;'.__('&quot;Read more&quot; text', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;input type=&quot;text&quot; name=&quot;readmore&quot; value=&quot;'.stripslashes($data['params']['readmore']).'&quot; id=&quot;readmore&quot; /&gt;';&nbsp;</div></li><li><div>        $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // check if we allow mutiple posts within the ALC&nbsp;</div></li><li><div>        if($data['autopost_type'] === 'single') {&nbsp;</div></li><li><div>            // background color&nbsp;</div></li><li><div>            $output .= '&lt;div id=&quot;bgcolor-block&quot; class=&quot;block clearfix&quot;&gt;';&nbsp;</div></li><li><div>            $output .= '    &lt;label&gt;'.__('Background color', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>            $output .= '    &lt;input class=&quot;color&quot; type=&quot;text&quot; name=&quot;bgcolor1&quot; value=&quot;'.(isset($data['params']['bgcolor1']) ? $data['params']['bgcolor1'] : '').'&quot; /&gt;';&nbsp;</div></li><li><div>            $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            // batch insert options&nbsp;</div></li><li><div>            $output .= '&lt;div class=&quot;block clearfix&quot;&gt;';&nbsp;</div></li><li><div>            $output .= '    &lt;h2&gt;'.__('Batch insert options', WYSIJA).'&lt;/h2&gt;';&nbsp;</div></li><li><div>            $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // sort by&nbsp;</div></li><li><div>            $output .= '&lt;div id=&quot;sort-block&quot; class=&quot;block clearfix&quot;&gt;';&nbsp;</div></li><li><div>            $output .= '    &lt;label&gt;'.__('Sort by', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>            $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;sort_by&quot; value=&quot;newest&quot; '.(($data['params']['sort_by'] === 'newest') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('newest', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>            $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;sort_by&quot; value=&quot;oldest&quot; '.(($data['params']['sort_by'] === 'oldest') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('oldest', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>            $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // show dividers&nbsp;</div></li><li><div>            $output .= '&lt;div id=&quot;divider-block&quot; class=&quot;block clearfix&quot;&gt;';&nbsp;</div></li><li><div>            $output .= '    &lt;label&gt;'.__('Show divider between posts', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>            $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;show_divider&quot; value=&quot;yes&quot; '.(($data['params']['show_divider'] === 'yes') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('yes', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>            $output .= '    &lt;label class=&quot;radio&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;show_divider&quot; value=&quot;no&quot; '.(($data['params']['show_divider'] === 'no') ? 'checked=&quot;checked&quot;' : '').' /&gt;'.__('no', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>            $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // background colors&nbsp;</div></li><li><div>            $output .= '&lt;div id=&quot;bgcolor-block&quot; class=&quot;block clearfix&quot;&gt;';&nbsp;</div></li><li><div>            $output .= '    &lt;label&gt;'.__('Background color with alternate', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>            $output .= '    &lt;input class=&quot;color&quot; type=&quot;text&quot; name=&quot;bgcolor1&quot; value=&quot;'.(isset($data['params']['bgcolor1']) ? $data['params']['bgcolor1'] : '').'&quot; /&gt;';&nbsp;</div></li><li><div>            $output .= '    &lt;input class=&quot;color&quot; type=&quot;text&quot; name=&quot;bgcolor2&quot; value=&quot;'.(isset($data['params']['bgcolor2']) ? $data['params']['bgcolor2'] : '').'&quot; /&gt;';&nbsp;</div></li><li><div>            $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $output;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function popup_dividers($data = array()) {&nbsp;</div></li><li><div>        echo $this-&gt;messages(true);&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;div class=&quot;popup_content dividers&quot;&gt;&nbsp;</div></li><li><div>            &lt;form enctype=&quot;multipart/form-data&quot; method=&quot;post&quot; action=&quot;&quot; class=&quot;&quot; id=&quot;dividers-form&quot;&gt;&nbsp;</div></li><li><div>                &lt;ul class=&quot;dividers&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                foreach($data['dividers'] as $divider) {&nbsp;</div></li><li><div>                    $selected = ($divider['src'] === $data['selected']['src']) ? ' class=&quot;selected&quot;' : '';&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                    &lt;li class=&quot;clearfix&quot;&gt;&lt;a href=&quot;javascript:;&quot;&lt;?php echo $selected ?&gt;&gt;&lt;img src=&quot;&lt;?php echo $divider['src'] ?&gt;&quot; alt=&quot;&quot; width=&quot;&lt;?php echo $divider['width'] ?&gt;&quot; height=&quot;&lt;?php echo $divider['height'] ?&gt;&quot; /&gt;&lt;/a&gt;&lt;/li&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                &lt;/ul&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;hidden&quot; name=&quot;email_id&quot; value=&quot;&lt;?php echo $data['email']['email_id'] ?&gt;&quot; id=&quot;email_id&quot; /&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;hidden&quot; name=&quot;divider_src&quot; value=&quot;&lt;?php echo $data['selected']['src'] ?&gt;&quot; id=&quot;divider_src&quot; /&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;hidden&quot; name=&quot;divider_width&quot; value=&quot;&lt;?php echo $data['selected']['width'] ?&gt;&quot; id=&quot;divider_width&quot; /&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;hidden&quot; name=&quot;divider_height&quot; value=&quot;&lt;?php echo $data['selected']['height'] ?&gt;&quot; id=&quot;divider_height&quot; /&gt;&nbsp;</div></li><li><div>                &lt;p class=&quot;submit_button&quot;&gt;&nbsp;</div></li><li><div>                    &lt;input type=&quot;submit&quot; id=&quot;dividers-submit&quot; class=&quot;button-primary&quot; name=&quot;submit&quot; value=&quot;&lt;?php echo esc_attr(__('Done', WYSIJA)); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                &lt;/p&gt;&nbsp;</div></li><li><div>            &lt;/form&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function popup_autopost($data = array()) {&nbsp;</div></li><li><div>        echo $this-&gt;messages(true);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // container&nbsp;</div></li><li><div>        $output .= '&lt;div class=&quot;popup_content inline_form autopost&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // form&nbsp;</div></li><li><div>        $output .= '&lt;form enctype=&quot;multipart/form-data&quot; method=&quot;post&quot; action=&quot;&quot; class=&quot;&quot; id=&quot;autopost-form&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // basic options&nbsp;</div></li><li><div>        $output .= '&lt;div id=&quot;basic&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $helper_articles = WYSIJA::get('articles', 'helper');&nbsp;</div></li><li><div>        $output .= '&lt;div class=&quot;block clearfix&quot;&gt;';&nbsp;</div></li><li><div>        $output .= '    &lt;label&gt;'.__('Post type', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        $output .= $helper_articles-&gt;field_select_post_type( array( 'value' =&gt; $data['params']['post_type'] ) );&nbsp;</div></li><li><div>        $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // post limit&nbsp;</div></li><li><div>        if($data['autopost_type'] === 'single') {&nbsp;</div></li><li><div>            $output .= '&lt;input type=&quot;hidden&quot; name=&quot;post_limit&quot; value=&quot;1&quot; /&gt;';&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $output .= '&lt;div class=&quot;block clearfix&quot;&gt;';&nbsp;</div></li><li><div>            $output .= '    &lt;label&gt;'.__('Maximum of posts to show', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>            $output .= '    &lt;select name=&quot;post_limit&quot; id=&quot;post_limit&quot;&gt;';&nbsp;</div></li><li><div>            foreach($data['post_limits'] as $limit) {&nbsp;</div></li><li><div>                $output .= '    &lt;option value=&quot;'.$limit.'&quot; '.(($limit === (int)$data['params']['post_limit']) ? 'selected=&quot;selected&quot;' : '').' &gt;'.$limit.'&lt;/option&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $output .= '    &lt;/select&gt;';&nbsp;</div></li><li><div>            $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Get selected terms IDs&nbsp;</div></li><li><div>        $terms_selected = array_filter( ( isset( $data['params']['category_ids'] ) ? explode( ', ', trim( $data['params']['category_ids'] ) ) : array() ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Create the init selection in to be in the Select2 format of results&nbsp;</div></li><li><div>        $_attr_init_selection = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Only build if there are any selected terms&nbsp;</div></li><li><div>        if ( ! empty( $terms_selected ) ) {&nbsp;</div></li><li><div>            $taxonomies = get_taxonomies( array(), 'objects' );&nbsp;</div></li><li><div>            $terms = get_terms( array_keys( $taxonomies ), array( 'include' =&gt; $terms_selected, 'hide_empty' =&gt; false ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            foreach ( $terms as $term ) {&nbsp;</div></li><li><div>                $_attr_init_selection[] = array(&nbsp;</div></li><li><div>                    'id' =&gt; $term-&gt;term_id, &nbsp;</div></li><li><div>                    'text' =&gt; wp_kses( $taxonomies[$term-&gt;taxonomy]-&gt;labels-&gt;singular_name . ': ' . $term-&gt;name, array() ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // categories&nbsp;</div></li><li><div>        $output .=&nbsp;</div></li><li><div>        '&lt;div class=&quot;block clearfix&quot; id=&quot;categories_filters&quot;&gt;' .&nbsp;</div></li><li><div>            '&lt;label title=&quot;' . esc_attr__( 'And taxonomies as well...', WYSIJA ) . '&quot;&gt;' . __( 'Categories and tags', WYSIJA ) . '&lt;/label&gt;' .&nbsp;</div></li><li><div>            '&lt;div class=&quot;group&quot;&gt;' .&nbsp;</div></li><li><div>                '&lt;p class=&quot;category_select clearfix&quot;&gt;' .&nbsp;</div></li><li><div>                    '&lt;input data-placeholder=&quot;' . __( 'Select...', WYSIJA ) . '&quot; name=&quot;category_ids&quot; style=&quot;width: 300px&quot; class=&quot;category_ids mailpoet-field-select2-terms&quot; data-multiple=&quot;true&quot; data-value=\'' . WJ_Utils::esc_json_attr( $_attr_init_selection ) . '\' value=&quot;' . esc_attr( implode( ', ', $terms_selected ) ) . '&quot; type=&quot;hidden&quot;&gt;' .&nbsp;</div></li><li><div>                '&lt;/p&gt;' .&nbsp;</div></li><li><div>            '&lt;/div&gt;' .&nbsp;</div></li><li><div>        '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // end - basic options&nbsp;</div></li><li><div>        $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // display options&nbsp;</div></li><li><div>        $output .= '&lt;p&gt;&lt;a id=&quot;toggle-advanced&quot; href=&quot;javascript:;&quot;&gt;'.__('Show display options', WYSIJA).'&lt;/a&gt;&lt;/p&gt;';&nbsp;</div></li><li><div>        $output .= '&lt;div id=&quot;advanced&quot;&gt;';&nbsp;</div></li><li><div>        $output .= $this-&gt;_post_display_options($data);&nbsp;</div></li><li><div>        $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $output .= '    &lt;p class=&quot;submit_button&quot;&gt;&lt;input type=&quot;submit&quot; id=&quot;autopost-submit&quot; class=&quot;button-primary&quot; name=&quot;submit&quot; value=&quot;'.__('Done', WYSIJA).'&quot; /&gt;&lt;/p&gt;';&nbsp;</div></li><li><div>        $output .= '&lt;/form&gt;';&nbsp;</div></li><li><div>        $output .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo $output;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function popup_bookmarks($data = array()) {&nbsp;</div></li><li><div>        echo $this-&gt;messages(true);&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>                &lt;div class=&quot;popup_content inline_form bookmarks&quot;&gt;&nbsp;</div></li><li><div>                    &lt;form enctype=&quot;multipart/form-data&quot; method=&quot;post&quot; action=&quot;&quot; class=&quot;&quot; id=&quot;bookmarks-form&quot;&gt;&nbsp;</div></li><li><div>                        &lt;ul class=&quot;networks&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                $i = 0;&nbsp;</div></li><li><div>                foreach ($data['networks'] as $key =&gt; $network) {&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                                &lt;li class=&quot;clearfix&quot;&gt;&nbsp;</div></li><li><div>                                    &lt;input type=&quot;hidden&quot; name=&quot;bookmarks-&lt;?php echo($key) ?&gt;-position&quot; value=&quot;&lt;?php echo($i++) ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                                    &lt;label for=&quot;bookmarks-url-&lt;?php echo($key) ?&gt;&quot;&gt;&lt;?php echo($network['label']) ?&gt;&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;bookmarks-&lt;?php echo($key) ?&gt;-url&quot; placeholder=&quot;&lt;?php echo $network['placeholder']; ?&gt;&quot; value=&quot;&lt;?php echo htmlentities($network['url']) ?&gt;&quot; id=&quot;bookmarks-url-&lt;?php echo($key) ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                                &lt;/li&gt;&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                        &lt;/ul&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;div class=&quot;sizes&quot;&gt;&nbsp;</div></li><li><div>                            &lt;span&gt;&lt;?php _e('Size:', WYSIJA) ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                            &lt;a href=&quot;javascript:;&quot; class=&quot;small&lt;?php if ($data['size'] === 'small') echo ' selected' ?&gt;&quot; rel=&quot;small&quot;&gt;&lt;?php _e('small', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                            &lt;a href=&quot;javascript:;&quot; class=&quot;medium&lt;?php if ($data['size'] === 'medium') echo ' selected' ?&gt;&quot; rel=&quot;medium&quot;&gt;&lt;?php _e('medium', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                            &lt;input type=&quot;hidden&quot; name=&quot;bookmarks-size&quot; value=&quot;&lt;?php echo $data['size'] ?&gt;&quot; id=&quot;bookmarks-size&quot; /&gt;&nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;ul class=&quot;icons&quot;&gt;&lt;!-- this will be loaded via ajax --&gt;&lt;/ul&gt;&nbsp;</div></li><li><div>                        &lt;input type=&quot;hidden&quot; name=&quot;bookmarks-iconset&quot; value=&quot;&quot; id=&quot;bookmarks-iconset&quot; /&gt;&nbsp;</div></li><li><div>                        &lt;input type=&quot;hidden&quot; name=&quot;bookmarks-theme&quot; value=&quot;&lt;?php echo $data['theme'] ?&gt;&quot; id=&quot;bookmarks-theme&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;p class=&quot;submit_button&quot;&gt;&nbsp;</div></li><li><div>                            &lt;input type=&quot;submit&quot; id=&quot;bookmarks-submit&quot; name=&quot;submit&quot; value=&quot;&lt;?php echo esc_attr(__(&quot;Done&quot;, WYSIJA)) ?&gt;&quot; class=&quot;button-primary&quot;/&gt;&nbsp;</div></li><li><div>                        &lt;/p&gt;&nbsp;</div></li><li><div>                    &lt;/form&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function popup_wysija_browse($errors) {&nbsp;</div></li><li><div>                echo $this-&gt;messages(true);&nbsp;</div></li><li><div>                ?&gt;&lt;div id=&quot;overlay&quot;&gt;&lt;img id=&quot;loader&quot; src=&quot;&lt;?php echo WYSIJA_URL ?&gt;img/wpspin_light.gif&quot; /&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                &lt;div class=&quot;popup_content media-browse&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    global $redir_tab, $type;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $redir_tab = 'wysija_browse';&nbsp;</div></li><li><div>                    media_upload_header();&nbsp;</div></li><li><div>                    $post_id = intval($_REQUEST['post_id']);&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;form enctype=&quot;multipart/form-data&quot; method=&quot;post&quot; action=&quot;&quot; class=&quot;media-upload-form validate&quot; id=&quot;wysija-browse-form&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    $secure = array('action' =&gt; &quot;medias&quot;);&nbsp;</div></li><li><div>                    $this-&gt;secure($secure);&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;div id=&quot;media-items&quot; class=&quot;clearfix&quot;&gt;&lt;?php echo $this-&gt;_get_media_items($post_id, $errors); ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;/form&gt;&nbsp;</div></li><li><div>                    &lt;?php $this-&gt;_alt_close(); ?&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _alt_close() {&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>        &lt;p class=&quot;submit_button&quot;&gt;&lt;input type=&quot;submit&quot; id=&quot;close-pop-alt&quot; value=&quot;&lt;?php echo esc_attr(__(&quot;Done&quot;, WYSIJA)) ?&gt;&quot; name=&quot;submit-draft&quot; class=&quot;button-primary wysija&quot;/&gt;&lt;/p&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function __filterPostParent($query) {&nbsp;</div></li><li><div>        global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $query . ' AND post_parent!=' . (int) $_REQUEST['post_id'] . ' ';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function popup_wp_browse($errors) {&nbsp;</div></li><li><div>        echo $this-&gt;messages(true);&nbsp;</div></li><li><div>        ?&gt;&lt;div id=&quot;overlay&quot;&gt;&lt;img id=&quot;loader&quot; src=&quot;&lt;?php echo WYSIJA_URL ?&gt;img/wpspin_light.gif&quot; /&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                &lt;div class=&quot;popup_content media-wp-browse&quot;&gt;&nbsp;</div></li><li><div>                            &lt;?php&nbsp;</div></li><li><div>                            global $redir_tab, $wpdb, $wp_query, $wp_locale, $type, $tab, $post_mime_types;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            $redir_tab = 'wp_browse';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            media_upload_header();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            $limit = 20;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            $_GET['paged'] = isset($_GET['paged']) ? intval($_GET['paged']) : 0;&nbsp;</div></li><li><div>                            if ($_GET['paged'] &lt; 1)&nbsp;</div></li><li><div>                                $_GET['paged'] = 1;&nbsp;</div></li><li><div>                            $start = ( $_GET['paged'] - 1 ) * $limit;&nbsp;</div></li><li><div>                            if ($start &lt; 1)&nbsp;</div></li><li><div>                                $start = 0;&nbsp;</div></li><li><div>                            add_filter('post_limits', create_function('$a', &quot;return 'LIMIT $start, $limit';&quot;));&nbsp;</div></li><li><div>                            add_filter('posts_where_paged', array($this, '__filterPostParent'));&nbsp;</div></li><li><div>                            //add_filter( 'posts_where_paged', create_function( '$a', &quot;return ' AND post_parent!=1' &quot; ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            list($post_mime_types, $avail_post_mime_types) = wp_edit_attachments_query(array('post_mime_type' =&gt; array('image')));&nbsp;</div></li><li><div>                            ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;form enctype=&quot;multipart/form-data&quot; method=&quot;post&quot; action=&quot;&quot; class=&quot;media-upload-form validate&quot; id=&quot;library-form&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;div class=&quot;tablenav&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    $page_links = paginate_links(array(&nbsp;</div></li><li><div>                        'base' =&gt; add_query_arg('paged', '%#%'), &nbsp;</div></li><li><div>                        'format' =&gt; '', &nbsp;</div></li><li><div>                        'prev_text' =&gt; __('&laquo;'), &nbsp;</div></li><li><div>                        'next_text' =&gt; __('&raquo;'), &nbsp;</div></li><li><div>                        'total' =&gt; ceil($wp_query-&gt;found_posts / $limit), &nbsp;</div></li><li><div>                        'current' =&gt; $_GET['paged']&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ($page_links)&nbsp;</div></li><li><div>                        echo &quot;&lt;div class='tablenav-pages'&gt;$page_links&lt;/div&gt;&quot;;&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    $secure = array('action' =&gt; &quot;medias&quot;);&nbsp;</div></li><li><div>                    $this-&gt;secure($secure);&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;div id=&quot;media-items&quot; class=&quot;clearfix&quot;&gt;&lt;?php echo $this-&gt;_get_media_items(null, $errors, true); ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;/form&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;?php $this-&gt;_alt_close(); ?&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                function popup_new_wp_upload($errors) {&nbsp;</div></li><li><div>                    echo $this-&gt;messages(true);&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                &lt;div id=&quot;overlay&quot;&gt;&lt;img id=&quot;loader&quot; src=&quot;&lt;?php echo WYSIJA_URL ?&gt;img/wpspin_light.gif&quot; /&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                &lt;div class=&quot;popup_content media-wp-upload&quot;&gt;&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                        global $redir_tab, $type, $tab;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        $redir_tab = 'new_wp_upload';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        media_upload_header();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        global $type, $tab, $pagenow, $is_IE, $is_opera;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        if (function_exists('_device_can_upload') && !_device_can_upload()) {&nbsp;</div></li><li><div>                            echo '&lt;p&gt;' . __('The web browser on your device cannot be used to upload files. You may be able to use the &lt;a href=&quot;http://wordpress.org/extend/mobile/&quot;&gt;native app for your device&lt;/a&gt; instead.') . '&lt;/p&gt;';&nbsp;</div></li><li><div>                            return;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        $upload_action_url = admin_url('async-upload.php');&nbsp;</div></li><li><div>                        $post_id = isset($_REQUEST['post_id']) ? intval($_REQUEST['post_id']) : 0;&nbsp;</div></li><li><div>                        $_type = isset($type) ? $type : '';&nbsp;</div></li><li><div>                        $_tab = isset($tab) ? $tab : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        $upload_size_unit = $max_upload_size = wp_max_upload_size();&nbsp;</div></li><li><div>                        $sizes = array('KB', 'MB', 'GB');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        for ($u = -1; $upload_size_unit &gt; 1024 && $u &lt; count($sizes) - 1; $u++) {&nbsp;</div></li><li><div>                            $upload_size_unit /= 1024;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        if ($u &lt; 0) {&nbsp;</div></li><li><div>                            $upload_size_unit = 0;&nbsp;</div></li><li><div>                            $u = 0;&nbsp;</div></li><li><div>                        } else {&nbsp;</div></li><li><div>                            $upload_size_unit = (int) $upload_size_unit;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        ?&gt;&nbsp;</div></li><li><div>                    &lt;script type=&quot;text/javascript&quot;&gt;var post_id = &lt;?php echo $post_id; ?&gt;;&lt;/script&gt;&nbsp;</div></li><li><div>                    &lt;div id=&quot;media-upload-notice&quot;&gt;&lt;?php&nbsp;</div></li><li><div>                    if (isset($errors['upload_notice']))&nbsp;</div></li><li><div>                        echo $errors['upload_notice'];&nbsp;</div></li><li><div>                    ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;div id=&quot;media-upload-error&quot;&gt;&lt;?php&nbsp;</div></li><li><div>                    if (isset($errors['upload_error']) && is_wp_error($errors['upload_error']))&nbsp;</div></li><li><div>                        echo $errors['upload_error']-&gt;get_error_message();&nbsp;</div></li><li><div>                    ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    // Check quota for this blog if multisite&nbsp;</div></li><li><div>                    if (is_multisite() && !is_upload_space_available()) {&nbsp;</div></li><li><div>                        echo '&lt;p&gt;' . sprintf(__('Sorry, you have filled your storage quota (%s MB).'), get_space_allowed()) . '&lt;/p&gt;';&nbsp;</div></li><li><div>                        return;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    do_action('pre-upload-ui');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $post_params = array(&nbsp;</div></li><li><div>                        &quot;post_id&quot; =&gt; $post_id, &nbsp;</div></li><li><div>                        &quot;_wpnonce&quot; =&gt; wp_create_nonce('media-form'), &nbsp;</div></li><li><div>                        &quot;type&quot; =&gt; $_type, &nbsp;</div></li><li><div>                        &quot;tab&quot; =&gt; $_tab, &nbsp;</div></li><li><div>                        &quot;short&quot; =&gt; &quot;1&quot;, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $post_params = apply_filters('upload_post_params', $post_params); // hook change! old name: 'swfupload_post_params'&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $plupload_init = array(&nbsp;</div></li><li><div>                        'runtimes' =&gt; 'html5, silverlight, flash, html4', &nbsp;</div></li><li><div>                        'browse_button' =&gt; 'plupload-browse-button', &nbsp;</div></li><li><div>                        'container' =&gt; 'plupload-upload-ui', &nbsp;</div></li><li><div>                        'drop_element' =&gt; 'drag-drop-area', &nbsp;</div></li><li><div>                        'file_data_name' =&gt; 'async-upload', &nbsp;</div></li><li><div>                        'multiple_queues' =&gt; true, &nbsp;</div></li><li><div>                        'max_file_size' =&gt; $max_upload_size . 'b', &nbsp;</div></li><li><div>                        'url' =&gt; $upload_action_url, &nbsp;</div></li><li><div>                        'flash_swf_url' =&gt; includes_url('js/plupload/plupload.flash.swf'), &nbsp;</div></li><li><div>                        'silverlight_xap_url' =&gt; includes_url('js/plupload/plupload.silverlight.xap'), &nbsp;</div></li><li><div>                        'filters' =&gt; array(array('title' =&gt; __('Allowed Files'), 'extensions' =&gt; '*')), &nbsp;</div></li><li><div>                        'multipart' =&gt; true, &nbsp;</div></li><li><div>                        'urlstream_upload' =&gt; true, &nbsp;</div></li><li><div>                        'multipart_params' =&gt; $post_params&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $plupload_init = apply_filters('plupload_init', $plupload_init);&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>                            &lt;?php&nbsp;</div></li><li><div>                            // Verify size is an int. If not return default value.&nbsp;</div></li><li><div>                            $large_size_h = absint(get_option('large_size_h'));&nbsp;</div></li><li><div>                            if (!$large_size_h)&nbsp;</div></li><li><div>                                $large_size_h = 1024;&nbsp;</div></li><li><div>                            $large_size_w = absint(get_option('large_size_w'));&nbsp;</div></li><li><div>                            if (!$large_size_w)&nbsp;</div></li><li><div>                                $large_size_w = 1024;&nbsp;</div></li><li><div>                            ?&gt;&nbsp;</div></li><li><div>                        var resize_height = &lt;?php echo $large_size_h; ?&gt;, resize_width = &lt;?php echo $large_size_w; ?&gt;, &nbsp;</div></li><li><div>                                wpUploaderInit = &lt;?php echo json_encode($plupload_init); ?&gt;;&nbsp;</div></li><li><div>                    &lt;/script&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;div id=&quot;plupload-upload-ui&quot; class=&quot;hide-if-no-js&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php do_action('pre-plupload-upload-ui'); // hook change, old name: 'pre-flash-upload-ui'  ?&gt;&nbsp;</div></li><li><div>                        &lt;div id=&quot;drag-drop-area&quot;&gt;&nbsp;</div></li><li><div>                            &lt;div class=&quot;drag-drop-inside&quot;&gt;&nbsp;</div></li><li><div>                                &lt;p class=&quot;drag-drop-info&quot;&gt;&lt;?php _e('Drop files here', WYSIJA); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                                &lt;p&gt;&lt;?php _ex('or', 'Uploader: Drop files here - or - Select Files', WYSIJA); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                                &lt;p class=&quot;drag-drop-buttons&quot;&gt;&lt;input id=&quot;plupload-browse-button&quot; type=&quot;button&quot; value=&quot;&lt;?php esc_attr_e('Select Files', WYSIJA); ?&gt;&quot; class=&quot;button&quot; /&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                            &lt;/div&gt;&nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;?php do_action('post-plupload-upload-ui'); // hook change, old name: 'post-flash-upload-ui' ?&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;div id=&quot;html-upload-ui&quot; class=&quot;hide-if-js&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php do_action('pre-html-upload-ui'); ?&gt;&nbsp;</div></li><li><div>                        &lt;p id=&quot;async-upload-wrap&quot; class=&quot;clearfix&quot;&gt;&nbsp;</div></li><li><div>                            &lt;label class=&quot;screen-reader-text&quot; for=&quot;async-upload&quot;&gt;&lt;?php _e('Upload', WYSIJA); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                            &lt;input type=&quot;file&quot; name=&quot;async-upload&quot; id=&quot;async-upload&quot; /&gt;&nbsp;</div></li><li><div>                &lt;?php submit_button(__('Upload'), 'button', 'html-upload', false); ?&gt;&nbsp;</div></li><li><div>                            &lt;a href=&quot;#&quot; onclick=&quot;try {&nbsp;</div></li><li><div>                                top.tb_remove();&nbsp;</div></li><li><div>                            } catch (e) {&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                            ;&nbsp;</div></li><li><div>                            return false;&quot;&gt;&lt;?php _e('Cancel', WYSIJA); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                        &lt;/p&gt;&nbsp;</div></li><li><div>                &lt;?php do_action('post-html-upload-ui'); ?&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;p class=&quot;max-upload-size&quot;&gt;&lt;?php printf(__('Maximum upload file size: %d%s.', WYSIJA), esc_html($upload_size_unit), esc_html($sizes[$u])); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                &lt;?php if (($is_IE || $is_opera) && $max_upload_size &gt; 100 * 1024 * 1024) { ?&gt;&nbsp;</div></li><li><div>                        &lt;p class=&quot;big-file-warning&quot;&gt;&lt;?php _e('Your browser has some limitations uploading large files with the multi-file uploader. Please use the browser uploader for files over 100MB.', WYSIJA); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                &lt;?php }&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                    &lt;div id=&quot;media-items&quot; class=&quot;hide-if-no-js&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                &lt;?php do_action('post-upload-ui'); ?&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function popup_wp_upload($errors) {&nbsp;</div></li><li><div>                global $redir_tab, $type, $tab;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $redir_tab = 'wp_upload';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                media_upload_header();&nbsp;</div></li><li><div>                $flash_action_url = admin_url('async-upload.php');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // If Mac and mod_security, no Flash. :(&nbsp;</div></li><li><div>                $flash = true;&nbsp;</div></li><li><div>                /**&nbsp;</div></li><li><div>                  if(false !== stripos($_SERVER['HTTP_USER_AGENT'], 'mac') && apache_mod_loaded('mod_security')) {&nbsp;</div></li><li><div>                  $flash = false;&nbsp;</div></li><li><div>                  } */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $flash = apply_filters('flash_uploader', $flash);&nbsp;</div></li><li><div>                $post_id = isset($_REQUEST['post_id']) ? intval($_REQUEST['post_id']) : 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $upload_size_unit = $max_upload_size = wp_max_upload_size();&nbsp;</div></li><li><div>                $sizes = array('KB', 'MB', 'GB');&nbsp;</div></li><li><div>                for ($u = -1; $upload_size_unit &gt; 1024 && $u &lt; count($sizes) - 1; $u++)&nbsp;</div></li><li><div>                    $upload_size_unit /= 1024;&nbsp;</div></li><li><div>                if ($u &lt; 0) {&nbsp;</div></li><li><div>                    $upload_size_unit = 0;&nbsp;</div></li><li><div>                    $u = 0;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $upload_size_unit = (int) $upload_size_unit;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                echo $this-&gt;messages(true);&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                &lt;div class=&quot;updated&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;?php _e('Please update your WordPress to the latest version, in order to get the latest uploading system.', WYSIJA) ?&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                &lt;div id=&quot;overlay&quot;&gt;&lt;img id=&quot;loader&quot; src=&quot;&lt;?php echo WYSIJA_URL ?&gt;img/wpspin_light.gif&quot; /&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                &lt;div class=&quot;popup_content media-wp-upload&quot;&gt;&nbsp;</div></li><li><div>                    &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>                        //&lt;![CDATA[&nbsp;</div></li><li><div>                        var uploaderMode = 0;&nbsp;</div></li><li><div>                        jQuery(document).ready(function($) {&nbsp;</div></li><li><div>                            uploaderMode = getUserSetting('uploader');&nbsp;</div></li><li><div>                            $('.upload-html-bypass a').click(function() {&nbsp;</div></li><li><div>                                deleteUserSetting('uploader');&nbsp;</div></li><li><div>                                uploaderMode = 0;&nbsp;</div></li><li><div>                                swfuploadPreLoad();&nbsp;</div></li><li><div>                                return false;&nbsp;</div></li><li><div>                            });&nbsp;</div></li><li><div>                            $('.upload-flash-bypass a').click(function() {&nbsp;</div></li><li><div>                                setUserSetting('uploader', '1');&nbsp;</div></li><li><div>                                uploaderMode = 1;&nbsp;</div></li><li><div>                                swfuploadPreLoad();&nbsp;</div></li><li><div>                                return false;&nbsp;</div></li><li><div>                            });&nbsp;</div></li><li><div>                        });&nbsp;</div></li><li><div>                        //]]&gt;&nbsp;</div></li><li><div>                    &lt;/script&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;div id=&quot;media-upload-notice&quot;&gt;&nbsp;</div></li><li><div>        &lt;?php if (isset($errors['upload_notice'])) { ?&gt;&nbsp;</div></li><li><div>            &lt;?php echo $errors['upload_notice']; ?&gt;&nbsp;</div></li><li><div>        &lt;?php } ?&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;div id=&quot;media-upload-error&quot;&gt;&nbsp;</div></li><li><div>        &lt;?php if (isset($errors['upload_error']) && is_wp_error($errors['upload_error'])) { ?&gt;&nbsp;</div></li><li><div>            &lt;?php echo $errors['upload_error']-&gt;get_error_message(); ?&gt;&nbsp;</div></li><li><div>        &lt;?php } ?&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        // Check quota for this blog if multisite&nbsp;</div></li><li><div>        if (is_multisite() && !is_upload_space_available()) {&nbsp;</div></li><li><div>            echo '&lt;p&gt;' . sprintf(__('Sorry, you have filled your storage quota (%s MB).'), get_space_allowed()) . '&lt;/p&gt;';&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        do_action('pre-upload-ui');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ($flash) :&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>                        &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>                            //&lt;![CDATA[&nbsp;</div></li><li><div>                            var swfu;&nbsp;</div></li><li><div>                            SWFUpload.onload = function() {&nbsp;</div></li><li><div>                                var settings = {&nbsp;</div></li><li><div>                                    button_text: '&lt;span class=&quot;button&quot;&gt;&lt;?php _e('Select Files', WYSIJA); ?&gt;&lt;\/span&gt;', &nbsp;</div></li><li><div>                                    button_text_style: '.button { text-align: center; font-weight: bold; font-family:&quot;Lucida Grande&quot;, Verdana, Arial, &quot;Bitstream Vera Sans&quot;, sans-serif; font-size: 11px; text-shadow: 0 1px 0 #FFFFFF; color:#464646; }', &nbsp;</div></li><li><div>                                    button_height: &quot;23&quot;, &nbsp;</div></li><li><div>                                    button_width: &quot;132&quot;, &nbsp;</div></li><li><div>                                    button_text_top_padding: 3, &nbsp;</div></li><li><div>                                    button_image_url: '&lt;?php echo includes_url('images/upload.png?ver=20100531'); ?&gt;', &nbsp;</div></li><li><div>                                    button_placeholder_id: &quot;flash-browse-button&quot;, &nbsp;</div></li><li><div>                                    upload_url: &quot;&lt;?php echo esc_attr($flash_action_url); ?&gt;&quot;, &nbsp;</div></li><li><div>                                    flash_url: &quot;&lt;?php echo includes_url() . 'js/swfupload/swfupload.swf'; ?&gt;&quot;, &nbsp;</div></li><li><div>                                    file_post_name: &quot;async-upload&quot;, &nbsp;</div></li><li><div>                                    file_types: &quot;&lt;?php echo apply_filters('upload_file_glob', '*.*'); ?&gt;&quot;, &nbsp;</div></li><li><div>                                    post_params: {&nbsp;</div></li><li><div>                                        &quot;post_id&quot;: &quot;&lt;?php echo $post_id; ?&gt;&quot;, &nbsp;</div></li><li><div>                                        &quot;auth_cookie&quot;: &quot;&lt;?php echo (is_ssl() ? $_COOKIE[SECURE_AUTH_COOKIE] : $_COOKIE[AUTH_COOKIE]); ?&gt;&quot;, &nbsp;</div></li><li><div>                                        &quot;logged_in_cookie&quot;: &quot;&lt;?php echo $_COOKIE[LOGGED_IN_COOKIE]; ?&gt;&quot;, &nbsp;</div></li><li><div>                                        &quot;_wpnonce&quot;: &quot;&lt;?php echo wp_create_nonce('media-form'); ?&gt;&quot;, &nbsp;</div></li><li><div>                                        &quot;type&quot;: &quot;&lt;?php echo $type; ?&gt;&quot;, &nbsp;</div></li><li><div>                                        &quot;tab&quot;: &quot;&lt;?php echo $tab; ?&gt;&quot;, &nbsp;</div></li><li><div>                                        &quot;short&quot;: &quot;1&quot;&nbsp;</div></li><li><div>                                    }, &nbsp;</div></li><li><div>                                    file_size_limit: &quot;&lt;?php echo $max_upload_size; ?&gt;b&quot;, &nbsp;</div></li><li><div>                                    file_dialog_start_handler: fileDialogStart, &nbsp;</div></li><li><div>                                    file_queued_handler: fileQueued, &nbsp;</div></li><li><div>                                    upload_start_handler: uploadStart, &nbsp;</div></li><li><div>                                    upload_progress_handler: uploadProgress, &nbsp;</div></li><li><div>                                    upload_error_handler: uploadError, &nbsp;</div></li><li><div>                                    upload_success_handler: WYSIJAuploadSuccess, &nbsp;</div></li><li><div>                                    upload_complete_handler: WYSIJAuploadComplete, &nbsp;</div></li><li><div>                                    file_queue_error_handler: fileQueueError, &nbsp;</div></li><li><div>                                    file_dialog_complete_handler: fileDialogComplete, &nbsp;</div></li><li><div>                                    swfupload_pre_load_handler: swfuploadPreLoad, &nbsp;</div></li><li><div>                                    swfupload_load_failed_handler: swfuploadLoadFailed, &nbsp;</div></li><li><div>                                    custom_settings: {&nbsp;</div></li><li><div>                                        degraded_element_id: &quot;html-upload-ui&quot;, // id of the element displayed when swfupload is unavailable&nbsp;</div></li><li><div>                                        swfupload_element_id: &quot;flash-upload-ui&quot; // id of the element displayed when swfupload is available&nbsp;</div></li><li><div>                                    }, &nbsp;</div></li><li><div>                                    debug: false&nbsp;</div></li><li><div>                                };&nbsp;</div></li><li><div>                                swfu = new SWFUpload(settings);&nbsp;</div></li><li><div>                            };&nbsp;</div></li><li><div>                            //]]&gt;&nbsp;</div></li><li><div>                        &lt;/script&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;div id=&quot;flash-upload-ui&quot; class=&quot;hide-if-no-js&quot;&gt;&nbsp;</div></li><li><div>                        &lt;?php do_action('pre-flash-upload-ui'); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            &lt;div&gt;&nbsp;</div></li><li><div>                    &lt;?php _e('Choose files to upload', WYSIJA); ?&gt;&nbsp;</div></li><li><div>                                &lt;div id=&quot;flash-browse-button&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                                &lt;span&gt;&lt;input id=&quot;cancel-upload&quot; disabled=&quot;disabled&quot; onclick=&quot;cancelUpload()&quot; type=&quot;button&quot; value=&quot;&lt;?php esc_attr_e('Cancel Upload', WYSIJA); ?&gt;&quot; class=&quot;button&quot; /&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                            &lt;/div&gt;&nbsp;</div></li><li><div>                            &lt;p class=&quot;media-upload-size&quot;&gt;&lt;?php printf(__('Maximum upload file size: %d%s', WYSIJA), $upload_size_unit, $sizes[$u]); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                    &lt;?php do_action('post-flash-upload-ui'); ?&gt;&nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;?php endif; // $flash ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;div id=&quot;html-upload-ui&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php do_action('pre-html-upload-ui'); ?&gt;&nbsp;</div></li><li><div>                        &lt;p id=&quot;async-upload-wrap&quot;&gt;&nbsp;</div></li><li><div>                            &lt;label class=&quot;screen-reader-text&quot; for=&quot;async-upload&quot;&gt;&lt;?php _e('Upload', WYSIJA); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                            &lt;input type=&quot;file&quot; name=&quot;async-upload&quot; id=&quot;async-upload&quot; /&gt; &lt;input type=&quot;submit&quot; class=&quot;button&quot; name=&quot;html-upload&quot; value=&quot;&lt;?php esc_attr_e('Upload', WYSIJA); ?&gt;&quot; /&gt; &lt;a href=&quot;#&quot; onclick=&quot;try {&nbsp;</div></li><li><div>                                top.tb_remove();&nbsp;</div></li><li><div>                            } catch (e) {&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                            ;&nbsp;</div></li><li><div>                            return false;&quot;&gt;&lt;?php _e('Cancel', WYSIJA); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                        &lt;/p&gt;&nbsp;</div></li><li><div>                        &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                        &lt;p class=&quot;media-upload-size&quot;&gt;&lt;?php printf(__('Maximum upload file size: %d%s', WYSIJA), $upload_size_unit, $sizes[$u]); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                &lt;?php if (is_lighttpd_before_150()): ?&gt;&nbsp;</div></li><li><div>                            &lt;p&gt;&lt;?php _e('If you want to use all capabilities of the uploader, like uploading multiple files at once, please upgrade to lighttpd 1.5.'); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>                &lt;?php do_action('post-html-upload-ui', $flash); ?&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;?php do_action('post-upload-ui'); ?&gt;&nbsp;</div></li><li><div>                    &lt;div id=&quot;media-items&quot; class=&quot;clearfix&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function _get_media_items($post_id, $errors, $wpimage = false) {&nbsp;</div></li><li><div>                $attachments = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ($post_id) {&nbsp;</div></li><li><div>                    $post = get_post($post_id);&nbsp;</div></li><li><div>                    if ($post && $post-&gt;post_type == 'attachment')&nbsp;</div></li><li><div>                        $attachments = array($post-&gt;ID =&gt; $post);&nbsp;</div></li><li><div>                    else&nbsp;</div></li><li><div>                        $attachments = get_children(array('post_parent' =&gt; $post_id, 'post_type' =&gt; 'attachment', 'orderby' =&gt; 'ID', 'order' =&gt; 'DESC', 'post_mime_type' =&gt; 'image'));&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    // old weird code reverted as the pagination broke&nbsp;</div></li><li><div>                    if (is_array($GLOBALS['wp_the_query']-&gt;posts)) {&nbsp;</div></li><li><div>                        foreach ($GLOBALS['wp_the_query']-&gt;posts as $attachment) {&nbsp;</div></li><li><div>                            $attachments[$attachment-&gt;ID] = $attachment;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    //TODO update the code so that we take care of the query ourselves without passing through WP get_posts() or get_children()&nbsp;</div></li><li><div>                    //$attachments = get_children( array( 'post_type' =&gt; 'attachment', 'orderby' =&gt; 'ID', 'order' =&gt; 'DESC', 'post_mime_type'=&gt;'image') );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $selectedImages=$this-&gt;_getSelectedImages();&nbsp;</div></li><li><div>            $output = '';&nbsp;</div></li><li><div>            $helper_image = WYSIJA::get('image', 'helper');&nbsp;</div></li><li><div>            foreach ( (array) $attachments as $id =&gt; $attachment ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if (!$post_id && $attachment-&gt;post_parent == $_REQUEST['post_id']) {&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ($attachment-&gt;post_status == 'trash') {&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ($attachment-&gt;post_mime_type == 'image/bmp') {&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (($id = intval($id)) && ($thumb_details = wp_get_attachment_image_src($id, 'thumbnail', true))) {&nbsp;</div></li><li><div>                        $thumb_url = $thumb_details[0];&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $thumb_url = false;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    // Check if we have our image size, otherwise, use full image.&nbsp;</div></li><li><div>                    if (($id = intval($id)) && ($wysija_sized_image = wp_get_attachment_image_src($id, 'wysija-newsletters-max', true))) {&nbsp;</div></li><li><div>                        $full_url = $wysija_sized_image[0];&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $full_url = $attachment-&gt;guid;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( ( $id = intval( $id ) )) $img_details = wp_get_attachment_image_src( $id, 'full', true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $image_template = array(&nbsp;</div></li><li><div>                           'width'=&gt; $img_details[1], &nbsp;</div></li><li><div>                           'height'=&gt; $img_details[2], &nbsp;</div></li><li><div>                           'url'=&gt; $full_url, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if(empty($image_template['width']) || empty($image_template['height']) || (empty($image_template['width']) && empty($image_template['height']))) {&nbsp;</div></li><li><div>                        $image_template = $helper_image-&gt;valid_image($image_template);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                     $classname=&quot;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                     if(isset($selectedImages[&quot;wp-&quot;.$attachment-&gt;ID])) $classname=&quot; selected &quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $output.='&lt;div class=&quot;wysija-thumb image-'.  esc_attr($attachment-&gt;ID.$classname).'&quot;&gt;';&nbsp;</div></li><li><div>                    $output .= '&lt;img title=&quot;'.  esc_attr($attachment-&gt;post_title).'&quot; alt=&quot;'.  esc_attr($attachment-&gt;post_title).'&quot; src=&quot;'.esc_url($thumb_url).'&quot; class=&quot;thumbnail&quot; /&gt;';&nbsp;</div></li><li><div>                    if(!$wpimage)    $output.='&lt;span class=&quot;delete-wrap&quot;&gt;&lt;span class=&quot;delete del-attachment&quot;&gt;'.esc_html($attachment-&gt;ID).'&lt;/span&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>                    $output.='&lt;span class=&quot;identifier&quot;&gt;'.  esc_html($attachment-&gt;ID).'&lt;/span&gt;&nbsp;</div></li><li><div>                        &lt;span class=&quot;width&quot;&gt;'.$image_template['width'].'&lt;/span&gt;&nbsp;</div></li><li><div>                        &lt;span class=&quot;height&quot;&gt;'.$image_template['height'].'&lt;/span&gt;&nbsp;</div></li><li><div>                        &lt;span class=&quot;url&quot;&gt;'.esc_url($full_url).'&lt;/span&gt;&nbsp;</div></li><li><div>                        &lt;span class=&quot;thumb_url&quot;&gt;'.esc_url($thumb_url).'&lt;/span&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if (!$output) {&nbsp;</div></li><li><div>                    if($wpimage === false) {&nbsp;</div></li><li><div>                        $output = &quot;&lt;em&gt;&quot; . __('This tab will be filled with images from your current and previous newsletters.', WYSIJA) . &quot;&lt;/em&gt;&quot;;&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $output = &quot;&lt;em&gt;&quot; . __('This tab will be filled with images from your WordPress Posts.', WYSIJA) . &quot;&lt;/em&gt;&quot;;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                return $output;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function _getSelectedImages() {&nbsp;</div></li><li><div>                $modelEmail = WYSIJA::get(&quot;email&quot;, &quot;model&quot;);&nbsp;</div></li><li><div>                $email = $modelEmail-&gt;getOne(false, array(&quot;email_id&quot; =&gt; $_REQUEST['emailId']));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if (!isset($email['params']['quickselection']) or empty($email['params']['quickselection']))&nbsp;</div></li><li><div>                    return array();&nbsp;</div></li><li><div>                return $email['params']['quickselection'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function welcome_new($data) {&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                    &lt;div id=&quot;update-page&quot; class=&quot;about-wrap mpoet-page&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;h1&gt;&lt;?php echo sprintf(__('Welcome to %1$s', WYSIJA), '&lt;span class=&quot;version&quot;&gt;MailPoet '.WYSIJA::get_version()).&quot;&lt;/span&gt;&quot;; ?&gt;&lt;/h1&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;div class=&quot;about-text&quot;&gt;&lt;?php echo $data['abouttext'] ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                        foreach ($data['sections'] as $section) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            $link_hide = $class_added = '';&nbsp;</div></li><li><div>                            if (isset($section['hidelink'])) {&nbsp;</div></li><li><div>                                $link_hide = ' &lt;span class=&quot;ctaupdate&quot;&gt;-&lt;/span&gt; ' . $section['hidelink'];&nbsp;</div></li><li><div>                                $class_added = ' removeme';&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        ?&gt;&nbsp;</div></li><li><div>                                &lt;div class=&quot;changelog &lt;?php echo $class_added ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                                    &lt;h2&gt;&lt;?php echo $section['title'] . $link_hide ?&gt;&lt;/h2&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                    &lt;div class=&quot;feature-section &lt;?php echo $section['format'] ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                                        &lt;?php&nbsp;</div></li><li><div>                                        switch ($section['format']) {&nbsp;</div></li><li><div>                                            case 'three-col':&nbsp;</div></li><li><div>                                                if(true) {&nbsp;</div></li><li><div>                                                    foreach ($section['cols'] as $col) {&nbsp;</div></li><li><div>                                                        ?&gt;&nbsp;</div></li><li><div>                                                        &lt;div&gt;&nbsp;</div></li><li><div>                                                            &lt;h4&gt;&lt;?php echo $col['title'] ?&gt;&lt;/h4&gt;&nbsp;</div></li><li><div>                                                            &lt;p&gt;&lt;?php echo $col['content'] ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                                                        &lt;/div&gt;&nbsp;</div></li><li><div>                                                        &lt;?php&nbsp;</div></li><li><div>                                                    }&nbsp;</div></li><li><div>                                                }else{&nbsp;</div></li><li><div>                                                    $quick_html_helper = WYSIJA::get('quick_html', 'helper');&nbsp;</div></li><li><div>                                                    echo $quick_html_helper-&gt;three_arguments($section['cols']);&nbsp;</div></li><li><div>                                                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                                break;&nbsp;</div></li><li><div>                                            case 'bullets':&nbsp;</div></li><li><div>                                                echo '&lt;ul&gt;';&nbsp;</div></li><li><div>                                                foreach ($section['paragraphs'] as $line) {&nbsp;</div></li><li><div>                                                    ?&gt;&nbsp;</div></li><li><div>                                                    &lt;li&gt;&lt;?php echo $line ?&gt;&lt;/li&gt;&nbsp;</div></li><li><div>                                                    &lt;?php&nbsp;</div></li><li><div>                                                }&nbsp;</div></li><li><div>                                                echo '&lt;/ul&gt;';&nbsp;</div></li><li><div>                                                break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            default :&nbsp;</div></li><li><div>                                                foreach ($section['paragraphs'] as $line) {&nbsp;</div></li><li><div>                                                    echo '&lt;p&gt;'.$line.'&lt;/p&gt;';&nbsp;</div></li><li><div>                                                }&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>                                        ?&gt;&nbsp;</div></li><li><div>                                    &lt;/div&gt;&nbsp;</div></li><li><div>                                &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;a class=&quot;button-primary&quot; href=&quot;admin.php?page=wysija_campaigns&quot;&gt;&lt;?php _e('Thanks! Now take me to MailPoet.', WYSIJA); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function whats_new($data) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $helper_readme = WYSIJA::get('readme', 'helper');&nbsp;</div></li><li><div>                $helper_readme-&gt;scan();&nbsp;</div></li><li><div>                $helper_licence = WYSIJA::get('licence', 'helper');&nbsp;</div></li><li><div>                                $model_config = WYSIJA::get('config', 'model');&nbsp;</div></li><li><div>                $data = array();&nbsp;</div></li><li><div>                //&nbsp;</div></li><li><div>&nbsp;&nbsp;</div></li><li><div>                                $installed_time = (int)$model_config-&gt;getValue('installed_time');&nbsp;</div></li><li><div>                                $usage =  time() - $installed_time;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                $helper_toolbox = WYSIJA::get('toolbox', 'helper');&nbsp;</div></li><li><div>                                $usage_string = $helper_toolbox-&gt;duration_string($usage, true, 1);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                $onemonth = 3600*24*31;&nbsp;</div></li><li><div>                                $twomonths = 3600*24*62;&nbsp;</div></li><li><div>                                $year = 3600*24*365;&nbsp;</div></li><li><div>                                if( $usage &gt; $twomonths) {&nbsp;</div></li><li><div>                                    $data['abouttext'] = sprintf(__('You have been a MailPoet user for %s.', WYSIJA), '&lt;strong&gt;'.trim($usage_string).'&lt;/strong&gt;');&nbsp;</div></li><li><div>                                     if( $usage &gt; $twomonths) {&nbsp;</div></li><li><div>                                         $data['abouttext'] .= '&lt;br/&gt;'.__( 'Wow! Thanks for being part of our community for so long.' , WYSIJA ) ;&nbsp;</div></li><li><div>                                     }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                }else{&nbsp;</div></li><li><div>                                    $data['abouttext'] = __('You updated! It\'s like having the next gadget, but better.', WYSIJA);&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // this is a flag to have a pretty clean update page where teh only call to action is our survey&nbsp;</div></li><li><div>                $show_survey = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $is_multisite = is_multisite();&nbsp;</div></li><li><div>                $is_network_admin = WYSIJA::current_user_can('manage_network');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ($is_multisite) {&nbsp;</div></li><li><div>                    if ($is_network_admin) {&nbsp;</div></li><li><div>                        $model_config-&gt;save(array('ms_wysija_whats_new' =&gt; WYSIJA::get_version()));&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $model_config-&gt;save(array('wysija_whats_new' =&gt; WYSIJA::get_version()));&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                $sharing_data = $model_config-&gt;getValue('analytics');&nbsp;</div></li><li><div>                                if( empty( $sharing_data ) ) {&nbsp;</div></li><li><div>                                    $data['sections'][] = array(&nbsp;</div></li><li><div>                                            'title' =&gt; __('One quick question...', WYSIJA), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            'content' =&gt; '&lt;div class=&quot;feature-section&quot;&gt;&lt;iframe frameborder=&quot;0&quot; width=&quot;100%&quot; height=&quot;370&quot; scrolling=&quot;auto&quot; allowtransparency=&quot;true&quot; src=&quot;//mailpoet.polldaddy.com/s/what-s-new-sept-2015?iframe=1&quot;&gt;&lt;a href=&quot;//mailpoet.polldaddy.com/s/what-s-new-sept-2015&quot;&gt;View Survey&lt;/a&gt;&lt;/iframe&gt;&lt;/div&gt;'.&nbsp;</div></li><li><div>                                             '&lt;div class=&quot;mpoet-update-subscribe&quot; &gt;&lt;h4&gt;'.__( 'Subscribe to our newsletters', WYSIJA ).'&lt;/h4&gt;&lt;div class=&quot;mpoet-update-subscribe-left&quot;&gt; &lt;p&gt;'.__('We send a monthly newsletter with the following:', WYSIJA).'&lt;/p&gt;' .&nbsp;</div></li><li><div>                                                                                                    '&lt;ul&gt;' .&nbsp;</div></li><li><div>                                                                                                            '&lt;li&gt;'.__('Important plugin updates', WYSIJA).'&lt;/li&gt;' .&nbsp;</div></li><li><div>                                                                                                            '&lt;li&gt;'.__('Coupons', WYSIJA).'&lt;/li&gt;' .&nbsp;</div></li><li><div>                                                                                                            '&lt;li&gt;'.__('Tips for you, or your customers', WYSIJA).'&lt;/li&gt;' .&nbsp;</div></li><li><div>                                                                                                            '&lt;li&gt;'.__('What we*re working on', WYSIJA).'&lt;/li&gt;' .&nbsp;</div></li><li><div>                                                                                                            '&lt;li&gt;'.__('News from us, the team', WYSIJA).'&lt;/li&gt;' .&nbsp;</div></li><li><div>                                                                                                    '&lt;/ul&gt;&nbsp;</div></li><li><div>                                                                                                     &lt;p&gt;View an &lt;a target=&quot;_blank&quot; href=&quot;http://www.mailpoet.com/?wysija-page=1&controller=email&action=view&email_id=1181&wysijap=subscriptions-3&quot;&gt;an example blog post email&lt;/a&gt; and &lt;a target=&quot;_blank&quot; href=&quot;http://www.mailpoet.com/?wysija-page=1&controller=email&action=view&email_id=64&wysijap=subscriptions-2&quot;&gt;an example newsletter&lt;/a&gt;.&lt;/p&gt;&nbsp;</div></li><li><div>                                                                                                        &lt;/div&gt;' .&nbsp;</div></li><li><div>                                                                                            '&lt;div class=&quot;mpoet-update-subscribe-right&quot;&gt;' .&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                                                                            '&lt;iframe width=&quot;380&quot; scrolling=&quot;no&quot; frameborder=&quot;0&quot; src=&quot;http://www.mailpoet.com/?wysija-page=1&controller=subscribers&action=wysija_outter&wysija_form=5&external_site=1&wysijap=subscriptions-3&quot; class=&quot;iframe-wysija&quot; vspace=&quot;0&quot; tabindex=&quot;0&quot; style=&quot;position: static; top: 0pt; margin: 0px; border-style: none; height: 180px; left: 0pt; visibility: visible; background-color: #f1f1f1!important;&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; hspace=&quot;0&quot; allowtransparency=&quot;true&quot; title=&quot;Subscription Wysija&quot;&gt;&lt;/iframe&gt;&nbsp;</div></li><li><div>                                                                                                &lt;/div&gt;&nbsp;</div></li><li><div>                                                                                                &lt;div style=&quot;clear:both;&quot;&gt;&lt;/div&gt;', &nbsp;</div></li><li><div>                                            'format' =&gt; 'title-content', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $msg = $model_config-&gt;getValue('ignore_msgs');&nbsp;</div></li><li><div>                if ( !isset($msg['ctaupdate']) && $show_survey === false ) {&nbsp;</div></li><li><div>                    $data['sections'][] = array(&nbsp;</div></li><li><div>                        'title' =&gt; __('Keep this plugin essentially free', WYSIJA), &nbsp;</div></li><li><div>                        'review' =&gt; array(&nbsp;</div></li><li><div>                            'title' =&gt; '1. ' . __('Love kittens?', WYSIJA) . ' ' . __('We love stars...', WYSIJA), &nbsp;</div></li><li><div>                            'content' =&gt; str_replace(&nbsp;</div></li><li><div>                                    array('[link]', '[/link]'), array('&lt;a href=&quot;http://goo.gl/D52CBL&quot; target=&quot;_blank&quot; title=&quot;On wordpress.org&quot;&gt;', '&lt;/a&gt;'), __('Each time one of our users forgets to write a review, a kitten dies. It\'s sad and breaks our hearts. [link]Add your own review[/link] and save a kitten today.', WYSIJA))&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                        'follow' =&gt; array(&nbsp;</div></li><li><div>                            'title' =&gt; '2. ' . __('Follow us and don\'t miss anything!', WYSIJA), &nbsp;</div></li><li><div>                            'content' =&gt; $this-&gt;_get_social_buttons(false)&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                        'hidelink' =&gt; '&lt;a class=&quot;linkignore ctaupdate&quot; href=&quot;javascript:;&quot;&gt;' . __('Hide!', WYSIJA) . '&lt;/a&gt;', &nbsp;</div></li><li><div>                        'format' =&gt; 'review-follow', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                if( $show_survey ) {&nbsp;</div></li><li><div>                                    $data['sections'][] = array(&nbsp;</div></li><li><div>                        'title' =&gt; 'Answer our survey and make your plugin better', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        'content' =&gt; '&lt;iframe frameborder=&quot;0&quot; width=&quot;100%&quot; height=&quot;600&quot; scrolling=&quot;auto&quot; allowtransparency=&quot;true&quot; src=&quot;//mailpoet.polldaddy.com/s/what-s-new-sept-2015?iframe=1&quot;&gt;&lt;a href=&quot;//mailpoet.polldaddy.com/s/what-s-new-sept-2015&quot;&gt;View Survey&lt;/a&gt;&lt;/iframe&gt;&lt;hr/&gt;', &nbsp;</div></li><li><div>                        'format' =&gt; 'title-content', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if (isset($helper_readme-&gt;changelog[WYSIJA::get_version()])) {&nbsp;</div></li><li><div>                    $data['sections'][] = array(&nbsp;</div></li><li><div>                        'title' =&gt; __('Change log', WYSIJA), &nbsp;</div></li><li><div>                        'format' =&gt; 'bullets', &nbsp;</div></li><li><div>                        'paragraphs' =&gt; $helper_readme-&gt;changelog[WYSIJA::get_version()]&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                &lt;div id=&quot;update-page&quot; class=&quot;about-wrap mpoet-page&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;h1&gt;&lt;?php echo sprintf(__('You\'ve updated to %1$s', WYSIJA), '&lt;span class=&quot;version&quot;&gt;MailPoet '.WYSIJA::get_version()).&quot;&lt;/span&gt;&quot;; ?&gt;&lt;/h1&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;div class=&quot;about-text&quot;&gt;&lt;?php echo $data['abouttext'] ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                    foreach ($data['sections'] as $section) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        $link_hide = $class_added = '';&nbsp;</div></li><li><div>                        if (isset($section['hidelink'])) {&nbsp;</div></li><li><div>                            $link_hide = ' &lt;span class=&quot;ctaupdate&quot;&gt;-&lt;/span&gt; ' . $section['hidelink'];&nbsp;</div></li><li><div>                            $class_added = ' removeme';&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                    ?&gt;&nbsp;</div></li><li><div>                            &lt;div class=&quot;changelog &lt;?php echo $class_added ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                                &lt;h2&gt;&lt;?php echo $section['title'] . $link_hide ?&gt;&lt;/h2&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                &lt;div class=&quot;feature-section &lt;?php echo $section['format'] ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                                    &lt;?php&nbsp;</div></li><li><div>                                    switch ($section['format']) {&nbsp;</div></li><li><div>                                        case 'title-content':&nbsp;</div></li><li><div>                                            ?&gt;&nbsp;</div></li><li><div>                                            &lt;div&gt;&nbsp;</div></li><li><div>                                                &lt;?php echo $section['content'] ?&gt;&nbsp;</div></li><li><div>                                            &lt;/div&gt;&nbsp;</div></li><li><div>                                            &lt;?php&nbsp;</div></li><li><div>                                            break;&nbsp;</div></li><li><div>                                        case 'three-col':&nbsp;</div></li><li><div>                                            if(isset($section['content'])) {&nbsp;</div></li><li><div>                                                foreach ($section['cols'] as $col) {&nbsp;</div></li><li><div>                                                    ?&gt;&nbsp;</div></li><li><div>                                                    &lt;div&gt;&nbsp;</div></li><li><div>                                                        &lt;h4&gt;&lt;?php echo $col['title'] ?&gt;&lt;/h4&gt;&nbsp;</div></li><li><div>                                                        &lt;p&gt;&lt;?php echo $col['content'] ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                                                    &lt;/div&gt;&nbsp;</div></li><li><div>                                                    &lt;?php&nbsp;</div></li><li><div>                                                }&nbsp;</div></li><li><div>                                            }else{&nbsp;</div></li><li><div>                                                $quick_html_helper = WYSIJA::get('quick_html', 'helper');&nbsp;</div></li><li><div>                                                echo $quick_html_helper-&gt;three_arguments($section['cols']);&nbsp;</div></li><li><div>                                            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            break;&nbsp;</div></li><li><div>                                        case 'bullets':&nbsp;</div></li><li><div>                                            echo '&lt;ul&gt;';&nbsp;</div></li><li><div>                                            foreach ($section['paragraphs'] as $line) {&nbsp;</div></li><li><div>                                                ?&gt;&nbsp;</div></li><li><div>                                                &lt;li&gt;&lt;?php echo $line ?&gt;&lt;/li&gt;&nbsp;</div></li><li><div>                                                &lt;?php&nbsp;</div></li><li><div>                                            }&nbsp;</div></li><li><div>                                            echo '&lt;/ul&gt;';&nbsp;</div></li><li><div>                                            break;&nbsp;</div></li><li><div>                                    case 'review-follow':&nbsp;</div></li><li><div>                                            $class_review_kitten = ' small';&nbsp;</div></li><li><div>                                            $count_title = count(str_split($section['review']['title']));&nbsp;</div></li><li><div>                                            $count_content = count(str_split($section['review']['content']));&nbsp;</div></li><li><div>                                            if ($count_title &gt; 40 || $count_content &gt; 340)&nbsp;</div></li><li><div>                                                $class_review_kitten = ' medium';&nbsp;</div></li><li><div>                                            if ($count_title &gt; 50 || $count_content &gt; 400)&nbsp;</div></li><li><div>                                                $class_review_kitten = ' large';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            echo '&lt;div id=&quot;review-follow&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            echo '&lt;div class=&quot;review-left' . $class_review_kitten . '&quot;&gt;';&nbsp;</div></li><li><div>                                            echo '&lt;div class=&quot;description&quot;&gt;&lt;h4&gt;' . $section['review']['title'] . '&lt;/h4&gt;';&nbsp;</div></li><li><div>                                            echo '&lt;p&gt;' . $section['review']['content'] . '&lt;/p&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>                                            echo '&lt;a title=&quot;On wordpress.org&quot; target=&quot;_blank&quot; class=&quot;link-cat-review&quot; href=&quot;http://goo.gl/P0r5Fc&quot;&gt; &lt;/a&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            echo '&lt;div class=&quot;review-right&quot;&gt;';&nbsp;</div></li><li><div>                                            echo '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            echo '&lt;div class=&quot;subscribe-middle' . $class_review_kitten . '&quot;&gt;';&nbsp;</div></li><li><div>                                            echo '&lt;div class=&quot;description&quot; &gt;&lt;h4&gt;' . $section['follow']['title'] . '&lt;/h4&gt;';&nbsp;</div></li><li><div>                                            echo '&lt;div class=&quot;socials&quot;&gt;' . $section['follow']['content'] . '&lt;/div&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>                                            echo '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            $class_name = 'follow-right';&nbsp;</div></li><li><div>                                            if(version_compare(get_bloginfo('version'), '3.8')&gt;= 0) {&nbsp;</div></li><li><div>                                                $class_name .= '38';&nbsp;</div></li><li><div>                                            }&nbsp;</div></li><li><div>                                            echo '&lt;div class=&quot;'.$class_name.'&quot;&gt;';&nbsp;</div></li><li><div>                                            echo '&lt;/div&gt;';&nbsp;</div></li><li><div>                                            echo '&lt;/div&gt;';&nbsp;</div></li><li><div>                                            break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        default :&nbsp;</div></li><li><div>                                            foreach ($section['paragraphs'] as $line) {&nbsp;</div></li><li><div>                                                ?&gt;&nbsp;</div></li><li><div>                                                &lt;p&gt;&lt;?php echo $line ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                            &lt;?php&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                                &lt;/div&gt;&nbsp;</div></li><li><div>                            &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>                $link_class = 'button-primary';&nbsp;</div></li><li><div>                if($show_survey) {&nbsp;</div></li><li><div>                    $link_class = 'button-secondary';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;a class=&quot;&lt;?php echo $link_class ?&gt;&quot; href=&quot;admin.php?page=wysija_campaigns&quot;&gt;&lt;?php _e('Thanks! Now take me to MailPoet.', WYSIJA); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * poll section, we inject one section in the $data object if a poll is available&nbsp;</div></li><li><div>     * @param array $data&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function _inject_poll( $data ) {&nbsp;</div></li><li><div>        $polls_available = array( '7970424' ); // all polls' ids from polldaddy&nbsp;</div></li><li><div>        $display_poll = 0; // poll id to display&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $model_config = WYSIJA::get( 'config' , 'model' );&nbsp;</div></li><li><div>        $polls_already_viewed = $model_config-&gt;getValue('viewed_polls');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // we go through all of the viewed polls in order to find one that has not been viewed yet&nbsp;</div></li><li><div>        if( !empty($polls_already_viewed) ) {&nbsp;</div></li><li><div>            foreach( $polls_available as $poll_id ) {&nbsp;</div></li><li><div>                if( !in_array( $poll_id , $polls_already_viewed )) {&nbsp;</div></li><li><div>                    $display_poll = $poll_id;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }else{&nbsp;</div></li><li><div>            // no poll has been viewed yet, let's display the first one&nbsp;</div></li><li><div>            $display_poll = $polls_available[0];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // only if we found a poll which has not been viewed yet, will we display it&nbsp;</div></li><li><div>        if( $display_poll &gt; 0 ) {&nbsp;</div></li><li><div>            $data['sections'][] = array(&nbsp;</div></li><li><div>                'title' =&gt; __('Hey! We have a quick question for you:', WYSIJA), &nbsp;</div></li><li><div>                'paragraphs' =&gt; array(&nbsp;</div></li><li><div>                    'line1' =&gt; '&lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot; src=&quot;https://secure.polldaddy.com/p/'.$display_poll.'.js&quot;&gt;&lt;/script&gt;&nbsp;</div></li><li><div>                        &lt;noscript&gt;&nbsp;</div></li><li><div>                            &lt;a href=&quot;https://polldaddy.com/poll/'.$display_poll.'/&quot;&gt;'.__('Hey! We have a quick question for you:', WYSIJA).'&lt;/a&gt;&nbsp;</div></li><li><div>                        &lt;/noscript&gt;'&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                'format' =&gt; 'paragraphs'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $polls_already_viewed[] = $display_poll;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // save the new array of viewed polls&nbsp;</div></li><li><div>            $model_config-&gt;save( array( 'viewed_polls' =&gt; $polls_already_viewed ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // returning the new data array&nbsp;</div></li><li><div>        return $data;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    private function _get_social_buttons($inline=true) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>         if($inline) {&nbsp;</div></li><li><div>             $class=' class=&quot;socials removeme&quot;';&nbsp;</div></li><li><div>         }else{&nbsp;</div></li><li><div>             $class=' id=&quot;socials-block&quot;';&nbsp;</div></li><li><div>         }&nbsp;</div></li><li><div>         $wysijaversion='&lt;div '.$class.'&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;fb&quot; &gt;&nbsp;</div></li><li><div>        &lt;div id=&quot;fb-root&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;script&gt;(function(d, s, id) {&nbsp;</div></li><li><div>          var js, fjs = d.getElementsByTagName(s)[0];&nbsp;</div></li><li><div>          if (d.getElementById(id)) return;&nbsp;</div></li><li><div>          js = d.createElement(s); js.id = id;&nbsp;</div></li><li><div>          js.src = &quot;//connect.facebook.net/en_US/all.js#xfbml=1&quot;;&nbsp;</div></li><li><div>          fjs.parentNode.insertBefore(js, fjs);&nbsp;</div></li><li><div>        }(document, \'script\', \'facebook-jssdk\'));&lt;/script&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;fb-like&quot; data-href=&quot;http://www.facebook.com/mailpoetplugin&quot; data-send=&quot;false&quot; data-layout=&quot;button_count&quot; data-width=&quot;90&quot; data-show-faces=&quot;false&quot;&gt;&lt;/div&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;twitter&quot;&gt;&nbsp;</div></li><li><div>        &lt;a href=&quot;https://twitter.com/mail_poet&quot; class=&quot;twitter-follow-button&quot; data-show-count=&quot;true&quot; data-show-screen-name=&quot;false&quot;&gt;Follow us&lt;/a&gt;&nbsp;</div></li><li><div>        &lt;script&gt;!function(d, s, id) {var js, fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)) {js=d.createElement(s);js.id=id;js.src=&quot;//platform.twitter.com/widgets.js&quot;;fjs.parentNode.insertBefore(js, fjs);}}(document, &quot;script&quot;, &quot;twitter-wjs&quot;);&lt;/script&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;gplus&quot;&gt;&nbsp;</div></li><li><div>        &lt;!-- Place this tag in your head or just before your close body tag --&gt;&nbsp;</div></li><li><div>        &lt;script type=&quot;text/javascript&quot; src=&quot;https://apis.google.com/js/plusone.js&quot;&gt;&lt;/script&gt;&nbsp;</div></li><li><div>        &lt;!-- Place this tag where you want the +1 button to render --&gt;&nbsp;</div></li><li><div>        &lt;g:plusone href=&quot;https://plus.google.com/104749849451537343615&quot; size=&quot;medium&quot;&gt;&lt;/g:plusone&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        ';&nbsp;</div></li><li><div>         if($inline) $wysijaversion.='&lt;div id=&quot;hidesocials&quot;&gt;&nbsp;</div></li><li><div>        &lt;a class=&quot;linkignore socialfoot&quot; href=&quot;javascript:;&quot;&gt;'.__('Hide!', WYSIJA).'&lt;/a&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;';&nbsp;</div></li><li><div>            $wysijaversion.= &quot;&lt;div style='clear:both;'&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style='clear:both;'&gt;&lt;/div&gt;&quot;;&nbsp;</div></li><li><div>            return $wysijaversion;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 2.7.1</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/classes/wysija_view_back_campaigns/" class="active">2.7.5</a></li><li><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.4/classes/wysija_view_back_campaigns/" class="">2.7.4</a></li><li><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.3/classes/wysija_view_back_campaigns/" class="">2.7.3</a></li><li><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.2/classes/wysija_view_back_campaigns/" class="">2.7.2</a></li><li><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.1/classes/wysija_view_back_campaigns/" class="">2.7.1</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>WYSIJA_view_back_campaigns</li><li><span></span>MailPoet Newsletters</li><li><span></span>2.7.5</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>