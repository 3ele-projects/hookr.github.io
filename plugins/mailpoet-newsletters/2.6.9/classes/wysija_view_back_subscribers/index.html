<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="2.7.5" data-slug="mailpoet-newsletters" data-type="class" data-id="55881"><head xmlns="http://www.w3.org/1999/xhtml"><title> wysija_view_back_subscribers | class | Mailpoet Newsletters | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="WYSIJA_view_back_subscribers, class, plugin, mailpoet-newsletters, 2.7.5" /><meta name="description" content="The MailPoet Newsletters WYSIJA view back subscribers class." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.10"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=ed055004643ce627590ab2281b1d70ef' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.10' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/wysija_view_back_subscribers/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fwysija_view_back_subscribers%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fwysija_view_back_subscribers%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-mailpoet-newsletters-2.7.5-class-wysija_view_back_subscribers","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="wysija_view_back_subscribers" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to mailpoet-newsletters." href="http://hookr.io/plugins/mailpoet-newsletters/" class="plugin"><span property="name">mailpoet-newsletters</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.7.5." href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/" class="H_VERSION"><span property="name">2.7.5</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">wysija_view_back_subscribers</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="299"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/all/" title="All">All <span class="count badge">299</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="104"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/hooks/" title="Hooks">Hooks <span class="count badge">104</span></a></li><li class="" data-id="action" data-count="30"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/actions/" title="Actions">Actions <span class="count badge">30</span></a></li><li class="" data-id="filter" data-count="74"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/filters/" title="Filters">Filters <span class="count badge">74</span></a></li><li class="active" data-id="class" data-count="132"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/classes/" title="Classes">Classes <span class="count badge">132</span></a></li><li class="" data-id="constant" data-count="52"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/constants/" title="Constants">Constants <span class="count badge">52</span></a></li><li class="" data-id="function" data-count="8"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/functions/" title="Functions">Functions <span class="count badge">8</span></a></li><li class="" data-id="shortcode" data-count="3"><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">3</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>WYSIJA_view_back_subscribers</strong></h1><p>The MailPoet Newsletters <strong>WYSIJA view back subscribers</strong> class.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/files/views-back-subscribers/" class="file">/views/back/subscribers.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="4" class="block" start="4"><li><div>class WYSIJA_view_back_subscribers extends WYSIJA_view_back&nbsp;</div></li><li><div>{&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    var $icon = &quot;icon-users&quot;;&nbsp;</div></li><li><div>    var $column_action_list = &quot;email&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function __construct()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    $this-&gt;title = __(&quot;Lists and Subscribers&quot;, WYSIJA);&nbsp;</div></li><li><div>    parent::__construct();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    $this-&gt;search = array(&quot;title&quot; =&gt; __(&quot;Search subscribers&quot;, WYSIJA));&nbsp;</div></li><li><div>    $this-&gt;column_actions = array('editlist' =&gt; __('Edit', WYSIJA), 'duplicatelist' =&gt; __('Duplicate', WYSIJA), 'deletelist' =&gt; __('Delete', WYSIJA));&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function main($data)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        echo '&lt;form method=&quot;post&quot; action=&quot;#currentform&quot; id=&quot;posts-filter&quot;&gt;';&nbsp;</div></li><li><div>    $this-&gt;filtersLink($data);&nbsp;</div></li><li><div>    $this-&gt;filterDDP($data);&nbsp;</div></li><li><div>    $this-&gt;listing($data);&nbsp;</div></li><li><div>    $this-&gt;limitPerPage();&nbsp;</div></li><li><div>    echo '&lt;/form&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function menuTop($case = false) {&nbsp;</div></li><li><div>        if (!$case)&nbsp;</div></li><li><div>            $case = $this-&gt;menuTop;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $arrayTrans = array(&quot;backtolist&quot; =&gt; __(&quot;Back to lists&quot;, WYSIJA), &quot;back&quot; =&gt; __(&quot;Back&quot;, WYSIJA), &quot;add&quot; =&gt; __('Add Subscriber', WYSIJA), &quot;addlist&quot; =&gt; __('Add List', WYSIJA), &quot;lists&quot; =&gt; __('Edit Lists', WYSIJA), &quot;import&quot; =&gt; __('Import', WYSIJA), &quot;export&quot; =&gt; __('Export', WYSIJA));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        switch ($case) {&nbsp;</div></li><li><div>            case &quot;add&quot;:&nbsp;</div></li><li><div>            case &quot;edit&quot;:&nbsp;</div></li><li><div>            case &quot;export&quot;:&nbsp;</div></li><li><div>            case &quot;import&quot;:&nbsp;</div></li><li><div>            case &quot;addlist&quot;:&nbsp;</div></li><li><div>            case &quot;editlist&quot;:&nbsp;</div></li><li><div>            default:&nbsp;</div></li><li><div>            $arrayMenus = array(&quot;add&quot;, &quot;addlist&quot;, &quot;lists&quot;, &quot;import&quot;, &quot;export&quot;);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $html = &quot;&quot;;&nbsp;</div></li><li><div>        $classes = function_exists('wp_star_rating') ? 'add-new-h2' : 'button-secondary2';&nbsp;</div></li><li><div>        foreach ($arrayMenus as $action) {&nbsp;</div></li><li><div>            if (isset($_GET['action']) && $_GET['action'] == $action)&nbsp;</div></li><li><div>            continue; // Skip printing the list if we are in this action already&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $html.= '&lt;a href=&quot;admin.php?page=wysija_subscribers&action='.$action.'&quot; class=&quot;'.$classes.'&quot;&gt;'.$arrayTrans[$action].'&lt;/a&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $html;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function filterDDP($data)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>    &lt;ul class=&quot;subsubsub&quot;&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        $total = count($data['counts']);&nbsp;</div></li><li><div>        $i = 1;&nbsp;</div></li><li><div>        foreach ($data['counts'] as $countType =&gt; $count)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>        if (!$count)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            continue;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        switch ($countType)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            case 'all':&nbsp;</div></li><li><div>            $tradText = __('All', WYSIJA);&nbsp;</div></li><li><div>            break;&nbsp;</div></li><li><div>            case 'unconfirmed':&nbsp;</div></li><li><div>            $tradText = __('Unconfirmed', WYSIJA);&nbsp;</div></li><li><div>            break;&nbsp;</div></li><li><div>            case 'unsubscribed':&nbsp;</div></li><li><div>            $tradText = __('Unsubscribed', WYSIJA);&nbsp;</div></li><li><div>            break;&nbsp;</div></li><li><div>            case 'subscribed':&nbsp;</div></li><li><div>            $tradText = __('Subscribed', WYSIJA);&nbsp;</div></li><li><div>            break;&nbsp;</div></li><li><div>            case 'unlisted':&nbsp;</div></li><li><div>            $tradText = __('Unlisted', WYSIJA);&nbsp;</div></li><li><div>            break;&nbsp;</div></li><li><div>            case 'inactive':&nbsp;</div></li><li><div>            $tradText = __('Never opened or clicked', WYSIJA);&nbsp;</div></li><li><div>            break;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $classcurrent = '';&nbsp;</div></li><li><div>        $radio_checked = '';&nbsp;</div></li><li><div>        if ((isset($_REQUEST['link_filter']) && $_REQUEST['link_filter'] == $countType) || ($countType == 'all' && !isset($_REQUEST['link_filter'])))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $classcurrent = 'class=&quot;current&quot;';&nbsp;</div></li><li><div>            $radio_checked = 'checked=&quot;checked&quot;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ($i &gt; 1)&nbsp;</div></li><li><div>            echo ' | ';&nbsp;</div></li><li><div>        echo '&lt;li&gt;&lt;a '.$classcurrent.' href=&quot;admin.php?page=wysija_subscribers&link_filter='.$countType.'&quot;&gt;'.$tradText.' &lt;span class=&quot;count&quot;&gt;('.$count.')&lt;/span&gt;&lt;/a&gt;';&nbsp;</div></li><li><div>        echo '&lt;input type=&quot;radio&quot; name=&quot;wysija[filter][link_filter]&quot; id=&quot;link_filter_'.$countType.'&quot; value=&quot;'.$countType.'&quot; '.$radio_checked.' style=&quot;display:none;&quot;/&gt;';&nbsp;</div></li><li><div>        echo '&lt;/li&gt;';&nbsp;</div></li><li><div>        $i++;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>    &lt;/ul&gt;&nbsp;</div></li><li><div>    &lt;?php $this-&gt;searchBox(); ?&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    $action_locale = array(&nbsp;</div></li><li><div>            'delete' =&gt; __('Delete this subscriber forever?', WYSIJA), &nbsp;</div></li><li><div>            'delete_bulk' =&gt; __('Delete these subscribers forever?', WYSIJA)&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>    &lt;div class=&quot;tablenav&quot;&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;alignleft actions&quot;&gt;&nbsp;</div></li><li><div>        &lt;select name=&quot;method&quot; class=&quot;global-action&quot; data-locale='&lt;?php echo json_encode($action_locale); ?&gt;'&gt;&nbsp;</div></li><li><div>            &lt;option selected=&quot;selected&quot; value=&quot;&quot;&gt;&lt;?php _e('Bulk Actions', WYSIJA); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>            &lt;option value=&quot;&quot;&gt;&lt;?php _e('Move to list', WYSIJA); ?&gt;...&lt;/option&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>            foreach ($data['lists'] as $listK =&gt; $list)&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>            //if(!(isset($_REQUEST['filter-list']) && $_REQUEST['filter-list']== $listK) && $list['is_enabled']) { // Commented by TNT&nbsp;</div></li><li><div>            if ($list['is_enabled'])&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                ?&gt;&lt;option value=&quot;actionvar_movetolist-listid_&lt;?php echo $listK ?&gt;&quot; data-nonce=&quot;&lt;?php echo $this-&gt;secure(array('action' =&gt; &quot;actionvar_movetolist-listid_&quot; . $listK), true)?&gt;&quot;&gt;&lt;?php&nbsp;</div></li><li><div>                echo str_repeat('&nbsp;', 5).$list['name'];&nbsp;</div></li><li><div>                if (isset($list['users']))&nbsp;</div></li><li><div>                    echo ' ('.$list['users'].')';&nbsp;</div></li><li><div>                ?&gt;&lt;/option&gt;&lt;?php&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>            &lt;option value=&quot;&quot;&gt;&lt;?php _e('Add to list', WYSIJA); ?&gt;...&lt;/option&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>            foreach ($data['lists'] as $listK =&gt; $list)&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>            //if(!(isset($_REQUEST['filter-list']) && $_REQUEST['filter-list']== $listK) && $list['is_enabled']) { // Commented by TNT&nbsp;</div></li><li><div>            if ($list['is_enabled'])&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                ?&gt;&lt;option value=&quot;actionvar_copytolist-listid_&lt;?php echo $listK ?&gt;&quot; data-nonce=&quot;&lt;?php echo $this-&gt;secure(array('action' =&gt; &quot;actionvar_copytolist-listid_&quot; . $listK), true)?&gt;&quot;&gt;&lt;?php&nbsp;</div></li><li><div>                echo str_repeat('&nbsp;', 5).$list['name'];&nbsp;</div></li><li><div>                if (isset($list['users']))&nbsp;</div></li><li><div>                    echo ' ('.$list['users'].')';&nbsp;</div></li><li><div>                ?&gt;&lt;/option&gt;&lt;?php&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>            &lt;option value=&quot;&quot;&gt;&lt;?php _e('Remove from list', WYSIJA); ?&gt;...&lt;/option&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>            foreach ($data['lists'] as $listK =&gt; $list)&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>            //if(!(isset($_REQUEST['filter-list']) && $_REQUEST['filter-list']== $listK) && $list['is_enabled']) { // Commented by TNT&nbsp;</div></li><li><div>            if ($list['is_enabled'])&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                ?&gt;&lt;option value=&quot;actionvar_removefromlist-listid_&lt;?php echo $listK ?&gt;&quot; data-nonce=&quot;&lt;?php echo $this-&gt;secure(array('action' =&gt; &quot;actionvar_removefromlist-listid_&quot; . $listK), true)?&gt;&quot;&gt;&lt;?php&nbsp;</div></li><li><div>                echo str_repeat('&nbsp;', 5).$list['name'];&nbsp;</div></li><li><div>                if (isset($list['users']))&nbsp;</div></li><li><div>                echo ' ('.$list['users'].')';&nbsp;</div></li><li><div>                ?&gt;&lt;/option&gt;&lt;?php&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>            &lt;option value=&quot;actionvar_removefromalllists&quot; data-nonce=&quot;&lt;?php echo $this-&gt;secure(array('action' =&gt; &quot;actionvar_removefromalllists&quot; ), true)?&gt;&quot;&gt;&lt;?php _e('Remove from all lists', WYSIJA); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>            &lt;option value=&quot;exportlist&quot; data-nonce=&quot;&lt;?php echo $this-&gt;secure(array('action' =&gt; &quot;exportlist&quot; ), true)?&gt;&quot;&gt;&lt;?php _e('Export', WYSIJA); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>            &lt;option value=&quot;deleteusers&quot; data-nonce=&quot;&lt;?php echo $this-&gt;secure(array('action' =&gt; &quot;deleteusers&quot; ), true)?&gt;&quot;&gt;&lt;?php _e('Delete subscribers', WYSIJA); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>            $config_model = WYSIJA::get('config', 'model');&nbsp;</div></li><li><div>            $confirm_dbleoptin = $config_model-&gt;getValue('confirm_dbleoptin');&nbsp;</div></li><li><div>            if ($confirm_dbleoptin)&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>                &lt;option value=&quot;actionvar_confirmusers&quot; data-nonce=&quot;&lt;?php echo $this-&gt;secure(array('action' =&gt; &quot;actionvar_confirmusers&quot; ), true)?&gt;&quot;&gt;&lt;?php _e('Confirm unconfirmed subscribers', WYSIJA); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                &lt;option value=&quot;actionvar_resendconfirmationemail&quot; data-nonce=&quot;&lt;?php echo $this-&gt;secure(array('action' =&gt; &quot;actionvar_resendconfirmationemail&quot; ), true)?&gt;&quot;&gt;&lt;?php _e('Resend confirmation email', WYSIJA); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>            &lt;?php } ?&gt;&nbsp;</div></li><li><div>        &lt;/select&gt;&nbsp;</div></li><li><div>        &lt;input type=&quot;submit&quot; class=&quot;bulksubmit button-secondary action&quot; name=&quot;doaction&quot; value=&quot;&lt;?php echo esc_attr(__('Apply', WYSIJA)); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>                $this-&gt;secure(array(&nbsp;</div></li><li><div>                    'action' =&gt; 'bulk_action', &nbsp;</div></li><li><div>                    'controller' =&gt; 'wysija_subscribers'&nbsp;</div></li><li><div> ));&nbsp;</div></li><li><div>               ?&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;div class=&quot;alignleft actions&quot;&gt;&nbsp;</div></li><li><div>        &lt;select name=&quot;wysija[filter][filter_list]&quot; class=&quot;global-filter&quot;&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    $is_list_pre_selected = false;&nbsp;</div></li><li><div>        $options_list = '';&nbsp;</div></li><li><div>    foreach ($data['lists'] as $listK =&gt; $list)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>            $selected = '';&nbsp;</div></li><li><div>            if (in_array($listK, $data['selected_lists'])) {&nbsp;</div></li><li><div>                $selected = ' selected=&quot;selected&quot; ';&nbsp;</div></li><li><div>                $is_list_pre_selected = true;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        if (isset($list['users']))&nbsp;</div></li><li><div>        $options_list .= '&lt;option '.$selected.' value=&quot;'.$list['list_id'].'&quot;&gt;'.$list['name'].' ('.$list['users'].')'.'&lt;/option&gt;';&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>        $options_list .= '&lt;option '.$selected.' value=&quot;'.$list['list_id'].'&quot;&gt;'.$list['name'].'&lt;/option&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                        // Now, if there is not any selected list, let's select &quot;View all lists&quot; by default.&nbsp;</div></li><li><div>                        $selected = in_array('', $data['selected_lists']) ? ' selected=&quot;selected&quot; ' : '';&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>            &lt;option &lt;?php echo $selected; ?&gt; data-sort='0' value=&quot;&quot;&gt;&lt;?php _e('View all lists', WYSIJA); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                        $selected = in_array('orphaned', $data['selected_lists']) ? ' selected=&quot;selected&quot; ' : '';&nbsp;</div></li><li><div>            if (in_array('orphaned', $data['selected_lists'])) {&nbsp;</div></li><li><div>                $selected = ' selected=&quot;selected&quot; ';&nbsp;</div></li><li><div>                $is_list_pre_selected = true;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                    &lt;option &lt;?php echo $selected; ?&gt; value=&quot;orphaned&quot; data-sort='0'&gt;&lt;?php _e('Subscribers in no list', WYSIJA); ?&gt;&lt;/option&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;?php echo $options_list; ?&gt;&nbsp;</div></li><li><div>        &lt;/select&gt;&nbsp;</div></li><li><div>        &lt;input type=&quot;submit&quot; class=&quot;filtersubmit button-secondary action&quot; name=&quot;doaction&quot; value=&quot;&lt;?php echo esc_attr(__('Filter', WYSIJA)); ?&gt;&quot;&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;?php $this-&gt;pagination(); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>    &lt;/div&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * main view&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        function listing($data, $simple = false)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>    &lt;div class=&quot;list&quot;&gt;&nbsp;</div></li><li><div>        &lt;table cellspacing=&quot;0&quot; class=&quot;widefat fixed&quot;&gt;&nbsp;</div></li><li><div>        &lt;thead&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>            $status_sorting = $last_opened_sorting = $last_clicked_sorting = $username_sorting = $created_at_sorting = ' sortable desc';&nbsp;</div></li><li><div>            $hiddenOrder = '';&nbsp;</div></li><li><div>            if (isset($_REQUEST['orderby']))&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>            switch ($_REQUEST['orderby'])&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                case 'email':&nbsp;</div></li><li><div>                $username_sorting = ' sorted '.$_REQUEST['ordert'];&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>                case 'created_at':&nbsp;</div></li><li><div>                $created_at_sorting = ' sorted '.$_REQUEST['ordert'];&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>                case 'last_opened':&nbsp;</div></li><li><div>                $last_opened_sorting = ' sorted '.$_REQUEST['ordert'];&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>                case 'last_clicked':&nbsp;</div></li><li><div>                $last_clicked_sorting = ' sorted '.$_REQUEST['ordert'];&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>                case 'status':&nbsp;</div></li><li><div>                $status_sorting = ' sorted '.$_REQUEST['ordert'];&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $hiddenOrder = '&lt;input type=&quot;hidden&quot; name=&quot;orderby&quot; id=&quot;wysija-orderby&quot; value=&quot;'.esc_attr($_REQUEST[&quot;orderby&quot;]).'&quot;/&gt;';&nbsp;</div></li><li><div>            $hiddenOrder.='&lt;input type=&quot;hidden&quot; name=&quot;ordert&quot; id=&quot;wysija-ordert&quot; value=&quot;'.esc_attr($_REQUEST[&quot;ordert&quot;]).'&quot;/&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $header = '&lt;tr class=&quot;thead&quot;&gt;&nbsp;</div></li><li><div>                            &lt;th scope=&quot;col&quot; id=&quot;user-id&quot; class=&quot;manage-column column-user-id check-column&quot;&gt;&lt;input type=&quot;checkbox&quot; /&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                            &lt;th class=&quot;manage-column column-username'.$username_sorting.'&quot; id=&quot;email&quot; scope=&quot;col&quot; style=&quot;width:140px;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;'.__('Email', WYSIJA).'&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>            $header .='&lt;th class=&quot;manage-column column-list-names&quot; id=&quot;list-list&quot; scope=&quot;col&quot;&gt;'.__('Lists', WYSIJA).'&lt;/th&gt;';&nbsp;</div></li><li><div>            $header .='&lt;th class=&quot;manage-column column-status'.$status_sorting.'&quot; id=&quot;status&quot; scope=&quot;col&quot; style=&quot;width:80px;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;'.__('Status', WYSIJA).'&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>            $header .= '&lt;th class=&quot;manage-column column-date'.$created_at_sorting.'&quot; id=&quot;created_at&quot; scope=&quot;col&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;'.__('Subscribed on', WYSIJA).'&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>            $header .= '&lt;th class=&quot;manage-column column-date' . $last_opened_sorting . '&quot; id=&quot;last_opened&quot; scope=&quot;col&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;' . __('Last open', WYSIJA) . '&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>            $header .= '&lt;th class=&quot;manage-column column-date' . $last_clicked_sorting . '&quot; id=&quot;last_clicked&quot; scope=&quot;col&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;orderlink&quot; &gt;&lt;span&gt;' . __('Last click', WYSIJA) . '&lt;/span&gt;&lt;span class=&quot;sorting-indicator&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/th&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $header .= '&lt;/tr&gt;';&nbsp;</div></li><li><div>            echo $header;&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>        &lt;/thead&gt;&nbsp;</div></li><li><div>        &lt;tfoot&gt;&nbsp;</div></li><li><div>               &lt;?php&nbsp;</div></li><li><div>               echo $header;&nbsp;</div></li><li><div>               ?&gt;&nbsp;</div></li><li><div>        &lt;/tfoot&gt;&nbsp;</div></li><li><div>               &lt;?php if ($data['show_batch_select'])&nbsp;</div></li><li><div>               { ?&gt;&nbsp;</div></li><li><div>            &lt;tr class=&quot;batch-select&quot;&gt;&nbsp;</div></li><li><div>                &lt;td colspan=&quot;5&quot;&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;radio&quot; name=&quot;wysija[user][force_select_all]&quot; id=&quot;force_select_all&quot; style=&quot;display:none;&quot; /&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;hidden&quot; name=&quot;wysija[user][timestamp]&quot; value=&quot;&lt;?php echo $data['max_create_at']; ?&gt;&quot;/&gt;&nbsp;</div></li><li><div>                &lt;div class=&quot;force_to_select_all_link&quot; style=&quot;display:none&quot;&gt;&nbsp;</div></li><li><div>               &lt;?php _e('All subscribers on this page are selected.', WYSIJA); ?&gt;&nbsp;</div></li><li><div>                    &lt;a href=&quot;javascript:void(0);&quot;&gt;&lt;?php echo sprintf(__('Select all %1$s subscribers.', WYSIJA), $data['current_counts']); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;div class=&quot;clear_select_all&quot; style=&quot;display:none&quot;&gt;&nbsp;</div></li><li><div>               &lt;?php echo sprintf(__('All %1$s subscribers are selected.', WYSIJA), $data['current_counts']); ?&gt;&nbsp;</div></li><li><div>                    &lt;a&gt;&lt;?php echo __('Clear selection', WYSIJA); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $class = 'list:'.$this-&gt;model-&gt;table_name.' '.$this-&gt;model-&gt;table_name.'-list';&nbsp;</div></li><li><div>        $id = 'wysija-'.$this-&gt;model-&gt;table_name;&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;tbody class=&quot;&lt;?php echo $class; ?&gt;&quot; id=&quot;&lt;?php echo $id; ?&gt;&quot;&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>            $listingRows = '';&nbsp;</div></li><li><div>            $alt = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $statuses = array('-1' =&gt; __('Unsubscribed', WYSIJA), '0' =&gt; __('Unconfirmed', WYSIJA), '1' =&gt; __('Subscribed', WYSIJA));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $config = WYSIJA::get('config', 'model');&nbsp;</div></li><li><div>            if(!$config-&gt;getValue('confirm_dbleoptin')) {&nbsp;</div></li><li><div>                $statuses['0'] = $statuses['1'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $links_helper = WYSIJA::get('links', 'helper');&nbsp;</div></li><li><div>            foreach ($data['subscribers'] as $row) {&nbsp;</div></li><li><div>                $classRow = '';&nbsp;</div></li><li><div>                if($alt) {&nbsp;</div></li><li><div>                    $classRow = 'alternate';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>            &lt;tr class=&quot;&lt;?php echo $classRow; ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                &lt;th scope=&quot;col&quot; class=&quot;check-column&quot; &gt;&nbsp;</div></li><li><div>                    &lt;input type=&quot;checkbox&quot; name=&quot;wysija[user][user_id][]&quot; id=&quot;user_id_&lt;?php echo $row['user_id'] ?&gt;&quot; value=&quot;&lt;?php echo esc_attr($row['user_id']) ?&gt;&quot; class=&quot;checkboxselec&quot; /&gt;&nbsp;</div></li><li><div>                &lt;/th&gt;&nbsp;</div></li><li><div>                &lt;td class=&quot;username column-username&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                    echo get_avatar($row['email'], 32);&nbsp;</div></li><li><div>                    echo '&lt;strong&gt;'.$row['email'].'&lt;/strong&gt;';&nbsp;</div></li><li><div>                    echo '&lt;p style=&quot;margin:0;&quot;&gt;'.esc_html($row['firstname'].' '.$row['lastname']).'&lt;/p&gt;';&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                &lt;div class=&quot;row-actions&quot;&gt;&nbsp;</div></li><li><div>                    &lt;span class=&quot;edit&quot;&gt;&nbsp;</div></li><li><div>                        &lt;a href=&quot;&lt;?php echo $links_helper-&gt;detailed_subscriber($row['user_id']); ?&gt;&quot; class=&quot;submitedit&quot;&gt;&lt;?php _e('View stats or edit', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                    &lt;/span&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&lt;?php&nbsp;</div></li><li><div>        if (isset($row['lists']))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>        echo $row['lists'];&nbsp;</div></li><li><div>        if (isset($row['unsub_lists']))&nbsp;</div></li><li><div>            echo ' / ';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if (isset($row['unsub_lists']))&nbsp;</div></li><li><div>        echo '&lt;span class=&quot;wysija-unsubscribed-on&quot; title=&quot;'.__('Lists to which the subscriber was subscribed.', WYSIJA).'&quot;&gt;'.$row['unsub_lists'].'&lt;/span&gt;';&nbsp;</div></li><li><div>        ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&lt;?php echo $statuses[$row['status']]; ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&lt;?php echo $this-&gt;fieldListHTML_created_at($row['created_at']) ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&lt;?php echo $this-&gt;fieldListHTML_created_at($row['last_opened']) ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&lt;?php echo $this-&gt;fieldListHTML_created_at($row['last_clicked']) ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&lt;?php&nbsp;</div></li><li><div>            $alt = !$alt;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;/tbody&gt;&nbsp;</div></li><li><div>    &lt;/table&gt;&nbsp;</div></li><li><div>    &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                echo $hiddenOrder;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            function export($data)&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                /** make a list of fields to export */&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>    &lt;form name=&quot;submitexport&quot; method=&quot;post&quot; id=&quot;submitexport&quot; action=&quot;&quot; class=&quot;form-valid&quot;&gt;&nbsp;</div></li><li><div>        &lt;table class=&quot;form-table&quot;&gt;&nbsp;</div></li><li><div>        &lt;tbody&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    if (!isset($data['subscribers']))&nbsp;</div></li><li><div>    {//select a list and export&nbsp;</div></li><li><div>        /** set the filters necessary to export&nbsp;</div></li><li><div>         * 1-export a list&nbsp;</div></li><li><div>         * 2-export all&nbsp;</div></li><li><div>         * 3-export confirmed&nbsp;</div></li><li><div>         * 4-export&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $formObj = WYSIJA::get('forms', 'helper');&nbsp;</div></li><li><div>        $config = WYSIJA::get('config', 'model');&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>                &lt;tr&gt;&nbsp;</div></li><li><div>                &lt;th&gt;&lt;label for=&quot;filterlist&quot;&gt;&lt;?php _e(&quot;Pick a list&quot;, WYSIJA); ?&gt;&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                &lt;td&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        $lists_html = '';&nbsp;</div></li><li><div>        foreach ($data['lists'] as $listK =&gt; $list)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>        $lists_html .= '&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;wysija[export][filter][list][]&quot; checked=&quot;checked&quot; class=&quot;validate[minCheckbox[1]] checkbox&quot; value=&quot;'.esc_attr($list['list_id']).'&quot; /&gt;';&nbsp;</div></li><li><div>        $lists_html .= '&nbsp;'.$list['name'];&nbsp;</div></li><li><div>        $lists_html .= ' &lt;span class=&quot;count-confirmed-only&quot;&gt;('.$list['subscribers'].')&lt;/span&gt;';&nbsp;</div></li><li><div>        $lists_html .= '&lt;span class=&quot;count-all&quot;&gt;('.((int) $list['belonging']).')&lt;/span&gt;';&nbsp;</div></li><li><div>        $lists_html .= '&lt;/label&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo $lists_html;&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>                &lt;/td&gt;&nbsp;</div></li><li><div>                &lt;/tr&gt;&nbsp;</div></li><li><div>                &lt;tr&gt;&nbsp;</div></li><li><div>                &lt;th&gt;&lt;label for=&quot;exportformat&quot;&gt;&lt;?php _e(&quot;Format&quot;, WYSIJA); ?&gt;&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                &lt;td&gt;&nbsp;</div></li><li><div>                    &lt;input type=&quot;radio&quot; id=&quot;export_format1&quot; value=&quot;, &quot; checked=&quot;checked&quot; name=&quot;wysija[export][format]&quot;&gt;&nbsp;</div></li><li><div>                    &lt;label for=&quot;export_format1&quot;&gt;&lt;?php _e('CSV file', WYSIJA); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                    &lt;input type=&quot;radio&quot; id=&quot;export_format2&quot; value=&quot;;&quot; name=&quot;wysija[export][format]&quot;&gt;&nbsp;</div></li><li><div>                    &lt;label for=&quot;export_format2&quot;&gt;&lt;?php _e('Excel for Windows', WYSIJA); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                &lt;/td&gt;&nbsp;</div></li><li><div>                &lt;/tr&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                if ($config-&gt;getValue('confirm_dbleoptin'))&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                &lt;tr&gt;&nbsp;</div></li><li><div>                &lt;th&gt;&lt;label for=&quot;confirmedcheck&quot;&gt;&lt;?php _e(&quot;Export confirmed subscribers only&quot;, WYSIJA); ?&gt;&lt;/label&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                &lt;td&gt;&nbsp;</div></li><li><div>                    &lt;input type=&quot;checkbox&quot; name=&quot;wysija[export][filter][confirmed]&quot; checked=&quot;checked&quot; value=&quot;1&quot; id=&quot;confirmedcheck&quot; /&gt;&nbsp;</div></li><li><div>                &lt;/td&gt;&nbsp;</div></li><li><div>                &lt;/tr&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    elseif (!empty($data['user']['timestamp']) && !empty($data['user']['force_select_all']) && (bool) $data['user']['force_select_all'])&nbsp;</div></li><li><div>    { //batch-select and export&nbsp;</div></li><li><div>        if (!empty($data['filter']) && is_array($data['filter']))&nbsp;</div></li><li><div>        foreach ($data['filter'] as $k =&gt; $v)&nbsp;</div></li><li><div>            echo '&lt;input type=&quot;hidden&quot; value=&quot;'.$v.'&quot; name=&quot;wysija[filter]['.$k.']&quot; /&gt;';&nbsp;</div></li><li><div>        foreach ($data['user'] as $k =&gt; $v)&nbsp;</div></li><li><div>        if ($k != 'user_id') // we don't ask for user_id in case of batch-select&nbsp;</div></li><li><div>            echo '&lt;input type=&quot;hidden&quot; value=&quot;'.$v.'&quot; name=&quot;wysija[user]['.$k.']&quot; /&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>            &lt;tr&gt;&nbsp;</div></li><li><div>            &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;listfields&quot;&gt;&lt;?php _e('List of fields to export', WYSIJA); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    $model_user_field = WYSIJA::get('user_field', 'model');&nbsp;</div></li><li><div>    $fields = $model_user_field-&gt;getFields();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    $helper_forms = WYSIJA::get('forms', 'helper');&nbsp;</div></li><li><div>    echo $helper_forms-&gt;checkboxes(array('class' =&gt; 'validate[minCheckbox[1]] checkbox', 'name' =&gt; 'wysija[export][fields][]', 'id' =&gt; 'wysijafields'), $fields);&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>        &lt;/tbody&gt;&nbsp;</div></li><li><div>        &lt;/table&gt;&nbsp;</div></li><li><div>        &lt;p class=&quot;submit&quot;&gt;&nbsp;</div></li><li><div>        &lt;input type=&quot;hidden&quot; name=&quot;wysija[export][user_ids]&quot; id=&quot;user_ids&quot; value=&quot;&lt;?php if (isset($data['subscribers'])) echo base64_encode(json_encode($data['subscribers'])) ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>        &lt;input type=&quot;hidden&quot; value=&quot;export_get&quot; name=&quot;action&quot; /&gt;&nbsp;</div></li><li><div>                &lt;?php $this-&gt;secure(array('action' =&gt; &quot;export_get&quot;)); ?&gt;&nbsp;</div></li><li><div>        &lt;input type=&quot;submit&quot; value=&quot;&lt;?php echo esc_attr(__('Export', WYSIJA)) ?&gt;&quot; class=&quot;button-primary wysija&quot;&gt;&nbsp;</div></li><li><div>        &lt;/p&gt;&nbsp;</div></li><li><div>    &lt;/form&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function add($data = false)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    $this-&gt;buttonsave = __('Save', WYSIJA);&nbsp;</div></li><li><div>    if (!$data['user'] || isset($this-&gt;add))&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;buttonsave = __('Add Subscriber', WYSIJA);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    $formid = 'wysija-'.$_REQUEST['action'];&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>    &lt;form name=&quot;&lt;?php echo $formid ?&gt;&quot; method=&quot;post&quot; id=&quot;&lt;?php echo $formid ?&gt;&quot; action=&quot;&quot; class=&quot;form-valid&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;table class=&quot;form-table&quot;&gt;&nbsp;</div></li><li><div>        &lt;tbody&gt;&nbsp;</div></li><li><div>            &lt;tr&gt;&nbsp;</div></li><li><div>            &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;email&quot;&gt;&lt;?php _e('Email', WYSIJA); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;text&quot; size=&quot;40&quot; class=&quot;validate[required, custom[email]]&quot; id=&quot;email&quot; value=&quot;&lt;?php if ($data['user']) echo esc_attr($data['user']['details']['email']) ?&gt;&quot; name=&quot;wysija[user][email]&quot; /&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;tr&gt;&nbsp;</div></li><li><div>            &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;fname&quot;&gt;&lt;?php _e('First name', WYSIJA); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;text&quot; size=&quot;40&quot; id=&quot;fname&quot; value=&quot;&lt;?php if ($data['user']) echo esc_attr($data['user']['details']['firstname']) ?&gt;&quot; name=&quot;wysija[user][firstname]&quot; /&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;tr&gt;&nbsp;</div></li><li><div>            &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;lname&quot;&gt;&lt;?php _e('Last name', WYSIJA); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;text&quot; size=&quot;40&quot; id=&quot;lname&quot; value=&quot;&lt;?php if ($data['user']) echo esc_attr($data['user']['details']['lastname']) ?&gt;&quot; name=&quot;wysija[user][lastname]&quot; /&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>            &lt;tr&gt;&nbsp;</div></li><li><div>            &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;user-status&quot; &gt;&lt;?php _e('Status', WYSIJA); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                $form_obj = WYSIJA::get('forms', 'helper');&nbsp;</div></li><li><div>                $user_status = 1;&nbsp;</div></li><li><div>                $config = WYSIJA::get('config', 'model');&nbsp;</div></li><li><div>                if ($config-&gt;getValue(&quot;confirm_dbleoptin&quot;))&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                $statusddp = array('1' =&gt; __('Subscribed', WYSIJA), '0' =&gt; __('Unconfirmed', WYSIJA), '-1' =&gt; __('Unsubscribed', WYSIJA));&nbsp;</div></li><li><div>                if ($data['user'])&nbsp;</div></li><li><div>                    $user_status = $data['user']['details']['status'];&nbsp;</div></li><li><div>                }else&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                $statusddp = array('1' =&gt; __('Subscribed', WYSIJA), '-1' =&gt; __('Unsubscribed', WYSIJA));&nbsp;</div></li><li><div>                if ($data['user'])&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                    if ((int) $data['user']['details']['status'] == 0)&nbsp;</div></li><li><div>                    {&nbsp;</div></li><li><div>                    $user_status = 1;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    else&nbsp;</div></li><li><div>                    {&nbsp;</div></li><li><div>                    $user_status = $data['user']['details']['status'];&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                echo &quot;&lt;p&gt;&quot;.$form_obj-&gt;radios(&nbsp;</div></li><li><div>                    array('id' =&gt; 'user-status', 'name' =&gt; 'wysija[user][status]'), $statusddp, $user_status, ' class=&quot;validate[required]&quot; ').&quot;&lt;/p&gt;&quot;;&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>            &lt;tr&gt;&nbsp;</div></li><li><div>            &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;lists&quot; class=&quot;title&quot;&gt;&lt;?php _e('Lists', WYSIJA); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                $field_html = '';&nbsp;</div></li><li><div>                $field = 'list';&nbsp;</div></li><li><div>                $valuefield = array();&nbsp;</div></li><li><div>                if ($data['user'] && isset($data['user']['lists']))&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                foreach ($data['user']['lists'] as $list)&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                    $valuefield[$list['list_id']] = $list;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $_display_style = 2; // 1 = 1 column, 2 = float left&nbsp;</div></li><li><div>                usort( $data['list'], array( $this, 'sort_by_name' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                foreach ($data['list'] as $list)&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $checked = false;&nbsp;</div></li><li><div>                $extra_checkbox = $hidden_field = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if (isset($valuefield[$list['list_id']]))&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                    //if the subscriber has this list and is not unsubed then we check the checkbox&nbsp;</div></li><li><div>                    if ($valuefield[$list['list_id']]['unsub_date'] &lt;= 0)&nbsp;</div></li><li><div>                    {&nbsp;</div></li><li><div>                    $checked = true;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    else&nbsp;</div></li><li><div>                    {&nbsp;</div></li><li><div>                    //we keep a reference of the list to which we are unsubscribed&nbsp;</div></li><li><div>                    $hidden_field = $form_obj-&gt;hidden(array('id' =&gt; $field.$list['list_id'], 'name' =&gt; 'wysija[user_list][unsub_list][]', 'class' =&gt; 'checkboxx'), $list['list_id']);&nbsp;</div></li><li><div>                    $hidden_field.=' / &lt;span class=&quot;wysija-unsubscribed-on&quot;&gt; '.sprintf(__('Unsubscribed on %1$s', WYSIJA), date('D, j M Y H:i:s', $valuefield[$list['list_id']]['unsub_date'])).'&lt;/span&gt;';&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $checkout_params = array('id' =&gt; $field.$list['list_id'], 'name' =&gt; &quot;wysija[user_list][list_id][]&quot;, 'class' =&gt; '');&nbsp;</div></li><li><div>                $checkbox = $form_obj-&gt;checkbox($checkout_params, $list['list_id'], $checked, $extra_checkbox) . &quot;&lt;label for='list{$list['list_id']}'&gt;{$list['name']}&lt;/label&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ($_display_style == 1)&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                    $field_html.= '&lt;p&gt;&lt;label for=&quot;'.$field.$list['list_id'].'&quot;&gt;';&nbsp;</div></li><li><div>                    $field_html.=$checkbox;&nbsp;</div></li><li><div>                    $field_html.=$hidden_field;&nbsp;</div></li><li><div>                    $field_html.='&lt;/label&gt;&lt;/p&gt;';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                else&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                    $field_html .= '&lt;p class=&quot;labelcheck&quot;&gt;';&nbsp;</div></li><li><div>                    $field_html .= $checkbox;&nbsp;</div></li><li><div>                    $field_html .= $hidden_field;&nbsp;</div></li><li><div>                    $field_html .= '&lt;/p&gt;';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                echo $field_html;&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>            /**&nbsp;</div></li><li><div>              Custom Fields.&nbsp;</div></li><li><div>             */&nbsp;</div></li><li><div>            echo WJ_FieldRender::render_all(&nbsp;</div></li><li><div>                $data['user']['details']['user_id']&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>            &lt;tr class='submit_row'&gt;&nbsp;</div></li><li><div>            &lt;td colspan='2'&gt;&nbsp;</div></li><li><div>    &lt;?php $this-&gt;secure(array('action' =&gt; &quot;save&quot;, 'id' =&gt; $data['user']['details']['user_id'])); ?&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;hidden&quot; name=&quot;wysija[user][user_id]&quot; id=&quot;user_id&quot; value=&quot;&lt;?php echo esc_attr($data['user']['details']['user_id']) ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;hidden&quot; value=&quot;save&quot; name=&quot;action&quot; /&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;submit&quot; value=&quot;&lt;?php echo esc_attr($this-&gt;buttonsave) ?&gt;&quot; class=&quot;button-primary wysija&quot;&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>        &lt;/tbody&gt;&nbsp;</div></li><li><div>        &lt;/table&gt;&nbsp;</div></li><li><div>    &lt;/form&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // @todo: move to a helper&nbsp;</div></li><li><div>    function subscribers_stats($htmlContent, $data)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    $htmlContent = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    if (count($data['charts']['stats']) &gt; 0)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $htmlContent.= '&lt;p&gt;';&nbsp;</div></li><li><div>        $helper_licence = WYSIJA::get('licence', 'helper');&nbsp;</div></li><li><div>        $url_checkout = $helper_licence-&gt;get_url_checkout('subscriber_stats');&nbsp;</div></li><li><div>        $htmlContent.= str_replace(&nbsp;</div></li><li><div>            array('[link]', '[/link]'), array('&lt;a title=&quot;'.__('Get Premium now', WYSIJA).'&quot; target=&quot;_blank&quot; href=&quot;'.$url_checkout.'&quot;&gt;', '&lt;/a&gt;'), __(&quot;Note: Find out what this subscriber opened and clicked with our [link]Premium version.[/link]&quot;, WYSIJA));&nbsp;</div></li><li><div>        $htmlContent.= '&lt;/p&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    return $htmlContent;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function edit($data)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    // loop to show the core lists to which the user is subscribed to&nbsp;</div></li><li><div>    // @todo: we should move this block to controller, or at least a separated function&nbsp;</div></li><li><div>    foreach ($data['list'] as $keyl =&gt; $list)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if (!$list['is_enabled'])&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>        //make sure this lists is in the user lists&nbsp;</div></li><li><div>        foreach ($data['user']['lists'] as $ulist)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            if ($list['list_id'] == $ulist['list_id'])&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>            continue(2);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        unset($data['list'][$keyl]);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>    &lt;div id=&quot;hook_subscriber_left&quot; class=&quot;hook-column left-column hook&quot;&gt;&nbsp;</div></li><li><div>        &lt;?php $this-&gt;add($data); ?&gt;&nbsp;</div></li><li><div>        &lt;?php if (!empty($data['hooks']['hook_subscriber_left'])) echo $data['hooks']['hook_subscriber_left']; ?&gt;&nbsp;</div></li><li><div>    &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php if (!empty($data['hooks']['hook_subscriber_right']))&nbsp;</div></li><li><div>        { ?&gt;&nbsp;</div></li><li><div>        &lt;div id=&quot;hook_subscriber_right&quot; class=&quot;hook-column right-column hook&quot;&gt;&nbsp;</div></li><li><div>            &lt;?php echo $data['hooks']['hook_subscriber_right']; ?&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>            &lt;?php } ?&gt;&nbsp;</div></li><li><div>    &lt;?php if (!empty($data['hooks']['hook_subscriber_bottom']))&nbsp;</div></li><li><div>    { ?&gt;&nbsp;</div></li><li><div>        &lt;div id=&quot;hook_subscriber_bottom&quot; class=&quot;hook&quot;&gt;&lt;?php echo $data['hooks']['hook_subscriber_bottom']; ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function globalActionsLists($data = false)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>    &lt;div class=&quot;tablenav&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;?php $this-&gt;pagination(&quot;&action=lists&quot;); ?&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>    &lt;/div&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * main view when editing lists it has one listing and one form&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function lists($data)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    echo '&lt;form method=&quot;post&quot; action=&quot;&quot; id=&quot;posts-filter&quot;&gt;';&nbsp;</div></li><li><div>    $this-&gt;globalActionsLists($data);&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>    &lt;div class=&quot;list&quot;&gt;&nbsp;</div></li><li><div>        &lt;table cellspacing=&quot;0&quot; class=&quot;widefat fixed&quot; &gt;&nbsp;</div></li><li><div>        &lt;thead&gt;&nbsp;</div></li><li><div>            &lt;tr class=&quot;thead&quot;&gt;&nbsp;</div></li><li><div>            &lt;th class=&quot;manage-column column-name&quot; id=&quot;name-list&quot; scope=&quot;col&quot; style=&quot;width:30%;&quot;&gt;&lt;?php _e('Name', WYSIJA) ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>            &lt;th class=&quot;manage-column column-subscribed&quot; id=&quot;subscribed-list&quot; scope=&quot;col&quot;&gt;&lt;?php _e('Subscribed', WYSIJA) ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    $config = WYSIJA::get(&quot;config&quot;, &quot;model&quot;);&nbsp;</div></li><li><div>    if ($config-&gt;getValue(&quot;confirm_dbleoptin&quot;))&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        ?&gt;&lt;th class=&quot;manage-column column-unsubscribed&quot; id=&quot;unconfirmed-list&quot; scope=&quot;col&quot;&gt;&lt;?php _e('Unconfirmed', WYSIJA) ?&gt;&lt;/th&gt;&lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;th class=&quot;manage-column column-unsubscribed&quot; id=&quot;unsubscribed-list&quot; scope=&quot;col&quot;&gt;&lt;?php _e('Unsubscribed', WYSIJA) ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>        &lt;?php /** &lt;th class=&quot;manage-column column-campaigns&quot; id=&quot;campaigns-list&quot; scope=&quot;col&quot;&gt;&lt;?php _e('Newsletters sent', WYSIJA) ?&gt;&lt;/th&gt; */ ?&gt;&nbsp;</div></li><li><div>            &lt;th class=&quot;manage-column column-date&quot; id=&quot;date-list&quot; scope=&quot;col&quot; style=&quot;width:15%;&quot;&gt;&lt;?php _e('Date created', WYSIJA) ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>        &lt;/thead&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;tbody class=&quot;list:&lt;?php echo $this-&gt;model-&gt;table_name.' '.$this-&gt;model-&gt;table_name.'-list&quot; id=&quot;wysija-'.$this-&gt;model-&gt;table_name.'&quot;' ?&gt;&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    $listingRows = &quot;&quot;;&nbsp;</div></li><li><div>    $alt = true;&nbsp;</div></li><li><div>    foreach ($data['list'] as $row =&gt; $columns)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $classRow = &quot;&quot;;&nbsp;</div></li><li><div>        if ($alt)&nbsp;</div></li><li><div>        $classRow = ' class=&quot;alternate&quot; ';&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>                   &lt;tr &lt;?php echo $classRow ?&gt; &gt;&nbsp;</div></li><li><div>                   &lt;td class=&quot;manage-column column-name&quot;  scope=&quot;col&quot;&gt;&nbsp;</div></li><li><div>            &lt;strong&gt;&lt;a href=&quot;admin.php?page=wysija_subscribers&id=&lt;?php echo $columns['list_id'] ?&gt;&action=editlist&quot; class=&quot;submitedit&quot;&gt;&lt;?php&nbsp;</div></li><li><div>        echo $columns['name'];&nbsp;</div></li><li><div>        ?&gt;&lt;/a&gt;&lt;/strong&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;row-actions&quot;&gt;&nbsp;</div></li><li><div>            &lt;span class=&quot;edit&quot;&gt;&nbsp;</div></li><li><div>                &lt;a href=&quot;admin.php?page=wysija_subscribers&id=&lt;?php echo $columns['list_id'] ?&gt;&action=editlist&quot; class=&quot;submitedit&quot;&gt;&lt;?php _e('Edit', WYSIJA) ?&gt;&lt;/a&gt; |&nbsp;</div></li><li><div>            &lt;/span&gt;&nbsp;</div></li><li><div>            &lt;span class=&quot;duplicate&quot;&gt;&nbsp;</div></li><li><div>                &lt;a href=&quot;admin.php?page=wysija_subscribers&id=&lt;?php echo $columns['list_id'] ?&gt;&action=duplicatelist&_wpnonce=&lt;?php echo $this-&gt;secure(array(&quot;action&quot; =&gt; &quot;duplicatelist&quot;, &quot;id&quot; =&gt; $columns['list_id']), true); ?&gt;&quot; class=&quot;submitduplicate&quot;&gt;&lt;?php _e('Duplicate', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>            &lt;/span&gt;&nbsp;</div></li><li><div>        &lt;?php if ($columns['namekey'] != &quot;users&quot;): ?&gt;&nbsp;</div></li><li><div>            |&nbsp;</div></li><li><div>            &lt;span class=&quot;delete&quot;&gt;&nbsp;</div></li><li><div>                &lt;a href=&quot;admin.php?page=wysija_subscribers&id=&lt;?php echo $columns['list_id'] ?&gt;&action=deletelist&_wpnonce=&lt;?php echo $this-&gt;secure(array(&quot;action&quot; =&gt; &quot;deletelist&quot;, &quot;id&quot; =&gt; $columns['list_id']), true); ?&gt;&quot; class=&quot;submitdelete&quot;&gt;&lt;?php _e('Delete', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>            &lt;/span&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        endif;&nbsp;</div></li><li><div>        if (!$columns['is_enabled']):&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>            |&nbsp;</div></li><li><div>            &lt;span class=&quot;synch&quot;&gt;&nbsp;</div></li><li><div>                &lt;a href=&quot;admin.php?page=wysija_subscribers&id=&lt;?php echo $columns['list_id'] ?&gt;&action=synchlist&_wpnonce=&lt;?php echo $this-&gt;secure(array(&quot;action&quot; =&gt; &quot;synchlist&quot;, &quot;id&quot; =&gt; $columns['list_id']), true); ?&gt;&quot; class=&quot;submitsynch&quot;&gt;&lt;?php _e('Update', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>            &lt;/span&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        endif;&nbsp;</div></li><li><div>        global $current_user;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ($columns['namekey'] == 'users' && !$columns['is_enabled'] && is_multisite() && is_super_admin($current_user-&gt;ID)):&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>            |&nbsp;</div></li><li><div>            &lt;span class=&quot;synchtotal&quot;&gt;&nbsp;</div></li><li><div>                &lt;a href=&quot;admin.php?page=wysija_subscribers&id=&lt;?php echo $columns['list_id'] ?&gt;&action=synchlisttotal&_wpnonce=&lt;?php echo $this-&gt;secure(array(&quot;action&quot; =&gt; &quot;synchlisttotal&quot;, &quot;id&quot; =&gt; $columns['list_id']), true); ?&gt;&quot; class=&quot;submitsynch&quot;&gt;&lt;?php _e('Get all MS users', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>            &lt;/span&gt;&nbsp;</div></li><li><div>        &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>            &lt;?php if (!$columns['is_enabled'] && $columns['namekey'] != 'users'): ?&gt;&nbsp;</div></li><li><div>            |&nbsp;</div></li><li><div>            &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>            &lt;span class=&quot;view_subscribers&quot;&gt;&nbsp;</div></li><li><div>                &lt;a href=&quot;admin.php?page=wysija_subscribers&filter-list=&lt;?php echo $columns['list_id'] ?&gt;&quot;&gt;| &lt;?php _e('View subscribers', WYSIJA) ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>            &lt;/span&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;td class=&quot;manage-column column-subscribed&quot;  scope=&quot;col&quot;&gt;&lt;?php echo $columns['subscribers'] ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        if ($config-&gt;getValue(&quot;confirm_dbleoptin&quot;))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>        ?&gt;&lt;td class=&quot;manage-column column-unconfirmed&quot;  scope=&quot;col&quot;&gt;&lt;?php echo $columns['unconfirmed'] ?&gt;&lt;/td&gt;&lt;?php&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;td class=&quot;manage-column column-unsubscribed&quot;  scope=&quot;col&quot;&gt;&lt;?php echo $columns['unsubscribers'] ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>        &lt;?php /** &lt;td class=&quot;manage-column column-campaigns&quot;  scope=&quot;col&quot;&gt;&lt;?php echo $columns['campaigns_sent'] ?&gt;&lt;/td&gt; */ ?&gt;&nbsp;</div></li><li><div>            &lt;td class=&quot;manage-column column-date&quot;  scope=&quot;col&quot;&gt;&lt;?php echo $this-&gt;fieldListHTML_created_at($columns['created_at']) ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        $alt = !$alt;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;/tbody&gt;&nbsp;</div></li><li><div>    &lt;/table&gt;&nbsp;</div></li><li><div>    &lt;/div&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    echo '&lt;/form&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function addList($data)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    $this-&gt;editList($data);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function editList($data)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>    &lt;div class=&quot;form&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;form class=&quot;form-valid&quot; action=&quot;admin.php?page=wysija_subscribers&action=lists&lt;?php if ($data['form']['list_id']) echo &quot;&id=&quot;.$data['form']['list_id'] ?&gt;&quot; id=&quot;wysija-edit&quot; method=&quot;post&quot; name=&quot;wysija-edit&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;input type=&quot;hidden&quot; name=&quot;wysija[list][list_id]&quot; id=&quot;list_id&quot; value=&quot;&lt;?php echo esc_attr($data['form']['list_id']) ?&gt;&quot;&gt;&nbsp;</div></li><li><div>        &lt;table class=&quot;form-table&quot;&gt;&nbsp;</div></li><li><div>            &lt;tbody&gt;&nbsp;</div></li><li><div>            &lt;tr&gt;&nbsp;</div></li><li><div>                &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;list-name&quot;&gt;&lt;?php _e('Name', WYSIJA); ?&gt; &lt;/label&gt;&nbsp;</div></li><li><div>                &lt;/th&gt;&nbsp;</div></li><li><div>                &lt;td&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;text&quot; size=&quot;40&quot; class=&quot;validate[required]&quot; id=&quot;list-name&quot; value=&quot;&lt;?php echo esc_attr($data['form']['name']) ?&gt;&quot; name=&quot;wysija[list][name]&quot; /&gt;&nbsp;</div></li><li><div>                &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>            &lt;tr&gt;&nbsp;</div></li><li><div>                &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;list-desc&quot;&gt;&lt;?php _e('Description', WYSIJA); ?&gt; &lt;/label&gt;&nbsp;</div></li><li><div>            &lt;p class=&quot;description&quot;&gt;&lt;?php _e('For your own use and never shown to your subscribers.', WYSIJA); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&nbsp;</div></li><li><div>            &lt;textarea type=&quot;text&quot; cols=&quot;40&quot; rows=&quot;3&quot; id=&quot;list-desc&quot; name=&quot;wysija[list][description]&quot; /&gt;&lt;?php echo $data['form']['description'] ?&gt;&lt;/textarea&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>            &lt;/tbody&gt;&nbsp;</div></li><li><div>        &lt;/table&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    if ($_REQUEST['action'] == &quot;editlist&quot;)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $buttonName = __('Update list', WYSIJA);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    else&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $buttonName = __('Add list', WYSIJA);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>        &lt;p class=&quot;submit&quot;&gt;&nbsp;</div></li><li><div>    &lt;?php $this-&gt;secure(array('action' =&gt; &quot;savelist&quot;, 'id' =&gt; $data['form']['list_id'])); ?&gt;&nbsp;</div></li><li><div>            &lt;input type=&quot;hidden&quot; value=&quot;savelist&quot; name=&quot;action&quot; /&gt;&nbsp;</div></li><li><div>            &lt;input type=&quot;submit&quot; value=&quot;&lt;?php echo esc_attr($buttonName) ?&gt;&quot; class=&quot;button-primary wysija&quot;&gt;&nbsp;</div></li><li><div>        &lt;/p&gt;&nbsp;</div></li><li><div>        &lt;/form&gt;&nbsp;</div></li><li><div>    &lt;/div&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function import($data)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    $helperNumbers = WYSIJA::get('numbers', 'helper');&nbsp;</div></li><li><div>    $data = $helperNumbers-&gt;get_max_file_upload();&nbsp;</div></li><li><div>    $bytes = $data['maxmegas'];&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>    &lt;div class=&quot;form&quot;&gt;&nbsp;</div></li><li><div>        &lt;form class=&quot;form-valid&quot; action=&quot;admin.php?page=wysija_subscribers&action=lists&quot; id=&quot;wysija-edit&quot; enctype=&quot;multipart/form-data&quot; method=&quot;post&quot; name=&quot;wysija-edit&quot;&gt;&nbsp;</div></li><li><div>        &lt;table class=&quot;form-table&quot;&gt;&nbsp;</div></li><li><div>            &lt;tbody&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;tr&gt;&nbsp;</div></li><li><div>                &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;redirect&quot;&gt;&lt;?php _e('How do you want to import?', WYSIJA); ?&gt; &lt;/label&gt;&nbsp;</div></li><li><div>                &lt;/th&gt;&nbsp;</div></li><li><div>                &lt;td&gt;&nbsp;</div></li><li><div>                &lt;p&gt;&nbsp;</div></li><li><div>                    &lt;label for=&quot;copy-paste&quot;&gt;&nbsp;</div></li><li><div>                    &lt;input type=&quot;radio&quot; class=&quot;validate[required]&quot; id=&quot;copy-paste&quot; value=&quot;copy&quot; name=&quot;wysija[import][type]&quot; &gt;&lt;?php _e('Copy paste in a text box', WYSIJA); ?&gt;&nbsp;</div></li><li><div>                    &lt;/label&gt;&nbsp;</div></li><li><div>                    &lt;label for=&quot;upload-file&quot;&gt;&nbsp;</div></li><li><div>                    &lt;input type=&quot;radio&quot; class=&quot;validate[required]&quot; id=&quot;upload-file&quot; value=&quot;upload&quot; name=&quot;wysija[import][type]&quot;&gt;&lt;?php _e('Upload a file', WYSIJA); ?&gt;&nbsp;</div></li><li><div>                    &lt;/label&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    $config = WYSIJA::get('config', &quot;model&quot;);&nbsp;</div></li><li><div>    $importPossible = $config-&gt;getValue(&quot;pluginsImportableEgg&quot;);&nbsp;</div></li><li><div>    $importedalready = $config-&gt;getValue(&quot;pluginsImportedEgg&quot;);&nbsp;</div></li><li><div>    if (is_array($importPossible))&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        foreach ($importPossible as $tableName =&gt; $pluginInfos)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>        if (is_array($importedalready) && in_array($tableName, $importedalready))&nbsp;</div></li><li><div>            continue;&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>                        &lt;label for=&quot;import-from-plugin-&lt;?php echo $tableName; ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                        &lt;a class=&quot;button-secondary2&quot; id=&quot;import-from-plugin-&lt;?php echo $tableName; ?&gt;&quot; href=&quot;admin.php?page=wysija_subscribers&action=importplugins&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php echo sprintf(__('Import from %1$s', WYSIJA), '&lt;strong&gt;&quot;'.$pluginInfos['name'].'&quot;&lt;/strong&gt;'); ?&gt;&nbsp;</div></li><li><div>                        &lt;/a&gt;&nbsp;</div></li><li><div>                        &lt;/label&gt;&nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                &lt;/p&gt;&nbsp;</div></li><li><div>                &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;tr class=&quot;csvmode copy&quot;&gt;&nbsp;</div></li><li><div>                &lt;th scope=&quot;row&quot; &gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;csvtext&quot;&gt;&lt;?php _e('Then paste your list here', WYSIJA); ?&gt; &lt;/label&gt;&nbsp;</div></li><li><div>            &lt;p class=&quot;description&quot;&gt;&lt;?php echo str_replace(array(&quot;[link]&quot;, &quot;[/link]&quot;), array('&lt;a target=&quot;_blank&quot; href=&quot;http://support.mailpoet.com/knowledgebase/importing-subscribers-with-a-csv-file/?utm_source=wpadmin&utm_campaign=import&quot;&gt;', '&lt;/a&gt;'), __('This needs to be in CSV style or a simple paste from Gmail, Hotmail or Yahoo. See [link]examples in our support site[/link].', WYSIJA)) ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&nbsp;</div></li><li><div>            &lt;textarea type=&quot;text&quot; style=&quot;width:500px;&quot; cols=&quot;130&quot; rows=&quot;10&quot; class=&quot;validate[required]&quot; id=&quot;csvtext&quot; name=&quot;wysija[user_list][csv]&quot; /&gt;&lt;/textarea&gt;&nbsp;</div></li><li><div>            &lt;p class=&quot;fieldsmatch&quot;&gt;&lt;/p&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;tr class=&quot;csvmode upload&quot;&gt;&nbsp;</div></li><li><div>            &lt;th scope=&quot;row&quot; &gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;csvfile&quot;&gt;&lt;?php _e('Upload a file', WYSIJA); ?&gt; &lt;/label&gt;&nbsp;</div></li><li><div>            &lt;p class=&quot;description&quot;&gt;&lt;?php echo str_replace(array(&quot;[link]&quot;, &quot;[/link]&quot;), array('&lt;a target=&quot;_blank&quot; href=&quot;http://support.mailpoet.com/knowledgebase/importing-subscribers-with-a-csv-file/?utm_source=wpadmin&utm_campaign=import file&quot;&gt;', '&lt;/a&gt;'), __('This needs to be in CSV style. See [link]examples in our support site[/link].', WYSIJA)) ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&nbsp;</div></li><li><div>            &lt;input type=&quot;file&quot; name=&quot;importfile&quot; size=&quot;50&quot; /&gt;( &lt;?php echo sprintf(__('total max upload file size : %1$s', WYSIJA), $bytes) ?&gt; )&nbsp;</div></li><li><div>            &lt;p class=&quot;fieldsmatch&quot;&gt;&lt;/p&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;tr&gt;&nbsp;</div></li><li><div>            &lt;th scope=&quot;row&quot; colspan=&quot;2&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;redirect&quot;&gt;&lt;?php _e('Did these subscribers ask to be in your list?', WYSIJA); ?&gt; &lt;/label&gt;&nbsp;</div></li><li><div>            &lt;p class=&quot;description&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php _e('If the answer is &quot;no&quot;, consider yourself a spammer.', WYSIJA); ?&gt;&lt;br /&gt;&nbsp;</div></li><li><div>                &lt;?php echo str_replace(array(&quot;[link]&quot;, &quot;[/link]&quot;), array('&lt;a target=&quot;_blank&quot; href=&quot;http://support.mailpoet.com/knowledgebase/dont-import-subscribers-who-didnt-sign-up/#utm_source=wpadmin&utm_campaign=importwarning&quot;&gt;', '&lt;/a&gt;'), __('[link]Read more on support.mailpoet.com[/link].', WYSIJA)) ?&gt;&nbsp;</div></li><li><div>            &lt;/p&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>            &lt;/tbody&gt;&nbsp;</div></li><li><div>        &lt;/table&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;p class=&quot;submit&quot;&gt;&nbsp;</div></li><li><div>            &lt;input type=&quot;hidden&quot; value=&quot;importmatch&quot; name=&quot;action&quot; /&gt;&nbsp;</div></li><li><div>                    &lt;?php $this-&gt;secure(array('action' =&gt; &quot;importmatch&quot;)); ?&gt;&nbsp;</div></li><li><div>            &lt;input type=&quot;submit&quot; value=&quot;&lt;?php echo esc_attr(__('Next step', WYSIJA)) ?&gt;&quot; class=&quot;button-primary wysija&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;/p&gt;&nbsp;</div></li><li><div>        &lt;/form&gt;&nbsp;</div></li><li><div>    &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function importmatch($data)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>    &lt;form class=&quot;form-valid&quot; action=&quot;admin.php?page=wysija_subscribers&action=lists&quot; id=&quot;wysija-edit&quot; method=&quot;post&quot;  name=&quot;wysija-edit&quot;&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;list&quot; style=&quot;overflow:auto&quot;&gt;&nbsp;</div></li><li><div>        &lt;table cellspacing=&quot;0&quot; class=&quot;widefat fixed&quot; &gt;&nbsp;</div></li><li><div>            &lt;thead&gt;&nbsp;</div></li><li><div>            &lt;tr class=&quot;thead&quot;&gt;&nbsp;</div></li><li><div>                &lt;th id=&quot;first-row&quot;&gt;&lt;?php _e('Match data', WYSIJA); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                $columns = array(&nbsp;</div></li><li><div>                'nomatch' =&gt; __('Ignore column...', WYSIJA), &nbsp;</div></li><li><div>                'email' =&gt; __('Email', WYSIJA), &nbsp;</div></li><li><div>                'firstname' =&gt; __('First name', WYSIJA), &nbsp;</div></li><li><div>                'lastname' =&gt; __('Last name', WYSIJA), &nbsp;</div></li><li><div>                'ip' =&gt; __('IP address', WYSIJA), &nbsp;</div></li><li><div>                'status' =&gt; __('Status', WYSIJA));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $WJ_Field = new WJ_Field();&nbsp;</div></li><li><div>                $custom_fields = $WJ_Field-&gt;get_all();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $extended_columns = array();&nbsp;</div></li><li><div>                if (!empty($custom_fields))&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                foreach ($custom_fields as $row)&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                    $extended_columns['cf_'.$row-&gt;id] = $row-&gt;name;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $helper_form = WYSIJA::get('forms', 'helper');&nbsp;</div></li><li><div>                $i = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $email_column_matched = false;&nbsp;</div></li><li><div>                $this-&gt;new_column_can_be_imported = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $data['csv'][0] = array_map('trim', $data['csv'][0]);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                foreach ($data['csv'][0] as $column_key =&gt; $column_name)&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                $selected = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $columns_array = $columns;&nbsp;</div></li><li><div>                // we make a key out of the column name&nbsp;</div></li><li><div>                $column_name_key = str_replace(array(' ', '-', '_'), '', strtolower($column_name));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // we try to automatically match columns with previous matches recorded in the past&nbsp;</div></li><li><div>                $import_fields = get_option('wysija_import_fields');&nbsp;</div></li><li><div>                if (isset($import_fields[$column_name_key]) && substr($import_fields[$column_name_key], 0, 10) != 'new_field|')&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                    $selected = $import_fields[$column_name_key];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                else&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    // we're making the matches dropdown with an extra value 'Import as &quot;name of the column&quot;'&nbsp;</div></li><li><div>                    // since we didn't detect it in the previously matched columns&nbsp;</div></li><li><div>                    $columns_array = array();&nbsp;</div></li><li><div>                    foreach ($columns as $col_key =&gt; $col_val)&nbsp;</div></li><li><div>                    {&nbsp;</div></li><li><div>                    // we need to put that extra value right after the ignore column value&nbsp;</div></li><li><div>                    if (count($columns_array) === 1) {&nbsp;</div></li><li><div>                        $column_name = preg_replace('|[^a-z0-9#_.-]|i', '', $column_name);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            $columns_array['new_field|input|'.$column_name] = sprintf(__('Import as &quot;%1$s&quot;', WYSIJA), $column_name);&nbsp;</div></li><li><div>                        $columns_array['new_field|date|'.$column_name] = sprintf(__('Import &quot;%1$s&quot; as date field', WYSIJA), $column_name);&nbsp;</div></li><li><div>                        $this-&gt;new_column_can_be_imported[$column_key] = true;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    else&nbsp;</div></li><li><div>                    {&nbsp;</div></li><li><div>                        $columns_array[$col_key] = $col_val;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // if it is an email column we set it by default as email&nbsp;</div></li><li><div>                if (!$email_column_matched && isset($data['keyemail'][$column_key]))&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                    $selected = 'email';&nbsp;</div></li><li><div>                    $email_column_matched = true;&nbsp;</div></li><li><div>                    $columns_array = $columns;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $columns_array = array_map('trim', array_merge($columns_array, $extended_columns));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                // we're building one dropdown per column&nbsp;</div></li><li><div>                $dropdown = '&lt;div class=&quot;match-dropdown&quot;&gt;'.$helper_form-&gt;dropdown(array('id' =&gt; 'column-match-'.$i, 'name' =&gt; 'wysija[match]['.$i.']', 'class' =&gt; 'create_extra row-'.$column_key), $columns_array, $selected).'&lt;/div&gt;';&nbsp;</div></li><li><div>                /**&nbsp;</div></li><li><div>                 * We need to improve the import, fields come back to options for columns later on.&nbsp;</div></li><li><div>                if (isset($this-&gt;new_column_can_be_imported[$column_key])) {&nbsp;</div></li><li><div>                    $dropdown .= '&lt;div class=&quot;import-new-field&quot; id=&quot;column-match-date-wrap-'.$i.'&quot;&gt;&lt;input id=&quot;column-match-date-'.$i.'&quot;  type=&quot;checkbox&quot; name=&quot;wysija[ignore_invalid_date]['.$i.']&quot;\&gt;&lt;label for=&quot;column-match-date-'.$i.'&quot;&gt;' . __('Ignore invalid dates', WYSIJA) . '&lt;/label&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                */&nbsp;</div></li><li><div>                echo '&lt;th&gt;'.$dropdown.'&lt;/th&gt;';&nbsp;</div></li><li><div>                $i++;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>            &lt;/thead&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;tbody class=&quot;list:&lt;?php echo $this-&gt;model-&gt;table_name.' '.$this-&gt;model-&gt;table_name.'-list&quot; id=&quot;wysija-'.$this-&gt;model-&gt;table_name.'&quot;' ?&gt;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        $listingRows = '';&nbsp;</div></li><li><div>        $alt = true;&nbsp;</div></li><li><div>        $i = 0;&nbsp;</div></li><li><div>        foreach ($data['csv'] as $columns)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>        $classRow = '';&nbsp;</div></li><li><div>        if ($alt)&nbsp;</div></li><li><div>            $classRow = ' class=&quot;alternate&quot; ';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo &quot;&lt;tr $classRow&gt;&quot;;&nbsp;</div></li><li><div>        if (isset($data['firstrowisdata']))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $j = $i + 1;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $j = $i;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ($i == 0)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $valuefrow = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if (isset($data['firstrowisdata']))&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>            $valuefrow = '1&lt;input value=&quot;1&quot; type=&quot;hidden&quot; id=&quot;firstrowdata&quot; name=&quot;firstrowisdata&quot;  /&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            echo '&lt;td&gt;'.$valuefrow.'&lt;/td&gt;';&nbsp;</div></li><li><div>            //echo '&lt;td&gt;&lt;label for=&quot;firstrowdata&quot; class=&quot;title&quot; title=&quot;'.__(&quot;This line is not a header description, it is data and needs to be inserted!&quot;, WYSIJA).'&quot;&gt;&lt;input '.$checked.' type=&quot;checkbox&quot; id=&quot;firstrowdata&quot; name=&quot;firstrowisdata&quot;  /&gt;'.__(&quot;Insert line!&quot;, WYSIJA).'&lt;/label&gt;&lt;/td&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            echo '&lt;td&gt;'.$j.'&lt;/td&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ($columns as $key_col =&gt; $val)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>      $val = esc_html($val);&nbsp;</div></li><li><div>            if ($i == 0 && !isset($data['firstrowisdata']))&nbsp;</div></li><li><div>            echo '&lt;td&gt;&lt;strong&gt;'.$val.'&lt;/strong&gt;&lt;/td&gt;';&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>            if (!empty($this-&gt;new_column_can_be_imported[$key_col]))&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                $timestamp = strtotime($val);&nbsp;</div></li><li><div>                if ($timestamp &gt; 0)&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                $val_converted = '&lt;span class=&quot;converted-field-to-date row-'.$key_col.'&quot; title=&quot;'.__('Verify that the date in blue matches the original one.', WYSIJA).'&quot;&gt;'.date(get_option('date_format').' '.get_option('time_format'), $timestamp).'&lt;/span&gt;';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                else&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                $val_converted = '&lt;span class=&quot;converted-field-error row-'.$key_col.'&quot; title=&quot;'.__('Do not match as a \'date field\' if most of the rows for that column return the same error.', WYSIJA).'&quot;&gt;'.__('Error matching date.', WYSIJA).'&lt;/span&gt;';&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $val = ' &lt;span class=&quot;imported-field&quot;&gt;'.$val.'&lt;/span&gt;'.$val_converted;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            echo '&lt;td&gt;'.$val.'&lt;/td&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        echo '&lt;/tr&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $alt = !$alt;&nbsp;</div></li><li><div>        $i++;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ($data['totalrows'] &gt; 3)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                   &lt;tr class=&quot;alternate&quot; &gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        echo '&lt;td&gt;...&lt;/td&gt;';&nbsp;</div></li><li><div>        foreach ($data['csv'][0] as $col)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            echo '&lt;td&gt;...&lt;/td&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>                   &lt;/tr&gt;&nbsp;</div></li><li><div>                &lt;tr&gt;&lt;td&gt;&lt;?php echo $data['totalrows'] ?&gt;&lt;/td&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        foreach ($data['lastrow'] as $key_col =&gt; $val)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>        $val = esc_html($val);&nbsp;</div></li><li><div>        if (!empty($this-&gt;new_column_can_be_imported[$key_col]))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $timestamp = strtotime($val);&nbsp;</div></li><li><div>            if ($timestamp &gt; 0)&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>            $val_converted = '&lt;span class=&quot;converted-field-to-date row-'.$key_col.'&quot; title=&quot;'.__('Verify that the date in blue matches the original one.', WYSIJA).'&quot;&gt;'.date(get_option('date_format').' '.get_option('time_format'), $timestamp).'&lt;/span&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>            $val_converted = '&lt;span class=&quot;converted-field-error row-'.$key_col.'&quot; title=&quot;'.__('Do not match as a \'date field\' if most of the rows for that column return the same error.', WYSIJA).'&quot;&gt;'.__('Error matching date.', WYSIJA).'&lt;/span&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $val = ' &lt;span class=&quot;imported-field&quot;&gt;'.$val.'&lt;/span&gt;'.$val_converted;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        echo '&lt;td&gt;'.$val.'&lt;/td&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>                &lt;/tr&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>            &lt;/tbody&gt;&nbsp;</div></li><li><div>        &lt;/table&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    if ($data['errormatch'])&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    else&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>            &lt;table class=&quot;form-table&quot;&gt;&nbsp;</div></li><li><div>            &lt;tbody&gt;&nbsp;</div></li><li><div>                &lt;tr&gt;&nbsp;</div></li><li><div>                &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                    &lt;label for=&quot;name&quot;&gt;&lt;?php _e('Pick one or many lists', WYSIJA); ?&gt; &lt;/label&gt;&nbsp;</div></li><li><div>            &lt;p class=&quot;description&quot;&gt;&lt;?php _e('Pick the lists you want to import those subscribers to.', WYSIJA); ?&gt; &lt;/p&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>        //create an array of existing lists to import within&nbsp;</div></li><li><div>        $model_list = WYSIJA::get('list', 'model');&nbsp;</div></li><li><div>        $lists = $model_list-&gt;get(array('name', 'list_id'), array('is_enabled' =&gt; 1));&nbsp;</div></li><li><div>        //first value is to create new list&nbsp;</div></li><li><div>        $lists[] = array('name' =&gt; __('New list', WYSIJA), 'list_id' =&gt; 0);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        //create an array of active(status 99) follow_up emails aossicated to a list_id&nbsp;</div></li><li><div>        $helper_email = WYSIJA::get('email', 'helper');&nbsp;</div></li><li><div>        $follow_ups_per_list = $helper_email-&gt;get_active_follow_ups(array('subject', 'params'));&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $follow_up_name_per_list = array();&nbsp;</div></li><li><div>        foreach ($follow_ups_per_list as $list_id =&gt; $follow_ups)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>        if (!isset($follow_up_name_per_list[$list_id]))&nbsp;</div></li><li><div>            $follow_up_name_per_list[$list_id] = array();&nbsp;</div></li><li><div>        foreach ($follow_ups as $follow_up)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $follow_up_name_per_list[$list_id][] = $follow_up['subject'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $helper_form = WYSIJA::get('forms', 'helper');&nbsp;</div></li><li><div>        //field name for processing&nbsp;</div></li><li><div>        $field = 'list';&nbsp;</div></li><li><div>        $fieldHTML = '&lt;div&gt;';&nbsp;</div></li><li><div>        foreach ($lists as $list)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>        if ($list['list_id'] == 0)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $fieldHTML.= '&lt;p&gt;&lt;label for=&quot;'.$field.$list['list_id'].'&quot;&gt;';&nbsp;</div></li><li><div>            $fieldHTML.=$helper_form-&gt;checkbox(array('class' =&gt; 'validate[minCheckbox[1]] checkbox', 'id' =&gt; $field.$list['list_id'], 'name' =&gt; &quot;wysija[user_list][$field][]&quot;), $list['list_id']).'&lt;span&gt;'.$list['name'].'&lt;/span&gt;';&nbsp;</div></li><li><div>            $fieldHTML.='&lt;/label&gt; ';&nbsp;</div></li><li><div>            $fieldHTML.='&lt;span id=&quot;blocknewlist&quot;&gt;'.$helper_form-&gt;input(array('class' =&gt; 'validate[required]', 'id' =&gt; 'namenewlist', 'size' =&gt; 30, 'name' =&gt; 'wysija[list][newlistname]', 'value' =&gt; __('Type name of your new list', WYSIJA))).'&lt;/span&gt;&lt;/p&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $fieldHTML.= '&lt;p&gt;&lt;label for=&quot;'.$field.$list['list_id'].'&quot;&gt;'.$helper_form-&gt;checkbox(array('class' =&gt; 'validate[minCheckbox[1]] checkbox', 'id' =&gt; $field.$list['list_id'], 'name' =&gt; &quot;wysija[user_list][$field][]&quot;), $list['list_id']).$list['name'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if (isset($follow_up_name_per_list[$list['list_id']]))&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>            $fieldHTML.=' &lt;span style=&quot;margin-left:10px;&quot;&gt;&lt;strong&gt;'.__('Note:', WYSIJA).' &lt;/strong&gt;'.sprintf(__('subscribers will receive &quot;%1$s&quot; after import.', WYSIJA), implode(', ', $follow_up_name_per_list[$list['list_id']])).'&lt;/span&gt;';&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $fieldHTML.='&lt;/label&gt;&lt;/p&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $fieldHTML .= '&lt;/div&gt;';&nbsp;</div></li><li><div>        echo $fieldHTML;&nbsp;</div></li><li><div>        ?&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>            &lt;/tr&gt;&nbsp;</div></li><li><div>            &lt;/tbody&gt;&nbsp;</div></li><li><div>            &lt;/table&gt;&nbsp;</div></li><li><div>            &lt;p class=&quot;submit&quot;&gt;&nbsp;</div></li><li><div>        &lt;?php $this-&gt;secure(array('action' =&gt; 'import_save')); ?&gt;&nbsp;</div></li><li><div>            &lt;input type=&quot;hidden&quot; value=&quot;&lt;?php echo esc_attr($data['dataImport']) ?&gt;&quot; name=&quot;wysija[dataImport]&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;input type=&quot;hidden&quot; value=&quot;import_save&quot; name=&quot;action&quot; /&gt;&nbsp;</div></li><li><div>            &lt;input type=&quot;submit&quot; value=&quot;&lt;?php echo esc_attr(__('Import', WYSIJA)) ?&gt;&quot; class=&quot;button-primary wysija&quot;&gt;&nbsp;</div></li><li><div>            &lt;/p&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>    &lt;/form&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function import_save($data)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function importplugins($data)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    echo '&lt;form class=&quot;form-valid&quot; action=&quot;admin.php?page=wysija_subscribers&action=lists&quot; id=&quot;wysija-edit&quot; method=&quot;post&quot;  name=&quot;wysija-edit&quot;&gt;';&nbsp;</div></li><li><div>    echo '&lt;ul&gt;';&nbsp;</div></li><li><div>    $config = WYSIJA::get('config', 'model');&nbsp;</div></li><li><div>    $imported_already = $config-&gt;getValue('pluginsImportedEgg');&nbsp;</div></li><li><div>    foreach ($data['plugins'] as $tablename =&gt; $pluginInfos)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if (is_array($imported_already) && in_array($tablename, $imported_already))&nbsp;</div></li><li><div>        continue;&nbsp;</div></li><li><div>        echo '&lt;li&gt;&lt;label for=&quot;import-'.$tablename.'1&quot;&gt;';&nbsp;</div></li><li><div>        echo sprintf(__('Import the %1$s subscribers from the plugin: %2$s ', WYSIJA), &quot;&lt;strong&gt;&quot;.$pluginInfos['total'].&quot;&lt;/strong&gt;&quot;, &quot;&lt;strong&gt;&quot;.$pluginInfos['name'].&quot;&lt;/strong&gt;&quot;).'&lt;/label&gt;';&nbsp;</div></li><li><div>        echo '&lt;label for=&quot;import-'.$tablename.'1&quot;&gt;&lt;input checked=&quot;checked&quot; type=&quot;radio&quot; id=&quot;import-'.$tablename.'1&quot; name=&quot;wysija[import]['.$tablename.']&quot; value=&quot;1&quot; /&gt;'.__('Yes', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        echo '&lt;label for=&quot;import-'.$tablename.'0&quot;&gt;&lt;input type=&quot;radio&quot; id=&quot;import-'.$tablename.'0&quot; name=&quot;wysija[import]['.$tablename.']&quot; value=&quot;0&quot; /&gt;'.__('No', WYSIJA).'&lt;/label&gt;';&nbsp;</div></li><li><div>        echo '&lt;/li&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    echo '&lt;/ul&gt;';&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>    &lt;p class=&quot;submit&quot;&gt;&nbsp;</div></li><li><div>    &lt;?php $this-&gt;secure(array('action' =&gt; &quot;importpluginsave&quot;)); ?&gt;&nbsp;</div></li><li><div>        &lt;input type=&quot;hidden&quot; value=&quot;importpluginsave&quot; name=&quot;action&quot; /&gt;&nbsp;</div></li><li><div>        &lt;input type=&quot;submit&quot; value=&quot;&lt;?php echo esc_attr(__('Import', WYSIJA)) ?&gt;&quot; class=&quot;button-primary wysija&quot;&gt;&nbsp;</div></li><li><div>    &lt;/p&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    echo '&lt;/form&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 2.7.4</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.9/classes/wysija_view_back_subscribers/" class="">2.7.9</a></li><li><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.8/classes/wysija_view_back_subscribers/" class="">2.7.8</a></li><li><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.6/classes/wysija_view_back_subscribers/" class="">2.7.6</a></li><li><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.5/classes/wysija_view_back_subscribers/" class="active">2.7.5</a></li><li><a href="http://hookr.io/plugins/mailpoet-newsletters/2.7.4/classes/wysija_view_back_subscribers/" class="">2.7.4</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>WYSIJA_view_back_subscribers</li><li><span></span>MailPoet Newsletters</li><li><span></span>2.7.9</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>