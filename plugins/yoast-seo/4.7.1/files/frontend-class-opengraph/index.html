<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="4.7.1" data-slug="yoast-seo" data-type="file" data-id="14430"><head xmlns="http://www.w3.org/1999/xhtml"><title> frontend-class-opengraph | file | Yoast Seo | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, yoast-seo, 4.7.1" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=bafaf6cb711a66832e74a3bd8c6be6ed' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/frontend-class-opengraph/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Ffrontend-class-opengraph%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Ffrontend-class-opengraph%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-yoast-seo-4.7.1-file-frontend-class-opengraph","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="frontend-class-opengraph" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to yoast-seo." href="http://hookr.io/plugins/yoast-seo/" class="plugin"><span property="name">yoast-seo</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 4.7.1." href="http://hookr.io/plugins/yoast-seo/4.7.1/" class="H_VERSION"><span property="name">4.7.1</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/yoast-seo/4.7.1/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">frontend-class-opengraph</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="558"><a href="http://hookr.io/plugins/yoast-seo/4.7.1/all/" title="All">All <span class="count badge">558</span></a></li><li class="" data-id="new" data-count="3"><a href="http://hookr.io/plugins/yoast-seo/4.7.1/new/" title="New">New <span class="count badge">3</span></a></li><li class="" data-id="hooks" data-count="187"><a href="http://hookr.io/plugins/yoast-seo/4.7.1/hooks/" title="Hooks">Hooks <span class="count badge">187</span></a></li><li class="" data-id="action" data-count="44"><a href="http://hookr.io/plugins/yoast-seo/4.7.1/actions/" title="Actions">Actions <span class="count badge">44</span></a></li><li class="" data-id="filter" data-count="143"><a href="http://hookr.io/plugins/yoast-seo/4.7.1/filters/" title="Filters">Filters <span class="count badge">143</span></a></li><li class="" data-id="class" data-count="256"><a href="http://hookr.io/plugins/yoast-seo/4.7.1/classes/" title="Classes">Classes <span class="count badge">256</span></a></li><li class="" data-id="constant" data-count="10"><a href="http://hookr.io/plugins/yoast-seo/4.7.1/constants/" title="Constants">Constants <span class="count badge">10</span></a></li><li class="" data-id="function" data-count="103"><a href="http://hookr.io/plugins/yoast-seo/4.7.1/functions/" title="Functions">Functions <span class="count badge">103</span></a></li><li class="" data-id="shortcode" data-count="2"><a href="http://hookr.io/plugins/yoast-seo/4.7.1/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">2</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/frontend/class-opengraph.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @package WPSEO\Frontend</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * This code adds the OpenGraph output.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>class WPSEO_OpenGraph {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @var array $options Options for the OpenGraph Settings</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public $options = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Class constructor.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function __construct() {&nbsp;</div></li><li><div>      $this-&gt;options = WPSEO_Options::get_option( 'wpseo_social' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $GLOBALS['fb_ver'] ) || class_exists( 'Facebook_Loader', false ) ) {&nbsp;</div></li><li><div>          add_filter( 'fb_meta_tags', array( $this, 'facebook_filter' ), 10, 1 );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          add_filter( 'language_attributes', array( $this, 'add_opengraph_namespace' ), 15 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_action( 'wpseo_opengraph', array( $this, 'locale' ), 1 );&nbsp;</div></li><li><div>          add_action( 'wpseo_opengraph', array( $this, 'type' ), 5 );&nbsp;</div></li><li><div>          add_action( 'wpseo_opengraph', array( $this, 'og_title' ), 10 );&nbsp;</div></li><li><div>          add_action( 'wpseo_opengraph', array( $this, 'site_owner' ), 20 );&nbsp;</div></li><li><div>          add_action( 'wpseo_opengraph', array( $this, 'description' ), 11 );&nbsp;</div></li><li><div>          add_action( 'wpseo_opengraph', array( $this, 'url' ), 12 );&nbsp;</div></li><li><div>          add_action( 'wpseo_opengraph', array( $this, 'site_name' ), 13 );&nbsp;</div></li><li><div>          add_action( 'wpseo_opengraph', array( $this, 'website_facebook' ), 14 );&nbsp;</div></li><li><div>          if ( is_singular() && ! is_front_page() ) {&nbsp;</div></li><li><div>              add_action( 'wpseo_opengraph', array( $this, 'article_author_facebook' ), 15 );&nbsp;</div></li><li><div>              add_action( 'wpseo_opengraph', array( $this, 'tags' ), 16 );&nbsp;</div></li><li><div>              add_action( 'wpseo_opengraph', array( $this, 'category' ), 17 );&nbsp;</div></li><li><div>              add_action( 'wpseo_opengraph', array( $this, 'publish_date' ), 19 );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_action( 'wpseo_opengraph', array( $this, 'image' ), 30 );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      add_filter( 'jetpack_enable_open_graph', '__return_false' );&nbsp;</div></li><li><div>      add_action( 'wpseo_head', array( $this, 'opengraph' ), 30 );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Main OpenGraph output.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function opengraph() {&nbsp;</div></li><li><div>      wp_reset_query();&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Action: 'wpseo_opengraph' - Hook to add all Facebook OpenGraph output to so they're close together.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      do_action( 'wpseo_opengraph' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Internal function to output FB tags. This also adds an output filter to each bit of output based on the property.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $property Property attribute value.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $content  Content attribute value.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function og_tag( $property, $content ) {&nbsp;</div></li><li><div>      $og_property = str_replace( ':', '_', $property );&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter: 'wpseo_og_' . $og_property - Allow developers to change the content of specific OG meta tags.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @api string $content The content of the property</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $content = apply_filters( 'wpseo_og_' . $og_property, $content );&nbsp;</div></li><li><div>      if ( empty( $content ) ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo '&lt;meta property=&quot;', esc_attr( $property ), '&quot; content=&quot;', esc_attr( $content ), '&quot; /&gt;', &quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filter the Facebook plugins metadata</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $meta_tags the array to fix.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array $meta_tags</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function facebook_filter( $meta_tags ) {&nbsp;</div></li><li><div>      $meta_tags['http:<span class="comment">//ogp.me/ns#type'] = $this-&gt;type( false );</span>&nbsp;</div></li><li><div>      $meta_tags['http:<span class="comment">//ogp.me/ns#title'] = $this-&gt;og_title( false );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Filter the locale too because the Facebook plugin locale code is not as good as ours.</span>&nbsp;</div></li><li><div>      $meta_tags['http:<span class="comment">//ogp.me/ns#locale'] = $this-&gt;locale( false );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $ogdesc = $this-&gt;description( false );&nbsp;</div></li><li><div>      if ( ! empty( $ogdesc ) ) {&nbsp;</div></li><li><div>          $meta_tags['http:<span class="comment">//ogp.me/ns#description'] = $ogdesc;</span>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $meta_tags;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filter for the namespace, adding the OpenGraph namespace.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @link https://developers.facebook.com/docs/web/tutorials/scrumptious/open-graph-object/</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $input The input namespace string.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function add_opengraph_namespace( $input ) {&nbsp;</div></li><li><div>      $namespaces = array(&nbsp;</div></li><li><div>          'og: http:<span class="comment">//ogp.me/ns#', </span>&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      if ( $this-&gt;options['fbadminapp'] != 0 || ( is_array( $this-&gt;options['fb_admins'] ) && $this-&gt;options['fb_admins'] !== array() ) ) {&nbsp;</div></li><li><div>          $namespaces[] = 'fb: http:<span class="comment">//ogp.me/ns/fb#';</span>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Allow for adding additional namespaces to the &lt;html&gt; prefix attributes.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since 3.9.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param array $namespaces Currently registered namespaces which are to be</span>&nbsp;</div></li><li><div><span class="comment">       *                          added to the prefix attribute.</span>&nbsp;</div></li><li><div><span class="comment">       *                          Namespaces are strings and have the following syntax:</span>&nbsp;</div></li><li><div><span class="comment">       *                          ns: http://url.to.namespace/definition</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $namespaces = apply_filters( 'wpseo_html_namespaces', $namespaces );&nbsp;</div></li><li><div>      $namespace_string = implode( ' ', array_unique( $namespaces ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( strpos( $input, ' prefix=' ) !== false ) {&nbsp;</div></li><li><div>          $regex = '`prefix=([\'&quot;])(.+?)\1`';&nbsp;</div></li><li><div>          $replace = 'prefix=&quot;$2 ' . $namespace_string . '&quot;';&nbsp;</div></li><li><div>          $input = preg_replace( $regex, $replace, $input );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          $input .= ' prefix=&quot;' . $namespace_string . '&quot;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $input;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Outputs the authors FB page.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @link https://developers.facebook.com/blog/post/2013/06/19/platform-updates--new-open-graph-tags-for-media-publishers-and-more/</span>&nbsp;</div></li><li><div><span class="comment">   * @link https://developers.facebook.com/docs/reference/opengraph/object-type/article/</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function article_author_facebook() {&nbsp;</div></li><li><div>      if ( ! is_singular() ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter: 'wpseo_opengraph_author_facebook' - Allow developers to filter the Yoast SEO post authors facebook profile URL</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @api bool|string $unsigned The Facebook author URL, return false to disable</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $facebook = apply_filters( 'wpseo_opengraph_author_facebook', get_the_author_meta( 'facebook', $GLOBALS['post']-&gt;post_author ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $facebook && ( is_string( $facebook ) && $facebook !== '' ) ) {&nbsp;</div></li><li><div>          $this-&gt;og_tag( 'article:author', $facebook );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Outputs the websites FB page.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @link https://developers.facebook.com/blog/post/2013/06/19/platform-updates--new-open-graph-tags-for-media-publishers-and-more/</span>&nbsp;</div></li><li><div><span class="comment">   * @link https://developers.facebook.com/docs/reference/opengraph/object-type/article/</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function website_facebook() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 'article' === $this-&gt;type( false ) && ! empty( $this-&gt;options['facebook_site'] ) ) {&nbsp;</div></li><li><div>          $this-&gt;og_tag( 'article:publisher', $this-&gt;options['facebook_site'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Outputs the site owner</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @link https://developers.facebook.com/docs/reference/opengraph/object-type/article/</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function site_owner() {&nbsp;</div></li><li><div>      if ( isset( $this-&gt;options['fbadminapp'] ) && $this-&gt;options['fbadminapp'] != 0 ) {&nbsp;</div></li><li><div>          $this-&gt;og_tag( 'fb:app_id', $this-&gt;options['fbadminapp'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else if ( isset( $this-&gt;options['fb_admins'] ) && is_array( $this-&gt;options['fb_admins'] ) && $this-&gt;options['fb_admins'] !== array() ) {&nbsp;</div></li><li><div>          $adminstr = implode( ', ', array_keys( $this-&gt;options['fb_admins'] ) );&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Filter: 'wpseo_opengraph_admin' - Allow developer to filter the fb:admins string put out by Yoast SEO</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @api string $adminstr The admin string</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          $adminstr = apply_filters( 'wpseo_opengraph_admin', $adminstr );&nbsp;</div></li><li><div>          if ( is_string( $adminstr ) && $adminstr !== '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $admins = explode( ', ', $adminstr );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( $admins as $admin_id ) {&nbsp;</div></li><li><div>                  $this-&gt;og_tag( 'fb:admins', $admin_id );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Outputs the SEO title as OpenGraph title.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @link https://developers.facebook.com/docs/reference/opengraph/object-type/article/</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $echo Whether or not to echo the output.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string|boolean</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function og_title( $echo = true ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $frontend = WPSEO_Frontend::get_instance();&nbsp;</div></li><li><div>      $is_posts_page = $frontend-&gt;is_posts_page();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_singular() || $is_posts_page ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $post_id = ( $is_posts_page ) ? get_option( 'page_for_posts' ) : get_the_ID();&nbsp;</div></li><li><div>          $post = get_post( $post_id );&nbsp;</div></li><li><div>          $title = WPSEO_Meta::get_value( 'opengraph-title', $post_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $title === '' ) {&nbsp;</div></li><li><div>              $title = $frontend-&gt;title( '' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          else {&nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment">// Replace Yoast SEO Variables.</span></span></span>&nbsp;</div></li><li><div>              $title = wpseo_replace_vars( $title, $post );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else if ( is_front_page() ) {&nbsp;</div></li><li><div>          $title = ( isset( $this-&gt;options['og_frontpage_title'] ) && $this-&gt;options['og_frontpage_title'] !== '' ) ? $this-&gt;options['og_frontpage_title'] : $frontend-&gt;title( '' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      elseif ( is_category() || is_tax() || is_tag() ) {&nbsp;</div></li><li><div>          $title = WPSEO_Taxonomy_Meta::get_meta_without_term( 'opengraph-title' );&nbsp;</div></li><li><div>          if ( $title === '' ) {&nbsp;</div></li><li><div>              $title = $frontend-&gt;title( '' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          else {&nbsp;</div></li><li><div>              <span class="comment"><span class="comment"><span class="comment">// Replace Yoast SEO Variables.</span></span></span>&nbsp;</div></li><li><div>              $title = wpseo_replace_vars( $title, $GLOBALS['wp_query']-&gt;get_queried_object() );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          $title = $frontend-&gt;title( '' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter: 'wpseo_opengraph_title' - Allow changing the title specifically for OpenGraph</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @api string $unsigned The title string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $title = trim( apply_filters( 'wpseo_opengraph_title', $title ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_string( $title ) && $title !== '' ) {&nbsp;</div></li><li><div>          if ( $echo !== false ) {&nbsp;</div></li><li><div>              $this-&gt;og_tag( 'og:title', $title );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return true;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $echo === false ) {&nbsp;</div></li><li><div>          return $title;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Outputs the canonical URL as OpenGraph URL, which consolidates likes and shares.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @link https://developers.facebook.com/docs/reference/opengraph/object-type/article/</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function url() {&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter: 'wpseo_opengraph_url' - Allow changing the OpenGraph URL</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @api string $unsigned Canonical URL</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $url = apply_filters( 'wpseo_opengraph_url', WPSEO_Frontend::get_instance()-&gt;canonical( false ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_string( $url ) && $url !== '' ) {&nbsp;</div></li><li><div>          $this-&gt;og_tag( 'og:url', esc_url( $url ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Output the locale, doing some conversions to make sure the proper Facebook locale is outputted.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Last update/compare with FB list done on 2015-03-16 by Rarst</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @see  http://www.facebook.com/translations/FacebookLocales.xml for the list of supported locales</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @link https://developers.facebook.com/docs/reference/opengraph/object-type/article/</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $echo Whether to echo or return the locale.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string $locale</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function locale( $echo = true ) {&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter: 'wpseo_locale' - Allow changing the locale output</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @api string $unsigned Locale string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $locale = apply_filters( 'wpseo_locale', get_locale() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Catch some weird locales served out by WP that are not easily doubled up.</span>&nbsp;</div></li><li><div>      $fix_locales = array(&nbsp;</div></li><li><div>          'ca' =&gt; 'ca_ES', &nbsp;</div></li><li><div>          'en' =&gt; 'en_US', &nbsp;</div></li><li><div>          'el' =&gt; 'el_GR', &nbsp;</div></li><li><div>          'et' =&gt; 'et_EE', &nbsp;</div></li><li><div>          'ja' =&gt; 'ja_JP', &nbsp;</div></li><li><div>          'sq' =&gt; 'sq_AL', &nbsp;</div></li><li><div>          'uk' =&gt; 'uk_UA', &nbsp;</div></li><li><div>          'vi' =&gt; 'vi_VN', &nbsp;</div></li><li><div>          'zh' =&gt; 'zh_CN', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( isset( $fix_locales[ $locale ] ) ) {&nbsp;</div></li><li><div>          $locale = $fix_locales[ $locale ];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Convert locales like &quot;es&quot; to &quot;es_ES&quot;, in case that works for the given locale (sometimes it does).</span>&nbsp;</div></li><li><div>      if ( strlen( $locale ) == 2 ) {&nbsp;</div></li><li><div>          $locale = strtolower( $locale ) . '_' . strtoupper( $locale );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// These are the locales FB supports.</span>&nbsp;</div></li><li><div>      $fb_valid_fb_locales = array(&nbsp;</div></li><li><div>          'af_ZA', <span class="comment">// Afrikaans.</span>&nbsp;</div></li><li><div>          'ak_GH', <span class="comment">// Akan.</span>&nbsp;</div></li><li><div>          'am_ET', <span class="comment">// Amharic.</span>&nbsp;</div></li><li><div>          'ar_AR', <span class="comment">// Arabic.</span>&nbsp;</div></li><li><div>          'as_IN', <span class="comment">// Assamese.</span>&nbsp;</div></li><li><div>          'ay_BO', <span class="comment">// Aymara.</span>&nbsp;</div></li><li><div>          'az_AZ', <span class="comment">// Azerbaijani.</span>&nbsp;</div></li><li><div>          'be_BY', <span class="comment">// Belarusian.</span>&nbsp;</div></li><li><div>          'bg_BG', <span class="comment">// Bulgarian.</span>&nbsp;</div></li><li><div>          'bn_IN', <span class="comment">// Bengali.</span>&nbsp;</div></li><li><div>          'br_FR', <span class="comment">// Breton.</span>&nbsp;</div></li><li><div>          'bs_BA', <span class="comment">// Bosnian.</span>&nbsp;</div></li><li><div>          'ca_ES', <span class="comment">// Catalan.</span>&nbsp;</div></li><li><div>          'cb_IQ', <span class="comment">// Sorani Kurdish.</span>&nbsp;</div></li><li><div>          'ck_US', <span class="comment">// Cherokee.</span>&nbsp;</div></li><li><div>          'co_FR', <span class="comment">// Corsican.</span>&nbsp;</div></li><li><div>          'cs_CZ', <span class="comment">// Czech.</span>&nbsp;</div></li><li><div>          'cx_PH', <span class="comment">// Cebuano.</span>&nbsp;</div></li><li><div>          'cy_GB', <span class="comment">// Welsh.</span>&nbsp;</div></li><li><div>          'da_DK', <span class="comment">// Danish.</span>&nbsp;</div></li><li><div>          'de_DE', <span class="comment">// German.</span>&nbsp;</div></li><li><div>          'el_GR', <span class="comment">// Greek.</span>&nbsp;</div></li><li><div>          'en_GB', <span class="comment">// English (UK).</span>&nbsp;</div></li><li><div>          'en_IN', <span class="comment">// English (India).</span>&nbsp;</div></li><li><div>          'en_PI', <span class="comment">// English (Pirate).</span>&nbsp;</div></li><li><div>          'en_UD', <span class="comment">// English (Upside Down).</span>&nbsp;</div></li><li><div>          'en_US', <span class="comment">// English (US).</span>&nbsp;</div></li><li><div>          'eo_EO', <span class="comment">// Esperanto.</span>&nbsp;</div></li><li><div>          'es_CL', <span class="comment">// Spanish (Chile).</span>&nbsp;</div></li><li><div>          'es_CO', <span class="comment">// Spanish (Colombia).</span>&nbsp;</div></li><li><div>          'es_ES', <span class="comment">// Spanish (Spain).</span>&nbsp;</div></li><li><div>          'es_LA', <span class="comment">// Spanish.</span>&nbsp;</div></li><li><div>          'es_MX', <span class="comment">// Spanish (Mexico).</span>&nbsp;</div></li><li><div>          'es_VE', <span class="comment">// Spanish (Venezuela).</span>&nbsp;</div></li><li><div>          'et_EE', <span class="comment">// Estonian.</span>&nbsp;</div></li><li><div>          'eu_ES', <span class="comment">// Basque.</span>&nbsp;</div></li><li><div>          'fa_IR', <span class="comment">// Persian.</span>&nbsp;</div></li><li><div>          'fb_LT', <span class="comment">// Leet Speak.</span>&nbsp;</div></li><li><div>          'ff_NG', <span class="comment">// Fulah.</span>&nbsp;</div></li><li><div>          'fi_FI', <span class="comment">// Finnish.</span>&nbsp;</div></li><li><div>          'fo_FO', <span class="comment">// Faroese.</span>&nbsp;</div></li><li><div>          'fr_CA', <span class="comment">// French (Canada).</span>&nbsp;</div></li><li><div>          'fr_FR', <span class="comment">// French (France).</span>&nbsp;</div></li><li><div>          'fy_NL', <span class="comment">// Frisian.</span>&nbsp;</div></li><li><div>          'ga_IE', <span class="comment">// Irish.</span>&nbsp;</div></li><li><div>          'gl_ES', <span class="comment">// Galician.</span>&nbsp;</div></li><li><div>          'gn_PY', <span class="comment">// Guarani.</span>&nbsp;</div></li><li><div>          'gu_IN', <span class="comment">// Gujarati.</span>&nbsp;</div></li><li><div>          'gx_GR', <span class="comment">// Classical Greek.</span>&nbsp;</div></li><li><div>          'ha_NG', <span class="comment">// Hausa.</span>&nbsp;</div></li><li><div>          'he_IL', <span class="comment">// Hebrew.</span>&nbsp;</div></li><li><div>          'hi_IN', <span class="comment">// Hindi.</span>&nbsp;</div></li><li><div>          'hr_HR', <span class="comment">// Croatian.</span>&nbsp;</div></li><li><div>          'hu_HU', <span class="comment">// Hungarian.</span>&nbsp;</div></li><li><div>          'hy_AM', <span class="comment">// Armenian.</span>&nbsp;</div></li><li><div>          'id_ID', <span class="comment">// Indonesian.</span>&nbsp;</div></li><li><div>          'ig_NG', <span class="comment">// Igbo.</span>&nbsp;</div></li><li><div>          'is_IS', <span class="comment">// Icelandic.</span>&nbsp;</div></li><li><div>          'it_IT', <span class="comment">// Italian.</span>&nbsp;</div></li><li><div>          'ja_JP', <span class="comment">// Japanese.</span>&nbsp;</div></li><li><div>          'ja_KS', <span class="comment">// Japanese (Kansai).</span>&nbsp;</div></li><li><div>          'jv_ID', <span class="comment">// Javanese.</span>&nbsp;</div></li><li><div>          'ka_GE', <span class="comment">// Georgian.</span>&nbsp;</div></li><li><div>          'kk_KZ', <span class="comment">// Kazakh.</span>&nbsp;</div></li><li><div>          'km_KH', <span class="comment">// Khmer.</span>&nbsp;</div></li><li><div>          'kn_IN', <span class="comment">// Kannada.</span>&nbsp;</div></li><li><div>          'ko_KR', <span class="comment">// Korean.</span>&nbsp;</div></li><li><div>          'ku_TR', <span class="comment">// Kurdish (Kurmanji).</span>&nbsp;</div></li><li><div>          'ky_KG', <span class="comment">// Kyrgyz.</span>&nbsp;</div></li><li><div>          'la_VA', <span class="comment">// Latin.</span>&nbsp;</div></li><li><div>          'lg_UG', <span class="comment">// Ganda.</span>&nbsp;</div></li><li><div>          'li_NL', <span class="comment">// Limburgish.</span>&nbsp;</div></li><li><div>          'ln_CD', <span class="comment">// Lingala.</span>&nbsp;</div></li><li><div>          'lo_LA', <span class="comment">// Lao.</span>&nbsp;</div></li><li><div>          'lt_LT', <span class="comment">// Lithuanian.</span>&nbsp;</div></li><li><div>          'lv_LV', <span class="comment">// Latvian.</span>&nbsp;</div></li><li><div>          'mg_MG', <span class="comment">// Malagasy.</span>&nbsp;</div></li><li><div>          'mi_NZ', <span class="comment">// Maori.</span>&nbsp;</div></li><li><div>          'mk_MK', <span class="comment">// Macedonian.</span>&nbsp;</div></li><li><div>          'ml_IN', <span class="comment">// Malayalam.</span>&nbsp;</div></li><li><div>          'mn_MN', <span class="comment">// Mongolian.</span>&nbsp;</div></li><li><div>          'mr_IN', <span class="comment">// Marathi.</span>&nbsp;</div></li><li><div>          'ms_MY', <span class="comment">// Malay.</span>&nbsp;</div></li><li><div>          'mt_MT', <span class="comment">// Maltese.</span>&nbsp;</div></li><li><div>          'my_MM', <span class="comment">// Burmese.</span>&nbsp;</div></li><li><div>          'nb_NO', <span class="comment">// Norwegian (bokmal).</span>&nbsp;</div></li><li><div>          'nd_ZW', <span class="comment">// Ndebele.</span>&nbsp;</div></li><li><div>          'ne_NP', <span class="comment">// Nepali.</span>&nbsp;</div></li><li><div>          'nl_BE', <span class="comment">// Dutch (Belgie).</span>&nbsp;</div></li><li><div>          'nl_NL', <span class="comment">// Dutch.</span>&nbsp;</div></li><li><div>          'nn_NO', <span class="comment">// Norwegian (nynorsk).</span>&nbsp;</div></li><li><div>          'ny_MW', <span class="comment">// Chewa.</span>&nbsp;</div></li><li><div>          'or_IN', <span class="comment">// Oriya.</span>&nbsp;</div></li><li><div>          'pa_IN', <span class="comment">// Punjabi.</span>&nbsp;</div></li><li><div>          'pl_PL', <span class="comment">// Polish.</span>&nbsp;</div></li><li><div>          'ps_AF', <span class="comment">// Pashto.</span>&nbsp;</div></li><li><div>          'pt_BR', <span class="comment">// Portuguese (Brazil).</span>&nbsp;</div></li><li><div>          'pt_PT', <span class="comment">// Portuguese (Portugal).</span>&nbsp;</div></li><li><div>          'qu_PE', <span class="comment">// Quechua.</span>&nbsp;</div></li><li><div>          'rm_CH', <span class="comment">// Romansh.</span>&nbsp;</div></li><li><div>          'ro_RO', <span class="comment">// Romanian.</span>&nbsp;</div></li><li><div>          'ru_RU', <span class="comment">// Russian.</span>&nbsp;</div></li><li><div>          'rw_RW', <span class="comment">// Kinyarwanda.</span>&nbsp;</div></li><li><div>          'sa_IN', <span class="comment">// Sanskrit.</span>&nbsp;</div></li><li><div>          'sc_IT', <span class="comment">// Sardinian.</span>&nbsp;</div></li><li><div>          'se_NO', <span class="comment">// Northern Sami.</span>&nbsp;</div></li><li><div>          'si_LK', <span class="comment">// Sinhala.</span>&nbsp;</div></li><li><div>          'sk_SK', <span class="comment">// Slovak.</span>&nbsp;</div></li><li><div>          'sl_SI', <span class="comment">// Slovenian.</span>&nbsp;</div></li><li><div>          'sn_ZW', <span class="comment">// Shona.</span>&nbsp;</div></li><li><div>          'so_SO', <span class="comment">// Somali.</span>&nbsp;</div></li><li><div>          'sq_AL', <span class="comment">// Albanian.</span>&nbsp;</div></li><li><div>          'sr_RS', <span class="comment">// Serbian.</span>&nbsp;</div></li><li><div>          'sv_SE', <span class="comment">// Swedish.</span>&nbsp;</div></li><li><div>          'sw_KE', <span class="comment">// Swahili.</span>&nbsp;</div></li><li><div>          'sy_SY', <span class="comment">// Syriac.</span>&nbsp;</div></li><li><div>          'sz_PL', <span class="comment">// Silesian.</span>&nbsp;</div></li><li><div>          'ta_IN', <span class="comment">// Tamil.</span>&nbsp;</div></li><li><div>          'te_IN', <span class="comment">// Telugu.</span>&nbsp;</div></li><li><div>          'tg_TJ', <span class="comment">// Tajik.</span>&nbsp;</div></li><li><div>          'th_TH', <span class="comment">// Thai.</span>&nbsp;</div></li><li><div>          'tk_TM', <span class="comment">// Turkmen.</span>&nbsp;</div></li><li><div>          'tl_PH', <span class="comment">// Filipino.</span>&nbsp;</div></li><li><div>          'tl_ST', <span class="comment">// Klingon.</span>&nbsp;</div></li><li><div>          'tr_TR', <span class="comment">// Turkish.</span>&nbsp;</div></li><li><div>          'tt_RU', <span class="comment">// Tatar.</span>&nbsp;</div></li><li><div>          'tz_MA', <span class="comment">// Tamazight.</span>&nbsp;</div></li><li><div>          'uk_UA', <span class="comment">// Ukrainian.</span>&nbsp;</div></li><li><div>          'ur_PK', <span class="comment">// Urdu.</span>&nbsp;</div></li><li><div>          'uz_UZ', <span class="comment">// Uzbek.</span>&nbsp;</div></li><li><div>          'vi_VN', <span class="comment">// Vietnamese.</span>&nbsp;</div></li><li><div>          'wo_SN', <span class="comment">// Wolof.</span>&nbsp;</div></li><li><div>          'xh_ZA', <span class="comment">// Xhosa.</span>&nbsp;</div></li><li><div>          'yi_DE', <span class="comment">// Yiddish.</span>&nbsp;</div></li><li><div>          'yo_NG', <span class="comment">// Yoruba.</span>&nbsp;</div></li><li><div>          'zh_CN', <span class="comment">// Simplified Chinese (China).</span>&nbsp;</div></li><li><div>          'zh_HK', <span class="comment">// Traditional Chinese (Hong Kong).</span>&nbsp;</div></li><li><div>          'zh_TW', <span class="comment">// Traditional Chinese (Taiwan).</span>&nbsp;</div></li><li><div>          'zu_ZA', <span class="comment">// Zulu.</span>&nbsp;</div></li><li><div>          'zz_TR', <span class="comment">// Zazaki.</span>&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Check to see if the locale is a valid FB one, if not, use en_US as a fallback.</span>&nbsp;</div></li><li><div>      if ( ! in_array( $locale, $fb_valid_fb_locales ) ) {&nbsp;</div></li><li><div>          $locale = strtolower( substr( $locale, 0, 2 ) ) . '_' . strtoupper( substr( $locale, 0, 2 ) );&nbsp;</div></li><li><div>          if ( ! in_array( $locale, $fb_valid_fb_locales ) ) {&nbsp;</div></li><li><div>              $locale = 'en_US';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $echo !== false ) {&nbsp;</div></li><li><div>          $this-&gt;og_tag( 'og:locale', $locale );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $locale;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Output the OpenGraph type.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param boolean $echo Whether to echo or return the type.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @link https://developers.facebook.com/docs/reference/opengraph/object-type/object/</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string $type</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function type( $echo = true ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_front_page() || is_home() ) {&nbsp;</div></li><li><div>          $type = 'website';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      elseif ( is_singular() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// This'll usually only be changed by plugins right now.</span>&nbsp;</div></li><li><div>          $type = WPSEO_Meta::get_value( 'og_type' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $type === '' ) {&nbsp;</div></li><li><div>              $type = 'article';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          <span class="comment">// We use &quot;object&quot; for archives etc. as article doesn't apply there.</span>&nbsp;</div></li><li><div>          $type = 'object';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter: 'wpseo_opengraph_type' - Allow changing the OpenGraph type of the page</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @api string $type The OpenGraph type string.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $type = apply_filters( 'wpseo_opengraph_type', $type );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_string( $type ) && $type !== '' ) {&nbsp;</div></li><li><div>          if ( $echo !== false ) {&nbsp;</div></li><li><div>              $this-&gt;og_tag( 'og:type', $type );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          else {&nbsp;</div></li><li><div>              return $type;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Create new WPSEO_OpenGraph_Image class and get the images to set the og:image</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string|boolean $image Optional image URL.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function image( $image = false ) {&nbsp;</div></li><li><div>      $opengraph_images = new WPSEO_OpenGraph_Image( $this-&gt;options, $image );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $opengraph_images-&gt;get_images() as $img ) {&nbsp;</div></li><li><div>          $this-&gt;og_tag( 'og:image', esc_url( $img ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $dimensions = $opengraph_images-&gt;get_dimensions();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $dimensions['width'] ) ) {&nbsp;</div></li><li><div>          $this-&gt;og_tag( 'og:image:width', absint( $dimensions['width'] ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $dimensions['height'] ) ) {&nbsp;</div></li><li><div>          $this-&gt;og_tag( 'og:image:height', absint( $dimensions['height'] ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Fallback method for plugins using image_output</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $image Image URL.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function image_output( $image ) {&nbsp;</div></li><li><div>      $this-&gt;image( $image );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Output the OpenGraph description, specific OG description first, if not, grab the meta description.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $echo Whether to echo or return the description.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string $ogdesc</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function description( $echo = true ) {&nbsp;</div></li><li><div>      $ogdesc = '';&nbsp;</div></li><li><div>      $frontend = WPSEO_Frontend::get_instance();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_front_page() ) {&nbsp;</div></li><li><div>          if ( isset( $this-&gt;options['og_frontpage_desc'] ) && $this-&gt;options['og_frontpage_desc'] !== '' ) {&nbsp;</div></li><li><div>              $ogdesc = wpseo_replace_vars( $this-&gt;options['og_frontpage_desc'], null );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          else {&nbsp;</div></li><li><div>              $ogdesc = $frontend-&gt;metadesc( false );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $is_posts_page = $frontend-&gt;is_posts_page();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_singular() || $is_posts_page ) {&nbsp;</div></li><li><div>          $post_id = ( $is_posts_page ) ? get_option( 'page_for_posts' ) : get_the_ID();&nbsp;</div></li><li><div>          $post = get_post( $post_id );&nbsp;</div></li><li><div>          $ogdesc = WPSEO_Meta::get_value( 'opengraph-description', $post_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment"><span class="comment">// Replace Yoast SEO Variables.</span></span></span>&nbsp;</div></li><li><div>          $ogdesc = wpseo_replace_vars( $ogdesc, $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Use metadesc if $ogdesc is empty.</span>&nbsp;</div></li><li><div>          if ( $ogdesc === '' ) {&nbsp;</div></li><li><div>              $ogdesc = $frontend-&gt;metadesc( false );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Tag og:description is still blank so grab it from get_the_excerpt().</span>&nbsp;</div></li><li><div>          if ( ! is_string( $ogdesc ) || ( is_string( $ogdesc ) && $ogdesc === '' ) ) {&nbsp;</div></li><li><div>              $ogdesc = str_replace( '[&hellip;]', '&hellip;', strip_tags( get_the_excerpt() ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_category() || is_tag() || is_tax() ) {&nbsp;</div></li><li><div>          $ogdesc = WPSEO_Taxonomy_Meta::get_meta_without_term( 'opengraph-description' );&nbsp;</div></li><li><div>          if ( $ogdesc === '' ) {&nbsp;</div></li><li><div>              $ogdesc = $frontend-&gt;metadesc( false );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $ogdesc === '' ) {&nbsp;</div></li><li><div>              $ogdesc = trim( strip_tags( term_description() ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $ogdesc === '' ) {&nbsp;</div></li><li><div>              $ogdesc = WPSEO_Taxonomy_Meta::get_meta_without_term( 'desc' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Strip shortcodes if any.</span>&nbsp;</div></li><li><div>      $ogdesc = strip_shortcodes( $ogdesc );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter: 'wpseo_opengraph_desc' - Allow changing the OpenGraph description</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @api string $ogdesc The description string.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $ogdesc = trim( apply_filters( 'wpseo_opengraph_desc', $ogdesc ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_string( $ogdesc ) && $ogdesc !== '' ) {&nbsp;</div></li><li><div>          if ( $echo !== false ) {&nbsp;</div></li><li><div>              $this-&gt;og_tag( 'og:description', $ogdesc );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $ogdesc;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Output the site name straight from the blog info.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function site_name() {&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter: 'wpseo_opengraph_site_name' - Allow changing the OpenGraph site name</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @api string $unsigned Blog name string</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $name = apply_filters( 'wpseo_opengraph_site_name', get_bloginfo( 'name' ) );&nbsp;</div></li><li><div>      if ( is_string( $name ) && $name !== '' ) {&nbsp;</div></li><li><div>          $this-&gt;og_tag( 'og:site_name', $name );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Output the article tags as article:tag tags.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @link https://developers.facebook.com/docs/reference/opengraph/object-type/article/</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function tags() {&nbsp;</div></li><li><div>      if ( ! is_singular() ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $tags = get_the_tags();&nbsp;</div></li><li><div>      if ( ! is_wp_error( $tags ) && ( is_array( $tags ) && $tags !== array() ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $tags as $tag ) {&nbsp;</div></li><li><div>              $this-&gt;og_tag( 'article:tag', $tag-&gt;name );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Output the article category as an article:section tag.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @link https://developers.facebook.com/docs/reference/opengraph/object-type/article/</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean;</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function category() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! is_singular() ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $terms = get_the_category();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! is_wp_error( $terms ) && ( is_array( $terms ) && $terms !== array() ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// We can only show one section here, so we take the first one.</span>&nbsp;</div></li><li><div>          $this-&gt;og_tag( 'article:section', $terms[0]-&gt;name );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Output the article publish and last modification date</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @link https://developers.facebook.com/docs/reference/opengraph/object-type/article/</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean;</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function publish_date() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! is_singular( 'post' ) ) {&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Filter: 'wpseo_opengraph_show_publish_date' - Allow showing publication date for other post types</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @api bool $unsigned Whether or not to show publish date</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @param string $post_type The current URL's post type.</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          if ( false === apply_filters( 'wpseo_opengraph_show_publish_date', false, get_post_type() ) ) {&nbsp;</div></li><li><div>              return false;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $pub = get_the_date( DATE_W3C );&nbsp;</div></li><li><div>      $this-&gt;og_tag( 'article:published_time', $pub );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $mod = get_the_modified_date( DATE_W3C );&nbsp;</div></li><li><div>      if ( $mod != $pub ) {&nbsp;</div></li><li><div>          $this-&gt;og_tag( 'article:modified_time', $mod );&nbsp;</div></li><li><div>          $this-&gt;og_tag( 'og:updated_time', $mod );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>} <span class="comment">/** End of class */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Class WPSEO_OpenGraph_Image</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>class WPSEO_OpenGraph_Image {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @var array $options Holds options passed to the constructor</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $options;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @var array $images Holds the images that have been put out as OG image.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $images = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @TODO This needs to be refactored since we only hold one set of dimensions for multiple images. R.</span>&nbsp;</div></li><li><div><span class="comment">   * @var array $dimensions Holds image dimensions, if determined.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  protected $dimensions = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Constructor</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array          $options Options set.</span>&nbsp;</div></li><li><div><span class="comment">   * @param string|boolean $image   Optional image URL.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function __construct( $options, $image = false ) {&nbsp;</div></li><li><div>      $this-&gt;options = $options;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $image ) && $this-&gt;add_image( $image ) ) {&nbsp;</div></li><li><div>          <span class="comment">// Safely assume an image was added so we don't need to automatically determine it anymore.</span>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      else {&nbsp;</div></li><li><div>          $this-&gt;set_images();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the images array</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_images() {&nbsp;</div></li><li><div>      return $this-&gt;images;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the dimensions array.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_dimensions() {&nbsp;</div></li><li><div>      return $this-&gt;dimensions;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Display an OpenGraph image tag</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $img - Source URL to the image.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function add_image( $img ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $original = trim( $img );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Filter: 'wpseo_opengraph_image' - Allow changing the OpenGraph image.</span>&nbsp;</div></li><li><div>      $img = trim( apply_filters( 'wpseo_opengraph_image', $img ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $original !== $img ) {&nbsp;</div></li><li><div>          $this-&gt;dimensions = array();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $img ) ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( WPSEO_Utils::is_url_relative( $img ) === true ) {&nbsp;</div></li><li><div>          $img = $this-&gt;get_relative_path( $img );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( in_array( $img, $this-&gt;images ) ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      array_push( $this-&gt;images, $img );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Check if page is front page or singular and call the corresponding functions. If not, call get_default_image.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function set_images() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter: wpseo_add_opengraph_images - Allow developers to add images to the OpenGraph tags</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @api WPSEO_OpenGraph_Image The current object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      do_action( 'wpseo_add_opengraph_images', $this );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_front_page() ) {&nbsp;</div></li><li><div>          $this-&gt;get_front_page_image();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      elseif ( is_home() ) { <span class="comment">// Posts page, which won't be caught by is_singular() below.</span>&nbsp;</div></li><li><div>          $this-&gt;get_posts_page_image();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_singular() ) {&nbsp;</div></li><li><div>          $this-&gt;get_singular_image();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_category() || is_tax() || is_tag() ) {&nbsp;</div></li><li><div>          $this-&gt;get_opengraph_image_taxonomy();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;get_default_image();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * If the frontpage image exists, call add_image</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_front_page_image() {&nbsp;</div></li><li><div>      if ( $this-&gt;options['og_frontpage_image'] !== '' ) {&nbsp;</div></li><li><div>          $this-&gt;add_image( $this-&gt;options['og_frontpage_image'] );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the images of the posts page.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_posts_page_image() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $post_id = get_option( 'page_for_posts' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;get_opengraph_image_post( $post_id ) ) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;get_featured_image( $post_id ) ) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the images of the singular post.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_singular_image() {&nbsp;</div></li><li><div>      global $post;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;get_opengraph_image_post() ) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;get_attachment_page_image( $post-&gt;ID ) ) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;get_featured_image( $post-&gt;ID ) ) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $this-&gt;get_content_images( $post );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get default image and call add_image</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_default_image() {&nbsp;</div></li><li><div>      if ( count( $this-&gt;images ) === 0 && isset( $this-&gt;options['og_default_image'] ) && $this-&gt;options['og_default_image'] !== '' ) {&nbsp;</div></li><li><div>          $this-&gt;add_image( $this-&gt;options['og_default_image'] );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * If opengraph-image is set, call add_image and return true.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $post_id Optional post ID to use.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_opengraph_image_post( $post_id = 0 ) {&nbsp;</div></li><li><div>      $ogimg = WPSEO_Meta::get_value( 'opengraph-image', $post_id );&nbsp;</div></li><li><div>      if ( $ogimg !== '' ) {&nbsp;</div></li><li><div>          $this-&gt;add_image( $ogimg );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Check if taxonomy has an image and add this image</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_opengraph_image_taxonomy() {&nbsp;</div></li><li><div>      if ( ( $ogimg = WPSEO_Taxonomy_Meta::get_meta_without_term( 'opengraph-image' ) ) !== '' ) {&nbsp;</div></li><li><div>          $this-&gt;add_image( $ogimg );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * If there is a featured image, check image size. If image size is correct, call add_image and return true</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $post_id The post ID.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_featured_image( $post_id ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( has_post_thumbnail( $post_id ) ) {&nbsp;</div></li><li><div>          <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">           * Filter: 'wpseo_opengraph_image_size' - Allow changing the image size used for OpenGraph sharing</span>&nbsp;</div></li><li><div><span class="comment">           *</span>&nbsp;</div></li><li><div><span class="comment">           * @api string $unsigned Size string</span>&nbsp;</div></li><li><div><span class="comment">           */</span>&nbsp;</div></li><li><div>          $thumb = wp_get_attachment_image_src( get_post_thumbnail_id( $post_id ), apply_filters( 'wpseo_opengraph_image_size', 'original' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( $this-&gt;check_featured_image_size( $thumb ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;dimensions['width'] = $thumb[1];&nbsp;</div></li><li><div>              $this-&gt;dimensions['height'] = $thumb[2];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              return $this-&gt;add_image( $thumb[0] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * If this is an attachment page, call add_image with the attachment and return true</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $post_id The post ID.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_attachment_page_image( $post_id ) {&nbsp;</div></li><li><div>      if ( get_post_type( $post_id ) === 'attachment' ) {&nbsp;</div></li><li><div>          $mime_type = get_post_mime_type( $post_id );&nbsp;</div></li><li><div>          switch ( $mime_type ) {&nbsp;</div></li><li><div>              case 'image/jpeg':&nbsp;</div></li><li><div>              case 'image/png':&nbsp;</div></li><li><div>              case 'image/gif':&nbsp;</div></li><li><div>                  return $this-&gt;add_image( wp_get_attachment_url( $post_id ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Filter: 'wpseo_pre_analysis_post_content' - Allow filtering the content before analysis</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @api string $post_content The Post content string</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param object $post - The post object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_content_images( $post ) {&nbsp;</div></li><li><div>      $content = apply_filters( 'wpseo_pre_analysis_post_content', $post-&gt;post_content, $post );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( preg_match_all( '`&lt;img [^&gt;]+&gt;`', $content, $matches ) ) {&nbsp;</div></li><li><div>          foreach ( $matches[0] as $img ) {&nbsp;</div></li><li><div>              if ( preg_match( '`src=([&quot;\'])(.*?)\1`', $img, $match ) ) {&nbsp;</div></li><li><div>                  $this-&gt;add_image( $match[2] );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Check size of featured image. If image is too small, return false, else return true</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $img_data wp_get_attachment_image_src: url, width, height, icon.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function check_featured_image_size( $img_data ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! is_array( $img_data ) ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get the width and height of the image.</span>&nbsp;</div></li><li><div>      if ( $img_data[1] &lt; 200 || $img_data[2] &lt; 200 ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the relative path of the image</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $img Image data array.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool|string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_relative_path( $img ) {&nbsp;</div></li><li><div>      if ( $img[0] != '/' ) {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If it's a relative URL, it's relative to the domain, not necessarily to the WordPress install, we</span>&nbsp;</div></li><li><div>      <span class="comment">// want to preserve domain name and URL scheme (http / https) though.</span>&nbsp;</div></li><li><div>      $parsed_url = wp_parse_url( home_url() );&nbsp;</div></li><li><div>      $img = $parsed_url['scheme'] . ':<span class="comment">//' . $parsed_url['host'] . $img;</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $img;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>Yoast SEO</li><li><span></span>4.7.1</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>