<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="1.7.2" data-slug="advanced-custom-fields-font-awesome" data-type="file" data-id="76557"><head xmlns="http://www.w3.org/1999/xhtml"><title> better-font-awesome-library-better-font-awesome-library | file | Advanced Custom Fields Font Awesome | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, advanced-custom-fields-font-awesome, 1.7.2" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=fc2d4cb4c7031f14ad096005ce604f26' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/better-font-awesome-library-better-font-awesome-library/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fbetter-font-awesome-library-better-font-awesome-library%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fbetter-font-awesome-library-better-font-awesome-library%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-advanced-custom-fields-font-awesome-1.7.2-file-better-font-awesome-library-better-font-awesome-library","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="better-font-awesome-library-better-font-awesome-library" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to advanced-custom-fields-font-a&hellip;." href="http://hookr.io/plugins/advanced-custom-fields-font-awesome/" class="plugin"><span property="name">advanced-custom-fields-font-a&hellip;</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 1.7.2." href="http://hookr.io/plugins/advanced-custom-fields-font-awesome/1.7.2/" class="H_VERSION"><span property="name">1.7.2</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/advanced-custom-fields-font-awesome/1.7.2/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">better-font-awesome-library-b&hellip;</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="22"><a href="http://hookr.io/plugins/advanced-custom-fields-font-awesome/1.7.2/all/" title="All">All <span class="count badge">22</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/advanced-custom-fields-font-awesome/1.7.2/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="17"><a href="http://hookr.io/plugins/advanced-custom-fields-font-awesome/1.7.2/hooks/" title="Hooks">Hooks <span class="count badge">17</span></a></li><li class="" data-id="action" data-count="4"><a href="http://hookr.io/plugins/advanced-custom-fields-font-awesome/1.7.2/actions/" title="Actions">Actions <span class="count badge">4</span></a></li><li class="" data-id="filter" data-count="13"><a href="http://hookr.io/plugins/advanced-custom-fields-font-awesome/1.7.2/filters/" title="Filters">Filters <span class="count badge">13</span></a></li><li class="" data-id="class" data-count="3"><a href="http://hookr.io/plugins/advanced-custom-fields-font-awesome/1.7.2/classes/" title="Classes">Classes <span class="count badge">3</span></a></li><li class="" data-id="constant" data-count="0"><a href="http://hookr.io/plugins/advanced-custom-fields-font-awesome/1.7.2/constants/" title="Constants">Constants <span class="count badge">0</span></a></li><li class="" data-id="function" data-count="1"><a href="http://hookr.io/plugins/advanced-custom-fields-font-awesome/1.7.2/functions/" title="Functions">Functions <span class="count badge">1</span></a></li><li class="" data-id="shortcode" data-count="1"><a href="http://hookr.io/plugins/advanced-custom-fields-font-awesome/1.7.2/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">1</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/better-font-awesome-library/better-font-awesome-library.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Better Font Awesome Library</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * A class to implement Font Awesome in WordPress.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @see      jsDelivr CDN and API</span>&nbsp;</div></li><li><div><span class="comment"> * @link     http://www.jsdelivr.com/</span>&nbsp;</div></li><li><div><span class="comment"> * @link     https://github.com/jsdelivr/api</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since    1.0.0</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package  Better Font Awesome Library</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * @todo test in both pre and post TinyMCE V4 (make sure icons all appear in</span>&nbsp;</div></li><li><div><span class="comment"> *       editor and front end)</span>&nbsp;</div></li><li><div><span class="comment"> * @todo There may be a better way to do get_local_file_contents(), refer to:</span>&nbsp;</div></li><li><div><span class="comment"> *       https://github.com/markjaquith/feedback/issues/33</span>&nbsp;</div></li><li><div><span class="comment"> * @todo Icon menu icon not showing up in black studio widget - add attribute</span>&nbsp;</div></li><li><div><span class="comment"> *       selector for admin CSS instead of exact ID selector. Not sure if this</span>&nbsp;</div></li><li><div><span class="comment"> *       is still an issue?</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Exit if accessed directly</span>&nbsp;</div></li><li><div>if ( ! defined( 'ABSPATH' ) ) exit;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( ! class_exists( 'Better_Font_Awesome_Library' ) ) :&nbsp;</div></li><li><div>class Better_Font_Awesome_Library {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Better Font Awesome Library slug.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  const SLUG = 'bfa';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Better Font Awesome Library version slug.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  const VERSION = '1.0.0';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * jsDelivr API URL for Font Awesome version info.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  const JSDELIVR_API_URL = 'http:<span class="comment">//api.jsdelivr.com/v1/jsdelivr/libraries/fontawesome/?fields=versions, lastversion';</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Initialization args.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $args;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Default args to use if any $arg isn't specified.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $default_args = array(&nbsp;</div></li><li><div>      'version' =&gt; 'latest', &nbsp;</div></li><li><div>      'minified' =&gt; true, &nbsp;</div></li><li><div>      'remove_existing_fa' =&gt; false, &nbsp;</div></li><li><div>      'load_styles' =&gt; true, &nbsp;</div></li><li><div>      'load_admin_styles' =&gt; true, &nbsp;</div></li><li><div>      'load_shortcode' =&gt; true, &nbsp;</div></li><li><div>      'load_tinymce_plugin' =&gt; true, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Root URL of the library.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.4</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $root_url;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Args for wp_remote_get() calls.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $wp_remote_get_args = array(&nbsp;</div></li><li><div>      'timeout' =&gt; 10, &nbsp;</div></li><li><div>      'sslverify' =&gt; false, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Array to hold the jsDelivr API data.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $api_data = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Version of Font Awesome being used.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $font_awesome_version;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Font Awesome stylesheet URL.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $stylesheet_url;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Font Awesome CSS.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $css;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Data associated with the local fallback version of Font Awesome.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $fallback_data = array(&nbsp;</div></li><li><div>      'directory' =&gt; 'lib/fallback-font-awesome/', &nbsp;</div></li><li><div>      'path' =&gt; '', &nbsp;</div></li><li><div>      'url' =&gt; '', &nbsp;</div></li><li><div>      'version' =&gt; '', &nbsp;</div></li><li><div>      'css' =&gt; '', &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Array of available Font Awesome icon slugs.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $icons = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Font Awesome prefix to be used ('icon' or 'fa').</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $prefix;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Array to track errors and wp_remote_get() failures.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $errors = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Instance of this class.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @var    Better_Font_Awesome_Library</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private static $instance = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Returns the instance of this class, and initializes</span>&nbsp;</div></li><li><div><span class="comment">   * the instance if it doesn't already exist.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  Better_Font_Awesome_Library  The BFAL object.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public static function get_instance( $args = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If the single instance hasn't been set, set it now.</span>&nbsp;</div></li><li><div>      if ( null == self::$instance ) {&nbsp;</div></li><li><div>          self::$instance = new self( $args );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return self::$instance;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Better Font Awesome Library constructor.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $args  Initialization arguments.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function __construct( $args = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get initialization args.</span>&nbsp;</div></li><li><div>      $this-&gt;args = $args;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Load the library functionality.</span>&nbsp;</div></li><li><div>      $this-&gt;load();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Set up all plugin library functionality.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function load() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Initialize library properties and actions as needed.</span>&nbsp;</div></li><li><div>      $this-&gt;initialize( $this-&gt;args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Use the jsDelivr API to fetch info on the jsDelivr Font Awesome CDN.</span>&nbsp;</div></li><li><div>      $this-&gt;setup_api_data();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set the version of Font Awesome to be used.</span>&nbsp;</div></li><li><div>      $this-&gt;set_active_version();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set the URL for the Font Awesome stylesheet.</span>&nbsp;</div></li><li><div>      $this-&gt;set_stylesheet_url( $this-&gt;font_awesome_version );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get stylesheet and generate list of available icons in Font Awesome stylesheet.</span>&nbsp;</div></li><li><div>      $this-&gt;setup_stylesheet_data();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add Font Awesome and/or custom CSS to the editor.</span>&nbsp;</div></li><li><div>      $this-&gt;add_editor_styles();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Output any necessary admin notices.</span>&nbsp;</div></li><li><div>      add_action( 'admin_notices', array( $this, 'do_admin_notice' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Remove existing Font Awesome CSS and shortcodes if needed.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * Use priority 15 to ensure this is done after other plugin</span>&nbsp;</div></li><li><div><span class="comment">       * CSS/shortcodes are loaded. This must run before any other</span>&nbsp;</div></li><li><div><span class="comment">       * style/script/shortcode actions so it doesn't accidentally</span>&nbsp;</div></li><li><div><span class="comment">       * remove them.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      if ( $this-&gt;args['remove_existing_fa'] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_action( 'wp_enqueue_scripts', array( $this, 'remove_font_awesome_css' ), 15 );&nbsp;</div></li><li><div>          add_action( 'init', array( $this, 'remove_icon_shortcode' ), 20 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Load front-end scripts and styles.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * Use priority 15 to make sure styles/scripts load after other plugins.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      if ( $this-&gt;args['load_styles'] || $this-&gt;args['remove_existing_fa'] ) {&nbsp;</div></li><li><div>          add_action( 'wp_enqueue_scripts', array( $this, 'register_font_awesome_css' ), 15 );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Load admin scripts and styles.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * Use priority 15 to make sure styles/scripts load after other plugins.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      if ( $this-&gt;args['load_admin_styles'] || $this-&gt;args['load_tinymce_plugin'] ) {&nbsp;</div></li><li><div>          add_action( 'admin_enqueue_scripts', array( $this, 'register_font_awesome_css' ), 15 );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Add [icon] shortcode.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * Use priority 15 to ensure this is done after removing existing Font</span>&nbsp;</div></li><li><div><span class="comment">       * Awesome CSS and shortcodes.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      if ( $this-&gt;args['load_shortcode'] || $this-&gt;args['load_tinymce_plugin'] ) {&nbsp;</div></li><li><div>          add_action( 'init', array( $this, 'add_icon_shortcode' ), 20 );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Load TinyMCE functionality.</span>&nbsp;</div></li><li><div>      if ( $this-&gt;args['load_tinymce_plugin'] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_scripts' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Add shortcode insertion button.</span>&nbsp;</div></li><li><div>          add_action( 'media_buttons', array( $this, 'add_insert_shortcode_button' ), 99 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Do necessary initialization actions.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function initialize( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Parse the initialization args with the defaults.</span>&nbsp;</div></li><li><div>      $this-&gt;parse_args( $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Setup root URL, which differs for plugins vs. themes.</span>&nbsp;</div></li><li><div>      $this-&gt;setup_root_url();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set fallback stylesheet directory URL and path.</span>&nbsp;</div></li><li><div>      $this-&gt;setup_fallback_data();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Parse the initialization args with the defaults and apply bfa_args filter.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  array  $args  Args used to initialize BFAL.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function parse_args( $args = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Parse initialization args with defaults.</span>&nbsp;</div></li><li><div>      $this-&gt;args = wp_parse_args( $args, $this-&gt;default_args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter the initialization args.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param  array  $this-&gt;args  BFAL initialization args.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $this-&gt;args = apply_filters( 'bfa_init_args', $this-&gt;args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter the wp_remote_get args.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param  array  $this-&gt;wp_remote_get_args  BFAL wp_remote_get_args args.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $this-&gt;wp_remote_get_args = apply_filters( 'bfa_wp_remote_get_args', $this-&gt;wp_remote_get_args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Set up root URL for library, which differs for plugins vs. themes.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.4</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function setup_root_url() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get BFA directory and theme root directory paths.</span>&nbsp;</div></li><li><div>      $bfa_directory = dirname(__FILE__);&nbsp;</div></li><li><div>      $theme_directory = get_stylesheet_directory();&nbsp;</div></li><li><div>      $plugin_dir = plugin_dir_url( __FILE__ );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Check if we're inside a theme or plugin.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * If we're in a theme, than plugin_dir_url() will return a</span>&nbsp;</div></li><li><div><span class="comment">       * funky URL that includes the actual file path (e.g.</span>&nbsp;</div></li><li><div><span class="comment">       * /srv/www/site_name/wp-content/...)</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $is_theme = false;&nbsp;</div></li><li><div>      if ( strpos( $plugin_dir, $bfa_directory ) !== false ) {&nbsp;</div></li><li><div>          $is_theme = true;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// First check if we're inside a theme.</span>&nbsp;</div></li><li><div>      if ( $is_theme ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Get relative BFA directory by removing theme root directory path.</span>&nbsp;</div></li><li><div>          $bfa_rel_path = str_replace( $theme_directory, '', $bfa_directory );&nbsp;</div></li><li><div>          $this-&gt;root_url = trailingslashit( get_stylesheet_directory_uri() . $bfa_rel_path );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      } else { <span class="comment">// Otherwise we're inside a plugin.</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $this-&gt;root_url = trailingslashit( plugin_dir_url( __FILE__ ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Set up data for the local fallback version of Font Awesome.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function setup_fallback_data() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set fallback directory path.</span>&nbsp;</div></li><li><div>      $directory_path = plugin_dir_path( __FILE__ ) . $this-&gt;fallback_data['directory'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter directory path.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param  string  $directory_path  The path to the fallback Font Awesome directory.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $directory_path = trailingslashit( apply_filters( 'bfa_fallback_directory_path', $directory_path ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set fallback path and URL.</span>&nbsp;</div></li><li><div>      $this-&gt;fallback_data['path'] = $directory_path . 'css/font-awesome' . $this-&gt;get_min_suffix() . '.css';&nbsp;</div></li><li><div>      $this-&gt;fallback_data['url'] = $this-&gt;root_url . $this-&gt;fallback_data['directory'] . 'css/font-awesome' . $this-&gt;get_min_suffix() . '.css';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get the fallback version based on package.json.</span>&nbsp;</div></li><li><div>      $fallback_json_file_path = $directory_path . 'package.json';&nbsp;</div></li><li><div>      $fallback_data = json_decode( $this-&gt;get_local_file_contents( $fallback_json_file_path ) );&nbsp;</div></li><li><div>      $this-&gt;fallback_data['version'] = $fallback_data-&gt;version;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get the fallback CSS.</span>&nbsp;</div></li><li><div>      $this-&gt;fallback_data['css'] = $this-&gt;get_fallback_css();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Set up data for all versions of Font Awesome available on the jsDelivr</span>&nbsp;</div></li><li><div><span class="comment">   * CDN.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Uses the jsDelivr API.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function setup_api_data() {&nbsp;</div></li><li><div>      $this-&gt;api_data = $this-&gt;fetch_api_data( self::JSDELIVR_API_URL );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Fetch the jsDelivr API data.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * First check to see if the api-versions transient is set, and if not use</span>&nbsp;</div></li><li><div><span class="comment">   * the jsDelivr API to retrieve all available versions of Font Awesome.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  array|WP_ERROR  Available CDN Font Awesome versions, or a</span>&nbsp;</div></li><li><div><span class="comment">   *                          WP_ERROR if the fetch fails.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function fetch_api_data( $url ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( false === ( $response = get_transient( self::SLUG . '-api-versions' ) ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $response = wp_remote_get( $url, $this-&gt;wp_remote_get_args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( 200 == wp_remote_retrieve_response_code( $response ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Decode the API data and grab the versions info.</span>&nbsp;</div></li><li><div>              $json_data = json_decode( wp_remote_retrieve_body( $response ) );&nbsp;</div></li><li><div>              $response = $json_data[0];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">               * Filter the API transient expiration.</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">               *</span>&nbsp;</div></li><li><div><span class="comment">               * @param  int  Expiration for API transient.</span>&nbsp;</div></li><li><div><span class="comment">               */</span>&nbsp;</div></li><li><div>              $transient_expiration = apply_filters( 'bfa_api_transient_expiration', 12 * HOUR_IN_SECONDS );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Set the API transient.</span>&nbsp;</div></li><li><div>              set_transient( self::SLUG . '-api-versions', $response, $transient_expiration );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          } elseif ( is_wp_error( $response ) ) { <span class="comment"><span class="comment">// Check for faulty wp_remote_get()</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;set_error( 'api', $response-&gt;get_error_code(), $response-&gt;get_error_message() . &quot; (URL: $url)&quot; );&nbsp;</div></li><li><div>              $response = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          } elseif ( isset( $response['response'] ) ) { <span class="comment"><span class="comment">// Check for 404 and other non-WP_ERROR codes</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;set_error( 'api', $response['response']['code'], $response['response']['message'] . &quot; (URL: $url)&quot; );&nbsp;</div></li><li><div>              $response = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          } else { <span class="comment"><span class="comment">// Total failsafe</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $this-&gt;set_error( 'api', 'Unknown', __( 'The jsDelivr API servers appear to be temporarily unavailable.', 'better-font-awesome' ) . &quot; (URL: $url)&quot; );&nbsp;</div></li><li><div>              $response = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $response;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Set the version of Font Awesome to use.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function set_active_version() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 'latest' == $this-&gt;args['version'] ) {&nbsp;</div></li><li><div>          $this-&gt;font_awesome_version = $this-&gt;get_latest_version();&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $this-&gt;font_awesome_version = $this-&gt;args['version'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the latest available Font Awesome version.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string  Latest available Font Awesome version, either via the</span>&nbsp;</div></li><li><div><span class="comment">   *                  jsDelivr API data (if available), or a best guess based on transient and</span>&nbsp;</div></li><li><div><span class="comment">   *                  fallback version data.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_latest_version() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;api_data_exists() ) {&nbsp;</div></li><li><div>          return $this-&gt;get_api_value( 'lastversion' );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          return $this-&gt;guess_latest_version();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Guess the latest Font Awesome version.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Check both the transient Font Awesome CSS array and the locally-hosted</span>&nbsp;</div></li><li><div><span class="comment">   * version of Font Awesome to determine the latest listed version.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string  Latest transient or fallback version of Font Awesome CSS.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function guess_latest_version() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $css_transient_latest_version = $this-&gt;get_css_transient_latest_version();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( version_compare( $css_transient_latest_version, $this-&gt;fallback_data['version'], '&gt;' ) ) {&nbsp;</div></li><li><div>          return $css_transient_latest_version;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          return $this-&gt;fallback_data['version'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the latest version saved in the CSS transient.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string  Latest version key in the CSS transient array.</span>&nbsp;</div></li><li><div><span class="comment">   *                  Return '0' if the CSS transient isn't set.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_css_transient_latest_version() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $transient_css_array = get_transient( self::SLUG . '-css' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $transient_css_array ) ) {&nbsp;</div></li><li><div>          return max( array_keys( $transient_css_array ) );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          return '0';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Determine the remote Font Awesome stylesheet URL based on the selected</span>&nbsp;</div></li><li><div><span class="comment">   * version.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $version  Version of Font Awesome to use.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function set_stylesheet_url( $version ) {&nbsp;</div></li><li><div>      $this-&gt;stylesheet_url = '<span class="comment">//cdn.jsdelivr.net/fontawesome/' . $version . '/css/font-awesome' . $this-&gt;get_min_suffix() . '.css';</span>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get stylesheet CSS and populate icons array.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function setup_stylesheet_data() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get the Font Awesome CSS.</span>&nbsp;</div></li><li><div>      $this-&gt;css = $this-&gt;get_css( $this-&gt;stylesheet_url, $this-&gt;font_awesome_version );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get the list of available icons from the Font Awesome CSS.</span>&nbsp;</div></li><li><div>      $this-&gt;icons = $this-&gt;setup_icon_array( $this-&gt;css );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set up prefix based on version ('fa' or 'icon').</span>&nbsp;</div></li><li><div>      $this-&gt;prefix = $this-&gt;setup_prefix( $this-&gt;font_awesome_version );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the Font Awesome CSS.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param   string  $url       URL of the remote stylesheet.</span>&nbsp;</div></li><li><div><span class="comment">   * @param   string  $version   Version of Font Awesome to fetch.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string  $response  Font Awesome CSS, from either:</span>&nbsp;</div></li><li><div><span class="comment">   *                             1. transient, </span>&nbsp;</div></li><li><div><span class="comment">   *                             2. wp_remote_get(), or</span>&nbsp;</div></li><li><div><span class="comment">   *                             3. fallback CSS.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_css( $url, $version ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// First try getting the transient CSS.</span>&nbsp;</div></li><li><div>      $response = $this-&gt;get_transient_css( $version );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Next, try fetching the CSS from the remote jsDelivr CDN.</span>&nbsp;</div></li><li><div>      if ( ! $response ) {&nbsp;</div></li><li><div>          $response = $this-&gt;get_remote_css( $url, $version );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter the force fallback flag.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since  1.0.4</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param  bool  Whether or not to force the fallback CSS.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $force_fallback = apply_filters( 'bfa_force_fallback', false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Use the local fallback if both the transient and wp_remote_get()</span>&nbsp;</div></li><li><div><span class="comment">       * methods fail, or if fallback is forced with bfa_force_fallback filter.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      if ( is_wp_error( $response ) || $force_fallback ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Log the CSS fetch error.</span>&nbsp;</div></li><li><div>          if ( ! $force_fallback ) {&nbsp;</div></li><li><div>              $this-&gt;set_error( 'css', $response-&gt;get_error_code(), $response-&gt;get_error_message() . &quot; (URL: $url)&quot; );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Use the local fallback CSS.</span>&nbsp;</div></li><li><div>          $response = $this-&gt;fallback_data['css'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Update the version string to match the fallback version.</span>&nbsp;</div></li><li><div>          $this-&gt;font_awesome_version = $this-&gt;fallback_data['version'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Update the stylesheet URL to match the fallback version.</span>&nbsp;</div></li><li><div>          $this-&gt;stylesheet_url = $this-&gt;fallback_data['url'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $response;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the transient copy of the CSS for the specified version.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param   string  $version  Font Awesome version to check.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string            Transient CSS if it exists, otherwise null.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_transient_css( $version ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $transient_css_array = get_transient( self::SLUG . '-css' );&nbsp;</div></li><li><div>      return isset( $transient_css_array[ $version ] ) ? $transient_css_array[ $version ] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the CSS from the remote jsDelivr CDN.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param   string           $url       URL for the remote stylesheet.</span>&nbsp;</div></li><li><div><span class="comment">   * @param   string           $version   Font Awesome version to fetch.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string|WP_ERROR  $response  Remote CSS, or WP_ERROR if</span>&nbsp;</div></li><li><div><span class="comment">   *                                      wp_remote_get() fails.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_remote_css( $url, $version ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get the remote Font Awesome CSS.</span>&nbsp;</div></li><li><div>      $url = set_url_scheme( $url );&nbsp;</div></li><li><div>      $response = wp_remote_get( $url, $this-&gt;wp_remote_get_args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * If fetch was successful, return the remote CSS, and set the CSS</span>&nbsp;</div></li><li><div><span class="comment">       * transient for this version. Otherwise, return a WP_Error object.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      if ( 200 == wp_remote_retrieve_response_code( $response ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $response = wp_remote_retrieve_body( $response );&nbsp;</div></li><li><div>          $this-&gt;set_css_transient( $version, $response );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      } elseif ( is_wp_error( $response ) ) { <span class="comment"><span class="comment">// Check for faulty wp_remote_get()</span></span>&nbsp;</div></li><li><div>          $response = $response;&nbsp;</div></li><li><div>      } elseif ( isset( $response['response'] ) ) { <span class="comment"><span class="comment">// Check for 404 and other non-WP_ERROR codes</span></span>&nbsp;</div></li><li><div>          $response = new WP_Error( $response['response']['code'], $response['response']['message'] . &quot; (URL: $url)&quot; );&nbsp;</div></li><li><div>      } else { <span class="comment"><span class="comment">// Total failsafe</span></span>&nbsp;</div></li><li><div>          $response = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $response;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Set the CSS transient array.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $version  Version of Font Awesome for which to set the</span>&nbsp;</div></li><li><div><span class="comment">   *                           transient.</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $value    CSS for corresponding version of Font Awesome.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function set_css_transient( $version, $value ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Get the transient array, which contains data for multiple Font</span>&nbsp;</div></li><li><div><span class="comment">       * Awesome version.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $transient_css_array = get_transient( self::SLUG . '-css' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set the new value for the specified Font Awesome version.</span>&nbsp;</div></li><li><div>      $transient_css_array[ $version ] = $value;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter the CSS transient expiration.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param  int  Expiration for the CSS transient.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $transient_expiration = apply_filters( 'bfa_css_transient_expiration', 30 * DAY_IN_SECONDS );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set the new CSS array transient.</span>&nbsp;</div></li><li><div>      set_transient( self::SLUG . '-css', $transient_css_array, $transient_expiration );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the CSS of the local fallback Font Awesome version.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string  Contents of the local fallback Font Awesome stylesheet.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_fallback_css() {&nbsp;</div></li><li><div>      return $this-&gt;get_local_file_contents( $this-&gt;fallback_data['path'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get array of icons from the Font Awesome CSS.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param   string  $css  The Font Awesome CSS.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  array         All available icon names (e.g. adjust, car, pencil).</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function setup_icon_array( $css ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $icons = array();&nbsp;</div></li><li><div>      $hex_codes = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Get all CSS selectors that have a &quot;content:&quot; pseudo-element rule, </span>&nbsp;</div></li><li><div><span class="comment">       * as well as all associated hex codes.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      preg_match_all( '/\.(icon-|fa-)([^, }]*)\s*:before\s*{\s*(content:)\s*&quot;(\\\\[^&quot;]+)&quot;/s', $css, $matches );&nbsp;</div></li><li><div>      $icons = $matches[2];&nbsp;</div></li><li><div>      $hex_codes = $matches[4];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add hex codes as icon array index.</span>&nbsp;</div></li><li><div>      $icons = array_combine( $hex_codes, $icons );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Alphabetize the icons array by icon name.</span>&nbsp;</div></li><li><div>      asort( $icons );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter the array of available icons.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param   array  $icons  Array of all available icons.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $icons = apply_filters( 'bfa_icon_list', $icons );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $icons;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the Font Awesosome prefix ('fa' or 'icon').</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param   string  $version  Font Awesome version being used.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string  $prefix  'fa' or 'icon', depending on the version.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function setup_prefix( $version ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( 0 &lt;= version_compare( $version, '4' ) ) {&nbsp;</div></li><li><div>          $prefix = 'fa';&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $prefix = 'icon';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter the Font Awesome prefix.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param  string  $prefix  Font Awesome prefix ('icon' or 'fa').</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $prefix = apply_filters( 'bfa_prefix', $prefix );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $prefix;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Remove styles that include 'fontawesome' or 'font-awesome' in their slug.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function remove_font_awesome_css() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      global $wp_styles;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Loop through all registered styles and remove any that appear to be Font Awesome.</span>&nbsp;</div></li><li><div>      foreach ( $wp_styles-&gt;registered as $script =&gt; $details ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( false !== strpos( $script, 'fontawesome' ) || false !== strpos( $script, 'font-awesome' ) ) {&nbsp;</div></li><li><div>              wp_dequeue_style( $script );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Remove [icon] shortcode.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function remove_icon_shortcode() {&nbsp;</div></li><li><div>      remove_shortcode( 'icon' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Add [icon] shortcode.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Usage:</span>&nbsp;</div></li><li><div><span class="comment">   * [icon name=&quot;flag&quot; class=&quot;fw 2x spin&quot; unprefixed_class=&quot;custom_class&quot;]</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function add_icon_shortcode() {&nbsp;</div></li><li><div>      add_shortcode( 'icon', array( $this, 'render_shortcode' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Render [icon] shortcode.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Usage:</span>&nbsp;</div></li><li><div><span class="comment">   * [icon name=&quot;flag&quot; class=&quot;fw 2x spin&quot; unprefixed_class=&quot;custom_class&quot;]</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param   array   $atts    Shortcode attributes.</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string  $output  Icon HTML (e.g. &lt;i class=&quot;fa fa-car&quot;&gt;&lt;/i&gt;).</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function render_shortcode( $atts ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      extract( shortcode_atts( array(&nbsp;</div></li><li><div>                  'name' =&gt; '', &nbsp;</div></li><li><div>                  'class' =&gt; '', &nbsp;</div></li><li><div>                  'unprefixed_class' =&gt; '', &nbsp;</div></li><li><div>                  'title' =&gt; '', <span class="comment"><span class="comment">/** For compatibility with other plugins */</span></span>&nbsp;</div></li><li><div>                  'size' =&gt; '', <span class="comment"><span class="comment">/** For compatibility with other plugins */</span></span>&nbsp;</div></li><li><div>                  'space' =&gt; '', &nbsp;</div></li><li><div> ), $atts )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Include for backwards compatibility with Font Awesome More Icons plugin.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @see https://wordpress.org/plugins/font-awesome-more-icons/</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $title = $title ? 'title=&quot;' . $title . '&quot; ' : '';&nbsp;</div></li><li><div>      $space = 'true' == $space ? '&nbsp;' : '';&nbsp;</div></li><li><div>      $size = $size ? ' '. $this-&gt;prefix . '-' . $size : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Remove &quot;icon-&quot; and &quot;fa-&quot; from name</span>&nbsp;</div></li><li><div>      <span class="comment">// This helps both:</span>&nbsp;</div></li><li><div>      <span class="comment">//  1. Incorrect shortcodes (when user includes full class name including prefix)</span>&nbsp;</div></li><li><div>      <span class="comment">//  2. Old shortcodes from other plugins that required prefixes</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Strip 'icon-' and 'fa-' from the BEGINNING of $name.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * This corrects for:</span>&nbsp;</div></li><li><div><span class="comment">       *     1. Incorrect shortcodes (when user includes full class name including prefix)</span>&nbsp;</div></li><li><div><span class="comment">       *  2. Old shortcodes from other plugins that required prefixes</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $prefixes = array( 'icon-', 'fa-' );&nbsp;</div></li><li><div>      foreach ( $prefixes as $prefix ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( substr( $name, 0, strlen( $prefix ) ) == $prefix ) {&nbsp;</div></li><li><div>              $name = substr( $name, strlen( $prefix ) );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $name = str_replace( 'fa-', '', $name );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add the version-specific prefix back on to $name, if it exists.</span>&nbsp;</div></li><li><div>      $icon_name = $this-&gt;prefix ? $this-&gt;prefix . '-' . $name : $name;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Remove &quot;icon-&quot; and &quot;fa-&quot; from the icon class.</span>&nbsp;</div></li><li><div>      $class = str_replace( 'icon-', '', $class );&nbsp;</div></li><li><div>      $class = str_replace( 'fa-', '', $class );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Remove extra spaces from the icon class.</span>&nbsp;</div></li><li><div>      $class = trim( $class );&nbsp;</div></li><li><div>      $class = preg_replace( '/\s{3, }/', ' ', $class );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add the version-specific prefix back on to each class.</span>&nbsp;</div></li><li><div>      $class_array = explode( ' ', $class );&nbsp;</div></li><li><div>      foreach ( $class_array as $index =&gt; $class ) {&nbsp;</div></li><li><div>          $class_array[ $index ] = $this-&gt;prefix ? $this-&gt;prefix . '-' . $class : $class;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $class = implode( ' ', $class_array );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add unprefixed classes.</span>&nbsp;</div></li><li><div>      $class .= $unprefixed_class ? ' ' . $unprefixed_class : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter the icon class.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param  string  $class  Classes attached to the icon.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      $class = apply_filters( 'bfa_icon_class', $class, $name );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Generate the HTML &lt;i&gt; icon element output.</span>&nbsp;</div></li><li><div>      $output = sprintf( '&lt;i class=&quot;%s %s %s %s&quot; %s&gt;%s&lt;/i&gt;', &nbsp;</div></li><li><div>          $this-&gt;prefix, &nbsp;</div></li><li><div>          $icon_name, &nbsp;</div></li><li><div>          $class, &nbsp;</div></li><li><div>          $size, &nbsp;</div></li><li><div>          $title, &nbsp;</div></li><li><div>          $space&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Filter the icon output.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param  string  $output  Icon output.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      return apply_filters( 'bfa_icon', $output );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Register and enqueue Font Awesome CSS.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function register_font_awesome_css() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      wp_register_style( self::SLUG . '-font-awesome', $this-&gt;stylesheet_url, '', $this-&gt;font_awesome_version );&nbsp;</div></li><li><div>      wp_enqueue_style( self::SLUG . '-font-awesome' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Add Font Awesome CSS to TinyMCE.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function add_editor_styles() {&nbsp;</div></li><li><div>      add_editor_style( $this-&gt;stylesheet_url );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Load admin CSS.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function enqueue_admin_scripts() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Check whether to get minified or non-minified files.</span>&nbsp;</div></li><li><div>      $suffix = ( defined( 'SCRIPT_DEBUG' ) && SCRIPT_DEBUG ) ? '' : '.min';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Custom admin CSS.</span>&nbsp;</div></li><li><div>      wp_enqueue_style( self::SLUG . '-admin', $this-&gt;root_url . 'css/admin-styles.css' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Custom admin JS.</span>&nbsp;</div></li><li><div>      wp_enqueue_script( self::SLUG . '-admin', $this-&gt;root_url . 'js/admin.js' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Icon picker JS and CSS.</span>&nbsp;</div></li><li><div>      wp_enqueue_style( 'fontawesome-iconpicker', $this-&gt;root_url . 'lib/fontawesome-iconpicker/css/fontawesome-iconpicker' . $suffix . '.css' );&nbsp;</div></li><li><div>      wp_enqueue_script( 'fontawesome-iconpicker', $this-&gt;root_url . 'lib/fontawesome-iconpicker/js/fontawesome-iconpicker' . $suffix . '.js' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Output PHP variables to JS.</span>&nbsp;</div></li><li><div>      $bfa_vars = array(&nbsp;</div></li><li><div>          'fa_prefix' =&gt; $this-&gt;prefix, &nbsp;</div></li><li><div>          'fa_icons' =&gt; $this-&gt;get_icons(), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      wp_localize_script( self::SLUG . '-admin', 'bfa_vars', $bfa_vars );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * [add_insert_shortcode_button description]</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.3.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function add_insert_shortcode_button() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      ob_start();&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>      &lt;span class=&quot;bfa-iconpicker fontawesome-iconpicker&quot; data-selected=&quot;fa-flag&quot;&gt;&nbsp;</div></li><li><div>          &lt;a href=&quot;#&quot; class=&quot;button button-secondary iconpicker-component&quot;&gt;&nbsp;</div></li><li><div>              &lt;span class=&quot;fa icon fa-flag icon-flag&quot;&gt;&lt;/span&gt;&nbsp;&nbsp;</div></li><li><div>              &lt;?php esc_html_e( 'Insert Icon', 'better-font-awesome' ); ?&gt;&nbsp;</div></li><li><div>              &lt;i class=&quot;change-icon-placeholder&quot;&gt;&lt;/i&gt;&nbsp;</div></li><li><div>          &lt;/a&gt;&nbsp;</div></li><li><div>      &lt;/span&gt;&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>      echo ob_get_clean();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Generate admin notices.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function do_admin_notice() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $this-&gt;errors ) && apply_filters( 'bfa_show_errors', true ) ) :&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>          &lt;div class=&quot;error&quot;&gt;&nbsp;</div></li><li><div>              &lt;p&gt;&nbsp;</div></li><li><div>                  &lt;b&gt;&lt;?php _e( 'Better Font Awesome', 'better-font-awesome' ); ?&gt;&lt;/b&gt;&nbsp;</div></li><li><div>              &lt;/p&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;!-- API Error --&gt;&nbsp;</div></li><li><div>              &lt;?php if ( is_wp_error ( $this-&gt;get_error('api') ) ) : ?&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&nbsp;</div></li><li><div>                      &lt;b&gt;&lt;?php _e( 'API Error', 'better-font-awesome' ); ?&gt;&lt;/b&gt;&lt;br /&gt;&nbsp;</div></li><li><div>                      &lt;?php&nbsp;</div></li><li><div>                      printf( __( 'The attempt to reach the jsDelivr API server failed with the following error: %s', 'better-font-awesome' ), &nbsp;</div></li><li><div>                          '&lt;code&gt;' . $this-&gt;get_error('api')-&gt;get_error_code() . ': ' . $this-&gt;get_error('api')-&gt;get_error_message() . '&lt;/code&gt;'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                      ?&gt;&nbsp;</div></li><li><div>                  &lt;/p&gt;&nbsp;</div></li><li><div>              &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;!-- CSS Error --&gt;&nbsp;</div></li><li><div>              &lt;?php if ( is_wp_error ( $this-&gt;get_error('css') ) ) : ?&gt;&nbsp;</div></li><li><div>                  &lt;p&gt;&nbsp;</div></li><li><div>                      &lt;b&gt;&lt;?php _e( 'Remote CSS Error', 'better-font-awesome' ); ?&gt;&lt;/b&gt;&lt;br /&gt;&nbsp;</div></li><li><div>                      &lt;?php&nbsp;</div></li><li><div>                      printf( __( 'The attempt to fetch the remote Font Awesome stylesheet failed with the following error: %s %s The embedded fallback Font Awesome will be used instead (version: %s).', 'better-font-awesome' ), &nbsp;</div></li><li><div>                          '&lt;code&gt;' . $this-&gt;get_error('css')-&gt;get_error_code() . ': ' . $this-&gt;get_error('css')-&gt;get_error_message() . '&lt;/code&gt;', &nbsp;</div></li><li><div>                          '&lt;br /&gt;', &nbsp;</div></li><li><div>                          '&lt;code&gt;' . $this-&gt;font_awesome_version . '&lt;/code&gt;'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                      ?&gt;&nbsp;</div></li><li><div>                  &lt;/p&gt;&nbsp;</div></li><li><div>              &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;!-- Fallback Text --&gt;&nbsp;</div></li><li><div>              &lt;p&gt;&lt;?php echo __( '&lt;b&gt;Don\'t worry! Better Font Awesome will still render using the included fallback version:&lt;/b&gt; ', 'better-font-awesome' ) . '&lt;code&gt;' . $this-&gt;fallback_data['version'] . '&lt;/code&gt;' ; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              &lt;!-- Solution Text --&gt;&nbsp;</div></li><li><div>              &lt;p&gt;&nbsp;</div></li><li><div>                  &lt;b&gt;&lt;?php _e( 'Solution', 'better-font-awesome' ); ?&gt;&lt;/b&gt;&lt;br /&gt;&nbsp;</div></li><li><div>                  &lt;?php&nbsp;</div></li><li><div>                  printf( __( 'This may be the result of a temporary server or connectivity issue which will resolve shortly. However if the problem persists please file a support ticket on the %splugin forum%s, citing the errors listed above. ', 'better-font-awesome' ), &nbsp;</div></li><li><div>                      '&lt;a href=&quot;http:<span class="comment">//wordpress.org/support/plugin/better-font-awesome&quot; target=&quot;_blank&quot; title=&quot;Better Font Awesome support forum&quot;&gt;', </span>&nbsp;</div></li><li><div>                      '&lt;/a&gt;'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>              &lt;/p&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**----------------------------------------------------------------------------*</span>&nbsp;</div></li><li><div><span class="comment">   * Helper Functions</span>&nbsp;</div></li><li><div><span class="comment">   *----------------------------------------------------------------------------*/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the contents of a local file.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param   string  $file_path  Path to local file.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string  $contents   Content of local file.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_local_file_contents( $file_path ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      ob_start();&nbsp;</div></li><li><div>      include $file_path;&nbsp;</div></li><li><div>      $contents = ob_get_clean();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $contents;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Determine whether or not to use the .min suffix on Font Awesome</span>&nbsp;</div></li><li><div><span class="comment">   * stylesheet URLs.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string  '.min' if minification is specified, empty string if not.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function get_min_suffix() {&nbsp;</div></li><li><div>      return ( $this-&gt;args['minified'] ) ? '.min' : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Add an error to the $this-&gt;errors array.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since  1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $error_type  Type of error (api, css, etc).</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $code        Error code.</span>&nbsp;</div></li><li><div><span class="comment">   * @param  string  $message     Error message.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function set_error( $error_type, $code, $message ) {&nbsp;</div></li><li><div>      $this-&gt;errors[ $error_type ] = new WP_Error( $code, $message );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Retrieve a library error.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param   string  $process  Slug of the process to check (e.g. 'api').</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  WP_ERROR          The error for the specified process.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_error( $process ) {&nbsp;</div></li><li><div>      return isset( $this-&gt;errors[ $process ] ) ? $this-&gt;errors[ $process ] : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Check if API version data has been retrieved.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  boolean  Whether or not the API version info was successfully fetched.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function api_data_exists() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;api_data ) {&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get a specific API value.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param   string  $key    Array key of the API data to get.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  mixed   $value  Value associated with specified key.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_api_value( $key ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;api_data ) {&nbsp;</div></li><li><div>          $value = $this-&gt;api_data-&gt;$key;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $value = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $value;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**----------------------------------------------------------------------------*</span>&nbsp;</div></li><li><div><span class="comment">   * Public User Functions</span>&nbsp;</div></li><li><div><span class="comment">   *----------------------------------------------------------------------------*/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the version of Font Awesome currently in use.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string  Font Awesome version.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_version() {&nbsp;</div></li><li><div>      return $this-&gt;font_awesome_version;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the fallback version of Font Awesome included locally.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string  Font Awesome fallback version.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_fallback_version() {&nbsp;</div></li><li><div>      return $this-&gt;fallback_data['version'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the stylesheet URL.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string  Stylesheet URL.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_stylesheet_url() {&nbsp;</div></li><li><div>      return $this-&gt;stylesheet_url;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the array of available icons.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  array  Available Font Awesome icons.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_icons() {&nbsp;</div></li><li><div>      return $this-&gt;icons;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the icon prefix ('fa' or 'icon').</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  string  Font Awesome prefix.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_prefix() {&nbsp;</div></li><li><div>      return $this-&gt;prefix;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get version data for the remote jsDelivr CDN.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  object  jsDelivr API data.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_api_data() {&nbsp;</div></li><li><div>      return $this-&gt;api_data;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get errors.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since   1.0.0</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return  array  All library errors that have occured.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function get_errors() {&nbsp;</div></li><li><div>      return $this-&gt;errors;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>endif;&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>Advanced Custom Fields: Font Awesome</li><li><span></span>1.7.2</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>