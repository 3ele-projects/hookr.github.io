<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="1.29" data-slug="google-captcha-recaptcha-by-bestwebsoft" data-type="class" data-id="39699"><head xmlns="http://www.w3.org/1999/xhtml"><title> bws_settings_tabs | class | Google Captcha Recaptcha By Bestwebsoft | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="Bws_Settings_Tabs, class, plugin, google-captcha-recaptcha-by-bestwebsoft, 1.29" /><meta name="description" content="The Google Captcha (reCAPTCHA) by BestWebSoft Bws Settings Tabs class." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=0616caf90478308e213eafc6cdeb7a58' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/bws_settings_tabs/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fbws_settings_tabs%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fbws_settings_tabs%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-google-captcha-recaptcha-by-bestwebsoft-1.29-class-bws_settings_tabs","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="bws_settings_tabs" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to google-captcha-recaptcha-by-b&hellip;." href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/" class="plugin"><span property="name">google-captcha-recaptcha-by-b&hellip;</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 1.29." href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/1.29/" class="H_VERSION"><span property="name">1.29</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/1.29/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">bws_settings_tabs</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="86"><a href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/1.29/all/" title="All">All <span class="count badge">86</span></a></li><li class="" data-id="new" data-count="2"><a href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/1.29/new/" title="New">New <span class="count badge">2</span></a></li><li class="" data-id="hooks" data-count="10"><a href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/1.29/hooks/" title="Hooks">Hooks <span class="count badge">10</span></a></li><li class="" data-id="action" data-count="7"><a href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/1.29/actions/" title="Actions">Actions <span class="count badge">7</span></a></li><li class="" data-id="filter" data-count="3"><a href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/1.29/filters/" title="Filters">Filters <span class="count badge">3</span></a></li><li class="active" data-id="class" data-count="3"><a href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/1.29/classes/" title="Classes">Classes <span class="count badge">3</span></a></li><li class="" data-id="constant" data-count="2"><a href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/1.29/constants/" title="Constants">Constants <span class="count badge">2</span></a></li><li class="" data-id="function" data-count="70"><a href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/1.29/functions/" title="Functions">Functions <span class="count badge">70</span></a></li><li class="" data-id="shortcode" data-count="1"><a href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/1.29/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">1</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>Bws_Settings_Tabs</strong></h1><p>The Google Captcha (reCAPTCHA) by BestWebSoft <strong>Bws Settings Tabs</strong> class.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/1.29/files/bws-menu-class-bws-settings/" class="file">/bws_menu/class-bws-settings.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="9" class="block" start="9"><li><div>class Bws_Settings_Tabs {&nbsp;</div></li><li><div>    private $tabs;        &nbsp;</div></li><li><div>    private $plugin_basename;&nbsp;</div></li><li><div>    private $prefix;&nbsp;</div></li><li><div>    private $pro_plugin_is_activated = false;&nbsp;</div></li><li><div>    private $custom_code_args = array();&nbsp;</div></li><li><div>    private $wp_slug;&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>    public $options;&nbsp;</div></li><li><div>    public $default_options;&nbsp;</div></li><li><div>    public $is_network_options;    &nbsp;</div></li><li><div>    public $plugins_info = array();&nbsp;</div></li><li><div>    public $hide_pro_tabs = false;&nbsp;</div></li><li><div>    public $demo_data;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public $is_pro = false;&nbsp;</div></li><li><div>    public $pro_page;&nbsp;</div></li><li><div>    public $bws_license_plugin;&nbsp;</div></li><li><div>    public $link_key;&nbsp;</div></li><li><div>    public $link_pn;&nbsp;</div></li><li><div>    public $is_trial = false;&nbsp;</div></li><li><div>    public $trial_days;&nbsp;</div></li><li><div>    public $bws_hide_pro_option_exist = true;    &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public $forbid_view = false;&nbsp;</div></li><li><div>    public $change_permission_attr = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public $version;&nbsp;</div></li><li><div>    public $upload_dir;&nbsp;</div></li><li><div>    public $all_plugins;&nbsp;</div></li><li><div>    public $is_multisite;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public $doc_link;&nbsp;</div></li><li><div>    public $doc_video_link;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Constructor.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * The child class should call this constructor from its own constructor to override&nbsp;</div></li><li><div>     * the default $args.&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param array|string $args&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function __construct( $args = array() ) {&nbsp;</div></li><li><div>        $args = wp_parse_args( $args, array(&nbsp;</div></li><li><div>            'plugin_basename' =&gt; '', &nbsp;</div></li><li><div>            'prefix' =&gt; '', &nbsp;</div></li><li><div>            'plugins_info' =&gt; array(), &nbsp;</div></li><li><div>            'default_options' =&gt; array(), &nbsp;</div></li><li><div>            'options' =&gt; array(), &nbsp;</div></li><li><div>            'is_network_options' =&gt; false, &nbsp;</div></li><li><div>            'tabs' =&gt; array(), &nbsp;</div></li><li><div>            'doc_link' =&gt; '', &nbsp;</div></li><li><div>            'doc_video_link' =&gt; '', &nbsp;</div></li><li><div>            'wp_slug' =&gt; '', &nbsp;</div></li><li><div>            'demo_data' =&gt; false, &nbsp;</div></li><li><div>            /** if this is free version and pro exist */&nbsp;</div></li><li><div>            'pro_page' =&gt; '', &nbsp;</div></li><li><div>            'bws_license_plugin'=&gt; '', &nbsp;</div></li><li><div>            'link_key' =&gt; '', &nbsp;</div></li><li><div>            'link_pn' =&gt; '', &nbsp;</div></li><li><div>            'trial_days' =&gt; false&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $args['plugins_info']['Name'] = str_replace( ' by BestWebSoft', '', $args['plugins_info']['Name'] );&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        $this-&gt;plugin_basename = $args['plugin_basename'];&nbsp;</div></li><li><div>        $this-&gt;prefix = $args['prefix'];&nbsp;</div></li><li><div>        $this-&gt;plugins_info = $args['plugins_info'];            &nbsp;</div></li><li><div>        $this-&gt;options = $args['options'];&nbsp;</div></li><li><div>        $this-&gt;default_options = $args['default_options'];&nbsp;</div></li><li><div>        $this-&gt;wp_slug = $args['wp_slug'];&nbsp;</div></li><li><div>        $this-&gt;demo_data = $args['demo_data'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;tabs = $args['tabs'];&nbsp;</div></li><li><div>        $this-&gt;is_network_options = $args['is_network_options'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;doc_link = $args['doc_link'];&nbsp;</div></li><li><div>        $this-&gt;doc_video_link = $args['doc_video_link'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;pro_page = $args['pro_page'];&nbsp;</div></li><li><div>        $this-&gt;bws_license_plugin = $args['bws_license_plugin'];&nbsp;</div></li><li><div>        $this-&gt;link_key = $args['link_key'];&nbsp;</div></li><li><div>        $this-&gt;link_pn = $args['link_pn'];&nbsp;</div></li><li><div>        $this-&gt;trial_days = $args['trial_days'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;hide_pro_tabs = bws_hide_premium_options_check( $this-&gt;options );&nbsp;</div></li><li><div>        $this-&gt;version = '1.0.0';&nbsp;</div></li><li><div>        $this-&gt;is_multisite = is_multisite();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( empty( $this-&gt;pro_page ) && array_key_exists( 'license', $this-&gt;tabs ) )&nbsp;</div></li><li><div>            $this-&gt;is_pro = true;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Displays the content of the &quot;Settings&quot; on the plugin settings page&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @param  void&nbsp;</div></li><li><div>     * @return void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function display_content() {&nbsp;</div></li><li><div>        global $bstwbsftwppdtplgns_options;&nbsp;</div></li><li><div>        if ( array_key_exists( 'custom_code', $this-&gt;tabs ) ) {&nbsp;</div></li><li><div>            /** get args for `custom code` tab */&nbsp;</div></li><li><div>            $this-&gt;get_custom_code();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $save_results = $this-&gt;save_all_tabs_options();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;display_messages( $save_results );&nbsp;</div></li><li><div>        if ( isset( $_REQUEST['bws_restore_default'] ) && check_admin_referer( $this-&gt;plugin_basename, 'bws_nonce_name' ) ) {&nbsp;</div></li><li><div>            bws_form_restore_default_confirm( $this-&gt;plugin_basename );&nbsp;</div></li><li><div>        } elseif ( isset( $_POST['bws_handle_demo'] ) && check_admin_referer( $this-&gt;plugin_basename, 'bws_nonce_name' ) ) {&nbsp;</div></li><li><div>            $this-&gt;demo_data-&gt;bws_demo_confirm();&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            bws_show_settings_notice(); ?&gt;&nbsp;</div></li><li><div>            &lt;form class=&quot;bws_form&quot; method=&quot;post&quot; action=&quot;&quot; enctype=&quot;multipart/form-data&quot;&gt;&nbsp;</div></li><li><div>                &lt;div id=&quot;poststuff&quot;&gt;&nbsp;</div></li><li><div>                    &lt;div id=&quot;post-body&quot; class=&quot;metabox-holder columns-2&quot;&gt;&nbsp;</div></li><li><div>                        &lt;div id=&quot;post-body-content&quot; style=&quot;position: relative;&quot;&gt;&nbsp;</div></li><li><div>                            &lt;?php $this-&gt;display_tabs(); ?&gt;                    &nbsp;</div></li><li><div>                        &lt;/div&gt;&lt;!-- /post-body-content --&gt;&nbsp;</div></li><li><div>                        &lt;div id=&quot;postbox-container-1&quot; class=&quot;postbox-container&quot;&gt;&nbsp;</div></li><li><div>                            &lt;div class=&quot;meta-box-sortables ui-sortable&quot;&gt;&nbsp;</div></li><li><div>                                &lt;div id=&quot;submitdiv&quot; class=&quot;postbox&quot;&gt;&nbsp;</div></li><li><div>                                    &lt;h3 class=&quot;hndle&quot;&gt;&lt;?php _e( 'Information', 'bestwebsoft' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                                    &lt;div class=&quot;inside&quot;&gt;&nbsp;</div></li><li><div>                                        &lt;div class=&quot;submitbox&quot; id=&quot;submitpost&quot;&gt;&nbsp;</div></li><li><div>                                            &lt;div id=&quot;minor-publishing&quot;&gt;&nbsp;</div></li><li><div>                                                &lt;div id=&quot;misc-publishing-actions&quot;&gt;&nbsp;</div></li><li><div>                                                    &lt;?php if ( $this-&gt;is_pro ) {&nbsp;</div></li><li><div>                                                        if ( ! isset( $bstwbsftwppdtplgns_options['time_out'][ $this-&gt;plugin_basename ] ) || isset( $bstwbsftwppdtplgns_options['wrong_license_key'][ $this-&gt;plugin_basename ] ) ) {&nbsp;</div></li><li><div>                                                            $license_type = 'Pro';&nbsp;</div></li><li><div>                                                            $license_status = __( 'Inactive', 'bestwebsoft' ) . ' &lt;a href=&quot;#' . $this-&gt;prefix . '_license_tab&quot; class=&quot;bws_trigger_tab_click&quot;&gt;' . __( 'Learn More', 'bestwebsoft' ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>                                                        } else {&nbsp;</div></li><li><div>                                                            $finish = strtotime( $bstwbsftwppdtplgns_options['time_out'][ $this-&gt;plugin_basename ] );&nbsp;</div></li><li><div>                                                            $today = strtotime( date( &quot;m/d/Y&quot; ) );&nbsp;</div></li><li><div>                                                            if ( isset( $bstwbsftwppdtplgns_options['trial'][ $this-&gt;plugin_basename ] ) ) { &nbsp;</div></li><li><div>                                                                $license_type = 'Trial Pro';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                                                if ( $finish &lt; $today ) {&nbsp;</div></li><li><div>                                                                    $license_status = __( 'Expired', 'bestwebsoft' );&nbsp;</div></li><li><div>                                                                } else {&nbsp;</div></li><li><div>                                                                    $daysleft = floor( ( $finish - $today ) / ( 60*60*24 ) );&nbsp;</div></li><li><div>                                                                    $license_status = sprintf( __( '%s day(-s) left', 'bestwebsoft' ), $daysleft );&nbsp;</div></li><li><div>                                                                }&nbsp;</div></li><li><div>                                                                $license_status .= '. &lt;a target=&quot;_blank&quot; href=&quot;' . $this-&gt;plugins_info['PluginURI'] . '&quot;&gt;' . __( 'Upgrade to Pro', 'bestwebsoft' ) . '&lt;/a&gt;';                                     &nbsp;</div></li><li><div>                                                            } else {&nbsp;</div></li><li><div>                                                                $license_type = isset( $bstwbsftwppdtplgns_options['nonprofit'][ $this-&gt;plugin_basename ] ) ? 'Nonprofit Pro' : 'Pro';&nbsp;</div></li><li><div>                                                                if ( $finish &lt; $today ) {&nbsp;</div></li><li><div>                                                                    $license_status = sprintf( __( 'Expired on %s', 'bestwebsoft' ), $bstwbsftwppdtplgns_options['time_out'][ $this-&gt;plugin_basename ] ) . '. &lt;a target=&quot;_blank&quot; href=&quot;https://support.bestwebsoft.com/entries/53487136&quot;&gt;' . __( 'Renew Now', 'bestwebsoft' ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>                                                                } else {&nbsp;</div></li><li><div>                                                                    $license_status = __( 'Active', 'bestwebsoft' );&nbsp;</div></li><li><div>                                                                }&nbsp;</div></li><li><div>                                                            }&nbsp;</div></li><li><div>                                                        } ?&gt;&nbsp;</div></li><li><div>                                                        &lt;div class=&quot;misc-pub-section&quot;&gt;&nbsp;</div></li><li><div>                                                            &lt;strong&gt;&lt;?php _e( 'License', 'bestwebsoft' ); ?&gt;:&lt;/strong&gt; &lt;?php echo $license_type; ?&gt;&nbsp;</div></li><li><div>                                                        &lt;/div&gt;&nbsp;</div></li><li><div>                                                        &lt;div class=&quot;misc-pub-section&quot;&gt;&nbsp;</div></li><li><div>                                                            &lt;strong&gt;&lt;?php _e( 'Status', 'bestwebsoft' ); ?&gt;:&lt;/strong&gt; &lt;?php echo $license_status; ?&gt;&nbsp;</div></li><li><div>                                                        &lt;/div&gt;&lt;!-- .misc-pub-section --&gt;&nbsp;</div></li><li><div>                                                    &lt;?php } ?&gt;&nbsp;</div></li><li><div>                                                    &lt;div class=&quot;misc-pub-section&quot;&gt;&nbsp;</div></li><li><div>                                                        &lt;strong&gt;&lt;?php _e( 'Version', 'bestwebsoft' ); ?&gt;:&lt;/strong&gt; &lt;?php echo $this-&gt;plugins_info['Version']; ?&gt;&nbsp;</div></li><li><div>                                                    &lt;/div&gt;&lt;!-- .misc-pub-section --&gt;&nbsp;</div></li><li><div>                                                &lt;/div&gt;&nbsp;</div></li><li><div>                                                &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                                            &lt;/div&gt;&nbsp;</div></li><li><div>                                            &lt;div id=&quot;major-publishing-actions&quot;&gt;&nbsp;</div></li><li><div>                                                &lt;div id=&quot;publishing-action&quot;&gt;&nbsp;</div></li><li><div>                                                    &lt;input type=&quot;hidden&quot; name=&quot;&lt;?php echo $this-&gt;prefix; ?&gt;_form_submit&quot; value=&quot;submit&quot; /&gt;&nbsp;</div></li><li><div>                                                    &lt;input id=&quot;bws-submit-button&quot; type=&quot;submit&quot; class=&quot;button button-primary button-large&quot; value=&quot;&lt;?php _e( 'Save Changes', 'bestwebsoft' ); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                                                    &lt;?php wp_nonce_field( $this-&gt;plugin_basename, 'bws_nonce_name' ); ?&gt;                    &nbsp;</div></li><li><div>                                                &lt;/div&gt;&nbsp;</div></li><li><div>                                                &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                                            &lt;/div&gt;&nbsp;</div></li><li><div>                                        &lt;/div&gt;&nbsp;</div></li><li><div>                                    &lt;/div&gt;                                        &nbsp;</div></li><li><div>                                &lt;/div&gt;&nbsp;</div></li><li><div>                                &lt;?php /**&nbsp;</div></li><li><div>                                 * action - Display custom metabox&nbsp;</div></li><li><div>                                 */&nbsp;</div></li><li><div>                                do_action( __CLASS__ . '_display_metabox' ); ?&gt;&nbsp;</div></li><li><div>                            &lt;/div&gt;&nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>                        &lt;div id=&quot;postbox-container-2&quot; class=&quot;postbox-container&quot;&gt;&nbsp;</div></li><li><div>                            &lt;?php /**&nbsp;</div></li><li><div>                             * action - Display additional content for #postbox-container-2&nbsp;</div></li><li><div>                             */&nbsp;</div></li><li><div>                            do_action( __CLASS__ . '_display_second_postbox' ); ?&gt;&nbsp;</div></li><li><div>                            &lt;div class=&quot;submit&quot;&gt;&nbsp;</div></li><li><div>                                &lt;input type=&quot;submit&quot; class=&quot;button button-primary button-large&quot; value=&quot;&lt;?php _e( 'Save Changes', 'bestwebsoft' ); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                            &lt;/div&gt;                                &nbsp;</div></li><li><div>                            &lt;?php if ( ! empty( $this-&gt;wp_slug ) )&nbsp;</div></li><li><div>                                bws_plugin_reviews_block( $this-&gt;plugins_info['Name'], $this-&gt;wp_slug ); ?&gt;&nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;/form&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Displays the Tabs&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @param  void&nbsp;</div></li><li><div>     * @return void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function display_tabs() { &nbsp;</div></li><li><div>        global $wp_version; ?&gt;&nbsp;</div></li><li><div>        &lt;div id=&quot;bws_settings_tabs_wrapper&quot;&lt;?php if ( version_compare( $wp_version, '4.0', '&lt;' ) ) echo ' class=&quot;edit-form-section&quot;'; ?&gt;&gt;&nbsp;</div></li><li><div>            &lt;ul id=&quot;bws_settings_tabs&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php $this-&gt;display_tabs_list(); ?&gt;&nbsp;</div></li><li><div>            &lt;/ul&gt;&nbsp;</div></li><li><div>            &lt;?php $this-&gt;display_tabs_content(); ?&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>            &lt;input type=&quot;hidden&quot; name=&quot;bws_active_tab&quot; value=&quot;&lt;?php if ( isset( $_REQUEST['bws_active_tab'] ) ) echo esc_attr( $_REQUEST['bws_active_tab'] ); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>    &lt;?php }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Displays the list of tabs&nbsp;</div></li><li><div>     * @access private&nbsp;</div></li><li><div>     * @return void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function display_tabs_list() {&nbsp;</div></li><li><div>        foreach ( $this-&gt;tabs as $tab_slug =&gt; $data ) {&nbsp;</div></li><li><div>            if ( ! empty( $data['is_pro'] ) && $this-&gt;hide_pro_tabs )&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>            $tab_class = 'bws-tab-' . $tab_slug;&nbsp;</div></li><li><div>            if ( ! empty( $data['is_pro'] ) )&nbsp;</div></li><li><div>                $tab_class .= ' bws_pro_tab';&nbsp;</div></li><li><div>            if ( ! empty( $data['class'] ) )&nbsp;</div></li><li><div>                $tab_class .= ' ' . $data['class']; ?&gt;&nbsp;</div></li><li><div>            &lt;li class=&quot;&lt;?php echo $tab_class; ?&gt;&quot; data-slug=&quot;&lt;?php echo $tab_slug; ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                &lt;a href=&quot;#&lt;?php echo $this-&gt;prefix; ?&gt;_&lt;?php echo $tab_slug; ?&gt;_tab&quot;&gt;&nbsp;</div></li><li><div>                    &lt;span&gt;&lt;?php echo esc_html( $data['label'] ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                &lt;/a&gt;&nbsp;</div></li><li><div>            &lt;/li&gt;&nbsp;</div></li><li><div>        &lt;?php }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Displays the content of tabs&nbsp;</div></li><li><div>     * @access private&nbsp;</div></li><li><div>     * @param  string $tab_slug&nbsp;</div></li><li><div>     * @return void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function display_tabs_content() {&nbsp;</div></li><li><div>        foreach ( $this-&gt;tabs as $tab_slug =&gt; $data ) { &nbsp;</div></li><li><div>            if ( ! empty( $data['is_pro'] ) && $this-&gt;hide_pro_tabs )&nbsp;</div></li><li><div>                continue; ?&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;bws_tab ui-tabs-panel ui-widget-content ui-corner-bottom&quot; id=&quot;&lt;?php echo $this-&gt;prefix . '_' . $tab_slug; ?&gt;_tab&quot; aria-labelledby=&quot;ui-id-2&quot; role=&quot;tabpanel&quot; aria-hidden=&quot;false&quot; style=&quot;display: block;&quot;&gt;                    &nbsp;</div></li><li><div>                &lt;?php if ( method_exists( $this, 'tab_' . str_replace( '-', '_', $tab_slug ) ) ) {&nbsp;</div></li><li><div>                    call_user_func( array( $this, 'tab_' . str_replace( '-', '_', $tab_slug ) ) );&nbsp;</div></li><li><div>                } ?&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Save all options from all tabs and display errors\messages&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @param  void&nbsp;</div></li><li><div>     * @return void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function save_all_tabs_options() {&nbsp;</div></li><li><div>        $message = $notice = $error = '';&nbsp;</div></li><li><div>        /** Restore default settings */&nbsp;</div></li><li><div>        if ( isset( $_POST['bws_restore_confirm'] ) && check_admin_referer( $this-&gt;plugin_basename, 'bws_settings_nonce_name' ) ) {&nbsp;</div></li><li><div>            $this-&gt;restore_options();&nbsp;</div></li><li><div>            $message = __( 'All plugin settings were restored.', 'bestwebsoft' );&nbsp;</div></li><li><div>        /** Go Pro - check license key */&nbsp;</div></li><li><div>        } elseif ( isset( $_POST['bws_license_submit'] ) && check_admin_referer( $this-&gt;plugin_basename, 'bws_nonce_name' ) ) {&nbsp;</div></li><li><div>            $result = $this-&gt;save_options_license_key();&nbsp;</div></li><li><div>            if ( ! empty( $result['error'] ) )&nbsp;</div></li><li><div>                $error = $result['error'];&nbsp;</div></li><li><div>            if ( ! empty( $result['message'] ) )&nbsp;</div></li><li><div>                $message = $result['message'];&nbsp;</div></li><li><div>            if ( ! empty( $result['notice'] ) )&nbsp;</div></li><li><div>                $notice = $result['notice'];&nbsp;</div></li><li><div>        /** check demo data */&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $demo_result = ! empty( $this-&gt;demo_data ) ? $this-&gt;demo_data-&gt;bws_handle_demo_data() : false;&nbsp;</div></li><li><div>            if ( false !== $demo_result ) {&nbsp;</div></li><li><div>                if ( ! empty( $demo_result ) && is_array( $demo_result ) ) {&nbsp;</div></li><li><div>                    $error = $demo_result['error'];&nbsp;</div></li><li><div>                    $message = $demo_result['done'];&nbsp;</div></li><li><div>                    if ( ! empty( $demo_result['done'] ) && ! empty( $demo_result['options'] ) )&nbsp;</div></li><li><div>                        $this-&gt;options = $demo_result['options'];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            /** Save options */&nbsp;</div></li><li><div>            } elseif ( ! isset( $_REQUEST['bws_restore_default'] ) && ! isset( $_POST['bws_handle_demo'] ) && isset( $_REQUEST[ $this-&gt;prefix . '_form_submit'] ) && check_admin_referer( $this-&gt;plugin_basename, 'bws_nonce_name' ) ) {&nbsp;</div></li><li><div>                /** save tabs */                &nbsp;</div></li><li><div>                $result = $this-&gt;save_options();&nbsp;</div></li><li><div>                if ( ! empty( $result['error'] ) )&nbsp;</div></li><li><div>                    $error = $result['error'];&nbsp;</div></li><li><div>                if ( ! empty( $result['message'] ) )&nbsp;</div></li><li><div>                    $message = $result['message'];&nbsp;</div></li><li><div>                if ( ! empty( $result['notice'] ) )&nbsp;</div></li><li><div>                    $notice = $result['notice'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( '' == $this-&gt;change_permission_attr ) {&nbsp;</div></li><li><div>                    /** save `misc` tab */&nbsp;</div></li><li><div>                    $result = $this-&gt;save_options_misc();&nbsp;</div></li><li><div>                    if ( ! empty( $result['notice'] ) )&nbsp;</div></li><li><div>                        $notice .= $result['notice'];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( array_key_exists( 'custom_code', $this-&gt;tabs ) ) {&nbsp;</div></li><li><div>                    /** save `custom code` tab */&nbsp;</div></li><li><div>                    $this-&gt;save_options_custom_code();&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return compact( 'message', 'notice', 'error' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display error\message\notice&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @param  $save_results - array with error\message\notice&nbsp;</div></li><li><div>     * @return void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function display_messages( $save_results ) {&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * action - Display custom error\message\notice&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        do_action( __CLASS__ . '_display_custom_messages', $save_results ); ?&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;updated fade inline&quot; &lt;?php if ( empty( $save_results['message'] ) ) echo &quot;style=\&quot;display:none\&quot;&quot;; ?&gt;&gt;&lt;p&gt;&lt;strong&gt;&lt;?php echo $save_results['message']; ?&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;updated bws-notice inline&quot; &lt;?php if ( empty( $save_results['notice'] ) ) echo &quot;style=\&quot;display:none\&quot;&quot;; ?&gt;&gt;&lt;p&gt;&lt;strong&gt;&lt;?php echo $save_results['notice']; ?&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;error inline&quot; &lt;?php if ( empty( $save_results['error'] ) ) echo &quot;style=\&quot;display:none\&quot;&quot;; ?&gt;&gt;&lt;p&gt;&lt;strong&gt;&lt;?php echo $save_results['error']; ?&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&nbsp;</div></li><li><div>    &lt;?php }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Save plugin options to the database&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @param  ab&nbsp;</div></li><li><div>     * @return array    The action results&nbsp;</div></li><li><div>     * @abstract&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function save_options() {&nbsp;</div></li><li><div>        die( 'function Bws_Settings_Tabs::save_options() must be over-ridden in a sub-class.' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Get 'custom_code' status and content&nbsp;</div></li><li><div>     * @access private&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function get_custom_code() {&nbsp;</div></li><li><div>        global $bstwbsftwppdtplgns_options;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;custom_code_args = array(&nbsp;</div></li><li><div>            'is_css_active' =&gt; false, &nbsp;</div></li><li><div>            'content_css' =&gt; '', &nbsp;</div></li><li><div>            'css_writeable' =&gt; false, &nbsp;</div></li><li><div>            'is_php_active' =&gt; false, &nbsp;</div></li><li><div>            'content_php' =&gt; '', &nbsp;</div></li><li><div>            'php_writeable' =&gt; false, &nbsp;</div></li><li><div>            'is_js_active' =&gt; false, &nbsp;</div></li><li><div>            'content_js' =&gt; '', &nbsp;</div></li><li><div>            'js_writeable' =&gt; false, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! $this-&gt;upload_dir )&nbsp;</div></li><li><div>            $this-&gt;upload_dir = wp_upload_dir();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $folder = $this-&gt;upload_dir['basedir'] . '/bws-custom-code';&nbsp;</div></li><li><div>        if ( ! $this-&gt;upload_dir[&quot;error&quot;] ) {&nbsp;</div></li><li><div>            if ( ! is_dir( $folder ) )&nbsp;</div></li><li><div>                wp_mkdir_p( $folder, 0755 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $index_file = $this-&gt;upload_dir['basedir'] . '/bws-custom-code/index.php';&nbsp;</div></li><li><div>            if ( ! file_exists( $index_file ) ) {&nbsp;</div></li><li><div>                if ( $f = fopen( $index_file, 'w+' ) )&nbsp;</div></li><li><div>                    fclose( $f );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        if ( $this-&gt;is_multisite )&nbsp;</div></li><li><div>            $this-&gt;custom_code_args['blog_id'] = get_current_blog_id();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( array( 'css', 'php', 'js' ) as $extension ) {&nbsp;</div></li><li><div>            $file = 'bws-custom-code.' . $extension;&nbsp;</div></li><li><div>            $real_file = $folder . '/' . $file;&nbsp;</div></li><li><div>                    &nbsp;</div></li><li><div>            if ( file_exists( $real_file ) ) {&nbsp;</div></li><li><div>                update_recently_edited( $real_file );&nbsp;</div></li><li><div>                $this-&gt;custom_code_args[&quot;content_{$extension}&quot;] = esc_textarea( file_get_contents( $real_file ) );&nbsp;</div></li><li><div>                if ( ( $this-&gt;is_multisite && isset( $bstwbsftwppdtplgns_options['custom_code'][ $this-&gt;custom_code_args['blog_id'] ][ $file ] ) ) ||&nbsp;</div></li><li><div>                    ( ! $this-&gt;is_multisite && isset( $bstwbsftwppdtplgns_options['custom_code'][ $file ] ) ) ) {&nbsp;</div></li><li><div>                    $this-&gt;custom_code_args[&quot;is_{$extension}_active&quot;] = true;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( is_writeable( $real_file ) )&nbsp;</div></li><li><div>                    $this-&gt;custom_code_args[&quot;{$extension}_writeable&quot;] = true;&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $this-&gt;custom_code_args[&quot;{$extension}_writeable&quot;] = true;&nbsp;</div></li><li><div>                if ( 'php' == $extension )&nbsp;</div></li><li><div>                    $this-&gt;custom_code_args[&quot;content_{$extension}&quot;] = &quot;&lt;?php&quot; . &quot;\n&quot; . &quot;if ( ! defined( 'ABSPATH' ) ) exit;&quot; . &quot;\n&quot; . &quot;if ( ! defined( 'BWS_GLOBAL' ) ) exit;&quot; . &quot;\n\n&quot; . &quot;/* Start your code here */&quot; . &quot;\n&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display 'custom_code' tab&nbsp;</div></li><li><div>     * @access private&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function tab_custom_code() { ?&gt;&nbsp;</div></li><li><div>        &lt;h3 class=&quot;bws_tab_label&quot;&gt;&lt;?php _e( 'Custom Code', 'bestwebsoft' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>        &lt;?php $this-&gt;help_phrase(); ?&gt;&nbsp;</div></li><li><div>        &lt;hr&gt;&nbsp;</div></li><li><div>        &lt;?php if ( ! current_user_can( 'edit_plugins' ) ) {&nbsp;</div></li><li><div>            echo '&lt;p&gt;' . __( 'You do not have sufficient permissions to edit plugins for this site.', 'bestwebsoft' ) . '&lt;/p&gt;';&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $list = array( &nbsp;</div></li><li><div>            'css' =&gt; array( 'description' =&gt; __( 'These styles will be added to the header on all pages of your site.', 'bestwebsoft' ), &nbsp;</div></li><li><div>                        'learn_more_link' =&gt; 'https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Getting_started' &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'php' =&gt; array( 'description' =&gt; sprintf( __( 'This PHP code will be hooked to the %s action and will be printed on front end only.', 'bestwebsoft' ), '&lt;a href=&quot;http://codex.wordpress.org/Plugin_API/Action_Reference/init&quot; target=&quot;_blank&quot;&gt;&lt;code&gt;init&lt;/code&gt;&lt;/a&gt;' ), &nbsp;</div></li><li><div>                        'learn_more_link' =&gt; 'http://php.net/' &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'js' =&gt; array( 'description' =&gt; __( 'These code will be added to the header on all pages of your site.', 'bestwebsoft' ), &nbsp;</div></li><li><div>                        'learn_more_link' =&gt; 'https://developer.mozilla.org/en-US/docs/Web/JavaScript' &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! $this-&gt;custom_code_args['css_writeable'] ||&nbsp;</div></li><li><div>            ! $this-&gt;custom_code_args['php_writeable'] ||&nbsp;</div></li><li><div>            ! $this-&gt;custom_code_args['js_writeable'] ) { ?&gt;&nbsp;</div></li><li><div>            &lt;p&gt;&lt;em&gt;&lt;?php printf( __( 'You need to make this files writable before you can save your changes. See %s the Codex %s for more information.', 'bestwebsoft' ), &nbsp;</div></li><li><div>            '&lt;a href=&quot;https://codex.wordpress.org/Changing_File_Permissions&quot; target=&quot;_blank&quot;&gt;', &nbsp;</div></li><li><div>            '&lt;/a&gt;' ); ?&gt;&lt;/em&gt;&lt;/p&gt;&nbsp;</div></li><li><div>        &lt;?php }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( $list as $extension =&gt; $extension_data ) {&nbsp;</div></li><li><div>            $name = 'js' == $extension ? 'JavaScript' : strtoupper( $extension ); ?&gt;&nbsp;</div></li><li><div>            &lt;p&gt;&lt;big&gt;&nbsp;</div></li><li><div>                &lt;strong&gt;&lt;?php echo $name; ?&gt;&lt;/strong&gt;&nbsp;</div></li><li><div>                &lt;?php if ( ! $this-&gt;custom_code_args[&quot;{$extension}_writeable&quot;] )&nbsp;</div></li><li><div>                    echo '(' . __( 'Browsing', 'bestwebsoft' ) . ')'; ?&gt;&nbsp;</div></li><li><div>            &lt;/big&gt;&lt;/p&gt;&nbsp;</div></li><li><div>            &lt;p class=&quot;bws_info&quot;&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;checkbox&quot; name=&quot;bws_custom_&lt;?php echo $extension; ?&gt;_active&quot; value=&quot;1&quot; &lt;?php if ( $this-&gt;custom_code_args[&quot;is_{$extension}_active&quot;] ) echo &quot;checked&quot;; ?&gt; /&gt; &nbsp;</div></li><li><div>                &lt;?php printf( __( 'Activate custom %s code.', 'bestwebsoft' ), $name ); ?&gt;&nbsp;</div></li><li><div>            &lt;/p&gt;&nbsp;</div></li><li><div>            &lt;textarea cols=&quot;70&quot; rows=&quot;25&quot; name=&quot;bws_newcontent_&lt;?php echo $extension; ?&gt;&quot; id=&quot;bws_newcontent_&lt;?php echo $extension; ?&gt;&quot;&gt;&lt;?php if ( isset( $this-&gt;custom_code_args[&quot;content_{$extension}&quot;] ) ) echo $this-&gt;custom_code_args[&quot;content_{$extension}&quot;]; ?&gt;&lt;/textarea&gt;&nbsp;</div></li><li><div>            &lt;p class=&quot;bws_info&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php echo $extension_data['description']; ?&gt;&nbsp;</div></li><li><div>                &lt;br&gt;&nbsp;</div></li><li><div>                &lt;a href=&quot;&lt;?php echo $extension_data['learn_more_link']; ?&gt;&quot; target=&quot;_blank&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php printf( __( 'Learn more about %s', 'bestwebsoft' ), $name ); ?&gt;&nbsp;</div></li><li><div>                &lt;/a&gt;&nbsp;</div></li><li><div>            &lt;/p&gt;&nbsp;</div></li><li><div>        &lt;?php }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Save plugin options to the database&nbsp;</div></li><li><div>     * @access private&nbsp;</div></li><li><div>     * @return array    The action results&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function save_options_custom_code() {&nbsp;</div></li><li><div>        global $bstwbsftwppdtplgns_options;&nbsp;</div></li><li><div>        $folder = $this-&gt;upload_dir['basedir'] . '/bws-custom-code';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        foreach ( array( 'css', 'php', 'js' ) as $extension ) {                &nbsp;</div></li><li><div>            $file = 'bws-custom-code.' . $extension;&nbsp;</div></li><li><div>            $real_file = $folder . '/' . $file;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( isset( $_POST[&quot;bws_newcontent_{$extension}&quot;] ) &&&nbsp;</div></li><li><div>                $this-&gt;custom_code_args[&quot;{$extension}_writeable&quot;] ) {&nbsp;</div></li><li><div>                $newcontent = trim( wp_unslash( $_POST[&quot;bws_newcontent_{$extension}&quot;] ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( ! empty( $newcontent ) && isset( $_POST[&quot;bws_custom_{$extension}_active&quot;] ) ) {&nbsp;</div></li><li><div>                    $this-&gt;custom_code_args[&quot;is_{$extension}_active&quot;] = true;&nbsp;</div></li><li><div>                    if ( $this-&gt;is_multisite ) {&nbsp;</div></li><li><div>                        $bstwbsftwppdtplgns_options['custom_code'][ $this-&gt;custom_code_args['blog_id'] ][ $file ] = ( 'php' == $extension ) ? $real_file : $this-&gt;upload_dir['baseurl'] . '/bws-custom-code/' . $file;&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $bstwbsftwppdtplgns_options['custom_code'][ $file ] = ( 'php' == $extension ) ? $real_file : $this-&gt;upload_dir['baseurl'] . '/bws-custom-code/' . $file;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $this-&gt;custom_code_args[&quot;is_{$extension}_active&quot;] = false;&nbsp;</div></li><li><div>                    if ( $this-&gt;is_multisite ) {&nbsp;</div></li><li><div>                        if ( isset( $bstwbsftwppdtplgns_options['custom_code'][ $this-&gt;custom_code_args['blog_id'] ][ $file ] ) )&nbsp;</div></li><li><div>                            unset( $bstwbsftwppdtplgns_options['custom_code'][ $this-&gt;custom_code_args['blog_id'] ][ $file ] );&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        if ( isset( $bstwbsftwppdtplgns_options['custom_code'][ $file ] ) )&nbsp;</div></li><li><div>                            unset( $bstwbsftwppdtplgns_options['custom_code'][ $file ] );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                if ( $f = fopen( $real_file, 'w+' ) ) {&nbsp;</div></li><li><div>                    fwrite( $f, $newcontent );&nbsp;</div></li><li><div>                    fclose( $f );&nbsp;</div></li><li><div>                    $this-&gt;custom_code_args[&quot;content_{$extension}&quot;] = $newcontent;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $this-&gt;is_multisite )&nbsp;</div></li><li><div>            update_site_option( 'bstwbsftwppdtplgns_options', $bstwbsftwppdtplgns_options );&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            update_option( 'bstwbsftwppdtplgns_options', $bstwbsftwppdtplgns_options );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display 'misc' tab&nbsp;</div></li><li><div>     * @access private&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function tab_misc() { &nbsp;</div></li><li><div>        global $bstwbsftwppdtplgns_options; ?&gt;&nbsp;</div></li><li><div>        &lt;h3 class=&quot;bws_tab_label&quot;&gt;&lt;?php _e( 'Miscellaneous Settings', 'bestwebsoft' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>        &lt;?php $this-&gt;help_phrase(); ?&gt;&nbsp;</div></li><li><div>        &lt;hr&gt;&nbsp;</div></li><li><div>        &lt;?php /**&nbsp;</div></li><li><div>         * action - Display custom options on the Import / Export' tab&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        do_action( __CLASS__ . '_additional_misc_options' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! $this-&gt;forbid_view && ! empty( $this-&gt;change_permission_attr ) ) { ?&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;error inline bws_visible&quot;&gt;&lt;p&gt;&lt;strong&gt;&lt;?php _e( &quot;Notice&quot;, 'bestwebsoft' ); ?&gt;:&lt;/strong&gt; &lt;strong&gt;&lt;?php printf( __( &quot;It is prohibited to change %s settings on this site in the %s network settings.&quot;, 'bestwebsoft' ), $this-&gt;plugins_info[&quot;Name&quot;], $this-&gt;plugins_info[&quot;Name&quot;] ); ?&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php }&nbsp;</div></li><li><div>        if ( $this-&gt;forbid_view ) { ?&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;error inline bws_visible&quot;&gt;&lt;p&gt;&lt;strong&gt;&lt;?php _e( &quot;Notice&quot;, 'bestwebsoft' ); ?&gt;:&lt;/strong&gt; &lt;strong&gt;&lt;?php printf( __( &quot;It is prohibited to view %s settings on this site in the %s network settings.&quot;, 'bestwebsoft' ), $this-&gt;plugins_info[&quot;Name&quot;], $this-&gt;plugins_info[&quot;Name&quot;] ); ?&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php } else { ?&gt;&nbsp;</div></li><li><div>            &lt;table class=&quot;form-table&quot;&gt;            &nbsp;</div></li><li><div>                &lt;?php /**&nbsp;</div></li><li><div>                 * action - Display custom options on the 'misc' tab&nbsp;</div></li><li><div>                 */&nbsp;</div></li><li><div>                do_action( __CLASS__ . '_additional_misc_options_affected' );&nbsp;</div></li><li><div>                if ( ! empty( $this-&gt;pro_page ) && $this-&gt;bws_hide_pro_option_exist ) { ?&gt;&nbsp;</div></li><li><div>                    &lt;tr&gt;&nbsp;</div></li><li><div>                        &lt;th scope=&quot;row&quot;&gt;&lt;?php _e( 'Pro Options', 'bestwebsoft' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                        &lt;td&gt;&nbsp;</div></li><li><div>                            &lt;input &lt;?php echo $this-&gt;change_permission_attr; ?&gt; name=&quot;bws_hide_premium_options_submit&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php if ( ! $this-&gt;hide_pro_tabs ) echo 'checked=&quot;checked &quot;'; ?&gt; /&gt; &nbsp;</div></li><li><div>                            &lt;span class=&quot;bws_info&quot;&gt;&lt;?php _e( 'Enable to display plugin Pro options.', 'bestwebsoft' ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                        &lt;/td&gt;&nbsp;</div></li><li><div>                    &lt;/tr&gt;&nbsp;</div></li><li><div>                &lt;?php } ?&gt;&nbsp;</div></li><li><div>                &lt;tr&gt;&nbsp;</div></li><li><div>                    &lt;th scope=&quot;row&quot;&gt;&lt;?php _e( 'Track Usage', 'bestwebsoft' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                    &lt;td&gt;&nbsp;</div></li><li><div>                        &lt;input &lt;?php echo $this-&gt;change_permission_attr; ?&gt; name=&quot;bws_track_usage&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php if ( ! empty( $bstwbsftwppdtplgns_options['track_usage']['products'][ $this-&gt;plugin_basename ] ) ) echo 'checked=&quot;checked &quot;'; ?&gt;/&gt; &nbsp;</div></li><li><div>                        &lt;span class=&quot;bws_info&quot;&gt;&lt;?php _e( 'Enable to allow tracking plugin usage anonymously in order to make it better.', 'bestwebsoft' ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                    &lt;/td&gt;&nbsp;</div></li><li><div>                &lt;/tr&gt;&nbsp;</div></li><li><div>                &lt;tr&gt;&nbsp;</div></li><li><div>                    &lt;th scope=&quot;row&quot;&gt;&lt;?php _e( 'Default Settings', 'bestwebsoft' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                    &lt;td&gt;&nbsp;</div></li><li><div>                        &lt;input&lt;?php echo $this-&gt;change_permission_attr; ?&gt; name=&quot;bws_restore_default&quot; type=&quot;submit&quot; class=&quot;button&quot; value=&quot;&lt;?php _e( 'Restore Settings', 'bestwebsoft' ); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                        &lt;div class=&quot;bws_info&quot;&gt;&lt;?php _e( 'This will restore plugin settings to defaults.', 'bestwebsoft' ); ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;/td&gt;&nbsp;</div></li><li><div>                &lt;/tr&gt;&nbsp;</div></li><li><div>            &lt;/table&gt;&nbsp;</div></li><li><div>        &lt;?php }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display 'Import / Export' tab&nbsp;</div></li><li><div>     * @access private&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function tab_import_export() { ?&gt;&nbsp;</div></li><li><div>        &lt;h3 class=&quot;bws_tab_label&quot;&gt;&lt;?php _e( 'Import / Export', 'bestwebsoft' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>        &lt;?php $this-&gt;help_phrase(); ?&gt;&nbsp;</div></li><li><div>        &lt;hr&gt;                        &nbsp;</div></li><li><div>        &lt;?php /**&nbsp;</div></li><li><div>         * action - Display custom options on the Import / Export' tab&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        do_action( __CLASS__ . '_additional_import_export_options' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( ! $this-&gt;forbid_view && ! empty( $this-&gt;change_permission_attr ) ) { ?&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;error inline bws_visible&quot;&gt;&lt;p&gt;&lt;strong&gt;&lt;?php _e( &quot;Notice&quot;, 'bestwebsoft' ); ?&gt;:&lt;/strong&gt; &lt;strong&gt;&lt;?php printf( __( &quot;It is prohibited to change %s settings on this site in the %s network settings.&quot;, 'bestwebsoft' ), $this-&gt;plugins_info[&quot;Name&quot;], $this-&gt;plugins_info[&quot;Name&quot;] ); ?&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php }&nbsp;</div></li><li><div>        if ( $this-&gt;forbid_view ) { ?&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;error inline bws_visible&quot;&gt;&lt;p&gt;&lt;strong&gt;&lt;?php _e( &quot;Notice&quot;, 'bestwebsoft' ); ?&gt;:&lt;/strong&gt; &lt;strong&gt;&lt;?php printf( __( &quot;It is prohibited to view %s settings on this site in the %s network settings.&quot;, 'bestwebsoft' ), $this-&gt;plugins_info[&quot;Name&quot;], $this-&gt;plugins_info[&quot;Name&quot;] ); ?&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php } else { ?&gt;&nbsp;</div></li><li><div>            &lt;table class=&quot;form-table&quot;&gt;                      &nbsp;</div></li><li><div>                &lt;?php /**&nbsp;</div></li><li><div>                 * action - Display custom options on the Import / Export' tab&nbsp;</div></li><li><div>                 */&nbsp;</div></li><li><div>                do_action( __CLASS__ . '_additional_import_export_options_affected' ); ?&gt;&nbsp;</div></li><li><div>            &lt;/table&gt;&nbsp;</div></li><li><div>        &lt;?php }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Save plugin options to the database&nbsp;</div></li><li><div>     * @access private&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function save_options_misc() {&nbsp;</div></li><li><div>        global $bstwbsftwppdtplgns_options, $wp_version;&nbsp;</div></li><li><div>        /** hide premium options */&nbsp;</div></li><li><div>        if ( ! empty( $this-&gt;pro_page ) ) {&nbsp;</div></li><li><div>            if ( isset( $_POST['bws_hide_premium_options'] ) ) {&nbsp;</div></li><li><div>                $hide_result = bws_hide_premium_options( $this-&gt;options );&nbsp;</div></li><li><div>                $this-&gt;hide_pro_tabs = true;&nbsp;</div></li><li><div>                $this-&gt;options = $hide_result['options'];&nbsp;</div></li><li><div>                if ( ! empty( $hide_result['message'] ) )&nbsp;</div></li><li><div>                    $notice = $hide_result['message'];&nbsp;</div></li><li><div>                if ( $this-&gt;is_network_options )&nbsp;</div></li><li><div>                    update_site_option( $this-&gt;prefix . '_options', $this-&gt;options );&nbsp;</div></li><li><div>                else&nbsp;</div></li><li><div>                    update_option( $this-&gt;prefix . '_options', $this-&gt;options );&nbsp;</div></li><li><div>            } else if ( isset( $_POST['bws_hide_premium_options_submit'] ) ) {&nbsp;</div></li><li><div>                if ( ! empty( $this-&gt;options['hide_premium_options'] ) ) {&nbsp;</div></li><li><div>                    $key = array_search( get_current_user_id(), $this-&gt;options['hide_premium_options'] );&nbsp;</div></li><li><div>                    if ( false !== $key )&nbsp;</div></li><li><div>                        unset( $this-&gt;options['hide_premium_options'][ $key ] );&nbsp;</div></li><li><div>                    if ( $this-&gt;is_network_options )&nbsp;</div></li><li><div>                        update_site_option( $this-&gt;prefix . '_options', $this-&gt;options );&nbsp;</div></li><li><div>                    else&nbsp;</div></li><li><div>                        update_option( $this-&gt;prefix . '_options', $this-&gt;options );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $this-&gt;hide_pro_tabs = false;                &nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                if ( empty( $this-&gt;options['hide_premium_options'] ) ) {&nbsp;</div></li><li><div>                    $this-&gt;options['hide_premium_options'][] = get_current_user_id();&nbsp;</div></li><li><div>                    if ( $this-&gt;is_network_options )&nbsp;</div></li><li><div>                        update_site_option( $this-&gt;prefix . '_options', $this-&gt;options );&nbsp;</div></li><li><div>                    else&nbsp;</div></li><li><div>                        update_option( $this-&gt;prefix . '_options', $this-&gt;options );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $this-&gt;hide_pro_tabs = true;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        /** Save 'Track Usage' option */&nbsp;</div></li><li><div>        if ( isset( $_POST['bws_track_usage'] ) ) {&nbsp;</div></li><li><div>            if ( empty( $bstwbsftwppdtplgns_options['track_usage']['products'][ $this-&gt;plugin_basename ] ) ) {&nbsp;</div></li><li><div>                $bstwbsftwppdtplgns_options['track_usage']['products'][ $this-&gt;plugin_basename ] = true;&nbsp;</div></li><li><div>                $track_usage = true;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            if ( ! empty( $bstwbsftwppdtplgns_options['track_usage']['products'][ $this-&gt;plugin_basename ] ) ) {&nbsp;</div></li><li><div>                unset( $bstwbsftwppdtplgns_options['track_usage']['products'][ $this-&gt;plugin_basename ] ); false;&nbsp;</div></li><li><div>                $track_usage = false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( isset( $track_usage ) ) {&nbsp;</div></li><li><div>            $usage_id = ! empty( $bstwbsftwppdtplgns_options['track_usage']['usage_id'] ) ? $bstwbsftwppdtplgns_options['track_usage']['usage_id'] : false;&nbsp;</div></li><li><div>            /** send data */&nbsp;</div></li><li><div>            $options = array(&nbsp;</div></li><li><div>                'timeout' =&gt; 3, &nbsp;</div></li><li><div>                'body' =&gt; array(&nbsp;</div></li><li><div>                    'url' =&gt; get_bloginfo( 'url' ), &nbsp;</div></li><li><div>                    'wp_version' =&gt; $wp_version, &nbsp;</div></li><li><div>                    'is_active' =&gt; $track_usage, &nbsp;</div></li><li><div>                    'product' =&gt; $this-&gt;plugin_basename, &nbsp;</div></li><li><div>                    'version' =&gt; $this-&gt;plugins_info['Version'], &nbsp;</div></li><li><div>                    'usage_id' =&gt; $usage_id, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                'user-agent' =&gt; 'WordPress/' . $wp_version . '; ' . get_bloginfo( 'url' )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            $raw_response = wp_remote_post( 'http://bestwebsoft.com/wp-content/plugins/products-statistics/track-usage/', $options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( ! is_wp_error( $raw_response ) && 200 == wp_remote_retrieve_response_code( $raw_response ) ) {&nbsp;</div></li><li><div>                $response = maybe_unserialize( wp_remote_retrieve_body( $raw_response ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                if ( is_array( $response ) &&&nbsp;</div></li><li><div>                    ! empty( $response['usage_id'] ) &&&nbsp;</div></li><li><div>                    $response['usage_id'] != $usage_id ) {&nbsp;</div></li><li><div>                    $bstwbsftwppdtplgns_options['track_usage']['usage_id'] = $response['usage_id'];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $this-&gt;is_multisite )&nbsp;</div></li><li><div>                update_site_option( 'bstwbsftwppdtplgns_options', $bstwbsftwppdtplgns_options );&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                update_option( 'bstwbsftwppdtplgns_options', $bstwbsftwppdtplgns_options );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return compact( 'notice' );&nbsp;</div></li><li><div>    }                &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function tab_license() {&nbsp;</div></li><li><div>        global $wp_version, $bstwbsftwppdtplgns_options; ?&gt;&nbsp;</div></li><li><div>        &lt;h3 class=&quot;bws_tab_label&quot;&gt;&lt;?php _e( 'License Key', 'bestwebsoft' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>        &lt;?php $this-&gt;help_phrase(); ?&gt;&nbsp;</div></li><li><div>        &lt;hr&gt;&nbsp;</div></li><li><div>        &lt;?php if ( ! empty( $this-&gt;pro_page ) ) {&nbsp;</div></li><li><div>            $bws_license_key = ( isset( $_POST['bws_license_key'] ) ) ? stripslashes( esc_html( trim( $_POST['bws_license_key'] ) ) ) : &quot;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if ( $this-&gt;pro_plugin_is_activated ) { &nbsp;</div></li><li><div>                deactivate_plugins( $this-&gt;plugin_basename ); ?&gt;&nbsp;</div></li><li><div>                &lt;script type=&quot;text/javascript&quot;&gt;&nbsp;</div></li><li><div>                    (function($) {&nbsp;</div></li><li><div>                        var i = 7;&nbsp;</div></li><li><div>                        function bws_set_timeout() {&nbsp;</div></li><li><div>                            i--;&nbsp;</div></li><li><div>                            if ( 0 == i ) {&nbsp;</div></li><li><div>                                window.location.href = '&lt;?php echo $this-&gt;pro_page; ?&gt;';&nbsp;</div></li><li><div>                            } else {&nbsp;</div></li><li><div>                                $( '#bws_timeout_counter' ).text( i );&nbsp;</div></li><li><div>                                window.setTimeout( bws_set_timeout, 1000 );&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        window.setTimeout( bws_set_timeout, 1000 );&nbsp;</div></li><li><div>                    })(jQuery);&nbsp;</div></li><li><div>                &lt;/script&gt;&nbsp;</div></li><li><div>                &lt;p&gt;&lt;strong&gt;&lt;?php _e( 'Congratulations! Pro license is activated successfully.', 'bestwebsoft' ); ?&gt;&lt;/strong&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                &lt;p&gt;&lt;?php printf( __( 'You will be automatically redirected to the %s in %s seconds.', 'bestwebsoft' ), '&lt;a href=&quot;' . $this-&gt;pro_page . '&quot;&gt;' . __( 'Settings page', 'bestwebsoft' ) . '&lt;/a&gt;', '&lt;span id=&quot;bws_timeout_counter&quot;&gt;7&lt;/span&gt;' ); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>            &lt;?php } else {             &nbsp;</div></li><li><div>                $attr = '';&nbsp;</div></li><li><div>                if ( isset( $bstwbsftwppdtplgns_options['go_pro'][ $this-&gt;bws_license_plugin ]['count'] ) &&&nbsp;</div></li><li><div>                    '5' &lt; $bstwbsftwppdtplgns_options['go_pro'][ $this-&gt;bws_license_plugin ]['count'] &&&nbsp;</div></li><li><div>                    $bstwbsftwppdtplgns_options['go_pro'][ $this-&gt;bws_license_plugin ]['time'] &gt; ( time() - ( 24 * 60 * 60 ) ) )&nbsp;</div></li><li><div>                    $attr = 'disabled=&quot;disabled&quot;'; ?&gt;        &nbsp;</div></li><li><div>                &lt;table class=&quot;form-table&quot;&gt;            &nbsp;</div></li><li><div>                    &lt;tr&gt;&nbsp;</div></li><li><div>                        &lt;th scope=&quot;row&quot;&gt;&lt;?php _e( 'License Key', 'bestwebsoft' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                        &lt;td&gt;&nbsp;</div></li><li><div>                            &lt;input &lt;?php echo $attr; ?&gt; type=&quot;text&quot; name=&quot;bws_license_key&quot; value=&quot;&lt;?php echo $bws_license_key; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                            &lt;input &lt;?php echo $attr; ?&gt; type=&quot;hidden&quot; name=&quot;bws_license_plugin&quot; value=&quot;&lt;?php echo $this-&gt;bws_license_plugin; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                            &lt;input &lt;?php echo $attr; ?&gt; type=&quot;submit&quot; class=&quot;button button-secondary&quot; name=&quot;bws_license_submit&quot; value=&quot;&lt;?php _e( 'Activate', 'bestwebsoft' ); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                            &lt;div class=&quot;bws_info&quot;&gt;&nbsp;</div></li><li><div>                                &lt;?php printf( __( 'Enter your license key to activate %s and get premium plugin features.', 'bestwebsoft' ), '&lt;a href=&quot;' . $this-&gt;plugins_info['PluginURI'] . '?k=' . $this-&gt;link_key . '&pn=' . $this-&gt;link_pn . '&v=' . $this-&gt;plugins_info[&quot;Version&quot;] . '&wp_v=' . $wp_version . '&quot; target=&quot;_blank&quot; title=&quot;' . $this-&gt;plugins_info[&quot;Name&quot;] . ' Pro&quot;&gt;' . $this-&gt;plugins_info[&quot;Name&quot;] . ' Pro&lt;/a&gt;' ); ?&gt;&nbsp;</div></li><li><div>                            &lt;/div&gt;&nbsp;</div></li><li><div>                            &lt;?php if ( '' != $attr ) { ?&gt;&nbsp;</div></li><li><div>                                &lt;p&gt;&lt;?php _e( &quot;Unfortunately, you have exceeded the number of available tries per day. Please, upload the plugin manually.&quot;, 'bestwebsoft' ); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                            &lt;?php }&nbsp;</div></li><li><div>                            if ( $this-&gt;trial_days !== false )&nbsp;</div></li><li><div>                                echo '&lt;p&gt;' . __( 'or', 'bestwebsoft' ) . ' &lt;a href=&quot;' . $this-&gt;plugins_info['PluginURI'] . 'trial/?k=' . $this-&gt;link_key . '&pn=' . $this-&gt;link_pn . '&v=' . $this-&gt;plugins_info[&quot;Version&quot;] . '&wp_v=' . $wp_version . '&quot; target=&quot;_blank&quot;&gt;' . sprintf( __( 'Start Your Free %s-Day Trial Now', 'bestwebsoft' ), $this-&gt;trial_days ) . '&lt;/a&gt;&lt;/p&gt;'; ?&gt;&nbsp;</div></li><li><div>                        &lt;/td&gt;&nbsp;</div></li><li><div>                    &lt;/tr&gt;&nbsp;</div></li><li><div>                &lt;/table&gt;&nbsp;</div></li><li><div>            &lt;?php }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            global $bstwbsftwppdtplgns_options;&nbsp;</div></li><li><div>            $license_key = ( isset( $bstwbsftwppdtplgns_options[ $this-&gt;plugin_basename ] ) ) ? $bstwbsftwppdtplgns_options[ $this-&gt;plugin_basename ] : ''; ?&gt;&nbsp;</div></li><li><div>            &lt;table class=&quot;form-table&quot;&gt;            &nbsp;</div></li><li><div>                &lt;tr&gt;&nbsp;</div></li><li><div>                    &lt;th scope=&quot;row&quot;&gt;&lt;?php _e( 'License Key', 'bestwebsoft' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                    &lt;td&gt;&nbsp;</div></li><li><div>                        &lt;input type=&quot;text&quot; maxlength=&quot;100&quot; name=&quot;bws_license_key&quot; value=&quot;&lt;?php echo $license_key; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                        &lt;input type=&quot;submit&quot; class=&quot;button button-secondary&quot; name=&quot;bws_license_submit&quot; value=&quot;&lt;?php _e( 'Check license key', 'bestwebsoft' ); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>                        &lt;div class=&quot;bws_info&quot;&gt;&nbsp;</div></li><li><div>                            &lt;?php _e( 'If necessary, you can check if the license key is correct or reenter it in the field below.', 'bestwebsoft' ); ?&gt;&nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;/td&gt;&nbsp;</div></li><li><div>                &lt;/tr&gt;&nbsp;</div></li><li><div>                &lt;tr&gt;&nbsp;</div></li><li><div>                    &lt;th scope=&quot;row&quot;&gt;&lt;?php _e( 'Manage License Settings', 'bestwebsoft' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                    &lt;td&gt;&nbsp;</div></li><li><div>                        &lt;a class=&quot;button button-secondary&quot; href=&quot;https://bestwebsoft.com/client-area&quot; target=&quot;_blank&quot;&gt;&lt;?php _e( 'Login to Client Area', 'bestwebsoft' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                        &lt;div class=&quot;bws_info&quot;&gt;&nbsp;</div></li><li><div>                            &lt;?php _e( 'Manage active licenses, download BWS products, and view your payment history using BestWebSoft Client Area.', 'bestwebsoft' ); ?&gt;&nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;/td&gt;&nbsp;</div></li><li><div>                &lt;/tr&gt;&nbsp;</div></li><li><div>            &lt;/table&gt;&nbsp;</div></li><li><div>        &lt;?php }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Save plugin options to the database&nbsp;</div></li><li><div>     * @access private&nbsp;</div></li><li><div>     * @param  ab&nbsp;</div></li><li><div>     * @return array    The action results&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private function save_options_license_key() {&nbsp;</div></li><li><div>        global $wp_version, $bstwbsftwppdtplgns_options;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $bws_license_key = ( isset( $_POST['bws_license_key'] ) ) ? stripslashes( esc_html( trim( $_POST['bws_license_key'] ) ) ) : '';&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        if ( '' != $bws_license_key ) {&nbsp;</div></li><li><div>            if ( strlen( $bws_license_key ) != 18 ) {&nbsp;</div></li><li><div>                $error = __( 'Wrong license key', 'bestwebsoft' );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                /** CHECK license key */&nbsp;</div></li><li><div>                if ( $this-&gt;is_pro ) {&nbsp;</div></li><li><div>                    delete_transient( 'bws_plugins_update' );&nbsp;</div></li><li><div>                    if ( ! $this-&gt;all_plugins ) {&nbsp;</div></li><li><div>                        if ( ! function_exists( 'get_plugins' ) )&nbsp;</div></li><li><div>                            require_once( ABSPATH . 'wp-admin/includes/plugin.php' );&nbsp;</div></li><li><div>                        $this-&gt;all_plugins = get_plugins();&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $current = get_site_transient( 'update_plugins' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( ! empty( $this-&gt;all_plugins ) && isset( $current ) && is_array( $current-&gt;response ) ) {&nbsp;</div></li><li><div>                        $to_send = array();&nbsp;</div></li><li><div>                        $to_send[&quot;plugins&quot;][ $this-&gt;plugin_basename ] = $this-&gt;all_plugins[ $this-&gt;plugin_basename ];&nbsp;</div></li><li><div>                        $to_send[&quot;plugins&quot;][ $this-&gt;plugin_basename ][&quot;bws_license_key&quot;] = $bws_license_key;&nbsp;</div></li><li><div>                        $to_send[&quot;plugins&quot;][ $this-&gt;plugin_basename ][&quot;bws_illegal_client&quot;] = true;&nbsp;</div></li><li><div>                        $options = array(&nbsp;</div></li><li><div>                            'timeout' =&gt; ( ( defined('DOING_CRON') && DOING_CRON ) ? 30 : 3 ), &nbsp;</div></li><li><div>                            'body' =&gt; array( 'plugins' =&gt; serialize( $to_send ) ), &nbsp;</div></li><li><div>                            'user-agent' =&gt; 'WordPress/' . $wp_version . '; ' . get_bloginfo( 'url' )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                        $raw_response = wp_remote_post( 'http://bestwebsoft.com/wp-content/plugins/paid-products/plugins/update-check/1.0/', $options );&nbsp;</div></li><li><div>                        &nbsp;</div></li><li><div>                        if ( is_wp_error( $raw_response ) || 200 != wp_remote_retrieve_response_code( $raw_response ) ) {&nbsp;</div></li><li><div>                            $error = __( 'Something went wrong. Please try again later. If the error appears again, please contact us', 'bestwebsoft' ) . ': &lt;a href=https://support.bestwebsoft.com&gt;BestWebSoft&lt;/a&gt;. ' . __( 'We are sorry for inconvenience.', 'bestwebsoft' );&nbsp;</div></li><li><div>                        } else {&nbsp;</div></li><li><div>                            $response = maybe_unserialize( wp_remote_retrieve_body( $raw_response ) );&nbsp;</div></li><li><div>                            if ( is_array( $response ) && !empty( $response ) ) {&nbsp;</div></li><li><div>                                foreach ( $response as $single_response ) {&nbsp;</div></li><li><div>                                    if ( &quot;wrong_license_key&quot; == $single_response-&gt;package ) {&nbsp;</div></li><li><div>                                        $error = __( 'Wrong license key.', 'bestwebsoft' );&nbsp;</div></li><li><div>                                    } else if ( &quot;wrong_domain&quot; == $single_response-&gt;package ) {&nbsp;</div></li><li><div>                                        $error = __( 'This license key is bound to another site.', 'bestwebsoft' );&nbsp;</div></li><li><div>                                    } else if ( &quot;time_out&quot; == $single_response-&gt;package ) {&nbsp;</div></li><li><div>                                        $message = __( 'This license key is valid, but Your license has expired. If you want to update our plugin in future, you should extend the license.', 'bestwebsoft' );&nbsp;</div></li><li><div>                                    } elseif ( &quot;you_are_banned&quot; == $single_response-&gt;package ) {&nbsp;</div></li><li><div>                                        $error = __( &quot;Unfortunately, you have exceeded the number of available tries.&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>                                    } elseif ( &quot;duplicate_domen_for_trial&quot; == $single_response-&gt;package ) {&nbsp;</div></li><li><div>                                        $error = __( &quot;Unfortunately, the Pro Trial licence was already installed to this domain. The Pro Trial license can be installed only once.&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>                                    }                                        &nbsp;</div></li><li><div>                                    if ( empty( $error ) ) {&nbsp;</div></li><li><div>                                        if ( empty( $message ) ) {&nbsp;</div></li><li><div>                                            if ( isset( $single_response-&gt;trial ) )&nbsp;</div></li><li><div>                                                $message = __( 'The Pro Trial license key is valid.', 'bestwebsoft' );&nbsp;</div></li><li><div>                                            else&nbsp;</div></li><li><div>                                                $message = __( 'The license key is valid.', 'bestwebsoft' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            if ( ! empty( $single_response-&gt;time_out ) )&nbsp;</div></li><li><div>                                                $message .= ' ' . __( 'Your license will expire on', 'bestwebsoft' ) . ' ' . $single_response-&gt;time_out . '.';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            if ( isset( $single_response-&gt;trial ) && $this-&gt;is_trial )&nbsp;</div></li><li><div>                                                $message .= ' ' . sprintf( __( 'In order to continue using the plugin it is necessary to buy a %s license.', 'bestwebsoft' ), '&lt;a href=&quot;' . $this-&gt;plugins_info['PluginURI'] . '?k=' . $this-&gt;link_key . '&pn=' . $this-&gt;link_pn . '&v=' . $this-&gt;plugins_info[&quot;Version&quot;] . '&wp_v=' . $wp_version . '&quot; target=&quot;_blank&quot; title=&quot;' . $this-&gt;plugins_info[&quot;Name&quot;] . '&quot;&gt;Pro&lt;/a&gt;' );&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        if ( isset( $single_response-&gt;trial ) ) {&nbsp;</div></li><li><div>                                            $bstwbsftwppdtplgns_options['trial'][ $this-&gt;plugin_basename ] = 1;&nbsp;</div></li><li><div>                                        } else {&nbsp;</div></li><li><div>                                            unset( $bstwbsftwppdtplgns_options['trial'][ $this-&gt;plugin_basename ] );&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        if ( isset( $single_response-&gt;nonprofit ) ) {&nbsp;</div></li><li><div>                                            $bstwbsftwppdtplgns_options['nonprofit'][ $this-&gt;plugin_basename ] = 1;&nbsp;</div></li><li><div>                                        } else {&nbsp;</div></li><li><div>                                            unset( $bstwbsftwppdtplgns_options['nonprofit'][ $this-&gt;plugin_basename ] );&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>                                &nbsp;</div></li><li><div>                                        if ( ! isset( $bstwbsftwppdtplgns_options[ $this-&gt;plugin_basename ] ) || $bstwbsftwppdtplgns_options[ $this-&gt;plugin_basename ] != $bws_license_key ) {&nbsp;</div></li><li><div>                                            $bstwbsftwppdtplgns_options[ $this-&gt;plugin_basename ] = $bws_license_key;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                            $file = @fopen( dirname( dirname( __FILE__ ) ) . &quot;/license_key.txt&quot; , &quot;w+&quot; );&nbsp;</div></li><li><div>                                            if ( $file ) {&nbsp;</div></li><li><div>                                                @fwrite( $file, $bws_license_key );&nbsp;</div></li><li><div>                                                @fclose( $file );&nbsp;</div></li><li><div>                                            }&nbsp;</div></li><li><div>                                            $update_option = true;&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        if ( ! isset( $bstwbsftwppdtplgns_options['time_out'][ $this-&gt;plugin_basename ] ) || $bstwbsftwppdtplgns_options['time_out'][ $this-&gt;plugin_basename ] != $single_response-&gt;time_out ) {&nbsp;</div></li><li><div>                                            $bstwbsftwppdtplgns_options['time_out'][ $this-&gt;plugin_basename ] = $single_response-&gt;time_out;&nbsp;</div></li><li><div>                                            $update_option = true;&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        if ( isset( $update_option ) ) {&nbsp;</div></li><li><div>                                            if ( $this-&gt;is_multisite )&nbsp;</div></li><li><div>                                                update_site_option( 'bstwbsftwppdtplgns_options', $bstwbsftwppdtplgns_options );&nbsp;</div></li><li><div>                                            else&nbsp;</div></li><li><div>                                                update_option( 'bstwbsftwppdtplgns_options', $bstwbsftwppdtplgns_options );&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>                                    }&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>                            } else {&nbsp;</div></li><li><div>                                $error = __( 'Something went wrong. Please try again later. If the error appears again, please contact us', 'bestwebsoft' ) . ' &lt;a href=https://support.bestwebsoft.com&gt;BestWebSoft&lt;/a&gt;. ' . __( 'We are sorry for inconvenience.', 'bestwebsoft' );&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                /** Go Pro */&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    $bws_license_plugin = stripslashes( esc_html( $_POST['bws_license_plugin'] ) );&nbsp;</div></li><li><div>                    if ( isset( $bstwbsftwppdtplgns_options['go_pro'][ $bws_license_plugin ]['count'] ) && $bstwbsftwppdtplgns_options['go_pro'][ $bws_license_plugin ]['time'] &gt; ( time() - (24 * 60 * 60) ) ) {&nbsp;</div></li><li><div>                        $bstwbsftwppdtplgns_options['go_pro'][ $bws_license_plugin ]['count'] = $bstwbsftwppdtplgns_options['go_pro'][ $bws_license_plugin ]['count'] + 1;&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $bstwbsftwppdtplgns_options['go_pro'][ $bws_license_plugin ]['count'] = 1;&nbsp;</div></li><li><div>                        $bstwbsftwppdtplgns_options['go_pro'][ $bws_license_plugin ]['time'] = time();&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    /** download Pro */&nbsp;</div></li><li><div>                    if ( ! $this-&gt;all_plugins ) {&nbsp;</div></li><li><div>                        if ( ! function_exists( 'get_plugins' ) )&nbsp;</div></li><li><div>                            require_once( ABSPATH . 'wp-admin/includes/plugin.php' );&nbsp;</div></li><li><div>                        $this-&gt;all_plugins = get_plugins();&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( ! array_key_exists( $bws_license_plugin, $this-&gt;all_plugins ) ) {&nbsp;</div></li><li><div>                        $current = get_site_transient( 'update_plugins' );&nbsp;</div></li><li><div>                        if ( ! empty( $current ) && is_array( $current-&gt;response ) ) {&nbsp;</div></li><li><div>                            $to_send = array();&nbsp;</div></li><li><div>                            $to_send[&quot;plugins&quot;][ $bws_license_plugin ] = array();&nbsp;</div></li><li><div>                            $to_send[&quot;plugins&quot;][ $bws_license_plugin ][&quot;bws_license_key&quot;] = $bws_license_key;&nbsp;</div></li><li><div>                            $to_send[&quot;plugins&quot;][ $bws_license_plugin ][&quot;bws_illegal_client&quot;] = true;&nbsp;</div></li><li><div>                            $options = array(&nbsp;</div></li><li><div>                                'timeout' =&gt; ( ( defined( 'DOING_CRON' ) && DOING_CRON ) ? 30 : 3 ), &nbsp;</div></li><li><div>                                'body' =&gt; array( 'plugins' =&gt; serialize( $to_send ) ), &nbsp;</div></li><li><div>                                'user-agent' =&gt; 'WordPress/' . $wp_version . '; ' . get_bloginfo( 'url' ) );&nbsp;</div></li><li><div>                            $raw_response = wp_remote_post( 'http://bestwebsoft.com/wp-content/plugins/paid-products/plugins/update-check/1.0/', $options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                            if ( is_wp_error( $raw_response ) || 200 != wp_remote_retrieve_response_code( $raw_response ) ) {&nbsp;</div></li><li><div>                                $error = __( &quot;Something went wrong. Please try again later. If the error appears again, please contact us&quot;, 'bestwebsoft' ) . ': &lt;a href=&quot;https://support.bestwebsoft.com&quot;&gt;BestWebSoft&lt;/a&gt;. ' . __( &quot;We are sorry for inconvenience.&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>                            } else {&nbsp;</div></li><li><div>                                $response = maybe_unserialize( wp_remote_retrieve_body( $raw_response ) );&nbsp;</div></li><li><div>                                if ( is_array( $response ) && ! empty( $response ) ) {&nbsp;</div></li><li><div>                                    foreach ( $response as $single_response ) {&nbsp;</div></li><li><div>                                        if ( &quot;wrong_license_key&quot; == $single_response-&gt;package ) {&nbsp;</div></li><li><div>                                            $error = __( &quot;Wrong license key.&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>                                        } elseif ( &quot;wrong_domain&quot; == $single_response-&gt;package ) {&nbsp;</div></li><li><div>                                            $error = __( &quot;This license key is bound to another site.&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>                                        } elseif ( &quot;you_are_banned&quot; == $single_response-&gt;package ) {&nbsp;</div></li><li><div>                                            $error = __( &quot;Unfortunately, you have exceeded the number of available tries per day. Please, upload the plugin manually.&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>                                        } elseif ( &quot;time_out&quot; == $single_response-&gt;package ) {&nbsp;</div></li><li><div>                                            $error = sprintf( __( &quot;Unfortunately, Your license has expired. To continue getting top-priority support and plugin updates, you should extend it in your %s&quot;, 'bestwebsoft' ), ' &lt;a href=&quot;https://bestwebsoft.com/client-area&quot;&gt;Client Area&lt;/a&gt;' );&nbsp;</div></li><li><div>                                        } elseif ( &quot;duplicate_domen_for_trial&quot; == $single_response-&gt;package ) {&nbsp;</div></li><li><div>                                            $error = __( &quot;Unfortunately, the Pro licence was already installed to this domain. The Pro Trial license can be installed only once.&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>                                    }&nbsp;</div></li><li><div>                                    if ( empty( $error ) ) {&nbsp;</div></li><li><div>                                        $bstwbsftwppdtplgns_options[ $bws_license_plugin ] = $bws_license_key;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        $url = 'http://bestwebsoft.com/wp-content/plugins/paid-products/plugins/downloads/?bws_first_download=' . $bws_license_plugin . '&bws_license_key=' . $bws_license_key . '&download_from=5';&nbsp;</div></li><li><div>                                        &nbsp;</div></li><li><div>                                        if ( ! $this-&gt;upload_dir )&nbsp;</div></li><li><div>                                            $this-&gt;upload_dir = wp_upload_dir();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        $zip_name = explode( '/', $bws_license_plugin );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        if ( !function_exists( 'curl_init' ) ) {&nbsp;</div></li><li><div>                                            $received_content = file_get_contents( $url );&nbsp;</div></li><li><div>                                        } else {&nbsp;</div></li><li><div>                                            $ch = curl_init();&nbsp;</div></li><li><div>                                            curl_setopt( $ch, CURLOPT_URL, $url );&nbsp;</div></li><li><div>                                            curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true );&nbsp;</div></li><li><div>                                            $received_content = curl_exec( $ch );&nbsp;</div></li><li><div>                                            curl_close( $ch );&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        if ( ! $received_content ) {&nbsp;</div></li><li><div>                                            $error = __( &quot;Failed to download the zip archive. Please, upload the plugin manually&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>                                        } else {&nbsp;</div></li><li><div>                                            if ( is_writable( $this-&gt;upload_dir[&quot;path&quot;] ) ) {&nbsp;</div></li><li><div>                                                $file_put_contents = $this-&gt;upload_dir[&quot;path&quot;] . &quot;/&quot; . $zip_name[0] . &quot;.zip&quot;;&nbsp;</div></li><li><div>                                                if ( file_put_contents( $file_put_contents, $received_content ) ) {&nbsp;</div></li><li><div>                                                    @chmod( $file_put_contents, octdec( 755 ) );&nbsp;</div></li><li><div>                                                    if ( class_exists( 'ZipArchive' ) ) {&nbsp;</div></li><li><div>                                                        $zip = new ZipArchive();&nbsp;</div></li><li><div>                                                        if ( $zip-&gt;open( $file_put_contents ) === TRUE ) {&nbsp;</div></li><li><div>                                                            $zip-&gt;extractTo( WP_PLUGIN_DIR );&nbsp;</div></li><li><div>                                                            $zip-&gt;close();&nbsp;</div></li><li><div>                                                        } else {&nbsp;</div></li><li><div>                                                            $error = __( &quot;Failed to open the zip archive. Please, upload the plugin manually&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>                                                        }&nbsp;</div></li><li><div>                                                    } elseif ( class_exists( 'Phar' ) ) {&nbsp;</div></li><li><div>                                                        $phar = new PharData( $file_put_contents );&nbsp;</div></li><li><div>                                                        $phar-&gt;extractTo( WP_PLUGIN_DIR );&nbsp;</div></li><li><div>                                                    } else {&nbsp;</div></li><li><div>                                                        $error = __( &quot;Your server does not support either ZipArchive or Phar. Please, upload the plugin manually&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>                                                    }&nbsp;</div></li><li><div>                                                    @unlink( $file_put_contents );&nbsp;</div></li><li><div>                                                } else {&nbsp;</div></li><li><div>                                                    $error = __( &quot;Failed to download the zip archive. Please, upload the plugin manually&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>                                                }&nbsp;</div></li><li><div>                                            } else {&nbsp;</div></li><li><div>                                                $error = __( &quot;UploadDir is not writable. Please, upload the plugin manually&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>                                            }&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                                        /** activate Pro */&nbsp;</div></li><li><div>                                        if ( file_exists( WP_PLUGIN_DIR . '/' . $zip_name[0] ) ) {&nbsp;</div></li><li><div>                                            if ( $this-&gt;is_multisite && is_plugin_active_for_network( $this-&gt;plugin_basename ) ) {&nbsp;</div></li><li><div>                                                /** if multisite and free plugin is network activated */&nbsp;</div></li><li><div>                                                $active_plugins = get_site_option( 'active_sitewide_plugins' );&nbsp;</div></li><li><div>                                                $active_plugins[ $bws_license_plugin ] = time();&nbsp;</div></li><li><div>                                                update_site_option( 'active_sitewide_plugins', $active_plugins );&nbsp;</div></li><li><div>                                            } else {&nbsp;</div></li><li><div>                                                /** activate on a single blog */&nbsp;</div></li><li><div>                                                $active_plugins = get_option( 'active_plugins' );&nbsp;</div></li><li><div>                                                array_push( $active_plugins, $bws_license_plugin );&nbsp;</div></li><li><div>                                                update_option( 'active_plugins', $active_plugins );&nbsp;</div></li><li><div>                                            }&nbsp;</div></li><li><div>                                            $this-&gt;pro_plugin_is_activated = true;&nbsp;</div></li><li><div>                                        } elseif ( empty( $error ) ) {&nbsp;</div></li><li><div>                                            $error = __( &quot;Failed to download the zip archive. Please, upload the plugin manually&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>                                        }&nbsp;</div></li><li><div>                                    }&nbsp;</div></li><li><div>                                } else {&nbsp;</div></li><li><div>                                    $error = __( &quot;Something went wrong. Try again later or upload the plugin manually. We are sorry for inconvenience.&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>                                }&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $bstwbsftwppdtplgns_options[ $bws_license_plugin ] = $bws_license_key;&nbsp;</div></li><li><div>                        /** activate Pro */&nbsp;</div></li><li><div>                        if ( ! is_plugin_active( $bws_license_plugin ) ) {&nbsp;</div></li><li><div>                            if ( $this-&gt;is_multisite && is_plugin_active_for_network( $this-&gt;plugin_basename ) ) {&nbsp;</div></li><li><div>                                /** if multisite and free plugin is network activated */&nbsp;</div></li><li><div>                                $network_wide = true;&nbsp;</div></li><li><div>                            } else {&nbsp;</div></li><li><div>                                /** activate on a single blog */&nbsp;</div></li><li><div>                                $network_wide = false;&nbsp;</div></li><li><div>                            }&nbsp;</div></li><li><div>                            activate_plugin( $bws_license_plugin, NULL, $network_wide );&nbsp;</div></li><li><div>                            $this-&gt;pro_plugin_is_activated = true;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    /** add 'track_usage' for Pro version */&nbsp;</div></li><li><div>                    if ( ! empty( $bstwbsftwppdtplgns_options['track_usage'][ $this-&gt;plugin_basename ] ) &&&nbsp;</div></li><li><div>                        empty( $bstwbsftwppdtplgns_options['track_usage'][ $bws_license_plugin ] ) ) {&nbsp;</div></li><li><div>                        $bstwbsftwppdtplgns_options['track_usage'][ $bws_license_plugin ] = $bstwbsftwppdtplgns_options['track_usage'][ $this-&gt;plugin_basename ];&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( $this-&gt;is_multisite )&nbsp;</div></li><li><div>                        update_site_option( 'bstwbsftwppdtplgns_options', $bstwbsftwppdtplgns_options );&nbsp;</div></li><li><div>                    else&nbsp;</div></li><li><div>                        update_option( 'bstwbsftwppdtplgns_options', $bstwbsftwppdtplgns_options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    if ( $this-&gt;pro_plugin_is_activated )&nbsp;</div></li><li><div>                        delete_transient( 'bws_plugins_update' );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $error = __( &quot;Please, enter Your license key&quot;, 'bestwebsoft' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return compact( 'error', 'message' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display help phrase&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @param  void&nbsp;</div></li><li><div>     * @return array    The action results&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function help_phrase() {&nbsp;</div></li><li><div>        echo '&lt;div class=&quot;bws_tab_description&quot;&gt;' . __( 'Need Help?', 'bestwebsoft' ) . ' ';&nbsp;</div></li><li><div>        if ( '' != $this-&gt;doc_link )&nbsp;</div></li><li><div>            echo '&lt;a href=&quot;' . $this-&gt;doc_link . '&quot; target=&quot;_blank&quot;&gt;' . __( 'Read the Instruction', 'bestwebsoft' );&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            echo '&lt;a href=&quot;https://support.bestwebsoft.com/hc/en-us/&quot; target=&quot;_blank&quot;&gt;' . __( 'Visit Help Center', 'bestwebsoft' );&nbsp;</div></li><li><div>        if ( '' != $this-&gt;doc_video_link )&nbsp;</div></li><li><div>            echo '&lt;/a&gt;' . ' ' . __( 'or', 'bestwebsoft' ) . ' ' . '&lt;a href=&quot;' . $this-&gt;doc_video_link . '&quot; target=&quot;_blank&quot;&gt;' . __( 'Watch the Video', 'bestwebsoft' );&nbsp;</div></li><li><div>        echo '&lt;/a&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function bws_pro_block_links() { &nbsp;</div></li><li><div>        global $wp_version; ?&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;bws_pro_version_tooltip&quot;&gt;                            &nbsp;</div></li><li><div>            &lt;a class=&quot;bws_button&quot; href=&quot;&lt;?php echo $this-&gt;plugins_info['PluginURI']; ?&gt;?k=&lt;?php echo $this-&gt;link_key; ?&gt;&amp;pn=&lt;?php echo $this-&gt;link_pn; ?&gt;&amp;v=&lt;?php echo $this-&gt;plugins_info[&quot;Version&quot;]; ?&gt;&amp;wp_v=&lt;?php echo $wp_version; ?&gt;&quot; target=&quot;_blank&quot; title=&quot;&lt;?php echo $this-&gt;plugins_info[&quot;Name&quot;]; ?&gt;&quot;&gt;&lt;?php _e( 'Upgrade to Pro', 'bestwebsoft' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>            &lt;?php if ( $this-&gt;trial_days !== false ) { ?&gt;&nbsp;</div></li><li><div>                &lt;span class=&quot;bws_trial_info&quot;&gt;&nbsp;</div></li><li><div>                    &lt;?php _e( 'or', 'bestwebsoft' ); ?&gt; &nbsp;</div></li><li><div>                    &lt;a href=&quot;&lt;?php echo $this-&gt;plugins_info['PluginURI']; ?&gt;?k=&lt;?php echo $this-&gt;link_key; ?&gt;&amp;pn=&lt;?php echo $this-&gt;link_pn; ?&gt;&amp;v=&lt;?php echo $this-&gt;plugins_info[&quot;Version&quot;]; ?&gt;&amp;wp_v=&lt;?php echo $wp_version; ?&gt;&quot; target=&quot;_blank&quot; title=&quot;&lt;?php echo $this-&gt;plugins_info[&quot;Name&quot;]; ?&gt;&quot;&gt;&lt;?php _e( 'Start Your Free Trial', 'bestwebsoft' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                &lt;/span&gt;&nbsp;</div></li><li><div>            &lt;?php } ?&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>    &lt;?php }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Restore plugin options to defaults&nbsp;</div></li><li><div>     * @access public&nbsp;</div></li><li><div>     * @param  void&nbsp;</div></li><li><div>     * @return void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function restore_options() {&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * filter - Change default_options array OR process custom functions&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        $this-&gt;options = apply_filters( __CLASS__ . '_additional_restore_options', $this-&gt;default_options );&nbsp;</div></li><li><div>        if ( $this-&gt;is_network_options ) {&nbsp;</div></li><li><div>            $this-&gt;options['network_apply'] = 'default';&nbsp;</div></li><li><div>            $this-&gt;options['network_view'] = '1';&nbsp;</div></li><li><div>            $this-&gt;options['network_change'] = '1';&nbsp;</div></li><li><div>            update_site_option( $this-&gt;prefix . '_options', $this-&gt;options );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            update_option( $this-&gt;prefix . '_options', $this-&gt;options );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 1.28</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/1.29/classes/bws_settings_tabs/" class="active">1.29</a></li><li><a href="http://hookr.io/plugins/google-captcha-recaptcha-by-bestwebsoft/1.28/classes/bws_settings_tabs/" class="">1.28</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>Bws_Settings_Tabs</li><li><span></span>Google Captcha (reCAPTCHA) by BestWebSoft</li><li><span></span>1.29</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>