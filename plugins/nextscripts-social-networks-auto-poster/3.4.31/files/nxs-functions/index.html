<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="3.4.31" data-slug="nextscripts-social-networks-auto-poster" data-type="file" data-id="31435"><head xmlns="http://www.w3.org/1999/xhtml"><title> nxs-functions | file | Nextscripts Social Networks Auto Poster | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, nextscripts-social-networks-auto-poster, 3.4.31" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=3094d0bef33ef0fc7105087016d59440' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/nxs-functions/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fnxs-functions%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fnxs-functions%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-nextscripts-social-networks-auto-poster-3.4.31-file-nxs-functions","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="nxs-functions" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to nextscripts-social-networks-a&hellip;." href="http://hookr.io/plugins/nextscripts-social-networks-auto-poster/" class="plugin"><span property="name">nextscripts-social-networks-a&hellip;</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 3.4.31." href="http://hookr.io/plugins/nextscripts-social-networks-auto-poster/3.4.31/" class="H_VERSION"><span property="name">3.4.31</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/nextscripts-social-networks-auto-poster/3.4.31/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">nxs-functions</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="515"><a href="http://hookr.io/plugins/nextscripts-social-networks-auto-poster/3.4.31/all/" title="All">All <span class="count badge">515</span></a></li><li class="" data-id="new" data-count="44"><a href="http://hookr.io/plugins/nextscripts-social-networks-auto-poster/3.4.31/new/" title="New">New <span class="count badge">44</span></a></li><li class="" data-id="hooks" data-count="224"><a href="http://hookr.io/plugins/nextscripts-social-networks-auto-poster/3.4.31/hooks/" title="Hooks">Hooks <span class="count badge">224</span></a></li><li class="" data-id="action" data-count="6"><a href="http://hookr.io/plugins/nextscripts-social-networks-auto-poster/3.4.31/actions/" title="Actions">Actions <span class="count badge">6</span></a></li><li class="" data-id="filter" data-count="218"><a href="http://hookr.io/plugins/nextscripts-social-networks-auto-poster/3.4.31/filters/" title="Filters">Filters <span class="count badge">218</span></a></li><li class="" data-id="class" data-count="91"><a href="http://hookr.io/plugins/nextscripts-social-networks-auto-poster/3.4.31/classes/" title="Classes">Classes <span class="count badge">91</span></a></li><li class="" data-id="constant" data-count="4"><a href="http://hookr.io/plugins/nextscripts-social-networks-auto-poster/3.4.31/constants/" title="Constants">Constants <span class="count badge">4</span></a></li><li class="" data-id="function" data-count="195"><a href="http://hookr.io/plugins/nextscripts-social-networks-auto-poster/3.4.31/functions/" title="Functions">Functions <span class="count badge">195</span></a></li><li class="" data-id="shortcode" data-count="1"><a href="http://hookr.io/plugins/nextscripts-social-networks-auto-poster/3.4.31/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">1</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/nxs_functions.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div>if (!function_exists('prr')) { function prr($str) { echo &quot;&lt;pre&gt;&quot;; print_r($str); echo &quot;&lt;/pre&gt;\r\n&quot;; }}        &nbsp;</div></li><li><div>if (!function_exists('nsx_stripSlashes')) { function nsx_stripSlashes(&$value) {$value = stripslashes($value);}}&nbsp;</div></li><li><div>if (!function_exists('nsx_fixSlashes')) { function nsx_fixSlashes(&$value) { while (strpos($value, '\\\\')!==false) $value = str_replace('\\\\', '\\', $value);&nbsp;</div></li><li><div> if (strpos($value, &quot;\\'&quot;)!==false) $value = str_replace(&quot;\\'&quot;, &quot;'&quot;, $value); if (strpos($value, '\\&quot;')!==false) $value = str_replace('\\&quot;', '&quot;', $value);&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists('CutFromTo')) { function CutFromTo($string, $from, $to) {$fstart = stripos($string, $from); $tmp = substr($string, $fstart+strlen($from)); $flen = stripos($tmp, $to);  return substr($tmp, 0, $flen);}}&nbsp;</div></li><li><div>if (!function_exists('nsx_doEncode')) { function nsx_doEncode($string, $key='NSX') { $key = sha1($key); $strLen = strlen($string);$keyLen = strlen($key); $j = 0; $hash = '';&nbsp;</div></li><li><div>for ($i = 0; $i &lt; $strLen; $i++) { $ordStr = ord(substr($string, $i, 1)); if ($j == $keyLen) $j = 0; $ordKey = ord(substr($key, $j, 1)); $j++; $hash .= strrev(base_convert(dechex($ordStr + $ordKey), 16, 36));} return $hash;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists('nsx_doDecode')) { function nsx_doDecode($string, $key='NSX') { $key = sha1($key); $keyLen = strlen($key); $hash = ''; $sX = str_split($string, 2560);&nbsp;</div></li><li><div>foreach($sX as $ss) {$j=0; $sA=str_split($ss, 2); foreach($sA as $oS) {$oS=hexdec(base_convert(strrev($oS), 36, 16)); if ($j==$keyLen) $j=0; $oK=ord(substr($key, $j, 1)); $j++; $hash.=chr($oS-$oK);}} return $hash;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists('nxs_decodeEntitiesFull')) { function nxs_decodeEntitiesFull($string, $quotes = ENT_COMPAT, $charset = 'utf-8') {&nbsp;</div></li><li><div>return html_entity_decode(preg_replace_callback('/&([a-zA-Z][a-zA-Z0-9]+);/', 'nxs_convertEntity', $string), $quotes, $charset); &nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists('nxs_substr')) { function nxs_substr($str, $start) { preg_match_all(&quot;/./su&quot;, $str, $ar);&nbsp;</div></li><li><div> if(func_num_args() &gt;= 3) { $end = func_get_arg(2); return join(&quot;&quot;, array_slice($ar[0], $start, $end)); } else return join(&quot;&quot;, array_slice($ar[0], $start));&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists('nxs_strLen')) { function nxs_strLen($str) { return count(str_split(utf8_decode($str))); }}&nbsp;</div></li><li><div>if (!function_exists('nxs_convertEntity')) { function nxs_convertEntity($matches, $destroy = true) {&nbsp;</div></li><li><div>static $table = array('quot' =&gt; '&#34;', 'amp' =&gt; '&#38;', 'lt' =&gt; '&#60;', 'gt' =&gt; '&#62;', 'apos' =&gt; '&#39;', 'OElig' =&gt; '&#338;', 'oelig' =&gt; '&#339;', 'Scaron' =&gt; '&#352;', 'scaron' =&gt; '&#353;', 'Yuml' =&gt; '&#376;', 'circ' =&gt; '&#710;', 'tilde' =&gt; '&#732;', 'ensp' =&gt; '&#8194;', 'emsp' =&gt; '&#8195;', 'thinsp' =&gt; '&#8201;', 'zwnj' =&gt; '&#8204;', 'zwj' =&gt; '&#8205;', 'lrm' =&gt; '&#8206;', 'rlm' =&gt; '&#8207;', 'ndash' =&gt; '&#8211;', 'mdash' =&gt; '&#8212;', 'lsquo' =&gt; '&#8216;', 'rsquo' =&gt; '&#8217;', 'sbquo' =&gt; '&#8218;', 'ldquo' =&gt; '&#8220;', 'rdquo' =&gt; '&#8221;', 'bdquo' =&gt; '&#8222;', 'dagger' =&gt; '&#8224;', 'Dagger' =&gt; '&#8225;', 'permil' =&gt; '&#8240;', 'lsaquo' =&gt; '&#8249;', 'rsaquo' =&gt; '&#8250;', 'euro' =&gt; '&#8364;', 'fnof' =&gt; '&#402;', 'Alpha' =&gt; '&#913;', 'Beta' =&gt; '&#914;', 'Gamma' =&gt; '&#915;', 'Delta' =&gt; '&#916;', 'Epsilon' =&gt; '&#917;', 'Zeta' =&gt; '&#918;', 'Eta' =&gt; '&#919;', 'Theta' =&gt; '&#920;', 'Iota' =&gt; '&#921;', 'Kappa' =&gt; '&#922;', 'Lambda' =&gt; '&#923;', 'Mu' =&gt; '&#924;', 'Nu' =&gt; '&#925;', 'Xi' =&gt; '&#926;', 'Omicron' =&gt; '&#927;', 'Pi' =&gt; '&#928;', 'Rho' =&gt; '&#929;', 'Sigma' =&gt; '&#931;', 'Tau' =&gt; '&#932;', 'Upsilon' =&gt; '&#933;', 'Phi' =&gt; '&#934;', 'Chi' =&gt; '&#935;', 'Psi' =&gt; '&#936;', 'Omega' =&gt; '&#937;', 'alpha' =&gt; '&#945;', 'beta' =&gt; '&#946;', 'gamma' =&gt; '&#947;', 'delta' =&gt; '&#948;', 'epsilon' =&gt; '&#949;', 'zeta' =&gt; '&#950;', 'eta' =&gt; '&#951;', 'theta' =&gt; '&#952;', 'iota' =&gt; '&#953;', 'kappa' =&gt; '&#954;', 'lambda' =&gt; '&#955;', 'mu' =&gt; '&#956;', 'nu' =&gt; '&#957;', 'xi' =&gt; '&#958;', 'omicron' =&gt; '&#959;', 'pi' =&gt; '&#960;', 'rho' =&gt; '&#961;', 'sigmaf' =&gt; '&#962;', 'sigma' =&gt; '&#963;', 'tau' =&gt; '&#964;', 'upsilon' =&gt; '&#965;', 'phi' =&gt; '&#966;', 'chi' =&gt; '&#967;', 'psi' =&gt; '&#968;', 'omega' =&gt; '&#969;', 'thetasym' =&gt; '&#977;', 'upsih' =&gt; '&#978;', 'piv' =&gt; '&#982;', 'bull' =&gt; '&#8226;', 'hellip' =&gt; '&#8230;', 'prime' =&gt; '&#8242;', 'Prime' =&gt; '&#8243;', 'oline' =&gt; '&#8254;', 'frasl' =&gt; '&#8260;', 'weierp' =&gt; '&#8472;', 'image' =&gt; '&#8465;', 'real' =&gt; '&#8476;', 'trade' =&gt; '&#8482;', 'alefsym' =&gt; '&#8501;', 'larr' =&gt; '&#8592;', 'uarr' =&gt; '&#8593;', 'rarr' =&gt; '&#8594;', 'darr' =&gt; '&#8595;', 'harr' =&gt; '&#8596;', 'crarr' =&gt; '&#8629;', 'lArr' =&gt; '&#8656;', 'uArr' =&gt; '&#8657;', 'rArr' =&gt; '&#8658;', 'dArr' =&gt; '&#8659;', 'hArr' =&gt; '&#8660;', 'forall' =&gt; '&#8704;', 'part' =&gt; '&#8706;', 'exist' =&gt; '&#8707;', 'empty' =&gt; '&#8709;', 'nabla' =&gt; '&#8711;', 'isin' =&gt; '&#8712;', 'notin' =&gt; '&#8713;', 'ni' =&gt; '&#8715;', 'prod' =&gt; '&#8719;', 'sum' =&gt; '&#8721;', 'minus' =&gt; '&#8722;', 'lowast' =&gt; '&#8727;', 'radic' =&gt; '&#8730;', 'prop' =&gt; '&#8733;', 'infin' =&gt; '&#8734;', 'ang' =&gt; '&#8736;', 'and' =&gt; '&#8743;', 'or' =&gt; '&#8744;', 'cap' =&gt; '&#8745;', 'cup' =&gt; '&#8746;', 'int' =&gt; '&#8747;', 'there4' =&gt; '&#8756;', 'sim' =&gt; '&#8764;', 'cong' =&gt; '&#8773;', 'asymp' =&gt; '&#8776;', 'ne' =&gt; '&#8800;', 'equiv' =&gt; '&#8801;', 'le' =&gt; '&#8804;', 'ge' =&gt; '&#8805;', 'sub' =&gt; '&#8834;', 'sup' =&gt; '&#8835;', 'nsub' =&gt; '&#8836;', 'sube' =&gt; '&#8838;', 'supe' =&gt; '&#8839;', 'oplus' =&gt; '&#8853;', 'otimes' =&gt; '&#8855;', 'perp' =&gt; '&#8869;', 'sdot' =&gt; '&#8901;', 'lceil' =&gt; '&#8968;', 'rceil' =&gt; '&#8969;', 'lfloor' =&gt; '&#8970;', 'rfloor' =&gt; '&#8971;', 'lang' =&gt; '&#9001;', 'rang' =&gt; '&#9002;', 'loz' =&gt; '&#9674;', 'spades' =&gt; '&#9824;', 'clubs' =&gt; '&#9827;', 'hearts' =&gt; '&#9829;', 'diams' =&gt; '&#9830;', 'nbsp' =&gt; '&#160;', 'iexcl' =&gt; '&#161;', 'cent' =&gt; '&#162;', 'pound' =&gt; '&#163;', 'curren' =&gt; '&#164;', 'yen' =&gt; '&#165;', 'brvbar' =&gt; '&#166;', 'sect' =&gt; '&#167;', 'uml' =&gt; '&#168;', 'copy' =&gt; '&#169;', 'ordf' =&gt; '&#170;', 'laquo' =&gt; '&#171;', 'not' =&gt; '&#172;', 'shy' =&gt; '&#173;', 'reg' =&gt; '&#174;', 'macr' =&gt; '&#175;', 'deg' =&gt; '&#176;', 'plusmn' =&gt; '&#177;', 'sup2' =&gt; '&#178;', 'sup3' =&gt; '&#179;', 'acute' =&gt; '&#180;', 'micro' =&gt; '&#181;', 'para' =&gt; '&#182;', 'middot' =&gt; '&#183;', 'cedil' =&gt; '&#184;', 'sup1' =&gt; '&#185;', 'ordm' =&gt; '&#186;', 'raquo' =&gt; '&#187;', 'frac14' =&gt; '&#188;', 'frac12' =&gt; '&#189;', 'frac34' =&gt; '&#190;', 'iquest' =&gt; '&#191;', 'Agrave' =&gt; '&#192;', 'Aacute' =&gt; '&#193;', 'Acirc' =&gt; '&#194;', 'Atilde' =&gt; '&#195;', 'Auml' =&gt; '&#196;', 'Aring' =&gt; '&#197;', 'AElig' =&gt; '&#198;', 'Ccedil' =&gt; '&#199;', 'Egrave' =&gt; '&#200;', 'Eacute' =&gt; '&#201;', 'Ecirc' =&gt; '&#202;', 'Euml' =&gt; '&#203;', 'Igrave' =&gt; '&#204;', 'Iacute' =&gt; '&#205;', 'Icirc' =&gt; '&#206;', 'Iuml' =&gt; '&#207;', 'ETH' =&gt; '&#208;', 'Ntilde' =&gt; '&#209;', 'Ograve' =&gt; '&#210;', 'Oacute' =&gt; '&#211;', 'Ocirc' =&gt; '&#212;', 'Otilde' =&gt; '&#213;', 'Ouml' =&gt; '&#214;', 'times' =&gt; '&#215;', 'Oslash' =&gt; '&#216;', 'Ugrave' =&gt; '&#217;', 'Uacute' =&gt; '&#218;', 'Ucirc' =&gt; '&#219;', 'Uuml' =&gt; '&#220;', 'Yacute' =&gt; '&#221;', 'THORN' =&gt; '&#222;', 'szlig' =&gt; '&#223;', 'agrave' =&gt; '&#224;', 'aacute' =&gt; '&#225;', 'acirc' =&gt; '&#226;', 'atilde' =&gt; '&#227;', 'auml' =&gt; '&#228;', 'aring' =&gt; '&#229;', 'aelig' =&gt; '&#230;', 'ccedil' =&gt; '&#231;', 'egrave' =&gt; '&#232;', 'eacute' =&gt; '&#233;', 'ecirc' =&gt; '&#234;', 'euml' =&gt; '&#235;', 'igrave' =&gt; '&#236;', 'iacute' =&gt; '&#237;', 'icirc' =&gt; '&#238;', 'iuml' =&gt; '&#239;', 'eth' =&gt; '&#240;', 'ntilde' =&gt; '&#241;', 'ograve' =&gt; '&#242;', 'oacute' =&gt; '&#243;', 'ocirc' =&gt; '&#244;', 'otilde' =&gt; '&#245;', 'ouml' =&gt; '&#246;', 'divide' =&gt; '&#247;', 'oslash' =&gt; '&#248;', 'ugrave' =&gt; '&#249;', 'uacute' =&gt; '&#250;', 'ucirc' =&gt; '&#251;', 'uuml' =&gt; '&#252;', 'yacute' =&gt; '&#253;', 'thorn' =&gt; '&#254;', 'yuml' =&gt; '&#255;');&nbsp;</div></li><li><div>if (isset($table[$matches[1]])) return $table[$matches[1]];&nbsp;</div></li><li><div><span class="comment">// else </span>&nbsp;</div></li><li><div>return $destroy ? '' : $matches[0];&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists('nxs_decodeEntities')) {function nxs_decodeEntities($text) {&nbsp;</div></li><li><div>  $text= html_entity_decode($text, ENT_QUOTES, &quot;ISO-8859-1&quot;); #NOTE: UTF-8 does not work!&nbsp;</div></li><li><div>  $text= preg_replace('/&#(\d+);/me', &quot;chr(\\1)&quot;, $text); #decimal notation&nbsp;</div></li><li><div>  $text= preg_replace('/&#x([a-f0-9]+);/mei', &quot;chr(0x\\1)&quot;, $text);  #hex notation&nbsp;</div></li><li><div>  return $text;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists('nsFindImgsInPost')) {function nsFindImgsInPost($post, $advImgFnd=false) { global $ShownAds; if (isset($ShownAds)) $ShownAdsL = $ShownAds;  $postImgs = array(); if (!is_object($post)) return;&nbsp;</div></li><li><div>if ($advImgFnd) $postCntEx = apply_filters('the_content', $post-&gt;post_excerpt); else $postCntEx = $post-&gt;post_excerpt;   &nbsp;</div></li><li><div>if ($advImgFnd) $postCnt = apply_filters('the_content', $post-&gt;post_content); else $postCnt = $post-&gt;post_content; &nbsp;</div></li><li><div>$postCnt = $postCntEx.$postCnt;&nbsp;</div></li><li><div><span class="comment">//$output = preg_match_all( '/&lt;img.+src=[\'&quot;]([^\'&quot;]+)[\'&quot;].*&gt;/i', $postCnt, $matches ); if ($output === false) {return false;} </span>&nbsp;</div></li><li><div><span class="comment">//$postCnt = str_replace(&quot;'&quot;, '&quot;', $postCnt); $output = preg_match_all( '/src=&quot;([^&quot;]*)&quot;/', $postCnt, $matches ); if ($output === false) {return false;}</span>&nbsp;</div></li><li><div>$postCnt = str_replace(&quot;'&quot;, '&quot;', $postCnt); $output = preg_match_all( '/&lt; *img[^&gt;]*src *= *[&quot;\']?([^&quot;\']*)/i', $postCnt, $matches ); <span class="comment">// prr($matches);  </span>&nbsp;</div></li><li><div>if ($output === false || $output == 0) { $vids = nsFindVidsInPost($post, $advImgFnd==false); if (count($vids)&gt;0)  $postImgs[] = 'http:<span class="comment">//img.youtube.com/vi/'.$vids[0].'/0.jpg';  else return false;} </span>&nbsp;</div></li><li><div>  else { foreach ($matches[1] as $match) { if (!preg_match('/^https?:\/\<span class="comment">//', $match ) ) $match = site_url( '/' ) . ltrim( $match, '/' ); $postImgs[] = $match;} if (isset($ShownAds)) $ShownAds = $ShownAdsL; }  </span>&nbsp;</div></li><li><div>return $postImgs;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists('nsFindAudioInPost')) {function nsFindAudioInPost($post, $raw=true) {  <span class="comment">//### !!!   $raw=false Breaks ob_start() [ref.outcontrol]: Cannot use output buffering in output buffering display handlers - Investigate</span>&nbsp;</div></li><li><div>global $ShownAds; if (isset($ShownAds)) $ShownAdsL = $ShownAds; $postVids = array();&nbsp;</div></li><li><div>if (is_object($post)) { if ($raw) $postCnt = $post-&gt;post_content; else $postCnt = apply_filters('the_content', $post-&gt;post_content); } else $postCnt = $post;&nbsp;</div></li><li><div>$regex_pattern = &quot;((https?|ftp|gopher|telnet|file|notes|ms-help):((<span class="comment">//)|(\\\\))+[\w\d:#@%/;$()~_?\+-=\\\.&]*\.(mp3|aac|m4a))&quot;;</span>&nbsp;</div></li><li><div>$output = preg_match_all( $regex_pattern, $postCnt, $matches );  if ($output === false) {return false;}    &nbsp;</div></li><li><div>foreach ($matches[0] as $match) { $postAu[] = $match; } $postAu = array_unique($postAu); if (isset($ShownAds)) $ShownAds = $ShownAdsL; return $postAu;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists('nsGetYTThumb')) {function nsGetYTThumb($yt) {  &nbsp;</div></li><li><div>$out = 'http:<span class="comment">//img.youtube.com/vi/'.$yt.'/maxresdefault.jpg'; $response = wp_remote_get($out); </span>&nbsp;</div></li><li><div>if (is_wp_error($response) || $response['response']['code']!='200' ) { $out = 'http:<span class="comment">//img.youtube.com/vi/'.$yt.'/sddefault.jpg';  </span>&nbsp;</div></li><li><div>  $response = wp_remote_get($out); if (is_wp_error($response) || $response['response']['code']!='200' ) $out = 'http:<span class="comment">//img.youtube.com/vi/'.$yt.'/0.jpg';</span>&nbsp;</div></li><li><div>} return $out;  &nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists('nsFindVidsInPost')) {function nsFindVidsInPost($post, $raw=true) {  <span class="comment">//### !!!  $raw=false ## Breaks ob_start() [ref.outcontrol]: Cannot use output buffering in output buffering display handlers - Investigate</span>&nbsp;</div></li><li><div>global $ShownAds; if (isset($ShownAds)) $ShownAdsL = $ShownAds; $postVids = array();&nbsp;</div></li><li><div>if (is_object($post)) { if ($raw) $postCnt = $post-&gt;post_content; else $postCnt = apply_filters('the_content', $post-&gt;post_content); } else $postCnt = $post; <span class="comment">//prr($postCnt);</span>&nbsp;</div></li><li><div>$postCnt = preg_replace('/youtube.com\/vi\/(.*)\/(.*).jpg/isU', &quot;youtube.com/v/$1/&quot;, $postCnt);  &nbsp;</div></li><li><div>$output = preg_match_all( '@((https?:<span class="comment">//)?([-\w]+\.[-\w\.]+)+\w(:\d+)?(/([-\w/_\.]*(\?\S+)?)?(#[a-z_.-][a-z0-9+\$_.-]*)?)*)@', $postCnt, $matches ); if ($output === false) {return false;} </span>&nbsp;</div></li><li><div>foreach ($matches[0] as $match) {  &nbsp;</div></li><li><div>   $output2 = preg_match_all( '%(?:youtube(?:-nocookie)?\.com/(?:[^/]+/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu\.be/)([^&quot;&lt;&gt;&?/ ]{11})%i', $match, $matches2 ); if ($output2 === false) {return false;} &nbsp;</div></li><li><div>   foreach ($matches2[1] as $match2) {  $match2 = trim($match2); if (strlen($match2)==11) $postVids[] = $match2;} &nbsp;</div></li><li><div>   $output3 = preg_match_all( '/^https?:\/\/(www\.)?vimeo\.com\/(clip\:)?(\d+).*$/', $match, $matches3 );  if ($output3 === false) {return false;} &nbsp;</div></li><li><div>   foreach ($matches3[3] as $match3) {  $match3 = trim($match3); if (strlen($match3)==8 || strlen($match3)==9) $postVids[] = $match3;} &nbsp;</div></li><li><div>   $output3 = preg_match_all( '#https?:<span class="comment">//(player\.)?vimeo\.com(/video)?/(\d+)#i', $match, $matches3 );  if ($output3 === false) {return false;} </span>&nbsp;</div></li><li><div>   foreach ($matches3[3] as $match3) {  $match3 = trim($match3); if (strlen($match3)==8 || strlen($match3)==9) $postVids[] = $match3;}      &nbsp;</div></li><li><div>   $output3 = preg_match_all( '#https?:<span class="comment">//(www\.)?facebook\.com/video\.php\?v=(\d+)#i', $match, $matches3 ); if ($output3 === false) {return false;} </span>&nbsp;</div></li><li><div>   foreach ($matches3[2] as $match3) {  $match3 = trim($match3); if (strlen($match3)==15) $postVids[] = $match3;} &nbsp;</div></li><li><div>   $output3 = preg_match_all( '#https?:<span class="comment">//(www\.)?facebook\.com/video/embed(/)?\?video_id=(\d+)#i', $match, $matches3 ); if ($output3 === false) {return false;} </span>&nbsp;</div></li><li><div>   foreach ($matches3[3] as $match3) {  $match3 = trim($match3); if (strlen($match3)==15) $postVids[] = $match3;} &nbsp;</div></li><li><div>}   $postVids = array_unique($postVids); if (isset($ShownAds)) $ShownAds = $ShownAdsL; return $postVids;  &nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists('nsTrnc')) { function nsTrnc($string, $limit, $break=&quot; &quot;, $pad=&quot; ...&quot;) { if(nxs_strLen($string) &lt;= $limit) return $string; if(nxs_strLen($pad) &gt;= $limit) return ''; $string = nxs_substr($string, 0, $limit-nxs_strLen($pad)); &nbsp;</div></li><li><div>$brLoc = strripos($string, $break);  if ($brLoc===false) return $string.$pad; else return nxs_substr($string, 0, $brLoc).$pad; &nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists('nsSubStrEl')) { function nsSubStrEl($string, $length, $end='...') { if (strlen($string) &gt; $length) { $length -= strlen($end); $string = substr($string, 0, $length); $string .= $end; } return $string;}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists('nxs_snapCleanHTML')) { function nxs_snapCleanHTML($html) { &nbsp;</div></li><li><div>  $html = preg_replace('/&lt;script\b[^&gt;]*&gt;(.*?)&lt;\/script&gt;/is', &quot;&quot;, $html); $html = preg_replace('/&lt;!--(.*)--&gt;/Uis', &quot;&quot;, $html); return $html;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists(&quot;nxs_getNXSHeaders&quot;)) {  function nxs_getNXSHeaders($ref='', $post=false) { $hdrsArr = array(); &nbsp;</div></li><li><div> $hdrsArr['Connection']='keep-alive'; $hdrsArr['Referer']=$ref;&nbsp;</div></li><li><div> $hdrsArr['User-Agent']='Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.22 Safari/537.11';&nbsp;</div></li><li><div> if($post) $hdrsArr['Content-Type']='application/x-www-form-urlencoded'; &nbsp;</div></li><li><div> $hdrsArr['Accept']='application/json, text/javascript, *<span class="comment">/*; q=0.01';  </span>&nbsp;</div></li><li><div><span class="comment"> if (function_exists('gzdeflate')) $hdrsArr['Accept-Encoding']='gzip, deflate, sdch'; </span>&nbsp;</div></li><li><div><span class="comment"> $hdrsArr['Accept-Language']='en-US, en;q=0.8'; $hdrsArr['Accept-Charset']='ISO-8859-1, utf-8;q=0.7, *;q=0.3'; return $hdrsArr;</span>&nbsp;</div></li><li><div><span class="comment">}}</span>&nbsp;</div></li><li><div><span class="comment">if (!function_exists('nxs_chckRmImage')) {function nxs_chckRmImage($url, $chType='head') { if( ini_get('allow_url_fopen')=='1' && @getimagesize($url)!==false) return true;</span>&nbsp;</div></li><li><div><span class="comment">$hdrsArr = nxs_getNXSHeaders(); $nxsWPRemWhat = 'wp_remote_'.$chType; $rsp = $nxsWPRemWhat($url, array('headers' =&gt; $hdrsArr));  </span>&nbsp;</div></li><li><div><span class="comment">if(is_wp_error($rsp)) { nxs_addToLogN('E', 'Error', 'IMAGE', '-=ERROR=- Server can\'t access it\'s own images. (Image URL: '.$url.') Most probably it\'s a DNS problem. Please contact your hosting provider. '.serialize($rsp), ''); return false; }</span>&nbsp;</div></li><li><div><span class="comment">if (is_array($rsp) && ($rsp['response']['code']=='200' || ( $rsp['response']['code']=='403' &&  $rsp['headers']['server']=='cloudflare-nginx') )) return true; </span>&nbsp;</div></li><li><div><span class="comment">  else { if ($chType=='head') { return  nxs_chckRmImage($url, 'get'); } else { nxs_addToLogN('E', 'Error', 'IMAGE', '-=ERROR=- Server can\'t access it\'s own images. (Image URL: '.$url.') Most probably it\'s a DNS problem. Please contact your hosting provider. '.serialize($rsp), $url); return false; }</span>&nbsp;</div></li><li><div><span class="comment">  } </span>&nbsp;</div></li><li><div><span class="comment">}}</span>&nbsp;</div></li><li><div><span class="comment">if (!function_exists('nxs_getPostImage')) { function nxs_getPostImage($postID, $size='large', $def='') { $imgURL = '';  global $plgn_NS_SNAutoPoster;  if (!isset($plgn_NS_SNAutoPoster)) return; $options = $plgn_NS_SNAutoPoster-&gt;nxs_options; $options['sImg'] = (defined('NXSAPIVER') && NXSAPIVER == '2.15.11')?1:0; </span>&nbsp;</div></li><li><div><span class="comment">if (empty($options['imgNoCheck']) || $options['imgNoCheck'] != '1') { $indx = rand(0, 2); </span>&nbsp;</div></li><li><div><span class="comment">  $iTstArr = array('https://www.bing.com/s/a/hpc12.png', 'https://www.apple.com/global/elements/flags/16x16/usa_2x.png', 'https://s.yimg.com/rz/l/yahoo_en-US_f_p_142x37.png'); </span>&nbsp;</div></li><li><div><span class="comment">  $imgURL = $iTstArr[$indx]; $res = nxs_chckRmImage($imgURL); $imgURL = ''; if (!$res) $options['imgNoCheck'] = '1'; } if ($options['sImg']==1) return $options['useSSLCert'].'/logo2.png';</span>&nbsp;</div></li><li><div><span class="comment"><span class="comment">//## </span>Featured Image from Specified Location</span>&nbsp;</div></li><li><div><span class="comment">if ((int)$postID&gt;0 && isset($options['featImgLoc']) && $options['featImgLoc']!=='') {  $afiLoc= get_post_meta($postID, $options['featImgLoc'], true); </span>&nbsp;</div></li><li><div><span class="comment">  if (is_array($afiLoc) && $options['featImgLocArrPath']!='') { $cPath = $options['featImgLocArrPath'];</span>&nbsp;</div></li><li><div><span class="comment">    while (strpos($cPath, '[')!==false) { $arrIt = CutFromTo($cPath, '[', ']'); $arrIt = str_replace(&quot;'&quot;, &quot;&quot;, str_replace('&quot;', '', $arrIt)); $afiLoc = $afiLoc[$arrIt]; $cPath = substr($cPath, strpos($cPath, ']'));}    </span>&nbsp;</div></li><li><div><span class="comment">  } $imgURL = trim($options['featImgLocPrefix']).trim($afiLoc); if ($imgURL!='' && stripos($imgURL, 'http')===false) $imgURL =  home_url().$imgURL;</span>&nbsp;</div></li><li><div><span class="comment">}</span>&nbsp;</div></li><li><div><span class="comment">if ($imgURL!='' && $options['imgNoCheck']!='1' && nxs_chckRmImage($imgURL)==false) $imgURL = '';  if ($imgURL!='') return $imgURL;</span>&nbsp;</div></li><li><div><span class="comment"><span class="comment">//## </span>Featured Image</span>&nbsp;</div></li><li><div><span class="comment">if ($imgURL=='') { if ((int)$postID&gt;0 && function_exists(&quot;get_post_thumbnail_id&quot;) && function_exists('has_post_thumbnail') && has_post_thumbnail($postID) ) { </span>&nbsp;</div></li><li><div><span class="comment">  $imgURL = wp_get_attachment_image_src(get_post_thumbnail_id($postID), $size); $imgURL = $imgURL[0]; if ((trim($imgURL)!='')  && substr($imgURL, 0, 4)!='http') $imgURL = site_url($imgURL);</span>&nbsp;</div></li><li><div><span class="comment">}} </span>&nbsp;</div></li><li><div><span class="comment">if ($imgURL!='' && $options['imgNoCheck']!='1' && nxs_chckRmImage($imgURL)==false) $imgURL = ''; if ($imgURL!='') return $imgURL;  </span>&nbsp;</div></li><li><div><span class="comment"><span class="comment">//## </span>plugin/categories-images</span>&nbsp;</div></li><li><div><span class="comment">if ((int)$postID&gt;0 && function_exists('z_taxonomy_image_url')) {  $post_categories = wp_get_post_categories( $postID );</span>&nbsp;</div></li><li><div><span class="comment">  foreach($post_categories as $c) { $cat = get_category( $c );  $imgURL = trim(z_taxonomy_image_url($cat-&gt;term_id)); if ($imgURL!='') break; }</span>&nbsp;</div></li><li><div><span class="comment">  if ($imgURL!='' && substr($imgURL, 0, 4)!='http') {</span>&nbsp;</div></li><li><div><span class="comment">    $stURL = site_url(); if (substr($stURL, -1)=='/') $stURL = substr($stURL, 0, -1);  if ($imgURL!='') $imgURL = $stURL.$imgURL; </span>&nbsp;</div></li><li><div><span class="comment">  }</span>&nbsp;</div></li><li><div><span class="comment">}</span>&nbsp;</div></li><li><div><span class="comment">if ($imgURL!='' && $options['imgNoCheck']!='1' && nxs_chckRmImage($imgURL)==false) $imgURL = ''; if ($imgURL!='') return $imgURL;</span>&nbsp;</div></li><li><div><span class="comment"><span class="comment">//## </span>YAPB</span>&nbsp;</div></li><li><div><span class="comment">if ((int)$postID&gt;0 && class_exists(&quot;YapbImage&quot;)) { $imgURLObj = YapbImage::getInstanceFromDb($postID); if (is_object($imgURLObj)) $imgURL = $imgURLObj-&gt;uri; </span>&nbsp;</div></li><li><div><span class="comment">  $stURL = site_url(); if (substr($stURL, -1)=='/') $stURL = substr($stURL, 0, -1);  if ($imgURL!='') $imgURL = $stURL.$imgURL; </span>&nbsp;</div></li><li><div><span class="comment">}</span>&nbsp;</div></li><li><div><span class="comment">if ($imgURL!='' && $options['imgNoCheck']!='1' && nxs_chckRmImage($imgURL)==false) $imgURL = ''; if ($imgURL!='') return $imgURL;</span>&nbsp;</div></li><li><div><span class="comment"><span class="comment">//## </span>Find Images in Post</span>&nbsp;</div></li><li><div><span class="comment">if ((int)$postID&gt;0 && $imgURL=='') {$post = get_post($postID); $imgsFromPost = nsFindImgsInPost($post, $options['useUnProc'] == '1'); if (is_array($imgsFromPost) && count($imgsFromPost)&gt;0) $imgURL = $imgsFromPost[0]; } //echo &quot;##&quot;.count($imgsFromPost); prr($imgsFromPost);</span>&nbsp;</div></li><li><div><span class="comment">if ($imgURL!='' && $options['imgNoCheck']!='1' && nxs_chckRmImage($imgURL)==false) $imgURL = ''; if ($imgURL!='') return $imgURL;</span>&nbsp;</div></li><li><div><span class="comment"><span class="comment">//## </span>Attachements</span>&nbsp;</div></li><li><div><span class="comment">if ((int)$postID&gt;0 && $imgURL=='') { $attachments = get_posts(array('post_type' =&gt; 'attachment', 'posts_per_page' =&gt; -1, 'post_parent' =&gt; $postID)); </span>&nbsp;</div></li><li><div><span class="comment">    if (is_array($attachments) && count($attachments)&gt;0 && is_object($attachments[0])) { $imgURL = wp_get_attachment_image_src($attachments[0]-&gt;ID, $size); $imgURL = $imgURL[0]; }     </span>&nbsp;</div></li><li><div><span class="comment">}</span>&nbsp;</div></li><li><div><span class="comment">if ($imgURL!='' && $options['imgNoCheck']!='1' && nxs_chckRmImage($imgURL)==false) $imgURL = ''; if ($imgURL!='') return $imgURL;    </span>&nbsp;</div></li><li><div><span class="comment"><span class="comment">//## </span>Default</span>&nbsp;</div></li><li><div><span class="comment">if (trim($imgURL)=='' && trim($def)=='') $imgURL = $options['ogImgDef']; </span>&nbsp;</div></li><li><div><span class="comment">if (trim($imgURL)=='' && trim($def)!='') $imgURL = $def; </span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">return $imgURL;</span>&nbsp;</div></li><li><div><span class="comment">}}</span>&nbsp;</div></li><li><div><span class="comment">if (!function_exists('nxs_makeURLParams')) { function nxs_makeURLParams($params) {  global $plgn_NS_SNAutoPoster;  if (!isset($plgn_NS_SNAutoPoster)) return; $options = $plgn_NS_SNAutoPoster-&gt;nxs_options;</span>&nbsp;</div></li><li><div><span class="comment">  if (!isset($options['addURLParams']) || $options['addURLParams']=='') return false; else $templ = $options['addURLParams'];</span>&nbsp;</div></li><li><div><span class="comment">  if (preg_match('%NTNAME%', $templ)) $templ = str_ireplace(&quot;%NTNAME%&quot;, urlencode($params['NTNAME']), $templ);</span>&nbsp;</div></li><li><div><span class="comment">  if (preg_match('%NTCODE%', $templ)) $templ = str_ireplace(&quot;%NTCODE%&quot;, urlencode($params['NTCODE']), $templ);</span>&nbsp;</div></li><li><div><span class="comment">  if (preg_match('%ACCNAME%', $templ)) $templ = str_ireplace(&quot;%ACCNAME%&quot;, urlencode($params['ACCNAME']), $templ);</span>&nbsp;</div></li><li><div><span class="comment">  if (preg_match('%POSTID%', $templ)) $templ = str_ireplace(&quot;%POSTID%&quot;, urlencode($params['POSTID']), $templ);</span>&nbsp;</div></li><li><div><span class="comment">  if (preg_match('%POSTTITLE%', $templ)) { $post = get_post($params['POSTID']); if (is_object($post)) {$postName = $post-&gt;post_title; $templ = str_ireplace(&quot;%POSTTITLE%&quot;, urlencode($postName), $templ);}}</span>&nbsp;</div></li><li><div><span class="comment">  if (preg_match('%SITENAME%', $templ)) { $siteTitle = urlencode(htmlspecialchars_decode(get_bloginfo('name'), ENT_QUOTES)); $templ = str_ireplace(&quot;%SITENAME%&quot;, $siteTitle, $templ); }</span>&nbsp;</div></li><li><div><span class="comment">  return $templ;</span>&nbsp;</div></li><li><div><span class="comment">}}</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment">function nxs_tiny_mce_before_init($init) { global $tinymce_version; </span>&nbsp;</div></li><li><div><span class="comment">if (substr($tinymce_version, 0, 1)&lt;4) $init['setup'] = &quot;function( ed ) { ed.onChange.add( function( ed, e ) {  nxs_updateGetImgsX( e );   }); }&quot;; else</span>&nbsp;</div></li><li><div><span class="comment">  $init['setup'] = &quot;function(ed) {ed.on('NodeChange', function(e) {nxs_updateGetImgsX(e);});}&quot;;     </span>&nbsp;</div></li><li><div><span class="comment">  return $init;</span>&nbsp;</div></li><li><div><span class="comment">}</span>&nbsp;</div></li><li><div><span class="comment">&nbsp;</span>&nbsp;</div></li><li><div><span class="comment"><span class="comment">//## </span>CSS && JS</span>&nbsp;</div></li><li><div><span class="comment">if (!function_exists(&quot;jsPostToSNAP&quot;)) { function jsPostToSNAP() {  global $nxs_snapAvNts, $nxs_plurl; ?&gt;</span>&nbsp;</div></li><li><div><span class="comment">  &lt;script type=&quot;text/javascript&quot; &gt;  </span>&nbsp;</div></li><li><div><span class="comment">  function nxs_updateGetImgsX(e) { }</span>&nbsp;</div></li><li><div><span class="comment">  jQuery(document).on('change', '#content', function( e ) { nxs_updateGetImgsX( e ); });</span>&nbsp;</div></li><li><div><span class="comment">  </span>&nbsp;</div></li><li><div><span class="comment">  function nxs_updateGetImgsXX(e) { </span>&nbsp;</div></li><li><div><span class="comment">    var targetId = e.target.id; </span>&nbsp;</div></li><li><div><span class="comment">    var text = 'Kortinko';</span>&nbsp;</div></li><li><div><span class="comment">    switch ( targetId ) {</span>&nbsp;</div></li><li><div><span class="comment">       case 'content':</span>&nbsp;</div></li><li><div><span class="comment">           text = jQuery('#content').val(); </span>&nbsp;</div></li><li><div><span class="comment">           break;</span>&nbsp;</div></li><li><div><span class="comment">       case 'tinymce':</span>&nbsp;</div></li><li><div><span class="comment">           if ( tinymce.activeEditor ) text = tinymce.activeEditor.getContent();</span>&nbsp;</div></li><li><div><span class="comment">           break;</span>&nbsp;</div></li><li><div><span class="comment">    }</span>&nbsp;</div></li><li><div><span class="comment">    jQuery('.nxs_imgPrevList').html( text );</span>&nbsp;</div></li><li><div><span class="comment">  }    </span>&nbsp;</div></li><li><div><span class="comment">  function nxs_clPrvImgShow(tIdN) { jQuery(&quot;#isAutoImg-&quot;+tIdN).trigger('click'); jQuery(&quot;#isAutoImg-&quot;+tIdN).trigger('click');  }    </span>&nbsp;</div></li><li><div><span class="comment">  function nxs_clPrvImg(id, ii) { jQuery(&quot;#imgToUse-&quot;+ii).val(jQuery(&quot;#&quot;+id+&quot; img&quot;).attr('src')); jQuery(&quot;.nxs_prevIDiv&quot;+ii+&quot; .nxs_checkIcon&quot;).hide();</span>&nbsp;</div></li><li><div><span class="comment">    jQuery(&quot;.nxs_prevIDiv&quot;+ii).removeClass(&quot;nxs_chImg_selDiv&quot;); jQuery(&quot;.nxs_prevIDiv&quot;+ii+&quot; img&quot;).removeClass(&quot;nxs_chImg_selImg&quot;); </span>&nbsp;</div></li><li><div><span class="comment">    jQuery(&quot;#&quot;+id+&quot; img&quot;).addClass(&quot;nxs_chImg_selImg&quot;); jQuery(&quot;#&quot;+id).addClass(&quot;nxs_chImg_selDiv&quot;); jQuery(&quot;#&quot;+id+&quot; .nxs_checkIcon&quot;).show();</span>&nbsp;</div></li><li><div><span class="comment">  }    </span>&nbsp;</div></li><li><div><span class="comment">  function nxs_getOriginalWidthOfImg(img_element) { var t = new Image();  t.src = (img_element.getAttribute ? img_element.getAttribute(&quot;src&quot;) : false) || img_element.src; /* alert(t.src+&quot; | &quot;+t.width); */</span> return t.width; }        &nbsp;</div></li><li><div>  function nxs_updateGetImgs(e) { &nbsp;</div></li><li><div>      var textOut=''; var text = '';&nbsp;</div></li><li><div>      var tId = e.target.id; &nbsp;</div></li><li><div>      var tIdN = tId.replace(&quot;isAutoImg-&quot;, &quot;&quot;);&nbsp;</div></li><li><div>      if ( tinymce.activeEditor ) text = tinymce.activeEditor.getContent();&nbsp;</div></li><li><div>      if ( text == '' ) text = jQuery('#content').val();                &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      jQuery('#NS_SNAP_AddPostMetaTags').append('&lt;div id=&quot;nxs_tempDivImgs&quot; style=&quot;display: none;&quot;&gt;&lt;/div&gt;'); jQuery('#nxs_tempDivImgs').append(text);&nbsp;</div></li><li><div>      var textOutA = new Array(); var currSelImg =  jQuery(&quot;#imgToUse-&quot;+tIdN).val();&nbsp;</div></li><li><div>              &nbsp;</div></li><li><div>      textOutA.push('http:<span class="comment">//cdn.gtln.us/img/nxs/noImgC.png');  </span>&nbsp;</div></li><li><div>      <span class="comment">//var fImg = jQuery('.attachment-post-thumbnail').attr('src'); if (fImg!='' && fImg!=undefined) { textOutA.push(fImg); if (currSelImg=='') currSelImg = fImg; }        </span>&nbsp;</div></li><li><div>      var fImg = jQuery('#set-post-thumbnail &gt; img').attr('src'); if (fImg!='' && fImg!=undefined) { textOutA.push(fImg); if (currSelImg=='') currSelImg = fImg; }        &nbsp;</div></li><li><div>      var fImg = jQuery('#yapbdiv img').attr('src'); if (fImg!='' && fImg!=undefined) { textOutA.push(fImg); if (currSelImg=='') currSelImg = fImg; }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      jQuery('#nxs_tempDivImgs img').each(function() { var prWidth; prWidth = nxs_getOriginalWidthOfImg(this); if (prWidth!=1) textOutA.push(jQuery(this).attr('src'));  });                &nbsp;</div></li><li><div>      jQuery('#nxs_tempDivImgs').remove();&nbsp;</div></li><li><div>      var index;  for (index = 0; index &lt; textOutA.length; ++index) { var isSel = currSelImg == textOutA[index] ? 'nxs_chImg_selImg' : ''; var isSelDisp = currSelImg == textOutA[index] ? 'style=&quot;display:block;&quot;' : ''; &nbsp;</div></li><li><div>        textOut = textOut + '&lt;div class=&quot;nxs_prevIDiv'+tIdN+' nxs_prevImagesDiv&quot; id=&quot;nxs_idiv'+tIdN+index+'&quot; onclick=&quot;nxs_clPrvImg(\'nxs_idiv'+tIdN+index+'\', \''+tIdN+'\');&quot;&gt;&lt;img class=&quot;nxs_prevImages '+isSel+'&quot; src=&quot;'+textOutA[index]+'&quot;&gt;&lt;div '+isSelDisp+' class=&quot;nxs_checkIcon&quot;&gt;&lt;div class=&quot;media-modal-icon&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;'; &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      jQuery('#imgPrevList-'+tIdN).html( textOut );&nbsp;</div></li><li><div>      if (jQuery('#'+tId).is(&quot;:checked&quot;)) jQuery('#imgPrevList-'+tIdN).hide(); else {  jQuery('#nxs_'+tIdN+'_idivD').hide(); jQuery('#imgPrevList-'+tIdN).show();  }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  jQuery(document).on('change', '.isAutoURL', function( e ) {    var tId = e.target.id; var tIdN = tId.replace(&quot;isAutoURL-&quot;, &quot;&quot;);&nbsp;</div></li><li><div>     if (jQuery('#'+tId).is(&quot;:checked&quot;)) { jQuery('#isAutoURLFld-'+tIdN).hide(); jQuery('#URLToUse-'+tIdN).val(''); } else { jQuery('#isAutoURLFld-'+tIdN).show(); }&nbsp;</div></li><li><div>  });    &nbsp;</div></li><li><div>  jQuery(document).on('change', '.isAutoImg', function( e ) {   &nbsp;</div></li><li><div>      nxs_updateGetImgs( e );&nbsp;</div></li><li><div>  });    &nbsp;</div></li><li><div>  jQuery(document).on('change', '#wp-content-editor-container #conXXtent', function() {&nbsp;</div></li><li><div>      nxs_updateGetImgs();&nbsp;</div></li><li><div>  });&nbsp;</div></li><li><div>  jQuery(document).on('change', '#tinXXymce', function() {&nbsp;</div></li><li><div>      nxs_updateGetImgs();&nbsp;</div></li><li><div>  });       &nbsp;</div></li><li><div>  jQuery(document).ready(function($) {          &nbsp;</div></li><li><div>  &lt;?php       &nbsp;</div></li><li><div>    foreach ($nxs_snapAvNts as $avNt) {?&gt;&nbsp;</div></li><li><div>      jQuery('input#rePostTo&lt;?php echo $avNt['code']; ?&gt;_button').click(function() { var data = { action: 'rePostTo&lt;?php echo $avNt['code']; ?&gt;', id: jQuery('input#post_ID').val(), nid:jQuery(this).attr('alt'), _wpnonce: jQuery('input#nxsSsPageWPN_wpnonce').val()}; callAjSNAP(data, '&lt;?php echo $avNt['name']; ?&gt;'); });&nbsp;</div></li><li><div>  &lt;?php } &nbsp;</div></li><li><div>   foreach ($nxs_snapAvNts as $avNt) {?&gt;&nbsp;</div></li><li><div>      jQuery('input#riTo&lt;?php echo $avNt['code']; ?&gt;_button').click(function() { var data = { action: 'rePostTo&lt;?php echo $avNt['code']; ?&gt;', id: jQuery('input#post_ID').val(), ri:1, nid:jQuery(this).attr('alt'), _wpnonce: jQuery('input#nxsSsPageWPN_wpnonce').val()}; callAjSNAP(data, '&lt;?php echo $avNt['name']; ?&gt;'); });&nbsp;</div></li><li><div>  &lt;?php } ?&gt;&nbsp;</div></li><li><div>     function callAjSNAP(data, label) { &nbsp;</div></li><li><div>          var style = &quot;position: fixed; display: none; z-index: 1000; top: 50%; left: 50%; background-color: #E8E8E8; border: 1px solid #555; padding: 15px; width: 350px; min-height: 80px; margin-left: -175px; margin-top: -40px; text-align: center; vertical-align: middle;&quot;;&nbsp;</div></li><li><div>          jQuery('body').append(&quot;&lt;div id='test_results' style='&quot; + style + &quot;'&gt;&lt;/div&gt;&quot;);&nbsp;</div></li><li><div>          jQuery('#test_results').html(&quot;&lt;p&gt;Sending update to &quot;+label+&quot;&lt;/p&gt;&quot; + &quot;&lt;p&gt;&lt;img src='&lt;?php echo $nxs_plurl; ?&gt;img/ajax-loader-med.gif' /&gt;&lt;/p&gt;&quot;);&nbsp;</div></li><li><div>          jQuery('#test_results').show();            &nbsp;</div></li><li><div>          jQuery.post(ajaxurl, data, function(response) { if (response=='') response = 'Message Posted';&nbsp;</div></li><li><div>              jQuery('#test_results').html('&lt;p&gt; ' + response + '&lt;/p&gt;' +'&lt;input type=&quot;button&quot; class=&quot;button&quot; name=&quot;results_ok_button&quot; id=&quot;results_ok_button&quot; value=&quot;OK&quot; /&gt;');&nbsp;</div></li><li><div>              jQuery('#results_ok_button').click(remove_results);&nbsp;</div></li><li><div>          });            &nbsp;</div></li><li><div>      }        &nbsp;</div></li><li><div>      function remove_results() { jQuery(&quot;#results_ok_button&quot;).unbind(&quot;click&quot;);jQuery(&quot;#test_results&quot;).remove();&nbsp;</div></li><li><div>          if (typeof document.body.style.maxHeight == &quot;undefined&quot;) { jQuery(&quot;body&quot;, &quot;html&quot;).css({height: &quot;auto&quot;, width: &quot;auto&quot;}); jQuery(&quot;html&quot;).css(&quot;overflow&quot;, &quot;&quot;);}&nbsp;</div></li><li><div>          document.onkeydown = &quot;&quot;;document.onkeyup = &quot;&quot;;  return false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  });&nbsp;</div></li><li><div>  &lt;/script&gt;    &nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>if (!function_exists(&quot;nxs_jsPostToSNAP2&quot;)) { function nxs_jsPostToSNAP2() { global $nxs_snapAvNts, $nxs_snapThisPageUrl, $plgn_NS_SNAutoPoster, $nxs_plurl; &nbsp;</div></li><li><div> if (!isset($plgn_NS_SNAutoPoster)) return; $options = $plgn_NS_SNAutoPoster-&gt;nxs_options; &nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>&lt;script type=&quot;text/javascript&quot;&gt;   &nbsp;</div></li><li><div>&nbsp;</div></li><li><div> jQuery(function() {&nbsp;</div></li><li><div>  jQuery(&quot;form .categorydiv .selectit input:checkbox&quot;).click ( function() { var nxs_isLocked = jQuery('#nxsLockIt').val(); if (nxs_isLocked=='1') return; &nbsp;</div></li><li><div>     var thVal = jQuery(this).val();  if (!jQuery(this).is(&quot;:checked&quot;)) return;        &nbsp;</div></li><li><div>     &nbsp;</div></li><li><div>     var arr = [&lt;?php if (!empty($options['exclCats'])) { $xarr = maybe_unserialize($options['exclCats']); if (is_array($xarr)) echo &quot;'&quot;.implode(&quot;', '&quot;, $xarr).&quot;'&quot;; } ?&gt;];&nbsp;</div></li><li><div>     if ( jQuery.inArray(thVal, arr)&gt;-1) jQuery('.nxsGrpDoChb').removeAttr('checked'); else jQuery(&quot;.nxsGrpDoChb[title='def']&quot;).attr('checked', 'checked');&nbsp;</div></li><li><div>     &nbsp;</div></li><li><div>     jQuery(&quot;.nxs_SC&quot;).each(function(index) { var cats = jQuery(this).val();  var catsA = cats.split(', '); uqID = jQuery(this).attr('id'); uqID = uqID.replace(&quot;nxs_SC_&quot;, &quot;do&quot;, &quot;gi&quot;);&nbsp;</div></li><li><div>       if (jQuery.inArray(thVal, catsA)&gt;-1)  jQuery('#'+uqID).attr('checked', 'checked')&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// alert( uqID + &quot;|&quot; + catsA +  &quot;|&quot; + thVal);  </span></span>&nbsp;</div></li><li><div>     }); &nbsp;</div></li><li><div>     &nbsp;</div></li><li><div>     jQuery(&quot;.nxs_TG&quot;).each(function(index) { var cats = jQuery(this).val();  var catsA = cats.split(', '); uqID = jQuery(this).attr('id'); uqID = uqID.replace(&quot;nxs_TG_&quot;, &quot;do&quot;, &quot;gi&quot;);&nbsp;</div></li><li><div>       if (jQuery.inArray(thVal, catsA)&gt;-1)  jQuery('#'+uqID).attr('checked', 'checked')&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// alert( uqID + &quot;|&quot; + catsA +  &quot;|&quot; + thVal);  </span></span>&nbsp;</div></li><li><div>     });        &nbsp;</div></li><li><div>     &nbsp;</div></li><li><div>  });&nbsp;</div></li><li><div>});&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>function seFBA(pgID, fbAppID, fbAppSec) { var data = { pgID: pgID, action: 'nsAuthFBSv', _wpnonce: jQuery('input#nxsSsPageWPN_wpnonce').val()}; &nbsp;</div></li><li><div>  jQuery.post(ajaxurl, data, function(response) {  &nbsp;</div></li><li><div>    window.location = &quot;https:<span class="comment">//www.facebook.com/dialog/oauth?client_id=&quot;+fbAppID+&quot;&client_secret=&quot;+fbAppSec+&quot;&scope=publish_stream, offline_access, read_stream, manage_pages&redirect_uri=&lt;?php echo $nxs_snapThisPageUrl;?&gt;&quot;;</span>&nbsp;</div></li><li><div>  });                       &nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>function doLic() { var lk = jQuery('#eLic').val();  jQuery.post(ajaxurl, {lk:lk, action: 'nxsDoLic', id: 0, _wpnonce: jQuery('input#doLic_wpnonce').val()}, function(j) { &nbsp;</div></li><li><div>    if (jQuery.trim(j)=='OK') window.location = &quot;&lt;?php echo $nxs_snapThisPageUrl; ?&gt;&quot;; else alert('&lt;?php _e('Wrong key, please contact support', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;');&nbsp;</div></li><li><div>  }, &quot;html&quot;)&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>function testPost(nt, nid) { jQuery(&quot;.blnkg&quot;).hide(); &lt;?php foreach ($nxs_snapAvNts as $avNt) {?&gt;&nbsp;</div></li><li><div>  if (nt=='&lt;?php echo $avNt['code']; ?&gt;') { &nbsp;</div></li><li><div>     var data = { action: 'rePostTo&lt;?php echo $avNt['code']; ?&gt;', id: 0, nid: nid, _wpnonce: jQuery('input#nxsSsPageWPN_wpnonce').val()}; callAjSNAP(data, '&lt;?php echo $avNt['name']; ?&gt;'); &nbsp;</div></li><li><div>  }&lt;?php } ?&gt;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nxs_doTabs() {&nbsp;</div></li><li><div>  jQuery('#nxsAPIUpd').dblclick(function() { doLic(); });&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">//When page loads...</span></span>&nbsp;</div></li><li><div>  jQuery(&quot;.nsx_tab_content&quot;).hide(); <span class="comment"><span class="comment">//Hide all content</span></span>&nbsp;</div></li><li><div>  jQuery(&quot;ul.nsx_tabs &gt; li:first-child&quot;).addClass(&quot;active&quot;).show(); <span class="comment"><span class="comment">//Activate first tab</span></span>&nbsp;</div></li><li><div>  jQuery(&quot;.nsx_tab_container &gt; .nsx_tab_content:first-child&quot;).show(); <span class="comment"><span class="comment">//Show first tab content</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">//On Click Event</span></span>&nbsp;</div></li><li><div>  jQuery(&quot;ul.nsx_tabs li&quot;).click(function() {&nbsp;</div></li><li><div>    jQuery(this).parent().children(&quot;li&quot;).removeClass(&quot;active&quot;); <span class="comment"><span class="comment">//Remove any &quot;active&quot; class</span></span>&nbsp;</div></li><li><div>    jQuery(this).addClass(&quot;active&quot;); <span class="comment"><span class="comment">//Add &quot;active&quot; class to selected tab</span></span>&nbsp;</div></li><li><div>    jQuery(this).parent().parent().children(&quot;.nsx_tab_container&quot;).children(&quot;.nsx_tab_content&quot;).hide(); <span class="comment"><span class="comment">//Hide all tab content    </span></span>&nbsp;</div></li><li><div>    var activeTab = jQuery(this).find(&quot;a&quot;).attr(&quot;href&quot;); <span class="comment"><span class="comment">//Find the href attribute value to identify the active tab + content</span></span>&nbsp;</div></li><li><div>    jQuery(activeTab).show(); <span class="comment"><span class="comment">//Fade in the active ID content</span></span>&nbsp;</div></li><li><div>    return false;&nbsp;</div></li><li><div>  });&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nxs_doTabsInd(iid) {    &nbsp;</div></li><li><div>  <span class="comment"><span class="comment">//When page loads...</span></span>&nbsp;</div></li><li><div>  jQuery(iid+&quot; .nsx_tab_content&quot;).hide(); <span class="comment"><span class="comment">//Hide all content</span></span>&nbsp;</div></li><li><div>  jQuery(iid+&quot; ul.nsx_tabs &gt; li:first-child&quot;).addClass(&quot;active&quot;).show(); <span class="comment"><span class="comment">//Activate first tab</span></span>&nbsp;</div></li><li><div>  jQuery(iid+&quot; .nsx_tab_container &gt; .nsx_tab_content:first-child&quot;).show(); <span class="comment"><span class="comment">//Show first tab content</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">//On Click Event</span></span>&nbsp;</div></li><li><div>  jQuery(iid+&quot; ul.nsx_tabs li&quot;).click(function() {&nbsp;</div></li><li><div>    jQuery(this).parent().children(&quot;li&quot;).removeClass(&quot;active&quot;); <span class="comment"><span class="comment">//Remove any &quot;active&quot; class</span></span>&nbsp;</div></li><li><div>    jQuery(this).addClass(&quot;active&quot;); <span class="comment"><span class="comment">//Add &quot;active&quot; class to selected tab</span></span>&nbsp;</div></li><li><div>    jQuery(this).parent().parent().children(&quot;.nsx_tab_container&quot;).children(&quot;.nsx_tab_content&quot;).hide(); <span class="comment"><span class="comment">//Hide all tab content    </span></span>&nbsp;</div></li><li><div>    var activeTab = jQuery(this).find(&quot;a&quot;).attr(&quot;href&quot;); <span class="comment"><span class="comment">//Find the href attribute value to identify the active tab + content</span></span>&nbsp;</div></li><li><div>    jQuery(activeTab).show(); <span class="comment"><span class="comment">//Fade in the active ID content</span></span>&nbsp;</div></li><li><div>    return false;&nbsp;</div></li><li><div>  });&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nxs_in_array(needle, haystack) { for(var i in haystack) { if(haystack[i] == needle) return true;} return false; }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>jQuery(document).ready(function() {    nxs_doTabs();&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">//## </span>Check for excluded Tags    </span>&nbsp;</div></li><li><div>  var nxs_curTagsValue = []; jQuery('.the-tags').each(function() {if (jQuery(this).val()!='') nxs_curTagsValue[jQuery(this).attr('id')] = jQuery(this).val(); });&nbsp;</div></li><li><div>  jQuery(function () { setTimeout(nxs_checkTagsChangesX, 50); });&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  function nxs_checkTagsChangesX() { var isChanged = false; var nxs_isLocked = jQuery('#nxsLockIt').val(); if (nxs_isLocked=='1') return;&nbsp;</div></li><li><div>    jQuery('.the-tags').each(function() {       &nbsp;</div></li><li><div>      currentValue = jQuery( this ).val(); currID = jQuery(this).attr('id');   <span class="comment">//   console.log( currID );   </span>&nbsp;</div></li><li><div>      if ((currentValue) && currentValue != nxs_curTagsValue[currID] && currentValue != '') isChanged = true;&nbsp;</div></li><li><div>    });          &nbsp;</div></li><li><div>    if (isChanged) { <span class="comment"><span class="comment">//## </span>Changed</span>&nbsp;</div></li><li><div>      jQuery('.the-tags').each(function() { if (jQuery(this).val()!='') nxs_curTagsValue[jQuery(this).attr('id')] = jQuery(this).val(); });&nbsp;</div></li><li><div>      var nxs_curTagsValueX = ''; var tValX = [];&nbsp;</div></li><li><div>      jQuery('.the-tags').each(function() { &nbsp;</div></li><li><div>         var tVals = jQuery( this ).val().toLowerCase().split(&quot;, &quot;); var tID = jQuery( this ).attr('id').replace(&quot;tax-input-&quot;, &quot;&quot;); &nbsp;</div></li><li><div>         for(var ii in tVals) tValX.push(tID+&quot;|&quot;+jQuery.trim(tVals[ii])); &nbsp;</div></li><li><div>      }); <span class="comment">//  console.log( tValX );</span>&nbsp;</div></li><li><div>      jQuery(&quot;.nxs_TG&quot;).each(function(index) { var cats = jQuery(this).val();  var catsA = cats.split(', '); uqID = jQuery(this).attr('id'); uqID = uqID.replace(&quot;nxs_TG_&quot;, &quot;do&quot;, &quot;gi&quot;);&nbsp;</div></li><li><div>        <span class="comment">// console.log( uqID ); console.log( JSON.stringify( catsA ) );</span>&nbsp;</div></li><li><div>      for(var ii in catsA) { var tgVal = jQuery.trim(catsA[ii]).toLowerCase();&nbsp;</div></li><li><div>        if (tgVal.indexOf(&quot;|&quot;)&lt;1 && tgVal!=&quot;&quot;) tgVal = &quot;post_tag|&quot;+tgVal;&nbsp;</div></li><li><div>        if (tgVal!=&quot;&quot; && jQuery.inArray(tgVal, tValX)&gt;-1) {  jQuery('#'+uqID).attr('checked', 'checked'); }           &nbsp;</div></li><li><div>      }        &nbsp;</div></li><li><div>      });&nbsp;</div></li><li><div>    } setTimeout(nxs_checkTagsChangesX, 50);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>});&nbsp;</div></li><li><div>&lt;/script&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;style type=&quot;text/css&quot;&gt;&nbsp;</div></li><li><div>.NXSButton { background-color:#89c403;&nbsp;</div></li><li><div>  background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #89c403), color-stop(1, #77a809) );&nbsp;</div></li><li><div>  background:-moz-linear-gradient( center top, #89c403 5%, #77a809 100% );&nbsp;</div></li><li><div>  filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#89c403', endColorstr='#77a809');    &nbsp;</div></li><li><div>  -moz-border-radius:4px; -webkit-border-radius:4px; border-radius:4px; border:1px solid #74b807; display:inline-block; color:#ffffff;&nbsp;</div></li><li><div>  font-family:Trebuchet MS; font-size:12px; font-weight:bold; padding:4px 5px;  text-decoration:none;  text-shadow:1px 1px 0px #528009;&nbsp;</div></li><li><div>}.NXSButton:hover {color:#ffffff; background-color:#77a809;&nbsp;</div></li><li><div>  background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #77a809), color-stop(1, #89c403) );&nbsp;</div></li><li><div>  background:-moz-linear-gradient( center top, #77a809 5%, #89c403 100% );&nbsp;</div></li><li><div>  filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#77a809', endColorstr='#89c403');    &nbsp;</div></li><li><div>}.NXSButton:active {color:#ffffff; position:relative; top:1px;}.NXSButton:focus {color:#ffffff; position:relative; top:1px;} .nsBigText{font-size: 14px; color: #585858; font-weight: bold; display: inline;}&nbsp;</div></li><li><div>.NXSButtonB { background-color:#038bc4;&nbsp;</div></li><li><div>  background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #038bc4), color-stop(1, #096aa8) );&nbsp;</div></li><li><div>  background:-moz-linear-gradient( center top, #038bc4 5%, #096aa8 100% );&nbsp;</div></li><li><div>  filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#038bc4', endColorstr='#096aa8');    &nbsp;</div></li><li><div>  -moz-border-radius:4px; -webkit-border-radius:4px; border-radius:4px; border:1px solid #077cb8; display:inline-block; color:#ffffff;&nbsp;</div></li><li><div>  font-family:Trebuchet MS; font-size:12px; font-weight:bold; padding:4px 5px;  text-decoration:none;  text-shadow:1px 1px 0px #095d80;&nbsp;</div></li><li><div>}.NXSButtonB:hover {color:#ffffff; background-color:#096aa8;&nbsp;</div></li><li><div>  background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #096aa8), color-stop(1, #038bc4) );&nbsp;</div></li><li><div>  background:-moz-linear-gradient( center top, #096aa8 5%, #038bc4 100% );&nbsp;</div></li><li><div>  filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#096aa8', endColorstr='#038bc4');    &nbsp;</div></li><li><div>}.NXSButtonB:active {color:#ffffff; position:relative; top:1px;}.NXSButton:focus {color:#ffffff; position:relative; top:1px;} .nsBigText{font-size: 14px; color: #585858; font-weight: bold; display: inline;}&nbsp;</div></li><li><div>#nxs_ntType {width: 150px;}&nbsp;</div></li><li><div>#nsx_addNT {width: 600px;}&nbsp;</div></li><li><div>.nxsInfoMsg{  margin: 1px auto; padding: 3px 10px 3px 5px; border: 1px solid #ffea90;  background-color: #fdfae4; display: inline; -webkit-border-radius: 5px; -moz-border-radius: 5px; border-radius: 5px; }&nbsp;</div></li><li><div>.blnkg{text-decoration:blink; font-size: 17px; color: #0CB107; font-weight: bold; display: inline;}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>div.popShAtt { display: none; position: absolute; width: 600px; padding: 10px; background: #eeeeee; color: #000000; border: 1px solid #1a1a1a; font-size: 90%; }&nbsp;</div></li><li><div>.underdash {border-bottom: 1px #21759B dashed; text-decoration:none;}&nbsp;</div></li><li><div>.underdash a:hover {border-bottom: 1px #21759B dashed}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>.nxsTHRow {vertical-align:top; padding-top:6px; text-align:right; width:80px; padding-right:10px;}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>ul.nsx_tabs {margin: 0;padding: 0; margin-top:5px;float: left;list-style: none;height: 32px;border-bottom: 1px solid #999;border-left: 1px solid #999;width: 99%;}&nbsp;</div></li><li><div>ul.nsx_tabs li {float: left;margin: 0;padding: 0;height: 31px;line-height: 31px;border: 1px solid #999;border-left: none;margin-bottom: -1px;overflow: hidden;position: relative;background: #e0e0e0;}&nbsp;</div></li><li><div>ul.nsx_tabs li a {text-decoration: none;color: #000; display: block; font-size: 1.2em; padding: 0 20px; border: 1px solid #fff; outline: none;}&nbsp;</div></li><li><div>ul.nsx_tabs li a:hover { background: #ccc;}&nbsp;</div></li><li><div>html ul.nsx_tabs li.active, html ul.nsx_tabs li.active a:hover  { background: #fff; border-bottom: 1px solid #fff; }&nbsp;</div></li><li><div>.nsx_tab_container {border: 1px solid #999; border-top: none; overflow: hidden; clear: both; float: left; width: 99%; background: #fff;}&nbsp;</div></li><li><div>.nsx_tab_content {padding: 10px;}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>.nxs_tls_cpt{width:100%; padding-bottom: 5px; padding-top: 10px;font-size: 16px; font-weight: bold;}&nbsp;</div></li><li><div>.nxs_tls_bd{width:100%; padding-left: 10px; padding-bottom: 10px;}&nbsp;</div></li><li><div>.nxs_tls_sbInfo{font-style: italic; padding-bottom: 10px; padding-top: 2px;}&nbsp;</div></li><li><div>.nxs_tls_sbInfo2{font-style: italic; padding-left: 10px; padding-bottom: 5px; line-height: 10px; font-size: 11px;}&nbsp;</div></li><li><div>.nxs_tls_lbl{width:100%;padding-top:7px;padding-bottom:1px;}&nbsp;</div></li><li><div>.nxsInstrSpan{ font-size: 11px; }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>.subDiv{margin-left: 15px;}&nbsp;</div></li><li><div>.nxs_hili {color:#008000;}&nbsp;</div></li><li><div>.clNewNTSets{width: 800px;}&nbsp;</div></li><li><div>.nxclear {clear: both;}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>.nxs_icon16 { font-size: 14px; line-height: 18px;&nbsp;</div></li><li><div>  background-position: 3px 50% !important;&nbsp;</div></li><li><div>  background-repeat: no-repeat !important;&nbsp;</div></li><li><div>  display: inline-block;&nbsp;</div></li><li><div>  padding: 1px 0 1px 23px !important;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>.nxs_box{border-color: #DFDFDF; border-radius: 3px 3px 3px 3px; box-shadow: 0 1px 0 #FFFFFF inset; border-style: solid; border-width: 1px; line-height: 1; margin-bottom: 10px; padding: 0; <span class="comment">/* max-width: 1080px; */</span>}&nbsp;</div></li><li><div>.nxs_box_header{border-bottom-color: #DFDFDF; box-shadow: 0 1px 0 #FFFFFF; text-shadow: 0 1px 0 #FFFFFF;font-size: 15px;font-weight: normal;line-height: 1;margin: 0;padding: 6px;&nbsp;</div></li><li><div>background:#f1f1f1;background-image:-webkit-gradient(linear, left bottom, left top, from(#ececec), to(#f9f9f9));background-image:-webkit-linear-gradient(bottom, #ececec, #f9f9f9);background-image:-moz-linear-gradient(bottom, #ececec, #f9f9f9);background-image:-o-linear-gradient(bottom, #ececec, #f9f9f9);background-image:linear-gradient(to top, #ececec, #f9f9f9)&nbsp;</div></li><li><div>-moz-user-select: none;border-bottom-style: solid;border-bottom-width: 1px;}&nbsp;</div></li><li><div>.nxs_box_inside{line-height: 1.4em; padding: 10px;}&nbsp;</div></li><li><div>.nxs_box_inside input[type=text]{ padding: 5px; height: 24px; border: 1px solid #ACACAC;}&nbsp;</div></li><li><div>.nxs_box_inside .insOneDiv, #nsx_addNT .insOneDiv{max-width: 1020px; background-color: #f8f9f9; background-repeat: no-repeat; margin: 10px; border: 1px solid #808080; padding: 10px; display:none; overflow: hidden;}&nbsp;</div></li><li><div>.nxs_box_inside .itemDiv {margin:5px;margin-left:10px;}&nbsp;</div></li><li><div>.nxs_box_header h3 {font-size: 14px; margin-bottom: 2px; margin-top: 2px;}&nbsp;</div></li><li><div>.nxs_newLabel {font-size: 11px; color:red; padding-left: 5px; padding-right: 5px;}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>.nxs_prevImagesDiv {border:1px solid #0f3c6d;  width:110px; height:110px; margin:3px; padding:3px; text-align:center; float:left; position: relative;}&nbsp;</div></li><li><div>.nxs_prevImages {padding:1px; max-height:100px; max-width:100px;}&nbsp;</div></li><li><div>.nxs_chImg_selDiv {border:1px solid #800000;}&nbsp;</div></li><li><div>.nxs_chImg_selImg {border:4px solid #800000;}&nbsp;</div></li><li><div>.nxs_checkIcon{position: absolute;}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>.nxs_checkIcon{display:none; height:24px;width:24px;position:absolute;top:-7px;right:-7px;outline:0;border:1px solid #fff;border-radius:3px;box-shadow:0 0 0 1px rgba(0, 0, 0, 0.4);background:#800000;background-image:-webkit-gradient(linear, left top, left bottom, from(#800000), to(#570000));background-image:-webkit-linear-gradient(top, #800000, #570000);background-image:-moz-linear-gradient(top, #800000, #570000);background-image:-o-linear-gradient(top, #800000, #570000);background-image:linear-gradient(to bottom, #800000, #570000)}&nbsp;</div></li><li><div>.nxs_checkIcon{ top:-5px; right: -3px; width: 15px; height: 15px; box-shadow:0 0 0 1px #800000;background:#800000;background-image:-webkit-gradient(linear, left top, left bottom, from(#800000), to(#570000));background-image:-webkit-linear-gradient(top, #800000, #570000);background-image:-moz-linear-gradient(top, #800000, #570000);background-image:-o-linear-gradient(top, #800000, #570000);background-image:linear-gradient(to bottom, #800000, #570000)}&nbsp;</div></li><li><div>.nxs_checkIcon div{background-position:-21px 0; width: 15px; height: 15px;}&nbsp;</div></li><li><div><span class="comment">/* #nxsDivWrap .postbox .inside {overflow: hidden;}  */</span>&nbsp;</div></li><li><div>#nxsDivWrap .postbox .description {vertical-align: middle; color: #ACACAC;}  &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>.submitX {padding-top: 7px; padding-bottom: 5px;}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>.nxs_txtIcon { margin: 0px; padding-left: 20px; background-repeat: no-repeat;} .nxs_ti_gp {background-image: url('&lt;?php echo $nxs_plurl; ?&gt;img/gp16.png');} &nbsp;</div></li><li><div>          .nxs_ti_li {background-image: url('&lt;?php echo $nxs_plurl; ?&gt;img/li16.png');}  .nxs_ti_rd {background-image: url('&lt;?php echo $nxs_plurl; ?&gt;img/rd16.png');} &nbsp;</div></li><li><div>          .nxs_ti_fp {background-image: url('&lt;?php echo $nxs_plurl; ?&gt;img/fp16.png');}  .nxs_ti_yt {background-image: url('&lt;?php echo $nxs_plurl; ?&gt;img/yt16.png');} &nbsp;</div></li><li><div>          .nxs_ti_bg {background-image: url('&lt;?php echo $nxs_plurl; ?&gt;img/bg16.png');}  .nxs_ti_pn {background-image: url('&lt;?php echo $nxs_plurl; ?&gt;img/pn16.png');} &nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>input[readonly]{ background-color:white; }         &nbsp;</div></li><li><div>.nxs-selz-dropwodn {max-width: 200px;}&nbsp;</div></li><li><div>&lt;/style&gt;&nbsp;</div></li><li><div>&lt;?php }}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists('nxs_doShowHint')) { function nxs_doShowHint($t, $ex='', $wdth='79') { ?&gt;&nbsp;</div></li><li><div>&lt;div id=&quot;&lt;?php echo $t; ?&gt;Hint&quot; class=&quot;nxs_FRMTHint&quot; style=&quot;font-size: 11px; margin: 2px; margin-top: 0px; padding:7px; border: 1px solid #C0C0C0; width: &lt;?php echo $wdth; ?&gt;%; background: #fff; display: none;&quot;&gt;&lt;span class=&quot;nxs_hili&quot;&gt;%TITLE%&lt;/span&gt; - &lt;?php _e('Inserts the Title of the post', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;, &lt;span class=&quot;nxs_hili&quot;&gt;%URL%&lt;/span&gt; - &lt;?php _e('Inserts the URL of the post', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;, &lt;span class=&quot;nxs_hili&quot;&gt;%SURL%&lt;/span&gt; - &lt;?php _e('Inserts the &lt;b&gt;shortened URL&lt;/b&gt; of your post', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;, &lt;span class=&quot;nxs_hili&quot;&gt;%IMG%&lt;/span&gt; - &lt;?php _e('Inserts the featured image URL', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;, &lt;span class=&quot;nxs_hili&quot;&gt;%EXCERPT%&lt;/span&gt; - &lt;?php _e('Inserts the excerpt of the post (processed)', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;, &lt;span class=&quot;nxs_hili&quot;&gt;%RAWEXCERPT%&lt;/span&gt; - &lt;?php _e('Inserts the excerpt of the post (as typed)', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;, &lt;span class=&quot;nxs_hili&quot;&gt;%ANNOUNCE%&lt;/span&gt; - &lt;?php _e('Inserts the text till the &lt;!--more--&gt; tag or first N words of the post', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;, &lt;span class=&quot;nxs_hili&quot;&gt;%FULLTEXT%&lt;/span&gt; - &lt;?php _e('Inserts the processed body(text) of the post', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;, &lt;span class=&quot;nxs_hili&quot;&gt;%RAWTEXT%&lt;/span&gt; - &lt;?php _e('Inserts the body(text) of the post as typed', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;, &lt;span class=&quot;nxs_hili&quot;&gt;%TAGS%&lt;/span&gt; - &lt;?php _e('Inserts post tags', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;, &lt;span class=&quot;nxs_hili&quot;&gt;%CATS%&lt;/span&gt; - &lt;?php _e('Inserts post categories', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;, &lt;span class=&quot;nxs_hili&quot;&gt;%HTAGS%&lt;/span&gt; - &lt;?php _e('Inserts post tags as hashtags', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;, &lt;span class=&quot;nxs_hili&quot;&gt;%HCATS%&lt;/span&gt; - &lt;?php _e('Inserts post categories as hashtags', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;, &lt;span class=&quot;nxs_hili&quot;&gt;%AUTHORNAME%&lt;/span&gt; - &lt;?php _e('Inserts the author\'s name', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;, &lt;span class=&quot;nxs_hili&quot;&gt;%SITENAME%&lt;/span&gt; - &lt;?php _e('Inserts the the Blog/Site name', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;. &lt;?php echo $ex; ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>&lt;?php }}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists('nxs_doSMAS')) { function nxs_doSMAS($nType, $typeii) { ?&gt;&lt;div id=&quot;do&lt;?php echo $typeii; ?&gt;Div&quot; class=&quot;clNewNTSets&quot; style=&quot;margin-left: 10px; display:none; &quot;&gt;&lt;div style=&quot;font-size: 15px; text-align: center;&quot;&gt;&lt;br/&gt;&lt;br/&gt;&nbsp;</div></li><li><div>&lt;?php printf( __( 'You already have %s configured.  This plugin supports only one %s account. &lt;br/&gt;&lt;br/&gt; Please consider getting &lt;a target=&quot;_blank&quot; href=&quot;http:<span class="comment">//www.nextscripts.com/social-networks-auto-poster-for-wp-multiple-accounts&quot;&gt;Multiple Accounts Edition&lt;/a&gt; if you would like to add another %s account for auto-posting.', 'social-networks-auto-poster-facebook-twitter-g' ), $nType, $nType, $nType );  ?&gt;</span>&nbsp;</div></li><li><div>&lt;/div&gt;&lt;/div&gt;&lt;?php &nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists('nxs_snapCleanup')) { function nxs_snapCleanup($options) {   global $nxs_snapAvNts; &nbsp;</div></li><li><div>  foreach ($nxs_snapAvNts as $avNt) { if (!isset($options[$avNt['lcode']]) || count($options[$avNt['lcode']])&gt;1) { $copt = ''; $t = '';&nbsp;</div></li><li><div>    if (isset($options[$avNt['lcode']]) && is_array($options[$avNt['lcode']])) $copt = array_values( $options[$avNt['lcode']] );  &nbsp;</div></li><li><div>    $t = (isset($copt[0]) && is_array($copt[0]) && count($copt[0]&gt;2))?$copt[0]:''; $options[$avNt['lcode']] = array(); if ($t!='') $options[$avNt['lcode']][] = $t;&nbsp;</div></li><li><div>  }}&nbsp;</div></li><li><div>  return $options;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//if (!function_exists('nxs_html_to_utf8')) { function nxs_html_to_utf8 ($data) {return preg_replace(&quot;/\\&\\#([0-9]{3, 10})\\;/e&quot;, 'nxs__html_to_utf8(&quot;\\1&quot;)', $data); }}</span>&nbsp;</div></li><li><div>if (!function_exists('nxs_html_to_utf8')) { function nxs_html_to_utf8 ($data) {return preg_replace_callback(&quot;/\\&\\#([0-9]{3, 10})\\;/&quot;, create_function ('$matches', 'return nxs__html_to_utf8($matches[2]);'), $data); }}&nbsp;</div></li><li><div>if (!function_exists('nxs__html_to_utf8')) { function nxs__html_to_utf8 ($data) { if ($data &gt; 127) { $i = 5; while (($i--) &gt; 0) {&nbsp;</div></li><li><div>if ($data != ($a = $data % ($p = pow(64, $i)))) { &nbsp;</div></li><li><div>  $ret = chr(base_convert(str_pad(str_repeat(1, $i + 1), 8, &quot;0&quot;), 2, 10) + (($data - $a) / $p)); for ($i; $i &gt; 0; $i--) $ret .= chr(128 + ((($data % pow(64, $i)) - ($data % ($p = pow(64, $i - 1)))) / $p)); break; }&nbsp;</div></li><li><div>}} else $ret = &quot;&#$data;&quot;;&nbsp;</div></li><li><div>return $ret;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists(&quot;nxs_chArrVar&quot;)) { function nxs_chArrVar($arr, $varN, $varV) { return (isset($arr) && is_array($arr) && isset($arr[$varN]) && $arr[$varN]==$varV); }}&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>if (!function_exists(&quot;nxs_metaMarkAsPosted&quot;)) { function nxs_metaMarkAsPosted($postID, $nt, $did, $args='') { $mpo =  get_post_meta($postID, 'snap'.$nt, true);  $mpo =  maybe_unserialize($mpo);&nbsp;</div></li><li><div><span class="comment">//prr($postID); prr('snap'.$nt);  prr($mpo); echo &quot;#####&quot;.$postID.&quot;|&quot;.$nt.&quot;|&quot;.$did.&quot;|&quot;.$args;</span>&nbsp;</div></li><li><div>if (!is_array($mpo)) $mpo = array(); if (!isset($mpo[$did]) || !is_array($mpo[$did])) $mpo[$did] = array();&nbsp;</div></li><li><div>if ($args=='' || ( is_array($args) && isset($args['isPosted']) && $args['isPosted']=='1')) $mpo[$did]['isPosted'] = '1';  &nbsp;</div></li><li><div>if (is_array($args) && isset($args['isPrePosted']) && $args['isPrePosted']==1) $mpo[$did]['isPrePosted'] = '1';  &nbsp;</div></li><li><div>if (is_array($args) && isset($args['pgID'])) $mpo[$did]['pgID'] = $args['pgID'];  &nbsp;</div></li><li><div>if (is_array($args) && isset($args['postURL'])) $mpo[$did]['postURL'] = $args['postURL'];  &nbsp;</div></li><li><div>if (is_array($args) && isset($args['pDate'])) $mpo[$did]['pDate'] = $args['pDate'];  &nbsp;</div></li><li><div><span class="comment">/**$mpo = mysql_real_escape_string(serialize($mpo)); */</span> delete_post_meta($postID, 'snap'.$nt); add_post_meta($postID, 'snap'.$nt, str_replace('\\', '\\\\', serialize($mpo)));&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists('nxs_checkAddLogTable')) { function nxs_checkAddLogTable() { global $nxs_tpWMPU, $wpdb; if($nxs_tpWMPU=='S') switch_to_blog(1);  &nbsp;</div></li><li><div>$installed_ver = get_option( &quot;nxs_log_db_table_version&quot; ); if ($installed_ver=='1.1') return true;&nbsp;</div></li><li><div>$table_name = $wpdb-&gt;prefix . &quot;nxs_log&quot;;&nbsp;</div></li><li><div>$sql = &quot;CREATE TABLE $table_name (&nbsp;</div></li><li><div>  id bigint(20) NOT NULL AUTO_INCREMENT, &nbsp;</div></li><li><div>  date datetime DEFAULT '0000-00-00 00:00:00' NOT NULL, &nbsp;</div></li><li><div>  act VARCHAR(255) DEFAULT '' NOT NULL, &nbsp;</div></li><li><div>  nt VARCHAR(255) DEFAULT '' NOT NULL, &nbsp;</div></li><li><div>  type VARCHAR(255) DEFAULT '' NOT NULL, &nbsp;</div></li><li><div>  msg text NOT NULL, &nbsp;</div></li><li><div>  extInfo text NOT NULL, &nbsp;</div></li><li><div>  UNIQUE KEY id (id)&nbsp;</div></li><li><div> ) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;&quot;;&nbsp;</div></li><li><div>require_once(ABSPATH . 'wp-admin/includes/upgrade.php'); dbDelta($sql);&nbsp;</div></li><li><div>delete_option(&quot;nxs_log_db_table_version&quot;); add_option(&quot;nxs_log_db_table_version&quot;, '1.1');&nbsp;</div></li><li><div>if($nxs_tpWMPU=='S' && function_exists(&quot;restore_current_blog&quot;)) restore_current_blog();&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists('nxs_getnxsLog')) { function nxs_getnxsLog() { global $nxs_tpWMPU, $wpdb; if($nxs_tpWMPU=='S') switch_to_blog(1);  &nbsp;</div></li><li><div> $log = $wpdb-&gt;get_results( &quot;SELECT * FROM &quot;. $wpdb-&gt;prefix . &quot;nxs_log ORDER BY id&quot;, ARRAY_A ); if (!is_array($log)) return array(); else return $log;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists('nxs_addToLog')) { function nxs_addToLog ($type, $action, $nt, $msg='') { nxs_addToLogN ($type, $action, $nt, $msg); }}&nbsp;</div></li><li><div>if (!function_exists('nxs_addToLogN')) { function nxs_addToLogN ($type, $action, $nt, $msg, $extInfo='') { global $nxs_tpWMPU, $wpdb; if($nxs_tpWMPU=='S') switch_to_blog(1); &nbsp;</div></li><li><div>global $plgn_NS_SNAutoPoster; if (isset($plgn_NS_SNAutoPoster)) $options = $plgn_NS_SNAutoPoster-&gt;nxs_options;  if (!empty($options) && !empty($options['numLogRows'])) $numLogRows = $options['numLogRows']; else $numLogRows = 150;&nbsp;</div></li><li><div><span class="comment"><span class="comment">//## </span>Skip if Minimal Only Setting</span>&nbsp;</div></li><li><div>if (isset($options['extDebug']) && $options['extDebug']=='2' && stripos($action, 'Skipped')!==false ) return; &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$logItem = array('date'=&gt;date_i18n('Y-m-d H:i:s'), 'act'=&gt;$action, 'msg'=&gt; strip_tags($msg), 'extInfo'=&gt;$extInfo, 'type'=&gt;$type, 'nt'=&gt;$nt); &nbsp;</div></li><li><div>$nxDB = $wpdb-&gt;insert( $wpdb-&gt;prefix . &quot;nxs_log&quot;, $logItem );  $lid = $wpdb-&gt;insert_id; $lid = $lid-$numLogRows;&nbsp;</div></li><li><div>if ($lid&gt;0) $wpdb-&gt;query( 'DELETE FROM '.$wpdb-&gt;prefix . 'nxs_log WHERE id&lt;'.$lid );    &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ($type=='E' && (isset($options['errNotifEmailCB']) && (int)$options['errNotifEmailCB'] == 1 && isset($options['errNotifEmail']) && trim($options['errNotifEmail']) != '')) { &nbsp;</div></li><li><div>  $log = maybe_unserialize(get_option('NSX_LogToEmail')); if (!is_array($log)) $log = array(); $log[] = $logItem; delete_option(&quot;NSX_LogToEmail&quot;); add_option(&quot;NSX_LogToEmail&quot;, $log, '', 'no');&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// $nxsDBLog = get_option('NS_SNAutoPosterLog'); $nxsDBLog = maybe_unserialize($nxsDBLog); if(!is_array($nxsDBLog)) $nxsDBLog = array(); $nxsDBLog[] = $logItem; $nxsDBLog = array_slice($nxsDBLog, -150);  </span>&nbsp;</div></li><li><div><span class="comment">// $res = update_option('NS_SNAutoPosterLog', ($nxsDBLog));   </span>&nbsp;</div></li><li><div><span class="comment">//delete_option('NS_SNAutoPosterLog'); add_option('NS_SNAutoPosterLog', ($nxsDBLog));   </span>&nbsp;</div></li><li><div>if($nxs_tpWMPU=='S' && function_exists(&quot;restore_current_blog&quot;)) restore_current_blog(); &nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists('nxsMergeArraysOV')) {function nxsMergeArraysOV($Arr1, $Arr2) {&nbsp;</div></li><li><div>foreach($Arr2 as $key =&gt; $value) { if(array_key_exists($key, $Arr1) && is_array($value)) $Arr1[$key] = nxsMergeArraysOV($Arr1[$key], $Arr2[$key]); else $Arr1[$key] = $value;} return $Arr1;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists('nxs_MergeCookieArr')) {function nxs_MergeCookieArr($ArrO, $ArrN) { $namesArr = array(); foreach($ArrO as $key =&gt; $value) { if (is_object($value)) $namesArr[$key] = $value-&gt;name; }             &nbsp;</div></li><li><div>foreach($ArrN as $key =&gt; $value) { if (is_object($value) && $value-&gt;value!='deleted') { $isEx = array_search($value-&gt;name, $namesArr); if ($isEx===false) $ArrO[] = $value; else $ArrO[$isEx] = $value;}} return $ArrO;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists('nxs_addPostingDelaySel')) {function nxs_addPostingDelaySel($nt, $ii, $hrs=0, $min=0, $days=0) { &nbsp;</div></li><li><div>global $plgn_NS_SNAutoPoster, $nxs_plurl;  if (!isset($plgn_NS_SNAutoPoster)) return; $options = $plgn_NS_SNAutoPoster-&gt;nxs_options; if ($options['nxsHTDP']=='I') return 'Not Compatible with &quot;Publish Immediately&quot;';&nbsp;</div></li><li><div>if (function_exists('nxs_doSMAS4')) return nxs_doSMAS4($nt, $ii, $hrs, $min, $days); else return '&lt;br/&gt;';&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists('nxs_addPostingDelaySelV3')) {function nxs_addPostingDelaySelV3($nt, $ii, $hrs=0, $min=0, $days=0) { &nbsp;</div></li><li><div>if (function_exists('nxs_doSMAS4')) { ?&gt; &lt;div class=&quot;nxs_tls_cpt&quot;&gt;&lt;?php _e('Posting Delay', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/div&gt;  &nbsp;</div></li><li><div>  &lt;div class=&quot;nxs_tls_bd&quot;&gt;&lt;?php  global $plgn_NS_SNAutoPoster, $nxs_plurl;  if (!isset($plgn_NS_SNAutoPoster)) return; $options = $plgn_NS_SNAutoPoster-&gt;nxs_options; &nbsp;</div></li><li><div>    if ($options['nxsHTDP']=='I') _e('Not Compatible with &quot;Publish Immediately&quot;'); else  echo nxs_doSMAS4($nt, $ii, $hrs, $min, $days); ?&gt;&lt;/div&gt;      &nbsp;</div></li><li><div>&lt;?php } else echo '&lt;br/&gt;';&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div> &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists(&quot;nxs_doQTrans&quot;)) { function nxs_doQTrans($txt, $lng='') { if (!function_exists(&quot;qtrans_split&quot;) && !function_exists(&quot;qtranxf_split&quot;)) return $txt; &nbsp;</div></li><li><div>$txt = str_ireplace('&lt;3', '&lt;3', $txt); $txt = str_ireplace('&lt;(', '&lt;(', $txt); <span class="comment">//$txt = preg_replace('/\]*\]/', '', $txt);</span>&nbsp;</div></li><li><div>$txt = preg_replace('/\{0, }(.*?)\][\s]{0, }(&lt;a[\s]{0, }.*?&lt;\/a&gt;)[\s]{0, }(.*?)\[\/caption\]/ims', '&lt;p $1&gt; $2 &lt;snap class=&quot;wpimgcaption&quot;&gt;$3&lt;/snap&gt; &lt;/p&gt;', $txt); <span class="comment">// WP Image with Caption fix</span>&nbsp;</div></li><li><div>if (function_exists(&quot;qtrans_split&quot;) && strpos($txt, '&lt;!--:')!==false ) { $tta = qtrans_split($txt); if ($lng!='') return $tta[$lng]; else return reset($tta); }&nbsp;</div></li><li><div>if (function_exists(&quot;qtranxf_split&quot;) && (strpos($txt, '&lt;!--:')!==false || strpos($txt, '[:')!==false) ) { $tta = qtranxf_split($txt); if ($lng!='') return $tta[$lng]; else return reset($tta); }    &nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists('nxs_addQTranslSel')) {function nxs_addQTranslSel($nt, $ii, $selLng) {  &nbsp;</div></li><li><div>if (function_exists('nxs_doSMAS6')) return nxs_doSMAS6($nt, $ii, $selLng); else return '';  &nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists(&quot;nxs_hideTip_ajax&quot;)) { function nxs_hideTip_ajax() {  check_ajax_referer('nxsSsPageWPN');   &nbsp;</div></li><li><div> global $plgn_NS_SNAutoPoster, $nxs_plurl;  if (!isset($plgn_NS_SNAutoPoster)) return; $options = $plgn_NS_SNAutoPoster-&gt;nxs_options; &nbsp;</div></li><li><div> $options['hideTopTip'] = '1';    update_option($plgn_NS_SNAutoPoster-&gt;dbOptionsName, $options); $plgn_NS_SNAutoPoster-&gt;nxs_options = $options;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists(&quot;nxs_mkShortURL&quot;)) { function nxs_mkShortURL($url, $postID='') { $rurl = '';  global $plgn_NS_SNAutoPoster;  if (!isset($plgn_NS_SNAutoPoster)) return; $options = $plgn_NS_SNAutoPoster-&gt;nxs_options;&nbsp;</div></li><li><div>  if ($options['nxsURLShrtnr']=='B' && trim($options['bitlyUname']!='') && trim($options['bitlyAPIKey']!='')) {      &nbsp;</div></li><li><div>    $response = wp_remote_get('http:<span class="comment">//api-ssl.bitly.com/v3/shorten?login='.$options['bitlyUname'].'&apiKey='.$options['bitlyAPIKey'].'&longUrl='.urlencode($url)); </span>&nbsp;</div></li><li><div>    if (is_wp_error($response)) { nxs_addToLogN('E', 'bit.ly', '', '-=ERROR=- '.print_r($response, true));  return $url; }&nbsp;</div></li><li><div>    $rtr = json_decode($response['body'], true);&nbsp;</div></li><li><div>    if ($rtr['status_code']=='200') $rurl = $rtr['data']['url'];&nbsp;</div></li><li><div>  } <span class="comment">//echo &quot;###&quot;.$rurl;</span>&nbsp;</div></li><li><div>  if ($options['nxsURLShrtnr']=='A' && trim($options['adflyUname']!='') && trim($options['adflyAPIKey']!='')) {      &nbsp;</div></li><li><div>    $response = wp_remote_get('http:<span class="comment">//api.adf.ly/api.php?key='.$options['adflyAPIKey'].'&uid='.$options['adflyUname'].'&advert_type=int&domain='.$options['adflyDomain'].'&url='.urlencode($url));       </span>&nbsp;</div></li><li><div>    if (is_wp_error($response)) {   nxs_addToLogN('E', 'adf.ly', '', '-=ERROR=- '.print_r($response, true));  return $url; }     &nbsp;</div></li><li><div>    if ( $response['body']!='error')  $rurl = $response['body']; else {  nxs_addToLogN('E', 'adf.ly', '', '-=ERROR=- '.print_r($response, true)); return $url; }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ($options['nxsURLShrtnr']=='C' && trim($options['clkimAPIKey']!='')) {    &nbsp;</div></li><li><div>    $response = wp_remote_get('http:<span class="comment">//clk.im/api?api='.$options['clkimAPIKey'].'&url='.urlencode($url));</span>&nbsp;</div></li><li><div>    if (is_wp_error($response)) { nxs_addToLogN('E', 'clk.im', '', '-=ERROR (SYS)=- '.print_r($response, true)); return $url; }  $r = json_decode($response['body'], true); <span class="comment">//prr($r); die();</span>&nbsp;</div></li><li><div>    if (!is_array($r) || $r['error']!='0') { nxs_addToLogN('E', 'clk.im', '', '-=ERROR (JSON)=- '.print_r($response['body'], true)); return $url; } else $rurl = urldecode($r['short']);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ($options['nxsURLShrtnr']=='X' && trim($options['xcoAPIKey']!='')) {    &nbsp;</div></li><li><div>    $response = wp_remote_get('http:<span class="comment">//api.x.co/Squeeze.svc/text/'.$options['xcoAPIKey'].'?url='.urlencode($url)); </span>&nbsp;</div></li><li><div>    if (is_wp_error($response)) { nxs_addToLogN('E', 'x.co', '', '-=ERROR (SYS)=- '.print_r($response, true)); return $url; }  $r = $response['body'];&nbsp;</div></li><li><div>    if (empty($r) || stripos($r, 'http:<span class="comment">//')===false) { nxs_addToLogN('E', 'x.co', '', '-=ERROR (RES)=- '.print_r($r, true)); return $url; } else $rurl = $r;</span>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ($options['nxsURLShrtnr']=='U') {    &nbsp;</div></li><li><div>    $flds = array('a'=&gt;'add', 'url'=&gt;$url); $response = wp_remote_post('http:<span class="comment">//u.to/', array('body' =&gt; $flds)); </span>&nbsp;</div></li><li><div>    if (is_wp_error($response)) { nxs_addToLogN('E', 'u.to', '', '-=ERROR (SYS)=- '.print_r($response, true)); return $url; }  $r = $response['body'];&nbsp;</div></li><li><div>    if (empty($r) || stripos($r, &quot;#shurlout').val('&quot;)===false) { nxs_addToLogN('E', 'x.co', '', '-=ERROR (RES)=- '.print_r($r, true)); return $url; } else $rurl = CutFromTo($r, &quot;#shurlout').val('&quot;, &quot;'&quot;);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ($options['nxsURLShrtnr']=='P' && trim($options['postAPIKey']!='')) {      &nbsp;</div></li><li><div>    $response = wp_remote_get('http:<span class="comment">//po.st/api/shorten?longUrl='.urlencode($url).'&apiKey='.$options['postAPIKey']);       </span>&nbsp;</div></li><li><div>    if (is_wp_error($response)) { nxs_addToLogN('E', 'po.st', '', '-=ERROR (SYS)=- '.print_r($response, true)); return $url; }  $r = json_decode($response['body'], true); &nbsp;</div></li><li><div>    if (!is_array($r) || $r['status_txt']!='OK') { nxs_addToLogN('E', 'po.st', '', '-=ERROR (JSON)=- '.print_r($response['body'], true)); return $url; } else $rurl = $r['short_url'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ($options['nxsURLShrtnr']=='W' && function_exists('wp_get_shortlink')) { global $post; $post = get_post($postID);  $rurl = wp_get_shortlink($postID, 'post'); }&nbsp;</div></li><li><div>  if ($options['nxsURLShrtnr']=='Y' && trim($options['YOURLSKey']!='') && trim($options['YOURLSURL']!='')) { $timestamp = time(); $signature = md5( $timestamp . $options['YOURLSKey'] ); &nbsp;</div></li><li><div>    $flds = array('signature'=&gt;$signature, 'action' =&gt; 'shorturl', 'url'=&gt;$url, 'format'=&gt;'json', 'timestamp'=&gt;$timestamp);  &nbsp;</div></li><li><div>    $response = wp_remote_post(($options['YOURLSURL']), array('body' =&gt; $flds)); &nbsp;</div></li><li><div>    if (is_wp_error($response)) {  nxs_addToLogN('E', 'YOURLS', '', '-=ERROR=- '.print_r($response, true)); return $url; } &nbsp;</div></li><li><div>    $rtr = json_decode($response['body'], true);  if (!is_array($rtr) || !isset($rtr['shorturl']) ) {   nxs_addToLogN('E', 'goo.gl', '', '-=ERROR=- '.print_r($response, true));  return $url; }      &nbsp;</div></li><li><div>    $rurl = $rtr['shorturl'];&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  }   &nbsp;</div></li><li><div>  if ($options['nxsURLShrtnr']=='O' || $options['nxsURLShrtnr']=='' || $options['nxsURLShrtnr']=='G') {   &nbsp;</div></li><li><div>    $response = wp_remote_post('https:<span class="comment">//www.googleapis.com/urlshortener/v1/url'.($options['gglAPIKey']!=''?'?key='.$options['gglAPIKey']:''), array('headers' =&gt; array('Content-Type'=&gt;'application/json'), 'body' =&gt; '{&quot;longUrl&quot;: &quot;'.$url.'&quot;}')); </span>&nbsp;</div></li><li><div>    if (is_wp_error($response)) {   nxs_addToLogN('E', 'goo.gl', '', '-=ERROR=- '.print_r($response, true));  return $url; } &nbsp;</div></li><li><div>    $rtr = json_decode($response['body'], true); if (!is_array($rtr) || isset($rtr['error']) || !isset($rtr['id']) ) {   nxs_addToLogN('E', 'goo.gl', '', '-=ERROR=- '.print_r($response, true));  return $url; }      &nbsp;</div></li><li><div>    $rurl = $rtr['id'];&nbsp;</div></li><li><div>  }    &nbsp;</div></li><li><div>  <span class="comment">//if ($rurl=='') { $response = wp_remote_get('http://gd.is/gtq/'.$url); if ((is_array($response) && ($response['response']['code']=='200'))) $rurl = $response['body']; }</span>&nbsp;</div></li><li><div>  if ($rurl!='') $url = $rurl;  return $url;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div><span class="comment"><span class="comment">//## </span>Comments - DISQUS native function has global $post; overwriting $post parameter in the middle of it.</span>&nbsp;</div></li><li><div>function nxs_dsq_export_wp($nxPost, $comments=null) { global $wpdb, $wp_query, $post; $post = $nxPost;  ob_start(); echo '&lt;?xml version=&quot;1.0&quot; encoding=&quot;' . get_bloginfo('charset') . '&quot;?' . &quot;&gt;\n&quot;;?&gt;&nbsp;</div></li><li><div>&lt;?php the_generator('export');?&gt;&lt;rss version=&quot;2.0&quot; xmlns:excerpt=&quot;http:<span class="comment">//wordpress.org/export/&lt;?php echo WXR_VERSION; ?&gt;/excerpt/&quot; xmlns:content=&quot;http://purl.org/rss/1.0/modules/content/&quot;</span>&nbsp;</div></li><li><div>  xmlns:dsq=&quot;http:<span class="comment">//www.disqus.com/&quot; xmlns:wfw=&quot;http://wellformedweb.org/CommentAPI/&quot; xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot; xmlns:wp=&quot;http://wordpress.org/export/&lt;?php echo WXR_VERSION; ?&gt;/&quot;&gt;</span>&nbsp;</div></li><li><div>&lt;channel&gt;&nbsp;</div></li><li><div>  &lt;title&gt;&lt;?php bloginfo_rss('name'); ?&gt;&lt;/title&gt;&lt;link&gt;&lt;?php bloginfo_rss('url') ?&gt;&lt;/link&gt;&lt;pubDate&gt;&lt;?php echo mysql2date('D, d M Y H:i:s +0000', get_lastpostmodified('GMT'), false); ?&gt;&lt;/pubDate&gt;&nbsp;</div></li><li><div>  &lt;generator&gt;WordPress &lt;?php bloginfo_rss('version'); ?&gt;; Disqus &lt;?php echo DISQUS_VERSION; ?&gt;&lt;/generator&gt;&nbsp;</div></li><li><div>&lt;?php $wp_query-&gt;in_the_loop = true; setup_postdata($post); ?&gt;&nbsp;</div></li><li><div>&lt;item&gt;&lt;title&gt;&lt;?php echo apply_filters('the_title_rss', $post-&gt;post_title); ?&gt;&lt;/title&gt;&lt;link&gt;&lt;?php the_permalink_rss() ?&gt;&lt;/link&gt;&nbsp;</div></li><li><div>&lt;pubDate&gt;&lt;?php echo mysql2date('D, d M Y H:i:s +0000', get_post_time('Y-m-d H:i:s', true), false); ?&gt;&lt;/pubDate&gt;&nbsp;</div></li><li><div>&lt;dc:creator&gt;&lt;?php echo dsq_export_wxr_cdata(get_the_author()); ?&gt;&lt;/dc:creator&gt;&nbsp;</div></li><li><div>&lt;guid isPermaLink=&quot;false&quot;&gt;&lt;?php the_guid(); ?&gt;&lt;/guid&gt;&nbsp;</div></li><li><div>&lt;content:encoded&gt;&lt;?php echo dsq_export_wxr_cdata( apply_filters('the_content_export', $post-&gt;post_content) ); ?&gt;&lt;/content:encoded&gt;&nbsp;</div></li><li><div>&lt;dsq:thread_identifier&gt;&lt;?php echo dsq_identifier_for_post($post); ?&gt;&lt;/dsq:thread_identifier&gt;&nbsp;</div></li><li><div>&lt;wp:post_id&gt;&lt;?php echo $post-&gt;ID; ?&gt;&lt;/wp:post_id&gt;&nbsp;</div></li><li><div>&lt;wp:post_date_gmt&gt;&lt;?php echo $post-&gt;post_date_gmt; ?&gt;&lt;/wp:post_date_gmt&gt;&nbsp;</div></li><li><div>&lt;wp:comment_status&gt;&lt;?php echo $post-&gt;comment_status; ?&gt;&lt;/wp:comment_status&gt;&nbsp;</div></li><li><div>&lt;?php&nbsp;</div></li><li><div>if ( $comments ) { foreach ( $comments as $c ) { ?&gt;&nbsp;</div></li><li><div>  &lt;wp:comment&gt;&nbsp;</div></li><li><div>  &lt;wp:comment_id&gt;&lt;?php echo $c-&gt;comment_ID; ?&gt;&lt;/wp:comment_id&gt;&nbsp;</div></li><li><div>  &lt;wp:comment_author&gt;&lt;?php echo dsq_export_wxr_cdata($c-&gt;comment_author); ?&gt;&lt;/wp:comment_author&gt;&nbsp;</div></li><li><div>  &lt;wp:comment_author_email&gt;&lt;?php echo $c-&gt;comment_author_email; ?&gt;&lt;/wp:comment_author_email&gt;&nbsp;</div></li><li><div>  &lt;wp:comment_author_url&gt;&lt;?php echo $c-&gt;comment_author_url; ?&gt;&lt;/wp:comment_author_url&gt;&nbsp;</div></li><li><div>  &lt;wp:comment_author_IP&gt;&lt;?php echo $c-&gt;comment_author_IP; ?&gt;&lt;/wp:comment_author_IP&gt;&nbsp;</div></li><li><div>  &lt;wp:comment_date&gt;&lt;?php echo $c-&gt;comment_date; ?&gt;&lt;/wp:comment_date&gt;&nbsp;</div></li><li><div>  &lt;wp:comment_date_gmt&gt;&lt;?php echo $c-&gt;comment_date_gmt; ?&gt;&lt;/wp:comment_date_gmt&gt;&nbsp;</div></li><li><div>  &lt;wp:comment_content&gt;&lt;?php echo dsq_export_wxr_cdata($c-&gt;comment_content) ?&gt;&lt;/wp:comment_content&gt;&nbsp;</div></li><li><div>  &lt;wp:comment_approved&gt;&lt;?php echo $c-&gt;comment_approved; ?&gt;&lt;/wp:comment_approved&gt;&nbsp;</div></li><li><div>  &lt;wp:comment_type&gt;&lt;?php echo $c-&gt;comment_type; ?&gt;&lt;/wp:comment_type&gt;&nbsp;</div></li><li><div>  &lt;wp:comment_parent&gt;&lt;?php echo $c-&gt;comment_parent; ?&gt;&lt;/wp:comment_parent&gt;&nbsp;</div></li><li><div>  &lt;/wp:comment&gt;&nbsp;</div></li><li><div>&lt;?php } } <span class="comment">// comments ?&gt;</span>&nbsp;</div></li><li><div>  &lt;/item&gt;&nbsp;</div></li><li><div>&lt;/channel&gt;&nbsp;</div></li><li><div>&lt;/rss&gt;&nbsp;</div></li><li><div>&lt;?php $output = ob_get_clean(); return $output;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div><span class="comment">//## </span>&nbsp;</div></li><li><div>if (!function_exists(&quot;nxs_postNewComment&quot;)) { function nxs_postNewComment($cmnt, $aa = false) { $cmnt['comment_post_ID'] = (int) $cmnt['comment_post_ID'];&nbsp;</div></li><li><div>$cmnt['comment_parent'] = isset($cmnt['comment_parent']) ? absint($cmnt['comment_parent']) : 0; $ae =  get_option('admin_email');&nbsp;</div></li><li><div><span class="comment">//$u = get_user_by( 'email', get_option('admin_email') );   $cmnt['user_id'] = $u-&gt;ID; //???</span>&nbsp;</div></li><li><div>$u = get_user_by( 'email', $cmnt['comment_author_email'] ); if (!empty($u)) $cmnt['user_id'] = $u-&gt;ID; else $cmnt['user_id'] = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$parent_status = ( 0 &lt; $cmnt['comment_parent'] ) ? wp_get_comment_status($cmnt['comment_parent']) : ''; &nbsp;</div></li><li><div>$cmnt['comment_parent'] = ( 'approved' == $parent_status || 'unapproved' == $parent_status ) ? $cmnt['comment_parent'] : 0;&nbsp;</div></li><li><div>$cmnt['comment_author_IP'] = ''; if (empty($cmnt['comment_agent'])) $cmnt['comment_agent'] = 'SNAP'; $cmnt['comment_date'] =  get_date_from_gmt( $cmnt['comment_date_gmt'] );    &nbsp;</div></li><li><div>$cmnt = wp_filter_comment($cmnt); if ($aa) $cmnt['comment_approved'] = 1; else $cmnt['comment_approved'] = nxs_wp_allow_comment($cmnt); <span class="comment">// echo &quot;INSERT&quot;;  prr($cmnt);</span>&nbsp;</div></li><li><div>if ( $cmnt['comment_approved'] != 'spam' && $cmnt['comment_approved']&gt;1 ) return $cmnt['comment_approved'];  else  $cmntID = wp_insert_comment($cmnt); &nbsp;</div></li><li><div>if (empty($cmntID)) {  nxs_addToLogN('E', 'Error', 'Comments', '-=ERROR=-', print_r($cmnt, true)); return; }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( 'spam' !== $cmnt['comment_approved'] ) { if ( '0' == $cmnt['comment_approved'] ) wp_notify_moderator($cmntID); $post = get_post($cmnt['comment_post_ID']);&nbsp;</div></li><li><div>  if ( get_option('comments_notify') && $cmnt['comment_approved'] && ( ! isset( $cmnt['user_id'] ) || $post-&gt;post_author != $cmnt['user_id'] ) ) wp_notify_postauthor($cmntID);  &nbsp;</div></li><li><div>  global $wpdb, $dsq_api;&nbsp;</div></li><li><div>  if (isset($dsq_api) && is_object($post)) { $plugins_url = str_replace( 'social-networks-auto-poster-facebook-twitter-g/', '', plugin_dir_path( __FILE__ )); require_once( $plugins_url.'disqus-comment-system/export.php'); &nbsp;</div></li><li><div>  if (function_exists('dsq_export_wp')) {&nbsp;</div></li><li><div>    $comments = $wpdb-&gt;get_results( $wpdb-&gt;prepare(&quot;SELECT * FROM $wpdb-&gt;comments WHERE comment_ID = %d&quot;, $cmntID) ); &nbsp;</div></li><li><div>    $wxr = nxs_dsq_export_wp($post, $comments); $response = $dsq_api-&gt;import_wordpress_comments($wxr, time()); &nbsp;</div></li><li><div>  }}&nbsp;</div></li><li><div>} &nbsp;</div></li><li><div>return $cmntID;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//#### Native WP Function that has wp_die in the middle of it ?????</span>&nbsp;</div></li><li><div>function nxs_wp_allow_comment($commentdata) { global $wpdb; extract($commentdata, EXTR_SKIP); &nbsp;</div></li><li><div>  <span class="comment">// Simple duplicate check // expected_slashed ($comment_post_ID, $comment_author, $comment_author_email, $comment_content)</span>&nbsp;</div></li><li><div>  $dupe = &quot;SELECT comment_ID FROM $wpdb-&gt;comments WHERE comment_post_ID = '$comment_post_ID' AND comment_parent = '$comment_parent' AND comment_approved != 'trash' AND ( comment_author = '$comment_author' &quot;;&nbsp;</div></li><li><div>  if ( $comment_author_email ) $dupe .= &quot;OR comment_author_email = '$comment_author_email' &quot;; $dupe .= &quot;) AND comment_content = '$comment_content' LIMIT 1&quot;;&nbsp;</div></li><li><div>  $dupeID = $wpdb-&gt;get_var($dupe); if ( $dupeID ) { do_action( 'comment_duplicate_trigger', $commentdata ); return $dupeID; } &nbsp;</div></li><li><div>  do_action( 'check_comment_flood', $comment_author_IP, $comment_author_email, $comment_date_gmt );&nbsp;</div></li><li><div>  if ( ! empty( $user_id ) ) { $user = get_userdata( $user_id ); $post_author = $wpdb-&gt;get_var($wpdb-&gt;prepare(&quot;SELECT post_author FROM $wpdb-&gt;posts WHERE ID = %d LIMIT 1&quot;, $comment_post_ID)); }&nbsp;</div></li><li><div>  if ( isset( $user ) && ( $user_id == $post_author || $user-&gt;has_cap( 'moderate_comments' ) ) ) { <span class="comment">// The author and the admins get respect.</span>&nbsp;</div></li><li><div>      $approved = 1;&nbsp;</div></li><li><div>   } else { <span class="comment">// Everyone else's comments will be checked.</span>&nbsp;</div></li><li><div>      if ( check_comment($comment_author, $comment_author_email, $comment_author_url, $comment_content, $comment_author_IP, $comment_agent, $comment_type) ) $approved = 1; else $approved = 0;&nbsp;</div></li><li><div>      if ( wp_blacklist_check($comment_author, $comment_author_email, $comment_author_url, $comment_content, $comment_author_IP, $comment_agent) ) $approved = 'spam';&nbsp;</div></li><li><div>  } $approved = apply_filters( 'pre_comment_approved', $approved, $commentdata ); return $approved;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists(&quot;ns_get_avatar&quot;)) { function ns_get_avatar($avatar, $id_or_email, $size=96, $default='', $alt='') { &nbsp;</div></li><li><div>  if ( is_object($id_or_email) ) { &nbsp;</div></li><li><div>    if ($id_or_email-&gt;comment_agent=='SNAP' && stripos($id_or_email-&gt;comment_author_url, 'facebook.com')!==false) { $fbuID = str_ireplace('@facebook.com', '', $id_or_email-&gt;comment_author_email);        &nbsp;</div></li><li><div>      $avatar = &quot;&lt;img alt='{$id_or_email-&gt;comment_author}' src='https:<span class="comment">//graph.facebook.com/v2.3/$fbuID/picture' class='avatar avatar-{$size} photo avatar-default' height='{$size}' width='{$size}' /&gt;&quot;;              }</span>&nbsp;</div></li><li><div>    if (stripos($id_or_email-&gt;comment_agent, 'SNAP||')!==false && stripos($id_or_email-&gt;comment_author_url, 'twitter.com')!==false) { $fbuID = str_ireplace('SNAP||', '', $id_or_email-&gt;comment_agent);&nbsp;</div></li><li><div>      $avatar = &quot;&lt;img alt='{$id_or_email-&gt;comment_author}' src='{$fbuID}' class='avatar avatar-{$size} photo avatar-default' height='{$size}' width='{$size}' /&gt;&quot;;        &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return $avatar;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists('nxs_doProcessTags')) { function nxs_doProcessTags($tags) { $tagsA = array(); if (!is_array($tags)) { $tags = explode(', ', $tags); &nbsp;</div></li><li><div>foreach ($tags as $tg) $tagsA[] = trim($tg); } else $tagsA = $tags; $tagsA = array_unique($tagsA);  $tags = array(); &nbsp;</div></li><li><div>foreach ($tagsA as $tg) { $tags['tagsA'][] = $tg; $tags['htagsA'][] = &quot;#&quot;.trim(str_replace(' ', '', preg_replace('/[^a-zA-Z0-9\p{L}\p{N}\s]/u', '', trim(ucwords(str_ireplace('&', '', str_ireplace('&amp;', '', $tg))))))); } &nbsp;</div></li><li><div>$tags['tags'] =  implode(', ', $tags['tagsA']); $tags['htags'] = implode(', ', $tags['htagsA']);&nbsp;</div></li><li><div>return $tags;&nbsp;</div></li><li><div>}}            &nbsp;</div></li><li><div>if (!function_exists('nxs_doFormatMsg')) { function nxs_doFormatMsg($format, $message, $addURLParams='') { global $nxs_urlLen; $msg = nxs_doSpin($format);<span class="comment">// prr($msg); prr($message);// Make &quot;message default&quot;</span>&nbsp;</div></li><li><div>$msgDef = array('title'=&gt;'', 'announce'=&gt;'', 'text'=&gt;'', 'url'=&gt;'', 'surl'=&gt;'', 'urlDescr'=&gt;'', 'urlTitle'=&gt;'', 'imageURL' =&gt; array(), 'videoCode'=&gt;'', 'videoURL'=&gt;'', 'siteName'=&gt;'', 'tags'=&gt;'', 'cats'=&gt;'', 'authorName'=&gt;'', 'orID'=&gt;''); $message = array_merge($msgDef, $message);&nbsp;</div></li><li><div>if (preg_match('/%URL%/', $msg)) { $url = $message['url']; if($addURLParams!='') $url .= (strpos($url, '?')!==false?'&':'?').$addURLParams;  $nxs_urlLen = nxs_strLen($url); $msg = str_ireplace(&quot;%URL%&quot;, $url, $msg);}&nbsp;</div></li><li><div>if (preg_match('/%SURL%/', $msg)) { &nbsp;</div></li><li><div>  if (isset($message['surl']) && $message['surl']!='') $url = $message['surl']; else { $url = $message['url']; if($addURLParams!='') $url .= (strpos($url, '?')!==false?'&':'?').$addURLParams; $url = nxs_mkShortURL($url); } &nbsp;</div></li><li><div>  $nxs_urlLen = nxs_strLen($url); $msg = str_ireplace(&quot;%SURL%&quot;, $url, $msg);&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>if (preg_match('/%IMG%/', $msg)) { if (isset($message['imgURL']) && is_array($message['imgURL'])) { $imgURL = trim($message['imgURL']['large']); if ($imgURL=='') $imgURL = trim($message['imgURL']['medium']);   &nbsp;</div></li><li><div>    if ($imgURL=='') $imgURL = trim($message['imgURL']['original']); if ($imgURL=='') $imgURL = trim($message['imgURL']['thumb']);&nbsp;</div></li><li><div>  } elseif (!empty($message['imgURL'])) $imgURL = $message['imgURL']; else $imgURL = '';    $msg = str_ireplace(&quot;%IMG%&quot;, $imgURL, $msg); &nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>if (preg_match('/%IMGLARGE%/', $msg)) $msg = str_ireplace(&quot;%IMG%&quot;, trim($message['imgURL']['large'], $msg));  &nbsp;</div></li><li><div>if (preg_match('/%IMGMEDIUM%/', $msg)) $msg = str_ireplace(&quot;%IMGMEDIUM%&quot;, trim($message['imgURL']['medium'], $msg));  &nbsp;</div></li><li><div>if (preg_match('/%IMGTHUMB%/', $msg)) $msg = str_ireplace(&quot;%IMGTHUMB%&quot;, trim($message['imgURL']['thumb'], $msg));  &nbsp;</div></li><li><div>if (preg_match('/%IMGORIGINAL%/', $msg)) $msg = str_ireplace(&quot;%IMGORIGINAL%&quot;, trim($message['imgURL']['original'], $msg));  &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (preg_match('/%ORID%/', $msg)) $msg = str_ireplace(&quot;%ORID%&quot;, $message['orID'], $msg);  &nbsp;</div></li><li><div>if (preg_match('/%TITLE%/', $msg)) $msg = str_ireplace(&quot;%TITLE%&quot;, $message['title'], $msg);  &nbsp;</div></li><li><div>if (preg_match('/%STITLE%/', $msg)) { $title = substr($message['title'], 0, 115); $msg = str_ireplace(&quot;%STITLE%&quot;, $title, $msg); }                    &nbsp;</div></li><li><div>if (preg_match('/%AUTHORNAME%/', $msg)) $msg = str_ireplace(&quot;%AUTHORNAME%&quot;, $message['authorName'], $msg);&nbsp;</div></li><li><div>if (preg_match('/%SITENAME%/', $msg)) $msg = str_ireplace(&quot;%SITENAME%&quot;, $message['siteName'], $msg); &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (preg_match('/%ANNOUNCE%/', $msg)) { $sText =  trim($message['announce'])!=''?$message['announce']:nsTrnc($message['description'], 300, &quot; &quot;, &quot;...&quot;);  $msg = str_ireplace(&quot;%ANNOUNCE%&quot;, $sText, $msg); }&nbsp;</div></li><li><div>if (preg_match('/%EXCERPT%/', $msg)) { $sText =  trim($message['announce'])!=''?$message['announce']:nsTrnc($message['description'], 300, &quot; &quot;, &quot;...&quot;);  $msg = str_ireplace(&quot;%EXCERPT%&quot;, $sText, $msg); }&nbsp;</div></li><li><div>if (preg_match('/%RAWEXCERPT%/', $msg)) { $sText =  trim($message['announce'])!=''?$message['announce']:nsTrnc($message['description'], 300, &quot; &quot;, &quot;...&quot;);  $msg = str_ireplace(&quot;%RAWEXCERPT%&quot;, $sText, $msg); }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (preg_match('/%TEXT%/', $msg)) $msg = str_ireplace(&quot;%TEXT%&quot;, $message['description'], $msg);     &nbsp;</div></li><li><div>if (preg_match('/%FULLTEXT%/', $msg)) $msg = str_ireplace(&quot;%FULLTEXT%&quot;, $message['description'], $msg);     &nbsp;</div></li><li><div>if (preg_match('/%RAWTEXT%/', $msg)) $msg = str_ireplace(&quot;%RAWTEXT%&quot;, $message['description'], $msg);     &nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (preg_match('/%TAGS%/', $msg)) { $tags = nxs_doProcessTags($message['tags']);  $msg = str_ireplace(&quot;%TAGS%&quot;, $tags['tags'], $msg); }&nbsp;</div></li><li><div>if (preg_match('/%HTAGS%/', $msg)) { $tags = nxs_doProcessTags($message['tags']);  $msg = str_ireplace(&quot;%HTAGS%&quot;, $tags['htags'], $msg); }&nbsp;</div></li><li><div>if (preg_match('/%CATS%/', $msg)) { $tags = nxs_doProcessTags($message['cats']);  $msg = str_ireplace(&quot;%CATS%&quot;, $tags['cats'], $msg); }&nbsp;</div></li><li><div>if (preg_match('/%HCATS%/', $msg)) { $tags = nxs_doProcessTags($message['hcats']);  $msg = str_ireplace(&quot;%HCATS%&quot;, $tags['hcats'], $msg); }&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>if (preg_match('/%+CF-[a-zA-Z0-9-_]+%/', $msg)) { $msgA = explode('%CF', $msg); $mout = '';&nbsp;</div></li><li><div>  foreach ($msgA as $mms) { &nbsp;</div></li><li><div>      if (substr($mms, 0, 1)=='-' && stripos($mms, '%')!==false) { $mGr = CutFromTo($mms, '-', '%'); $cfItem = $message[$mGr]; $mms = str_ireplace(&quot;-&quot;.$mGr.&quot;%&quot;, $cfItem, $mms); } $mout .= $mms; &nbsp;</div></li><li><div>  } $msg = $mout; &nbsp;</div></li><li><div>}  &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>return trim($msg);&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div><span class="comment">//## </span>Common Dialogs&nbsp;</div></li><li><div>if (!function_exists('nxs_showImgToUseDlg')) { function nxs_showImgToUseDlg($nt, $ii, $imgToUse, $hide=false) { ?&gt;&nbsp;</div></li><li><div> &lt;tr id=&quot;altFormatIMG&lt;?php echo $nt.$ii; ?&gt;&quot; style=&quot;&lt;?php echo $hide?'display:none;':''; ?&gt;&quot;&gt;&lt;th scope=&quot;row&quot; style=&quot;vertical-align:top; padding-top: 6px; text-align:right; width:60px; padding-right:10px;&quot;&gt;&lt;?php _e('Image(s) to use:', 'social-networks-auto-poster-facebook-twitter-g') ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                &lt;td&gt;&lt;input type=&quot;checkbox&quot; class=&quot;isAutoImg&quot; &lt;?php if ($imgToUse=='') { ?&gt;checked=&quot;checked&quot;&lt;?php } ?&gt;  id=&quot;isAutoImg-&lt;?php echo $nt; ?&gt;&lt;?php echo $ii; ?&gt;&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][isAutoImg]&quot; value=&quot;A&quot;/&gt; &lt;?php _e('Auto', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;</div></li><li><div>                &lt;?php if ($imgToUse!='') { ?&gt; &lt;a onclick=&quot;nxs_clPrvImgShow('&lt;?php echo $nt; ?&gt;&lt;?php echo $ii; ?&gt;');return false;&quot; href=&quot;#&quot;&gt;&lt;?php _e('Show all', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/a&gt;&lt;br/&gt;  &nbsp;</div></li><li><div>                  &lt;div class=&quot;nxs_prevImagesDiv&quot; id=&quot;nxs_&lt;?php echo $nt; ?&gt;&lt;?php echo $ii; ?&gt;_idivD&quot;&gt;&lt;img class=&quot;nxs_prevImages&quot; src=&quot;&lt;?php echo $imgToUse; ?&gt;&quot;&gt;&lt;div style=&quot;display:block;&quot; class=&quot;nxs_checkIcon&quot;&gt;&lt;div class=&quot;media-modal-icon&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                &lt;?php } else { ?&gt;&lt;br/&gt;&lt;?php } ?&gt;&nbsp;</div></li><li><div>                  &lt;div id=&quot;imgPrevList-&lt;?php echo $nt; ?&gt;&lt;?php echo $ii; ?&gt;&quot; class=&quot;nxs_imgPrevList&quot;&gt;&lt;/div&gt;  &nbsp;</div></li><li><div>                  &lt;input type=&quot;hidden&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][imgToUse]&quot; value=&quot;&lt;?php echo $imgToUse ?&gt;&quot; id=&quot;imgToUse-&lt;?php echo $nt; ?&gt;&lt;?php echo $ii; ?&gt;&quot; /&gt; &nbsp;</div></li><li><div>              &lt;/td&gt;&lt;/tr&gt; &nbsp;</div></li><li><div>&lt;?php }}&nbsp;</div></li><li><div>if (!function_exists('nxs_showURLToUseDlg')) { function nxs_showURLToUseDlg($nt, $ii, $urlToUse) { ?&gt;&nbsp;</div></li><li><div> &lt;tr id=&quot;altFormat1&quot; style=&quot;&quot;&gt;&lt;th scope=&quot;row&quot; style=&quot;vertical-align:top; padding-top: 6px; text-align:right; width:60px; padding-right:10px;&quot;&gt;&lt;?php _e('URL to use:', 'social-networks-auto-poster-facebook-twitter-g') ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>                &lt;td&gt;&lt;input type=&quot;checkbox&quot; class=&quot;isAutoURL&quot; &lt;?php if ($urlToUse=='') { ?&gt;checked=&quot;checked&quot;&lt;?php } ?&gt;  id=&quot;isAutoURL-&lt;?php echo $nt; ?&gt;&lt;?php echo $ii; ?&gt;&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][isAutoURL]&quot; value=&quot;A&quot;/&gt; &lt;?php _e('Auto', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt; - &lt;i&gt;&lt;?php _e('Post URL or globally defined URL will be used', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/i&gt;&nbsp;</div></li><li><div>                &nbsp;</div></li><li><div>                  &lt;div class=&quot;nxs_prevURLDiv&quot; &lt;?php if (trim($urlToUse)=='') { ?&gt; style=&quot;display:none;&quot;&lt;?php } ?&gt; id=&quot;isAutoURLFld-&lt;?php echo $nt; ?&gt;&lt;?php echo $ii; ?&gt;&quot;&gt;&nbsp;</div></li><li><div>                    &nbsp;&nbsp;&nbsp;&lt;?php _e('URL:', 'social-networks-auto-poster-facebook-twitter-g') ?&gt; &lt;input size=&quot;90&quot; type=&quot;text&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][urlToUse]&quot; value=&quot;&lt;?php echo $urlToUse ?&gt;&quot; id=&quot;URLToUse-&lt;?php echo $nt; ?&gt;&lt;?php echo $ii; ?&gt;&quot; /&gt; &nbsp;</div></li><li><div>                    &lt;br/&gt;&lt;span&gt;&lt;?php _e('This will trigger &quot;Network will decide attachment info&quot;. Image and other settings will be ignored.', 'social-networks-auto-poster-facebook-twitter-g') ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                  &lt;/div&gt;&nbsp;</div></li><li><div>                &nbsp;</div></li><li><div>              &lt;/td&gt;&lt;/tr&gt; &nbsp;</div></li><li><div>&lt;?php }}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//## </span>Tests&nbsp;</div></li><li><div>function nxs_cURLTestCode($url) {  &nbsp;</div></li><li><div>$out = 'There is a problem with cURL. You need to contact your server admin or hosting provider. Here is the PHP code to reproduce the problem:&lt;br/&gt;&lt;pre style=&quot;color:#005800&quot;&gt;&lt;?php '.&quot;\r\n&quot;.' $ch = curl_init(); '.&quot;\r\n&quot;.' curl_setopt($ch, CURLOPT_URL, &quot;'.$url.'&quot;); '.&quot;\r\n&quot;.' curl_setopt($ch, CURLOPT_USERAGENT, &quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.73 Safari/537.36&quot;); '.&quot;\r\n&quot;.' curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); '.&quot;\r\n&quot;.' curl_setopt($ch, CURLOPT_TIMEOUT, 10); '.&quot;\r\n&quot;.' curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 10); '.&quot;\r\n&quot;.' $response = curl_exec($ch); '.&quot;\r\n&quot;.' $errmsg = curl_error($ch); '.&quot;\r\n&quot;.' $cInfo = curl_getinfo($ch); '.&quot;\r\n&quot;.' curl_close($ch); '.&quot;\r\n&quot;.' print_r($errmsg); '.&quot;\r\n&quot;.' print_r($cInfo); '.&quot;\r\n&quot;.' print_r($response); '.&quot;\r\n&quot;.'?&gt;&lt;/pre&gt;'; return $out; &nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>function nxs_cURLTest($url, $msg, $testText) { echo &quot;&lt;br/&gt;--== Test Requested ... &quot;.$url.&quot;&lt;br/&gt;&quot;;  $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); &nbsp;</div></li><li><div>curl_setopt($ch, CURLOPT_USERAGENT, &quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.39 Safari/537.36&quot;); &nbsp;</div></li><li><div>curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_TIMEOUT, 10); curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 10);&nbsp;</div></li><li><div>$response = curl_exec($ch); $errmsg = curl_error($ch); $cInfo = curl_getinfo($ch); curl_close($ch); echo &quot;Testing ... &quot;.$url.&quot; - &quot;.$cInfo['url'].&quot;&lt;br/&gt;&quot;;&nbsp;</div></li><li><div>if (stripos($response, $testText)!==false) echo &quot;....&quot;.$msg.&quot; - OK&lt;br/&gt;&quot;; else { echo &quot;....&lt;b style='color:red;'&gt;&quot;.$msg.&quot; - Problem&lt;/b&gt;&lt;br/&gt;&quot;; prr($response); prr($errmsg); prr($cInfo); echo nxs_cURLTestCode($url);  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//## </span>Reposter&nbsp;</div></li><li><div>function nxs_adjRpst($optionsii, $pval) {  if (empty($optionsii['rpstDays'])) $optionsii['rpstDays'] = 0; if (empty($optionsii['rpstHrs'])) $optionsii['rpstHrs'] = 0; if (empty($optionsii['rpstMins'])) $optionsii['rpstMins'] = 0;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  $rpstEvrySecEx = $optionsii['rpstDays']*86400+$optionsii['rpstHrs']*3600+$optionsii['rpstMins']*60; $isRpstWasOn = isset($optionsii['rpstOn']) && $optionsii['rpstOn']=='1';&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if (isset($pval['rpstOn']))    $optionsii['rpstOn'] = $pval['rpstOn']; else $optionsii['rpstOn'] = 0;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if (isset($pval['rpstDays']))  $optionsii['rpstDays'] = trim($pval['rpstDays']);       &nbsp;</div></li><li><div>  if (isset($pval['rpstHrs']))   $optionsii['rpstHrs'] = trim($pval['rpstHrs']);     if ((int)$optionsii['rpstHrs']&gt;23) $optionsii['rpstHrs'] = 23;&nbsp;</div></li><li><div>  if (isset($pval['rpstMins']))  $optionsii['rpstMins'] = trim($pval['rpstMins']);   if ((int)$optionsii['rpstMins']&gt;59) $optionsii['rpstMins'] = 59;    &nbsp;</div></li><li><div>  if (isset($pval['rpstRndMins']))  $optionsii['rpstRndMins'] = trim($pval['rpstRndMins']);       &nbsp;</div></li><li><div>  if (isset($pval['rpstPostIncl']))  $optionsii['rpstPostIncl'] = trim($pval['rpstPostIncl']);     &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if (isset($pval['rpstStop']))  $optionsii['rpstStop'] = trim($pval['rpstStop']); else $optionsii['rpstStop'] = 'O';      &nbsp;</div></li><li><div>   &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  $rpstEvrySecNew = $optionsii['rpstDays']*86400+$optionsii['rpstHrs']*3600+$optionsii['rpstMins']*60;&nbsp;</div></li><li><div>  $rpstRNDSecs = isset($optionsii['rpstRndMins'])?$optionsii['rpstRndMins']*60:0; if ($rpstRNDSecs&gt;$rpstEvrySecNew) $optionsii['rpstRndMins'] = 0;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ($rpstEvrySecNew!=$rpstEvrySecEx || (!$isRpstWasOn && $optionsii['rpstOn']=='1')) { $currTime = time() + ( get_option( 'gmt_offset' ) * HOUR_IN_SECONDS ); $optionsii['rpstNxTime'] = $currTime + $rpstEvrySecNew; }&nbsp;</div></li><li><div>  if (isset($pval['rpstType']))  $optionsii['rpstType'] = trim($pval['rpstType']);       &nbsp;</div></li><li><div>  if (isset($pval['rpstTimeType']))  $optionsii['rpstTimeType'] = trim($pval['rpstTimeType']);       &nbsp;</div></li><li><div>  if (isset($pval['rpstFromTime']))  $optionsii['rpstFromTime'] = trim($pval['rpstFromTime']);       &nbsp;</div></li><li><div>  if (isset($pval['rpstToTime']))  $optionsii['rpstToTime'] = trim($pval['rpstToTime']);       &nbsp;</div></li><li><div>  if (isset($pval['rpstOLDays']))  $optionsii['rpstOLDays'] = trim($pval['rpstOLDays']);       &nbsp;</div></li><li><div>  if (isset($pval['rpstNWDays']))  $optionsii['rpstNWDays'] = trim($pval['rpstNWDays']);       &nbsp;</div></li><li><div>  if (isset($pval['rpstOnlyPUP']))  $optionsii['rpstOnlyPUP'] = trim($pval['rpstOnlyPUP']); else $optionsii['rpstOnlyPUP'] = 0;     &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if (isset($pval['nxsCPTSeld']))      $optionsii['nxsCPTSeld'] = serialize($pval['nxsCPTSeld']);              &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if (isset($pval['fltrsOn'])) $optionsii['fltrsOn'] = trim($pval['fltrsOn']); else $optionsii['fltrsOn'] = 0;     &nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if (isset($pval['tagsSel'])) {  $optionsii['tagsSel'] = trim($pval['tagsSel']); $tagsSelX = array(); $tggsSel = explode(', ', $optionsii['tagsSel']); &nbsp;</div></li><li><div>    foreach ($tggsSel as $tggg) { $tggg = trim($tggg); $tagsSelX[] = $tggg;  &nbsp;</div></li><li><div>      if (stripos($tggg, '|')!==false) { $tgArr =  explode('|', $tggg); $taxonomy = $tgArr[0]; $tgggT = $tgArr[1]; } else { $taxonomy = 'post_tag'; $tgggT = $tggg; } &nbsp;</div></li><li><div>      $tgArr = get_term_by( 'slug', $tgggT, $taxonomy, ARRAY_A); if (is_array($tgArr)) $tagsSelX[] = $tgArr['term_id'];&nbsp;</div></li><li><div>    }  $optionsii['tagsSelX'] = implode(', ', $tagsSelX); &nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if (isset($pval['custTaxSel']))  $optionsii['custTaxSel'] = trim($pval['custTaxSel']);     &nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>  if (isset($pval['rpstBtwHrsType']))  $optionsii['rpstBtwHrsType'] = trim($pval['rpstBtwHrsType']);       &nbsp;</div></li><li><div>  if (isset($pval['rpstBtwHrsT']))  $optionsii['rpstBtwHrsT'] = trim($pval['rpstBtwHrsT']);  if (isset($optionsii['rpstBtwHrsT'])&&(int)$optionsii['rpstBtwHrsT']&gt;23) $optionsii['rpstBtwHrsT'] = 23;         &nbsp;</div></li><li><div>  if (isset($pval['rpstBtwHrsF']))  $optionsii['rpstBtwHrsF'] = trim($pval['rpstBtwHrsF']);  if (isset($optionsii['rpstBtwHrsF'])&&(int)$optionsii['rpstBtwHrsF']&gt;23) $optionsii['rpstBtwHrsF'] = 23;               &nbsp;</div></li><li><div>  if (isset($pval['rpstBtwDays']))  $optionsii['rpstBtwDays'] = $pval['rpstBtwDays']; else $optionsii['rpstBtwDays'] = array(); &nbsp;</div></li><li><div>  return $optionsii;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nxs_showCatTagsCTFilters($nt, $ii, $options) { global $nxs_snapAvNts, $nxs_plurl; &nbsp;</div></li><li><div>if (!isset($options['tagsSel'])) $options['tagsSel'] = ''; if (!isset($options['custTaxSel'])) $options['custTaxSel'] = '';&nbsp;</div></li><li><div>?&gt; &lt;div class=&quot;nxs_tls_cpt&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;?php _e('Filter Autoposting by', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>  &lt;div class=&quot;nxs_tls_bd&quot;&gt;&nbsp;</div></li><li><div>  &lt;div style=&quot;width:100%;&quot;&gt;&lt;strong&gt;&lt;?php _e('Categories', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;:&lt;/strong&gt;&nbsp;</div></li><li><div>     &lt;input value=&quot;0&quot; id=&quot;catSelA&lt;?php echo strtoupper($nt); ?&gt;&lt;?php echo $ii; ?&gt;&quot; type=&quot;radio&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][catSel]&quot; &lt;?php if ((int)$options['catSel'] != 1) echo &quot;checked&quot;; ?&gt; /&gt; &lt;?php _e('All', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;</div></li><li><div>     &lt;input value=&quot;1&quot; id=&quot;catSelS&lt;?php echo strtoupper($nt); ?&gt;&lt;?php echo $ii; ?&gt;&quot; type=&quot;radio&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][catSel]&quot; &lt;?php if ((int)$options['catSel'] == 1) echo &quot;checked&quot;; ?&gt; /&gt; &lt;a href=&quot;#&quot; style=&quot;text-decoration: none;&quot; class=&quot;showCats&quot; id=&quot;nxs_SCA_&lt;?php echo strtoupper($nt); ?&gt;&lt;?php echo $ii; ?&gt;&quot; onclick=&quot;jQuery('#catSelS&lt;?php echo strtoupper($nt); ?&gt;&lt;?php echo $ii; ?&gt;').attr('checked', true); jQuery('#tmpCatSelNT').val('&lt;?php echo strtoupper($nt); ?&gt;&lt;?php echo $ii; ?&gt;'); nxs_markCats( jQuery('#nxs_SC_&lt;?php echo strtoupper($nt); ?&gt;&lt;?php echo $ii; ?&gt;').val() ); jQuery('#showCatSel').bPopup({ modalClose: false, appendTo: '#nsStForm', opacity: 0.6, follow: [false, false], position: [75, 'auto']}); return false;&quot;&gt;&lt;?php _e('Selected', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;?php if ($options['catSelEd']!='') echo &quot;[&quot;.(substr_count($options['catSelEd'], &quot;, &quot;)+1).&quot;]&quot;; ?&gt;&lt;/a&gt;       &nbsp;</div></li><li><div>     &lt;input type=&quot;hidden&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][catSelEd]&quot; id=&quot;nxs_SC_&lt;?php echo strtoupper($nt); ?&gt;&lt;?php echo $ii; ?&gt;&quot; value=&quot;&lt;?php echo $options['catSelEd']; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>  &lt;br/&gt;&lt;i&gt;&lt;?php _e('Only selected categories will be autoposted to this account', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/i&gt;&lt;/div&gt; &nbsp;</div></li><li><div>  &lt;br/&gt;&nbsp;</div></li><li><div>  &lt;div style=&quot;width:100%;&quot;&gt;&lt;strong&gt;&lt;?php _e('Tags and Custom Taxonomies', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;:&lt;/strong&gt;&nbsp;</div></li><li><div>     &lt;input name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][tagsSel]&quot; style=&quot;width: 30%;&quot; value=&quot;&lt;?php _e(apply_filters('format_to_edit', htmlentities($options['tagsSel'], ENT_COMPAT, &quot;UTF-8&quot;)), 'social-networks-auto-poster-facebook-twitter-g') ?&gt;&quot; /&gt;     &nbsp;</div></li><li><div>  &lt;br/&gt;&lt;i&gt;&lt;?php _e('Only posts with those tags assigned will be autoposted to this account, you can include custom taxonomy tags in taxonomy_slug|tag format.', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/i&gt;&lt;/div&gt; &nbsp;</div></li><li><div>  &lt;br/&gt;&nbsp;</div></li><li><div>  &lt;/div&gt; &lt;?php&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nxs_showRepostSettings($nt, $ii, $options) { global $nxs_snapAvNts, $nxs_plurl;   &nbsp;</div></li><li><div>if (empty($options['rpstPostIncl'])) $options['rpstPostIncl'] = 0; if (empty($options['rpstPostIncl'])) $options['rpstLastShTime'] = ''; if (empty($options['rpstNxTime'])) $options['rpstNxTime'] = '';&nbsp;</div></li><li><div>if (empty($options['rpstLastPostID'])) $options['rpstLastPostID'] = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>  &lt;div class=&quot;nxs_tls_cpt&quot;&gt;&nbsp;</div></li><li><div> &lt;?php _e('Auto Reposting', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;&nbsp;&lt;span class=&quot;nxsInstrSpan&quot;&gt;&lt;a href=&quot;http:<span class="comment">//www.nextscripts.com/snap-features/old-posts-auto-reposting/&quot; target=&quot;_blank&quot;&gt;&lt;?php _e('[Instructions]', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/a&gt; &nbsp;&nbsp; &lt;b style=&quot;color: darkred;&quot;&gt;Please note:&lt;/b&gt; This feature is depreciated, &lt;a href=&quot;http://www.nextscripts.com/blog/old-posts-reposting-no-longer-supported/&quot; target=&quot;_blank&quot;&gt;no longer supported&lt;/a&gt; and will be replaced with something much better in the upcoming ver 3.5 &lt;/span&gt;</span>&nbsp;</div></li><li><div> &lt;/div&gt;&nbsp;</div></li><li><div> &nbsp;</div></li><li><div> &lt;?php $cr = get_option('NXS_cronCheck'); if (!empty($cr) && is_array($cr) && isset($cr['status']) && $cr['status']=='0') { &nbsp;</div></li><li><div>    global $plgn_NS_SNAutoPoster; if (!isset($plgn_NS_SNAutoPoster)) return; $gOptions = $plgn_NS_SNAutoPoster-&gt;nxs_options; &nbsp;</div></li><li><div>     if (isset($gOptions['forceBrokenCron']) && $gOptions['forceBrokenCron'] =='1') { ?&gt; &nbsp;</div></li><li><div>       &lt;span style=&quot;color: red&quot;&gt; &lt;?php _e('Your WP Cron is not working correctly. Auto Reposting service is active by force. &lt;br/&gt; This might cause problems. Please see the test results and recommendations', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;</div></li><li><div>       &nbsp;-&nbsp;&lt;a target=&quot;_blank&quot; href=&quot;&lt;?php global $nxs_snapThisPageUrl; echo $nxs_snapThisPageUrl; ?&gt;&do=crtest&quot;&gt;WP Cron Test Results&lt;/a&gt;&lt;/span&gt;&nbsp;</div></li><li><div>      &lt;?php } else { ?&gt; &lt;span style=&quot;color: red&quot;&gt; &lt;?php _e('Auto Reposting service is Disabled. Your WP Cron is not working correctly. Please see the test results and recommendations', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;</div></li><li><div>   &nbsp;-&nbsp;&lt;a target=&quot;_blank&quot; href=&quot;&lt;?php global $nxs_snapThisPageUrl; echo $nxs_snapThisPageUrl; ?&gt;&do=crtest&quot;&gt;WP Cron Test Results&lt;/a&gt;&lt;/span&gt;&nbsp;</div></li><li><div> &lt;?php return; } } ?&gt;&nbsp;</div></li><li><div> &nbsp;</div></li><li><div> &nbsp;</div></li><li><div> &lt;div class=&quot;nxs_tls_bd&quot;&gt;&nbsp;</div></li><li><div>   &lt;div class=&quot;nxs_tls_sbInfo&quot;&gt;&lt;?php _e('Plugin could autorepost existing posts', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/div&gt;&nbsp;</div></li><li><div>   &lt;input value=&quot;1&quot;  id=&quot;riC&lt;?php echo $ii; ?&gt;&quot; &lt;?php if (isset($options['rpstOn']) && trim($options['rpstOn'])=='1') echo &quot;checked&quot;; ?&gt; type=&quot;checkbox&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstOn]&quot;/&gt; &nbsp;</div></li><li><div>     &lt;b&gt;&lt;?php _e('Repost existing posts every', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt; &lt;/b&gt;&nbsp;</div></li><li><div>   &nbsp;</div></li><li><div>   &lt;input type=&quot;text&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstDays]&quot; style=&quot;width: 35px;&quot; value=&quot;&lt;?php echo isset($options['rpstDays'])?$options['rpstDays']:'0'; ?&gt;&quot; /&gt;&nbsp;&lt;?php _e('Days', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;&nbsp;&nbsp;</div></li><li><div>   &lt;input type=&quot;text&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstHrs]&quot; style=&quot;width: 35px;&quot; value=&quot;&lt;?php echo isset($options['rpstHrs'])?$options['rpstHrs']:'2'; ?&gt;&quot; /&gt;&nbsp;&lt;?php _e('Hours', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;&nbsp;&nbsp;</div></li><li><div>   &lt;input type=&quot;text&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstMins]&quot; style=&quot;width: 35px;&quot; value=&quot;&lt;?php echo isset($options['rpstMins'])?$options['rpstMins']:'0'; ?&gt;&quot; /&gt;&nbsp;&lt;?php _e('Minutes', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;     &nbsp;</div></li><li><div>   &lt;div style=&quot;padding-left:10px;padding-top:10px;line-height:30px;&quot;&gt; &nbsp;</div></li><li><div>   &nbsp;</div></li><li><div>   &lt;b&gt;&lt;?php _e('Randomize posting time &#177;', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt; &lt;/b&gt;&nbsp;</div></li><li><div>   &lt;input type=&quot;text&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstRndMins]&quot; style=&quot;width: 35px;&quot; value=&quot;&lt;?php echo isset($options['rpstRndMins'])?$options['rpstRndMins']:'15'; ?&gt;&quot; onmouseout=&quot;hidePopShAtt('RPST1');&quot; onmouseover=&quot;showPopShAtt('RPST1', event);&quot; /&gt;&nbsp;&lt;?php _e('Minutes', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;</div></li><li><div>   &lt;br/&gt;     &nbsp;</div></li><li><div>   &lt;input value=&quot;1&quot;  id=&quot;riOC&lt;?php echo $ii; ?&gt;&quot; &lt;?php if (isset($options['rpstOnlyPUP']) && trim($options['rpstOnlyPUP'])=='1') echo &quot;checked&quot;; ?&gt; type=&quot;checkbox&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstOnlyPUP]&quot;/&gt; &nbsp;</div></li><li><div>     &lt;b&gt;&lt;?php _e('Repost ONLY previously unautoposted posts', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/b&gt;&nbsp;</div></li><li><div>   &lt;br/&gt;&nbsp;</div></li><li><div>   &lt;?php $args=array('public'=&gt;true, '_builtin'=&gt;false);  $output = 'names';  $operator = 'and';  $post_types = array(); &nbsp;</div></li><li><div>   if (function_exists('get_post_types')) $post_types=get_post_types($args, $output, $operator); &nbsp;</div></li><li><div>     if (!empty($post_types) && is_array($post_types)) { ?&gt;&nbsp;</div></li><li><div>   &lt;b&gt;&lt;?php _e('Repost: (Choose Posts, Pages, Custom Post Types)', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/b&gt;&nbsp;</div></li><li><div>   &lt;?php $post_typesIncl = array('post'=&gt;'post', 'page'=&gt;'page'); $post_types = array_merge($post_typesIncl, $post_types);    if ($options['nxsCPTSeld']=='a:1:{i:0;s:1:&quot;0&quot;;}') $options['nxsCPTSeld'] = '';&nbsp;</div></li><li><div>     if (!empty($options['nxsCPTSeld'])) $nxsCPTSeld = unserialize($options['nxsCPTSeld']); else $nxsCPTSeld = array('post');  &nbsp;</div></li><li><div>           ?&gt; &lt;div class=&quot;nxs_box_inside&quot; style=&quot;padding: 0px;&quot; &gt; &lt;div class=&quot;itemDiv&quot;  style=&quot;padding: 0px;&quot;&gt; &lt;div class=&quot;taxonomydiv&quot;&gt;&lt;div class=&quot;tabs-panel&quot; style=&quot;padding: 10px;&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;nxsCPTSeld[]&quot; value=&quot;0&quot; /&gt; &lt;?php <span class="comment">//prr($nxsCPTSeld); prr($post_types); prr($_POST['nxsCPTSeld']);              </span>&nbsp;</div></li><li><div>           foreach ($post_types as $cptID=&gt;$cptName) { if (in_array($cptID, $nxsCPTSeld)) $dCh = ' checked=&quot;checked&quot; '; else $dCh = &quot;&quot;;&nbsp;</div></li><li><div>            ?&gt;&lt;input type=&quot;checkbox&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][nxsCPTSeld][]&quot; value=&quot;&lt;?php echo esc_attr($cptID); ?&gt;&quot;&lt;?php echo $dCh ?&gt;&gt;&nbsp;&lt;?php echo $cptName ?&gt;&lt;br/&gt; &lt;?php&nbsp;</div></li><li><div>           }&nbsp;</div></li><li><div>    ?&gt;&lt;/div&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt;          &nbsp;</div></li><li><div>   &lt;?php } ?&gt;&nbsp;</div></li><li><div>   &lt;?php if (function_exists('nxs_doSMAS41')) nxs_doSMAS41($nt, $ii, $options); ?&gt;          &nbsp;</div></li><li><div>   &lt;b&gt;&lt;?php _e('Get posts', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/b&gt;&nbsp;</div></li><li><div>     &lt;select id=&quot;riS&lt;?php echo $nt; ?&gt;&lt;?php echo $ii; ?&gt;&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstType]&quot; onchange=&quot;nxs_actDeActTurnOff(jQuery(this).attr('id'));&quot;&gt;&lt;?php if (function_exists('nxs_doSMAS42')) nxs_doSMAS42($options); ?&gt;        &nbsp;</div></li><li><div>      &lt;option value=&quot;2&quot; &lt;?php  if (isset($options['rpstType']) && $options['rpstType']=='2') echo 'selected=&quot;selected&quot;' ?&gt;&gt;One By One - Old to New&lt;/option&gt;&lt;option value=&quot;3&quot; &lt;?php if (isset($options['rpstType']) && $options['rpstType']=='3') echo 'selected=&quot;selected&quot;' ?&gt;&gt;One By One - New to Old&lt;/option&gt;&nbsp;</div></li><li><div>      &lt;/select&gt; &nbsp;</div></li><li><div>    &lt;br/&gt; &nbsp;</div></li><li><div>    &lt;div style=&quot;padding-left: 15px;&quot;&gt;&nbsp;</div></li><li><div>    &lt;input type=&quot;radio&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstTimeType]&quot; value=&quot;D&quot; &lt;?php if (isset($options['rpstTimeType']) && $options['rpstTimeType']=='D') echo 'checked=&quot;checked&quot;'; ?&gt; /&gt;&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    &lt;?php _e('from', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;&lt;input type=&quot;text&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstFromTime]&quot; style=&quot;width: 75px;&quot; value=&quot;&lt;?php echo isset($options['rpstFromTime'])?$options['rpstFromTime']:''; ?&gt;&quot; /&gt;&nbsp;          &nbsp;</div></li><li><div>    &lt;?php _e('to', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;&lt;input type=&quot;text&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstToTime]&quot; style=&quot;width: 75px;&quot; value=&quot;&lt;?php echo isset($options['rpstToTime'])?$options['rpstToTime']:''; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>   &lt;br/&gt;&nbsp;</div></li><li><div>   &lt;input type=&quot;radio&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstTimeType]&quot; value=&quot;A&quot; &lt;?php if (!isset($options['rpstTimeType']) || $options['rpstTimeType']=='A') echo 'checked=&quot;checked&quot;'; ?&gt; /&gt;&nbsp;</div></li><li><div>   &lt;?php _e('Older then', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;&lt;input type=&quot;text&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstOLDays]&quot; style=&quot;width: 35px;&quot; value=&quot;&lt;?php  echo isset($options['rpstOLDays'])?$options['rpstOLDays']:'30'; ?&gt;&quot; /&gt;&nbsp;&lt;?php _e('Days', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;          &nbsp;</div></li><li><div>   &lt;?php _e('and Newer then', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;&lt;input type=&quot;text&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstNWDays]&quot; style=&quot;width: 35px;&quot; value=&quot;&lt;?php  echo isset($options['rpstNWDays'])?$options['rpstNWDays']:'365'; ?&gt;&quot; /&gt;&nbsp;&lt;?php _e('Days', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;     &nbsp;</div></li><li><div>   &lt;/div&gt;&nbsp;</div></li><li><div>   &lt;div id=&quot;riS&lt;?php echo $nt; ?&gt;&lt;?php echo $ii; ?&gt;xd&quot;  style=&quot;padding-left: 0px;&lt;?php if (isset($options['rpstType']) && $options['rpstType']=='1') echo &quot;display:none;&quot;; ?&gt;&quot;&gt;&lt;b&gt;&lt;?php _e('When finished', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;:&lt;/b&gt;       &nbsp;</div></li><li><div>       &lt;input type=&quot;radio&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstStop]&quot; value=&quot;O&quot; &lt;?php if (empty($options['rpstStop']) || (isset($options['rpstStop']) && trim($options['rpstStop'])=='O')) echo &quot;checked&quot;; ?&gt;  /&gt; &lt;?php _e('Auto Turn Reposting Off', 'social-networks-auto-poster-facebook-twitter-g') ?&gt;&nbsp;</div></li><li><div>       &nbsp;&nbsp;&nbsp;&nbsp;</div></li><li><div>       &lt;input type=&quot;radio&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstStop]&quot; value=&quot;W&quot; &lt;?php if (isset($options['rpstStop']) && trim($options['rpstStop'])=='W') echo 'checked=&quot;cheXcked&quot;'; ?&gt; /&gt; &lt;?php _e('Wait for new posts', 'social-networks-auto-poster-facebook-twitter-g') ?&gt;&nbsp;</div></li><li><div>       &nbsp;&nbsp;&nbsp;&nbsp;</div></li><li><div>       &lt;input type=&quot;radio&quot; name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstStop]&quot; value=&quot;R&quot; &lt;?php if (isset($options['rpstStop']) && trim($options['rpstStop'])=='R') echo 'checked=&quot;cheTcked&quot;'; ?&gt; /&gt; &lt;?php _e('Loop it. Reset and Start from the begining', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;</div></li><li><div>       &lt;/div&gt;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>   &lt;hr/&gt;&nbsp;</div></li><li><div>   &lt;strong style=&quot;font-size: 12px; margin: 10px; margin-left: 1px;&quot;&gt;New posts will be set by default to:&lt;/strong&gt;&nbsp;</div></li><li><div>           &lt;select name=&quot;&lt;?php echo $nt; ?&gt;[&lt;?php echo $ii; ?&gt;][rpstPostIncl]&quot;&gt;&lt;option &lt;?php echo !empty($options['rpstPostIncl'])?'selected=&quot;selected&quot;':''; ?&gt; value=&quot;nxsi&lt;?php echo $ii.$nt; ?&gt;&quot;&gt;Enabled for Repost&lt;/option&gt;&nbsp;</div></li><li><div>           &lt;option &lt;?php echo empty($options['rpstPostIncl'])?'selected=&quot;selected&quot;':''; ?&gt;  value=&quot;0&quot;&gt;Disabled for Repost&lt;/option&gt;&lt;/select&gt;&lt;br/&gt;&nbsp;</div></li><li><div>    &lt;div style=&quot;padding-left: 15px;&quot;&gt; &lt;img id=&quot;nxsLoadingImg&lt;?php echo $nt; ?&gt;&lt;?php echo $ii; ?&gt;&quot; style=&quot;display: none;&quot; src='&lt;?php echo $nxs_plurl; ?&gt;img/ajax-loader-sm.gif' /&gt;       &nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    &lt;?php      &nbsp;</div></li><li><div>      global $nxs_rpst_older, $nxs_rpst_newer, $nxs_rpst_lastID, $nxs_rpst_lastTime, $nxs_rpst_type, $nxs_rpst_code, $nxs_rpst_NT;  $ntOpts = $options;         &nbsp;</div></li><li><div>      $currTime = time() + ( get_option( 'gmt_offset' ) * HOUR_IN_SECONDS );&nbsp;</div></li><li><div>      if (!empty($ntOpts['nxsCPTSeld'])) $tpArray = maybe_unserialize($ntOpts['nxsCPTSeld']); else $tpArray = 'post';&nbsp;</div></li><li><div>      if ($ntOpts['rpstType']=='1') $args = array ( 'orderby' =&gt; 'rand', 'posts_per_page' =&gt; '1', 'post_type' =&gt; $tpArray, 'ignore_sticky_posts' =&gt; 1, 'post_status' =&gt; 'publish', 'suppress_filters' =&gt; false ); &nbsp;</div></li><li><div>      if ($ntOpts['rpstType']=='2') $args = array ( 'posts_per_page' =&gt; '1', 'orderby' =&gt; 'date ID', 'order'=&gt;'ASC', 'post_type' =&gt; $tpArray, 'post_status' =&gt; 'publish', 'suppress_filters' =&gt; false );&nbsp;</div></li><li><div>      if ($ntOpts['rpstType']=='3') $args = array ( 'posts_per_page' =&gt; '1', 'orderby' =&gt; 'date ID', 'order'=&gt;'DESC', 'post_type' =&gt; $tpArray, 'post_status' =&gt; 'publish', 'suppress_filters' =&gt; false );                   &nbsp;</div></li><li><div>      $rpstToTime = strtotime($ntOpts['rpstToTime']); if ($currTime &lt; $rpstToTime) $rpstToTime = $currTime;&nbsp;</div></li><li><div>      $rpstFromTime = strtotime($ntOpts['rpstFromTime']); if ($currTime &lt; $rpstFromTime) $rpstFromTime = $currTime;&nbsp;</div></li><li><div>      if ($ntOpts['rpstTimeType']=='D') { $nxs_rpst_older = ceil(abs($currTime - $rpstToTime) / 86400); $nxs_rpst_newer = ceil(abs($currTime - $rpstFromTime) / 86400);                   &nbsp;</div></li><li><div>        } else { $nxs_rpst_older = $ntOpts['rpstOLDays']; $nxs_rpst_newer = $ntOpts['rpstNWDays']; } $ggg = $ntOpts['rpstType']=='1'?'Random':($ntOpts['rpstType']=='3'?'New to Old':'Old to New');&nbsp;</div></li><li><div>      if ($nxs_rpst_newer&gt;5000) $nxs_rpst_newer = 5000;  if ($nxs_rpst_newer&lt;$nxs_rpst_older) $nxs_rpst_older = 0;                 &nbsp;</div></li><li><div>      $nxs_rpst_code = 'nxsi'.$ii.$nt; $nxs_rpst_NT = strtoupper($nt);&nbsp;</div></li><li><div>      add_filter( 'posts_join' , 'nxs_custom_posts_join');&nbsp;</div></li><li><div>      if (isset($ntOpts['rpstOnlyPUP']) && trim($ntOpts['rpstOnlyPUP'])=='1')  {  add_filter( 'posts_where', 'nxs_filter_where_only' ); }&nbsp;</div></li><li><div>      add_filter( 'posts_where', 'nxs_filter_where' ); $query = new WP_Query( $args ); remove_filter( 'posts_where', 'filter_where' ); &nbsp;</div></li><li><div>      echo &quot;Total posts included in reposting: &quot;.$query-&gt;found_posts;      &nbsp;</div></li><li><div>    ?&gt;&lt;br/&gt;&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>   &lt;?php _e('Set All Existing Posts to: ', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;</div></li><li><div>   &nbsp;&nbsp;&lt;span class=&quot;nxsInstrSpan&quot;&gt;&lt;a href=&quot;#&quot; onclick=&quot;nxs_setRpstAll('&lt;?php echo $nt; ?&gt;', '1', '&lt;?php echo $ii; ?&gt;'); return false;&quot;&gt;&lt;?php _e('[Enabled for Repost]', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/a&gt; &lt;/span&gt;&nbsp;</div></li><li><div>   &nbsp;&nbsp;&lt;span class=&quot;nxsInstrSpan&quot;&gt;&lt;a href=&quot;#&quot; onclick=&quot;nxs_setRpstAll('&lt;?php echo $nt; ?&gt;', '0', '&lt;?php echo $ii; ?&gt;'); return false;&quot;&gt;&lt;?php _e('[Disabled for Repost]', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/a&gt; &lt;/span&gt;        &nbsp;</div></li><li><div>   &nbsp;&nbsp;&lt;span class=&quot;nxsInstrSpan&quot;&gt;&lt;a href=&quot;#&quot; onclick=&quot;nxs_setRpstAll('&lt;?php echo $nt; ?&gt;', '2', '&lt;?php echo $ii; ?&gt;'); return false;&quot;&gt;&lt;?php _e('[Enabled/Disabled for Repost according to Categories/Tags/Taxonomies filters]', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/a&gt; &lt;/span&gt;        &nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>   &lt;/div&gt;&lt;hr/&gt;&nbsp;</div></li><li><div>   &lt;b&gt;&lt;?php _e('Last post', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/b&gt;&nbsp;(ID:&nbsp;&lt;?php echo !empty($options['rpstLastPostID'])?$options['rpstLastPostID']:''; ?&gt;)&nbsp;&lt;b&gt;&lt;?php _e('was re-posted on:', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/b&gt;&nbsp;&lt;?php echo $options['rpstLastShTime']&gt;0?date_i18n('Y-m-d H:i', $options['rpstLastShTime']):'Never'; ?&gt;&nbsp;</div></li><li><div>      &nbsp;&nbsp;&lt;b&gt;&lt;?php _e('Next post will be ~', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/b&gt;&nbsp;&lt;?php echo $options['rpstNxTime']&gt;0?date_i18n('Y-m-d H:i', $options['rpstNxTime']):'Never'; ?&gt; &lt;==&nbsp;</div></li><li><div>      &nbsp;&nbsp;&lt;span class=&quot;nxsInstrSpan&quot;&gt;&lt;a href=&quot;#&quot; onclick=&quot;nxs_setRpstAll('&lt;?php echo $nt; ?&gt;', 'X', '&lt;?php echo $ii; ?&gt;'); return false;&quot;&gt;&lt;?php _e('[Reset]', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/a&gt; &lt;/span&gt;&nbsp;</div></li><li><div>   &lt;br/&gt;&nbsp;</div></li><li><div>   &lt;b&gt;&lt;?php _e('Set &quot;Last re-posted post ID&quot; to:', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&nbsp;&lt;input type=&quot;text&quot; id=&quot;&lt;?php echo $nt; ?&gt;&lt;?php echo $ii; ?&gt;SetLPID&quot; style=&quot;width: 65px;&quot; value=&quot;&lt;?php echo $options['rpstLastPostID']; ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>   &nbsp;&nbsp;&lt;span class=&quot;nxsInstrSpan&quot;&gt;&lt;a href=&quot;#&quot; onclick=&quot;nxs_setRpstAll('&lt;?php echo $nt; ?&gt;', 'L', '&lt;?php echo $ii; ?&gt;'); return false;&quot;&gt;&lt;?php _e('[Set]', 'social-networks-auto-poster-facebook-twitter-g'); ?&gt;&lt;/a&gt; &lt;/span&gt;&lt;/b&gt;&nbsp;</div></li><li><div>   &lt;/div&gt;      &nbsp;</div></li><li><div> &lt;/div&gt;      &nbsp;</div></li><li><div>  &lt;?php &nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>function nxs_custom_posts_join($join) { global $wpdb; $join .= &quot; LEFT JOIN $wpdb-&gt;postmeta ON $wpdb-&gt;posts.ID = $wpdb-&gt;postmeta.post_id &quot;; return $join;}&nbsp;</div></li><li><div>function nxs_filter_where_only( $where = '' ) { global $wpdb; $where .= &quot; AND ($wpdb-&gt;postmeta.meta_key = 'snap_isAutoPosted' AND $wpdb-&gt;postmeta.meta_value = '1') &quot;; return $where; }&nbsp;</div></li><li><div>function nxs_filter_where( $where = '' ) { global $wpdb, $nxs_rpst_older, $nxs_rpst_newer, $nxs_rpst_lastID, $nxs_rpst_lastTime, $nxs_rpst_type, $nxs_rpst_typeONLY, $nxs_rpst_code, $nxs_rpst_NT; &nbsp;</div></li><li><div>  $where .= &quot; AND post_date &gt; '&quot; . date_i18n('Y-m-d', strtotime('-'.$nxs_rpst_newer.' days')) . &quot; 00:00:00'&quot; . &quot; AND post_date &lt; '&quot; . date_i18n('Y-m-d', strtotime('-'.$nxs_rpst_older.' days')) . &quot; 23:59:59'&quot;;    &nbsp;</div></li><li><div>  $where .= &quot; AND ($wpdb-&gt;postmeta.meta_key = 'snap&quot;.$nxs_rpst_NT.&quot;' AND $wpdb-&gt;postmeta.meta_value LIKE '%&quot;.$nxs_rpst_code.&quot;%') &quot;;&nbsp;</div></li><li><div>  if ($nxs_rpst_type=='2' && $nxs_rpst_lastID!='') $where .= &quot; AND ( (post_date = '&quot;.$nxs_rpst_lastTime.&quot;' && ID &gt; &quot;.$nxs_rpst_lastID.&quot; ) || post_date &gt; '&quot;.$nxs_rpst_lastTime.&quot;' )&quot;;&nbsp;</div></li><li><div>  if ($nxs_rpst_type=='3' && $nxs_rpst_lastID!='') $where .= &quot; AND ( (post_date = '&quot;.$nxs_rpst_lastTime.&quot;' && ID &lt; &quot;.$nxs_rpst_lastID.&quot; ) || post_date &lt; '&quot;.$nxs_rpst_lastTime.&quot;' )&quot;;&nbsp;</div></li><li><div>  if ($nxs_rpst_typeONLY) $where .= &quot; AND ($wpdb-&gt;postmeta.meta_key = 'snap_isAutoPosted' AND $wpdb-&gt;postmeta.meta_value = '1') &quot;;&nbsp;</div></li><li><div>  return $where; &nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nxs_rePoster() { global $nxs_snapAvNts, $plgn_NS_SNAutoPoster, $nxs_rpst_older, $nxs_rpst_newer, $nxs_rpst_lastID, $nxs_rpst_lastTime, $nxs_rpst_type, $nxs_rpst_code, $nxs_rpst_NT;   &nbsp;</div></li><li><div>if (!isset($plgn_NS_SNAutoPoster)) return; $options = $plgn_NS_SNAutoPoster-&gt;nxs_options;  $rpstBtwHrsF = 0; $rpstBtwHrsT = 0;&nbsp;</div></li><li><div>$currTime = time() + ( get_option( 'gmt_offset' ) * HOUR_IN_SECONDS );  $hasChanged = false;   &nbsp;</div></li><li><div><span class="comment">// if (stripos($_SERVER[&quot;REQUEST_URI&quot;], 'wp-cron.php')!==false) nxs_addToLogN('A', 'NXSPoster - Cron', $logNT, '-=Time=- '.$ret. &quot;ERR: &quot;.$currTime, $extInfo);</span>&nbsp;</div></li><li><div>if (stripos($_SERVER[&quot;REQUEST_URI&quot;], 'wp-cron.php')===false) return false; $warn = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>foreach ($nxs_snapAvNts as $avNt) {&nbsp;</div></li><li><div>  if (isset($options[$avNt['lcode']]) && is_array($options[$avNt['lcode']]) && count($options[$avNt['lcode']])&gt;0) { &nbsp;</div></li><li><div>      foreach ($options[$avNt['lcode']] as $ii=&gt;$ntOpts) { $logNT = '&lt;span style=&quot;color:#800000&quot;&gt;'.$avNt['name'].'&lt;/span&gt; - '.(isset($ntOpts['nName'])?$ntOpts['nName']:'');      &nbsp;</div></li><li><div>        if (isset($ntOpts['rpstOn']) && $ntOpts['rpstOn']=='1') {    &nbsp;</div></li><li><div>          <span class="comment">//## </span>Calculate Times&nbsp;</div></li><li><div>          $lastTime = (isset($ntOpts['rpstLastShTime']) && (int)$ntOpts['rpstLastShTime']&gt;0 )?$ntOpts['rpstLastShTime']:$currTime;&nbsp;</div></li><li><div>          $rpstEvrySec = $ntOpts['rpstDays']*86400+$ntOpts['rpstHrs']*3600+$ntOpts['rpstMins']*60; $rndSec = $ntOpts['rpstRndMins']*60;&nbsp;</div></li><li><div>          $nxTime = (isset($ntOpts['rpstNxTime']) && (int)$ntOpts['rpstNxTime']&gt;0)?$ntOpts['rpstNxTime']:$currTime+$rpstEvrySec;  &nbsp;</div></li><li><div>          <span class="comment">//## </span>First time? Set the options and get out. &nbsp;</div></li><li><div>          if (empty($ntOpts['rpstLastShTime'])) {  $ntOpts['rpstLastShTime'] = $currTime; $ntOpts['rpstNxTime'] = $lastTime + $rpstEvrySec + rand(0-$rndSec, $rndSec); &nbsp;</div></li><li><div>            $options[$avNt['lcode']][$ii] = $ntOpts; update_option($plgn_NS_SNAutoPoster-&gt;dbOptionsName, $options); $plgn_NS_SNAutoPoster-&gt;nxs_options = $options;  &nbsp;</div></li><li><div>             nxs_addToLogN('S', 'RE-Poster', $logNT, 'Initialization - First post will be: '.date_i18n('Y-m-d H:i:s', $ntOpts['rpstNxTime']), $extInfo); continue; &nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          <span class="comment">//## </span>Is it time to post?&nbsp;</div></li><li><div>          if ($nxTime &lt; $currTime) {  $times =  &quot;Requested Time: &quot;.date_i18n('Y-m-d H:i:s', $nxTime).&quot; | Current Time:&quot;.date_i18n('Y-m-d H:i:s', $currTime).&quot; | &quot;; &nbsp;</div></li><li><div>            <span class="comment">//## </span>Check if WP Cron is healthy   &nbsp;</div></li><li><div>            if ($warn) { $cr = get_option('NXS_cronCheck'); $warn = false; if (!empty($cr) && is_array($cr) && isset($cr['status']) && $cr['status']=='0') { global $nxs_snapThisPageUrl;     &nbsp;</div></li><li><div>              if (isset($options['forceBrokenCron']) && $options['forceBrokenCron'] =='1') &nbsp;</div></li><li><div>                nxs_addToLogN('W', 'Re-Poster is active by force. This could cause problems.', $logNT, 'Please see ', '&lt;a target=&quot;_blank&quot; href=&quot;'.$nxs_snapThisPageUrl.'&do=crtest&quot;&gt;WP Cron Test Results&lt;/a&gt;|'.$times); &nbsp;</div></li><li><div>              else { nxs_addToLogN('W', 'Re-Poster is Disabled', $logNT, 'Please see ', '&lt;a target=&quot;_blank&quot; href=&quot;'.$nxs_snapThisPageUrl.'&do=crtest&quot;&gt;WP Cron Test Results&lt;/a&gt;|'.$times); return; }&nbsp;</div></li><li><div>            }} &nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            if (!isset($ntOpts['rpstNxTime']) || (int)$ntOpts['rpstNxTime']&lt;1) $ntOpts['rpstNxTime'] = 0; <span class="comment">//prr($ntOpts);            </span>&nbsp;</div></li><li><div>            <span class="comment">//## </span>Check if Day or Hour is excluded&nbsp;</div></li><li><div>            if (isset($ntOpts['rpstBtwHrsType']) && $ntOpts['rpstBtwHrsType']=='D') { &nbsp;</div></li><li><div>              <span class="comment">//## </span>Check Days&nbsp;</div></li><li><div>              if (isset($ntOpts['rpstBtwDays']) && count($ntOpts['rpstBtwDays'])&gt;0 ) $rpstBtwDays = $ntOpts['rpstBtwDays']; else $rpstBtwDays = array();            &nbsp;</div></li><li><div>              if (is_array($rpstBtwDays) && count($rpstBtwDays)&gt;0) { $currDay = (int)date_i18n('w'); if (!(in_array($currDay, $rpstBtwDays))) { <span class="comment">// echo &quot;D :( &quot;;</span>&nbsp;</div></li><li><div>                nxs_addToLogN('S', 'RE-Poster', $logNT, 'Skipped - Excluded Day - '.$currDay, $extInfo);  continue;  &nbsp;</div></li><li><div>              }}&nbsp;</div></li><li><div>              <span class="comment">//## </span>Check Hours&nbsp;</div></li><li><div>              if (isset($ntOpts['rpstBtwHrsF']) && (int)$ntOpts['rpstBtwHrsF']&gt;0) $rpstBtwHrsF = (int)$ntOpts['rpstBtwHrsF']; else $rpstBtwHrsF = 0;&nbsp;</div></li><li><div>              if (isset($ntOpts['rpstBtwHrsT']) && (int)$ntOpts['rpstBtwHrsT']&gt;0) $rpstBtwHrsT = (int)$ntOpts['rpstBtwHrsT'];&nbsp;</div></li><li><div>              if ($rpstBtwHrsT&gt;0) { $currHour = (int)date_i18n('H', $currTime);  <span class="comment">//echo &quot;H &quot;.$currHour.&quot; ?&quot;;</span>&nbsp;</div></li><li><div>              if ( !( ($rpstBtwHrsF&lt;$rpstBtwHrsT && $currHour&lt;$rpstBtwHrsT && $currHour&gt;=$rpstBtwHrsF) || ($rpstBtwHrsF&gt;$rpstBtwHrsT && $currHour&lt;$rpstBtwHrsF && $currHour&gt;=$rpstBtwHrsT) )) {  <span class="comment">//echo &quot;H :( &quot;;</span>&nbsp;</div></li><li><div>                nxs_addToLogN('S', 'RE-Poster', $logNT, 'Skipped - Excluded Hour - '.$currHour, $extInfo);  continue;  &nbsp;</div></li><li><div>              }}&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            <span class="comment">//## </span>Do Post                &nbsp;</div></li><li><div>            $hasChanged = true; $nxs_rpst_type = $ntOpts['rpstType'];&nbsp;</div></li><li><div>            $nxs_rpst_lastID = (isset($ntOpts['rpstLastPostID']) && (int)$ntOpts['rpstLastPostID']&gt;0)?$ntOpts['rpstLastPostID']:($ntOpts['rpstType']=='3'?'90000000':'0');&nbsp;</div></li><li><div>            $nxs_rpst_lastTime = (!empty($ntOpts['rpstLastPostTime']) && $ntOpts['rpstLastPostTime']!='2050-12-12' && $ntOpts['rpstLastPostTime']!='1975-01-01')?$ntOpts['rpstLastPostTime']:($ntOpts['rpstType']=='3'?'2050-12-12':'1975-01-01');&nbsp;</div></li><li><div>            if (!empty($ntOpts['nxsCPTSeld'])) $tpArray = maybe_unserialize($ntOpts['nxsCPTSeld']); else $tpArray = 'post';&nbsp;</div></li><li><div>            <span class="comment">//nxs_addToLogN('S', 'pTypes', $logNT, print_r($tpArray, true), $extInfo); // $tpArray = array('post', 'location');</span>&nbsp;</div></li><li><div>            if ($ntOpts['rpstType']=='1') $args = array ( 'orderby' =&gt; 'rand', 'posts_per_page' =&gt; '1', 'post_type' =&gt; $tpArray, 'ignore_sticky_posts' =&gt; 1, 'post_status' =&gt; 'publish', 'suppress_filters' =&gt; false ); &nbsp;</div></li><li><div>            if ($ntOpts['rpstType']=='2') $args = array ( 'posts_per_page' =&gt; '1', 'orderby' =&gt; 'date ID', 'order'=&gt;'ASC', 'post_type' =&gt; $tpArray, 'post_status' =&gt; 'publish', 'suppress_filters' =&gt; false );&nbsp;</div></li><li><div>            if ($ntOpts['rpstType']=='3') $args = array ( 'posts_per_page' =&gt; '1', 'orderby' =&gt; 'date ID', 'order'=&gt;'DESC', 'post_type' =&gt; $tpArray, 'post_status' =&gt; 'publish', 'suppress_filters' =&gt; false );                   &nbsp;</div></li><li><div>            <span class="comment">//## </span>Get Post for Reposting&nbsp;</div></li><li><div>            <span class="comment">//   nxs_addToLogN('S', 'pTypes- ARG', $logNT, print_r($args, true), $extInfo);</span>&nbsp;</div></li><li><div>            $rpstToTime = strtotime($ntOpts['rpstToTime']); if ($currTime &lt; $rpstToTime) $rpstToTime = $currTime;  $rpstFromTime = strtotime($ntOpts['rpstFromTime']); if ($currTime &lt; $rpstFromTime) $rpstFromTime = $currTime;&nbsp;</div></li><li><div>            if ($ntOpts['rpstTimeType']=='D') { $nxs_rpst_older = ceil(abs($currTime - $rpstToTime) / 86400); &nbsp;</div></li><li><div>              $nxs_rpst_newer = ceil(abs($currTime - $rpstFromTime) / 86400);                   &nbsp;</div></li><li><div>            } else { $nxs_rpst_older = $ntOpts['rpstOLDays']; $nxs_rpst_newer = $ntOpts['rpstNWDays']; } $ggg = $ntOpts['rpstType']=='1'?'Random':($ntOpts['rpstType']=='3'?'New to Old':'Old to New');&nbsp;</div></li><li><div>            if ($nxs_rpst_newer&gt;5000) $nxs_rpst_newer = 5000;  if ($nxs_rpst_newer&lt;$nxs_rpst_older) $nxs_rpst_older = 0;&nbsp;</div></li><li><div>              $nxs_rpst_code = 'nxsi'.$ii.$avNt['lcode']; $nxs_rpst_NT = strtoupper($avNt['lcode']);&nbsp;</div></li><li><div>              add_filter( 'posts_join' , 'nxs_custom_posts_join');&nbsp;</div></li><li><div>              if (isset($ntOpts['rpstOnlyPUP']) && trim($ntOpts['rpstOnlyPUP'])=='1')  {  add_filter( 'posts_where', 'nxs_filter_where_only' ); }&nbsp;</div></li><li><div>              add_filter( 'posts_where', 'nxs_filter_where' ); $query = new WP_Query( $args ); remove_filter( 'posts_where', 'filter_where' ); <span class="comment">// $extInfo = print_r($query, true);                   </span>&nbsp;</div></li><li><div>                 &nbsp;</div></li><li><div>              $rpstLastPostID = $query-&gt;posts[0]-&gt;ID;  $rpstLastPostTime = $query-&gt;posts[0]-&gt;post_date;  $ntOpts['rpstLastPostTime'] =  ($rpstLastPostTime!='')?$rpstLastPostTime:($ntOpts['rpstType']=='3'?'1985-01-01':'2050-12-12');&nbsp;</div></li><li><div>              $extInfo = &quot; | Reposting (&lt;b&gt;&quot;.$ggg.&quot;&lt;/b&gt;) POST ID:&quot;.$rpstLastPostID. &quot; | Total posts included in reposting: &quot;.$query-&gt;found_posts.&quot; | Prev Post ID:&quot;.$nxs_rpst_lastID .&quot; | &quot;.($options['extDebug']=='1'?&quot;|Query: &quot;.print_r($query-&gt;request, true):'');&nbsp;</div></li><li><div>                 &nbsp;</div></li><li><div>              <span class="comment">//echo &quot;&lt;br/&gt;\r\n&quot;.$rpstEvrySec.&quot;&lt;br/&gt;\r\n&quot;;</span>&nbsp;</div></li><li><div>              $ntOpts['rpstLastShTime'] = $currTime; $rndTime = rand(0-$rndSec, $rndSec); $ntOpts['rpstNxTime'] = $lastTime + $rpstEvrySec*2 + $rndTime;  &nbsp;</div></li><li><div>              if ((int)$rpstLastPostID&lt;1) {  &nbsp;</div></li><li><div>                $extInfo = &quot; | Reposting (&lt;b&gt;&quot;.$ggg.&quot;&lt;/b&gt;) | Total posts included in reposting: &quot;.$query-&gt;found_posts.&quot; | &quot;.($options['extDebug']=='1'?&quot;|Query: &quot;.print_r($query-&gt;request, true):'');                      &nbsp;</div></li><li><div>                if ($ntOpts['rpstType']=='1') nxs_addToLogN('S', 'Random Re-Posting - Nothing to post', $logNT, $times.'| Last Time:'.date_i18n('Y-m-d H:i:s', $lastTime).' RND Time: '.$rndTime.' - Next Time - '.date_i18n('Y-m-d H:i:s', $ntOpts['rpstNxTime']).&quot;)&quot;, $extInfo);&nbsp;</div></li><li><div>                else { if (!isset($ntOpts['rpstStop']) || (isset($ntOpts['rpstStop']) && trim($ntOpts['rpstStop'])=='O')) { $ntOpts['rpstOn']='0';  &nbsp;</div></li><li><div>                    nxs_addToLogN('S', 'RE-Posting', $logNT, 'End of Query - Turning Auto-Reposting Off - '.$times.' | Last Time:'.date_i18n('Y-m-d H:i:s', $lastTime).' Next Time - '.date_i18n('Y-m-d H:i:s', $ntOpts['rpstNxTime']).&quot;)&quot;, $extInfo);&nbsp;</div></li><li><div>                  } elseif ( trim($ntOpts['rpstStop'])=='W') &nbsp;</div></li><li><div>                    nxs_addToLogN('S', 'RE-Posting', $logNT, '(Waiting mode is ON) &lt;b&gt;Nothing to Repost.&lt;/b&gt; | '.$times.' | Last Time:'.date_i18n('Y-m-d H:i:s', $lastTime).' Next Time - '.date_i18n('Y-m-d H:i:s', $ntOpts['rpstNxTime']).&quot;)&quot;, $extInfo);&nbsp;</div></li><li><div>                  elseif ( trim($ntOpts['rpstStop'])=='R') { $ntOpts['rpstLastPostID'] = ($ntOpts['rpstType']=='3'?'90000000':'0');&nbsp;</div></li><li><div>                    nxs_addToLogN('S', 'RE-Posting', $logNT, '(&lt;b&gt;Nothing to Repost.&lt;/b&gt; - End of Query - &lt;b&gt;Resetting&lt;b&gt;)  | '.$times.' | Last Time:'.date_i18n('Y-m-d H:i:s', $lastTime).' Next Time - '.date_i18n('Y-m-d H:i:s', $ntOpts['rpstNxTime']).&quot;)&quot;, $extInfo);                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>              } else { $ntOpts['rpstLastPostID'] = $rpstLastPostID;                                      &nbsp;</div></li><li><div>                <span class="comment">//## </span>Actual Post                     &nbsp;</div></li><li><div>                $clName = 'nxs_snapClass'.strtoupper($avNt['lcode']); $pFuncName = 'nxs_doPublishTo'.strtoupper($avNt['lcode']);                     &nbsp;</div></li><li><div>                $po =  get_post_meta($rpstLastPostID, 'snap'.strtoupper($avNt['lcode']), true); $po =  maybe_unserialize($po); &nbsp;</div></li><li><div>                $ntClInst = new $clName(); $ntOpts['ii'] = $ii; $ntOpts['pType'] = 'aj'; $ntOptsPost = $ntClInst-&gt;adjMetaOpt($ntOpts, $po[$ii]); &nbsp;</div></li><li><div>                if ($options['extDebug']=='1') $extInfo .= &quot;&lt;br/&gt;&lt;br/&gt;NT OPTS: &quot;.print_r($ntOptsPost, true);  if ($options['extDebug']=='1') $extInfo .= &quot;ARGS: &lt;br/&gt;&lt;br/&gt;&quot;.print_r($args, true);&nbsp;</div></li><li><div>                $result = $pFuncName($rpstLastPostID, $ntOptsPost); <span class="comment">//if ($result == 200) die(&quot;Successfully sent your post to App.Net.&quot;); else die($result);                          </span>&nbsp;</div></li><li><div>                nxs_addToLogN('S', 'RE-Posting', $logNT, 'OK  | '.$times.' | Previous Time:'.date_i18n('Y-m-d H:i:s', $lastTime).'| Next Shedulled Time - '.date_i18n('Y-m-d H:i:s', $ntOpts['rpstNxTime']).&quot;)&lt;br/&gt;&quot;, $extInfo);&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>            } $options[$avNt['lcode']][$ii] = $ntOpts; <span class="comment">// prr($ntOpts);</span>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }      &nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>} if ($hasChanged) { update_option($plgn_NS_SNAutoPoster-&gt;dbOptionsName, $options); $plgn_NS_SNAutoPoster-&gt;nxs_options = $options; }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nxs_chckBrwsr() { $isOK = false; if (empty($_SERVER['HTTP_USER_AGENT'])) return true;&nbsp;</div></li><li><div>if (preg_match('/MSIE/i', $_SERVER['HTTP_USER_AGENT'])) $isOK = true;    if (preg_match('/Internet Explorer/i', $_SERVER['HTTP_USER_AGENT'])) $isOK = true;&nbsp;</div></li><li><div>if (preg_match('/Firefox/i', $_SERVER['HTTP_USER_AGENT'])) $isOK = true; if (preg_match('/Opera/i', $_SERVER['HTTP_USER_AGENT'])) $isOK = true;&nbsp;</div></li><li><div>if (preg_match('/Chrome/i', $_SERVER['HTTP_USER_AGENT'])) $isOK = true;  if (preg_match('/Safari/i', $_SERVER['HTTP_USER_AGENT'])) $isOK = true;&nbsp;</div></li><li><div>if (preg_match('/(up.browser|up.link|mmp|symbian|smartphone|midp|wap|phone)/i', strtolower($_SERVER['HTTP_USER_AGENT'])) || (!empty($_SERVER['HTTP_ACCEPT']) && strpos(strtolower($_SERVER['HTTP_ACCEPT']), 'application/vnd.wap.xhtml+xml')&gt;0) or ((isset($_SERVER['HTTP_X_WAP_PROFILE']) or isset($_SERVER['HTTP_PROFILE'])))) $isOK = false;&nbsp;</div></li><li><div>return $isOK;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//## </span>NXS Cron&nbsp;</div></li><li><div>if (!function_exists(&quot;nxs_psCron&quot;)) { function nxs_psCron() { if (!is_home() && !is_front_page()) return; if (nxs_chckBrwsr()==false) return;    &nbsp;</div></li><li><div> <span class="comment">//if (stripos($_SERVER[&quot;REQUEST_URI&quot;], 'admin-ajax.php')!==false || stripos($_SERVER[&quot;REQUEST_URI&quot;], 'cf_action')!==false || stripos($_SERVER[&quot;REQUEST_URI&quot;], 'wp-cron.php')!==false) return;   </span>&nbsp;</div></li><li><div> $ltc = get_option('NSX_LastTChecked'); if (empty($ltc)) { add_option(&quot;NSX_LastTChecked&quot;, time()); return; } if (time()&lt;$ltc+300) return;  $sh =_get_cron_array();  $itmsToPush = array();   &nbsp;</div></li><li><div> if (is_array($sh)) foreach ($sh as $evTime =&gt; $evDataX) if (is_array($evDataX)) foreach ($evDataX as $evFunc=&gt;$evData) if (strpos($evFunc, 'ns_doPublishTo')!==false) { $chkTime = rand(360, 600); <span class="comment">//$chkTime = rand(5, 7);</span>&nbsp;</div></li><li><div>   if ($evTime&gt;'1359495839' && $evTime&lt;time()-$chkTime) $itmsToPush[] = array('time'=&gt;$evTime);&nbsp;</div></li><li><div> } if (count($itmsToPush)&lt;1) return;  &nbsp;</div></li><li><div> <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> $snapIP = get_post_meta($toPush['args'][0], 'snap_mp_'.$toPush['func'], true); </span>&nbsp;</div></li><li><div><span class="comment"> nxs_addToLogN('S', 'Missed Scheduled Autoposts Found', '', ' - ('.$evTime.&quot;&lt;&quot;.(time()-$chkTime).') - Trying to Post', '');</span>&nbsp;</div></li><li><div><span class="comment"> delete_post_meta(); add_post_meta($toPush['args'][0], 'snap_mp_'.$toPush['func'], (time()+300));</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div> update_option(&quot;NSX_LastTChecked&quot;, time());&nbsp;</div></li><li><div> $cron_url = site_url('wp-cron.php?doing_wp_cron=0'); ?&gt;&lt;script type=&quot;text/javascript&quot; &gt; jQuery(document).ready(function($) { jQuery.get('&lt;?php echo $cron_url; ?&gt;'); }); &lt;/script&gt;&lt;?php <span class="comment">// die();</span>&nbsp;</div></li><li><div> return true;         &nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists(&quot;nxs_addToRI&quot;)) { function nxs_addToRI($postID) { global $plgn_NS_SNAutoPoster;  if (!isset($plgn_NS_SNAutoPoster)) return; $options = $plgn_NS_SNAutoPoster-&gt;nxs_options;&nbsp;</div></li><li><div>$riPosts = get_option('NS_SNriPosts'); if (!is_array($riPosts)) $riPosts = array();  $options['riHowManyPostsToTrack'] =  (int) $options['riHowManyPostsToTrack'];  if ($options['riHowManyPostsToTrack']==0) return;&nbsp;</div></li><li><div>array_unshift($riPosts, $postID);  $riPosts = array_unique($riPosts); $riPosts = array_slice($riPosts, 0, $options['riHowManyPostsToTrack']); update_option('NS_SNriPosts', $riPosts);&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nxs_activation() { if (!wp_next_scheduled('nxs_hourly_event')) {wp_schedule_event(time(), 'hourly', 'nxs_hourly_event');} if (!wp_next_scheduled('nxs_querypost_event')) {wp_schedule_event(time(), 'nxsreposter', 'nxs_querypost_event');}  }&nbsp;</div></li><li><div>function nxs_do_this_hourly() {  $options = get_option('NS_SNAutoPoster');   &nbsp;</div></li><li><div>if (isset($options['errNotifEmailCB']) && (int)$options['errNotifEmailCB'] == 1 && isset($options['errNotifEmail']) && trim($options['errNotifEmail']) != '') { $logToSend = maybe_unserialize(get_option('NSX_LogToEmail')); <span class="comment">// echo &quot;SSS&quot;; </span>&nbsp;</div></li><li><div><span class="comment">//  prr($logToSend);</span>&nbsp;</div></li><li><div>  if (is_array($logToSend) && count($logToSend)&gt;0) { $to = $options['errNotifEmail']; $subject = &quot;SNAP Error Log for &quot;.$_SERVER[&quot;SERVER_NAME&quot;]; $message = print_r($logToSend, true);&nbsp;</div></li><li><div>    $eml = get_bloginfo('admin_email'); if (trim($eml)=='') $eml = &quot;snap-notify@&quot;.str_ireplace('www.', '', $_SERVER[&quot;SERVER_NAME&quot;]); &nbsp;</div></li><li><div>    $headers = &quot;From: &quot; . $eml . &quot;\r\n&quot;; $headers .= &quot;Reply-To: &quot;. $eml . &quot;\r\n&quot;; $headers .= &quot;MIME-Version: 1.0\r\n&quot;;&nbsp;</div></li><li><div>    $headers .= &quot;Content-Type: text/html; charset=ISO-8859-1\r\n&quot;; $retval = wp_mail($to, $subject, $message, $headers); echo ($to .&quot;|&quot;. $subject.&quot;|&quot;. $message.&quot;|&quot;. $headers);&nbsp;</div></li><li><div>    if ($retval == true) nxs_addToLogN( 'S', 'Log sent to email '.$options['errNotifEmail'], 'ALL', count($logToSend).' records sent', '');  &nbsp;</div></li><li><div>      else nxs_addToLogN( 'ER', '[FALIED] Log sent to email '.$options['errNotifEmail'], 'ALL', count($logToSend).' records were NOT sent', '');  &nbsp;</div></li><li><div>    delete_option(&quot;NSX_LogToEmail&quot;);  &nbsp;</div></li><li><div>}}  &nbsp;</div></li><li><div>$riPosts = get_option('NS_SNriPosts'); if (!is_array($riPosts)) $riPosts = array(); <span class="comment">//## </span>Check for Incoming Comments if nessesary.  &nbsp;</div></li><li><div>if ($options['riActive'] != 1 || count($riPosts)&lt;1 ) return;&nbsp;</div></li><li><div>if (isset($options['extDebug']) && $options['extDebug']=='1') nxs_addToLogN( 'S', 'Comments Import', 'ALL', 'Checking for new comments now...', print_r($riPosts, true));&nbsp;</div></li><li><div><span class="comment">//## </span>Facebook&nbsp;</div></li><li><div>if (is_array($options['fb'])) foreach ($options['fb'] as $ii=&gt;$fbo) if ($fbo['riComments']=='1') {  $fbo['ii'] = $ii; $fbo['pType'] = 'aj';&nbsp;</div></li><li><div>  foreach ($riPosts as $postID) {  &nbsp;</div></li><li><div>    $fbpo =  get_post_meta($postID, 'snapFB', true); $fbpo =  maybe_unserialize($fbpo); &nbsp;</div></li><li><div>    if (is_array($fbpo) && isset($fbpo[$ii]) && is_array($fbpo[$ii]) && isset($fbpo[$ii]['pgID']) && trim($fbpo[$ii]['pgID'])!='') { &nbsp;</div></li><li><div>        $ntClInst = new nxs_snapClassFB(); $fbo = $ntClInst-&gt;adjMetaOpt($fbo, $fbpo[$ii]);  nxs_getBackFBComments($postID, $fbo, $fbpo[$ii]);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>  }      &nbsp;</div></li><li><div>}   &nbsp;</div></li><li><div><span class="comment">//## </span>Twitter&nbsp;</div></li><li><div>if (is_array($options['tw'])) foreach ($options['tw'] as $ii=&gt;$fbo) if ($fbo['riComments']=='1') {  $fbo['ii'] = $ii; $fbo['pType'] = 'aj'; $twList = nxs_getBackTWCommentsList($fbo); &nbsp;</div></li><li><div>  foreach ($riPosts as $postID) {  &nbsp;</div></li><li><div>    $fbpo =  get_post_meta($postID, 'snapTW', true); $fbpo =  maybe_unserialize($fbpo); &nbsp;</div></li><li><div>    if (is_array($fbpo) && isset($fbpo[$ii]) && is_array($fbpo[$ii])  && isset($fbpo[$ii]['pgID']) && trim($fbpo[$ii]['pgID'])!='') { &nbsp;</div></li><li><div>       $ntClInst = new nxs_snapClassTW(); $fbo = $ntClInst-&gt;adjMetaOpt($fbo, $fbpo[$ii]); nxs_getBackTWComments($postID, $fbo, $fbpo[$ii], $twList);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>  }      &nbsp;</div></li><li><div>} &nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (!function_exists('nxsClnCookies')) { function nxsClnCookies($ck) { $ckOut = array(); $t =time(); foreach ($ck as $c) { if ($c-&gt;value!='deleted' && $c-&gt;value!='deleteMe' && $c-&gt;value!='delete me' && (empty($c-&gt;expires) || $c-&gt;expires&gt;$t)) $ckOut[] = $c; } return $ckOut; }}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//#### V3 new Query Poster</span>&nbsp;</div></li><li><div>function nxs_addToPostingQuery($postID) { global $plgn_NS_SNAutoPoster; if (!isset($plgn_NS_SNAutoPoster)) return; $options = $plgn_NS_SNAutoPoster-&gt;nxs_options; &nbsp;</div></li><li><div>$quPosts = maybe_unserialize(get_option('NSX_PostsQuery')); if (!is_array($quPosts)) $quPosts = array();  &nbsp;</div></li><li><div>if (!in_array($postID, $quPosts)) $quPosts[] = $postID; update_option('NSX_PostsQuery', $quPosts);    &nbsp;</div></li><li><div><span class="comment">//## </span>Update Next Post time&nbsp;</div></li><li><div>$currTime = time() + 10 + ( get_option( 'gmt_offset' ) * HOUR_IN_SECONDS ); $nxTime = !empty($options['quNxTime'])?$options['quNxTime']:0;&nbsp;</div></li><li><div>if (empty($nxTime) || $nxTime &lt; $currTime) { $options['quNxTime'] = $currTime; update_option('NS_SNAutoPoster', $options);  $plgn_NS_SNAutoPoster-&gt;nxs_options = $options; }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>function nxs_do_post_from_query() { nxs_cron_check(); <span class="comment">// nxs_addToLogN('A', 'Debug info only. - Cron Time', 'X', '', $extInfo);      </span>&nbsp;</div></li><li><div>if (stripos($_SERVER[&quot;REQUEST_URI&quot;], 'wp-cron.php')!==false) nxs_rePoster(); <span class="comment">//## </span>Run Reposter.&nbsp;</div></li><li><div>$options = get_option('NS_SNAutoPoster'); $quPosts = maybe_unserialize(get_option('NSX_PostsQuery')); if (!is_array($quPosts)) $quPosts = array();&nbsp;</div></li><li><div>if ($options['quLimit'] != '1' || count($quPosts)&lt;1) return;  $currTime = time() + ( get_option( 'gmt_offset' ) * HOUR_IN_SECONDS );  $hasChanged = false; &nbsp;</div></li><li><div>$postToPost = array_shift($quPosts);   &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$pstEvrySec = $options['quDays']*86400+$options['quHrs']*3600+$options['quMins']*60; $rndSec = $options['quLimitRndMins']*60;  &nbsp;</div></li><li><div>$nxTime = !empty($options['quNxTime'])?$options['quNxTime']:$currTime+$pstEvrySec; &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>$extInfo = 'Query Time:'.date_i18n('Y-m-d H:i:s', $options['quNxTime']).&quot;|Previous Time:&quot;.date_i18n('Y-m-d H:i:s', $options['quLastShTime']);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if (empty($options['quNxTime']) || $nxTime &lt; $currTime) $hasChanged = true;  <span class="comment">// Do Post  </span>&nbsp;</div></li><li><div>     &nbsp;</div></li><li><div>if ($hasChanged) { <span class="comment">//## </span>Do Post     &nbsp;</div></li><li><div>  nxs_addToLogN('A', '**POST STARTED** NXSPoster - WP CRON - Post from Query - Post ID: '.$postToPost, '', 'Curr Time: '.date_i18n('Y-m-d H:i:s', $currTime).'~', $extInfo);        &nbsp;</div></li><li><div>  $options['quLastShTime'] = $currTime; $rndTime = rand(0-$rndSec, $rndSec); $options['quNxTime'] = $currTime + $pstEvrySec + $rndTime;    &nbsp;</div></li><li><div>  if ($options['nxsOverLimit']=='D') { $dateC = date(&quot;d&quot;); $dayN = date(&quot;d&quot;, $nxTime); if ($dayN!=$dateC) $quPosts = array(); }    &nbsp;</div></li><li><div>  update_option('NSX_PostsQuery', $quPosts);  update_option('NS_SNAutoPoster', $options);    &nbsp;</div></li><li><div>  nxs_snapPublishTo($postToPost, '', true);      &nbsp;</div></li><li><div>  nxs_addToLogN('A', '**POST FINISHED** NXSPoster - WP CRON - Post from Query - Post ID: '.$postToPost, '', '-=Time=- '.$currTime, $extInfo); &nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>class NXS_HtmlFixer { public $dirtyhtml; public $fixedhtml; public $allowed_styles; private $matrix; public $debug; private $fixedhtmlDisplayCode;&nbsp;</div></li><li><div>  public function __construct() { $this-&gt;dirtyhtml = &quot;&quot;; $this-&gt;fixedhtml = &quot;&quot;; $this-&gt;debug = false; $this-&gt;fixedhtmlDisplayCode = &quot;&quot;; $this-&gt;allowed_styles = array();}&nbsp;</div></li><li><div>  public function getFixedHtml($dirtyhtml) { $c = 0; $this-&gt;dirtyhtml = $dirtyhtml; $this-&gt;fixedhtml = &quot;&quot;; $this-&gt;fixedhtmlDisplayCode = &quot;&quot;; if (is_array($this-&gt;matrix)) unset($this-&gt;matrix); $errorsFound=0;&nbsp;</div></li><li><div>    while ($c&lt;10) { if ($c&gt;0) $this-&gt;dirtyhtml = $this-&gt;fixedxhtml; $errorsFound = $this-&gt;charByCharJob(); if (!$errorsFound) $c=10;  $this-&gt;fixedxhtml=str_replace('&lt;root&gt;', '', $this-&gt;fixedxhtml); &nbsp;</div></li><li><div>      $this-&gt;fixedxhtml=str_replace('&lt;/root&gt;', '', $this-&gt;fixedxhtml); $this-&gt;fixedxhtml = $this-&gt;removeSpacesAndBadTags($this-&gt;fixedxhtml); $c++;&nbsp;</div></li><li><div>    } return $this-&gt;fixedxhtml;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  private function fixStrToLower($m) { $right = strstr($m, '='); $left = str_replace($right, '', $m); return strtolower($left).$right;}&nbsp;</div></li><li><div>  private function fixQuotes($s) { $q = &quot;\&quot;&quot;; if (!stristr($s, &quot;=&quot;)) return $s; $out = $s; preg_match_all(&quot;|=(.*)|&quot;, $s, $o, PREG_PATTERN_ORDER);&nbsp;</div></li><li><div>    for ($i = 0; $i&lt; count ($o[1]); $i++) { $t = trim ( $o[1][$i] ) ; $lc=&quot;&quot;; if ($t!=&quot;&quot;) { if ($t[strlen($t)-1]==&quot;&gt;&quot;) { $lc= ($t[strlen($t)-2].$t[strlen($t)-1])==&quot;/&gt;&quot;  ?  &quot;/&gt;&quot;  :  &quot;&gt;&quot; ; $t=substr($t, 0, -1);}&nbsp;</div></li><li><div>      if (($t[0]!=&quot;\&quot;&quot;)&&($t[0]!=&quot;'&quot;)) $out = str_replace( $t, &quot;\&quot;&quot;.$t, $out); else $q=$t[0]; if (($t[strlen($t)-1]!=&quot;\&quot;&quot;)&&($t[strlen($t)-1]!=&quot;'&quot;)) $out = str_replace( $t.$lc, $t.$q.$lc, $out);&nbsp;</div></li><li><div>    }} return $out;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  private function fixTag($t) {  $t = preg_replace ( array( '/borderColor=([^ &gt;])*/i', '/border=([^ &gt;])*/i' ), array('', ''), $t);&nbsp;</div></li><li><div>      preg_match_all('/(?:&quot;[^&quot;]*&quot;|\'[^\']*\'|[^&quot;\'\s]+)+/', $t, $ar);  $ar = $ar[0];<span class="comment">// prr($ar);</span>&nbsp;</div></li><li><div>      $nt = &quot;&quot;; for ($i=0;$i&lt;count($ar);$i++) { if (strpos($ar[$i], 'href=\\\\\\&quot;')!==false) {$ar[$i] = str_replace('\\\\\\&quot;', '&quot;', $ar[$i]);}&nbsp;</div></li><li><div>        if (strpos($ar[$i], 'href=\\&quot;')!==false) {$ar[$i] = str_replace('\\&quot;', '&quot;', $ar[$i]);} if (strpos($ar[$i], 'href=\&quot;')!==false) {$ar[$i] = str_replace('\&quot;', '&quot;', $ar[$i]);}&nbsp;</div></li><li><div>        $ar[$i]=$this-&gt;fixStrToLower($ar[$i]); if (stristr($ar[$i], &quot;=&quot;)) $ar[$i] = $this-&gt;fixQuotes($ar[$i]); $nt.=$ar[$i].&quot; &quot;;   &nbsp;</div></li><li><div>      } $nt=preg_replace(&quot;/&lt;( )*/i&quot;, &quot;&lt;&quot;, $nt); $nt=preg_replace(&quot;/( )*&gt;/i&quot;, &quot;&gt;&quot;, $nt); return trim($nt);&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  private function extractChars($tag1, $tag2, $tutto) {  if (!stristr($tutto, $tag1)) return ''; $s=stristr($tutto, $tag1); $s=substr( $s, strlen($tag1)); if (!stristr($s, $tag2)) return '';&nbsp;</div></li><li><div>      $s1=stristr($s, $tag2); return substr($s, 0, strlen($s)-strlen($s1));&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  private function mergeStyleAttributes($s) { $x = &quot;&quot;; $temp = &quot;&quot;; $c = 0;&nbsp;</div></li><li><div>      while(stristr($s, &quot;style=\&quot;&quot;)) {$temp = $this-&gt;extractChars(&quot;style=\&quot;&quot;, &quot;\&quot;&quot;, $s); if ($temp==&quot;&quot;) { return preg_replace(&quot;/(\/)?&gt;/i&quot;, &quot;\&quot;\\1&gt;&quot;, $s);}&nbsp;</div></li><li><div>          if ($c==0) $s = str_replace(&quot;style=\&quot;&quot;.$temp.&quot;\&quot;&quot;, &quot;##PUTITHERE##&quot;, $s); $s = str_replace(&quot;style=\&quot;&quot;.$temp.&quot;\&quot;&quot;, &quot;&quot;, $s); if (!preg_match(&quot;/;$/i&quot;, $temp)) $temp.=&quot;;&quot;; $x.=$temp; $c++;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if (count($this-&gt;allowed_styles)&gt;0) { $check=explode(';', $x); $x=&quot;&quot;; foreach($check as $chk) { foreach($this-&gt;allowed_styles as $as) if(stripos($chk, $as) !== False) { $x.=$chk.';'; break; } }}&nbsp;</div></li><li><div>      if ($c&gt;0) $s = str_replace(&quot;##PUTITHERE##&quot;, &quot;style=\&quot;&quot;.$x.&quot;\&quot;&quot;, $s);return $s;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  private function fixAutoclosingTags($tag, $tipo=&quot;&quot;) { if (in_array( $tipo, array (&quot;img&quot;, &quot;input&quot;, &quot;br&quot;, &quot;hr&quot;)) ) { if (!stristr($tag, '/&gt;')) $tag = str_replace('&gt;', '/&gt;', $tag ); } return $tag; }&nbsp;</div></li><li><div>  private function getTypeOfTag($tag) { $tag = trim(preg_replace(&quot;/[\&gt;\&lt;\/]/i&quot;, &quot;&quot;, $tag)); $a = explode(&quot; &quot;, $tag); return $a[0];}&nbsp;</div></li><li><div>  private function checkTree() { $errorsCounter = 0; for ($i=1;$i&lt;count($this-&gt;matrix);$i++) { $flag=false;&nbsp;</div></li><li><div>    if ($this-&gt;matrix[$i][&quot;tagType&quot;]==&quot;div&quot;) { $parentType = $this-&gt;matrix[$this-&gt;matrix[$i][&quot;parentTag&quot;]][&quot;tagType&quot;]; if (in_array($parentType, array(&quot;p&quot;, &quot;b&quot;, &quot;i&quot;, &quot;font&quot;, &quot;u&quot;, &quot;small&quot;, &quot;strong&quot;, &quot;em&quot;))) $flag=true; }&nbsp;</div></li><li><div>    if (in_array( $this-&gt;matrix[$i][&quot;tagType&quot;], array( &quot;b&quot;, &quot;strong&quot; )) ) {  $parentType = $this-&gt;matrix[$this-&gt;matrix[$i][&quot;parentTag&quot;]][&quot;tagType&quot;]; if (in_array($parentType, array(&quot;b&quot;, &quot;strong&quot;))) $flag=true; }&nbsp;</div></li><li><div>    if (in_array( $this-&gt;matrix[$i][&quot;tagType&quot;], array ( &quot;i&quot;, &quot;em&quot;) )) {  $parentType = $this-&gt;matrix[$this-&gt;matrix[$i][&quot;parentTag&quot;]][&quot;tagType&quot;]; if (in_array($parentType, array(&quot;i&quot;, &quot;em&quot;))) $flag=true; }&nbsp;</div></li><li><div>    if ($this-&gt;matrix[$i][&quot;tagType&quot;]==&quot;p&quot;) { $parentType = $this-&gt;matrix[$this-&gt;matrix[$i][&quot;parentTag&quot;]][&quot;tagType&quot;]; if (in_array($parentType, array(&quot;p&quot;, &quot;b&quot;, &quot;i&quot;, &quot;font&quot;, &quot;u&quot;, &quot;small&quot;, &quot;strong&quot;, &quot;em&quot;))) $flag=true; }&nbsp;</div></li><li><div>    if ($this-&gt;matrix[$i][&quot;tagType&quot;]==&quot;table&quot;) { $parentType = $this-&gt;matrix[$this-&gt;matrix[$i][&quot;parentTag&quot;]][&quot;tagType&quot;]; if (in_array($parentType, array(&quot;p&quot;, &quot;b&quot;, &quot;i&quot;, &quot;font&quot;, &quot;u&quot;, &quot;small&quot;, &quot;strong&quot;, &quot;em&quot;, &quot;tr&quot;, &quot;table&quot;))) $flag=true; }&nbsp;</div></li><li><div>    if ($flag) { $errorsCounter++; if ($this-&gt;debug) echo &quot;&lt;div style='color:#ff0000'&gt;Found a &lt;b&gt;&quot;.$this-&gt;matrix[$i][&quot;tagType&quot;].&quot;&lt;/b&gt; tag inside a &lt;b&gt;&quot;.htmlspecialchars($parentType).&quot;&lt;/b&gt; tag at node $i: MOVED&lt;/div&gt;&quot;;                &nbsp;</div></li><li><div>      $swap = $this-&gt;matrix[$this-&gt;matrix[$i][&quot;parentTag&quot;]][&quot;parentTag&quot;]; if ($this-&gt;debug) echo &quot;&lt;div style='color:#ff0000'&gt;Every node that has parent &quot;.$this-&gt;matrix[$i][&quot;parentTag&quot;].&quot; will have parent &quot;.$swap.&quot;&lt;/div&gt;&quot;;&nbsp;</div></li><li><div>      $this-&gt;matrix[$this-&gt;matrix[$i][&quot;parentTag&quot;]][&quot;tag&quot;]=&quot;&lt;!-- T A G \&quot;&quot;.$this-&gt;matrix[$this-&gt;matrix[$i][&quot;parentTag&quot;]][&quot;tagType&quot;].&quot;\&quot; R E M O V E D --&gt;&quot;; $this-&gt;matrix[$this-&gt;matrix[$i][&quot;parentTag&quot;]][&quot;tagType&quot;]=&quot;&quot;;&nbsp;</div></li><li><div>      $hoSpostato=0;for ($j=count($this-&gt;matrix)-1;$j&gt;=$i;$j--) { if ($this-&gt;matrix[$j][&quot;parentTag&quot;]==$this-&gt;matrix[$i][&quot;parentTag&quot;]) { $this-&gt;matrix[$j][&quot;parentTag&quot;] = $swap; $hoSpostato=1; }}&nbsp;</div></li><li><div>    }}return $errorsCounter;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  private function findSonsOf($parentTag) { $out= &quot;&quot;;&nbsp;</div></li><li><div>    for ($i=1;$i&lt;count($this-&gt;matrix);$i++) { if ($this-&gt;matrix[$i][&quot;parentTag&quot;]==$parentTag) {&nbsp;</div></li><li><div>        if ($this-&gt;matrix[$i][&quot;tag&quot;]!=&quot;&quot;) { $out.=$this-&gt;matrix[$i][&quot;pre&quot;]; $out.=$this-&gt;matrix[$i][&quot;tag&quot;]; $out.=$this-&gt;matrix[$i][&quot;post&quot;]; } else { $out.=$this-&gt;matrix[$i][&quot;pre&quot;]; $out.=$this-&gt;matrix[$i][&quot;post&quot;];}&nbsp;</div></li><li><div>        if ($this-&gt;matrix[$i][&quot;tag&quot;]!=&quot;&quot;) { $out.=$this-&gt;findSonsOf($i); if ($this-&gt;matrix[$i][&quot;tagType&quot;]!=&quot;&quot;) { if (!in_array($this-&gt;matrix[$i][&quot;tagType&quot;], array ( &quot;br&quot;, &quot;img&quot;, &quot;hr&quot;, &quot;input&quot;))) $out.=&quot;&lt;/&quot;. $this-&gt;matrix[$i][&quot;tagType&quot;].&quot;&gt;&quot;;}}&nbsp;</div></li><li><div>    }}return $out;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  private function findSonsOfDisplayCode($parentTag) { $out= &quot;&quot;;&nbsp;</div></li><li><div>      for ($i=1;$i&lt;count($this-&gt;matrix);$i++) {&nbsp;</div></li><li><div>          if ($this-&gt;matrix[$i][&quot;parentTag&quot;]==$parentTag) { $out.= &quot;&lt;div style=\&quot;padding-left:15\&quot;&gt;&lt;span style='float:left;background-color:#FFFF99;color:#000;'&gt;{$i}:&lt;/span&gt;&quot;;&nbsp;</div></li><li><div>              if ($this-&gt;matrix[$i][&quot;tag&quot;]!=&quot;&quot;) { if ($this-&gt;matrix[$i][&quot;pre&quot;]!=&quot;&quot;) $out.=htmlspecialchars($this-&gt;matrix[$i][&quot;pre&quot;]).&quot;&lt;br&gt;&quot;;&nbsp;</div></li><li><div>                  $out.=&quot;&quot;.htmlspecialchars($this-&gt;matrix[$i][&quot;tag&quot;]).&quot;&lt;span style='background-color:red; color:white'&gt;{$i} &lt;em&gt;&quot;.$this-&gt;matrix[$i][&quot;tagType&quot;].&quot;&lt;/em&gt;&lt;/span&gt;&quot;;&nbsp;</div></li><li><div>                  $out.=htmlspecialchars($this-&gt;matrix[$i][&quot;post&quot;]);&nbsp;</div></li><li><div>              } else { if ($this-&gt;matrix[$i][&quot;pre&quot;]!=&quot;&quot;) $out.=htmlspecialchars($this-&gt;matrix[$i][&quot;pre&quot;]).&quot;&lt;br&gt;&quot;; $out.=htmlspecialchars($this-&gt;matrix[$i][&quot;post&quot;]);}&nbsp;</div></li><li><div>              if ($this-&gt;matrix[$i][&quot;tag&quot;]!=&quot;&quot;) { $out.=&quot;&lt;div&gt;&quot;.$this-&gt;findSonsOfDisplayCode($i).&quot;&lt;/div&gt;\n&quot;;&nbsp;</div></li><li><div>                  if ($this-&gt;matrix[$i][&quot;tagType&quot;]!=&quot;&quot;) {&nbsp;</div></li><li><div>                      if (($this-&gt;matrix[$i][&quot;tagType&quot;]!=&quot;br&quot;) && ($this-&gt;matrix[$i][&quot;tagType&quot;]!=&quot;img&quot;) && ($this-&gt;matrix[$i][&quot;tagType&quot;]!=&quot;hr&quot;)&& ($this-&gt;matrix[$i][&quot;tagType&quot;]!=&quot;input&quot;))&nbsp;</div></li><li><div>                          $out.=&quot;&lt;div style='color:red'&gt;&quot;.htmlspecialchars(&quot;&lt;/&quot;. $this-&gt;matrix[$i][&quot;tagType&quot;].&quot;&gt;&quot;).&quot;{$i} &lt;em&gt;&quot;.$this-&gt;matrix[$i][&quot;tagType&quot;].&quot;&lt;/em&gt;&lt;/div&gt;&quot;;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              } $out.=&quot;&lt;/div&gt;\n&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }return $out;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  private function removeSpacesAndBadTags($s) { $i=0;&nbsp;</div></li><li><div>    while ($i&lt;10) { $i++; $s = preg_replace (&nbsp;</div></li><li><div>      array( '/  /i', '/&lt;p([^&gt;])*&gt;(&nbsp;)*\s*&lt;\/p&gt;/i', '/&lt;span([^&gt;])*&gt;(&nbsp;)*\s*&lt;\/span&gt;/i', '/&lt;strong([^&gt;])*&gt;(&nbsp;)*\s*&lt;\/strong&gt;/i', '/&lt;em([^&gt;])*&gt;(&nbsp;)*\s*&lt;\/em&gt;/i', &nbsp;</div></li><li><div>        '/&lt;font([^&gt;])*&gt;(&nbsp;)*\s*&lt;\/font&gt;/i', '/&lt;small([^&gt;])*&gt;(&nbsp;)*\s*&lt;\/small&gt;/i', '/&lt;\?xml:namespace([^&gt;])*&gt;&lt;\/\?xml:namespace&gt;/i', '/&lt;\?xml:namespace([^&gt;])*\/&gt;/i', '/class=\&quot;MsoNormal\&quot;/i', &nbsp;</div></li><li><div>        '/&lt;o:p&gt;&lt;\/o:p&gt;/i', '/&lt;!DOCTYPE([^&gt;])*&gt;/i', '/&lt;!--(.|\s)*?--&gt;/', '/&lt;\?(.|\s)*?\?&gt;/'), &nbsp;</div></li><li><div>      array(' ', ' ', '', '', '', '', '', '', '', '', '', ' ', '', '' ) , trim($s));&nbsp;</div></li><li><div>    }return $s;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  private function charByCharJob() { $s = $this-&gt;removeSpacesAndBadTags($this-&gt;dirtyhtml); if ($s==&quot;&quot;) return; <span class="comment">//echo &quot;\r\n=!= &quot;.$s.&quot; =!=\r\n&lt;br/&gt;\r\n&quot;;</span>&nbsp;</div></li><li><div>      $s = &quot;&lt;root&gt;&quot;.$s.&quot;&lt;/root&gt;&quot;; $contenuto = &quot;&quot;; $ns = &quot;&quot;; $i=0; $j=0; $ss=''; $indexparentTag=0; $padri=array(); array_push($padri, &quot;0&quot;); $this-&gt;matrix[$j][&quot;tagType&quot;]=&quot;&quot;;&nbsp;</div></li><li><div>      $this-&gt;matrix[$j][&quot;tag&quot;]=&quot;&quot;; $this-&gt;matrix[$j][&quot;parentTag&quot;]=&quot;0&quot;; $this-&gt;matrix[$j][&quot;pre&quot;]=&quot;&quot;; $this-&gt;matrix[$j][&quot;post&quot;]=&quot;&quot;; $tags=array();&nbsp;</div></li><li><div>      <span class="comment">// echo &quot;\r\n=#= &quot;.$s.&quot; =#=\r\n&lt;br/&gt;\r\n&quot;;</span>&nbsp;</div></li><li><div>      while($i&lt;strlen($s)) {&nbsp;</div></li><li><div>          if ( $s[$i] ==&quot;&lt;&quot;) { $contenuto = $ns; $ns = &quot;&quot;; $tag=&quot;&quot;; while( $i&lt;strlen($s) && $s[$i]!=&quot;&gt;&quot; ) { $tag.=$s[$i]; $i++;} $tag.=$s[$i]; if (stristr($tag, '&lt;param') && stristr($tag, '/&gt;')) $tag = str_replace('/&gt;', '&gt;&lt;/param&gt;', $tag);&nbsp;</div></li><li><div>          $ss .= $tag;                 &nbsp;</div></li><li><div>      } else $ss .= $s[$i]; $i++; }&nbsp;</div></li><li><div>      $i=0; $s = $ss; <span class="comment">//echo &quot;\r\n== &quot;.$s.&quot; ==\r\n&lt;br/&gt;\r\n&quot;;</span>&nbsp;</div></li><li><div>      while($i&lt;strlen($s)) {&nbsp;</div></li><li><div>          if ( $s[$i] ==&quot;&lt;&quot;) { $contenuto = $ns; $ns = &quot;&quot;; $tag=&quot;&quot;; while( $i&lt;strlen($s) && $s[$i]!=&quot;&gt;&quot; ) { $tag.=$s[$i]; $i++;} $tag.=$s[$i];                &nbsp;</div></li><li><div>              if($s[$i]==&quot;&gt;&quot;) { $tag = $this-&gt;fixTag($tag); $tagType = $this-&gt;getTypeOfTag($tag); $tag = $this-&gt;fixAutoclosingTags($tag, $tagType);&nbsp;</div></li><li><div>                  $tag = $this-&gt;mergeStyleAttributes($tag); if (!isset($tags[$tagType])) $tags[$tagType]=0; $tagok=true;&nbsp;</div></li><li><div>                  if (($tags[$tagType]==0)&&(stristr($tag, '/'.$tagType.'&gt;'))&&(stristr($tag, '&lt;'.$tagType)!==false)) { $tagok=false; if ($this-&gt;debug) echo &quot;&lt;div style='color:#ff0000'&gt;Found a closing tag &lt;b&gt;&quot;.htmlspecialchars($tag).&quot;&lt;/b&gt; at char $i without open tag: REMOVED&lt;/div&gt;&quot;;} else $tagok=true;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>              if ($tagok) { $j++; $this-&gt;matrix[$j][&quot;pre&quot;]=&quot;&quot;; $this-&gt;matrix[$j][&quot;post&quot;]=&quot;&quot;; $this-&gt;matrix[$j][&quot;parentTag&quot;]=&quot;&quot;; $this-&gt;matrix[$j][&quot;tag&quot;]=&quot;&quot;; $this-&gt;matrix[$j][&quot;tagType&quot;]=&quot;&quot;;&nbsp;</div></li><li><div>                  if (stristr($tag, '/'.$tagType.'&gt;')) { $ind = array_pop($padri); $this-&gt;matrix[$j][&quot;post&quot;]=$contenuto; $this-&gt;matrix[$j][&quot;parentTag&quot;]=$ind; $tags[$tagType]--;&nbsp;</div></li><li><div>                  } else { if (@preg_match(&quot;/&quot;.$tagType.&quot;\/&gt;$/i&quot;, $tag)||preg_match(&quot;/\/&gt;/i&quot;, $tag)) { $this-&gt;matrix[$j][&quot;tagType&quot;]=$tagType; $this-&gt;matrix[$j][&quot;tag&quot;]=$tag;&nbsp;</div></li><li><div>                    $indexparentTag = array_pop($padri); array_push($padri, $indexparentTag); $this-&gt;matrix[$j][&quot;parentTag&quot;]=$indexparentTag; $this-&gt;matrix[$j][&quot;pre&quot;]=$contenuto; $this-&gt;matrix[$j][&quot;post&quot;]=&quot;&quot;;&nbsp;</div></li><li><div>                  } else { $tags[$tagType]++; $this-&gt;matrix[$j][&quot;tagType&quot;]=$tagType; $this-&gt;matrix[$j][&quot;tag&quot;]=$tag; $indexparentTag = array_pop($padri); array_push($padri, $indexparentTag);&nbsp;</div></li><li><div>                    array_push($padri, $j); $this-&gt;matrix[$j][&quot;parentTag&quot;]=$indexparentTag; $this-&gt;matrix[$j][&quot;pre&quot;]=$contenuto; $this-&gt;matrix[$j][&quot;post&quot;]=&quot;&quot;; }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          } else { $ns.=$s[$i]; } $i++;&nbsp;</div></li><li><div>      } for ($eli=$j+1;$eli&lt;count($this-&gt;matrix);$eli++) { $this-&gt;matrix[$eli][&quot;pre&quot;]=&quot;&quot;; $this-&gt;matrix[$eli][&quot;post&quot;]=&quot;&quot;; $this-&gt;matrix[$eli][&quot;parentTag&quot;]=&quot;&quot;; $this-&gt;matrix[$eli][&quot;tag&quot;]=&quot;&quot;; $this-&gt;matrix[$eli][&quot;tagType&quot;]=&quot;&quot;;}&nbsp;</div></li><li><div>      $errorsCounter = $this-&gt;checkTree();  $this-&gt;fixedxhtml=$this-&gt;findSonsOf(0);return $errorsCounter;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">//## </span>parse_str() implementation - max_vars fix.&nbsp;</div></li><li><div>if (!function_exists(&quot;NXS_doSetArrRecursive&quot;)) { function NXS_doSetArrRecursive(&$array, $path, $value) { $key = array_shift($path); <span class="comment">//prr($path); prr($key); echo &quot;|-&quot;; prr($array); echo &quot;-|&quot;;</span>&nbsp;</div></li><li><div>if (empty($path)) if (trim($key)=='')  $array[] = $value;  else  $array[$key] = $value; else { if (!isset($array[$key]) || !is_array($array[$key])) $array[$key] = array(); NXS_doSetArrRecursive($array[$key], $path, $value); }&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists(&quot;NXS_parseQueryStr&quot;)) { function NXS_parseQueryStr($url) { $tokens = explode(&quot;&&quot;, $url); $urlVars = array();&nbsp;</div></li><li><div>foreach ($tokens as $token) { $token = urldecode($token); $value = NXS_parseEQStr($token, &quot;=&quot;, &quot;&quot;); &nbsp;</div></li><li><div>  if (preg_match('/^([^\[]*)(\[.*\])$/', $token, $matches)) { if (preg_match_all('/\[([^\]]*)\]/', $matches[2], $matches2)) $gg = $matches2[1]; array_unshift($gg, $matches[1]); NXS_doSetArrRecursive($urlVars, $gg, $value);} &nbsp;</div></li><li><div>    else $urlVars[$token] = $value;&nbsp;</div></li><li><div>} return $urlVars;&nbsp;</div></li><li><div>}}&nbsp;</div></li><li><div>if (!function_exists(&quot;NXS_parseEQStr&quot;)) { function NXS_parseEQStr(&$a, $delim='.', $default=false) { $n = strpos($a, $delim); if ($n === false) return $default; $result = substr($a, $n+strlen($delim)); $a = substr($a, 0, $n); return $result;}}&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>NextScripts: Social Networks Auto-Poster</li><li><span></span>3.4.31</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>