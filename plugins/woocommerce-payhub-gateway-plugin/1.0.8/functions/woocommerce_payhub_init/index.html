<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr function lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr function lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr function lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr function ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr function gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr function" data-site="plugin" data-version="1.0.8" data-slug="woocommerce-payhub-gateway-plugin" data-type="function" data-id="91044"><head xmlns="http://www.w3.org/1999/xhtml"><title> woocommerce_payhub_init | function | Woocommerce Payhub Gateway Plugin | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="woocommerce_payhub_init, function, plugin, woocommerce-payhub-gateway-plugin, 1.0.8" /><meta name="description" content="The WooCommerce PayHub Gateway Plugin woocommerce payhub init function." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=f13ac0818c56fdd917be294986688437' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/functions/woocommerce_payhub_init/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffunctions%2Fwoocommerce_payhub_init%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffunctions%2Fwoocommerce_payhub_init%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-woocommerce-payhub-gateway-plugin-1.0.8-function-woocommerce_payhub_init","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="woocommerce_payhub_init" class="single single-function single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to woocommerce-payhub-gateway-pl&hellip;." href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/" class="plugin"><span property="name">woocommerce-payhub-gateway-pl&hellip;</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 1.0.8." href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/" class="H_VERSION"><span property="name">1.0.8</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to functions." href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/functions/" class=""><span property="name">functions</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">woocommerce_payhub_init</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="function"><ul role="navigation"><li class="" data-id="all" data-count="3"><a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/all/" title="All">All <span class="count badge">3</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="1"><a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/hooks/" title="Hooks">Hooks <span class="count badge">1</span></a></li><li class="" data-id="action" data-count="0"><a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/actions/" title="Actions">Actions <span class="count badge">0</span></a></li><li class="" data-id="filter" data-count="1"><a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/filters/" title="Filters">Filters <span class="count badge">1</span></a></li><li class="" data-id="class" data-count="0"><a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/classes/" title="Classes">Classes <span class="count badge">0</span></a></li><li class="" data-id="constant" data-count="0"><a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/constants/" title="Constants">Constants <span class="count badge">0</span></a></li><li class="active" data-id="function" data-count="2"><a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/functions/" title="Functions">Functions <span class="count badge">2</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>woocommerce_payhub_init</strong></h1><p>The WooCommerce PayHub Gateway Plugin <strong>woocommerce payhub init</strong> function.</p> </section> <section id="description"><h2>Description</h2><pre><div>woocommerce_payhub_init();&nbsp;</div></pre></section><hr /> <section id="usage"><h2>Usage</h2><pre><ol><li><div>if ( !function_exists( '<span class="func">woocommerce_payhub_init</span>' ) ) {&nbsp;</div></li><li><div>    require_once ABSPATH . PLUGINDIR . 'woocommerce-payhub-gateway-plugin/woocommerce-payhub.php';&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div> &nbsp;</div></li><li><div><span class="comment">// NOTICE! Understand what this does before running.</span>&nbsp;</div></li><li><div><span class="param">$result</span> = <span class="func">woocommerce_payhub_init</span>(<span class="param"></span>);&nbsp;</div></li><li><div>   &nbsp;</div></li></ol></pre></section><hr /> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The function is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/files/woocommerce-payhub/" class="file">/woocommerce-payhub.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="14" class="block" start="14"><li><div>function woocommerce_payhub_init() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    if ( ! class_exists( 'WC_Payment_Gateway' ) ) { return; }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    //require_once(WP_PLUGIN_DIR . &quot;/&quot; . plugin_basename( dirname(__FILE__)) . '/class/payhubTransaction.class.php');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Gateway class&nbsp;</div></li><li><div>     **/&nbsp;</div></li><li><div>    class WC_PayHub_Gateway extends WC_Payment_Gateway {&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>        var $avaiable_countries = array(&nbsp;</div></li><li><div>            'GB' =&gt; array(&nbsp;</div></li><li><div>                'Visa', &nbsp;</div></li><li><div>                'MasterCard', &nbsp;</div></li><li><div>                'Discover', &nbsp;</div></li><li><div>                'American Express'&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'US' =&gt; array(&nbsp;</div></li><li><div>                'Visa', &nbsp;</div></li><li><div>                'MasterCard', &nbsp;</div></li><li><div>                'Discover', &nbsp;</div></li><li><div>                'American Express'&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'CA' =&gt; array(&nbsp;</div></li><li><div>                'Visa', &nbsp;</div></li><li><div>                'MasterCard', &nbsp;</div></li><li><div>                'Discover', &nbsp;</div></li><li><div>                'American Express'&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        var $api_username;&nbsp;</div></li><li><div>        var $api_password;&nbsp;</div></li><li><div>        var $orgid;&nbsp;</div></li><li><div>        var $demo;&nbsp;</div></li><li><div>        var $terminal_id;&nbsp;</div></li><li><div>        var $card_data;&nbsp;</div></li><li><div>        var $card_cvv;&nbsp;</div></li><li><div>        var $card_exp_month;&nbsp;</div></li><li><div>        var $card_exp_year;&nbsp;</div></li><li><div>        var $response;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        function __construct() { &nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            $this-&gt;id = 'payhub';&nbsp;</div></li><li><div>            $this-&gt;method_title = __('PayHub', 'woothemes');&nbsp;</div></li><li><div>            $this-&gt;icon = WP_PLUGIN_URL . &quot;/&quot; . plugin_basename( dirname(__FILE__)) . '/PoweredbyPayHubCards.png';&nbsp;</div></li><li><div>            $this-&gt;has_fields = true;&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            // Load the form fields&nbsp;</div></li><li><div>            $this-&gt;init_form_fields();&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            // Load the settings.&nbsp;</div></li><li><div>            $this-&gt;init_settings();&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            // Get setting values&nbsp;</div></li><li><div>            $this-&gt;title = $this-&gt;settings['title'];&nbsp;</div></li><li><div>            $this-&gt;description = $this-&gt;settings['description'];&nbsp;</div></li><li><div>            $this-&gt;demo = $this-&gt;settings['demo'];&nbsp;</div></li><li><div>            $this-&gt;enabled = $this-&gt;settings['enabled'];&nbsp;</div></li><li><div>            $this-&gt;api_username = $this-&gt;settings['api_username'];&nbsp;</div></li><li><div>            $this-&gt;api_password = $this-&gt;settings['api_password'];&nbsp;</div></li><li><div>            $this-&gt;orgid = $this-&gt;settings['orgid'];&nbsp;</div></li><li><div>            $this-&gt;tid = $this-&gt;settings['terminal_id'];&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Hooks&nbsp;</div></li><li><div>            add_action( <a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/actions/add_action/admin_notices/" data-id="574166" title="admin_notices" class="action">'admin_notices'</a>, array( &$this, 'ssl_check') );&nbsp;</div></li><li><div>            add_action( 'woocommerce_update_options_payment_gateways_' . $this-&gt;id, array( $this, 'process_admin_options') );&nbsp;</div></li><li><div>            add_action( <a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/actions/add_action/woocommerce_thankyou_cheque/" data-id="574168" title="woocommerce_thankyou_cheque" class="action">'woocommerce_thankyou_cheque'</a>, array(&$this, 'thankyou_page' ));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * Check if SSL is enabled and notify the user if SSL is not enabled&nbsp;</div></li><li><div>         **/&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        function ssl_check() {&nbsp;</div></li><li><div>         &nbsp;</div></li><li><div>        if (get_option('woocommerce_force_ssl_checkout')=='no' && $this-&gt;enabled=='yes') :&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>            echo '&lt;div class=&quot;error&quot;&gt;&lt;p&gt;'.sprintf(__('PayHub is enabled, but the &lt;a href=&quot;%s&quot;&gt;force SSL option&lt;/a&gt; is disabled; your checkout is not secure! Please enable SSL and ensure your server has a valid SSL certificate - PayHub is in live mode.', 'woothemes'), admin_url('admin.php?page=woocommerce')).'&lt;/p&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        endif;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>     * Initialize Gateway Settings Form Fields&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function init_form_fields() {&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>        $this-&gt;form_fields = array(&nbsp;</div></li><li><div>            'title' =&gt; array(&nbsp;</div></li><li><div>                            'title' =&gt; __( 'Title', 'woothemes' ), &nbsp;</div></li><li><div>                            'type' =&gt; 'text', &nbsp;</div></li><li><div>                            'description' =&gt; __( 'This controls the title which the user sees during checkout.', 'woothemes' ), &nbsp;</div></li><li><div>                            'default' =&gt; __( 'PayHub, Inc', 'woothemes' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'enabled' =&gt; array(&nbsp;</div></li><li><div>                            'title' =&gt; __( 'Enable/Disable', 'woothemes' ), &nbsp;</div></li><li><div>                            'label' =&gt; __( 'Enable PayHub', 'woothemes' ), &nbsp;</div></li><li><div>                            'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                            'description' =&gt; '', &nbsp;</div></li><li><div>                            'default' =&gt; 'no'&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'demo' =&gt; array(&nbsp;</div></li><li><div>                            'title' =&gt; __( 'PayHub Demo', 'woothemes' ), &nbsp;</div></li><li><div>                            'label' =&gt; __( 'Enable Demo Mode', 'woothemes' ), &nbsp;</div></li><li><div>                            'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                            'description' =&gt; __('This turns on Demo Mode, where all transactions will go to our demo server.  While this mode is on, you can use any credit card number, but must use the following CVVs for the following card types.  VISA = 999, Mastercard = 998, AMEX = 9997, and Discover/Diners = 996', 'woothemes'), &nbsp;</div></li><li><div>                            'default' =&gt; 'no'&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'description' =&gt; array(&nbsp;</div></li><li><div>                            'title' =&gt; __( 'Description', 'woothemes' ), &nbsp;</div></li><li><div>                            'type' =&gt; 'text', &nbsp;</div></li><li><div>                            'description' =&gt; __( 'This controls the description which the user sees during checkout.', 'woothemes' ), &nbsp;</div></li><li><div>                            'default' =&gt; 'We accept Visa, Mastercard, & Discover'&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'api_username' =&gt; array(&nbsp;</div></li><li><div>                            'title' =&gt; __( 'API Username', 'woothemes' ), &nbsp;</div></li><li><div>                            'type' =&gt; 'text', &nbsp;</div></li><li><div>                            'description' =&gt; __( 'Get your API Login from PayHub.', 'woothemes' ), &nbsp;</div></li><li><div>                            'default' =&gt; ''&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'api_password' =&gt; array(&nbsp;</div></li><li><div>                            'title' =&gt; __( 'API Password', 'woothemes' ), &nbsp;</div></li><li><div>                            'type' =&gt; 'text', &nbsp;</div></li><li><div>                            'description' =&gt; __( 'Get your API Password from PayHub.', 'woothemes' ), &nbsp;</div></li><li><div>                            'default' =&gt; ''&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'orgid' =&gt; array(&nbsp;</div></li><li><div>                            'title' =&gt; __( 'OrgID', 'woothemes' ), &nbsp;</div></li><li><div>                            'type' =&gt; 'text', &nbsp;</div></li><li><div>                            'description' =&gt; __( 'This is your organization ID', 'woothemes' ), &nbsp;</div></li><li><div>                            'default' =&gt; '00000'&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'terminal_id' =&gt; array(&nbsp;</div></li><li><div>                            'title' =&gt; __( 'Terminal ID', 'woothemes' ), &nbsp;</div></li><li><div>                            'type' =&gt; 'text', &nbsp;</div></li><li><div>                            'description' =&gt; __( 'Get your terminal ID from PayHub.', 'woothemes' ), &nbsp;</div></li><li><div>                            'default' =&gt; '0000'&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>       /**&nbsp;</div></li><li><div>         * Admin Panel Options &nbsp;</div></li><li><div>         * - Options for bits like 'title' and availability on a country-by-country basis&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        function admin_options() {&nbsp;</div></li><li><div>            ?&gt;&nbsp;</div></li><li><div>            &lt;h3&gt;&lt;?php _e( 'PayHub', 'woothemes' ); ?&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>            &lt;p&gt;&lt;?php _e( 'Payhub works by adding credit card fields on the checkout and then sending the details to our webservice for verification. You must first have a PayHub Account to accept credit card and debit card payments. Please contact x to setup an account. If you have any questions you can contact us at (415) 306-9476 M-F from 8am - 5 pm PST or email us at wecare@payhub.com&lt;/a&gt; anytime.  ', 'woothemes' ); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>            &lt;table class=&quot;form-table&quot;&gt;&nbsp;</div></li><li><div>                &lt;?php $this-&gt;generate_settings_html(); ?&gt;&nbsp;</div></li><li><div>            &lt;/table&gt;&lt;!--/.form-table--&gt;&nbsp;</div></li><li><div>            &lt;?php&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * Payment form on checkout page&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        function payment_fields() {&nbsp;</div></li><li><div>            if ( $description = $this-&gt;get_description() )&nbsp;</div></li><li><div>                echo wpautop( wptexturize( $description ) );&nbsp;</div></li><li><div>            if ( $this-&gt;supports( 'default_credit_card_form' ) )&nbsp;</div></li><li><div>                echo $this-&gt;credit_card_form();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            global $woocommerce;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    $month_select = &quot;&quot;;&nbsp;</div></li><li><div>    for ($i=0; $i &lt; 12; $i++) {&nbsp;</div></li><li><div>        $month = sprintf('%02d', $i+1);&nbsp;</div></li><li><div>        if($month == date('m'))&nbsp;</div></li><li><div>            $select = 'selected ';&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $select = '';&nbsp;</div></li><li><div>        $month_select .= &quot;&lt;option value='&quot; . $month . &quot;' &quot; . $select . &quot;&gt;&quot; . $month . &quot;&lt;/option&gt;\n&quot;;&nbsp;</div></li><li><div>    }    &nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    // create options for valid from and expires on years&nbsp;</div></li><li><div>    $year_now = date('y');&nbsp;</div></li><li><div>    $year_select = &quot;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    for($y = $year_now; $y &lt; $year_now + 15; $y++) {&nbsp;</div></li><li><div>        $year = sprintf('%02d', $y);&nbsp;</div></li><li><div>        $year_select .= &quot;&lt;option value='&quot; . $year . &quot;' &quot; . $select . &quot;&gt;&quot; . $year . &quot;&lt;/option&gt;\n&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;fieldset&gt;&nbsp;</div></li><li><div>                    &lt;p class=&quot;form-row form-row-first&quot;&gt;&nbsp;</div></li><li><div>                        &lt;label for=&quot;card_number&quot;&gt;&lt;?php echo __(&quot;Credit Card number&quot;, 'woocommerce') ?&gt; &lt;span class=&quot;required&quot;&gt;*&lt;/span&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                        &lt;input type=&quot;text&quot; class=&quot;input-text&quot; name=&quot;card_number&quot; /&gt;&nbsp;</div></li><li><div>                    &lt;/p&gt;&nbsp;</div></li><li><div>                    &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;p class=&quot;form-row form-row-first&quot;&gt;&nbsp;</div></li><li><div>                        &lt;label for=&quot;cc_exp_month&quot;&gt;&lt;?php echo __(&quot;Expiration date&quot;, 'woocommerce') ?&gt; &lt;span class=&quot;required&quot;&gt;*&lt;/span&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                        &lt;select name=&quot;card_exp_month&quot; id=&quot;cc_exp_month&quot;&gt;&nbsp;</div></li><li><div>                            &lt;?php echo $month_select; ?&gt;&nbsp;</div></li><li><div>                        &lt;/select&gt;&nbsp;</div></li><li><div>                        &lt;select name=&quot;card_exp_year&quot; id=&quot;cc_exp_year&quot;&gt;&nbsp;</div></li><li><div>                            &lt;?php echo $year_select; ?&gt;&nbsp;</div></li><li><div>                        &lt;/select&gt;&nbsp;</div></li><li><div>                    &lt;/p&gt;&nbsp;</div></li><li><div>                    &lt;p class=&quot;form-row form-row-last&quot;&gt;&nbsp;</div></li><li><div>                        &lt;label for=&quot;card_cvv&quot;&gt;&lt;?php _e(&quot;Card security code&quot;, 'woocommerce') ?&gt; &lt;span class=&quot;required&quot;&gt;*&lt;/span&gt;&lt;/label&gt;&nbsp;</div></li><li><div>                        &lt;input type=&quot;text&quot; class=&quot;input-text&quot; id=&quot;cc_cvv&quot; name=&quot;card_cvv&quot; maxlength=&quot;4&quot; style=&quot;width:45px&quot; /&gt;&nbsp;</div></li><li><div>                        &lt;span class=&quot;help payhub_card_cvv_description&quot;&gt;&lt;/span&gt;&nbsp;</div></li><li><div>                    &lt;/p&gt;&nbsp;</div></li><li><div>                    &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&nbsp;</div></li><li><div>                &lt;/fieldset&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            function supports( $feature ) {&nbsp;</div></li><li><div>                return apply_filters( <a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/filters/woocommerce_payment_gateway_supports/" data-id="574169" title="woocommerce_payment_gateway_supports" class="filter">'woocommerce_payment_gateway_supports'</a>, in_array( $feature, $this-&gt;supports) ? true : false, $feature, $this);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            /**&nbsp;</div></li><li><div>         * Validate the payment form&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>        function validate_fields() {&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>                                    &nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            #$card_data = isset($_POST['payjunction_card_type']) ? $_POST['payjunction_card_type'] : '';&nbsp;</div></li><li><div>            $card_data = isset($_POST['card_number']) ? $_POST['card_number'] : '';&nbsp;</div></li><li><div>            $card_cvv = isset($_POST['card_cvv']) ? $_POST['card_cvv'] : '';&nbsp;</div></li><li><div>            $card_exp_month = isset($_POST['card_exp_month']) ? $_POST['card_exp_month'] : '';&nbsp;</div></li><li><div>            $card_exp_year = isset($_POST['card_exp_year']) ? $_POST['card_exp_year'] : '';&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>                &nbsp;</div></li><li><div>            // Check card security code&nbsp;</div></li><li><div>            /**&nbsp;</div></li><li><div>            if(!ctype_digit($card_cvv)) {&nbsp;</div></li><li><div>                $woocommerce-&gt;add_error(__('Card security code is invalid (only digits are allowed)', 'woothemes'));&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            if((strlen($card_cvv) != 3 && in_array($card_type, array('Visa', 'MasterCard', 'Discover'))) || (strlen($card_csc) != 4 && $card_type == 'American Express')) {&nbsp;</div></li><li><div>                $woocommerce-&gt;add_error(__('Card security code is invalid (wrong length)', 'woothemes'));&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>            // Check card expiration data&nbsp;</div></li><li><div>            if(!ctype_digit($card_exp_month) || !ctype_digit($card_exp_year) ||&nbsp;</div></li><li><div>                 $card_exp_month &gt; 12 ||&nbsp;</div></li><li><div>                 $card_exp_month &lt; 1 ||&nbsp;</div></li><li><div>                 $card_exp_year &lt; date('Y') ||&nbsp;</div></li><li><div>                 $card_exp_year &gt; date('Y') + 20&nbsp;</div></li><li><div> ) {&nbsp;</div></li><li><div>                $woocommerce-&gt;add_error(__('Card expiration date is invalid', 'woothemes'));&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>            // Check card number&nbsp;</div></li><li><div>            $card_number = str_replace(array(' ', '-'), '', $card_number);&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>            if(empty($card_number) || !ctype_digit($card_number)) {&nbsp;</div></li><li><div>                $woocommerce-&gt;add_error(__('Card number is invalid', 'woothemes'));&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            */&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Add the Gateway to WooCommerce&nbsp;</div></li><li><div>     **/&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function process_payment( $order_id ) {&nbsp;</div></li><li><div>        global $woocommerce;&nbsp;</div></li><li><div>        $order = new WC_Order( $order_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $mode = $this-&gt;demo;&nbsp;</div></li><li><div>        $post_url = &quot;https://checkout.payhub.com/invoice/transaction&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ($mode == &quot;yes&quot;) {&nbsp;</div></li><li><div>            $mode = &quot;demo&quot;;&nbsp;</div></li><li><div>        }else{&nbsp;</div></li><li><div>            $mode = &quot;live&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $post_data = array(&nbsp;</div></li><li><div>            'mode' =&gt; $mode, &nbsp;</div></li><li><div>            'orgid' =&gt; $this-&gt;orgid, &nbsp;</div></li><li><div>            'username' =&gt; $this-&gt;api_username, &nbsp;</div></li><li><div>            'password' =&gt; $this-&gt;api_password, &nbsp;</div></li><li><div>            'tid' =&gt; $this-&gt;tid, &nbsp;</div></li><li><div>            'first_name' =&gt; $order-&gt;billing_first_name, &nbsp;</div></li><li><div>            'last_name' =&gt; $order-&gt;billing_last_name, &nbsp;</div></li><li><div>            'phone' =&gt; $order-&gt;billing_phone, &nbsp;</div></li><li><div>            'email' =&gt; $order-&gt;billing_email, &nbsp;</div></li><li><div>            'address1' =&gt; $order-&gt;billing_address_1, &nbsp;</div></li><li><div>            'address2' =&gt; $order-&gt;billing_address_2, &nbsp;</div></li><li><div>            'city' =&gt; $order-&gt;billing_city, &nbsp;</div></li><li><div>            'state' =&gt; $order-&gt;billing_state, &nbsp;</div></li><li><div>            'zip' =&gt; $order-&gt;billing_postcode, &nbsp;</div></li><li><div>            'note' =&gt; $order_id . &quot;, &quot; . $order-&gt;user_id, &nbsp;</div></li><li><div>            'cc' =&gt; $_POST['card_number'], &nbsp;</div></li><li><div>            'month' =&gt; $_POST['card_exp_month'], &nbsp;</div></li><li><div>            'year' =&gt; $_POST['card_exp_year'], &nbsp;</div></li><li><div>            'cvv' =&gt; $_POST['card_cvv'], &nbsp;</div></li><li><div>            'amount' =&gt; $order-&gt;order_total, &nbsp;</div></li><li><div>            'ship_to_name' =&gt; $order-&gt;billing_first_name . $order-&gt;billing_last_name, &nbsp;</div></li><li><div>            'ship_address1' =&gt; $order-&gt;shipping_address_1, &nbsp;</div></li><li><div>            'ship_address2' =&gt; $order-&gt;shipping_address_2, &nbsp;</div></li><li><div>            'ship_city' =&gt; $order-&gt;shipping_city, &nbsp;</div></li><li><div>            'ship_state' =&gt; $order-&gt;shipping_state, &nbsp;</div></li><li><div>            'ship_zip' =&gt; $order-&gt;shipping_postcode&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $post_fields = json_encode($post_data);&nbsp;</div></li><li><div>      //var_dump($submit_data);&nbsp;</div></li><li><div>      //var_dump($post_url);&nbsp;</div></li><li><div>      // Setup the cURL request.&nbsp;</div></li><li><div>      $ch = curl_init();&nbsp;</div></li><li><div>      $c_opts = array(&nbsp;</div></li><li><div>                        CURLOPT_URL =&gt; $post_url, &nbsp;</div></li><li><div>                      CURLOPT_VERBOSE =&gt; 0, &nbsp;</div></li><li><div>                      CURLOPT_SSL_VERIFYHOST =&gt; 0, &nbsp;</div></li><li><div>                      CURLOPT_SSL_VERIFYPEER =&gt; true, &nbsp;</div></li><li><div>                      CURLOPT_HTTPHEADER =&gt; array('Content-Type: application/json'), &nbsp;</div></li><li><div>                      CURLOPT_RETURNTRANSFER =&gt; true, &nbsp;</div></li><li><div>                      CURLOPT_POST =&gt; true, &nbsp;</div></li><li><div>                      CURLOPT_POSTFIELDS =&gt; $post_fields);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      curl_setopt_array($ch, $c_opts);&nbsp;</div></li><li><div>      $raw = curl_exec($ch);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      curl_close($ch);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $wooresponse = json_decode($raw, true);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ($wooresponse['RESPONSE_CODE'] == &quot;00&quot;) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $order-&gt;add_order_note( __('Transaction completed', 'woothemes') . ' (PayHub Transaction ID: ' . $wooresponse['TRANSACTION_ID']);&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            //$order-&gt;payment_complete();&nbsp;</div></li><li><div>            $order-&gt;payment_complete();&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Remove cart&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            //$woocommerce-&gt;cart-&gt;empty_cart();&nbsp;</div></li><li><div>            // Empty awaiting payment session&nbsp;</div></li><li><div>            unset($_SESSION);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Return thank you page redirect&nbsp;</div></li><li><div>            return array(&nbsp;</div></li><li><div>                'result' =&gt; 'success', &nbsp;</div></li><li><div>                #'redirect' =&gt; add_query_arg('key', $order-&gt;order_key, add_query_arg('order', $order_id, get_permalink(get_option('woocommerce_thanks_page_id'))))&nbsp;</div></li><li><div>                'redirect' =&gt; $this-&gt;get_return_url($order)&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        else :&nbsp;</div></li><li><div>            $order-&gt;update_status('failed');&nbsp;</div></li><li><div>            $woocommerce-&gt;add_error(__('Payment Error:  ', 'woothemes') . $wooresponse['RESPONSE_TEXT']);&nbsp;</div></li><li><div>            $woocommerce-&gt;add_error(__('Payment Error:  ', 'woothemes') . $wooresponse['RESPONSE_CODE']);&nbsp;</div></li><li><div>            $order-&gt;add_order_note( __('Transaction Failed', 'woothemes') . ' (PayHub Response Code: ' . $wooresponse['RESPONSE_CODE']);&nbsp;</div></li><li><div>            $order-&gt;add_order_note( __('Transaction Failed', 'woothemes') . ' (Failed due to: ' . $wooresponse['RESPONSE_TEXT']);&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 1.0.10</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.8/functions/woocommerce_payhub_init/" class="active">1.0.8</a></li><li><a href="http://hookr.io/plugins/woocommerce-payhub-gateway-plugin/1.0.10/functions/woocommerce_payhub_init/" class="">1.0.10</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>function</li><li><span></span>woocommerce_payhub_init</li><li><span></span>WooCommerce PayHub Gateway Plugin</li><li><span></span>1.0.8</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>