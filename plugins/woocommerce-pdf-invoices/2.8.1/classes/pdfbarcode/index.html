<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="2.8.1" data-slug="woocommerce-pdf-invoices" data-type="class" data-id="20861"><head xmlns="http://www.w3.org/1999/xhtml"><title> pdfbarcode | class | Woocommerce Pdf Invoices | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="PDFBarcode, class, plugin, woocommerce-pdf-invoices, 2.8.1" /><meta name="description" content="The WooCommerce PDF Invoices PDFBarcode class." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=b72de87443130abfa5e85903409c4325' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/pdfbarcode/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fpdfbarcode%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fpdfbarcode%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-woocommerce-pdf-invoices-2.8.1-class-pdfbarcode","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="pdfbarcode" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to woocommerce-pdf-invoices." href="http://hookr.io/plugins/woocommerce-pdf-invoices/" class="plugin"><span property="name">woocommerce-pdf-invoices</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.8.1." href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.8.1/" class="H_VERSION"><span property="name">2.8.1</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.8.1/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">pdfbarcode</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="211"><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.8.1/all/" title="All">All <span class="count badge">211</span></a></li><li class="" data-id="new" data-count="24"><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.8.1/new/" title="New">New <span class="count badge">24</span></a></li><li class="" data-id="hooks" data-count="41"><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.8.1/hooks/" title="Hooks">Hooks <span class="count badge">41</span></a></li><li class="" data-id="action" data-count="13"><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.8.1/actions/" title="Actions">Actions <span class="count badge">13</span></a></li><li class="" data-id="filter" data-count="28"><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.8.1/filters/" title="Filters">Filters <span class="count badge">28</span></a></li><li class="active" data-id="class" data-count="63"><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.8.1/classes/" title="Classes">Classes <span class="count badge">63</span></a></li><li class="" data-id="constant" data-count="66"><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.8.1/constants/" title="Constants">Constants <span class="count badge">66</span></a></li><li class="" data-id="function" data-count="40"><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.8.1/functions/" title="Functions">Functions <span class="count badge">40</span></a></li><li class="" data-id="shortcode" data-count="1"><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.8.1/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">1</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>PDFBarcode</strong></h1><p>The WooCommerce PDF Invoices <strong>PDFBarcode</strong> class.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.8.1/files/vendor-mpdf-mpdf-classes-barcode/" class="file">/vendor/mpdf/mpdf/classes/barcode.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="46" class="block" start="46"><li><div>class PDFBarcode&nbsp;</div></li><li><div>{&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    protected $barcode_array;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    protected $gapwidth;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    protected $print_ratio;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    protected $daft;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function __construct()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function getBarcodeArray($code, $type, $pr = '')&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $this-&gt;setBarcode($code, $type, $pr);&nbsp;</div></li><li><div>        return $this-&gt;barcode_array;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function getChecksum($code, $type)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $this-&gt;setBarcode($code, $type);&nbsp;</div></li><li><div>        if (!$this-&gt;barcode_array) {&nbsp;</div></li><li><div>            return '';&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            return $this-&gt;barcode_array['checkdigit'];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function setBarcode($code, $type, $pr = '')&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $this-&gt;print_ratio = 1;&nbsp;</div></li><li><div>        switch (strtoupper($type)) {&nbsp;</div></li><li><div>            case 'ISBN':&nbsp;</div></li><li><div>            case 'ISSN':&nbsp;</div></li><li><div>            case 'EAN13': { // EAN 13&nbsp;</div></li><li><div>                    $arrcode = $this-&gt;barcode_eanupc($code, 13);&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 11; // LEFT light margin =  x X-dim (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 7; // RIGHT light margin =  x X-dim (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.33; // Nominal value for X-dim in mm (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 25.93; // Nominal bar height in mm incl. numerals (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'UPCA': { // UPC-A&nbsp;</div></li><li><div>                    $arrcode = $this-&gt;barcode_eanupc($code, 12);&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 9; // LEFT light margin =  x X-dim (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 9; // RIGHT light margin =  x X-dim (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.33; // Nominal value for X-dim in mm (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 25.91; // Nominal bar height in mm incl. numerals (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'UPCE': { // UPC-E&nbsp;</div></li><li><div>                    $arrcode = $this-&gt;barcode_eanupc($code, 6);&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 9; // LEFT light margin =  x X-dim (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 7; // RIGHT light margin =  x X-dim (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.33; // Nominal value for X-dim in mm (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 25.93; // Nominal bar height in mm incl. numerals (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'EAN8': { // EAN 8&nbsp;</div></li><li><div>                    $arrcode = $this-&gt;barcode_eanupc($code, 8);&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 7; // LEFT light margin =  x X-dim (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 7; // RIGHT light margin =  x X-dim (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.33; // Nominal value for X-dim in mm (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 21.64; // Nominal bar height in mm incl. numerals (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'EAN2': { // 2-Digits UPC-Based Extention&nbsp;</div></li><li><div>                    $arrcode = $this-&gt;barcode_eanext($code, 2);&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 7; // LEFT light margin =  x X-dim (estimated)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 7; // RIGHT light margin =  x X-dim (estimated)&nbsp;</div></li><li><div>                    $arrcode['sepM'] = 9;  // SEPARATION margin =  x X-dim (http://web.archive.org/web/19990501035133/http://www.uc-council.org/d36-d.htm)&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.33; // Nominal value for X-dim in mm (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 20; // Nominal bar height in mm incl. numerals (estimated) not used when combined&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'EAN5': { // 5-Digits UPC-Based Extention&nbsp;</div></li><li><div>                    $arrcode = $this-&gt;barcode_eanext($code, 5);&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 7; // LEFT light margin =  x X-dim (estimated)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 7; // RIGHT light margin =  x X-dim (estimated)&nbsp;</div></li><li><div>                    $arrcode['sepM'] = 9;  // SEPARATION margin =  x X-dim (http://web.archive.org/web/19990501035133/http://www.uc-council.org/d36-d.htm)&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.33; // Nominal value for X-dim in mm (http://www.gs1uk.org)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 20; // Nominal bar height in mm incl. numerals (estimated) not used when combined&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'IMB': { // IMB - Intelligent Mail Barcode - Onecode - USPS-B-3200&nbsp;</div></li><li><div>                    $xdim = 0.508;   // Nominal value for X-dim (bar width) in mm (spec.)&nbsp;</div></li><li><div>                    $bpi = 22;    // Bars per inch&nbsp;</div></li><li><div>                    // Ratio of Nominal value for width of spaces in mm / Nominal value for X-dim (bar width) in mm based on bars per inch&nbsp;</div></li><li><div>                    $this-&gt;gapwidth = ((25.4 / $bpi) - $xdim) / $xdim;&nbsp;</div></li><li><div>                    $this-&gt;daft = array('D' =&gt; 2, 'A' =&gt; 2, 'F' =&gt; 3, 'T' =&gt; 1); // Descender; Ascender; Full; Tracker bar heights&nbsp;</div></li><li><div>                    $arrcode = $this-&gt;barcode_imb($code);&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = $xdim;&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 3.68; // Nominal value for Height of Full bar in mm (spec.)&nbsp;</div></li><li><div>                    // USPS-B-3200 Revision C = 4.623&nbsp;</div></li><li><div>                    // USPS-B-3200 Revision E = 3.68&nbsp;</div></li><li><div>                    $arrcode['quietL'] = 3.175; // LEFT Quiet margin =  mm (spec.)&nbsp;</div></li><li><div>                    $arrcode['quietR'] = 3.175; // RIGHT Quiet margin =  mm (spec.)&nbsp;</div></li><li><div>                    $arrcode['quietTB'] = 0.711; // TOP/BOTTOM Quiet margin =  mm (spec.)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'RM4SCC': { // RM4SCC (Royal Mail 4-state Customer Code) - CBC (Customer Bar Code)&nbsp;</div></li><li><div>                    $xdim = 0.508;   // Nominal value for X-dim (bar width) in mm (spec.)&nbsp;</div></li><li><div>                    $bpi = 22;    // Bars per inch&nbsp;</div></li><li><div>                    // Ratio of Nominal value for width of spaces in mm / Nominal value for X-dim (bar width) in mm based on bars per inch&nbsp;</div></li><li><div>                    $this-&gt;gapwidth = ((25.4 / $bpi) - $xdim) / $xdim;&nbsp;</div></li><li><div>                    $this-&gt;daft = array('D' =&gt; 5, 'A' =&gt; 5, 'F' =&gt; 8, 'T' =&gt; 2); // Descender; Ascender; Full; Tracker bar heights&nbsp;</div></li><li><div>                    $arrcode = $this-&gt;barcode_rm4scc($code, false);&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = $xdim;&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 5.0; // Nominal value for Height of Full bar in mm (spec.)&nbsp;</div></li><li><div>                    $arrcode['quietL'] = 2;  // LEFT Quiet margin =  mm (spec.)&nbsp;</div></li><li><div>                    $arrcode['quietR'] = 2;  // RIGHT Quiet margin =  mm (spec.)&nbsp;</div></li><li><div>                    $arrcode['quietTB'] = 2; // TOP/BOTTOM Quiet margin =  mm (spec?)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'KIX': { // KIX (Klant index - Customer index)&nbsp;</div></li><li><div>                    $xdim = 0.508;   // Nominal value for X-dim (bar width) in mm (spec.)&nbsp;</div></li><li><div>                    $bpi = 22;    // Bars per inch&nbsp;</div></li><li><div>                    // Ratio of Nominal value for width of spaces in mm / Nominal value for X-dim (bar width) in mm based on bars per inch&nbsp;</div></li><li><div>                    $this-&gt;gapwidth = ((25.4 / $bpi) - $xdim) / $xdim;&nbsp;</div></li><li><div>                    $this-&gt;daft = array('D' =&gt; 5, 'A' =&gt; 5, 'F' =&gt; 8, 'T' =&gt; 2); // Descender; Ascender; Full; Tracker bar heights&nbsp;</div></li><li><div>                    $arrcode = $this-&gt;barcode_rm4scc($code, true);&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = $xdim;&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 5.0; // Nominal value for Height of Full bar in mm (? spec.)&nbsp;</div></li><li><div>                    $arrcode['quietL'] = 2;  // LEFT Quiet margin =  mm (spec.)&nbsp;</div></li><li><div>                    $arrcode['quietR'] = 2;  // RIGHT Quiet margin =  mm (spec.)&nbsp;</div></li><li><div>                    $arrcode['quietTB'] = 2; // TOP/BOTTOM Quiet margin =  mm (spec.)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'POSTNET': { // POSTNET&nbsp;</div></li><li><div>                    $xdim = 0.508;   // Nominal value for X-dim (bar width) in mm (spec.)&nbsp;</div></li><li><div>                    $bpi = 22;    // Bars per inch&nbsp;</div></li><li><div>                    // Ratio of Nominal value for width of spaces in mm / Nominal value for X-dim (bar width) in mm based on bars per inch&nbsp;</div></li><li><div>                    $this-&gt;gapwidth = ((25.4 / $bpi) - $xdim) / $xdim;&nbsp;</div></li><li><div>                    $arrcode = $this-&gt;barcode_postnet($code, false);&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = $xdim;&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 3.175; // Nominal value for Height of Full bar in mm (spec.)&nbsp;</div></li><li><div>                    $arrcode['quietL'] = 3.175; // LEFT Quiet margin =  mm (?spec.)&nbsp;</div></li><li><div>                    $arrcode['quietR'] = 3.175; // RIGHT Quiet margin =  mm (?spec.)&nbsp;</div></li><li><div>                    $arrcode['quietTB'] = 1.016; // TOP/BOTTOM Quiet margin =  mm (?spec.)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'PLANET': { // PLANET&nbsp;</div></li><li><div>                    $xdim = 0.508;   // Nominal value for X-dim (bar width) in mm (spec.)&nbsp;</div></li><li><div>                    $bpi = 22;    // Bars per inch&nbsp;</div></li><li><div>                    // Ratio of Nominal value for width of spaces in mm / Nominal value for X-dim (bar width) in mm based on bars per inch&nbsp;</div></li><li><div>                    $this-&gt;gapwidth = ((25.4 / $bpi) - $xdim) / $xdim;&nbsp;</div></li><li><div>                    $arrcode = $this-&gt;barcode_postnet($code, true);&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = $xdim;&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 3.175; // Nominal value for Height of Full bar in mm (spec.)&nbsp;</div></li><li><div>                    $arrcode['quietL'] = 3.175; // LEFT Quiet margin =  mm (?spec.)&nbsp;</div></li><li><div>                    $arrcode['quietR'] = 3.175; // RIGHT Quiet margin =  mm (?spec.)&nbsp;</div></li><li><div>                    $arrcode['quietTB'] = 1.016; // TOP/BOTTOM Quiet margin =  mm (?spec.)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            case 'C93': { // CODE 93 - USS-93&nbsp;</div></li><li><div>                    $arrcode = $this-&gt;barcode_code93($code);&nbsp;</div></li><li><div>                    if ($arrcode == false) {&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.381; // Nominal value for X-dim (bar width) in mm (2 X min. spec.)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 10;  // Nominal value for Height of Full bar in mm (non-spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 10; // LEFT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 10; // RIGHT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightTB'] = 0; // TOP/BOTTOM light margin =  x X-dim (non-spec.)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'CODE11': { // CODE 11&nbsp;</div></li><li><div>                    if ($pr &gt; 0) {&nbsp;</div></li><li><div>                        $this-&gt;print_ratio = $pr;&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $this-&gt;print_ratio = 3;&nbsp;</div></li><li><div>                    }  // spec: Pr= 1:2.24 - 1:3.5&nbsp;</div></li><li><div>                    $arrcode = $this-&gt;barcode_code11($code);&nbsp;</div></li><li><div>                    if ($arrcode == false) {&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.381; // Nominal value for X-dim (bar width) in mm (2 X min. spec.)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 10;  // Nominal value for Height of Full bar in mm (non-spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 10; // LEFT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 10; // RIGHT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightTB'] = 0; // TOP/BOTTOM light margin =  x X-dim (non-spec.)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'MSI':  // MSI (Variation of Plessey code)&nbsp;</div></li><li><div>            case 'MSI+': { // MSI + CHECKSUM (modulo 11)&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'MSI') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_msi($code, false);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'MSI+') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_msi($code, true);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ($arrcode == false) {&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.381; // Nominal value for X-dim (bar width) in mm (2 X min. spec.)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 10;  // Nominal value for Height of Full bar in mm (non-spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 12; // LEFT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 12; // RIGHT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightTB'] = 0; // TOP/BOTTOM light margin =  x X-dim (non-spec.)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'CODABAR': { // CODABAR&nbsp;</div></li><li><div>                    if ($pr &gt; 0) {&nbsp;</div></li><li><div>                        $this-&gt;print_ratio = $pr;&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $this-&gt;print_ratio = 2.5;&nbsp;</div></li><li><div>                    }  // spec: Pr= 1:2 - 1:3 (&gt;2.2 if X&lt;0.50)&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'CODABAR') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_codabar($code);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ($arrcode == false) {&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.381; // Nominal value for X-dim (bar width) in mm (2 X min. spec.)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 10;  // Nominal value for Height of Full bar in mm (non-spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 10; // LEFT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 10; // RIGHT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightTB'] = 0; // TOP/BOTTOM light margin =  x X-dim (non-spec.)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'C128A': // CODE 128 A&nbsp;</div></li><li><div>            case 'C128B': // CODE 128 B&nbsp;</div></li><li><div>            case 'C128C':  // CODE 128 C&nbsp;</div></li><li><div>            case 'EAN128A':  // EAN 128 A&nbsp;</div></li><li><div>            case 'EAN128B':  // EAN 128 B&nbsp;</div></li><li><div>            case 'EAN128C': { // EAN 128 C&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'C128A') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_c128($code, 'A');&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'C128B') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_c128($code, 'B');&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'C128C') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_c128($code, 'C');&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'EAN128A') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_c128($code, 'A', true);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'EAN128B') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_c128($code, 'B', true);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'EAN128C') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_c128($code, 'C', true);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ($arrcode == false) {&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.381; // Nominal value for X-dim (bar width) in mm (2 X min. spec.)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 10;  // Nominal value for Height of Full bar in mm (non-spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 10; // LEFT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 10; // RIGHT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightTB'] = 0; // TOP/BOTTOM light margin =  x X-dim (non-spec.)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'C39':  // CODE 39 - ANSI MH10.8M-1983 - USD-3 - 3 of 9.&nbsp;</div></li><li><div>            case 'C39+': // CODE 39 with checksum&nbsp;</div></li><li><div>            case 'C39E': // CODE 39 EXTENDED&nbsp;</div></li><li><div>            case 'C39E+': { // CODE 39 EXTENDED + CHECKSUM&nbsp;</div></li><li><div>                    if ($pr &gt; 0) {&nbsp;</div></li><li><div>                        $this-&gt;print_ratio = $pr;&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $this-&gt;print_ratio = 2.5;&nbsp;</div></li><li><div>                    } // spec: Pr= 1:2 - 1:3 (&gt;2.2 if X&lt;0.50)&nbsp;</div></li><li><div>                    $code = str_replace(chr(194) . chr(160), ' ', $code); // mPDF 5.3.95  (for utf-8 encoded)&nbsp;</div></li><li><div>                    $code = str_replace(chr(160), ' ', $code); // mPDF 5.3.95    (for win-1252)&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'C39') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_code39($code, false, false);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'C39+') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_code39($code, false, true);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'C39E') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_code39($code, true, false);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'C39E+') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_code39($code, true, true);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ($arrcode == false) {&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.381; // Nominal value for X-dim (bar width) in mm (2 X min. spec.)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 10;  // Nominal value for Height of Full bar in mm (non-spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 10; // LEFT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 10; // RIGHT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightTB'] = 0; // TOP/BOTTOM light margin =  x X-dim (non-spec.)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'S25':  // Standard 2 of 5&nbsp;</div></li><li><div>            case 'S25+': { // Standard 2 of 5 + CHECKSUM&nbsp;</div></li><li><div>                    if ($pr &gt; 0) {&nbsp;</div></li><li><div>                        $this-&gt;print_ratio = $pr;&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $this-&gt;print_ratio = 3;&nbsp;</div></li><li><div>                    }  // spec: Pr=1:3/1:4.5&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'S25') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_s25($code, false);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'S25+') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_s25($code, true);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ($arrcode == false) {&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.381; // Nominal value for X-dim (bar width) in mm (2 X min. spec.)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 10;  // Nominal value for Height of Full bar in mm (non-spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 10; // LEFT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 10; // RIGHT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightTB'] = 0; // TOP/BOTTOM light margin =  x X-dim (non-spec.)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'I25':  // Interleaved 2 of 5&nbsp;</div></li><li><div>            case 'I25+': { // Interleaved 2 of 5 + CHECKSUM&nbsp;</div></li><li><div>                    if ($pr &gt; 0) {&nbsp;</div></li><li><div>                        $this-&gt;print_ratio = $pr;&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $this-&gt;print_ratio = 2.5;&nbsp;</div></li><li><div>                    } // spec: Pr= 1:2 - 1:3 (&gt;2.2 if X&lt;0.50)&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'I25') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_i25($code, false);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'I25+') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_i25($code, true);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ($arrcode == false) {&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.381; // Nominal value for X-dim (bar width) in mm (2 X min. spec.)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 10;  // Nominal value for Height of Full bar in mm (non-spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 10; // LEFT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 10; // RIGHT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightTB'] = 0; // TOP/BOTTOM light margin =  x X-dim (non-spec.)&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'I25B':  // Interleaved 2 of 5 + Bearer bars&nbsp;</div></li><li><div>            case 'I25B+': { // Interleaved 2 of 5 + CHECKSUM + Bearer bars&nbsp;</div></li><li><div>                    if ($pr &gt; 0) {&nbsp;</div></li><li><div>                        $this-&gt;print_ratio = $pr;&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $this-&gt;print_ratio = 2.5;&nbsp;</div></li><li><div>                    } // spec: Pr= 1:2 - 1:3 (&gt;2.2 if X&lt;0.50)&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'I25B') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_i25($code, false);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if (strtoupper($type) == 'I25B+') {&nbsp;</div></li><li><div>                        $arrcode = $this-&gt;barcode_i25($code, true);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ($arrcode == false) {&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $arrcode['nom-X'] = 0.381; // Nominal value for X-dim (bar width) in mm (2 X min. spec.)&nbsp;</div></li><li><div>                    $arrcode['nom-H'] = 10;  // Nominal value for Height of Full bar in mm (non-spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmL'] = 10; // LEFT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightmR'] = 10; // RIGHT light margin =  x X-dim (spec.)&nbsp;</div></li><li><div>                    $arrcode['lightTB'] = 2; // TOP/BOTTOM light margin =  x X-dim (non-spec.) - used for bearer bars&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            default: {&nbsp;</div></li><li><div>                    $this-&gt;barcode_array = false;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $this-&gt;barcode_array = $arrcode;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * CODE 39 - ANSI MH10.8M-1983 - USD-3 - 3 of 9.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function barcode_code39($code, $extended = false, $checksum = false)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $chr['0'] = '111221211';&nbsp;</div></li><li><div>        $chr['1'] = '211211112';&nbsp;</div></li><li><div>        $chr['2'] = '112211112';&nbsp;</div></li><li><div>        $chr['3'] = '212211111';&nbsp;</div></li><li><div>        $chr['4'] = '111221112';&nbsp;</div></li><li><div>        $chr['5'] = '211221111';&nbsp;</div></li><li><div>        $chr['6'] = '112221111';&nbsp;</div></li><li><div>        $chr['7'] = '111211212';&nbsp;</div></li><li><div>        $chr['8'] = '211211211';&nbsp;</div></li><li><div>        $chr['9'] = '112211211';&nbsp;</div></li><li><div>        $chr['A'] = '211112112';&nbsp;</div></li><li><div>        $chr['B'] = '112112112';&nbsp;</div></li><li><div>        $chr['C'] = '212112111';&nbsp;</div></li><li><div>        $chr['D'] = '111122112';&nbsp;</div></li><li><div>        $chr['E'] = '211122111';&nbsp;</div></li><li><div>        $chr['F'] = '112122111';&nbsp;</div></li><li><div>        $chr['G'] = '111112212';&nbsp;</div></li><li><div>        $chr['H'] = '211112211';&nbsp;</div></li><li><div>        $chr['I'] = '112112211';&nbsp;</div></li><li><div>        $chr['J'] = '111122211';&nbsp;</div></li><li><div>        $chr['K'] = '211111122';&nbsp;</div></li><li><div>        $chr['L'] = '112111122';&nbsp;</div></li><li><div>        $chr['M'] = '212111121';&nbsp;</div></li><li><div>        $chr['N'] = '111121122';&nbsp;</div></li><li><div>        $chr['O'] = '211121121';&nbsp;</div></li><li><div>        $chr['P'] = '112121121';&nbsp;</div></li><li><div>        $chr['Q'] = '111111222';&nbsp;</div></li><li><div>        $chr['R'] = '211111221';&nbsp;</div></li><li><div>        $chr['S'] = '112111221';&nbsp;</div></li><li><div>        $chr['T'] = '111121221';&nbsp;</div></li><li><div>        $chr['U'] = '221111112';&nbsp;</div></li><li><div>        $chr['V'] = '122111112';&nbsp;</div></li><li><div>        $chr['W'] = '222111111';&nbsp;</div></li><li><div>        $chr['X'] = '121121112';&nbsp;</div></li><li><div>        $chr['Y'] = '221121111';&nbsp;</div></li><li><div>        $chr['Z'] = '122121111';&nbsp;</div></li><li><div>        $chr['-'] = '121111212';&nbsp;</div></li><li><div>        $chr['.'] = '221111211';&nbsp;</div></li><li><div>        $chr[' '] = '122111211';&nbsp;</div></li><li><div>        $chr['$'] = '121212111';&nbsp;</div></li><li><div>        $chr['/'] = '121211121';&nbsp;</div></li><li><div>        $chr['+'] = '121112121';&nbsp;</div></li><li><div>        $chr['%'] = '111212121';&nbsp;</div></li><li><div>        $chr['*'] = '121121211';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $code = strtoupper($code);&nbsp;</div></li><li><div>        $checkdigit = '';&nbsp;</div></li><li><div>        if ($extended) {&nbsp;</div></li><li><div>            // extended mode&nbsp;</div></li><li><div>            $code = $this-&gt;encode_code39_ext($code);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ($code === false) {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ($checksum) {&nbsp;</div></li><li><div>            // checksum&nbsp;</div></li><li><div>            $checkdigit = $this-&gt;checksum_code39($code);&nbsp;</div></li><li><div>            $code .= $checkdigit;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // add start and stop codes&nbsp;</div></li><li><div>        $code = '*' . $code . '*';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $bararray = array('code' =&gt; $code, 'maxw' =&gt; 0, 'maxh' =&gt; 1, 'bcode' =&gt; array());&nbsp;</div></li><li><div>        $k = 0;&nbsp;</div></li><li><div>        $clen = strlen($code);&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $clen; ++$i) {&nbsp;</div></li><li><div>            $char = $code[$i];&nbsp;</div></li><li><div>            if (!isset($chr[$char])) {&nbsp;</div></li><li><div>                // invalid character&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            for ($j = 0; $j &lt; 9; ++$j) {&nbsp;</div></li><li><div>                if (($j % 2) == 0) {&nbsp;</div></li><li><div>                    $t = true; // bar&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $t = false; // space&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $x = $chr[$char][$j];&nbsp;</div></li><li><div>                if ($x == 2) {&nbsp;</div></li><li><div>                    $w = $this-&gt;print_ratio;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $w = 1;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $bararray['bcode'][$k] = array('t' =&gt; $t, 'w' =&gt; $w, 'h' =&gt; 1, 'p' =&gt; 0);&nbsp;</div></li><li><div>                $bararray['maxw'] += $w;&nbsp;</div></li><li><div>                ++$k;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $bararray['bcode'][$k] = array('t' =&gt; false, 'w' =&gt; 1, 'h' =&gt; 1, 'p' =&gt; 0);&nbsp;</div></li><li><div>            $bararray['maxw'] += 1;&nbsp;</div></li><li><div>            ++$k;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $bararray['checkdigit'] = $checkdigit;&nbsp;</div></li><li><div>        return $bararray;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Encode a string to be used for CODE 39 Extended mode.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function encode_code39_ext($code)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $encode = array(&nbsp;</div></li><li><div>            chr(0) =&gt; '%U', chr(1) =&gt; '$A', chr(2) =&gt; '$B', chr(3) =&gt; '$C', &nbsp;</div></li><li><div>            chr(4) =&gt; '$D', chr(5) =&gt; '$E', chr(6) =&gt; '$F', chr(7) =&gt; '$G', &nbsp;</div></li><li><div>            chr(8) =&gt; '$H', chr(9) =&gt; '$I', chr(10) =&gt; '$J', chr(11) =&gt; 'K', &nbsp;</div></li><li><div>            chr(12) =&gt; '$L', chr(13) =&gt; '$M', chr(14) =&gt; '$N', chr(15) =&gt; '$O', &nbsp;</div></li><li><div>            chr(16) =&gt; '$P', chr(17) =&gt; '$Q', chr(18) =&gt; '$R', chr(19) =&gt; '$S', &nbsp;</div></li><li><div>            chr(20) =&gt; '$T', chr(21) =&gt; '$U', chr(22) =&gt; '$V', chr(23) =&gt; '$W', &nbsp;</div></li><li><div>            chr(24) =&gt; '$X', chr(25) =&gt; '$Y', chr(26) =&gt; '$Z', chr(27) =&gt; '%A', &nbsp;</div></li><li><div>            chr(28) =&gt; '%B', chr(29) =&gt; '%C', chr(30) =&gt; '%D', chr(31) =&gt; '%E', &nbsp;</div></li><li><div>            chr(32) =&gt; ' ', chr(33) =&gt; '/A', chr(34) =&gt; '/B', chr(35) =&gt; '/C', &nbsp;</div></li><li><div>            chr(36) =&gt; '/D', chr(37) =&gt; '/E', chr(38) =&gt; '/F', chr(39) =&gt; '/G', &nbsp;</div></li><li><div>            chr(40) =&gt; '/H', chr(41) =&gt; '/I', chr(42) =&gt; '/J', chr(43) =&gt; '/K', &nbsp;</div></li><li><div>            chr(44) =&gt; '/L', chr(45) =&gt; '-', chr(46) =&gt; '.', chr(47) =&gt; '/O', &nbsp;</div></li><li><div>            chr(48) =&gt; '0', chr(49) =&gt; '1', chr(50) =&gt; '2', chr(51) =&gt; '3', &nbsp;</div></li><li><div>            chr(52) =&gt; '4', chr(53) =&gt; '5', chr(54) =&gt; '6', chr(55) =&gt; '7', &nbsp;</div></li><li><div>            chr(56) =&gt; '8', chr(57) =&gt; '9', chr(58) =&gt; '/Z', chr(59) =&gt; '%F', &nbsp;</div></li><li><div>            chr(60) =&gt; '%G', chr(61) =&gt; '%H', chr(62) =&gt; '%I', chr(63) =&gt; '%J', &nbsp;</div></li><li><div>            chr(64) =&gt; '%V', chr(65) =&gt; 'A', chr(66) =&gt; 'B', chr(67) =&gt; 'C', &nbsp;</div></li><li><div>            chr(68) =&gt; 'D', chr(69) =&gt; 'E', chr(70) =&gt; 'F', chr(71) =&gt; 'G', &nbsp;</div></li><li><div>            chr(72) =&gt; 'H', chr(73) =&gt; 'I', chr(74) =&gt; 'J', chr(75) =&gt; 'K', &nbsp;</div></li><li><div>            chr(76) =&gt; 'L', chr(77) =&gt; 'M', chr(78) =&gt; 'N', chr(79) =&gt; 'O', &nbsp;</div></li><li><div>            chr(80) =&gt; 'P', chr(81) =&gt; 'Q', chr(82) =&gt; 'R', chr(83) =&gt; 'S', &nbsp;</div></li><li><div>            chr(84) =&gt; 'T', chr(85) =&gt; 'U', chr(86) =&gt; 'V', chr(87) =&gt; 'W', &nbsp;</div></li><li><div>            chr(88) =&gt; 'X', chr(89) =&gt; 'Y', chr(90) =&gt; 'Z', chr(91) =&gt; '%K', &nbsp;</div></li><li><div>            chr(92) =&gt; '%L', chr(93) =&gt; '%M', chr(94) =&gt; '%N', chr(95) =&gt; '%O', &nbsp;</div></li><li><div>            chr(96) =&gt; '%W', chr(97) =&gt; '+A', chr(98) =&gt; '+B', chr(99) =&gt; '+C', &nbsp;</div></li><li><div>            chr(100) =&gt; '+D', chr(101) =&gt; '+E', chr(102) =&gt; '+F', chr(103) =&gt; '+G', &nbsp;</div></li><li><div>            chr(104) =&gt; '+H', chr(105) =&gt; '+I', chr(106) =&gt; '+J', chr(107) =&gt; '+K', &nbsp;</div></li><li><div>            chr(108) =&gt; '+L', chr(109) =&gt; '+M', chr(110) =&gt; '+N', chr(111) =&gt; '+O', &nbsp;</div></li><li><div>            chr(112) =&gt; '+P', chr(113) =&gt; '+Q', chr(114) =&gt; '+R', chr(115) =&gt; '+S', &nbsp;</div></li><li><div>            chr(116) =&gt; '+T', chr(117) =&gt; '+U', chr(118) =&gt; '+V', chr(119) =&gt; '+W', &nbsp;</div></li><li><div>            chr(120) =&gt; '+X', chr(121) =&gt; '+Y', chr(122) =&gt; '+Z', chr(123) =&gt; '%P', &nbsp;</div></li><li><div>            chr(124) =&gt; '%Q', chr(125) =&gt; '%R', chr(126) =&gt; '%S', chr(127) =&gt; '%T');&nbsp;</div></li><li><div>        $code_ext = '';&nbsp;</div></li><li><div>        $clen = strlen($code);&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $clen; ++$i) {&nbsp;</div></li><li><div>            if (ord($code[$i]) &gt; 127) {&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $code_ext .= $encode[$code[$i]];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $code_ext;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Calculate CODE 39 checksum (modulo 43).&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function checksum_code39($code)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $chars = array(&nbsp;</div></li><li><div>            '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', &nbsp;</div></li><li><div>            'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', &nbsp;</div></li><li><div>            'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', &nbsp;</div></li><li><div>            'W', 'X', 'Y', 'Z', '-', '.', ' ', '$', '/', '+', '%');&nbsp;</div></li><li><div>        $sum = 0;&nbsp;</div></li><li><div>        $clen = strlen($code);&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $clen; ++$i) {&nbsp;</div></li><li><div>            $k = array_keys($chars, $code[$i]);&nbsp;</div></li><li><div>            $sum += $k[0];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $j = ($sum % 43);&nbsp;</div></li><li><div>        return $chars[$j];&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * CODE 93 - USS-93&nbsp;</div></li><li><div>     * Compact code similar to Code 39&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function barcode_code93($code)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $chr[48] = '131112'; // 0&nbsp;</div></li><li><div>        $chr[49] = '111213'; // 1&nbsp;</div></li><li><div>        $chr[50] = '111312'; // 2&nbsp;</div></li><li><div>        $chr[51] = '111411'; // 3&nbsp;</div></li><li><div>        $chr[52] = '121113'; // 4&nbsp;</div></li><li><div>        $chr[53] = '121212'; // 5&nbsp;</div></li><li><div>        $chr[54] = '121311'; // 6&nbsp;</div></li><li><div>        $chr[55] = '111114'; // 7&nbsp;</div></li><li><div>        $chr[56] = '131211'; // 8&nbsp;</div></li><li><div>        $chr[57] = '141111'; // 9&nbsp;</div></li><li><div>        $chr[65] = '211113'; // A&nbsp;</div></li><li><div>        $chr[66] = '211212'; // B&nbsp;</div></li><li><div>        $chr[67] = '211311'; // C&nbsp;</div></li><li><div>        $chr[68] = '221112'; // D&nbsp;</div></li><li><div>        $chr[69] = '221211'; // E&nbsp;</div></li><li><div>        $chr[70] = '231111'; // F&nbsp;</div></li><li><div>        $chr[71] = '112113'; // G&nbsp;</div></li><li><div>        $chr[72] = '112212'; // H&nbsp;</div></li><li><div>        $chr[73] = '112311'; // I&nbsp;</div></li><li><div>        $chr[74] = '122112'; // J&nbsp;</div></li><li><div>        $chr[75] = '132111'; // K&nbsp;</div></li><li><div>        $chr[76] = '111123'; // L&nbsp;</div></li><li><div>        $chr[77] = '111222'; // M&nbsp;</div></li><li><div>        $chr[78] = '111321'; // N&nbsp;</div></li><li><div>        $chr[79] = '121122'; // O&nbsp;</div></li><li><div>        $chr[80] = '131121'; // P&nbsp;</div></li><li><div>        $chr[81] = '212112'; // Q&nbsp;</div></li><li><div>        $chr[82] = '212211'; // R&nbsp;</div></li><li><div>        $chr[83] = '211122'; // S&nbsp;</div></li><li><div>        $chr[84] = '211221'; // T&nbsp;</div></li><li><div>        $chr[85] = '221121'; // U&nbsp;</div></li><li><div>        $chr[86] = '222111'; // V&nbsp;</div></li><li><div>        $chr[87] = '112122'; // W&nbsp;</div></li><li><div>        $chr[88] = '112221'; // X&nbsp;</div></li><li><div>        $chr[89] = '122121'; // Y&nbsp;</div></li><li><div>        $chr[90] = '123111'; // Z&nbsp;</div></li><li><div>        $chr[45] = '121131'; // -&nbsp;</div></li><li><div>        $chr[46] = '311112'; // .&nbsp;</div></li><li><div>        $chr[32] = '311211'; //&nbsp;</div></li><li><div>        $chr[36] = '321111'; // $&nbsp;</div></li><li><div>        $chr[47] = '112131'; // /&nbsp;</div></li><li><div>        $chr[43] = '113121'; // +&nbsp;</div></li><li><div>        $chr[37] = '211131'; // %&nbsp;</div></li><li><div>        $chr[128] = '121221'; // ($)&nbsp;</div></li><li><div>        $chr[129] = '311121'; // (/)&nbsp;</div></li><li><div>        $chr[130] = '122211'; // (+)&nbsp;</div></li><li><div>        $chr[131] = '312111'; // (%)&nbsp;</div></li><li><div>        $chr[42] = '111141'; // start-stop&nbsp;</div></li><li><div>        $code = strtoupper($code);&nbsp;</div></li><li><div>        $encode = array(&nbsp;</div></li><li><div>            chr(0) =&gt; chr(131) . 'U', chr(1) =&gt; chr(128) . 'A', chr(2) =&gt; chr(128) . 'B', chr(3) =&gt; chr(128) . 'C', &nbsp;</div></li><li><div>            chr(4) =&gt; chr(128) . 'D', chr(5) =&gt; chr(128) . 'E', chr(6) =&gt; chr(128) . 'F', chr(7) =&gt; chr(128) . 'G', &nbsp;</div></li><li><div>            chr(8) =&gt; chr(128) . 'H', chr(9) =&gt; chr(128) . 'I', chr(10) =&gt; chr(128) . 'J', chr(11) =&gt; 'K', &nbsp;</div></li><li><div>            chr(12) =&gt; chr(128) . 'L', chr(13) =&gt; chr(128) . 'M', chr(14) =&gt; chr(128) . 'N', chr(15) =&gt; chr(128) . 'O', &nbsp;</div></li><li><div>            chr(16) =&gt; chr(128) . 'P', chr(17) =&gt; chr(128) . 'Q', chr(18) =&gt; chr(128) . 'R', chr(19) =&gt; chr(128) . 'S', &nbsp;</div></li><li><div>            chr(20) =&gt; chr(128) . 'T', chr(21) =&gt; chr(128) . 'U', chr(22) =&gt; chr(128) . 'V', chr(23) =&gt; chr(128) . 'W', &nbsp;</div></li><li><div>            chr(24) =&gt; chr(128) . 'X', chr(25) =&gt; chr(128) . 'Y', chr(26) =&gt; chr(128) . 'Z', chr(27) =&gt; chr(131) . 'A', &nbsp;</div></li><li><div>            chr(28) =&gt; chr(131) . 'B', chr(29) =&gt; chr(131) . 'C', chr(30) =&gt; chr(131) . 'D', chr(31) =&gt; chr(131) . 'E', &nbsp;</div></li><li><div>            chr(32) =&gt; ' ', chr(33) =&gt; chr(129) . 'A', chr(34) =&gt; chr(129) . 'B', chr(35) =&gt; chr(129) . 'C', &nbsp;</div></li><li><div>            chr(36) =&gt; chr(129) . 'D', chr(37) =&gt; chr(129) . 'E', chr(38) =&gt; chr(129) . 'F', chr(39) =&gt; chr(129) . 'G', &nbsp;</div></li><li><div>            chr(40) =&gt; chr(129) . 'H', chr(41) =&gt; chr(129) . 'I', chr(42) =&gt; chr(129) . 'J', chr(43) =&gt; chr(129) . 'K', &nbsp;</div></li><li><div>            chr(44) =&gt; chr(129) . 'L', chr(45) =&gt; '-', chr(46) =&gt; '.', chr(47) =&gt; chr(129) . 'O', &nbsp;</div></li><li><div>            chr(48) =&gt; '0', chr(49) =&gt; '1', chr(50) =&gt; '2', chr(51) =&gt; '3', &nbsp;</div></li><li><div>            chr(52) =&gt; '4', chr(53) =&gt; '5', chr(54) =&gt; '6', chr(55) =&gt; '7', &nbsp;</div></li><li><div>            chr(56) =&gt; '8', chr(57) =&gt; '9', chr(58) =&gt; chr(129) . 'Z', chr(59) =&gt; chr(131) . 'F', &nbsp;</div></li><li><div>            chr(60) =&gt; chr(131) . 'G', chr(61) =&gt; chr(131) . 'H', chr(62) =&gt; chr(131) . 'I', chr(63) =&gt; chr(131) . 'J', &nbsp;</div></li><li><div>            chr(64) =&gt; chr(131) . 'V', chr(65) =&gt; 'A', chr(66) =&gt; 'B', chr(67) =&gt; 'C', &nbsp;</div></li><li><div>            chr(68) =&gt; 'D', chr(69) =&gt; 'E', chr(70) =&gt; 'F', chr(71) =&gt; 'G', &nbsp;</div></li><li><div>            chr(72) =&gt; 'H', chr(73) =&gt; 'I', chr(74) =&gt; 'J', chr(75) =&gt; 'K', &nbsp;</div></li><li><div>            chr(76) =&gt; 'L', chr(77) =&gt; 'M', chr(78) =&gt; 'N', chr(79) =&gt; 'O', &nbsp;</div></li><li><div>            chr(80) =&gt; 'P', chr(81) =&gt; 'Q', chr(82) =&gt; 'R', chr(83) =&gt; 'S', &nbsp;</div></li><li><div>            chr(84) =&gt; 'T', chr(85) =&gt; 'U', chr(86) =&gt; 'V', chr(87) =&gt; 'W', &nbsp;</div></li><li><div>            chr(88) =&gt; 'X', chr(89) =&gt; 'Y', chr(90) =&gt; 'Z', chr(91) =&gt; chr(131) . 'K', &nbsp;</div></li><li><div>            chr(92) =&gt; chr(131) . 'L', chr(93) =&gt; chr(131) . 'M', chr(94) =&gt; chr(131) . 'N', chr(95) =&gt; chr(131) . 'O', &nbsp;</div></li><li><div>            chr(96) =&gt; chr(131) . 'W', chr(97) =&gt; chr(130) . 'A', chr(98) =&gt; chr(130) . 'B', chr(99) =&gt; chr(130) . 'C', &nbsp;</div></li><li><div>            chr(100) =&gt; chr(130) . 'D', chr(101) =&gt; chr(130) . 'E', chr(102) =&gt; chr(130) . 'F', chr(103) =&gt; chr(130) . 'G', &nbsp;</div></li><li><div>            chr(104) =&gt; chr(130) . 'H', chr(105) =&gt; chr(130) . 'I', chr(106) =&gt; chr(130) . 'J', chr(107) =&gt; chr(130) . 'K', &nbsp;</div></li><li><div>            chr(108) =&gt; chr(130) . 'L', chr(109) =&gt; chr(130) . 'M', chr(110) =&gt; chr(130) . 'N', chr(111) =&gt; chr(130) . 'O', &nbsp;</div></li><li><div>            chr(112) =&gt; chr(130) . 'P', chr(113) =&gt; chr(130) . 'Q', chr(114) =&gt; chr(130) . 'R', chr(115) =&gt; chr(130) . 'S', &nbsp;</div></li><li><div>            chr(116) =&gt; chr(130) . 'T', chr(117) =&gt; chr(130) . 'U', chr(118) =&gt; chr(130) . 'V', chr(119) =&gt; chr(130) . 'W', &nbsp;</div></li><li><div>            chr(120) =&gt; chr(130) . 'X', chr(121) =&gt; chr(130) . 'Y', chr(122) =&gt; chr(130) . 'Z', chr(123) =&gt; chr(131) . 'P', &nbsp;</div></li><li><div>            chr(124) =&gt; chr(131) . 'Q', chr(125) =&gt; chr(131) . 'R', chr(126) =&gt; chr(131) . 'S', chr(127) =&gt; chr(131) . 'T');&nbsp;</div></li><li><div>        $code_ext = '';&nbsp;</div></li><li><div>        $clen = strlen($code);&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $clen; ++$i) {&nbsp;</div></li><li><div>            if (ord($code{$i}) &gt; 127) {&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $code_ext .= $encode[$code{$i}];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // checksum&nbsp;</div></li><li><div>        $code_ext .= $this-&gt;checksum_code93($code_ext);&nbsp;</div></li><li><div>        // add start and stop codes&nbsp;</div></li><li><div>        $code = '*' . $code_ext . '*';&nbsp;</div></li><li><div>        $bararray = array('code' =&gt; $code, 'maxw' =&gt; 0, 'maxh' =&gt; 1, 'bcode' =&gt; array());&nbsp;</div></li><li><div>        $k = 0;&nbsp;</div></li><li><div>        $clen = strlen($code);&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $clen; ++$i) {&nbsp;</div></li><li><div>            $char = ord($code{$i});&nbsp;</div></li><li><div>            if (!isset($chr[$char])) {&nbsp;</div></li><li><div>                // invalid character&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            for ($j = 0; $j &lt; 6; ++$j) {&nbsp;</div></li><li><div>                if (($j % 2) == 0) {&nbsp;</div></li><li><div>                    $t = true; // bar&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $t = false; // space&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $w = $chr[$char]{$j};&nbsp;</div></li><li><div>                $bararray['bcode'][$k] = array('t' =&gt; $t, 'w' =&gt; $w, 'h' =&gt; 1, 'p' =&gt; 0);&nbsp;</div></li><li><div>                $bararray['maxw'] += $w;&nbsp;</div></li><li><div>                ++$k;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $bararray['bcode'][$k] = array('t' =&gt; true, 'w' =&gt; 1, 'h' =&gt; 1, 'p' =&gt; 0);&nbsp;</div></li><li><div>        $bararray['maxw'] += 1;&nbsp;</div></li><li><div>        ++$k;&nbsp;</div></li><li><div>        return $bararray;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Calculate CODE 93 checksum (modulo 47).&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function checksum_code93($code)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $chars = array(&nbsp;</div></li><li><div>            '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', &nbsp;</div></li><li><div>            'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', &nbsp;</div></li><li><div>            'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', &nbsp;</div></li><li><div>            'W', 'X', 'Y', 'Z', '-', '.', ' ', '$', '/', '+', '%', &nbsp;</div></li><li><div>            '&lt;', '=', '&gt;', '?');&nbsp;</div></li><li><div>        // translate special characters&nbsp;</div></li><li><div>        $code = strtr($code, chr(128) . chr(131) . chr(129) . chr(130), '&lt;=&gt;?');&nbsp;</div></li><li><div>        $len = strlen($code);&nbsp;</div></li><li><div>        // calculate check digit C&nbsp;</div></li><li><div>        $p = 1;&nbsp;</div></li><li><div>        $check = 0;&nbsp;</div></li><li><div>        for ($i = ($len - 1); $i &gt;= 0; --$i) {&nbsp;</div></li><li><div>            $k = array_keys($chars, $code{$i});&nbsp;</div></li><li><div>            $check += ($k[0] * $p);&nbsp;</div></li><li><div>            ++$p;&nbsp;</div></li><li><div>            if ($p &gt; 20) {&nbsp;</div></li><li><div>                $p = 1;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $check %= 47;&nbsp;</div></li><li><div>        $c = $chars[$check];&nbsp;</div></li><li><div>        $code .= $c;&nbsp;</div></li><li><div>        // calculate check digit K&nbsp;</div></li><li><div>        $p = 1;&nbsp;</div></li><li><div>        $check = 0;&nbsp;</div></li><li><div>        for ($i = $len; $i &gt;= 0; --$i) {&nbsp;</div></li><li><div>            $k = array_keys($chars, $code{$i});&nbsp;</div></li><li><div>            $check += ($k[0] * $p);&nbsp;</div></li><li><div>            ++$p;&nbsp;</div></li><li><div>            if ($p &gt; 15) {&nbsp;</div></li><li><div>                $p = 1;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $check %= 47;&nbsp;</div></li><li><div>        $k = $chars[$check];&nbsp;</div></li><li><div>        $checksum = $c . $k;&nbsp;</div></li><li><div>        // resto respecial characters&nbsp;</div></li><li><div>        $checksum = strtr($checksum, '&lt;=&gt;?', chr(128) . chr(131) . chr(129) . chr(130));&nbsp;</div></li><li><div>        return $checksum;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Checksum for standard 2 of 5 barcodes.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function checksum_s25($code)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $len = strlen($code);&nbsp;</div></li><li><div>        $sum = 0;&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $len; $i+=2) {&nbsp;</div></li><li><div>            $sum += $code[$i];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $sum *= 3;&nbsp;</div></li><li><div>        for ($i = 1; $i &lt; $len; $i+=2) {&nbsp;</div></li><li><div>            $sum += ($code[$i]);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $r = $sum % 10;&nbsp;</div></li><li><div>        if ($r &gt; 0) {&nbsp;</div></li><li><div>            $r = (10 - $r);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $r;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * MSI.&nbsp;</div></li><li><div>     * Variation of Plessey code, with similar applications&nbsp;</div></li><li><div>     * Contains digits (0 to 9) and encodes the data only in the width of bars.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function barcode_msi($code, $checksum = false)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $chr['0'] = '100100100100';&nbsp;</div></li><li><div>        $chr['1'] = '100100100110';&nbsp;</div></li><li><div>        $chr['2'] = '100100110100';&nbsp;</div></li><li><div>        $chr['3'] = '100100110110';&nbsp;</div></li><li><div>        $chr['4'] = '100110100100';&nbsp;</div></li><li><div>        $chr['5'] = '100110100110';&nbsp;</div></li><li><div>        $chr['6'] = '100110110100';&nbsp;</div></li><li><div>        $chr['7'] = '100110110110';&nbsp;</div></li><li><div>        $chr['8'] = '110100100100';&nbsp;</div></li><li><div>        $chr['9'] = '110100100110';&nbsp;</div></li><li><div>        $chr['A'] = '110100110100';&nbsp;</div></li><li><div>        $chr['B'] = '110100110110';&nbsp;</div></li><li><div>        $chr['C'] = '110110100100';&nbsp;</div></li><li><div>        $chr['D'] = '110110100110';&nbsp;</div></li><li><div>        $chr['E'] = '110110110100';&nbsp;</div></li><li><div>        $chr['F'] = '110110110110';&nbsp;</div></li><li><div>        $checkdigit = '';&nbsp;</div></li><li><div>        if ($checksum) {&nbsp;</div></li><li><div>            // add checksum&nbsp;</div></li><li><div>            $clen = strlen($code);&nbsp;</div></li><li><div>            $p = 2;&nbsp;</div></li><li><div>            $check = 0;&nbsp;</div></li><li><div>            for ($i = ($clen - 1); $i &gt;= 0; --$i) {&nbsp;</div></li><li><div>                $check += (hexdec($code[$i]) * $p);&nbsp;</div></li><li><div>                ++$p;&nbsp;</div></li><li><div>                if ($p &gt; 7) {&nbsp;</div></li><li><div>                    $p = 2;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $check %= 11;&nbsp;</div></li><li><div>            if ($check &gt; 0) {&nbsp;</div></li><li><div>                $check = 11 - $check;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $code .= $check;&nbsp;</div></li><li><div>            $checkdigit = $check;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $seq = '110'; // left guard&nbsp;</div></li><li><div>        $clen = strlen($code);&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $clen; ++$i) {&nbsp;</div></li><li><div>            $digit = $code[$i];&nbsp;</div></li><li><div>            if (!isset($chr[$digit])) {&nbsp;</div></li><li><div>                // invalid character&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $seq .= $chr[$digit];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $seq .= '1001'; // right guard&nbsp;</div></li><li><div>        $bararray = array('code' =&gt; $code, 'maxw' =&gt; 0, 'maxh' =&gt; 1, 'bcode' =&gt; array());&nbsp;</div></li><li><div>        $bararray['checkdigit'] = $checkdigit;&nbsp;</div></li><li><div>        return $this-&gt;binseq_to_array($seq, $bararray);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Standard 2 of 5 barcodes.&nbsp;</div></li><li><div>     * Used in airline ticket marking, photofinishing&nbsp;</div></li><li><div>     * Contains digits (0 to 9) and encodes the data only in the width of bars.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function barcode_s25($code, $checksum = false)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $chr['0'] = '10101110111010';&nbsp;</div></li><li><div>        $chr['1'] = '11101010101110';&nbsp;</div></li><li><div>        $chr['2'] = '10111010101110';&nbsp;</div></li><li><div>        $chr['3'] = '11101110101010';&nbsp;</div></li><li><div>        $chr['4'] = '10101110101110';&nbsp;</div></li><li><div>        $chr['5'] = '11101011101010';&nbsp;</div></li><li><div>        $chr['6'] = '10111011101010';&nbsp;</div></li><li><div>        $chr['7'] = '10101011101110';&nbsp;</div></li><li><div>        $chr['8'] = '10101110111010';&nbsp;</div></li><li><div>        $chr['9'] = '10111010111010';&nbsp;</div></li><li><div>        $checkdigit = '';&nbsp;</div></li><li><div>        if ($checksum) {&nbsp;</div></li><li><div>            // add checksum&nbsp;</div></li><li><div>            $checkdigit = $this-&gt;checksum_s25($code);&nbsp;</div></li><li><div>            $code .= $checkdigit;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ((strlen($code) % 2) != 0) {&nbsp;</div></li><li><div>            // add leading zero if code-length is odd&nbsp;</div></li><li><div>            $code = '0' . $code;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $seq = '11011010';&nbsp;</div></li><li><div>        $clen = strlen($code);&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $clen; ++$i) {&nbsp;</div></li><li><div>            $digit = $code[$i];&nbsp;</div></li><li><div>            if (!isset($chr[$digit])) {&nbsp;</div></li><li><div>                // invalid character&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $seq .= $chr[$digit];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $seq .= '1101011';&nbsp;</div></li><li><div>        $bararray = array('code' =&gt; $code, 'maxw' =&gt; 0, 'maxh' =&gt; 1, 'bcode' =&gt; array());&nbsp;</div></li><li><div>        $bararray['checkdigit'] = $checkdigit;&nbsp;</div></li><li><div>        return $this-&gt;binseq_to_array($seq, $bararray);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Convert binary barcode sequence to barcode array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function binseq_to_array($seq, $bararray)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $len = strlen($seq);&nbsp;</div></li><li><div>        $w = 0;&nbsp;</div></li><li><div>        $k = 0;&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $len; ++$i) {&nbsp;</div></li><li><div>            $w += 1;&nbsp;</div></li><li><div>            if (($i == ($len - 1)) OR ( ($i &lt; ($len - 1)) AND ( $seq[$i] != $seq[($i + 1)]))) {&nbsp;</div></li><li><div>                if ($seq[$i] == '1') {&nbsp;</div></li><li><div>                    $t = true; // bar&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $t = false; // space&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $bararray['bcode'][$k] = array('t' =&gt; $t, 'w' =&gt; $w, 'h' =&gt; 1, 'p' =&gt; 0);&nbsp;</div></li><li><div>                $bararray['maxw'] += $w;&nbsp;</div></li><li><div>                ++$k;&nbsp;</div></li><li><div>                $w = 0;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $bararray;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Interleaved 2 of 5 barcodes.&nbsp;</div></li><li><div>     * Compact numeric code, widely used in industry, air cargo&nbsp;</div></li><li><div>     * Contains digits (0 to 9) and encodes the data in the width of both bars and spaces.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function barcode_i25($code, $checksum = false)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $chr['0'] = '11221';&nbsp;</div></li><li><div>        $chr['1'] = '21112';&nbsp;</div></li><li><div>        $chr['2'] = '12112';&nbsp;</div></li><li><div>        $chr['3'] = '22111';&nbsp;</div></li><li><div>        $chr['4'] = '11212';&nbsp;</div></li><li><div>        $chr['5'] = '21211';&nbsp;</div></li><li><div>        $chr['6'] = '12211';&nbsp;</div></li><li><div>        $chr['7'] = '11122';&nbsp;</div></li><li><div>        $chr['8'] = '21121';&nbsp;</div></li><li><div>        $chr['9'] = '12121';&nbsp;</div></li><li><div>        $chr['A'] = '11';&nbsp;</div></li><li><div>        $chr['Z'] = '21';&nbsp;</div></li><li><div>        $checkdigit = '';&nbsp;</div></li><li><div>        if ($checksum) {&nbsp;</div></li><li><div>            // add checksum&nbsp;</div></li><li><div>            $checkdigit = $this-&gt;checksum_s25($code);&nbsp;</div></li><li><div>            $code .= $checkdigit;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ((strlen($code) % 2) != 0) {&nbsp;</div></li><li><div>            // add leading zero if code-length is odd&nbsp;</div></li><li><div>            $code = '0' . $code;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // add start and stop codes&nbsp;</div></li><li><div>        $code = 'AA' . strtolower($code) . 'ZA';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $bararray = array('code' =&gt; $code, 'maxw' =&gt; 0, 'maxh' =&gt; 1, 'bcode' =&gt; array());&nbsp;</div></li><li><div>        $k = 0;&nbsp;</div></li><li><div>        $clen = strlen($code);&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $clen; $i = ($i + 2)) {&nbsp;</div></li><li><div>            $char_bar = $code[$i];&nbsp;</div></li><li><div>            $char_space = $code[$i + 1];&nbsp;</div></li><li><div>            if ((!isset($chr[$char_bar])) OR ( !isset($chr[$char_space]))) {&nbsp;</div></li><li><div>                // invalid character&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            // create a bar-space sequence&nbsp;</div></li><li><div>            $seq = '';&nbsp;</div></li><li><div>            $chrlen = strlen($chr[$char_bar]);&nbsp;</div></li><li><div>            for ($s = 0; $s &lt; $chrlen; $s++) {&nbsp;</div></li><li><div>                $seq .= $chr[$char_bar][$s] . $chr[$char_space][$s];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $seqlen = strlen($seq);&nbsp;</div></li><li><div>            for ($j = 0; $j &lt; $seqlen; ++$j) {&nbsp;</div></li><li><div>                if (($j % 2) == 0) {&nbsp;</div></li><li><div>                    $t = true; // bar&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $t = false; // space&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $x = $seq[$j];&nbsp;</div></li><li><div>                if ($x == 2) {&nbsp;</div></li><li><div>                    $w = $this-&gt;print_ratio;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $w = 1;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $bararray['bcode'][$k] = array('t' =&gt; $t, 'w' =&gt; $w, 'h' =&gt; 1, 'p' =&gt; 0);&nbsp;</div></li><li><div>                $bararray['maxw'] += $w;&nbsp;</div></li><li><div>                ++$k;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $bararray['checkdigit'] = $checkdigit;&nbsp;</div></li><li><div>        return $bararray;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * C128 barcodes.&nbsp;</div></li><li><div>     * Very capable code, excellent density, high reliability; in very wide use world-wide&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function barcode_c128($code, $type = 'B', $ean = false)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $code = strcode2utf($code); // mPDF 5.7.1    Allows e.g. &lt;barcode code=&quot;5432&#013;1068&quot; type=&quot;C128A&quot; /&gt;&nbsp;</div></li><li><div>        $chr = array(&nbsp;</div></li><li><div>            '212222', /** 00 */&nbsp;</div></li><li><div>            '222122', /** 01 */&nbsp;</div></li><li><div>            '222221', /** 02 */&nbsp;</div></li><li><div>            '121223', /** 03 */&nbsp;</div></li><li><div>            '121322', /** 04 */&nbsp;</div></li><li><div>            '131222', /** 05 */&nbsp;</div></li><li><div>            '122213', /** 06 */&nbsp;</div></li><li><div>            '122312', /** 07 */&nbsp;</div></li><li><div>            '132212', /** 08 */&nbsp;</div></li><li><div>            '221213', /** 09 */&nbsp;</div></li><li><div>            '221312', /** 10 */&nbsp;</div></li><li><div>            '231212', /** 11 */&nbsp;</div></li><li><div>            '112232', /** 12 */&nbsp;</div></li><li><div>            '122132', /** 13 */&nbsp;</div></li><li><div>            '122231', /** 14 */&nbsp;</div></li><li><div>            '113222', /** 15 */&nbsp;</div></li><li><div>            '123122', /** 16 */&nbsp;</div></li><li><div>            '123221', /** 17 */&nbsp;</div></li><li><div>            '223211', /** 18 */&nbsp;</div></li><li><div>            '221132', /** 19 */&nbsp;</div></li><li><div>            '221231', /** 20 */&nbsp;</div></li><li><div>            '213212', /** 21 */&nbsp;</div></li><li><div>            '223112', /** 22 */&nbsp;</div></li><li><div>            '312131', /** 23 */&nbsp;</div></li><li><div>            '311222', /** 24 */&nbsp;</div></li><li><div>            '321122', /** 25 */&nbsp;</div></li><li><div>            '321221', /** 26 */&nbsp;</div></li><li><div>            '312212', /** 27 */&nbsp;</div></li><li><div>            '322112', /** 28 */&nbsp;</div></li><li><div>            '322211', /** 29 */&nbsp;</div></li><li><div>            '212123', /** 30 */&nbsp;</div></li><li><div>            '212321', /** 31 */&nbsp;</div></li><li><div>            '232121', /** 32 */&nbsp;</div></li><li><div>            '111323', /** 33 */&nbsp;</div></li><li><div>            '131123', /** 34 */&nbsp;</div></li><li><div>            '131321', /** 35 */&nbsp;</div></li><li><div>            '112313', /** 36 */&nbsp;</div></li><li><div>            '132113', /** 37 */&nbsp;</div></li><li><div>            '132311', /** 38 */&nbsp;</div></li><li><div>            '211313', /** 39 */&nbsp;</div></li><li><div>            '231113', /** 40 */&nbsp;</div></li><li><div>            '231311', /** 41 */&nbsp;</div></li><li><div>            '112133', /** 42 */&nbsp;</div></li><li><div>            '112331', /** 43 */&nbsp;</div></li><li><div>            '132131', /** 44 */&nbsp;</div></li><li><div>            '113123', /** 45 */&nbsp;</div></li><li><div>            '113321', /** 46 */&nbsp;</div></li><li><div>            '133121', /** 47 */&nbsp;</div></li><li><div>            '313121', /** 48 */&nbsp;</div></li><li><div>            '211331', /** 49 */&nbsp;</div></li><li><div>            '231131', /** 50 */&nbsp;</div></li><li><div>            '213113', /** 51 */&nbsp;</div></li><li><div>            '213311', /** 52 */&nbsp;</div></li><li><div>            '213131', /** 53 */&nbsp;</div></li><li><div>            '311123', /** 54 */&nbsp;</div></li><li><div>            '311321', /** 55 */&nbsp;</div></li><li><div>            '331121', /** 56 */&nbsp;</div></li><li><div>            '312113', /** 57 */&nbsp;</div></li><li><div>            '312311', /** 58 */&nbsp;</div></li><li><div>            '332111', /** 59 */&nbsp;</div></li><li><div>            '314111', /** 60 */&nbsp;</div></li><li><div>            '221411', /** 61 */&nbsp;</div></li><li><div>            '431111', /** 62 */&nbsp;</div></li><li><div>            '111224', /** 63 */&nbsp;</div></li><li><div>            '111422', /** 64 */&nbsp;</div></li><li><div>            '121124', /** 65 */&nbsp;</div></li><li><div>            '121421', /** 66 */&nbsp;</div></li><li><div>            '141122', /** 67 */&nbsp;</div></li><li><div>            '141221', /** 68 */&nbsp;</div></li><li><div>            '112214', /** 69 */&nbsp;</div></li><li><div>            '112412', /** 70 */&nbsp;</div></li><li><div>            '122114', /** 71 */&nbsp;</div></li><li><div>            '122411', /** 72 */&nbsp;</div></li><li><div>            '142112', /** 73 */&nbsp;</div></li><li><div>            '142211', /** 74 */&nbsp;</div></li><li><div>            '241211', /** 75 */&nbsp;</div></li><li><div>            '221114', /** 76 */&nbsp;</div></li><li><div>            '413111', /** 77 */&nbsp;</div></li><li><div>            '241112', /** 78 */&nbsp;</div></li><li><div>            '134111', /** 79 */&nbsp;</div></li><li><div>            '111242', /** 80 */&nbsp;</div></li><li><div>            '121142', /** 81 */&nbsp;</div></li><li><div>            '121241', /** 82 */&nbsp;</div></li><li><div>            '114212', /** 83 */&nbsp;</div></li><li><div>            '124112', /** 84 */&nbsp;</div></li><li><div>            '124211', /** 85 */&nbsp;</div></li><li><div>            '411212', /** 86 */&nbsp;</div></li><li><div>            '421112', /** 87 */&nbsp;</div></li><li><div>            '421211', /** 88 */&nbsp;</div></li><li><div>            '212141', /** 89 */&nbsp;</div></li><li><div>            '214121', /** 90 */&nbsp;</div></li><li><div>            '412121', /** 91 */&nbsp;</div></li><li><div>            '111143', /** 92 */&nbsp;</div></li><li><div>            '111341', /** 93 */&nbsp;</div></li><li><div>            '131141', /** 94 */&nbsp;</div></li><li><div>            '114113', /** 95 */&nbsp;</div></li><li><div>            '114311', /** 96 */&nbsp;</div></li><li><div>            '411113', /** 97 */&nbsp;</div></li><li><div>            '411311', /** 98 */&nbsp;</div></li><li><div>            '113141', /** 99 */&nbsp;</div></li><li><div>            '114131', /** 100 */&nbsp;</div></li><li><div>            '311141', /** 101 */&nbsp;</div></li><li><div>            '411131', /** 102 */&nbsp;</div></li><li><div>            '211412', /** 103 START A */&nbsp;</div></li><li><div>            '211214', /** 104 START B  */&nbsp;</div></li><li><div>            '211232', /** 105 START C  */&nbsp;</div></li><li><div>            '233111', /** STOP */&nbsp;</div></li><li><div>            '200000' /** END */&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        $keys = '';&nbsp;</div></li><li><div>        switch (strtoupper($type)) {&nbsp;</div></li><li><div>            case 'A': {&nbsp;</div></li><li><div>                    $startid = 103;&nbsp;</div></li><li><div>                    $keys = ' !&quot;#$%&\'()*+, -./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_';&nbsp;</div></li><li><div>                    for ($i = 0; $i &lt; 32; ++$i) {&nbsp;</div></li><li><div>                        $keys .= chr($i);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'B': {&nbsp;</div></li><li><div>                    $startid = 104;&nbsp;</div></li><li><div>                    $keys = ' !&quot;#$%&\'()*+, -./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~' . chr(127);&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 'C': {&nbsp;</div></li><li><div>                    $startid = 105;&nbsp;</div></li><li><div>                    $keys = '';&nbsp;</div></li><li><div>                    if ((strlen($code) % 2) != 0) {&nbsp;</div></li><li><div>                        // The length of barcode value must be even ($code). You must pad the number with zeros&nbsp;</div></li><li><div>                        return false;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    for ($i = 0; $i &lt;= 99; ++$i) {&nbsp;</div></li><li><div>                        $keys .= chr($i);&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $new_code = '';&nbsp;</div></li><li><div>                    $hclen = (strlen($code) / 2);&nbsp;</div></li><li><div>                    for ($i = 0; $i &lt; $hclen; ++$i) {&nbsp;</div></li><li><div>                        $new_code .= chr(intval($code{(2 * $i)} . $code{(2 * $i + 1)}));&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $code = $new_code;&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            default: {&nbsp;</div></li><li><div>                    return false;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // calculate check character&nbsp;</div></li><li><div>        $sum = $startid;&nbsp;</div></li><li><div>        if ($ean) {&nbsp;</div></li><li><div>            $code = chr(102) . $code;&nbsp;</div></li><li><div>        } // Add FNC 1 - which identifies it as EAN-128&nbsp;</div></li><li><div>        $clen = strlen($code);&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $clen; ++$i) {&nbsp;</div></li><li><div>            if ($ean && $i == 0) {&nbsp;</div></li><li><div>                $sum += 102;&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $sum += (strpos($keys, $code[$i]) * ($i + 1));&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $check = ($sum % 103);&nbsp;</div></li><li><div>        $checkdigit = $check;&nbsp;</div></li><li><div>        // add start, check and stop codes&nbsp;</div></li><li><div>        $code = chr($startid) . $code . chr($check) . chr(106) . chr(107);&nbsp;</div></li><li><div>        $bararray = array('code' =&gt; $code, 'maxw' =&gt; 0, 'maxh' =&gt; 1, 'bcode' =&gt; array());&nbsp;</div></li><li><div>        $k = 0;&nbsp;</div></li><li><div>        $len = strlen($code);&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $len; ++$i) {&nbsp;</div></li><li><div>            $ck = strpos($keys, $code[$i]);&nbsp;</div></li><li><div>            if (($i == 0) || ($ean && $i == 1) | ($i &gt; ($len - 4))) {&nbsp;</div></li><li><div>                $char_num = ord($code[$i]);&nbsp;</div></li><li><div>                $seq = $chr[$char_num];&nbsp;</div></li><li><div>            } elseif (($ck &gt;= 0) AND isset($chr[$ck])) {&nbsp;</div></li><li><div>                $seq = $chr[$ck];&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                // invalid character&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            for ($j = 0; $j &lt; 6; ++$j) {&nbsp;</div></li><li><div>                if (($j % 2) == 0) {&nbsp;</div></li><li><div>                    $t = true; // bar&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $t = false; // space&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $w = $seq[$j];&nbsp;</div></li><li><div>                $bararray['bcode'][$k] = array('t' =&gt; $t, 'w' =&gt; $w, 'h' =&gt; 1, 'p' =&gt; 0);&nbsp;</div></li><li><div>                $bararray['maxw'] += $w;&nbsp;</div></li><li><div>                ++$k;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $bararray['checkdigit'] = $checkdigit;&nbsp;</div></li><li><div>        return $bararray;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * EAN13 and UPC-A barcodes.&nbsp;</div></li><li><div>     * EAN13: European Article Numbering international retail product code&nbsp;</div></li><li><div>     * UPC-A: Universal product code seen on almost all retail products in the USA and Canada&nbsp;</div></li><li><div>     * UPC-E: Short version of UPC symbol&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function barcode_eanupc($code, $len = 13)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $upce = false;&nbsp;</div></li><li><div>        $checkdigit = false;&nbsp;</div></li><li><div>        if ($len == 6) {&nbsp;</div></li><li><div>            $len = 12; // UPC-A&nbsp;</div></li><li><div>            $upce = true; // UPC-E mode&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $data_len = $len - 1;&nbsp;</div></li><li><div>        //Padding&nbsp;</div></li><li><div>        $code = str_pad($code, $data_len, '0', STR_PAD_LEFT);&nbsp;</div></li><li><div>        $code_len = strlen($code);&nbsp;</div></li><li><div>        // calculate check digit&nbsp;</div></li><li><div>        $sum_a = 0;&nbsp;</div></li><li><div>        for ($i = 1; $i &lt; $data_len; $i+=2) {&nbsp;</div></li><li><div>            $sum_a += $code[$i];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ($len &gt; 12) {&nbsp;</div></li><li><div>            $sum_a *= 3;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $sum_b = 0;&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $data_len; $i+=2) {&nbsp;</div></li><li><div>            $sum_b += ($code[$i]);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ($len &lt; 13) {&nbsp;</div></li><li><div>            $sum_b *= 3;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $r = ($sum_a + $sum_b) % 10;&nbsp;</div></li><li><div>        if ($r &gt; 0) {&nbsp;</div></li><li><div>            $r = (10 - $r);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ($code_len == $data_len) {&nbsp;</div></li><li><div>            // add check digit&nbsp;</div></li><li><div>            $code .= $r;&nbsp;</div></li><li><div>            $checkdigit = $r;&nbsp;</div></li><li><div>        } elseif ($r !== intval($code[$data_len])) {&nbsp;</div></li><li><div>            // wrong checkdigit&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ($len == 12) {&nbsp;</div></li><li><div>            // UPC-A&nbsp;</div></li><li><div>            $code = '0' . $code;&nbsp;</div></li><li><div>            ++$len;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ($upce) {&nbsp;</div></li><li><div>            // convert UPC-A to UPC-E&nbsp;</div></li><li><div>            $tmp = substr($code, 4, 3);&nbsp;</div></li><li><div>            $prod_code = intval(substr($code, 7, 5)); // product code&nbsp;</div></li><li><div>            $invalid_upce = false;&nbsp;</div></li><li><div>            if (($tmp == '000') OR ( $tmp == '100') OR ( $tmp == '200')) {&nbsp;</div></li><li><div>                // manufacturer code ends in 000, 100, or 200&nbsp;</div></li><li><div>                $upce_code = substr($code, 2, 2) . substr($code, 9, 3) . substr($code, 4, 1);&nbsp;</div></li><li><div>                if ($prod_code &gt; 999) {&nbsp;</div></li><li><div>                    $invalid_upce = true;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $tmp = substr($code, 5, 2);&nbsp;</div></li><li><div>                if ($tmp == '00') {&nbsp;</div></li><li><div>                    // manufacturer code ends in 00&nbsp;</div></li><li><div>                    $upce_code = substr($code, 2, 3) . substr($code, 10, 2) . '3';&nbsp;</div></li><li><div>                    if ($prod_code &gt; 99) {&nbsp;</div></li><li><div>                        $invalid_upce = true;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $tmp = substr($code, 6, 1);&nbsp;</div></li><li><div>                    if ($tmp == '0') {&nbsp;</div></li><li><div>                        // manufacturer code ends in 0&nbsp;</div></li><li><div>                        $upce_code = substr($code, 2, 4) . substr($code, 11, 1) . '4';&nbsp;</div></li><li><div>                        if ($prod_code &gt; 9) {&nbsp;</div></li><li><div>                            $invalid_upce = true;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        // manufacturer code does not end in zero&nbsp;</div></li><li><div>                        $upce_code = substr($code, 2, 5) . substr($code, 11, 1);&nbsp;</div></li><li><div>                        if ($prod_code &gt; 9) {&nbsp;</div></li><li><div>                            $invalid_upce = true;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ($invalid_upce) {&nbsp;</div></li><li><div>                throw new MpdfException('Error - UPC-A cannot produce a valid UPC-E barcode');&nbsp;</div></li><li><div>            } // Error generating a UPCE code&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // Convert digits to bars&nbsp;</div></li><li><div>        $codes = array(&nbsp;</div></li><li><div>            'A' =&gt; array(// left odd parity&nbsp;</div></li><li><div>                '0' =&gt; '0001101', &nbsp;</div></li><li><div>                '1' =&gt; '0011001', &nbsp;</div></li><li><div>                '2' =&gt; '0010011', &nbsp;</div></li><li><div>                '3' =&gt; '0111101', &nbsp;</div></li><li><div>                '4' =&gt; '0100011', &nbsp;</div></li><li><div>                '5' =&gt; '0110001', &nbsp;</div></li><li><div>                '6' =&gt; '0101111', &nbsp;</div></li><li><div>                '7' =&gt; '0111011', &nbsp;</div></li><li><div>                '8' =&gt; '0110111', &nbsp;</div></li><li><div>                '9' =&gt; '0001011'), &nbsp;</div></li><li><div>            'B' =&gt; array(// left even parity&nbsp;</div></li><li><div>                '0' =&gt; '0100111', &nbsp;</div></li><li><div>                '1' =&gt; '0110011', &nbsp;</div></li><li><div>                '2' =&gt; '0011011', &nbsp;</div></li><li><div>                '3' =&gt; '0100001', &nbsp;</div></li><li><div>                '4' =&gt; '0011101', &nbsp;</div></li><li><div>                '5' =&gt; '0111001', &nbsp;</div></li><li><div>                '6' =&gt; '0000101', &nbsp;</div></li><li><div>                '7' =&gt; '0010001', &nbsp;</div></li><li><div>                '8' =&gt; '0001001', &nbsp;</div></li><li><div>                '9' =&gt; '0010111'), &nbsp;</div></li><li><div>            'C' =&gt; array(// right&nbsp;</div></li><li><div>                '0' =&gt; '1110010', &nbsp;</div></li><li><div>                '1' =&gt; '1100110', &nbsp;</div></li><li><div>                '2' =&gt; '1101100', &nbsp;</div></li><li><div>                '3' =&gt; '1000010', &nbsp;</div></li><li><div>                '4' =&gt; '1011100', &nbsp;</div></li><li><div>                '5' =&gt; '1001110', &nbsp;</div></li><li><div>                '6' =&gt; '1010000', &nbsp;</div></li><li><div>                '7' =&gt; '1000100', &nbsp;</div></li><li><div>                '8' =&gt; '1001000', &nbsp;</div></li><li><div>                '9' =&gt; '1110100')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        $parities = array(&nbsp;</div></li><li><div>            '0' =&gt; array('A', 'A', 'A', 'A', 'A', 'A'), &nbsp;</div></li><li><div>            '1' =&gt; array('A', 'A', 'B', 'A', 'B', 'B'), &nbsp;</div></li><li><div>            '2' =&gt; array('A', 'A', 'B', 'B', 'A', 'B'), &nbsp;</div></li><li><div>            '3' =&gt; array('A', 'A', 'B', 'B', 'B', 'A'), &nbsp;</div></li><li><div>            '4' =&gt; array('A', 'B', 'A', 'A', 'B', 'B'), &nbsp;</div></li><li><div>            '5' =&gt; array('A', 'B', 'B', 'A', 'A', 'B'), &nbsp;</div></li><li><div>            '6' =&gt; array('A', 'B', 'B', 'B', 'A', 'A'), &nbsp;</div></li><li><div>            '7' =&gt; array('A', 'B', 'A', 'B', 'A', 'B'), &nbsp;</div></li><li><div>            '8' =&gt; array('A', 'B', 'A', 'B', 'B', 'A'), &nbsp;</div></li><li><div>            '9' =&gt; array('A', 'B', 'B', 'A', 'B', 'A')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        $upce_parities = array();&nbsp;</div></li><li><div>        $upce_parities[0] = array(&nbsp;</div></li><li><div>            '0' =&gt; array('B', 'B', 'B', 'A', 'A', 'A'), &nbsp;</div></li><li><div>            '1' =&gt; array('B', 'B', 'A', 'B', 'A', 'A'), &nbsp;</div></li><li><div>            '2' =&gt; array('B', 'B', 'A', 'A', 'B', 'A'), &nbsp;</div></li><li><div>            '3' =&gt; array('B', 'B', 'A', 'A', 'A', 'B'), &nbsp;</div></li><li><div>            '4' =&gt; array('B', 'A', 'B', 'B', 'A', 'A'), &nbsp;</div></li><li><div>            '5' =&gt; array('B', 'A', 'A', 'B', 'B', 'A'), &nbsp;</div></li><li><div>            '6' =&gt; array('B', 'A', 'A', 'A', 'B', 'B'), &nbsp;</div></li><li><div>            '7' =&gt; array('B', 'A', 'B', 'A', 'B', 'A'), &nbsp;</div></li><li><div>            '8' =&gt; array('B', 'A', 'B', 'A', 'A', 'B'), &nbsp;</div></li><li><div>            '9' =&gt; array('B', 'A', 'A', 'B', 'A', 'B')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        $upce_parities[1] = array(&nbsp;</div></li><li><div>            '0' =&gt; array('A', 'A', 'A', 'B', 'B', 'B'), &nbsp;</div></li><li><div>            '1' =&gt; array('A', 'A', 'B', 'A', 'B', 'B'), &nbsp;</div></li><li><div>            '2' =&gt; array('A', 'A', 'B', 'B', 'A', 'B'), &nbsp;</div></li><li><div>            '3' =&gt; array('A', 'A', 'B', 'B', 'B', 'A'), &nbsp;</div></li><li><div>            '4' =&gt; array('A', 'B', 'A', 'A', 'B', 'B'), &nbsp;</div></li><li><div>            '5' =&gt; array('A', 'B', 'B', 'A', 'A', 'B'), &nbsp;</div></li><li><div>            '6' =&gt; array('A', 'B', 'B', 'B', 'A', 'A'), &nbsp;</div></li><li><div>            '7' =&gt; array('A', 'B', 'A', 'B', 'A', 'B'), &nbsp;</div></li><li><div>            '8' =&gt; array('A', 'B', 'A', 'B', 'B', 'A'), &nbsp;</div></li><li><div>            '9' =&gt; array('A', 'B', 'B', 'A', 'B', 'A')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        $k = 0;&nbsp;</div></li><li><div>        $seq = '101'; // left guard bar&nbsp;</div></li><li><div>        if ($upce) {&nbsp;</div></li><li><div>            $bararray = array('code' =&gt; $upce_code, 'maxw' =&gt; 0, 'maxh' =&gt; 1, 'bcode' =&gt; array());&nbsp;</div></li><li><div>            $p = $upce_parities[$code{1}][$r];&nbsp;</div></li><li><div>            for ($i = 0; $i &lt; 6; ++$i) {&nbsp;</div></li><li><div>                $seq .= $codes[$p[$i]][$upce_code[$i]];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $seq .= '010101'; // right guard bar&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $bararray = array('code' =&gt; $code, 'maxw' =&gt; 0, 'maxh' =&gt; 1, 'bcode' =&gt; array());&nbsp;</div></li><li><div>            $half_len = ceil($len / 2);&nbsp;</div></li><li><div>            if ($len == 8) {&nbsp;</div></li><li><div>                for ($i = 0; $i &lt; $half_len; ++$i) {&nbsp;</div></li><li><div>                    $seq .= $codes['A'][$code[(int) $i]];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $p = $parities[$code{0}];&nbsp;</div></li><li><div>                for ($i = 1; $i &lt; $half_len; ++$i) {&nbsp;</div></li><li><div>                    $seq .= $codes[$p[$i - 1]][$code[(int) $i]];&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $seq .= '01010'; // center guard bar&nbsp;</div></li><li><div>            for ($i = $half_len; $i &lt; $len; ++$i) {&nbsp;</div></li><li><div>                $seq .= $codes['C'][$code[(int) $i]];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $seq .= '101'; // right guard bar&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $clen = strlen($seq);&nbsp;</div></li><li><div>        $w = 0;&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $clen; ++$i) {&nbsp;</div></li><li><div>            $w += 1;&nbsp;</div></li><li><div>            if (($i == ($clen - 1)) OR ( ($i &lt; ($clen - 1)) AND ( $seq[$i] != $seq[($i + 1)]))) {&nbsp;</div></li><li><div>                if ($seq[$i] == '1') {&nbsp;</div></li><li><div>                    $t = true; // bar&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $t = false; // space&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $bararray['bcode'][$k] = array('t' =&gt; $t, 'w' =&gt; $w, 'h' =&gt; 1, 'p' =&gt; 0);&nbsp;</div></li><li><div>                $bararray['maxw'] += $w;&nbsp;</div></li><li><div>                ++$k;&nbsp;</div></li><li><div>                $w = 0;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $bararray['checkdigit'] = $checkdigit;&nbsp;</div></li><li><div>        return $bararray;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * UPC-Based Extentions&nbsp;</div></li><li><div>     * 2-Digit Ext.: Used to indicate magazines and newspaper issue numbers&nbsp;</div></li><li><div>     * 5-Digit Ext.: Used to mark suggested retail price of books&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function barcode_eanext($code, $len = 5)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Padding&nbsp;</div></li><li><div>        $code = str_pad($code, $len, '0', STR_PAD_LEFT);&nbsp;</div></li><li><div>        // calculate check digit&nbsp;</div></li><li><div>        if ($len == 2) {&nbsp;</div></li><li><div>            $r = $code % 4;&nbsp;</div></li><li><div>        } elseif ($len == 5) {&nbsp;</div></li><li><div>            $r = (3 * ($code{0} + $code{2} + $code{4})) + (9 * ($code{1} + $code{3}));&nbsp;</div></li><li><div>            $r %= 10;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        //Convert digits to bars&nbsp;</div></li><li><div>        $codes = array(&nbsp;</div></li><li><div>            'A' =&gt; array(// left odd parity&nbsp;</div></li><li><div>                '0' =&gt; '0001101', &nbsp;</div></li><li><div>                '1' =&gt; '0011001', &nbsp;</div></li><li><div>                '2' =&gt; '0010011', &nbsp;</div></li><li><div>                '3' =&gt; '0111101', &nbsp;</div></li><li><div>                '4' =&gt; '0100011', &nbsp;</div></li><li><div>                '5' =&gt; '0110001', &nbsp;</div></li><li><div>                '6' =&gt; '0101111', &nbsp;</div></li><li><div>                '7' =&gt; '0111011', &nbsp;</div></li><li><div>                '8' =&gt; '0110111', &nbsp;</div></li><li><div>                '9' =&gt; '0001011'), &nbsp;</div></li><li><div>            'B' =&gt; array(// left even parity&nbsp;</div></li><li><div>                '0' =&gt; '0100111', &nbsp;</div></li><li><div>                '1' =&gt; '0110011', &nbsp;</div></li><li><div>                '2' =&gt; '0011011', &nbsp;</div></li><li><div>                '3' =&gt; '0100001', &nbsp;</div></li><li><div>                '4' =&gt; '0011101', &nbsp;</div></li><li><div>                '5' =&gt; '0111001', &nbsp;</div></li><li><div>                '6' =&gt; '0000101', &nbsp;</div></li><li><div>                '7' =&gt; '0010001', &nbsp;</div></li><li><div>                '8' =&gt; '0001001', &nbsp;</div></li><li><div>                '9' =&gt; '0010111')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        $parities = array();&nbsp;</div></li><li><div>        $parities[2] = array(&nbsp;</div></li><li><div>            '0' =&gt; array('A', 'A'), &nbsp;</div></li><li><div>            '1' =&gt; array('A', 'B'), &nbsp;</div></li><li><div>            '2' =&gt; array('B', 'A'), &nbsp;</div></li><li><div>            '3' =&gt; array('B', 'B')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        $parities[5] = array(&nbsp;</div></li><li><div>            '0' =&gt; array('B', 'B', 'A', 'A', 'A'), &nbsp;</div></li><li><div>            '1' =&gt; array('B', 'A', 'B', 'A', 'A'), &nbsp;</div></li><li><div>            '2' =&gt; array('B', 'A', 'A', 'B', 'A'), &nbsp;</div></li><li><div>            '3' =&gt; array('B', 'A', 'A', 'A', 'B'), &nbsp;</div></li><li><div>            '4' =&gt; array('A', 'B', 'B', 'A', 'A'), &nbsp;</div></li><li><div>            '5' =&gt; array('A', 'A', 'B', 'B', 'A'), &nbsp;</div></li><li><div>            '6' =&gt; array('A', 'A', 'A', 'B', 'B'), &nbsp;</div></li><li><div>            '7' =&gt; array('A', 'B', 'A', 'B', 'A'), &nbsp;</div></li><li><div>            '8' =&gt; array('A', 'B', 'A', 'A', 'B'), &nbsp;</div></li><li><div>            '9' =&gt; array('A', 'A', 'B', 'A', 'B')&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        $p = $parities[$len][$r];&nbsp;</div></li><li><div>        $seq = '1011'; // left guard bar&nbsp;</div></li><li><div>        $seq .= $codes[$p[0]][$code{0}];&nbsp;</div></li><li><div>        for ($i = 1; $i &lt; $len; ++$i) {&nbsp;</div></li><li><div>            $seq .= '01'; // separator&nbsp;</div></li><li><div>            $seq .= $codes[$p[$i]][$code[$i]];&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $bararray = array('code' =&gt; $code, 'maxw' =&gt; 0, 'maxh' =&gt; 1, 'bcode' =&gt; array());&nbsp;</div></li><li><div>        return $this-&gt;binseq_to_array($seq, $bararray);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * POSTNET and PLANET barcodes.&nbsp;</div></li><li><div>     * Used by U.S. Postal Service for automated mail sorting&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function barcode_postnet($code, $planet = false)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        // bar lenght&nbsp;</div></li><li><div>        if ($planet) {&nbsp;</div></li><li><div>            $barlen = Array(&nbsp;</div></li><li><div>                0 =&gt; Array(1, 1, 2, 2, 2), &nbsp;</div></li><li><div>                1 =&gt; Array(2, 2, 2, 1, 1), &nbsp;</div></li><li><div>                2 =&gt; Array(2, 2, 1, 2, 1), &nbsp;</div></li><li><div>                3 =&gt; Array(2, 2, 1, 1, 2), &nbsp;</div></li><li><div>                4 =&gt; Array(2, 1, 2, 2, 1), &nbsp;</div></li><li><div>                5 =&gt; Array(2, 1, 2, 1, 2), &nbsp;</div></li><li><div>                6 =&gt; Array(2, 1, 1, 2, 2), &nbsp;</div></li><li><div>                7 =&gt; Array(1, 2, 2, 2, 1), &nbsp;</div></li><li><div>                8 =&gt; Array(1, 2, 2, 1, 2), &nbsp;</div></li><li><div>                9 =&gt; Array(1, 2, 1, 2, 2)&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $barlen = Array(&nbsp;</div></li><li><div>                0 =&gt; Array(2, 2, 1, 1, 1), &nbsp;</div></li><li><div>                1 =&gt; Array(1, 1, 1, 2, 2), &nbsp;</div></li><li><div>                2 =&gt; Array(1, 1, 2, 1, 2), &nbsp;</div></li><li><div>                3 =&gt; Array(1, 1, 2, 2, 1), &nbsp;</div></li><li><div>                4 =&gt; Array(1, 2, 1, 1, 2), &nbsp;</div></li><li><div>                5 =&gt; Array(1, 2, 1, 2, 1), &nbsp;</div></li><li><div>                6 =&gt; Array(1, 2, 2, 1, 1), &nbsp;</div></li><li><div>                7 =&gt; Array(2, 1, 1, 1, 2), &nbsp;</div></li><li><div>                8 =&gt; Array(2, 1, 1, 2, 1), &nbsp;</div></li><li><div>                9 =&gt; Array(2, 1, 2, 1, 1)&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $bararray = array('code' =&gt; $code, 'maxw' =&gt; 0, 'maxh' =&gt; 5, 'bcode' =&gt; array());&nbsp;</div></li><li><div>        $k = 0;&nbsp;</div></li><li><div>        $code = str_replace('-', '', $code);&nbsp;</div></li><li><div>        $code = str_replace(' ', '', $code);&nbsp;</div></li><li><div>        $len = strlen($code);&nbsp;</div></li><li><div>        // calculate checksum&nbsp;</div></li><li><div>        $sum = 0;&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $len; ++$i) {&nbsp;</div></li><li><div>            $sum += intval($code[$i]);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $chkd = ($sum % 10);&nbsp;</div></li><li><div>        if ($chkd &gt; 0) {&nbsp;</div></li><li><div>            $chkd = (10 - $chkd);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $code .= $chkd;&nbsp;</div></li><li><div>        $checkdigit = $chkd;&nbsp;</div></li><li><div>        $len = strlen($code);&nbsp;</div></li><li><div>        // start bar&nbsp;</div></li><li><div>        $bararray['bcode'][$k++] = array('t' =&gt; 1, 'w' =&gt; 1, 'h' =&gt; 5, 'p' =&gt; 0);&nbsp;</div></li><li><div>        $bararray['bcode'][$k++] = array('t' =&gt; 0, 'w' =&gt; $this-&gt;gapwidth, 'h' =&gt; 5, 'p' =&gt; 0);&nbsp;</div></li><li><div>        $bararray['maxw'] += (1 + $this-&gt;gapwidth );&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $len; ++$i) {&nbsp;</div></li><li><div>            for ($j = 0; $j &lt; 5; ++$j) {&nbsp;</div></li><li><div>                $bh = $barlen[$code[$i]][$j];&nbsp;</div></li><li><div>                if ($bh == 2) {&nbsp;</div></li><li><div>                    $h = 5;&nbsp;</div></li><li><div>                    $p = 0;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $h = 2;&nbsp;</div></li><li><div>                    $p = 3;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $bararray['bcode'][$k++] = array('t' =&gt; 1, 'w' =&gt; 1, 'h' =&gt; $h, 'p' =&gt; $p);&nbsp;</div></li><li><div>                $bararray['bcode'][$k++] = array('t' =&gt; 0, 'w' =&gt; $this-&gt;gapwidth, 'h' =&gt; 2, 'p' =&gt; 0);&nbsp;</div></li><li><div>                $bararray['maxw'] += (1 + $this-&gt;gapwidth );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // end bar&nbsp;</div></li><li><div>        $bararray['bcode'][$k++] = array('t' =&gt; 1, 'w' =&gt; 1, 'h' =&gt; 5, 'p' =&gt; 0);&nbsp;</div></li><li><div>        $bararray['maxw'] += 1;&nbsp;</div></li><li><div>        $bararray['checkdigit'] = $checkdigit;&nbsp;</div></li><li><div>        return $bararray;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * RM4SCC - CBC - KIX&nbsp;</div></li><li><div>     * RM4SCC (Royal Mail 4-state Customer Code) - CBC (Customer Bar Code) - KIX (Klant index - Customer index)&nbsp;</div></li><li><div>     * RM4SCC is the name of the barcode symbology used by the Royal Mail for its Cleanmail service.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function barcode_rm4scc($code, $kix = false)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $notkix = !$kix;&nbsp;</div></li><li><div>        // bar mode&nbsp;</div></li><li><div>        // 1 = pos 1, length 2&nbsp;</div></li><li><div>        // 2 = pos 1, length 3&nbsp;</div></li><li><div>        // 3 = pos 2, length 1&nbsp;</div></li><li><div>        // 4 = pos 2, length 2&nbsp;</div></li><li><div>        $barmode = array(&nbsp;</div></li><li><div>            '0' =&gt; array(3, 3, 2, 2), &nbsp;</div></li><li><div>            '1' =&gt; array(3, 4, 1, 2), &nbsp;</div></li><li><div>            '2' =&gt; array(3, 4, 2, 1), &nbsp;</div></li><li><div>            '3' =&gt; array(4, 3, 1, 2), &nbsp;</div></li><li><div>            '4' =&gt; array(4, 3, 2, 1), &nbsp;</div></li><li><div>            '5' =&gt; array(4, 4, 1, 1), &nbsp;</div></li><li><div>            '6' =&gt; array(3, 1, 4, 2), &nbsp;</div></li><li><div>            '7' =&gt; array(3, 2, 3, 2), &nbsp;</div></li><li><div>            '8' =&gt; array(3, 2, 4, 1), &nbsp;</div></li><li><div>            '9' =&gt; array(4, 1, 3, 2), &nbsp;</div></li><li><div>            'A' =&gt; array(4, 1, 4, 1), &nbsp;</div></li><li><div>            'B' =&gt; array(4, 2, 3, 1), &nbsp;</div></li><li><div>            'C' =&gt; array(3, 1, 2, 4), &nbsp;</div></li><li><div>            'D' =&gt; array(3, 2, 1, 4), &nbsp;</div></li><li><div>            'E' =&gt; array(3, 2, 2, 3), &nbsp;</div></li><li><div>            'F' =&gt; array(4, 1, 1, 4), &nbsp;</div></li><li><div>            'G' =&gt; array(4, 1, 2, 3), &nbsp;</div></li><li><div>            'H' =&gt; array(4, 2, 1, 3), &nbsp;</div></li><li><div>            'I' =&gt; array(1, 3, 4, 2), &nbsp;</div></li><li><div>            'J' =&gt; array(1, 4, 3, 2), &nbsp;</div></li><li><div>            'K' =&gt; array(1, 4, 4, 1), &nbsp;</div></li><li><div>            'L' =&gt; array(2, 3, 3, 2), &nbsp;</div></li><li><div>            'M' =&gt; array(2, 3, 4, 1), &nbsp;</div></li><li><div>            'N' =&gt; array(2, 4, 3, 1), &nbsp;</div></li><li><div>            'O' =&gt; array(1, 3, 2, 4), &nbsp;</div></li><li><div>            'P' =&gt; array(1, 4, 1, 4), &nbsp;</div></li><li><div>            'Q' =&gt; array(1, 4, 2, 3), &nbsp;</div></li><li><div>            'R' =&gt; array(2, 3, 1, 4), &nbsp;</div></li><li><div>            'S' =&gt; array(2, 3, 2, 3), &nbsp;</div></li><li><div>            'T' =&gt; array(2, 4, 1, 3), &nbsp;</div></li><li><div>            'U' =&gt; array(1, 1, 4, 4), &nbsp;</div></li><li><div>            'V' =&gt; array(1, 2, 3, 4), &nbsp;</div></li><li><div>            'W' =&gt; array(1, 2, 4, 3), &nbsp;</div></li><li><div>            'X' =&gt; array(2, 1, 3, 4), &nbsp;</div></li><li><div>            'Y' =&gt; array(2, 1, 4, 3), &nbsp;</div></li><li><div>            'Z' =&gt; array(2, 2, 3, 3)&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        $code = strtoupper($code);&nbsp;</div></li><li><div>        $len = strlen($code);&nbsp;</div></li><li><div>        $bararray = array('code' =&gt; $code, 'maxw' =&gt; 0, 'maxh' =&gt; $this-&gt;daft['F'], 'bcode' =&gt; array());&nbsp;</div></li><li><div>        if ($notkix) {&nbsp;</div></li><li><div>            // table for checksum calculation (row, col)&nbsp;</div></li><li><div>            $checktable = array(&nbsp;</div></li><li><div>                '0' =&gt; array(1, 1), &nbsp;</div></li><li><div>                '1' =&gt; array(1, 2), &nbsp;</div></li><li><div>                '2' =&gt; array(1, 3), &nbsp;</div></li><li><div>                '3' =&gt; array(1, 4), &nbsp;</div></li><li><div>                '4' =&gt; array(1, 5), &nbsp;</div></li><li><div>                '5' =&gt; array(1, 0), &nbsp;</div></li><li><div>                '6' =&gt; array(2, 1), &nbsp;</div></li><li><div>                '7' =&gt; array(2, 2), &nbsp;</div></li><li><div>                '8' =&gt; array(2, 3), &nbsp;</div></li><li><div>                '9' =&gt; array(2, 4), &nbsp;</div></li><li><div>                'A' =&gt; array(2, 5), &nbsp;</div></li><li><div>                'B' =&gt; array(2, 0), &nbsp;</div></li><li><div>                'C' =&gt; array(3, 1), &nbsp;</div></li><li><div>                'D' =&gt; array(3, 2), &nbsp;</div></li><li><div>                'E' =&gt; array(3, 3), &nbsp;</div></li><li><div>                'F' =&gt; array(3, 4), &nbsp;</div></li><li><div>                'G' =&gt; array(3, 5), &nbsp;</div></li><li><div>                'H' =&gt; array(3, 0), &nbsp;</div></li><li><div>                'I' =&gt; array(4, 1), &nbsp;</div></li><li><div>                'J' =&gt; array(4, 2), &nbsp;</div></li><li><div>                'K' =&gt; array(4, 3), &nbsp;</div></li><li><div>                'L' =&gt; array(4, 4), &nbsp;</div></li><li><div>                'M' =&gt; array(4, 5), &nbsp;</div></li><li><div>                'N' =&gt; array(4, 0), &nbsp;</div></li><li><div>                'O' =&gt; array(5, 1), &nbsp;</div></li><li><div>                'P' =&gt; array(5, 2), &nbsp;</div></li><li><div>                'Q' =&gt; array(5, 3), &nbsp;</div></li><li><div>                'R' =&gt; array(5, 4), &nbsp;</div></li><li><div>                'S' =&gt; array(5, 5), &nbsp;</div></li><li><div>                'T' =&gt; array(5, 0), &nbsp;</div></li><li><div>                'U' =&gt; array(0, 1), &nbsp;</div></li><li><div>                'V' =&gt; array(0, 2), &nbsp;</div></li><li><div>                'W' =&gt; array(0, 3), &nbsp;</div></li><li><div>                'X' =&gt; array(0, 4), &nbsp;</div></li><li><div>                'Y' =&gt; array(0, 5), &nbsp;</div></li><li><div>                'Z' =&gt; array(0, 0)&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            $row = 0;&nbsp;</div></li><li><div>            $col = 0;&nbsp;</div></li><li><div>            for ($i = 0; $i &lt; $len; ++$i) {&nbsp;</div></li><li><div>                $row += $checktable[$code[$i]][0];&nbsp;</div></li><li><div>                $col += $checktable[$code[$i]][1];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $row %= 6;&nbsp;</div></li><li><div>            $col %= 6;&nbsp;</div></li><li><div>            $chk = array_keys($checktable, array($row, $col));&nbsp;</div></li><li><div>            $code .= $chk[0];&nbsp;</div></li><li><div>            $bararray['checkdigit'] = $chk[0];&nbsp;</div></li><li><div>            ++$len;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $k = 0;&nbsp;</div></li><li><div>        if ($notkix) {&nbsp;</div></li><li><div>            // start bar&nbsp;</div></li><li><div>            $bararray['bcode'][$k++] = array('t' =&gt; 1, 'w' =&gt; 1, 'h' =&gt; $this-&gt;daft['A'], 'p' =&gt; 0);&nbsp;</div></li><li><div>            $bararray['bcode'][$k++] = array('t' =&gt; 0, 'w' =&gt; $this-&gt;gapwidth, 'h' =&gt; $this-&gt;daft['A'], 'p' =&gt; 0);&nbsp;</div></li><li><div>            $bararray['maxw'] += (1 + $this-&gt;gapwidth);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $len; ++$i) {&nbsp;</div></li><li><div>            for ($j = 0; $j &lt; 4; ++$j) {&nbsp;</div></li><li><div>                switch ($barmode[$code[$i]][$j]) {&nbsp;</div></li><li><div>                    case 1: {&nbsp;</div></li><li><div>                            // ascender (A)&nbsp;</div></li><li><div>                            $p = 0;&nbsp;</div></li><li><div>                            $h = $this-&gt;daft['A'];&nbsp;</div></li><li><div>                            break;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    case 2: {&nbsp;</div></li><li><div>                            // full bar (F)&nbsp;</div></li><li><div>                            $p = 0;&nbsp;</div></li><li><div>                            $h = $this-&gt;daft['F'];&nbsp;</div></li><li><div>                            break;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    case 3: {&nbsp;</div></li><li><div>                            // tracker (T)&nbsp;</div></li><li><div>                            $p = ($this-&gt;daft['F'] - $this-&gt;daft['T']) / 2;&nbsp;</div></li><li><div>                            $h = $this-&gt;daft['T'];&nbsp;</div></li><li><div>                            break;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                    case 4: {&nbsp;</div></li><li><div>                            // descender (D)&nbsp;</div></li><li><div>                            $p = $this-&gt;daft['F'] - $this-&gt;daft['D'];&nbsp;</div></li><li><div>                            $h = $this-&gt;daft['D'];&nbsp;</div></li><li><div>                            break;&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                $bararray['bcode'][$k++] = array('t' =&gt; 1, 'w' =&gt; 1, 'h' =&gt; $h, 'p' =&gt; $p);&nbsp;</div></li><li><div>                $bararray['bcode'][$k++] = array('t' =&gt; 0, 'w' =&gt; $this-&gt;gapwidth, 'h' =&gt; 2, 'p' =&gt; 0);&nbsp;</div></li><li><div>                $bararray['maxw'] += (1 + $this-&gt;gapwidth);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ($notkix) {&nbsp;</div></li><li><div>            // stop bar&nbsp;</div></li><li><div>            $bararray['bcode'][$k++] = array('t' =&gt; 1, 'w' =&gt; 1, 'h' =&gt; $this-&gt;daft['F'], 'p' =&gt; 0);&nbsp;</div></li><li><div>            $bararray['maxw'] += 1;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $bararray;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * CODABAR barcodes.&nbsp;</div></li><li><div>     * Older code often used in library systems, sometimes in blood banks&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function barcode_codabar($code)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $chr = array(&nbsp;</div></li><li><div>            '0' =&gt; '11111221', &nbsp;</div></li><li><div>            '1' =&gt; '11112211', &nbsp;</div></li><li><div>            '2' =&gt; '11121121', &nbsp;</div></li><li><div>            '3' =&gt; '22111111', &nbsp;</div></li><li><div>            '4' =&gt; '11211211', &nbsp;</div></li><li><div>            '5' =&gt; '21111211', &nbsp;</div></li><li><div>            '6' =&gt; '12111121', &nbsp;</div></li><li><div>            '7' =&gt; '12112111', &nbsp;</div></li><li><div>            '8' =&gt; '12211111', &nbsp;</div></li><li><div>            '9' =&gt; '21121111', &nbsp;</div></li><li><div>            '-' =&gt; '11122111', &nbsp;</div></li><li><div>            '$' =&gt; '11221111', &nbsp;</div></li><li><div>            ':' =&gt; '21112121', &nbsp;</div></li><li><div>            '/' =&gt; '21211121', &nbsp;</div></li><li><div>            '.' =&gt; '21212111', &nbsp;</div></li><li><div>            '+' =&gt; '11222221', &nbsp;</div></li><li><div>            'A' =&gt; '11221211', &nbsp;</div></li><li><div>            'B' =&gt; '12121121', &nbsp;</div></li><li><div>            'C' =&gt; '11121221', &nbsp;</div></li><li><div>            'D' =&gt; '11122211'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        $bararray = array('code' =&gt; $code, 'maxw' =&gt; 0, 'maxh' =&gt; 1, 'bcode' =&gt; array());&nbsp;</div></li><li><div>        $k = 0;&nbsp;</div></li><li><div>        $w = 0;&nbsp;</div></li><li><div>        $seq = '';&nbsp;</div></li><li><div>        $code = strtoupper($code);&nbsp;</div></li><li><div>        $len = strlen($code);&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $len; ++$i) {&nbsp;</div></li><li><div>            if (!isset($chr[$code[$i]])) {&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $seq = $chr[$code[$i]];&nbsp;</div></li><li><div>            for ($j = 0; $j &lt; 8; ++$j) {&nbsp;</div></li><li><div>                if (($j % 2) == 0) {&nbsp;</div></li><li><div>                    $t = true; // bar&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $t = false; // space&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $x = $seq[$j];&nbsp;</div></li><li><div>                if ($x == 2) {&nbsp;</div></li><li><div>                    $w = $this-&gt;print_ratio;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $w = 1;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $bararray['bcode'][$k] = array('t' =&gt; $t, 'w' =&gt; $w, 'h' =&gt; 1, 'p' =&gt; 0);&nbsp;</div></li><li><div>                $bararray['maxw'] += $w;&nbsp;</div></li><li><div>                ++$k;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $bararray;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * CODE11 barcodes.&nbsp;</div></li><li><div>     * Used primarily for labeling telecommunications equipment&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function barcode_code11($code)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $chr = array(&nbsp;</div></li><li><div>            '0' =&gt; '111121', &nbsp;</div></li><li><div>            '1' =&gt; '211121', &nbsp;</div></li><li><div>            '2' =&gt; '121121', &nbsp;</div></li><li><div>            '3' =&gt; '221111', &nbsp;</div></li><li><div>            '4' =&gt; '112121', &nbsp;</div></li><li><div>            '5' =&gt; '212111', &nbsp;</div></li><li><div>            '6' =&gt; '122111', &nbsp;</div></li><li><div>            '7' =&gt; '111221', &nbsp;</div></li><li><div>            '8' =&gt; '211211', &nbsp;</div></li><li><div>            '9' =&gt; '211111', &nbsp;</div></li><li><div>            '-' =&gt; '112111', &nbsp;</div></li><li><div>            'S' =&gt; '112211'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $bararray = array('code' =&gt; $code, 'maxw' =&gt; 0, 'maxh' =&gt; 1, 'bcode' =&gt; array());&nbsp;</div></li><li><div>        $k = 0;&nbsp;</div></li><li><div>        $w = 0;&nbsp;</div></li><li><div>        $seq = '';&nbsp;</div></li><li><div>        $len = strlen($code);&nbsp;</div></li><li><div>        // calculate check digit C&nbsp;</div></li><li><div>        $p = 1;&nbsp;</div></li><li><div>        $check = 0;&nbsp;</div></li><li><div>        for ($i = ($len - 1); $i &gt;= 0; --$i) {&nbsp;</div></li><li><div>            $digit = $code[$i];&nbsp;</div></li><li><div>            if ($digit == '-') {&nbsp;</div></li><li><div>                $dval = 10;&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $dval = intval($digit);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $check += ($dval * $p);&nbsp;</div></li><li><div>            ++$p;&nbsp;</div></li><li><div>            if ($p &gt; 10) {&nbsp;</div></li><li><div>                $p = 1;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $check %= 11;&nbsp;</div></li><li><div>        if ($check == 10) {&nbsp;</div></li><li><div>            $check = '-';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $code .= $check;&nbsp;</div></li><li><div>        $checkdigit = $check;&nbsp;</div></li><li><div>        if ($len &gt; 10) {&nbsp;</div></li><li><div>            // calculate check digit K&nbsp;</div></li><li><div>            $p = 1;&nbsp;</div></li><li><div>            $check = 0;&nbsp;</div></li><li><div>            for ($i = $len; $i &gt;= 0; --$i) {&nbsp;</div></li><li><div>                $digit = $code[$i];&nbsp;</div></li><li><div>                if ($digit == '-') {&nbsp;</div></li><li><div>                    $dval = 10;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $dval = intval($digit);&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $check += ($dval * $p);&nbsp;</div></li><li><div>                ++$p;&nbsp;</div></li><li><div>                if ($p &gt; 9) {&nbsp;</div></li><li><div>                    $p = 1;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $check %= 11;&nbsp;</div></li><li><div>            $code .= $check;&nbsp;</div></li><li><div>            $checkdigit .= $check;&nbsp;</div></li><li><div>            ++$len;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $code = 'S' . $code . 'S';&nbsp;</div></li><li><div>        $len += 3;&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; $len; ++$i) {&nbsp;</div></li><li><div>            if (!isset($chr[$code[$i]])) {&nbsp;</div></li><li><div>                return false;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $seq = $chr[$code[$i]];&nbsp;</div></li><li><div>            for ($j = 0; $j &lt; 6; ++$j) {&nbsp;</div></li><li><div>                if (($j % 2) == 0) {&nbsp;</div></li><li><div>                    $t = true; // bar&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $t = false; // space&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $x = $seq[$j];&nbsp;</div></li><li><div>                if ($x == 2) {&nbsp;</div></li><li><div>                    $w = $this-&gt;print_ratio;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $w = 1;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $bararray['bcode'][$k] = array('t' =&gt; $t, 'w' =&gt; $w, 'h' =&gt; 1, 'p' =&gt; 0);&nbsp;</div></li><li><div>                $bararray['maxw'] += $w;&nbsp;</div></li><li><div>                ++$k;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $bararray['checkdigit'] = $checkdigit;&nbsp;</div></li><li><div>        return $bararray;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * IMB - Intelligent Mail Barcode - Onecode - USPS-B-3200&nbsp;</div></li><li><div>     * (requires PHP bcmath extension)&nbsp;</div></li><li><div>     * Intelligent Mail barcode is a 65-bar code for use on mail in the United States.&nbsp;</div></li><li><div>     * The fields are described as follows:&lt;ul&gt;&lt;li&gt;The Barcode Identifier shall be assigned by USPS to encode the presort identification that is currently printed in human readable form on the optional endorsement line (OEL) as well as for future USPS use. This shall be two digits, with the second digit in the range of 0-4. The allowable encoding ranges shall be 00-04, 10-14, 20-24, 30-34, 40-44, 50-54, 60-64, 70-74, 80-84, and 90-94.&lt;/li&gt;&lt;li&gt;The Service Type Identifier shall be assigned by USPS for any combination of services requested on the mailpiece. The allowable encoding range shall be 000-999. Each 3-digit value shall correspond to a particular mail class with a particular combination of service(s). Each service program, such as OneCode Confirm and OneCode ACS, shall provide the list of Service Type Identifier values.&lt;/li&gt;&lt;li&gt;The Mailer or Customer Identifier shall be assigned by USPS as a unique, 6 or 9 digit number that identifies a business entity. The allowable encoding range for the 6 digit Mailer ID shall be 000000- 899999, while the allowable encoding range for the 9 digit Mailer ID shall be 900000000-999999999.&lt;/li&gt;&lt;li&gt;The Serial or Sequence Number shall be assigned by the mailer for uniquely identifying and tracking mailpieces. The allowable encoding range shall be 000000000-999999999 when used with a 6 digit Mailer ID and 000000-999999 when used with a 9 digit Mailer ID. e. The Delivery Point ZIP Code shall be assigned by the mailer for routing the mailpiece. This shall replace POSTNET for routing the mailpiece to its final delivery point. The length may be 0, 5, 9, or 11 digits. The allowable encoding ranges shall be no ZIP Code, 00000-99999, 000000000-999999999, and 00000000000-99999999999.&lt;/li&gt;&lt;/ul&gt;&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function barcode_imb($code)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $asc_chr = array(4, 0, 2, 6, 3, 5, 1, 9, 8, 7, 1, 2, 0, 6, 4, 8, 2, 9, 5, 3, 0, 1, 3, 7, 4, 6, 8, 9, 2, 0, 5, 1, 9, 4, 3, 8, 6, 7, 1, 2, 4, 3, 9, 5, 7, 8, 3, 0, 2, 1, 4, 0, 9, 1, 7, 0, 2, 4, 6, 3, 7, 1, 9, 5, 8);&nbsp;</div></li><li><div>        $dsc_chr = array(7, 1, 9, 5, 8, 0, 2, 4, 6, 3, 5, 8, 9, 7, 3, 0, 6, 1, 7, 4, 6, 8, 9, 2, 5, 1, 7, 5, 4, 3, 8, 7, 6, 0, 2, 5, 4, 9, 3, 0, 1, 6, 8, 2, 0, 4, 5, 9, 6, 7, 5, 2, 6, 3, 8, 5, 1, 9, 8, 7, 4, 0, 2, 6, 3);&nbsp;</div></li><li><div>        $asc_pos = array(3, 0, 8, 11, 1, 12, 8, 11, 10, 6, 4, 12, 2, 7, 9, 6, 7, 9, 2, 8, 4, 0, 12, 7, 10, 9, 0, 7, 10, 5, 7, 9, 6, 8, 2, 12, 1, 4, 2, 0, 1, 5, 4, 6, 12, 1, 0, 9, 4, 7, 5, 10, 2, 6, 9, 11, 2, 12, 6, 7, 5, 11, 0, 3, 2);&nbsp;</div></li><li><div>        $dsc_pos = array(2, 10, 12, 5, 9, 1, 5, 4, 3, 9, 11, 5, 10, 1, 6, 3, 4, 1, 10, 0, 2, 11, 8, 6, 1, 12, 3, 8, 6, 4, 4, 11, 0, 6, 1, 9, 11, 5, 3, 7, 3, 10, 7, 11, 8, 2, 10, 3, 5, 8, 0, 3, 12, 11, 8, 4, 5, 1, 3, 0, 7, 12, 9, 8, 10);&nbsp;</div></li><li><div>        $code_arr = explode('-', $code);&nbsp;</div></li><li><div>        $tracking_number = $code_arr[0];&nbsp;</div></li><li><div>        if (isset($code_arr[1])) {&nbsp;</div></li><li><div>            $routing_code = $code_arr[1];&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $routing_code = '';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // Conversion of Routing Code&nbsp;</div></li><li><div>        switch (strlen($routing_code)) {&nbsp;</div></li><li><div>            case 0: {&nbsp;</div></li><li><div>                    $binary_code = 0;&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 5: {&nbsp;</div></li><li><div>                    $binary_code = bcadd($routing_code, '1');&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 9: {&nbsp;</div></li><li><div>                    $binary_code = bcadd($routing_code, '100001');&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            case 11: {&nbsp;</div></li><li><div>                    $binary_code = bcadd($routing_code, '1000100001');&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            default: {&nbsp;</div></li><li><div>                    return false;&nbsp;</div></li><li><div>                    break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $binary_code = bcmul($binary_code, 10);&nbsp;</div></li><li><div>        $binary_code = bcadd($binary_code, $tracking_number{0});&nbsp;</div></li><li><div>        $binary_code = bcmul($binary_code, 5);&nbsp;</div></li><li><div>        $binary_code = bcadd($binary_code, $tracking_number{1});&nbsp;</div></li><li><div>        $binary_code .= substr($tracking_number, 2, 18);&nbsp;</div></li><li><div>        // convert to hexadecimal&nbsp;</div></li><li><div>        $binary_code = $this-&gt;dec_to_hex($binary_code);&nbsp;</div></li><li><div>        // pad to get 13 bytes&nbsp;</div></li><li><div>        $binary_code = str_pad($binary_code, 26, '0', STR_PAD_LEFT);&nbsp;</div></li><li><div>        // convert string to array of bytes&nbsp;</div></li><li><div>        $binary_code_arr = chunk_split($binary_code, 2, &quot;\r&quot;);&nbsp;</div></li><li><div>        $binary_code_arr = substr($binary_code_arr, 0, -1);&nbsp;</div></li><li><div>        $binary_code_arr = explode(&quot;\r&quot;, $binary_code_arr);&nbsp;</div></li><li><div>        // calculate frame check sequence&nbsp;</div></li><li><div>        $fcs = $this-&gt;imb_crc11fcs($binary_code_arr);&nbsp;</div></li><li><div>        // exclude first 2 bits from first byte&nbsp;</div></li><li><div>        $first_byte = sprintf('%2s', dechex((hexdec($binary_code_arr[0]) &lt;&lt; 2) &gt;&gt; 2));&nbsp;</div></li><li><div>        $binary_code_102bit = $first_byte . substr($binary_code, 2);&nbsp;</div></li><li><div>        // convert binary data to codewords&nbsp;</div></li><li><div>        $codewords = array();&nbsp;</div></li><li><div>        $data = $this-&gt;hex_to_dec($binary_code_102bit);&nbsp;</div></li><li><div>        $codewords[0] = bcmod($data, 636) * 2;&nbsp;</div></li><li><div>        $data = bcdiv($data, 636);&nbsp;</div></li><li><div>        for ($i = 1; $i &lt; 9; ++$i) {&nbsp;</div></li><li><div>            $codewords[$i] = bcmod($data, 1365);&nbsp;</div></li><li><div>            $data = bcdiv($data, 1365);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $codewords[9] = $data;&nbsp;</div></li><li><div>        if (($fcs &gt;&gt; 10) == 1) {&nbsp;</div></li><li><div>            $codewords[9] += 659;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // generate lookup tables&nbsp;</div></li><li><div>        $table2of13 = $this-&gt;imb_tables(2, 78);&nbsp;</div></li><li><div>        $table5of13 = $this-&gt;imb_tables(5, 1287);&nbsp;</div></li><li><div>        // convert codewords to characters&nbsp;</div></li><li><div>        $characters = array();&nbsp;</div></li><li><div>        $bitmask = 512;&nbsp;</div></li><li><div>        foreach ($codewords as $k =&gt; $val) {&nbsp;</div></li><li><div>            if ($val &lt;= 1286) {&nbsp;</div></li><li><div>                $chrcode = $table5of13[$val];&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $chrcode = $table2of13[($val - 1287)];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if (($fcs & $bitmask) &gt; 0) {&nbsp;</div></li><li><div>                // bitwise invert&nbsp;</div></li><li><div>                $chrcode = ((~$chrcode) & 8191);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $characters[] = $chrcode;&nbsp;</div></li><li><div>            $bitmask /= 2;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $characters = array_reverse($characters);&nbsp;</div></li><li><div>        // build bars&nbsp;</div></li><li><div>        $k = 0;&nbsp;</div></li><li><div>        $bararray = array('code' =&gt; $code, 'maxw' =&gt; 0, 'maxh' =&gt; $this-&gt;daft['F'], 'bcode' =&gt; array());&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; 65; ++$i) {&nbsp;</div></li><li><div>            $asc = (($characters[$asc_chr[$i]] & pow(2, $asc_pos[$i])) &gt; 0);&nbsp;</div></li><li><div>            $dsc = (($characters[$dsc_chr[$i]] & pow(2, $dsc_pos[$i])) &gt; 0);&nbsp;</div></li><li><div>            if ($asc AND $dsc) {&nbsp;</div></li><li><div>                // full bar (F)&nbsp;</div></li><li><div>                $p = 0;&nbsp;</div></li><li><div>                $h = $this-&gt;daft['F'];&nbsp;</div></li><li><div>            } elseif ($asc) {&nbsp;</div></li><li><div>                // ascender (A)&nbsp;</div></li><li><div>                $p = 0;&nbsp;</div></li><li><div>                $h = $this-&gt;daft['A'];&nbsp;</div></li><li><div>            } elseif ($dsc) {&nbsp;</div></li><li><div>                // descender (D)&nbsp;</div></li><li><div>                $p = $this-&gt;daft['F'] - $this-&gt;daft['D'];&nbsp;</div></li><li><div>                $h = $this-&gt;daft['D'];&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                // tracker (T)&nbsp;</div></li><li><div>                $p = ($this-&gt;daft['F'] - $this-&gt;daft['T']) / 2;&nbsp;</div></li><li><div>                $h = $this-&gt;daft['T'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $bararray['bcode'][$k++] = array('t' =&gt; 1, 'w' =&gt; 1, 'h' =&gt; $h, 'p' =&gt; $p);&nbsp;</div></li><li><div>            // Gap&nbsp;</div></li><li><div>            $bararray['bcode'][$k++] = array('t' =&gt; 0, 'w' =&gt; $this-&gt;gapwidth, 'h' =&gt; 1, 'p' =&gt; 0);&nbsp;</div></li><li><div>            $bararray['maxw'] += (1 + $this-&gt;gapwidth );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        unset($bararray['bcode'][($k - 1)]);&nbsp;</div></li><li><div>        $bararray['maxw'] -= $this-&gt;gapwidth;&nbsp;</div></li><li><div>        return $bararray;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Convert large integer number to hexadecimal representation.&nbsp;</div></li><li><div>     * (requires PHP bcmath extension)&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function dec_to_hex($number)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $i = 0;&nbsp;</div></li><li><div>        $hex = array();&nbsp;</div></li><li><div>        if ($number == 0) {&nbsp;</div></li><li><div>            return '00';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        while ($number &gt; 0) {&nbsp;</div></li><li><div>            if ($number == 0) {&nbsp;</div></li><li><div>                array_push($hex, '0');&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                array_push($hex, strtoupper(dechex(bcmod($number, '16'))));&nbsp;</div></li><li><div>                $number = bcdiv($number, '16', 0);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $hex = array_reverse($hex);&nbsp;</div></li><li><div>        return implode($hex);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Convert large hexadecimal number to decimal representation (string).&nbsp;</div></li><li><div>     * (requires PHP bcmath extension)&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function hex_to_dec($hex)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $dec = 0;&nbsp;</div></li><li><div>        $bitval = 1;&nbsp;</div></li><li><div>        $len = strlen($hex);&nbsp;</div></li><li><div>        for ($pos = ($len - 1); $pos &gt;= 0; --$pos) {&nbsp;</div></li><li><div>            $dec = bcadd($dec, bcmul(hexdec($hex[$pos]), $bitval));&nbsp;</div></li><li><div>            $bitval = bcmul($bitval, 16);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $dec;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Intelligent Mail Barcode calculation of Frame Check Sequence&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function imb_crc11fcs($code_arr)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $genpoly = 0x0F35; // generator polynomial&nbsp;</div></li><li><div>        $fcs = 0x07FF; // Frame Check Sequence&nbsp;</div></li><li><div>        // do most significant byte skipping the 2 most significant bits&nbsp;</div></li><li><div>        $data = hexdec($code_arr[0]) &lt;&lt; 5;&nbsp;</div></li><li><div>        for ($bit = 2; $bit &lt; 8; ++$bit) {&nbsp;</div></li><li><div>            if (($fcs ^ $data) & 0x400) {&nbsp;</div></li><li><div>                $fcs = ($fcs &lt;&lt; 1) ^ $genpoly;&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $fcs = ($fcs &lt;&lt; 1);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $fcs &= 0x7FF;&nbsp;</div></li><li><div>            $data &lt;&lt;= 1;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // do rest of bytes&nbsp;</div></li><li><div>        for ($byte = 1; $byte &lt; 13; ++$byte) {&nbsp;</div></li><li><div>            $data = hexdec($code_arr[$byte]) &lt;&lt; 3;&nbsp;</div></li><li><div>            for ($bit = 0; $bit &lt; 8; ++$bit) {&nbsp;</div></li><li><div>                if (($fcs ^ $data) & 0x400) {&nbsp;</div></li><li><div>                    $fcs = ($fcs &lt;&lt; 1) ^ $genpoly;&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $fcs = ($fcs &lt;&lt; 1);&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $fcs &= 0x7FF;&nbsp;</div></li><li><div>                $data &lt;&lt;= 1;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $fcs;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Reverse unsigned short value&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function imb_reverse_us($num)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $rev = 0;&nbsp;</div></li><li><div>        for ($i = 0; $i &lt; 16; ++$i) {&nbsp;</div></li><li><div>            $rev &lt;&lt;= 1;&nbsp;</div></li><li><div>            $rev |= ($num & 1);&nbsp;</div></li><li><div>            $num &gt;&gt;= 1;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $rev;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * generate Nof13 tables used for Intelligent Mail Barcode&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function imb_tables($n, $size)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $table = array();&nbsp;</div></li><li><div>        $lli = 0; // LUT lower index&nbsp;</div></li><li><div>        $lui = $size - 1; // LUT upper index&nbsp;</div></li><li><div>        for ($count = 0; $count &lt; 8192; ++$count) {&nbsp;</div></li><li><div>            $bit_count = 0;&nbsp;</div></li><li><div>            for ($bit_index = 0; $bit_index &lt; 13; ++$bit_index) {&nbsp;</div></li><li><div>                $bit_count += intval(($count & (1 &lt;&lt; $bit_index)) != 0);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            // if we don't have the right number of bits on, go on to the next value&nbsp;</div></li><li><div>            if ($bit_count == $n) {&nbsp;</div></li><li><div>                $reverse = ($this-&gt;imb_reverse_us($count) &gt;&gt; 3);&nbsp;</div></li><li><div>                // if the reverse is less than count, we have already visited this pair before&nbsp;</div></li><li><div>                if ($reverse &gt;= $count) {&nbsp;</div></li><li><div>                    // If count is symmetric, place it at the first free slot from the end of the list.&nbsp;</div></li><li><div>                    // Otherwise, place it at the first free slot from the beginning of the list AND place $reverse ath the next free slot from the beginning of the list&nbsp;</div></li><li><div>                    if ($reverse == $count) {&nbsp;</div></li><li><div>                        $table[$lui] = $count;&nbsp;</div></li><li><div>                        --$lui;&nbsp;</div></li><li><div>                    } else {&nbsp;</div></li><li><div>                        $table[$lli] = $count;&nbsp;</div></li><li><div>                        ++$lli;&nbsp;</div></li><li><div>                        $table[$lli] = $reverse;&nbsp;</div></li><li><div>                        ++$lli;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $table;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 2.7.1</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.8.1/classes/pdfbarcode/" class="active">2.8.1</a></li><li><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.8.0/classes/pdfbarcode/" class="">2.8.0</a></li><li><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.7.3/classes/pdfbarcode/" class="">2.7.3</a></li><li><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.7.2/classes/pdfbarcode/" class="">2.7.2</a></li><li><a href="http://hookr.io/plugins/woocommerce-pdf-invoices/2.7.1/classes/pdfbarcode/" class="">2.7.1</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>PDFBarcode</li><li><span></span>WooCommerce PDF Invoices</li><li><span></span>2.8.1</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>