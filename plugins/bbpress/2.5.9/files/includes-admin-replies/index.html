<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="2.5.9" data-slug="bbpress" data-type="file" data-id="62429"><head xmlns="http://www.w3.org/1999/xhtml"><title> includes-admin-replies | file | Bbpress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, bbpress, 2.5.9" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.10"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=dc124d8387c9ac5a9c53f07cf027aff2' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.10' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/includes-admin-replies/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fincludes-admin-replies%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fincludes-admin-replies%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-bbpress-2.5.9-file-includes-admin-replies","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="includes-admin-replies" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to bbpress." href="http://hookr.io/plugins/bbpress/" class="plugin"><span property="name">bbpress</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.5.9." href="http://hookr.io/plugins/bbpress/2.5.9/" class="H_VERSION"><span property="name">2.5.9</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/bbpress/2.5.9/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">includes-admin-replies</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="2373"><a href="http://hookr.io/plugins/bbpress/2.5.9/all/" title="All">All <span class="count badge">2373</span></a></li><li class="" data-id="new" data-count="15"><a href="http://hookr.io/plugins/bbpress/2.5.9/new/" title="New">New <span class="count badge">15</span></a></li><li class="" data-id="hooks" data-count="1132"><a href="http://hookr.io/plugins/bbpress/2.5.9/hooks/" title="Hooks">Hooks <span class="count badge">1132</span></a></li><li class="" data-id="action" data-count="471"><a href="http://hookr.io/plugins/bbpress/2.5.9/actions/" title="Actions">Actions <span class="count badge">471</span></a></li><li class="" data-id="filter" data-count="661"><a href="http://hookr.io/plugins/bbpress/2.5.9/filters/" title="Filters">Filters <span class="count badge">661</span></a></li><li class="" data-id="class" data-count="54"><a href="http://hookr.io/plugins/bbpress/2.5.9/classes/" title="Classes">Classes <span class="count badge">54</span></a></li><li class="" data-id="constant" data-count="28"><a href="http://hookr.io/plugins/bbpress/2.5.9/constants/" title="Constants">Constants <span class="count badge">28</span></a></li><li class="" data-id="function" data-count="1158"><a href="http://hookr.io/plugins/bbpress/2.5.9/functions/" title="Functions">Functions <span class="count badge">1158</span></a></li><li class="" data-id="shortcode" data-count="1"><a href="http://hookr.io/plugins/bbpress/2.5.9/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">1</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/includes/admin/replies.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * bbPress Replies Admin Class</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package bbPress</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage Administration</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Exit if accessed directly</span>&nbsp;</div></li><li><div>if ( !defined( 'ABSPATH' ) ) exit;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>if ( !class_exists( 'BBP_Replies_Admin' ) ) :&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Loads bbPress replies admin area</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package bbPress</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage Administration</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2464)</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>class BBP_Replies_Admin {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/** Variables *************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * @var The post type of this admin component</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private $post_type = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/** Functions *************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * The main bbPress admin loader</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2515)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses BBP_Replies_Admin::setup_globals() Setup the globals needed</span>&nbsp;</div></li><li><div><span class="comment">   * @uses BBP_Replies_Admin::setup_actions() Setup the hooks and actions</span>&nbsp;</div></li><li><div><span class="comment">   * @uses BBP_Replies_Admin::setup_actions() Setup the help text</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function __construct() {&nbsp;</div></li><li><div>      $this-&gt;setup_globals();&nbsp;</div></li><li><div>      $this-&gt;setup_actions();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Setup the admin hooks, actions and filters</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2646)</span>&nbsp;</div></li><li><div><span class="comment">   * @access private</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses add_action() To add various actions</span>&nbsp;</div></li><li><div><span class="comment">   * @uses add_filter() To add various filters</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_forum_post_type() To get the forum post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_post_type() To get the topic post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function setup_actions() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add some general styling to the admin area</span>&nbsp;</div></li><li><div>      add_action( 'bbp_admin_head', array( $this, 'admin_head' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Messages</span>&nbsp;</div></li><li><div>      add_filter( 'post_updated_messages', array( $this, 'updated_messages' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Reply column headers.</span>&nbsp;</div></li><li><div>      add_filter( 'manage_' . $this-&gt;post_type . '_posts_columns', array( $this, 'column_headers' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Reply columns (in post row)</span>&nbsp;</div></li><li><div>      add_action( 'manage_' . $this-&gt;post_type . '_posts_custom_column', array( $this, 'column_data' ), 10, 2 );&nbsp;</div></li><li><div>      add_filter( 'post_row_actions', array( $this, 'row_actions' ), 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Reply metabox actions</span>&nbsp;</div></li><li><div>      add_action( 'add_meta_boxes', array( $this, 'attributes_metabox' ) );&nbsp;</div></li><li><div>      add_action( 'save_post', array( $this, 'attributes_metabox_save' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Check if there are any bbp_toggle_reply_* requests on admin_init, also have a message displayed</span>&nbsp;</div></li><li><div>      add_action( 'load-edit.php', array( $this, 'toggle_reply' ) );&nbsp;</div></li><li><div>      add_action( 'admin_notices', array( $this, 'toggle_reply_notice' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Anonymous metabox actions</span>&nbsp;</div></li><li><div>      add_action( 'add_meta_boxes', array( $this, 'author_metabox' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add ability to filter topics and replies per forum</span>&nbsp;</div></li><li><div>      add_filter( 'restrict_manage_posts', array( $this, 'filter_dropdown' ) );&nbsp;</div></li><li><div>      add_filter( 'bbp_request', array( $this, 'filter_post_rows' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Contextual Help</span>&nbsp;</div></li><li><div>      add_action( 'load-edit.php', array( $this, 'edit_help' ) );&nbsp;</div></li><li><div>      add_action( 'load-post.php', array( $this, 'new_help' ) );&nbsp;</div></li><li><div>      add_action( 'load-post-new.php', array( $this, 'new_help' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Should we bail out of this method?</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r4067)</span>&nbsp;</div></li><li><div><span class="comment">   * @return boolean</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function bail() {&nbsp;</div></li><li><div>      if ( !isset( get_current_screen()-&gt;post_type ) || ( $this-&gt;post_type !== get_current_screen()-&gt;post_type ) )&nbsp;</div></li><li><div>          return true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Admin globals</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2646)</span>&nbsp;</div></li><li><div><span class="comment">   * @access private</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  private function setup_globals() {&nbsp;</div></li><li><div>      $this-&gt;post_type = bbp_get_reply_post_type();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/** Contextual Help *******************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Contextual help for bbPress reply edit page</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r3119)</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_current_screen()</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function edit_help() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;bail() ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Overview</span>&nbsp;</div></li><li><div>      get_current_screen()-&gt;add_help_tab( array(&nbsp;</div></li><li><div>          'id' =&gt; 'overview', &nbsp;</div></li><li><div>          'title' =&gt; __( 'Overview', 'bbpress' ), &nbsp;</div></li><li><div>          'content' =&gt;&nbsp;</div></li><li><div>              '&lt;p&gt;' . __( 'This screen provides access to all of your replies. You can customize the display of this screen to suit your workflow.', 'bbpress' ) . '&lt;/p&gt;'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Screen Content</span>&nbsp;</div></li><li><div>      get_current_screen()-&gt;add_help_tab( array(&nbsp;</div></li><li><div>          'id' =&gt; 'screen-content', &nbsp;</div></li><li><div>          'title' =&gt; __( 'Screen Content', 'bbpress' ), &nbsp;</div></li><li><div>          'content' =&gt;&nbsp;</div></li><li><div>              '&lt;p&gt;' . __( 'You can customize the display of this screen&#8217;s contents in a number of ways:', 'bbpress' ) . '&lt;/p&gt;' .&nbsp;</div></li><li><div>              '&lt;ul&gt;' .&nbsp;</div></li><li><div>                  '&lt;li&gt;' . __( 'You can hide/display columns based on your needs and decide how many replies to list per screen using the Screen Options tab.', 'bbpress' ) . '&lt;/li&gt;' .&nbsp;</div></li><li><div>                  '&lt;li&gt;' . __( 'You can filter the list of replies by reply status using the text links in the upper left to show All, Published, Draft, or Trashed replies. The default view is to show all replies.', 'bbpress' ) . '&lt;/li&gt;' .&nbsp;</div></li><li><div>                  '&lt;li&gt;' . __( 'You can view replies in a simple title list or with an excerpt. Choose the view you prefer by clicking on the icons at the top of the list on the right.', 'bbpress' ) . '&lt;/li&gt;' .&nbsp;</div></li><li><div>                  '&lt;li&gt;' . __( 'You can refine the list to show only replies in a specific category or from a specific month by using the dropdown menus above the replies list. Click the Filter button after making your selection. You also can refine the list by clicking on the reply author, category or tag in the replies list.', 'bbpress' ) . '&lt;/li&gt;' .&nbsp;</div></li><li><div>              '&lt;/ul&gt;'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Available Actions</span>&nbsp;</div></li><li><div>      get_current_screen()-&gt;add_help_tab( array(&nbsp;</div></li><li><div>          'id' =&gt; 'action-links', &nbsp;</div></li><li><div>          'title' =&gt; __( 'Available Actions', 'bbpress' ), &nbsp;</div></li><li><div>          'content' =&gt;&nbsp;</div></li><li><div>              '&lt;p&gt;' . __( 'Hovering over a row in the replies list will display action links that allow you to manage your reply. You can perform the following actions:', 'bbpress' ) . '&lt;/p&gt;' .&nbsp;</div></li><li><div>              '&lt;ul&gt;' .&nbsp;</div></li><li><div>                  '&lt;li&gt;' . __( '&lt;strong&gt;Edit&lt;/strong&gt; takes you to the editing screen for that reply. You can also reach that screen by clicking on the reply title.', 'bbpress' ) . '&lt;/li&gt;' .&nbsp;</div></li><li><div>                  <span class="comment">//'&lt;li&gt;' . __( '&lt;strong&gt;Quick Edit&lt;/strong&gt; provides inline access to the metadata of your reply, allowing you to update reply details without leaving this screen.', 'bbpress' ) . '&lt;/li&gt;' .</span>&nbsp;</div></li><li><div>                  '&lt;li&gt;' . __( '&lt;strong&gt;Trash&lt;/strong&gt; removes your reply from this list and places it in the trash, from which you can permanently delete it.', 'bbpress' ) . '&lt;/li&gt;' .&nbsp;</div></li><li><div>                  '&lt;li&gt;' . __( '&lt;strong&gt;Spam&lt;/strong&gt; removes your reply from this list and places it in the spam queue, from which you can permanently delete it.', 'bbpress' ) . '&lt;/li&gt;' .&nbsp;</div></li><li><div>                  '&lt;li&gt;' . __( '&lt;strong&gt;Preview&lt;/strong&gt; will show you what your draft reply will look like if you publish it. View will take you to your live site to view the reply. Which link is available depends on your reply&#8217;s status.', 'bbpress' ) . '&lt;/li&gt;' .&nbsp;</div></li><li><div>              '&lt;/ul&gt;'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Bulk Actions</span>&nbsp;</div></li><li><div>      get_current_screen()-&gt;add_help_tab( array(&nbsp;</div></li><li><div>          'id' =&gt; 'bulk-actions', &nbsp;</div></li><li><div>          'title' =&gt; __( 'Bulk Actions', 'bbpress' ), &nbsp;</div></li><li><div>          'content' =&gt;&nbsp;</div></li><li><div>              '&lt;p&gt;' . __( 'You can also edit or move multiple replies to the trash at once. Select the replies you want to act on using the checkboxes, then select the action you want to take from the Bulk Actions menu and click Apply.', 'bbpress' ) . '&lt;/p&gt;' .&nbsp;</div></li><li><div>              '&lt;p&gt;' . __( 'When using Bulk Edit, you can change the metadata (categories, author, etc.) for all selected replies at once. To remove a reply from the grouping, just click the x next to its name in the Bulk Edit area that appears.', 'bbpress' ) . '&lt;/p&gt;'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Help Sidebar</span>&nbsp;</div></li><li><div>      get_current_screen()-&gt;set_help_sidebar(&nbsp;</div></li><li><div>          '&lt;p&gt;&lt;strong&gt;' . __( 'For more information:', 'bbpress' ) . '&lt;/strong&gt;&lt;/p&gt;' .&nbsp;</div></li><li><div>          '&lt;p&gt;' . __( '&lt;a href=&quot;http:<span class="comment"><span class="comment">//codex.bbpress.org&quot; target=&quot;_blank&quot;&gt;bbPress Documentation&lt;/a&gt;', 'bbpress' ) . '&lt;/p&gt;' .</span></span>&nbsp;</div></li><li><div>          '&lt;p&gt;' . __( '&lt;a href=&quot;http:<span class="comment"><span class="comment">//bbpress.org/forums/&quot; target=&quot;_blank&quot;&gt;bbPress Support Forums&lt;/a&gt;', 'bbpress' ) . '&lt;/p&gt;'</span></span>&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Contextual help for bbPress reply edit page</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r3119)</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_current_screen()</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function new_help() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;bail() ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $customize_display = '&lt;p&gt;' . __( 'The title field and the big reply editing Area are fixed in place, but you can reposition all the other boxes using drag and drop, and can minimize or expand them by clicking the title bar of each box. Use the Screen Options tab to unhide more boxes (Excerpt, Send Trackbacks, Custom Fields, Discussion, Slug, Author) or to choose a 1- or 2-column layout for this screen.', 'bbpress' ) . '&lt;/p&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      get_current_screen()-&gt;add_help_tab( array(&nbsp;</div></li><li><div>          'id' =&gt; 'customize-display', &nbsp;</div></li><li><div>          'title' =&gt; __( 'Customizing This Display', 'bbpress' ), &nbsp;</div></li><li><div>          'content' =&gt; $customize_display, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      get_current_screen()-&gt;add_help_tab( array(&nbsp;</div></li><li><div>          'id' =&gt; 'title-reply-editor', &nbsp;</div></li><li><div>          'title' =&gt; __( 'Title and Reply Editor', 'bbpress' ), &nbsp;</div></li><li><div>          'content' =&gt;&nbsp;</div></li><li><div>              '&lt;p&gt;' . __( '&lt;strong&gt;Title&lt;/strong&gt; - Enter a title for your reply. After you enter a title, you&#8217;ll see the permalink below, which you can edit.', 'bbpress' ) . '&lt;/p&gt;' .&nbsp;</div></li><li><div>              '&lt;p&gt;' . __( '&lt;strong&gt;Reply Editor&lt;/strong&gt; - Enter the text for your reply. There are two modes of editing: Visual and HTML. Choose the mode by clicking on the appropriate tab. Visual mode gives you a WYSIWYG editor. Click the last icon in the row to get a second row of controls. The HTML mode allows you to enter raw HTML along with your reply text. You can insert media files by clicking the icons above the reply editor and following the directions. You can go to the distraction-free writing screen via the Fullscreen icon in Visual mode (second to last in the top row) or the Fullscreen button in HTML mode (last in the row). Once there, you can make buttons visible by hovering over the top area. Exit Fullscreen back to the regular reply editor.', 'bbpress' ) . '&lt;/p&gt;'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $publish_box = '&lt;p&gt;' . __( '&lt;strong&gt;Publish&lt;/strong&gt; - You can set the terms of publishing your reply in the Publish box. For Status, Visibility, and Publish (immediately), click on the Edit link to reveal more options. Visibility includes options for password-protecting a reply or making it stay at the top of your blog indefinitely (sticky). Publish (immediately) allows you to set a future or past date and time, so you can schedule a reply to be published in the future or backdate a reply.', 'bbpress' ) . '&lt;/p&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( current_theme_supports( 'reply-thumbnails' ) && post_type_supports( 'reply', 'thumbnail' ) ) {&nbsp;</div></li><li><div>          $publish_box .= '&lt;p&gt;' . __( '&lt;strong&gt;Featured Image&lt;/strong&gt; - This allows you to associate an image with your reply without inserting it. This is usually useful only if your theme makes use of the featured image as a reply thumbnail on the home page, a custom header, etc.', 'bbpress' ) . '&lt;/p&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      get_current_screen()-&gt;add_help_tab( array(&nbsp;</div></li><li><div>          'id' =&gt; 'reply-attributes', &nbsp;</div></li><li><div>          'title' =&gt; __( 'Reply Attributes', 'bbpress' ), &nbsp;</div></li><li><div>          'content' =&gt;&nbsp;</div></li><li><div>              '&lt;p&gt;' . __( 'Select the attributes that your reply should have:', 'bbpress' ) . '&lt;/p&gt;' .&nbsp;</div></li><li><div>              '&lt;ul&gt;' .&nbsp;</div></li><li><div>                  '&lt;li&gt;' . __( '&lt;strong&gt;Forum&lt;/strong&gt; dropdown determines the parent forum that the reply belongs to. Select the forum, or leave the default (Use Forum of Topic) to post the reply in forum of the topic.', 'bbpress' ) . '&lt;/li&gt;' .&nbsp;</div></li><li><div>                  '&lt;li&gt;' . __( '&lt;strong&gt;Topic&lt;/strong&gt; determines the parent topic that the reply belongs to.', 'bbpress' ) . '&lt;/li&gt;' .&nbsp;</div></li><li><div>                  '&lt;li&gt;' . __( '&lt;strong&gt;Reply To&lt;/strong&gt; determines the threading of the reply.', 'bbpress' ) . '&lt;/li&gt;' .&nbsp;</div></li><li><div>              '&lt;/ul&gt;'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      get_current_screen()-&gt;add_help_tab( array(&nbsp;</div></li><li><div>          'id' =&gt; 'publish-box', &nbsp;</div></li><li><div>          'title' =&gt; __( 'Publish Box', 'bbpress' ), &nbsp;</div></li><li><div>          'content' =&gt; $publish_box, &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      get_current_screen()-&gt;set_help_sidebar(&nbsp;</div></li><li><div>          '&lt;p&gt;&lt;strong&gt;' . __( 'For more information:', 'bbpress' ) . '&lt;/strong&gt;&lt;/p&gt;' .&nbsp;</div></li><li><div>          '&lt;p&gt;' . __( '&lt;a href=&quot;http:<span class="comment"><span class="comment">//codex.bbpress.org&quot; target=&quot;_blank&quot;&gt;bbPress Documentation&lt;/a&gt;', 'bbpress' ) . '&lt;/p&gt;' .</span></span>&nbsp;</div></li><li><div>          '&lt;p&gt;' . __( '&lt;a href=&quot;http:<span class="comment"><span class="comment">//bbpress.org/forums/&quot; target=&quot;_blank&quot;&gt;bbPress Support Forums&lt;/a&gt;', 'bbpress' ) . '&lt;/p&gt;'</span></span>&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Add the reply attributes metabox</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2746)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses add_meta_box() To add the metabox</span>&nbsp;</div></li><li><div><span class="comment">   * @uses do_action() Calls 'bbp_reply_attributes_metabox'</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function attributes_metabox() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;bail() ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      add_meta_box (&nbsp;</div></li><li><div>          'bbp_reply_attributes', &nbsp;</div></li><li><div>          __( 'Reply Attributes', 'bbpress' ), &nbsp;</div></li><li><div>          'bbp_reply_metabox', &nbsp;</div></li><li><div>          $this-&gt;post_type, &nbsp;</div></li><li><div>          'side', &nbsp;</div></li><li><div>          'high'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      do_action( 'bbp_reply_attributes_metabox' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Pass the reply attributes for processing</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2746)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses current_user_can() To check if the current user is capable of</span>&nbsp;</div></li><li><div><span class="comment">   *                           editing the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses do_action() Calls 'bbp_reply_attributes_metabox_save' with the</span>&nbsp;</div></li><li><div><span class="comment">   *                    reply id and parent id</span>&nbsp;</div></li><li><div><span class="comment">   * @return int Parent id</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function attributes_metabox_save( $reply_id ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;bail() ) return $reply_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Bail if doing an autosave</span>&nbsp;</div></li><li><div>      if ( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE )&nbsp;</div></li><li><div>          return $reply_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Bail if not a post request</span>&nbsp;</div></li><li><div>      if ( ! bbp_is_post_request() )&nbsp;</div></li><li><div>          return $reply_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Check action exists</span>&nbsp;</div></li><li><div>      if ( empty( $_POST['action'] ) )&nbsp;</div></li><li><div>          return $reply_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Nonce check</span>&nbsp;</div></li><li><div>      if ( empty( $_POST['bbp_reply_metabox'] ) || !wp_verify_nonce( $_POST['bbp_reply_metabox'], 'bbp_reply_metabox_save' ) )&nbsp;</div></li><li><div>          return $reply_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Current user cannot edit this reply</span>&nbsp;</div></li><li><div>      if ( !current_user_can( 'edit_reply', $reply_id ) )&nbsp;</div></li><li><div>          return $reply_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get the reply meta post values</span>&nbsp;</div></li><li><div>      $topic_id = !empty( $_POST['parent_id'] ) ? (int) $_POST['parent_id']    : 0;&nbsp;</div></li><li><div>      $forum_id = !empty( $_POST['bbp_forum_id'] ) ? (int) $_POST['bbp_forum_id'] : bbp_get_topic_forum_id( $topic_id );&nbsp;</div></li><li><div>      $reply_to = !empty( $_POST['bbp_reply_to'] ) ? (int) $_POST['bbp_reply_to'] : 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get reply author data</span>&nbsp;</div></li><li><div>      $anonymous_data = bbp_filter_anonymous_post_data();&nbsp;</div></li><li><div>      $author_id = bbp_get_reply_author_id( $reply_id );&nbsp;</div></li><li><div>      $is_edit = (bool) isset( $_POST['save'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Formally update the reply</span>&nbsp;</div></li><li><div>      bbp_update_reply( $reply_id, $topic_id, $forum_id, $anonymous_data, $author_id, $is_edit, $reply_to );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Allow other fun things to happen</span>&nbsp;</div></li><li><div>      do_action( 'bbp_reply_attributes_metabox_save', $reply_id, $topic_id, $forum_id, $reply_to );&nbsp;</div></li><li><div>      do_action( 'bbp_author_metabox_save', $reply_id, $anonymous_data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $reply_id;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Add the author info metabox</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Allows editing of information about an author</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2828)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic() To get the topic</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply() To get the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_post_type() To get the topic post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses add_meta_box() To add the metabox</span>&nbsp;</div></li><li><div><span class="comment">   * @uses do_action() Calls 'bbp_author_metabox' with the topic/reply</span>&nbsp;</div></li><li><div><span class="comment">   *                    id</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function author_metabox() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;bail() ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Bail if post_type is not a reply</span>&nbsp;</div></li><li><div>      if ( empty( $_GET['action'] ) || ( 'edit' !== $_GET['action'] ) )&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add the metabox</span>&nbsp;</div></li><li><div>      add_meta_box(&nbsp;</div></li><li><div>          'bbp_author_metabox', &nbsp;</div></li><li><div>          __( 'Author Information', 'bbpress' ), &nbsp;</div></li><li><div>          'bbp_author_metabox', &nbsp;</div></li><li><div>          $this-&gt;post_type, &nbsp;</div></li><li><div>          'side', &nbsp;</div></li><li><div>          'high'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      do_action( 'bbp_author_metabox', get_the_ID() );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Add some general styling to the admin area</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2464)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_forum_post_type() To get the forum post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_post_type() To get the topic post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses sanitize_html_class() To sanitize the classes</span>&nbsp;</div></li><li><div><span class="comment">   * @uses do_action() Calls 'bbp_admin_head'</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function admin_head() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;bail() ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;style type=&quot;text/css&quot; media=&quot;screen&quot;&gt;&nbsp;</div></li><li><div>      <span class="comment">/*&lt;![CDATA[*/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          strong.label {&nbsp;</div></li><li><div>              display: inline-block;&nbsp;</div></li><li><div>              width: 60px;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          .column-bbp_forum_topic_count, &nbsp;</div></li><li><div>          .column-bbp_forum_reply_count, &nbsp;</div></li><li><div>          .column-bbp_topic_reply_count, &nbsp;</div></li><li><div>          .column-bbp_topic_voice_count {&nbsp;</div></li><li><div>              width: 8% !important;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          .column-author, &nbsp;</div></li><li><div>          .column-bbp_reply_author, &nbsp;</div></li><li><div>          .column-bbp_topic_author {&nbsp;</div></li><li><div>              width: 10% !important;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          .column-bbp_topic_forum, &nbsp;</div></li><li><div>          .column-bbp_reply_forum, &nbsp;</div></li><li><div>          .column-bbp_reply_topic {&nbsp;</div></li><li><div>              width: 10% !important;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          .column-bbp_forum_freshness, &nbsp;</div></li><li><div>          .column-bbp_topic_freshness {&nbsp;</div></li><li><div>              width: 10% !important;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          .column-bbp_forum_created, &nbsp;</div></li><li><div>          .column-bbp_topic_created, &nbsp;</div></li><li><div>          .column-bbp_reply_created {&nbsp;</div></li><li><div>              width: 15% !important;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          .status-closed {&nbsp;</div></li><li><div>              background-color: #eaeaea;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          .status-spam {&nbsp;</div></li><li><div>              background-color: #faeaea;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/*]]&gt;*/</span>&nbsp;</div></li><li><div>      &lt;/style&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Toggle reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Handles the admin-side spamming/unspamming of replies</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2740)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply() To get the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses current_user_can() To check if the user is capable of editing</span>&nbsp;</div></li><li><div><span class="comment">   *                           the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses wp_die() To die if the user isn't capable or the post wasn't</span>&nbsp;</div></li><li><div><span class="comment">   *                 found</span>&nbsp;</div></li><li><div><span class="comment">   * @uses check_admin_referer() To verify the nonce and check referer</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_reply_spam() To check if the reply is marked as spam</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_unspam_reply() To unmark the reply as spam</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_spam_reply() To mark the reply as spam</span>&nbsp;</div></li><li><div><span class="comment">   * @uses do_action() Calls 'bbp_toggle_reply_admin' with success, post</span>&nbsp;</div></li><li><div><span class="comment">   *                    data, action and message</span>&nbsp;</div></li><li><div><span class="comment">   * @uses add_query_arg() To add custom args to the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses wp_safe_redirect() Redirect the page to custom url</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function toggle_reply() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;bail() ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Only proceed if GET is a reply toggle action</span></span>&nbsp;</div></li><li><div>      if ( bbp_is_get_request() && !empty( $_GET['action'] ) && in_array( $_GET['action'], array( 'bbp_toggle_reply_spam' ) ) && !empty( $_GET['reply_id'] ) ) {&nbsp;</div></li><li><div>          $action = $_GET['action'];            <span class="comment">// What action is taking place?</span>&nbsp;</div></li><li><div>          $reply_id = (int) $_GET['reply_id'];    <span class="comment"><span class="comment">// What's the reply id?</span></span>&nbsp;</div></li><li><div>          $success = false;                      <span class="comment">// Flag</span>&nbsp;</div></li><li><div>          $post_data = array( 'ID' =&gt; $reply_id ); <span class="comment">// Prelim array</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Get reply and die if empty</span>&nbsp;</div></li><li><div>          $reply = bbp_get_reply( $reply_id );&nbsp;</div></li><li><div>          if ( empty( $reply ) ) <span class="comment">// Which reply?</span>&nbsp;</div></li><li><div>              wp_die( __( 'The reply was not found!', 'bbpress' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( !current_user_can( 'moderate', $reply-&gt;ID ) ) <span class="comment">// What is the user doing here?</span>&nbsp;</div></li><li><div>              wp_die( __( 'You do not have the permission to do that!', 'bbpress' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          switch ( $action ) {&nbsp;</div></li><li><div>              case 'bbp_toggle_reply_spam' :&nbsp;</div></li><li><div>                  check_admin_referer( 'spam-reply_' . $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $is_spam = bbp_is_reply_spam( $reply_id );&nbsp;</div></li><li><div>                  $message = $is_spam ? 'unspammed' : 'spammed';&nbsp;</div></li><li><div>                  $success = $is_spam ? bbp_unspam_reply( $reply_id ) : bbp_spam_reply( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $success = wp_update_post( $post_data );&nbsp;</div></li><li><div>          $message = array( 'bbp_reply_toggle_notice' =&gt; $message, 'reply_id' =&gt; $reply-&gt;ID );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( false === $success || is_wp_error( $success ) )&nbsp;</div></li><li><div>              $message['failed'] = '1';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Do additional reply toggle actions (admin side)</span>&nbsp;</div></li><li><div>          do_action( 'bbp_toggle_reply_admin', $success, $post_data, $action, $message );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Redirect back to the reply</span>&nbsp;</div></li><li><div>          $redirect = add_query_arg( $message, remove_query_arg( array( 'action', 'reply_id' ) ) );&nbsp;</div></li><li><div>          wp_safe_redirect( $redirect );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// For good measure</span>&nbsp;</div></li><li><div>          exit();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Toggle reply notices</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Display the success/error notices from</span>&nbsp;</div></li><li><div><span class="comment">   * {@link BBP_Admin::toggle_reply()}</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2740)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply() To get the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_title() To get the reply title of the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses esc_html() To sanitize the reply title</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_toggle_reply_notice_admin' with</span>&nbsp;</div></li><li><div><span class="comment">   *                        message, reply id, notice and is it a failure</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function toggle_reply_notice() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;bail() ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Only proceed if GET is a reply toggle action</span></span>&nbsp;</div></li><li><div>      if ( bbp_is_get_request() && !empty( $_GET['bbp_reply_toggle_notice'] ) && in_array( $_GET['bbp_reply_toggle_notice'], array( 'spammed', 'unspammed' ) ) && !empty( $_GET['reply_id'] ) ) {&nbsp;</div></li><li><div>          $notice = $_GET['bbp_reply_toggle_notice'];         <span class="comment">// Which notice?</span>&nbsp;</div></li><li><div>          $reply_id = (int) $_GET['reply_id'];                  <span class="comment"><span class="comment">// What's the reply id?</span></span>&nbsp;</div></li><li><div>          $is_failure = !empty( $_GET['failed'] ) ? true : false; <span class="comment">// Was that a failure?</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Empty? No reply?</span>&nbsp;</div></li><li><div>          if ( empty( $notice ) || empty( $reply_id ) )&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Get reply and bail if empty</span>&nbsp;</div></li><li><div>          $reply = bbp_get_reply( $reply_id );&nbsp;</div></li><li><div>          if ( empty( $reply ) )&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $reply_title = bbp_get_reply_title( $reply-&gt;ID );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          switch ( $notice ) {&nbsp;</div></li><li><div>              case 'spammed' :&nbsp;</div></li><li><div>                  $message = $is_failure === true ? sprintf( __( 'There was a problem marking the reply &quot;%1$s&quot; as spam.', 'bbpress' ), $reply_title ) : sprintf( __( 'Reply &quot;%1$s&quot; successfully marked as spam.', 'bbpress' ), $reply_title );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              case 'unspammed' :&nbsp;</div></li><li><div>                  $message = $is_failure === true ? sprintf( __( 'There was a problem unmarking the reply &quot;%1$s&quot; as spam.', 'bbpress' ), $reply_title ) : sprintf( __( 'Reply &quot;%1$s&quot; successfully unmarked as spam.', 'bbpress' ), $reply_title );&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Do additional reply toggle notice filters (admin side)</span>&nbsp;</div></li><li><div>          $message = apply_filters( 'bbp_toggle_reply_notice_admin', $message, $reply-&gt;ID, $notice, $is_failure );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;div id=&quot;message&quot; class=&quot;&lt;?php echo $is_failure === true ? 'error' : 'updated'; ?&gt; fade&quot;&gt;&nbsp;</div></li><li><div>              &lt;p style=&quot;line-height: 150%&quot;&gt;&lt;?php echo esc_html( $message ); ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>          &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;?php&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Manage the column headers for the replies page</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2577)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $columns The columns</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_admin_replies_column_headers' with</span>&nbsp;</div></li><li><div><span class="comment">   *                        the columns</span>&nbsp;</div></li><li><div><span class="comment">   * @return array $columns bbPress reply columns</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function column_headers( $columns ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;bail() ) return $columns;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $columns = array(&nbsp;</div></li><li><div>          'cb' =&gt; '&lt;input type=&quot;checkbox&quot; /&gt;', &nbsp;</div></li><li><div>          'title' =&gt; __( 'Title', 'bbpress' ), &nbsp;</div></li><li><div>          'bbp_reply_forum' =&gt; __( 'Forum', 'bbpress' ), &nbsp;</div></li><li><div>          'bbp_reply_topic' =&gt; __( 'Topic', 'bbpress' ), &nbsp;</div></li><li><div>          'bbp_reply_author' =&gt; __( 'Author', 'bbpress' ), &nbsp;</div></li><li><div>          'bbp_reply_created' =&gt; __( 'Created', 'bbpress' ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_admin_replies_column_headers', $columns );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Print extra columns for the replies page</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2577)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $column Column</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_topic_id() To get the topic id of the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_topic_title() To output the reply's topic title</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'reply_topic_row_actions' with an array</span>&nbsp;</div></li><li><div><span class="comment">   *                        of reply topic actions</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_permalink() To get the topic permalink</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_forum_id() To get the forum id of the topic of</span>&nbsp;</div></li><li><div><span class="comment">   *                                 the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_forum_permalink() To get the forum permalink</span>&nbsp;</div></li><li><div><span class="comment">   * @uses admin_url() To get the admin url of post.php</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'reply_topic_forum_row_actions' with an</span>&nbsp;</div></li><li><div><span class="comment">   *                        array of reply topic forum actions</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_reply_author_display_name() To output the reply author name</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_the_date() Get the reply creation date</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_the_time() Get the reply creation time</span>&nbsp;</div></li><li><div><span class="comment">   * @uses esc_attr() To sanitize the reply creation time</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_last_active_time() To get the time when the reply was</span>&nbsp;</div></li><li><div><span class="comment">   *                                    last active</span>&nbsp;</div></li><li><div><span class="comment">   * @uses do_action() Calls 'bbp_admin_replies_column_data' with the</span>&nbsp;</div></li><li><div><span class="comment">   *                    column and reply id</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function column_data( $column, $reply_id ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;bail() ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get topic ID</span>&nbsp;</div></li><li><div>      $topic_id = bbp_get_reply_topic_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Populate Column Data</span>&nbsp;</div></li><li><div>      switch ( $column ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Topic</span>&nbsp;</div></li><li><div>          case 'bbp_reply_topic' :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment">// Output forum name</span></span>&nbsp;</div></li><li><div>              if ( !empty( $topic_id ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Topic</span> Title&nbsp;</div></li><li><div>                  $topic_title = bbp_get_topic_title( $topic_id );&nbsp;</div></li><li><div>                  if ( empty( $topic_title ) ) {&nbsp;</div></li><li><div>                      $topic_title = esc_html__( 'No Topic', 'bbpress' );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// Output the title</span></span>&nbsp;</div></li><li><div>                  echo $topic_title;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Reply has no topic</span>&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  esc_html_e( 'No Topic', 'bbpress' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Forum</span>&nbsp;</div></li><li><div>          case 'bbp_reply_forum' :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Get Forum ID's</span>&nbsp;</div></li><li><div>              $reply_forum_id = bbp_get_reply_forum_id( $reply_id );&nbsp;</div></li><li><div>              $topic_forum_id = bbp_get_topic_forum_id( $topic_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment"><span class="comment">// Output forum name</span></span>&nbsp;</div></li><li><div>              if ( !empty( $reply_forum_id ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Forum</span> Title&nbsp;</div></li><li><div>                  $forum_title = bbp_get_forum_title( $reply_forum_id );&nbsp;</div></li><li><div>                  if ( empty( $forum_title ) ) {&nbsp;</div></li><li><div>                      $forum_title = esc_html__( 'No Forum', 'bbpress' );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Alert capable users of reply forum mismatch</span>&nbsp;</div></li><li><div>                  if ( $reply_forum_id !== $topic_forum_id ) {&nbsp;</div></li><li><div>                      if ( current_user_can( 'edit_others_replies' ) || current_user_can( 'moderate' ) ) {&nbsp;</div></li><li><div>                          $forum_title .= '&lt;div class=&quot;attention&quot;&gt;' . esc_html__( '(Mismatch)', 'bbpress' ) . '&lt;/div&gt;';&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// Output the title</span></span>&nbsp;</div></li><li><div>                  echo $forum_title;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Reply has no forum</span>&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  _e( 'No Forum', 'bbpress' );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Author</span>&nbsp;</div></li><li><div>          case 'bbp_reply_author' :&nbsp;</div></li><li><div>              bbp_reply_author_display_name ( $reply_id );&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Freshness</span>&nbsp;</div></li><li><div>          case 'bbp_reply_created':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Output last activity time and date</span>&nbsp;</div></li><li><div>              printf( '%1$s &lt;br /&gt; %2$s', &nbsp;</div></li><li><div>                  get_the_date(), &nbsp;</div></li><li><div>                  esc_attr( get_the_time() )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Do action for anything else</span>&nbsp;</div></li><li><div>          default :&nbsp;</div></li><li><div>              do_action( 'bbp_admin_replies_column_data', $column, $reply_id );&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Reply Row actions</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Remove the quick-edit action link under the reply title and add the</span>&nbsp;</div></li><li><div><span class="comment">   * content and spam link</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2577)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $actions Actions</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $reply Reply object</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_reply_content() To output reply content</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_permalink() To get the reply link</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_title() To get the reply title</span>&nbsp;</div></li><li><div><span class="comment">   * @uses current_user_can() To check if the current user can edit or</span>&nbsp;</div></li><li><div><span class="comment">   *                           delete the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_reply_spam() To check if the reply is marked as spam</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_type_object() To get the reply post type object</span>&nbsp;</div></li><li><div><span class="comment">   * @uses add_query_arg() To add custom args to the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses remove_query_arg() To remove custom args from the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses wp_nonce_url() To nonce the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_delete_post_link() To get the delete post link of the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @return array $actions Actions</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function row_actions( $actions, $reply ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;bail() ) return $actions;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      unset( $actions['inline hide-if-no-js'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Reply view links to topic</span>&nbsp;</div></li><li><div>      $actions['view'] = '&lt;a href=&quot;' . esc_url( bbp_get_reply_url( $reply-&gt;ID ) ) . '&quot; title=&quot;' . esc_attr( sprintf( __( 'View &#8220;%s&#8221;', 'bbpress' ), bbp_get_reply_title( $reply-&gt;ID ) ) ) . '&quot; rel=&quot;permalink&quot;&gt;' . esc_html__( 'View', 'bbpress' ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// User cannot view replies in trash</span>&nbsp;</div></li><li><div>      if ( ( bbp_get_trash_status_id() === $reply-&gt;post_status ) && !current_user_can( 'view_trash' ) )&nbsp;</div></li><li><div>          unset( $actions['view'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Only show the actions if the user is capable of viewing them</span>&nbsp;</div></li><li><div>      if ( current_user_can( 'moderate', $reply-&gt;ID ) ) {&nbsp;</div></li><li><div>          if ( in_array( $reply-&gt;post_status, array( bbp_get_public_status_id(), bbp_get_spam_status_id() ) ) ) {&nbsp;</div></li><li><div>              $spam_uri = wp_nonce_url( add_query_arg( array( 'reply_id' =&gt; $reply-&gt;ID, 'action' =&gt; 'bbp_toggle_reply_spam' ), remove_query_arg( array( 'bbp_reply_toggle_notice', 'reply_id', 'failed', 'super' ) ) ), 'spam-reply_'  . $reply-&gt;ID );&nbsp;</div></li><li><div>              if ( bbp_is_reply_spam( $reply-&gt;ID ) ) {&nbsp;</div></li><li><div>                  $actions['spam'] = '&lt;a href=&quot;' . esc_url( $spam_uri ) . '&quot; title=&quot;' . esc_attr__( 'Mark the reply as not spam', 'bbpress' ) . '&quot;&gt;' . esc_html__( 'Not spam', 'bbpress' ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>                  $actions['spam'] = '&lt;a href=&quot;' . esc_url( $spam_uri ) . '&quot; title=&quot;' . esc_attr__( 'Mark this reply as spam', 'bbpress' ) . '&quot;&gt;' . esc_html__( 'Spam', 'bbpress' ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Trash</span>&nbsp;</div></li><li><div>      if ( current_user_can( 'delete_reply', $reply-&gt;ID ) ) {&nbsp;</div></li><li><div>          if ( bbp_get_trash_status_id() === $reply-&gt;post_status ) {&nbsp;</div></li><li><div>              $post_type_object = get_post_type_object( bbp_get_reply_post_type() );&nbsp;</div></li><li><div>              $actions['untrash'] = &quot;&lt;a title='&quot; . esc_attr__( 'Restore this item from the Trash', 'bbpress' ) . &quot;' href='&quot; . esc_url( add_query_arg( array( '_wp_http_referer' =&gt; add_query_arg( array( 'post_type' =&gt; bbp_get_reply_post_type() ), admin_url( 'edit.php' ) ) ), wp_nonce_url( admin_url( sprintf( $post_type_object-&gt;_edit_link . '&amp;action=untrash', $reply-&gt;ID ) ), 'untrash-' . $reply-&gt;post_type . '_' . $reply-&gt;ID ) ) ) . &quot;'&gt;&quot; . esc_html__( 'Restore', 'bbpress' ) . &quot;&lt;/a&gt;&quot;;&nbsp;</div></li><li><div>          } elseif ( EMPTY_TRASH_DAYS ) {&nbsp;</div></li><li><div>              $actions['trash'] = &quot;&lt;a class='submitdelete' title='&quot; . esc_attr__( 'Move this item to the Trash', 'bbpress' ) . &quot;' href='&quot; . esc_url( add_query_arg( array( '_wp_http_referer' =&gt; add_query_arg( array( 'post_type' =&gt; bbp_get_reply_post_type() ), admin_url( 'edit.php' ) ) ), get_delete_post_link( $reply-&gt;ID ) ) ) . &quot;'&gt;&quot; . esc_html__( 'Trash', 'bbpress' ) . &quot;&lt;/a&gt;&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( bbp_get_trash_status_id() === $reply-&gt;post_status || !EMPTY_TRASH_DAYS ) {&nbsp;</div></li><li><div>              $actions['delete'] = &quot;&lt;a class='submitdelete' title='&quot; . esc_attr__( 'Delete this item permanently', 'bbpress' ) . &quot;' href='&quot; . esc_url( add_query_arg( array( '_wp_http_referer' =&gt; add_query_arg( array( 'post_type' =&gt; bbp_get_reply_post_type() ), admin_url( 'edit.php' ) ) ), get_delete_post_link( $reply-&gt;ID, '', true ) ) ) . &quot;'&gt;&quot; . esc_html__( 'Delete Permanently', 'bbpress' ) . &quot;&lt;/a&gt;&quot;;&nbsp;</div></li><li><div>          } elseif ( bbp_get_spam_status_id() === $reply-&gt;post_status ) {&nbsp;</div></li><li><div>              unset( $actions['trash'] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $actions;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Add forum dropdown to topic and reply list table filters</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2991)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_post_type() To get the topic post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_dropdown() To generate a forum dropdown</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool False. If post type is not topic or reply</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function filter_dropdown() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;bail() ) return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add Empty Spam button</span>&nbsp;</div></li><li><div>      if ( !empty( $_GET['post_status'] ) && ( bbp_get_spam_status_id() === $_GET['post_status'] ) && current_user_can( 'moderate' ) ) {&nbsp;</div></li><li><div>          wp_nonce_field( 'bulk-destroy', '_destroy_nonce' );&nbsp;</div></li><li><div>          $title = esc_attr__( 'Empty Spam', 'bbpress' );&nbsp;</div></li><li><div>          submit_button( $title, 'button-secondary apply', 'delete_all', false );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get which forum is selected</span>&nbsp;</div></li><li><div>      $selected = !empty( $_GET['bbp_forum_id'] ) ? $_GET['bbp_forum_id'] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Show the forums dropdown</span>&nbsp;</div></li><li><div>      bbp_dropdown( array(&nbsp;</div></li><li><div>          'selected' =&gt; $selected, &nbsp;</div></li><li><div>          'show_none' =&gt; __( 'In all forums', 'bbpress' )&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Adjust the request query and include the forum id</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2991)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $query_vars Query variables from {@link WP_Query}</span>&nbsp;</div></li><li><div><span class="comment">   * @uses is_admin() To check if it's the admin section</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_post_type() To get the topic post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment">   * @return array Processed Query Vars</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function filter_post_rows( $query_vars ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;bail() ) return $query_vars;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add post_parent query_var if one is present</span>&nbsp;</div></li><li><div>      if ( !empty( $_GET['bbp_forum_id'] ) ) {&nbsp;</div></li><li><div>          $query_vars['meta_key'] = '_bbp_forum_id';&nbsp;</div></li><li><div>          $query_vars['meta_value'] = $_GET['bbp_forum_id'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Return manipulated query_vars</span>&nbsp;</div></li><li><div>      return $query_vars;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Custom user feedback messages for reply post type</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r3080)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @global int $post_ID</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_permalink()</span>&nbsp;</div></li><li><div><span class="comment">   * @uses wp_post_revision_title()</span>&nbsp;</div></li><li><div><span class="comment">   * @uses esc_url()</span>&nbsp;</div></li><li><div><span class="comment">   * @uses add_query_arg()</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $messages</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return array</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  public function updated_messages( $messages ) {&nbsp;</div></li><li><div>      global $post_ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $this-&gt;bail() ) return $messages;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// URL for the current topic</span>&nbsp;</div></li><li><div>      $topic_url = bbp_get_topic_permalink( bbp_get_reply_topic_id( $post_ID ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Current reply's post_date</span>&nbsp;</div></li><li><div>      $post_date = bbp_get_global_post_field( 'post_date', 'raw' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Messages</span> array&nbsp;</div></li><li><div>      $messages[$this-&gt;post_type] = array(&nbsp;</div></li><li><div>          0 =&gt;  '', <span class="comment">// Left empty on purpose</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Updated</span>&nbsp;</div></li><li><div>          1 =&gt;  sprintf( __( 'Reply updated. &lt;a href=&quot;%s&quot;&gt;View topic&lt;/a&gt;', 'bbpress' ), $topic_url ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Custom field updated</span>&nbsp;</div></li><li><div>          2 =&gt; __( 'Custom field updated.', 'bbpress' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Custom field deleted</span>&nbsp;</div></li><li><div>          3 =&gt; __( 'Custom field deleted.', 'bbpress' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Reply updated</span>&nbsp;</div></li><li><div>          4 =&gt; __( 'Reply updated.', 'bbpress' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Restored from revision</span>&nbsp;</div></li><li><div>          <span class="comment">// translators: %s: date and time of the revision</span>&nbsp;</div></li><li><div>          5 =&gt; isset( $_GET['revision'] )&nbsp;</div></li><li><div>                  ? sprintf( __( 'Reply restored to revision from %s', 'bbpress' ), wp_post_revision_title( (int) $_GET['revision'], false ) )&nbsp;</div></li><li><div>                  : false, &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Reply created</span>&nbsp;</div></li><li><div>          6 =&gt; sprintf( __( 'Reply created. &lt;a href=&quot;%s&quot;&gt;View topic&lt;/a&gt;', 'bbpress' ), $topic_url ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Reply saved</span>&nbsp;</div></li><li><div>          7 =&gt; __( 'Reply saved.', 'bbpress' ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Reply submitted</span>&nbsp;</div></li><li><div>          8 =&gt; sprintf( __( 'Reply submitted. &lt;a target=&quot;_blank&quot; href=&quot;%s&quot;&gt;Preview topic&lt;/a&gt;', 'bbpress' ), esc_url( add_query_arg( 'preview', 'true', $topic_url ) ) ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Reply scheduled</span>&nbsp;</div></li><li><div>          9 =&gt; sprintf( __( 'Reply scheduled for: &lt;strong&gt;%1$s&lt;/strong&gt;. &lt;a target=&quot;_blank&quot; href=&quot;%2$s&quot;&gt;Preview topic&lt;/a&gt;', 'bbpress' ), &nbsp;</div></li><li><div>                  <span class="comment">// translators: Publish box date format, see http://php.net/date</span>&nbsp;</div></li><li><div>                  date_i18n( __( 'M j, Y @ G:i', 'bbpress' ), &nbsp;</div></li><li><div>                  strtotime( $post_date ) ), &nbsp;</div></li><li><div>                  $topic_url ), &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Reply draft updated</span>&nbsp;</div></li><li><div>          10 =&gt; sprintf( __( 'Reply draft updated. &lt;a target=&quot;_blank&quot; href=&quot;%s&quot;&gt;Preview topic&lt;/a&gt;', 'bbpress' ), esc_url( add_query_arg( 'preview', 'true', $topic_url ) ) ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $messages;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>endif; <span class="comment">// class_exists check</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Setup bbPress Replies Admin</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This is currently here to make hooking and unhooking of the admin UI easy.</span>&nbsp;</div></li><li><div><span class="comment"> * It could use dependency injection in the future, but for now this is easier.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2596)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses BBP_Replies_Admin</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_admin_replies() {&nbsp;</div></li><li><div>  bbpress()-&gt;admin-&gt;replies = new BBP_Replies_Admin();&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>bbPress</li><li><span></span>2.5.9</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>