<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="2.5.5" data-slug="bbpress" data-type="file" data-id="62440"><head xmlns="http://www.w3.org/1999/xhtml"><title> includes-common-template | file | Bbpress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, bbpress, 2.5.5" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.24"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=436a8bdf65f54de64d3f4807c5cd4968' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.24' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/includes-common-template/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fincludes-common-template%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fincludes-common-template%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-bbpress-2.5.5-file-includes-common-template","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="includes-common-template" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to bbpress." href="http://hookr.io/plugins/bbpress/" class="plugin"><span property="name">bbpress</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.5.5." href="http://hookr.io/plugins/bbpress/2.5.5/" class="H_VERSION"><span property="name">2.5.5</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/bbpress/2.5.5/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">includes-common-template</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="2357"><a href="http://hookr.io/plugins/bbpress/2.5.5/all/" title="All">All <span class="count badge">2357</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/bbpress/2.5.5/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="1124"><a href="http://hookr.io/plugins/bbpress/2.5.5/hooks/" title="Hooks">Hooks <span class="count badge">1124</span></a></li><li class="" data-id="action" data-count="471"><a href="http://hookr.io/plugins/bbpress/2.5.5/actions/" title="Actions">Actions <span class="count badge">471</span></a></li><li class="" data-id="filter" data-count="653"><a href="http://hookr.io/plugins/bbpress/2.5.5/filters/" title="Filters">Filters <span class="count badge">653</span></a></li><li class="" data-id="class" data-count="54"><a href="http://hookr.io/plugins/bbpress/2.5.5/classes/" title="Classes">Classes <span class="count badge">54</span></a></li><li class="" data-id="constant" data-count="28"><a href="http://hookr.io/plugins/bbpress/2.5.5/constants/" title="Constants">Constants <span class="count badge">28</span></a></li><li class="" data-id="function" data-count="1150"><a href="http://hookr.io/plugins/bbpress/2.5.5/functions/" title="Functions">Functions <span class="count badge">1150</span></a></li><li class="" data-id="shortcode" data-count="1"><a href="http://hookr.io/plugins/bbpress/2.5.5/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">1</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/includes/common/template.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * bbPress Common Template Tags</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Common template tags are ones that are used by more than one component, like</span>&nbsp;</div></li><li><div><span class="comment"> * forums, topics, replies, users, topic tags, etc...</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package bbPress</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage TemplateTags</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Exit if accessed directly</span>&nbsp;</div></li><li><div>if ( !defined( 'ABSPATH' ) ) exit;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** URLs **********************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Ouput the forum URL</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3979)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_forums_url() To get the forums URL</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $path Additional path with leading slash</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_forums_url( $path = '/' ) {&nbsp;</div></li><li><div>  echo esc_url( bbp_get_forums_url( $path ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the forum URL</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r3979)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses home_url() To get the home URL</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_root_slug() To get the forum root location</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $path Additional path with leading slash</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_forums_url( $path = '/' ) {&nbsp;</div></li><li><div>      return home_url( bbp_get_root_slug() . $path );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Ouput the forum URL</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3979)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_topics_url() To get the topics URL</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $path Additional path with leading slash</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_topics_url( $path = '/' ) {&nbsp;</div></li><li><div>  echo esc_url( bbp_get_topics_url( $path ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the forum URL</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r3979)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses home_url() To get the home URL</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_archive_slug() To get the topics archive location</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $path Additional path with leading slash</span>&nbsp;</div></li><li><div><span class="comment">   * @return The URL to the topics archive</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_topics_url( $path = '/' ) {&nbsp;</div></li><li><div>      return home_url( bbp_get_topic_archive_slug() . $path );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Add-on Actions ************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Add our custom head action to wp_head</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2464)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses do_action() Calls 'bbp_head'</span>&nbsp;</div></li><li><div><span class="comment">*/</span>&nbsp;</div></li><li><div>function bbp_head() {&nbsp;</div></li><li><div>  do_action( 'bbp_head' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Add our custom head action to wp_head</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2464)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses do_action() Calls 'bbp_footer'</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_footer() {&nbsp;</div></li><li><div>  do_action( 'bbp_footer' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** is_ ***********************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current site is public</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3398)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $site_id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_current_blog_id()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_blog_option()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters()</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if site is public, false if private</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_site_public( $site_id = 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Get the current site ID</span>&nbsp;</div></li><li><div>  if ( empty( $site_id ) )&nbsp;</div></li><li><div>      $site_id = get_current_blog_id();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Get the site visibility setting</span>&nbsp;</div></li><li><div>  $public = get_blog_option( $site_id, 'blog_public', 1 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_site_public', $public, $site_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a bbPress forum</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2549)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $post_id Possible post_id to check</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_forum_post_type() To get the forum post type</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's a forum page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_forum( $post_id = 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Supplied ID is a forum</span>&nbsp;</div></li><li><div>  if ( !empty( $post_id ) && ( bbp_get_forum_post_type() === get_post_type( $post_id ) ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_forum', $retval, $post_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if we are viewing a forum archive.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3251)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses is_post_type_archive() To check if we are looking at the forum archive</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_forum_post_type() To get the forum post type ID</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_forum_archive() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Default to false</span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// In forum archive</span>&nbsp;</div></li><li><div>  if ( is_post_type_archive( bbp_get_forum_post_type() ) || bbp_is_query_name( 'bbp_forum_archive' ) || !empty( $wp_query-&gt;bbp_show_topics_on_root ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_forum_archive', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Viewing a single forum</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3338)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses is_single()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_forum_post_type()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_post_type()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_single_forum() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Edit is not a single forum</span>&nbsp;</div></li><li><div>  if ( bbp_is_forum_edit() )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Single</span> and a match</span></span></span>&nbsp;</div></li><li><div>  if ( is_singular( bbp_get_forum_post_type() ) || bbp_is_query_name( 'bbp_single_forum' ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_single_forum', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a forum edit page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3553)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Query Checks if WP_Query::bbp_is_forum_edit is true</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's the forum edit page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_forum_edit() {&nbsp;</div></li><li><div>  global $wp_query, $pagenow;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_forum_edit ) && ( $wp_query-&gt;bbp_is_forum_edit === true ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Editing in admin</span></span></span></span>&nbsp;</div></li><li><div>  elseif ( is_admin() && ( 'post.php' === $pagenow ) && ( get_post_type() === bbp_get_forum_post_type() ) && ( !empty( $_GET['action'] ) && ( 'edit' === $_GET['action'] ) ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_forum_edit', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a bbPress topic</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2549)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $post_id Possible post_id to check</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_topic_post_type() To get the topic post type</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_post_type() To get the post type of the post id</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's a topic page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_topic( $post_id = 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Supplied ID is a topic</span>&nbsp;</div></li><li><div>  if ( !empty( $post_id ) && ( bbp_get_topic_post_type() === get_post_type( $post_id ) ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_topic', $retval, $post_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Viewing a single topic</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3338)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses is_single()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_topic_post_type()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_post_type()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_single_topic() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Edit is not a single topic</span>&nbsp;</div></li><li><div>  if ( bbp_is_topic_edit() )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Single</span> and a match</span></span></span>&nbsp;</div></li><li><div>  if ( is_singular( bbp_get_topic_post_type() ) || bbp_is_query_name( 'bbp_single_topic' ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_single_topic', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if we are viewing a topic archive.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3251)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses is_post_type_archive() To check if we are looking at the topic archive</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_topic_post_type() To get the topic post type ID</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_topic_archive() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Default to false</span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// In topic archive</span>&nbsp;</div></li><li><div>  if ( is_post_type_archive( bbp_get_topic_post_type() ) || bbp_is_query_name( 'bbp_topic_archive' ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_topic_archive', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a topic edit page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2753)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Query Checks if WP_Query::bbp_is_topic_edit is true</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's the topic edit page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_topic_edit() {&nbsp;</div></li><li><div>  global $wp_query, $pagenow;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_topic_edit ) && ( $wp_query-&gt;bbp_is_topic_edit === true ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Editing in admin</span></span></span></span>&nbsp;</div></li><li><div>  elseif ( is_admin() && ( 'post.php' === $pagenow ) && ( get_post_type() === bbp_get_topic_post_type() ) && ( !empty( $_GET['action'] ) && ( 'edit' === $_GET['action'] ) ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_topic_edit', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a topic merge page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2756)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_topic_edit() To check if it's a topic edit page</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's the topic merge page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_topic_merge() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Check topic edit and GET params</span></span>&nbsp;</div></li><li><div>  if ( bbp_is_topic_edit() && !empty( $_GET['action'] ) && ( 'merge' === $_GET['action'] ) )&nbsp;</div></li><li><div>      return true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_topic_merge', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a topic split page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2756)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_topic_edit() To check if it's a topic edit page</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's the topic split page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_topic_split() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Check topic edit and GET params</span></span>&nbsp;</div></li><li><div>  if ( bbp_is_topic_edit() && !empty( $_GET['action'] ) && ( 'split' === $_GET['action'] ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_topic_split', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if the current page is a topic tag</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3311)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's a topic tag, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_topic_tag() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Bail if topic-tags are off</span></span>&nbsp;</div></li><li><div>  if ( ! bbp_allow_topic_tags() )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Return false if editing a topic tag</span>&nbsp;</div></li><li><div>  if ( bbp_is_topic_tag_edit() )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Check tax and query vars</span>&nbsp;</div></li><li><div>  if ( is_tax( bbp_get_topic_tag_tax_id() ) || !empty( bbpress()-&gt;topic_query-&gt;is_tax ) || get_query_var( 'bbp_topic_tag' ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_topic_tag', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if the current page is editing a topic tag</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3346)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Query Checks if WP_Query::bbp_is_topic_tag_edit is true</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if editing a topic tag, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_topic_tag_edit() {&nbsp;</div></li><li><div>  global $wp_query, $pagenow, $taxnow;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Bail if topic-tags are off</span></span>&nbsp;</div></li><li><div>  if ( ! bbp_allow_topic_tags() )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_topic_tag_edit ) && ( true === $wp_query-&gt;bbp_is_topic_tag_edit ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Editing in admin</span></span></span></span>&nbsp;</div></li><li><div>  elseif ( is_admin() && ( 'edit-tags.php' === $pagenow ) && ( bbp_get_topic_tag_tax_id() === $taxnow ) && ( !empty( $_GET['action'] ) && ( 'edit' === $_GET['action'] ) ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_topic_tag_edit', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if the current post type is one of bbPress's</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3311)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $the_post Optional. Post object or post ID.</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_post_type()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_forum_post_type()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_topic_post_type()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_post_type()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_custom_post_type( $the_post = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// View</span>ing one of the bbPress post types</span>&nbsp;</div></li><li><div>  if ( in_array( get_post_type( $the_post ), array(&nbsp;</div></li><li><div>      bbp_get_forum_post_type(), &nbsp;</div></li><li><div>      bbp_get_topic_post_type(), &nbsp;</div></li><li><div>      bbp_get_reply_post_type()&nbsp;</div></li><li><div> ) ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_custom_post_type', $retval, $the_post );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a bbPress reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2549)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $post_id Possible post_id to check</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_post_type() To get the post type of the post id</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's a reply page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_reply( $post_id = 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Supplied ID is a reply</span>&nbsp;</div></li><li><div>  if ( !empty( $post_id ) && ( bbp_get_reply_post_type() === get_post_type( $post_id ) ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_reply', $retval, $post_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a reply edit page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2753)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Query Checks if WP_Query::bbp_is_reply_edit is true</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's the reply edit page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_reply_edit() {&nbsp;</div></li><li><div>  global $wp_query, $pagenow;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_reply_edit ) && ( true === $wp_query-&gt;bbp_is_reply_edit ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Editing in admin</span></span></span></span>&nbsp;</div></li><li><div>  elseif ( is_admin() && ( 'post.php' === $pagenow ) && ( get_post_type() === bbp_get_reply_post_type() ) && ( !empty( $_GET['action'] ) && ( 'edit' === $_GET['action'] ) ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_reply_edit', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a reply move page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_reply_move() To check if it's a reply move page</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's the reply move page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_reply_move() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Check reply edit and GET params</span>&nbsp;</div></li><li><div>  if ( bbp_is_reply_edit() && !empty( $_GET['action'] ) && ( 'move' === $_GET['action'] ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_reply_move', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Viewing a single reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3344)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses is_single()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_post_type()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_post_type()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters()</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_single_reply() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Edit is not a single reply</span>&nbsp;</div></li><li><div>  if ( bbp_is_reply_edit() )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment">// Single</span> and a match</span></span></span>&nbsp;</div></li><li><div>  if ( is_singular( bbp_get_reply_post_type() ) || ( bbp_is_query_name( 'bbp_single_reply' ) ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_single_reply', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a bbPress user's favorites page (profile page)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2652)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's the favorites page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_favorites() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_single_user_favs ) && ( true === $wp_query-&gt;bbp_is_single_user_favs ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_favorites', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a bbPress user's subscriptions page (profile page)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2652)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's the subscriptions page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_subscriptions() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_single_user_subs ) && ( true === $wp_query-&gt;bbp_is_single_user_subs ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_subscriptions', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page shows the topics created by a bbPress user (profile</span>&nbsp;</div></li><li><div><span class="comment"> * page)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2688)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's the topics created page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_topics_created() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_single_user_topics ) && ( true === $wp_query-&gt;bbp_is_single_user_topics ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_topics_created', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page shows the topics created by a bbPress user (profile</span>&nbsp;</div></li><li><div><span class="comment"> * page)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4225)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's the topics created page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_replies_created() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_single_user_replies ) && ( true === $wp_query-&gt;bbp_is_single_user_replies ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_replies_created', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is the currently logged in users author page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2688)</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_user() Check query variable</span>&nbsp;</div></li><li><div><span class="comment"> * @uses is_user_logged_in() Must be logged in to be home</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_displayed_user_id()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_current_user_id()</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's the user's home, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_user_home() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_single_user_home ) && ( true === $wp_query-&gt;bbp_is_single_user_home ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_user_home', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is the currently logged in users author edit page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3918)</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_user_edit() Check query variable</span>&nbsp;</div></li><li><div><span class="comment"> * @uses is_user_logged_in() Must be logged in to be home</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_displayed_user_id()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_current_user_id()</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's the user's home, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_user_home_edit() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( bbp_is_user_home() && bbp_is_single_user_edit() )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_user_home_edit', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a user profile page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2688)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Query Checks if WP_Query::bbp_is_single_user is set to true</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's a user's profile page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_single_user() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_single_user ) && ( true === $wp_query-&gt;bbp_is_single_user ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_single_user', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a user profile edit page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2688)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Query Checks if WP_Query::bbp_is_single_user_edit is set to true</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's a user's profile edit page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_single_user_edit() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_single_user_edit ) && ( true === $wp_query-&gt;bbp_is_single_user_edit ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_single_user_edit', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a user profile page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4225)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Query Checks if WP_Query::bbp_is_single_user_profile is set to true</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's a user's profile page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_single_user_profile() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_single_user_profile ) && ( true === $wp_query-&gt;bbp_is_single_user_profile ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_single_user_profile', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a user topics created page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4225)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Query Checks if WP_Query::bbp_is_single_user_topics is set to true</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's a user's topics page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_single_user_topics() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_single_user_topics ) && ( true === $wp_query-&gt;bbp_is_single_user_topics ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_single_user_topics', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a user replies created page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4225)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Query Checks if WP_Query::bbp_is_single_user_replies is set to true</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's a user's replies page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_single_user_replies() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_single_user_replies ) && ( true === $wp_query-&gt;bbp_is_single_user_replies ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_single_user_replies', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a view page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2789)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Query $wp_query To check if WP_Query::bbp_is_view is true</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_query_name() To get the query name</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool Is it a view page?</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_single_view() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_view ) && ( true === $wp_query-&gt;bbp_is_view ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> name&nbsp;</div></li><li><div>  if ( empty( $retval ) && bbp_is_query_name( 'bbp_single_view' ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_single_view', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a search page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4579)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Query $wp_query To check if WP_Query::bbp_is_search is true</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_query_name() To get the query name</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool Is it a search page?</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_search() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Bail if search is disabled</span></span>&nbsp;</div></li><li><div>  if ( ! bbp_allow_search() )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_search ) && ( true === $wp_query-&gt;bbp_is_search ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> name&nbsp;</div></li><li><div>  if ( empty( $retval ) && bbp_is_query_name( bbp_get_search_rewrite_id() ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Check $_GET</span>&nbsp;</div></li><li><div>  if ( empty( $retval ) && isset( $_REQUEST[ bbp_get_search_rewrite_id() ] ) && empty( $_REQUEST[ bbp_get_search_rewrite_id() ] ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_search', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is a search results page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4919)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @global WP_Query $wp_query To check if WP_Query::bbp_is_search is true</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_query_name() To get the query name</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool Is it a search page?</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_search_results() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Bail if search is disabled</span></span>&nbsp;</div></li><li><div>  if ( ! bbp_allow_search() )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_search_terms ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> name&nbsp;</div></li><li><div>  if ( empty( $retval ) && bbp_is_query_name( 'bbp_search_results' ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Check $_REQUEST</span>&nbsp;</div></li><li><div>  if ( empty( $retval ) && !empty( $_REQUEST[ bbp_get_search_rewrite_id() ] ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_search_results', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check if current page is an edit page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3585)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Query Checks if WP_Query::bbp_is_edit is true</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if it's the edit page, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_edit() {&nbsp;</div></li><li><div>  global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Assume false</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Check query</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  if ( !empty( $wp_query-&gt;bbp_is_edit ) && ( $wp_query-&gt;bbp_is_edit === true ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_edit', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Use the above is_() functions to output a body class for each scenario</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2926)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $wp_classes</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $custom_classes</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_forum()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_topic()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_topic_edit()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_topic_merge()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_topic_split()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_reply()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_reply_edit()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_reply_move()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_view()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_user_edit()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_user()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_user_home()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_subscriptions()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_favorites()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_topics_created()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_forum_archive()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_topic_archive()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_topic_tag()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_topic_tag_edit()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_topic_tag_tax_id()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_topic_tag_slug()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_topic_tag_id()</span>&nbsp;</div></li><li><div><span class="comment"> * @return array Body Classes</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_body_class( $wp_classes, $custom_classes = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $bbp_classes = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment">/** Archives **************************************************************/</span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( bbp_is_forum_archive() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_forum_post_type() . '-archive';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_archive() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_topic_post_type() . '-archive';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">/** Topic Tags ************************************************************/</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_tag() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_topic_tag_tax_id();&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_topic_tag_tax_id() . '-' . bbp_get_topic_tag_slug();&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_topic_tag_tax_id() . '-' . bbp_get_topic_tag_id();&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_tag_edit() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_topic_tag_tax_id() . '-edit';&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_topic_tag_tax_id() . '-' . bbp_get_topic_tag_slug() . '-edit';&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_topic_tag_tax_id() . '-' . bbp_get_topic_tag_id()   . '-edit';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">/** Components ************************************************************/</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_forum() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_forum_post_type();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_topic() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_topic_post_type();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_reply() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_reply_post_type();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_edit() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_topic_post_type() . '-edit';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_merge() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_topic_post_type() . '-merge';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_split() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_topic_post_type() . '-split';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_reply_edit() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_reply_post_type() . '-edit';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_reply_move() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = bbp_get_reply_post_type() . '-move';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_view() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = 'bbp-view';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">/** User ******************************************************************/</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_user_edit() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = 'bbp-user-edit';&nbsp;</div></li><li><div>      $bbp_classes[] = 'single';&nbsp;</div></li><li><div>      $bbp_classes[] = 'singular';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_user() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = 'bbp-user-page';&nbsp;</div></li><li><div>      $bbp_classes[] = 'single';&nbsp;</div></li><li><div>      $bbp_classes[] = 'singular';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_user_home() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = 'bbp-user-home';&nbsp;</div></li><li><div>      $bbp_classes[] = 'single';&nbsp;</div></li><li><div>      $bbp_classes[] = 'singular';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_user_home_edit() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = 'bbp-user-home-edit';&nbsp;</div></li><li><div>      $bbp_classes[] = 'single';&nbsp;</div></li><li><div>      $bbp_classes[] = 'singular';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_topics_created() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = 'bbp-topics-created';&nbsp;</div></li><li><div>      $bbp_classes[] = 'single';&nbsp;</div></li><li><div>      $bbp_classes[] = 'singular';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_favorites() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = 'bbp-favorites';&nbsp;</div></li><li><div>      $bbp_classes[] = 'single';&nbsp;</div></li><li><div>      $bbp_classes[] = 'singular';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_subscriptions() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = 'bbp-subscriptions';&nbsp;</div></li><li><div>      $bbp_classes[] = 'single';&nbsp;</div></li><li><div>      $bbp_classes[] = 'singular';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment">/** Search ****************************************************************/</span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_search() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = 'bbp-search';&nbsp;</div></li><li><div>      $bbp_classes[] = 'forum-search';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_search_results() ) {&nbsp;</div></li><li><div>      $bbp_classes[] = 'bbp-search-results';&nbsp;</div></li><li><div>      $bbp_classes[] = 'forum-search-results';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/** Clean up **************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Add bbPress class if we are within a bbPress page</span>&nbsp;</div></li><li><div>  if ( !empty( $bbp_classes ) ) {&nbsp;</div></li><li><div>      $bbp_classes[] = 'bbpress';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Merge WP classes with bbPress classes and remove any duplicates</span>&nbsp;</div></li><li><div>  $classes = array_unique( array_merge( (array) $bbp_classes, (array) $wp_classes ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Deprecated filter (do not use)</span>&nbsp;</div></li><li><div>  $classes = apply_filters( 'bbp_get_the_body_class', $classes, $bbp_classes, $wp_classes, $custom_classes );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return apply_filters( 'bbp_body_class', $classes, $bbp_classes, $wp_classes, $custom_classes );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Use the above is_() functions to return if in any bbPress page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3344)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_forum()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_topic()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_topic_edit()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_topic_merge()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_topic_split()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_reply()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_reply_edit()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_reply_move()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_view()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_user_edit()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_user()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_user_home()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_subscriptions()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_favorites()</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_topics_created()</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool In a bbPress page</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function is_bbpress() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Defalt to false</span>&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment">/** Archives **************************************************************/</span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( bbp_is_forum_archive() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_archive() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">/** Topic Tags ************************************************************/</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_tag() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_tag_edit() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">/** Components ************************************************************/</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_forum() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_topic() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_reply() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_edit() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_merge() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_split() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_reply_edit() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_reply_move() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_view() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">/** User ******************************************************************/</span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_user_edit() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_user() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_user_home() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_user_home_edit() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_topics_created() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_favorites() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_subscriptions() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment">/** Search ****************************************************************/</span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_search() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( bbp_is_search_results() ) {&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/** Done ******************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'is_bbpress', $retval );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Forms *********************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the login form action url</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2815)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $url Pass a URL to redirect to</span>&nbsp;</div></li><li><div><span class="comment"> * @uses add_query_arg() To add a arg to the url</span>&nbsp;</div></li><li><div><span class="comment"> * @uses site_url() Toget the site url</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters() Calls 'bbp_wp_login_action' with the url and args</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_wp_login_action( $args = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment">// Parse arguments against default values</span></span></span>&nbsp;</div></li><li><div>  $r = bbp_parse_args( $args, array(&nbsp;</div></li><li><div>      'action' =&gt; '', &nbsp;</div></li><li><div>      'context' =&gt; ''&nbsp;</div></li><li><div> ), 'login_action' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Add action as query arg</span>&nbsp;</div></li><li><div>  if ( !empty( $r['action'] ) ) {&nbsp;</div></li><li><div>      $login_url = add_query_arg( array( 'action' =&gt; $r['action'] ), 'wp-login.php' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// No query arg</span>&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $login_url = 'wp-login.php';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $login_url = site_url( $login_url, $r['context'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'bbp_wp_login_action', $login_url, $r );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output hidden request URI field for user forms.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * The referer link is the current Request URI from the server super global. To</span>&nbsp;</div></li><li><div><span class="comment"> * check the field manually, use bbp_get_redirect_to().</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2815)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $redirect_to Pass a URL to redirect to</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses wp_get_referer() To get the referer</span>&nbsp;</div></li><li><div><span class="comment"> * @uses esc_attr() To escape the url</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters() Calls 'bbp_redirect_to_field', passes field and to</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_redirect_to_field( $redirect_to = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Make sure we are directing somewhere</span>&nbsp;</div></li><li><div>  if ( empty( $redirect_to ) ) {&nbsp;</div></li><li><div>      if ( isset( $_SERVER['REQUEST_URI'] ) ) {&nbsp;</div></li><li><div>          $redirect_to = ( is_ssl() ? 'https:<span class="comment">//' : 'http://' ) . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $redirect_to = wp_get_referer();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Remove loggedout query arg if it's there</span>&nbsp;</div></li><li><div>  $redirect_to = (string) esc_attr( remove_query_arg( 'loggedout', $redirect_to ) );&nbsp;</div></li><li><div>  $redirect_field = '&lt;input type=&quot;hidden&quot; id=&quot;bbp_redirect_to&quot; name=&quot;redirect_to&quot; value=&quot;' . $redirect_to . '&quot; /&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'bbp_redirect_to_field', $redirect_field, $redirect_to );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Echo sanitized $_REQUEST value.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Use the $input_type parameter to properly process the value. This</span>&nbsp;</div></li><li><div><span class="comment"> * ensures correct sanitization of the value for the receiving input.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2815)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $request Name of $_REQUEST to look for</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $input_type Type of input. Default: text. Accepts:</span>&nbsp;</div></li><li><div><span class="comment"> *                            textarea|password|select|radio|checkbox</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_sanitize_val() To sanitize the value.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_sanitize_val( $request = '', $input_type = 'text' ) {&nbsp;</div></li><li><div>  echo bbp_get_sanitize_val( $request, $input_type );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return sanitized $_REQUEST value.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Use the $input_type parameter to properly process the value. This</span>&nbsp;</div></li><li><div><span class="comment">   * ensures correct sanitization of the value for the receiving input.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2815)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $request Name of $_REQUEST to look for</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $input_type Type of input. Default: text. Accepts:</span>&nbsp;</div></li><li><div><span class="comment">   *                            textarea|password|select|radio|checkbox</span>&nbsp;</div></li><li><div><span class="comment">   * @uses esc_attr() To escape the string</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_sanitize_val' with the sanitized</span>&nbsp;</div></li><li><div><span class="comment">   *                        value, request and input type</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Sanitized value ready for screen display</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_sanitize_val( $request = '', $input_type = 'text' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Check that requested</span>&nbsp;</div></li><li><div>      if ( empty( $_REQUEST[$request] ) )&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set request varaible</span>&nbsp;</div></li><li><div>      $pre_ret_val = $_REQUEST[$request];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Treat different kinds of fields in different ways</span>&nbsp;</div></li><li><div>      switch ( $input_type ) {&nbsp;</div></li><li><div>          case 'text'     :&nbsp;</div></li><li><div>          case 'textarea' :&nbsp;</div></li><li><div>              $retval = esc_attr( stripslashes( $pre_ret_val ) );&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          case 'password' :&nbsp;</div></li><li><div>          case 'select'   :&nbsp;</div></li><li><div>          case 'radio'    :&nbsp;</div></li><li><div>          case 'checkbox' :&nbsp;</div></li><li><div>          default :&nbsp;</div></li><li><div>              $retval = esc_attr( $pre_ret_val );&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_sanitize_val', $retval, $request, $input_type );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the current tab index of a given form</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Use this function to handle the tab indexing of user facing forms within a</span>&nbsp;</div></li><li><div><span class="comment"> * template file. Calling this function will automatically increment the global</span>&nbsp;</div></li><li><div><span class="comment"> * tab index by default.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2810)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $auto_increment Optional. Default true. Set to false to prevent</span>&nbsp;</div></li><li><div><span class="comment"> *                             increment</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_tab_index( $auto_increment = true ) {&nbsp;</div></li><li><div>  echo bbp_get_tab_index( $auto_increment );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Output the current tab index of a given form</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Use this function to handle the tab indexing of user facing forms</span>&nbsp;</div></li><li><div><span class="comment">   * within a template file. Calling this function will automatically</span>&nbsp;</div></li><li><div><span class="comment">   * increment the global tab index by default.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2810)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters Allows return value to be filtered</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $auto_increment Optional. Default true. Set to false to</span>&nbsp;</div></li><li><div><span class="comment">   *                             prevent the increment</span>&nbsp;</div></li><li><div><span class="comment">   * @return int $bbp-&gt;tab_index The global tab index</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_tab_index( $auto_increment = true ) {&nbsp;</div></li><li><div>      $bbp = bbpress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( true === $auto_increment )&nbsp;</div></li><li><div>          ++$bbp-&gt;tab_index;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_tab_index', (int) $bbp-&gt;tab_index );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output a select box allowing to pick which forum/topic a new topic/reply</span>&nbsp;</div></li><li><div><span class="comment"> * belongs in.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Can be used for any post type, but is mostly used for topics and forums.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2746)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $args See {@link bbp_get_dropdown()} for arguments</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_dropdown( $args = '' ) {&nbsp;</div></li><li><div>  echo bbp_get_dropdown( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Output a select box allowing to pick which forum/topic a new</span>&nbsp;</div></li><li><div><span class="comment">   * topic/reply belongs in.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2746)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param mixed $args The function supports these args:</span>&nbsp;</div></li><li><div><span class="comment">   *  - post_type: Post type, defaults to bbp_get_forum_post_type() (bbp_forum)</span>&nbsp;</div></li><li><div><span class="comment">   *  - selected: Selected ID, to not have any value as selected, pass</span>&nbsp;</div></li><li><div><span class="comment">   *               anything smaller than 0 (due to the nature of select</span>&nbsp;</div></li><li><div><span class="comment">   *               box, the first value would of course be selected -</span>&nbsp;</div></li><li><div><span class="comment">   *               though you can have that as none (pass 'show_none' arg))</span>&nbsp;</div></li><li><div><span class="comment">   *  - orderby: Defaults to 'menu_order title'</span>&nbsp;</div></li><li><div><span class="comment">   *  - post_parent: Post parent. Defaults to 0</span>&nbsp;</div></li><li><div><span class="comment">   *  - post_status: Which all post_statuses to find in? Can be an array</span>&nbsp;</div></li><li><div><span class="comment">   *                  or CSV of publish, category, closed, private, spam, </span>&nbsp;</div></li><li><div><span class="comment">   *                  trash (based on post type) - if not set, these are</span>&nbsp;</div></li><li><div><span class="comment">   *                  automatically determined based on the post_type</span>&nbsp;</div></li><li><div><span class="comment">   *  - posts_per_page: Retrieve all forums/topics. Defaults to -1 to get</span>&nbsp;</div></li><li><div><span class="comment">   *                     all posts</span>&nbsp;</div></li><li><div><span class="comment">   *  - walker: Which walker to use? Defaults to</span>&nbsp;</div></li><li><div><span class="comment">   *             {@link BBP_Walker_Dropdown}</span>&nbsp;</div></li><li><div><span class="comment">   *  - select_id: ID of the select box. Defaults to 'bbp_forum_id'</span>&nbsp;</div></li><li><div><span class="comment">   *  - tab: Tabindex value. False or integer</span>&nbsp;</div></li><li><div><span class="comment">   *  - options_only: Show only &lt;options&gt;? No &lt;select&gt;?</span>&nbsp;</div></li><li><div><span class="comment">   *  - show_none: Boolean or String __( '(No Forum)', 'bbpress' )</span>&nbsp;</div></li><li><div><span class="comment">   *  - disable_categories: Disable forum categories and closed forums?</span>&nbsp;</div></li><li><div><span class="comment">   *                         Defaults to true. Only for forums and when</span>&nbsp;</div></li><li><div><span class="comment">   *                         the category option is displayed.</span>&nbsp;</div></li><li><div><span class="comment">   * @uses BBP_Walker_Dropdown() As the default walker to generate the</span>&nbsp;</div></li><li><div><span class="comment">   *                              dropdown</span>&nbsp;</div></li><li><div><span class="comment">   * @uses current_user_can() To check if the current user can read</span>&nbsp;</div></li><li><div><span class="comment">   *                           private forums</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_forum_post_type() To get the forum post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_post_type() To get the topic post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses walk_page_dropdown_tree() To generate the dropdown using the</span>&nbsp;</div></li><li><div><span class="comment">   *                                  walker</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_dropdown' with the dropdown</span>&nbsp;</div></li><li><div><span class="comment">   *                        and args</span>&nbsp;</div></li><li><div><span class="comment">   * @return string The dropdown</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_dropdown( $args = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Arguments *********************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// Parse arguments against default values</span></span></span>&nbsp;</div></li><li><div>      $r = bbp_parse_args( $args, array(&nbsp;</div></li><li><div>          'post_type' =&gt; bbp_get_forum_post_type(), &nbsp;</div></li><li><div>          'post_parent' =&gt; null, &nbsp;</div></li><li><div>          'post_status' =&gt; null, &nbsp;</div></li><li><div>          'selected' =&gt; 0, &nbsp;</div></li><li><div>          'exclude' =&gt; array(), &nbsp;</div></li><li><div>          'numberposts' =&gt; -1, &nbsp;</div></li><li><div>          'orderby' =&gt; 'menu_order title', &nbsp;</div></li><li><div>          'order' =&gt; 'ASC', &nbsp;</div></li><li><div>          'walker' =&gt; '', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Output-related</span>&nbsp;</div></li><li><div>          'select_id' =&gt; 'bbp_forum_id', &nbsp;</div></li><li><div>          'tab' =&gt; bbp_get_tab_index(), &nbsp;</div></li><li><div>          'options_only' =&gt; false, &nbsp;</div></li><li><div>          'show_none' =&gt; false, &nbsp;</div></li><li><div>          'disable_categories' =&gt; true, &nbsp;</div></li><li><div>          'disabled' =&gt; ''&nbsp;</div></li><li><div> ), 'get_dropdown' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $r['walker'] ) ) {&nbsp;</div></li><li><div>          $r['walker'] = new BBP_Walker_Dropdown();&nbsp;</div></li><li><div>          $r['walker']-&gt;tree_type = $r['post_type'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Force 0</span>&nbsp;</div></li><li><div>      if ( is_numeric( $r['selected'] ) && $r['selected'] &lt; 0 ) {&nbsp;</div></li><li><div>          $r['selected'] = 0;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Force array</span>&nbsp;</div></li><li><div>      if ( !empty( $r['exclude'] ) && !is_array( $r['exclude'] ) ) {&nbsp;</div></li><li><div>          $r['exclude'] = explode( ', ', $r['exclude'] );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Setup variables ***************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $retval = '';&nbsp;</div></li><li><div>      $posts = get_posts( array(&nbsp;</div></li><li><div>          'post_type' =&gt; $r['post_type'], &nbsp;</div></li><li><div>          'post_status' =&gt; $r['post_status'], &nbsp;</div></li><li><div>          'exclude' =&gt; $r['exclude'], &nbsp;</div></li><li><div>          'post_parent' =&gt; $r['post_parent'], &nbsp;</div></li><li><div>          'numberposts' =&gt; $r['numberposts'], &nbsp;</div></li><li><div>          'orderby' =&gt; $r['orderby'], &nbsp;</div></li><li><div>          'order' =&gt; $r['order'], &nbsp;</div></li><li><div>          'walker' =&gt; $r['walker'], &nbsp;</div></li><li><div>          'disable_categories' =&gt; $r['disable_categories']&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Drop Down *********************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Build the opening tag for the select element</span>&nbsp;</div></li><li><div>      if ( empty( $r['options_only'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Should this select appear disabled?</span>&nbsp;</div></li><li><div>          $disabled = disabled( isset( bbpress()-&gt;options[ $r['disabled'] ] ), true, false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Setup the tab index attribute</span>&nbsp;</div></li><li><div>          $tab = !empty( $r['tab'] ) ? ' tabindex=&quot;' . intval( $r['tab'] ) . '&quot;' : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Open the select tag</span>&nbsp;</div></li><li><div>          $retval   .= '&lt;select name=&quot;' . esc_attr( $r['select_id'] ) . '&quot; id=&quot;' . esc_attr( $r['select_id'] ) . '&quot;' . $disabled . $tab . '&gt;' . &quot;\n&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Display a leading 'no-value' option, with or without custom text</span>&nbsp;</div></li><li><div>      if ( !empty( $r['show_none'] ) || !empty( $r['none_found'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Open the 'no-value' option tag</span>&nbsp;</div></li><li><div>          $retval .= &quot;\t&lt;option value=\&quot;\&quot; class=\&quot;level-0\&quot;&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Use deprecated 'none_found' first for backpat</span>&nbsp;</div></li><li><div>          if ( ! empty( $r['none_found'] ) && is_string( $r['none_found'] ) ) {&nbsp;</div></li><li><div>              $retval .= esc_html( $r['none_found'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Use 'show_none' second</span>&nbsp;</div></li><li><div>          } elseif ( ! empty( $r['show_none'] ) && is_string( $r['show_none'] ) ) {&nbsp;</div></li><li><div>              $retval .= esc_html( $r['show_none'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Otherwise, make some educated guesses</span>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Switch the response based on post type</span>&nbsp;</div></li><li><div>              switch ( $r['post_type'] ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// Topic</span>s</span>&nbsp;</div></li><li><div>                  case bbp_get_topic_post_type() :&nbsp;</div></li><li><div>                      $retval .= esc_html__( 'No topics available', 'bbpress' );&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment"><span class="comment">// Forum</span>s</span>&nbsp;</div></li><li><div>                  case bbp_get_forum_post_type() :&nbsp;</div></li><li><div>                      $retval .= esc_html__( 'No forums available', 'bbpress' );&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Any other</span>&nbsp;</div></li><li><div>                  default :&nbsp;</div></li><li><div>                      $retval .= esc_html__( 'None available', 'bbpress' );&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Close the 'no-value' option tag</span>&nbsp;</div></li><li><div>          $retval .= '&lt;/option&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Items found so walk the tree</span>&nbsp;</div></li><li><div>      if ( !empty( $posts ) ) {&nbsp;</div></li><li><div>          $retval .= walk_page_dropdown_tree( $posts, 0, $r );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Close the selecet tag</span>&nbsp;</div></li><li><div>      if ( empty( $r['options_only'] ) ) {&nbsp;</div></li><li><div>          $retval .= '&lt;/select&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_dropdown', $retval, $r );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the required hidden fields when creating/editing a forum</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3553)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_forum_edit() To check if it's the forum edit page</span>&nbsp;</div></li><li><div><span class="comment"> * @uses wp_nonce_field() To generate hidden nonce fields</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_forum_id() To output the forum id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_forum() To check if it's a forum page</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_forum_id() To output the forum id</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_forum_form_fields() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( bbp_is_forum_edit() ) : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;input type=&quot;hidden&quot; name=&quot;action&quot;       id=&quot;bbp_post_action&quot; value=&quot;bbp-edit-forum&quot; /&gt;&nbsp;</div></li><li><div>      &lt;input type=&quot;hidden&quot; name=&quot;bbp_forum_id&quot; id=&quot;bbp_forum_id&quot;    value=&quot;&lt;?php bbp_forum_id(); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( current_user_can( 'unfiltered_html' ) )&nbsp;</div></li><li><div>          wp_nonce_field( 'bbp-unfiltered-html-forum_' . bbp_get_forum_id(), '_bbp_unfiltered_html_forum', false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php wp_nonce_field( 'bbp-edit-forum_' . bbp_get_forum_id() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  else :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( bbp_is_single_forum() ) : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;input type=&quot;hidden&quot; name=&quot;bbp_forum_parent_id&quot; id=&quot;bbp_forum_parent_id&quot; value=&quot;&lt;?php bbp_forum_parent_id(); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;input type=&quot;hidden&quot; name=&quot;action&quot; id=&quot;bbp_post_action&quot; value=&quot;bbp-new-forum&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( current_user_can( 'unfiltered_html' ) )&nbsp;</div></li><li><div>          wp_nonce_field( 'bbp-unfiltered-html-forum_new', '_bbp_unfiltered_html_forum', false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php wp_nonce_field( 'bbp-new-forum' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the required hidden fields when creating/editing a topic</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2753)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_topic_edit() To check if it's the topic edit page</span>&nbsp;</div></li><li><div><span class="comment"> * @uses wp_nonce_field() To generate hidden nonce fields</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_topic_id() To output the topic id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_forum() To check if it's a forum page</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_forum_id() To output the forum id</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_topic_form_fields() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( bbp_is_topic_edit() ) : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;input type=&quot;hidden&quot; name=&quot;action&quot;       id=&quot;bbp_post_action&quot; value=&quot;bbp-edit-topic&quot; /&gt;&nbsp;</div></li><li><div>      &lt;input type=&quot;hidden&quot; name=&quot;bbp_topic_id&quot; id=&quot;bbp_topic_id&quot;    value=&quot;&lt;?php bbp_topic_id(); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( current_user_can( 'unfiltered_html' ) )&nbsp;</div></li><li><div>          wp_nonce_field( 'bbp-unfiltered-html-topic_' . bbp_get_topic_id(), '_bbp_unfiltered_html_topic', false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php wp_nonce_field( 'bbp-edit-topic_' . bbp_get_topic_id() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  else :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( bbp_is_single_forum() ) : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;input type=&quot;hidden&quot; name=&quot;bbp_forum_id&quot; id=&quot;bbp_forum_id&quot; value=&quot;&lt;?php bbp_forum_id(); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;input type=&quot;hidden&quot; name=&quot;action&quot; id=&quot;bbp_post_action&quot; value=&quot;bbp-new-topic&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php if ( current_user_can( 'unfiltered_html' ) )&nbsp;</div></li><li><div>          wp_nonce_field( 'bbp-unfiltered-html-topic_new', '_bbp_unfiltered_html_topic', false ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php wp_nonce_field( 'bbp-new-topic' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the required hidden fields when creating/editing a reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2753)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_reply_edit() To check if it's the reply edit page</span>&nbsp;</div></li><li><div><span class="comment"> * @uses wp_nonce_field() To generate hidden nonce fields</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_reply_id() To output the reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_topic_id() To output the topic id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_forum_id() To output the forum id</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_form_fields() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( bbp_is_reply_edit() ) : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;input type=&quot;hidden&quot; name=&quot;bbp_reply_id&quot;    id=&quot;bbp_reply_id&quot;    value=&quot;&lt;?php bbp_reply_id(); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>      &lt;input type=&quot;hidden&quot; name=&quot;bbp_reply_to&quot;    id=&quot;bbp_reply_to&quot;    value=&quot;&lt;?php bbp_form_reply_to(); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>      &lt;input type=&quot;hidden&quot; name=&quot;action&quot;          id=&quot;bbp_post_action&quot; value=&quot;bbp-edit-reply&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php if ( current_user_can( 'unfiltered_html' ) )&nbsp;</div></li><li><div>          wp_nonce_field( 'bbp-unfiltered-html-reply_' . bbp_get_reply_id(), '_bbp_unfiltered_html_reply', false ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php wp_nonce_field( 'bbp-edit-reply_' . bbp_get_reply_id() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  else : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;input type=&quot;hidden&quot; name=&quot;bbp_topic_id&quot;    id=&quot;bbp_topic_id&quot;    value=&quot;&lt;?php bbp_topic_id(); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>      &lt;input type=&quot;hidden&quot; name=&quot;bbp_reply_to&quot;    id=&quot;bbp_reply_to&quot;    value=&quot;&lt;?php bbp_form_reply_to(); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>      &lt;input type=&quot;hidden&quot; name=&quot;action&quot;          id=&quot;bbp_post_action&quot; value=&quot;bbp-new-reply&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php if ( current_user_can( 'unfiltered_html' ) )&nbsp;</div></li><li><div>          wp_nonce_field( 'bbp-unfiltered-html-reply_' . bbp_get_topic_id(), '_bbp_unfiltered_html_reply', false ); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php wp_nonce_field( 'bbp-new-reply' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Show redirect field if not viewing a specific topic</span>&nbsp;</div></li><li><div>      if ( bbp_is_query_name( 'bbp_single_topic' ) ) :&nbsp;</div></li><li><div>          bbp_redirect_to_field( get_permalink() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      endif;&nbsp;</div></li><li><div>  endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the required hidden fields when editing a user</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2690)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_displayed_user_id() To output the displayed user id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses wp_nonce_field() To generate a hidden referer field</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_edit_user_form_fields() {&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;input type=&quot;hidden&quot; name=&quot;action&quot;  id=&quot;bbp_post_action&quot; value=&quot;bbp-update-user&quot; /&gt;&nbsp;</div></li><li><div>  &lt;input type=&quot;hidden&quot; name=&quot;user_id&quot; id=&quot;user_id&quot;         value=&quot;&lt;?php bbp_displayed_user_id(); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php wp_nonce_field( 'update-user_' . bbp_get_displayed_user_id() );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Merge topic form fields</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Output the required hidden fields when merging a topic</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2756)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses wp_nonce_field() To generate a hidden nonce field</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_topic_id() To output the topic id</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_merge_topic_form_fields() {&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;input type=&quot;hidden&quot; name=&quot;action&quot;       id=&quot;bbp_post_action&quot; value=&quot;bbp-merge-topic&quot; /&gt;&nbsp;</div></li><li><div>  &lt;input type=&quot;hidden&quot; name=&quot;bbp_topic_id&quot; id=&quot;bbp_topic_id&quot;    value=&quot;&lt;?php bbp_topic_id(); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php wp_nonce_field( 'bbp-merge-topic_' . bbp_get_topic_id() );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Split topic form fields</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Output the required hidden fields when splitting a topic</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2756)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses wp_nonce_field() To generate a hidden nonce field</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_split_topic_form_fields() {&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;input type=&quot;hidden&quot; name=&quot;action&quot;       id=&quot;bbp_post_action&quot; value=&quot;bbp-split-topic&quot; /&gt;&nbsp;</div></li><li><div>  &lt;input type=&quot;hidden&quot; name=&quot;bbp_reply_id&quot; id=&quot;bbp_reply_id&quot;    value=&quot;&lt;?php echo absint( $_GET['reply_id'] ); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php wp_nonce_field( 'bbp-split-topic_' . bbp_get_topic_id() );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Move reply form fields</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Output the required hidden fields when moving a reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses wp_nonce_field() To generate a hidden nonce field</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_move_reply_form_fields() {&nbsp;</div></li><li><div>?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;input type=&quot;hidden&quot; name=&quot;action&quot;       id=&quot;bbp_post_action&quot; value=&quot;bbp-move-reply&quot; /&gt;&nbsp;</div></li><li><div>  &lt;input type=&quot;hidden&quot; name=&quot;bbp_reply_id&quot; id=&quot;bbp_reply_id&quot;    value=&quot;&lt;?php echo absint( $_GET['reply_id'] ); ?&gt;&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php wp_nonce_field( 'bbp-move-reply_' . bbp_get_reply_id() );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output a textarea or TinyMCE if enabled</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3586)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_the_content() To return the content to output</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_the_content( $args = array() ) {&nbsp;</div></li><li><div>  echo bbp_get_the_content( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return a textarea or TinyMCE if enabled</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r3586)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filter() To filter args and output</span>&nbsp;</div></li><li><div><span class="comment">   * @uses wp_parse_pargs() To compare args</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_use_wp_editor() To see if WP editor is in use</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_edit() To see if we are editing something</span>&nbsp;</div></li><li><div><span class="comment">   * @uses wp_editor() To output the WordPress editor</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @return string HTML from output buffer</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_the_content( $args = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// Parse arguments against default values</span></span></span>&nbsp;</div></li><li><div>      $r = bbp_parse_args( $args, array(&nbsp;</div></li><li><div>          'context' =&gt; 'topic', &nbsp;</div></li><li><div>          'before' =&gt; '&lt;div class=&quot;bbp-the-content-wrapper&quot;&gt;', &nbsp;</div></li><li><div>          'after' =&gt; '&lt;/div&gt;', &nbsp;</div></li><li><div>          'wpautop' =&gt; true, &nbsp;</div></li><li><div>          'media_buttons' =&gt; false, &nbsp;</div></li><li><div>          'textarea_rows' =&gt; '12', &nbsp;</div></li><li><div>          'tabindex' =&gt; bbp_get_tab_index(), &nbsp;</div></li><li><div>          'tabfocus_elements' =&gt; 'bbp_topic_title, bbp_topic_tags', &nbsp;</div></li><li><div>          'editor_class' =&gt; 'bbp-the-content', &nbsp;</div></li><li><div>          'tinymce' =&gt; false, &nbsp;</div></li><li><div>          'teeny' =&gt; true, &nbsp;</div></li><li><div>          'quicktags' =&gt; true, &nbsp;</div></li><li><div>          'dfw' =&gt; false&nbsp;</div></li><li><div> ), 'get_the_content' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If using tinymce, remove our escaping and trust tinymce</span>&nbsp;</div></li><li><div>      if ( bbp_use_wp_editor() && ( false !== $r['tinymce'] ) ) {&nbsp;</div></li><li><div>          remove_filter( 'bbp_get_form_forum_content', 'esc_textarea' );&nbsp;</div></li><li><div>          remove_filter( 'bbp_get_form_topic_content', 'esc_textarea' );&nbsp;</div></li><li><div>          remove_filter( 'bbp_get_form_reply_content', 'esc_textarea' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Assume we are not editing</span>&nbsp;</div></li><li><div>      $post_content = call_user_func( 'bbp_get_form_' . $r['context'] . '_content' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Start an output buffor</span>&nbsp;</div></li><li><div>      ob_start();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Output something before the editor</span>&nbsp;</div></li><li><div>      if ( !empty( $r['before'] ) ) {&nbsp;</div></li><li><div>          echo $r['before'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Use TinyMCE if available</span>&nbsp;</div></li><li><div>      if ( bbp_use_wp_editor() ) :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Enable additional TinyMCE plugins before outputting the editor</span>&nbsp;</div></li><li><div>          add_filter( 'tiny_mce_plugins', 'bbp_get_tiny_mce_plugins' );&nbsp;</div></li><li><div>          add_filter( 'teeny_mce_plugins', 'bbp_get_tiny_mce_plugins' );&nbsp;</div></li><li><div>          add_filter( 'teeny_mce_buttons', 'bbp_get_teeny_mce_buttons' );&nbsp;</div></li><li><div>          add_filter( 'quicktags_settings', 'bbp_get_quicktags_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Output the editor</span>&nbsp;</div></li><li><div>          wp_editor( $post_content, 'bbp_' . $r['context'] . '_content', array(&nbsp;</div></li><li><div>              'wpautop' =&gt; $r['wpautop'], &nbsp;</div></li><li><div>              'media_buttons' =&gt; $r['media_buttons'], &nbsp;</div></li><li><div>              'textarea_rows' =&gt; $r['textarea_rows'], &nbsp;</div></li><li><div>              'tabindex' =&gt; $r['tabindex'], &nbsp;</div></li><li><div>              'tabfocus_elements' =&gt; $r['tabfocus_elements'], &nbsp;</div></li><li><div>              'editor_class' =&gt; $r['editor_class'], &nbsp;</div></li><li><div>              'tinymce' =&gt; $r['tinymce'], &nbsp;</div></li><li><div>              'teeny' =&gt; $r['teeny'], &nbsp;</div></li><li><div>              'quicktags' =&gt; $r['quicktags'], &nbsp;</div></li><li><div>              'dfw' =&gt; $r['dfw'], &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Remove additional TinyMCE plugins after outputting the editor</span>&nbsp;</div></li><li><div>          remove_filter( 'tiny_mce_plugins', 'bbp_get_tiny_mce_plugins' );&nbsp;</div></li><li><div>          remove_filter( 'teeny_mce_plugins', 'bbp_get_tiny_mce_plugins' );&nbsp;</div></li><li><div>          remove_filter( 'teeny_mce_buttons', 'bbp_get_teeny_mce_buttons' );&nbsp;</div></li><li><div>          remove_filter( 'quicktags_settings', 'bbp_get_quicktags_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Fallback to normal textarea.</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * Note that we do not use esc_textarea() here to prevent double</span>&nbsp;</div></li><li><div><span class="comment">       * escaping the editable output, mucking up existing content.</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      else : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          &lt;textarea id=&quot;bbp_&lt;?php echo esc_attr( $r['context'] ); ?&gt;_content&quot; class=&quot;&lt;?php echo esc_attr( $r['editor_class'] ); ?&gt;&quot; name=&quot;bbp_&lt;?php echo esc_attr( $r['context'] ); ?&gt;_content&quot; cols=&quot;60&quot; rows=&quot;&lt;?php echo esc_attr( $r['textarea_rows'] ); ?&gt;&quot; tabindex=&quot;&lt;?php echo esc_attr( $r['tabindex'] ); ?&gt;&quot;&gt;&lt;?php echo $post_content; ?&gt;&lt;/textarea&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;?php endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Output something after the editor</span>&nbsp;</div></li><li><div>      if ( !empty( $r['after'] ) ) {&nbsp;</div></li><li><div>          echo $r['after'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Put the output into a usable variable</span>&nbsp;</div></li><li><div>      $output = ob_get_clean();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_the_content', $output, $args, $post_content );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Edit TinyMCE plugins to match core behaviour</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4574)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $plugins</span>&nbsp;</div></li><li><div><span class="comment"> * @see tiny_mce_plugins, teeny_mce_plugins</span>&nbsp;</div></li><li><div><span class="comment"> * @return array</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_get_tiny_mce_plugins( $plugins = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Unset fullscreen</span>&nbsp;</div></li><li><div>  foreach ( $plugins as $key =&gt; $value ) {&nbsp;</div></li><li><div>      if ( 'fullscreen' === $value ) {&nbsp;</div></li><li><div>          unset( $plugins[$key] );&nbsp;</div></li><li><div>          break;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Add the tabfocus plugin</span>&nbsp;</div></li><li><div>  $plugins[] = 'tabfocus';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return apply_filters( 'bbp_get_tiny_mce_plugins', $plugins );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Edit TeenyMCE buttons to match allowedtags</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4605)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $buttons</span>&nbsp;</div></li><li><div><span class="comment"> * @see teeny_mce_buttons</span>&nbsp;</div></li><li><div><span class="comment"> * @return array</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_get_teeny_mce_buttons( $buttons = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Remove some buttons from TeenyMCE</span>&nbsp;</div></li><li><div>  $buttons = array_diff( $buttons, array(&nbsp;</div></li><li><div>      'underline', &nbsp;</div></li><li><div>      'justifyleft', &nbsp;</div></li><li><div>      'justifycenter', &nbsp;</div></li><li><div>      'justifyright'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Images</span>&nbsp;</div></li><li><div>  array_push( $buttons, 'image' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return apply_filters( 'bbp_get_teeny_mce_buttons', $buttons );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Edit TinyMCE quicktags buttons to match allowedtags</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4606)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $buttons</span>&nbsp;</div></li><li><div><span class="comment"> * @see quicktags_settings</span>&nbsp;</div></li><li><div><span class="comment"> * @return array Quicktags settings</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_get_quicktags_settings( $settings = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Get buttons out of settings</span>&nbsp;</div></li><li><div>  $buttons_array = explode( ', ', $settings['buttons'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Diff the ones we don't want out</span>&nbsp;</div></li><li><div>  $buttons = array_diff( $buttons_array, array(&nbsp;</div></li><li><div>      'ins', &nbsp;</div></li><li><div>      'more', &nbsp;</div></li><li><div>      'spell'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Put them back into a string in the $settings array</span>&nbsp;</div></li><li><div>  $settings['buttons'] = implode( ', ', $buttons );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return apply_filters( 'bbp_get_quicktags_settings', $settings );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Views *********************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the view id</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2789)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $view Optional. View id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_view_id() To get the view id</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_view_id( $view = '' ) {&nbsp;</div></li><li><div>  echo bbp_get_view_id( $view );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the view id</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Use view id if supplied, otherwise bbp_get_view_rewrite_id() query var.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2789)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $view Optional. View id.</span>&nbsp;</div></li><li><div><span class="comment">   * @uses sanitize_title() To sanitize the view id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_query_var() To get the view id query variable</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_view_rewrite_id() To get the view rewrite ID</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool|string ID on success, false on failure</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_view_id( $view = '' ) {&nbsp;</div></li><li><div>      $bbp = bbpress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !empty( $view ) ) {&nbsp;</div></li><li><div>          $view = sanitize_title( $view );&nbsp;</div></li><li><div>      } elseif ( ! empty( $bbp-&gt;current_view_id ) ) {&nbsp;</div></li><li><div>          $view = $bbp-&gt;current_view_id;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $view = get_query_var( bbp_get_view_rewrite_id() );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( array_key_exists( $view, $bbp-&gt;views ) ) {&nbsp;</div></li><li><div>          return $view;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the view name aka title</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2789)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $view Optional. View id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_view_title() To get the view title</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_view_title( $view = '' ) {&nbsp;</div></li><li><div>  echo bbp_get_view_title( $view );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get the view name aka title</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * If a view id is supplied, that is used. Otherwise the bbp_view</span>&nbsp;</div></li><li><div><span class="comment">   * query var is checked for.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2789)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $view Optional. View id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_view_id() To get the view id</span>&nbsp;</div></li><li><div><span class="comment">   * @return bool|string Title on success, false on failure</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_view_title( $view = '' ) {&nbsp;</div></li><li><div>      $bbp = bbpress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $view = bbp_get_view_id( $view );&nbsp;</div></li><li><div>      if ( empty( $view ) )&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $bbp-&gt;views[$view]['title'];&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the view url</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2789)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $view Optional. View id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_view_url() To get the view url</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_view_url( $view = false ) {&nbsp;</div></li><li><div>  echo esc_url( bbp_get_view_url( $view ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the view url</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2789)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $view Optional. View id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses sanitize_title() To sanitize the view id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses home_url() To get blog home url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses add_query_arg() To add custom args to the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_view_url' with the view url, </span>&nbsp;</div></li><li><div><span class="comment">   *                        used view id</span>&nbsp;</div></li><li><div><span class="comment">   * @return string View url (or home url if the view was not found)</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_view_url( $view = false ) {&nbsp;</div></li><li><div>      global $wp_rewrite;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $view = bbp_get_view_id( $view );&nbsp;</div></li><li><div>      if ( empty( $view ) )&nbsp;</div></li><li><div>          return home_url();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Pretty permalinks</span>&nbsp;</div></li><li><div>      if ( $wp_rewrite-&gt;using_permalinks() ) {&nbsp;</div></li><li><div>          $url = $wp_rewrite-&gt;root . bbp_get_view_slug() . '/' . $view;&nbsp;</div></li><li><div>          $url = home_url( user_trailingslashit( $url ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Unpretty permalinks</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $url = add_query_arg( array( bbp_get_view_rewrite_id() =&gt; $view ), home_url( '/' ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_view_link', $url, $view );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Query *********************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Check the passed parameter against the current _bbp_query_name</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2980)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_query_name() Get the query var '_bbp_query_name'</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if match, false if not</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_query_name( $name = '' )  {&nbsp;</div></li><li><div>  return (bool) ( bbp_get_query_name() === $name );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Get the '_bbp_query_name' setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2695)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_query_var() To get the query var '_bbp_query_name'</span>&nbsp;</div></li><li><div><span class="comment"> * @return string To return the query var value</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_get_query_name()  {&nbsp;</div></li><li><div>  return get_query_var( '_bbp_query_name' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Set the '_bbp_query_name' setting to $name</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2692)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $name What to set the query var to</span>&nbsp;</div></li><li><div><span class="comment"> * @uses set_query_var() To set the query var '_bbp_query_name'</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_set_query_name( $name = '' )  {&nbsp;</div></li><li><div>  set_query_var( '_bbp_query_name', $name );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Used to clear the '_bbp_query_name' setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2692)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_set_query_name() To set the query var '_bbp_query_name' value to ''</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reset_query_name() {&nbsp;</div></li><li><div>  bbp_set_query_name();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Breadcrumbs ***************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the page title as a breadcrumb</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2589)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $sep Separator. Defaults to '&larr;'</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $current_page Include the current item</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $root Include the root page if one exists</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_breadcrumb() To get the breadcrumb</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_title_breadcrumb( $args = array() ) {&nbsp;</div></li><li><div>  echo bbp_get_breadcrumb( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output a breadcrumb</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2589)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $sep Separator. Defaults to '&larr;'</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $current_page Include the current item</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $root Include the root page if one exists</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_breadcrumb() To get the breadcrumb</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_breadcrumb( $args = array() ) {&nbsp;</div></li><li><div>  echo bbp_get_breadcrumb( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return a breadcrumb ( forum -&gt; topic -&gt; reply )</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2589)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $sep Separator. Defaults to '&larr;'</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $current_page Include the current item</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $root Include the root page if one exists</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post() To get the post</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_forum_permalink() To get the forum link</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_permalink() To get the topic link</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_permalink() To get the reply link</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_permalink() To get the permalink</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_forum_post_type() To get the forum post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_post_type() To get the topic post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_forum_title() To get the forum title</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_title() To get the topic title</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_title() To get the reply title</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_the_title() To get the title</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_breadcrumb' with the crumbs</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Breadcrumbs</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_breadcrumb( $args = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Turn off breadcrumbs</span>&nbsp;</div></li><li><div>      if ( apply_filters( 'bbp_no_breadcrumb', is_front_page() ) )&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Define variables</span>&nbsp;</div></li><li><div>      $front_id = $root_id = 0;&nbsp;</div></li><li><div>      $ancestors = $crumbs = $tag_data = array();&nbsp;</div></li><li><div>      $pre_root_text = $pre_front_text = $pre_current_text = '';&nbsp;</div></li><li><div>      $pre_include_root = $pre_include_home = $pre_include_current = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Home Text *********************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// No custom home text</span>&nbsp;</div></li><li><div>      if ( empty( $args['home_text'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $front_id = get_option( 'page_on_front' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Set home text to page title</span>&nbsp;</div></li><li><div>          if ( !empty( $front_id ) ) {&nbsp;</div></li><li><div>              $pre_front_text = get_the_title( $front_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Default to 'Home'</span>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $pre_front_text = __( 'Home', 'bbpress' );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Root Text *********************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// No custom root text</span>&nbsp;</div></li><li><div>      if ( empty( $args['root_text'] ) ) {&nbsp;</div></li><li><div>          $page = bbp_get_page_by_path( bbp_get_root_slug() );&nbsp;</div></li><li><div>          if ( !empty( $page ) ) {&nbsp;</div></li><li><div>              $root_id = $page-&gt;ID;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $pre_root_text = bbp_get_forum_archive_title();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Includes **********************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Root slug is also the front page</span>&nbsp;</div></li><li><div>      if ( !empty( $front_id ) && ( $front_id === $root_id ) ) {&nbsp;</div></li><li><div>          $pre_include_root = false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Don't show root if viewing forum archive</span>&nbsp;</div></li><li><div>      if ( bbp_is_forum_archive() ) {&nbsp;</div></li><li><div>          $pre_include_root = false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Don't show root if viewing page in place of forum archive</span>&nbsp;</div></li><li><div>      if ( !empty( $root_id ) && ( ( is_single() || is_page() ) && ( $root_id === get_the_ID() ) ) ) {&nbsp;</div></li><li><div>          $pre_include_root = false;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Current Text ******************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// Search</span></span> page</span>&nbsp;</div></li><li><div>      if ( bbp_is_search() ) {&nbsp;</div></li><li><div>          $pre_current_text = bbp_get_search_title();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Forum</span> archive</span>&nbsp;</div></li><li><div>      } elseif ( bbp_is_forum_archive() ) {&nbsp;</div></li><li><div>          $pre_current_text = bbp_get_forum_archive_title();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Topic</span> archive</span>&nbsp;</div></li><li><div>      } elseif ( bbp_is_topic_archive() ) {&nbsp;</div></li><li><div>          $pre_current_text = bbp_get_topic_archive_title();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// View</span>&nbsp;</div></li><li><div>      } elseif ( bbp_is_single_view() ) {&nbsp;</div></li><li><div>          $pre_current_text = bbp_get_view_title();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Single</span> Forum</span>&nbsp;</div></li><li><div>      } elseif ( bbp_is_single_forum() ) {&nbsp;</div></li><li><div>          $pre_current_text = bbp_get_forum_title();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// Single</span> Topic</span></span>&nbsp;</div></li><li><div>      } elseif ( bbp_is_single_topic() ) {&nbsp;</div></li><li><div>          $pre_current_text = bbp_get_topic_title();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// Single</span> Topic</span></span>&nbsp;</div></li><li><div>      } elseif ( bbp_is_single_reply() ) {&nbsp;</div></li><li><div>          $pre_current_text = bbp_get_reply_title();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Topic</span> Tag (or theme compat topic tag)</span>&nbsp;</div></li><li><div>      } elseif ( bbp_is_topic_tag() || ( get_query_var( 'bbp_topic_tag' ) && !bbp_is_topic_tag_edit() ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Always include the tag name</span>&nbsp;</div></li><li><div>          $tag_data[] = bbp_get_topic_tag_name();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// If capable, include a link to edit the tag</span>&nbsp;</div></li><li><div>          if ( current_user_can( 'manage_topic_tags' ) ) {&nbsp;</div></li><li><div>              $tag_data[] = '&lt;a href=&quot;' . esc_url( bbp_get_topic_tag_edit_link() ) . '&quot; class=&quot;bbp-edit-topic-tag-link&quot;&gt;' . esc_html__( '(Edit)', 'bbpress' ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Implode the results of the tag data</span>&nbsp;</div></li><li><div>          $pre_current_text = sprintf( __( 'Topic Tag: %s', 'bbpress' ), implode( ' ', $tag_data ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Edit Topic Tag</span>&nbsp;</div></li><li><div>      } elseif ( bbp_is_topic_tag_edit() ) {&nbsp;</div></li><li><div>          $pre_current_text = __( 'Edit', 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Single</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $pre_current_text = get_the_title();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Parse Args ********************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Parse args</span>&nbsp;</div></li><li><div>      $r = bbp_parse_args( $args, array(&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// HTML</span>&nbsp;</div></li><li><div>          'before' =&gt; '&lt;div class=&quot;bbp-breadcrumb&quot;&gt;&lt;p&gt;', &nbsp;</div></li><li><div>          'after' =&gt; '&lt;/p&gt;&lt;/div&gt;', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Separator</span>&nbsp;</div></li><li><div>          'sep' =&gt; is_rtl() ? __( '&lsaquo;', 'bbpress' ) : __( '&rsaquo;', 'bbpress' ), &nbsp;</div></li><li><div>          'pad_sep' =&gt; 1, &nbsp;</div></li><li><div>          'sep_before' =&gt; '&lt;span class=&quot;bbp-breadcrumb-sep&quot;&gt;', &nbsp;</div></li><li><div>          'sep_after' =&gt; '&lt;/span&gt;', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Crumbs</span>&nbsp;</div></li><li><div>          'crumb_before' =&gt; '', &nbsp;</div></li><li><div>          'crumb_after' =&gt; '', &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Home</span>&nbsp;</div></li><li><div>          'include_home' =&gt; $pre_include_home, &nbsp;</div></li><li><div>          'home_text' =&gt; $pre_front_text, &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">// Forum</span> root</span>&nbsp;</div></li><li><div>          'include_root' =&gt; $pre_include_root, &nbsp;</div></li><li><div>          'root_text' =&gt; $pre_root_text, &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Current</span>&nbsp;</div></li><li><div>          'include_current' =&gt; $pre_include_current, &nbsp;</div></li><li><div>          'current_text' =&gt; $pre_current_text, &nbsp;</div></li><li><div>          'current_before' =&gt; '&lt;span class=&quot;bbp-breadcrumb-current&quot;&gt;', &nbsp;</div></li><li><div>          'current_after' =&gt; '&lt;/span&gt;', &nbsp;</div></li><li><div> ), 'get_breadcrumb' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Ancestors *********************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get post ancestors</span>&nbsp;</div></li><li><div>      if ( is_singular() || bbp_is_forum_edit() || bbp_is_topic_edit() || bbp_is_reply_edit() ) {&nbsp;</div></li><li><div>          $ancestors = array_reverse( (array) get_post_ancestors( get_the_ID() ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Do we want to include a link to home?</span>&nbsp;</div></li><li><div>      if ( !empty( $r['include_home'] ) || empty( $r['home_text'] ) ) {&nbsp;</div></li><li><div>          $crumbs[] = '&lt;a href=&quot;' . trailingslashit( home_url() ) . '&quot; class=&quot;bbp-breadcrumb-home&quot;&gt;' . $r['home_text'] . '&lt;/a&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Do we want to include a link to the forum root?</span>&nbsp;</div></li><li><div>      if ( !empty( $r['include_root'] ) || empty( $r['root_text'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Page exists at root slug path, so use its permalink</span>&nbsp;</div></li><li><div>          $page = bbp_get_page_by_path( bbp_get_root_slug() );&nbsp;</div></li><li><div>          if ( !empty( $page ) ) {&nbsp;</div></li><li><div>              $root_url = get_permalink( $page-&gt;ID );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Use the root slug</span>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $root_url = get_post_type_archive_link( bbp_get_forum_post_type() );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Add the breadcrumb</span>&nbsp;</div></li><li><div>          $crumbs[] = '&lt;a href=&quot;' . esc_url( $root_url ) . '&quot; class=&quot;bbp-breadcrumb-root&quot;&gt;' . $r['root_text'] . '&lt;/a&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Ancestors exist</span>&nbsp;</div></li><li><div>      if ( !empty( $ancestors ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Loop through parents</span>&nbsp;</div></li><li><div>          foreach ( (array) $ancestors as $parent_id ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Parents</span>&nbsp;</div></li><li><div>              $parent = get_post( $parent_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Skip parent if empty or error</span>&nbsp;</div></li><li><div>              if ( empty( $parent ) || is_wp_error( $parent ) )&nbsp;</div></li><li><div>                  continue;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Switch through post_type to ensure correct filters are applied</span>&nbsp;</div></li><li><div>              switch ( $parent-&gt;post_type ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Forum</span>&nbsp;</div></li><li><div>                  case bbp_get_forum_post_type() :&nbsp;</div></li><li><div>                      $crumbs[] = '&lt;a href=&quot;' . esc_url( bbp_get_forum_permalink( $parent-&gt;ID ) ) . '&quot; class=&quot;bbp-breadcrumb-forum&quot;&gt;' . bbp_get_forum_title( $parent-&gt;ID ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Topic</span>&nbsp;</div></li><li><div>                  case bbp_get_topic_post_type() :&nbsp;</div></li><li><div>                      $crumbs[] = '&lt;a href=&quot;' . esc_url( bbp_get_topic_permalink( $parent-&gt;ID ) ) . '&quot; class=&quot;bbp-breadcrumb-topic&quot;&gt;' . bbp_get_topic_title( $parent-&gt;ID ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// Reply (Note: not in most themes)</span>&nbsp;</div></li><li><div>                  case bbp_get_reply_post_type() :&nbsp;</div></li><li><div>                      $crumbs[] = '&lt;a href=&quot;' . esc_url( bbp_get_reply_permalink( $parent-&gt;ID ) ) . '&quot; class=&quot;bbp-breadcrumb-reply&quot;&gt;' . bbp_get_reply_title( $parent-&gt;ID ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  <span class="comment">// WordPress Post/Page/Other</span>&nbsp;</div></li><li><div>                  default :&nbsp;</div></li><li><div>                      $crumbs[] = '&lt;a href=&quot;' . esc_url( get_permalink( $parent-&gt;ID ) ) . '&quot; class=&quot;bbp-breadcrumb-item&quot;&gt;' . get_the_title( $parent-&gt;ID ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Edit topic tag</span>&nbsp;</div></li><li><div>      } elseif ( bbp_is_topic_tag_edit() ) {&nbsp;</div></li><li><div>          $crumbs[] = '&lt;a href=&quot;' . esc_url( get_term_link( bbp_get_topic_tag_id(), bbp_get_topic_tag_tax_id() ) ) . '&quot; class=&quot;bbp-breadcrumb-topic-tag&quot;&gt;' . sprintf( __( 'Topic Tag: %s', 'bbpress' ), bbp_get_topic_tag_name() ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Search</span></span>&nbsp;</div></li><li><div>      } elseif ( bbp_is_search() && bbp_get_search_terms() ) {&nbsp;</div></li><li><div>          $crumbs[] = '&lt;a href=&quot;' . esc_url( bbp_get_search_url() ) . '&quot; class=&quot;bbp-breadcrumb-search&quot;&gt;' . esc_html__( 'Search', 'bbpress' ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Current ***********************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add current page to breadcrumb</span>&nbsp;</div></li><li><div>      if ( !empty( $r['include_current'] ) || empty( $r['current_text'] ) ) {&nbsp;</div></li><li><div>          $crumbs[] = $r['current_before'] . $r['current_text'] . $r['current_after'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Separator *********************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Wrap the separator in before/after before padding and filter</span>&nbsp;</div></li><li><div>      if ( ! empty( $r['sep'] ) ) {&nbsp;</div></li><li><div>          $sep = $r['sep_before'] . $r['sep'] . $r['sep_after'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Pad the separator</span>&nbsp;</div></li><li><div>      if ( !empty( $r['pad_sep'] ) ) {&nbsp;</div></li><li><div>          if ( function_exists( 'mb_strlen' ) ) {&nbsp;</div></li><li><div>              $sep = str_pad( $sep, mb_strlen( $sep ) + ( (int) $r['pad_sep'] * 2 ), ' ', STR_PAD_BOTH );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $sep = str_pad( $sep, strlen( $sep ) + ( (int) $r['pad_sep'] * 2 ), ' ', STR_PAD_BOTH );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">/** Finish Up *********************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Filter the separator and breadcrumb</span>&nbsp;</div></li><li><div>      $sep = apply_filters( 'bbp_breadcrumb_separator', $sep );&nbsp;</div></li><li><div>      $crumbs = apply_filters( 'bbp_breadcrumbs', $crumbs );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Build the trail</span>&nbsp;</div></li><li><div>      $trail = !empty( $crumbs ) ? ( $r['before'] . $r['crumb_before'] . implode( $sep . $r['crumb_after'] . $r['crumb_before'] , $crumbs ) . $r['crumb_after'] . $r['after'] ) : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_breadcrumb', $trail, $crumbs, $r );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Topic Tags ***************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output all of the allowed tags in HTML format with attributes.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * This is useful for displaying in the post area, which elements and</span>&nbsp;</div></li><li><div><span class="comment"> * attributes are supported. As well as any plugins which want to display it.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2780)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_allowed_tags()</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_allowed_tags() {&nbsp;</div></li><li><div>  echo bbp_get_allowed_tags();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Display all of the allowed tags in HTML format with attributes.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * This is useful for displaying in the post area, which elements and</span>&nbsp;</div></li><li><div><span class="comment">   * attributes are supported. As well as any plugins which want to display it.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2780)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_kses_allowed_tags() To get the allowed tags</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_allowed_tags' with the tags</span>&nbsp;</div></li><li><div><span class="comment">   * @return string HTML allowed tags entity encoded.</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_allowed_tags() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $allowed = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( (array) bbp_kses_allowed_tags() as $tag =&gt; $attributes ) {&nbsp;</div></li><li><div>          $allowed .= '&lt;' . $tag;&nbsp;</div></li><li><div>          if ( 0 &lt; count( $attributes ) ) {&nbsp;</div></li><li><div>              foreach ( array_keys( $attributes ) as $attribute ) {&nbsp;</div></li><li><div>                  $allowed .= ' ' . $attribute . '=&quot;&quot;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $allowed .= '&gt; ';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_allowed_tags', htmlentities( $allowed ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Errors & Messages *********************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Display possible errors & messages inside a template file</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2688)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Error bbPress::errors::get_error_codes() To get the error codes</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Error bbPress::errors::get_error_data() To get the error data</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Error bbPress::errors::get_error_messages() To get the error</span>&nbsp;</div></li><li><div><span class="comment"> *                                                       messages</span>&nbsp;</div></li><li><div><span class="comment"> * @uses is_wp_error() To check if it's a {@link WP_Error}</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_template_notices() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Bail if no notices or errors</span>&nbsp;</div></li><li><div>  if ( !bbp_has_errors() )&nbsp;</div></li><li><div>      return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Define local variable(s)</span>&nbsp;</div></li><li><div>  $errors = $messages = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Get bbPress</span>&nbsp;</div></li><li><div>  $bbp = bbpress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Loop through notices</span>&nbsp;</div></li><li><div>  foreach ( $bbp-&gt;errors-&gt;get_error_codes() as $code ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get notice severity</span>&nbsp;</div></li><li><div>      $severity = $bbp-&gt;errors-&gt;get_error_data( $code );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Loop through notices</span> and separate errors from messages&nbsp;</div></li><li><div>      foreach ( $bbp-&gt;errors-&gt;get_error_messages( $code ) as $error ) {&nbsp;</div></li><li><div>          if ( 'message' === $severity ) {&nbsp;</div></li><li><div>              $messages[] = $error;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $errors[] = $error;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Display errors first...</span>&nbsp;</div></li><li><div>  if ( !empty( $errors ) ) : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;div class=&quot;bbp-template-notice error&quot;&gt;&nbsp;</div></li><li><div>          &lt;p&gt;&nbsp;</div></li><li><div>              &lt;?php echo implode( &quot;&lt;/p&gt;\n&lt;p&gt;&quot;, $errors ); ?&gt;&nbsp;</div></li><li><div>          &lt;/p&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php endif;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// ...and messages last</span>&nbsp;</div></li><li><div>  if ( !empty( $messages ) ) : ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      &lt;div class=&quot;bbp-template-notice&quot;&gt;&nbsp;</div></li><li><div>          &lt;p&gt;&nbsp;</div></li><li><div>              &lt;?php echo implode( &quot;&lt;/p&gt;\n&lt;p&gt;&quot;, $messages ); ?&gt;&nbsp;</div></li><li><div>          &lt;/p&gt;&nbsp;</div></li><li><div>      &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  &lt;?php endif;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Login/logout/register/lost pass *******************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the logout link</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2827)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $redirect_to Redirect to url</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_logout_link() To get the logout link</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_logout_link( $redirect_to = '' ) {&nbsp;</div></li><li><div>  echo bbp_get_logout_link( $redirect_to );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the logout link</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2827)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $redirect_to Redirect to url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses wp_logout_url() To get the logout url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_logout_link' with the logout link and</span>&nbsp;</div></li><li><div><span class="comment">   *                        redirect to url</span>&nbsp;</div></li><li><div><span class="comment">   * @return string The logout link</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_logout_link( $redirect_to = '' ) {&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_logout_link', '&lt;a href=&quot;' . wp_logout_url( $redirect_to ) . '&quot; class=&quot;button logout-link&quot;&gt;' . esc_html__( 'Log Out', 'bbpress' ) . '&lt;/a&gt;', $redirect_to );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Title *********************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Custom page title for bbPress pages</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2788)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $title Optional. The title (not used).</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $sep Optional, default is '&raquo;'. How to separate the</span>&nbsp;</div></li><li><div><span class="comment"> *                     various items within the page title.</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $seplocation Optional. Direction to display title, 'right'.</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_user() To check if it's a user profile page</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_user_edit() To check if it's a user profile edit page</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_user_home() To check if the profile page is of the current user</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_query_var() To get the user id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_userdata() To get the user data</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_forum() To check if it's a forum</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_forum_title() To get the forum title</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_topic() To check if it's a topic</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_topic_title() To get the topic title</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_reply() To check if it's a reply</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_title() To get the reply title</span>&nbsp;</div></li><li><div><span class="comment"> * @uses is_tax() To check if it's the tag page</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_queried_object() To get the queried object</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_is_single_view() To check if it's a view</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_view_title() To get the view title</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters() Calls 'bbp_raw_title' with the title</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters() Calls 'bbp_profile_page_wp_title' with the title, </span>&nbsp;</div></li><li><div><span class="comment"> *                        separator and separator location</span>&nbsp;</div></li><li><div><span class="comment"> * @return string The tite</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_title( $title = '', $sep = '&raquo;', $seplocation = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Title array</span>&nbsp;</div></li><li><div>  $new_title = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment">/** Archives **************************************************************/</span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Forum</span> Archive&nbsp;</div></li><li><div>  if ( bbp_is_forum_archive() ) {&nbsp;</div></li><li><div>      $new_title['text'] = bbp_get_forum_archive_title();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Topic</span> Archive&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_archive() ) {&nbsp;</div></li><li><div>      $new_title['text'] = bbp_get_topic_archive_title();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/** Edit ******************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Forum</span> edit page&nbsp;</div></li><li><div>  } elseif ( bbp_is_forum_edit() ) {&nbsp;</div></li><li><div>      $new_title['text'] = bbp_get_forum_title();&nbsp;</div></li><li><div>      $new_title['format'] = esc_attr__( 'Forum Edit: %s', 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Topic</span> edit page&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_edit() ) {&nbsp;</div></li><li><div>      $new_title['text'] = bbp_get_topic_title();&nbsp;</div></li><li><div>      $new_title['format'] = esc_attr__( 'Topic Edit: %s', 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Reply edit page</span>&nbsp;</div></li><li><div>  } elseif ( bbp_is_reply_edit() ) {&nbsp;</div></li><li><div>      $new_title['text'] = bbp_get_reply_title();&nbsp;</div></li><li><div>      $new_title['format'] = esc_attr__( 'Reply Edit: %s', 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Topic</span> tag edit page&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_tag_edit() ) {&nbsp;</div></li><li><div>      $new_title['text'] = bbp_get_topic_tag_name();&nbsp;</div></li><li><div>      $new_title['format'] = esc_attr__( 'Topic Tag Edit: %s', 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/** Singles ***************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Forum</span> page&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_forum() ) {&nbsp;</div></li><li><div>      $new_title['text'] = bbp_get_forum_title();&nbsp;</div></li><li><div>      $new_title['format'] = esc_attr__( 'Forum: %s', 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Topic</span> page&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_topic() ) {&nbsp;</div></li><li><div>      $new_title['text'] = bbp_get_topic_title();&nbsp;</div></li><li><div>      $new_title['format'] = esc_attr__( 'Topic: %s', 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Replies</span>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_reply() ) {&nbsp;</div></li><li><div>      $new_title['text'] = bbp_get_reply_title();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Topic</span> tag page&nbsp;</div></li><li><div>  } elseif ( bbp_is_topic_tag() || get_query_var( 'bbp_topic_tag' ) ) {&nbsp;</div></li><li><div>      $new_title['text'] = bbp_get_topic_tag_name();&nbsp;</div></li><li><div>      $new_title['format'] = esc_attr__( 'Topic Tag: %s', 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/** Users *****************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Profile page</span>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_user() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// User is viewing their own profile</span>&nbsp;</div></li><li><div>      if ( bbp_is_user_home() ) {&nbsp;</div></li><li><div>          $new_title['text'] = esc_attr_x( 'Your', 'User viewing his/her own profile', 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// User is viewing someone else's profile (so use their display name)</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $new_title['text'] = sprintf( esc_attr_x( &quot;%s's&quot;, 'User viewing another users profile', 'bbpress' ), get_userdata( bbp_get_user_id() )-&gt;display_name );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// User topics created</span>&nbsp;</div></li><li><div>      if ( bbp_is_single_user_topics() ) {&nbsp;</div></li><li><div>          $new_title['format'] = esc_attr__( &quot;%s Topics&quot;, 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// User rueplies created</span>&nbsp;</div></li><li><div>      } elseif ( bbp_is_single_user_replies() ) {&nbsp;</div></li><li><div>          $new_title['format'] = esc_attr__( &quot;%s Replies&quot;, 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// User favorites</span>&nbsp;</div></li><li><div>      } elseif ( bbp_is_favorites() ) {&nbsp;</div></li><li><div>          $new_title['format'] = esc_attr__( &quot;%s Favorites&quot;, 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// User subscriptions</span>&nbsp;</div></li><li><div>      } elseif ( bbp_is_subscriptions() ) {&nbsp;</div></li><li><div>          $new_title['format'] = esc_attr__( &quot;%s Subscriptions&quot;, 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// User &quot;home&quot;</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $new_title['format'] = esc_attr__( &quot;%s Profile&quot;, 'bbpress' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Profile edit page</span>&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_user_edit() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Current</span> user&nbsp;</div></li><li><div>      if ( bbp_is_user_home_edit() ) {&nbsp;</div></li><li><div>          $new_title['text'] = esc_attr__( 'Edit Your Profile', 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Other user</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $new_title['text'] = get_userdata( bbp_get_user_id() )-&gt;display_name;&nbsp;</div></li><li><div>          $new_title['format'] = esc_attr__( &quot;Edit %s's Profile&quot;, 'bbpress' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/** Views *****************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// View</span>s&nbsp;</div></li><li><div>  } elseif ( bbp_is_single_view() ) {&nbsp;</div></li><li><div>      $new_title['text'] = bbp_get_view_title();&nbsp;</div></li><li><div>      $new_title['format'] = esc_attr__( 'View: %s', 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment">/** Search ****************************************************************/</span></span></span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Search</span></span>&nbsp;</div></li><li><div>  } elseif ( bbp_is_search() ) {&nbsp;</div></li><li><div>      $new_title['text'] = bbp_get_search_title();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// This filter is deprecated. Use 'bbp_before_title_parse_args' instead.</span>&nbsp;</div></li><li><div>  $new_title = apply_filters( 'bbp_raw_title_array', $new_title );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Set title array defaults</span>&nbsp;</div></li><li><div>  $new_title = bbp_parse_args( $new_title, array(&nbsp;</div></li><li><div>      'text' =&gt; $title, &nbsp;</div></li><li><div>      'format' =&gt; '%s'&nbsp;</div></li><li><div> ), 'title' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Get the formatted raw title</span>&nbsp;</div></li><li><div>  $new_title = sprintf( $new_title['format'], $new_title['text'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Filter the raw title</span>&nbsp;</div></li><li><div>  $new_title = apply_filters( 'bbp_raw_title', $new_title, $sep, $seplocation );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Compare new title with original title</span>&nbsp;</div></li><li><div>  if ( $new_title === $title )&nbsp;</div></li><li><div>      return $title;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Temporary separator, for accurate flipping, if necessary</span>&nbsp;</div></li><li><div>  $t_sep = '%WP_TITILE_SEP%';&nbsp;</div></li><li><div>  $prefix = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !empty( $new_title ) )&nbsp;</div></li><li><div>      $prefix = &quot; $sep &quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// sep on right, so reverse the order</span>&nbsp;</div></li><li><div>  if ( 'right' === $seplocation ) {&nbsp;</div></li><li><div>      $new_title_array = array_reverse( explode( $t_sep, $new_title ) );&nbsp;</div></li><li><div>      $new_title = implode( &quot; $sep &quot;, $new_title_array ) . $prefix;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// sep on left, do not reverse</span>&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $new_title_array = explode( $t_sep, $new_title );&nbsp;</div></li><li><div>      $new_title = $prefix . implode( &quot; $sep &quot;, $new_title_array );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Filter and return</span>&nbsp;</div></li><li><div>  return apply_filters( 'bbp_title', $new_title, $sep, $seplocation );&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>bbPress</li><li><span></span>2.5.9</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2021 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>