<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="2.5.8" data-slug="bbpress" data-type="file" data-id="62471"><head xmlns="http://www.w3.org/1999/xhtml"><title> includes-replies-template | file | Bbpress | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, bbpress, 2.5.8" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.17"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=7f9e014a2c91443bace4f31a724f3f15' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.17' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/includes-replies-template/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fincludes-replies-template%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fincludes-replies-template%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-bbpress-2.5.8-file-includes-replies-template","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="includes-replies-template" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to bbpress." href="http://hookr.io/plugins/bbpress/" class="plugin"><span property="name">bbpress</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.5.8." href="http://hookr.io/plugins/bbpress/2.5.8/" class="H_VERSION"><span property="name">2.5.8</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/bbpress/2.5.8/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">includes-replies-template</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="2367"><a href="http://hookr.io/plugins/bbpress/2.5.8/all/" title="All">All <span class="count badge">2367</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/bbpress/2.5.8/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="1131"><a href="http://hookr.io/plugins/bbpress/2.5.8/hooks/" title="Hooks">Hooks <span class="count badge">1131</span></a></li><li class="" data-id="action" data-count="471"><a href="http://hookr.io/plugins/bbpress/2.5.8/actions/" title="Actions">Actions <span class="count badge">471</span></a></li><li class="" data-id="filter" data-count="660"><a href="http://hookr.io/plugins/bbpress/2.5.8/filters/" title="Filters">Filters <span class="count badge">660</span></a></li><li class="" data-id="class" data-count="54"><a href="http://hookr.io/plugins/bbpress/2.5.8/classes/" title="Classes">Classes <span class="count badge">54</span></a></li><li class="" data-id="constant" data-count="28"><a href="http://hookr.io/plugins/bbpress/2.5.8/constants/" title="Constants">Constants <span class="count badge">28</span></a></li><li class="" data-id="function" data-count="1153"><a href="http://hookr.io/plugins/bbpress/2.5.8/functions/" title="Functions">Functions <span class="count badge">1153</span></a></li><li class="" data-id="shortcode" data-count="1"><a href="http://hookr.io/plugins/bbpress/2.5.8/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">1</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/includes/replies/template.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * bbPress Reply Template Tags</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package bbPress</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage TemplateTags</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Exit if accessed directly</span>&nbsp;</div></li><li><div>if ( !defined( 'ABSPATH' ) ) exit;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Post Type *****************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return the unique id of the custom post type for replies</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2857)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_post_type() {&nbsp;</div></li><li><div>  echo bbp_get_reply_post_type();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the unique id of the custom post type for replies</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2857)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_forum_post_type' with the forum</span>&nbsp;</div></li><li><div><span class="comment">   *                        post type id</span>&nbsp;</div></li><li><div><span class="comment">   * @return string The unique reply post type id</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_post_type() {&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_post_type', bbpress()-&gt;reply_post_type );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return array of labels used by the reply post type</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r5129)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return array</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_get_reply_post_type_labels() {&nbsp;</div></li><li><div>  return apply_filters( 'bbp_get_reply_post_type_labels', array(&nbsp;</div></li><li><div>      'name' =&gt; __( 'Replies', 'bbpress' ), &nbsp;</div></li><li><div>      'menu_name' =&gt; __( 'Replies', 'bbpress' ), &nbsp;</div></li><li><div>      'singular_name' =&gt; __( 'Reply', 'bbpress' ), &nbsp;</div></li><li><div>      'all_items' =&gt; __( 'All Replies', 'bbpress' ), &nbsp;</div></li><li><div>      'add_new' =&gt; __( 'New Reply', 'bbpress' ), &nbsp;</div></li><li><div>      'add_new_item' =&gt; __( 'Create New Reply', 'bbpress' ), &nbsp;</div></li><li><div>      'edit' =&gt; __( 'Edit', 'bbpress' ), &nbsp;</div></li><li><div>      'edit_item' =&gt; __( 'Edit Reply', 'bbpress' ), &nbsp;</div></li><li><div>      'new_item' =&gt; __( 'New Reply', 'bbpress' ), &nbsp;</div></li><li><div>      'view' =&gt; __( 'View Reply', 'bbpress' ), &nbsp;</div></li><li><div>      'view_item' =&gt; __( 'View Reply', 'bbpress' ), &nbsp;</div></li><li><div>      'search_items' =&gt; __( 'Search Replies', 'bbpress' ), &nbsp;</div></li><li><div>      'not_found' =&gt; __( 'No replies found', 'bbpress' ), &nbsp;</div></li><li><div>      'not_found_in_trash' =&gt; __( 'No replies found in Trash', 'bbpress' ), &nbsp;</div></li><li><div>      'parent_item_colon' =&gt; __( 'Topic:', 'bbpress' )&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return array of reply post type rewrite settings</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r5129)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return array</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_get_reply_post_type_rewrite() {&nbsp;</div></li><li><div>  return apply_filters( 'bbp_get_reply_post_type_rewrite', array(&nbsp;</div></li><li><div>      'slug' =&gt; bbp_get_reply_slug(), &nbsp;</div></li><li><div>      'with_front' =&gt; false&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return array of features the reply post type supports</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (rx5129)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return array</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_get_reply_post_type_supports() {&nbsp;</div></li><li><div>  return apply_filters( 'bbp_get_reply_post_type_supports', array(&nbsp;</div></li><li><div>      'title', &nbsp;</div></li><li><div>      'editor', &nbsp;</div></li><li><div>      'revisions'&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Reply Loop Functions ******************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * The main reply loop. WordPress makes this easy for us</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2553)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $args All the arguments supported by {@link WP_Query}</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_show_lead_topic() Are we showing the topic as a lead?</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_topic_id() To get the topic id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_topic_post_type() To get the topic post type</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_option() To get the replies per page option</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_paged() To get the current page value</span>&nbsp;</div></li><li><div><span class="comment"> * @uses current_user_can() To check if the current user is capable of editing</span>&nbsp;</div></li><li><div><span class="comment"> *                           others' replies</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Query To make query and get the replies</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Rewrite::using_permalinks() To check if the blog is using permalinks</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_permalink() To get the permalink</span>&nbsp;</div></li><li><div><span class="comment"> * @uses add_query_arg() To add custom args to the url</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters() Calls 'bbp_replies_pagination' with the pagination args</span>&nbsp;</div></li><li><div><span class="comment"> * @uses paginate_links() To paginate the links</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters() Calls 'bbp_has_replies' with</span>&nbsp;</div></li><li><div><span class="comment"> *                        bbPres::reply_query::have_posts()</span>&nbsp;</div></li><li><div><span class="comment"> *                        and bbPres::reply_query</span>&nbsp;</div></li><li><div><span class="comment"> * @return object Multidimensional array of reply information</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_has_replies( $args = '' ) {&nbsp;</div></li><li><div>  global $wp_rewrite;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/** Defaults **************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Other defaults</span>&nbsp;</div></li><li><div>  $default_reply_search = !empty( $_REQUEST['rs'] ) ? $_REQUEST['rs']    : false;&nbsp;</div></li><li><div>  $default_post_parent = ( bbp_is_single_topic() ) ? bbp_get_topic_id() : 'any';&nbsp;</div></li><li><div>  $default_post_type = ( bbp_is_single_topic() && bbp_show_lead_topic() ) ? bbp_get_reply_post_type() : array( bbp_get_topic_post_type(), bbp_get_reply_post_type() );&nbsp;</div></li><li><div>  $default_thread_replies = (bool) ( bbp_is_single_topic() && bbp_thread_replies() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Default query args</span>&nbsp;</div></li><li><div>  $default = array(&nbsp;</div></li><li><div>      'post_type' =&gt; $default_post_type, <span class="comment">// Only replies</span>&nbsp;</div></li><li><div>      'post_parent' =&gt; $default_post_parent, <span class="comment">// Of this topic</span>&nbsp;</div></li><li><div>      'posts_per_page' =&gt; bbp_get_replies_per_page(), <span class="comment">// This many</span>&nbsp;</div></li><li><div>      'paged' =&gt; bbp_get_paged(), <span class="comment">// On this page</span>&nbsp;</div></li><li><div>      'orderby' =&gt; 'date', <span class="comment">// Sorted by date</span>&nbsp;</div></li><li><div>      'order' =&gt; 'ASC', <span class="comment">// Oldest to newest</span>&nbsp;</div></li><li><div>      'hierarchical' =&gt; $default_thread_replies, <span class="comment">// Hierarchical replies</span>&nbsp;</div></li><li><div>      'ignore_sticky_posts' =&gt; true, <span class="comment">// Stickies not supported</span>&nbsp;</div></li><li><div>      's' =&gt; $default_reply_search, <span class="comment">// Maybe search</span>&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// What are the default allowed statuses (based on user caps)</span>&nbsp;</div></li><li><div>  if ( bbp_get_view_all() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Default view=all statuses</span>&nbsp;</div></li><li><div>      $post_statuses = array(&nbsp;</div></li><li><div>          bbp_get_public_status_id(), &nbsp;</div></li><li><div>          bbp_get_closed_status_id(), &nbsp;</div></li><li><div>          bbp_get_spam_status_id(), &nbsp;</div></li><li><div>          bbp_get_trash_status_id()&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add support for private status</span>&nbsp;</div></li><li><div>      if ( current_user_can( 'read_private_replies' ) ) {&nbsp;</div></li><li><div>          $post_statuses[] = bbp_get_private_status_id();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Join post statuses together</span>&nbsp;</div></li><li><div>      $default['post_status'] = implode( ', ', $post_statuses );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Lean on the 'perm' query var value of 'readable' to provide statuses</span>&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $default['perm'] = 'readable';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/** Setup *****************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Parse arguments against default values</span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>  $r = bbp_parse_args( $args, $default, 'has_replies' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Set posts_per_page value if replies are threaded</span>&nbsp;</div></li><li><div>  $replies_per_page = $r['posts_per_page'];&nbsp;</div></li><li><div>  if ( true === $r['hierarchical'] ) {&nbsp;</div></li><li><div>      $r['posts_per_page'] = -1;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Get bbPress</span>&nbsp;</div></li><li><div>  $bbp = bbpress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Call the query</span>&nbsp;</div></li><li><div>  $bbp-&gt;reply_query = new WP_Query( $r );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Add pagination values to query object</span>&nbsp;</div></li><li><div>  $bbp-&gt;reply_query-&gt;posts_per_page = $replies_per_page;&nbsp;</div></li><li><div>  $bbp-&gt;reply_query-&gt;paged = $r['paged'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Never home, regardless of what parse_query says</span>&nbsp;</div></li><li><div>  $bbp-&gt;reply_query-&gt;is_home = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Reset is_single if single topic</span>&nbsp;</div></li><li><div>  if ( bbp_is_single_topic() ) {&nbsp;</div></li><li><div>      $bbp-&gt;reply_query-&gt;is_single = true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Only add reply to if query returned results</span>&nbsp;</div></li><li><div>  if ( (int) $bbp-&gt;reply_query-&gt;found_posts ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get reply to for each reply</span>&nbsp;</div></li><li><div>      foreach ( $bbp-&gt;reply_query-&gt;posts as &$post ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Check for reply post type</span>&nbsp;</div></li><li><div>          if ( bbp_get_reply_post_type() === $post-&gt;post_type ) {&nbsp;</div></li><li><div>              $reply_to = bbp_get_reply_to( $post-&gt;ID );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Make sure it's a reply to a reply</span>&nbsp;</div></li><li><div>              if ( empty( $reply_to ) || ( bbp_get_reply_topic_id( $post-&gt;ID ) === $reply_to ) ) {&nbsp;</div></li><li><div>                  $reply_to = 0;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Add reply_to to the post object so we can walk it later</span>&nbsp;</div></li><li><div>              $post-&gt;reply_to = $reply_to;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Only add pagination if query returned results</span>&nbsp;</div></li><li><div>  if ( (int) $bbp-&gt;reply_query-&gt;found_posts && (int) $bbp-&gt;reply_query-&gt;posts_per_page ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If pretty permalinks are enabled, make our pagination pretty</span>&nbsp;</div></li><li><div>      if ( $wp_rewrite-&gt;using_permalinks() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// User's replies</span>&nbsp;</div></li><li><div>          if ( bbp_is_single_user_replies() ) {&nbsp;</div></li><li><div>              $base = bbp_get_user_replies_created_url( bbp_get_displayed_user_id() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Root profile page</span>&nbsp;</div></li><li><div>          } elseif ( bbp_is_single_user() ) {&nbsp;</div></li><li><div>              $base = bbp_get_user_profile_url( bbp_get_displayed_user_id() );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Page or single post</span>&nbsp;</div></li><li><div>          } elseif ( is_page() || is_single() ) {&nbsp;</div></li><li><div>              $base = get_permalink();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Single topic</span>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $base = get_permalink( bbp_get_topic_id() );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $base = trailingslashit( $base ) . user_trailingslashit( $wp_rewrite-&gt;pagination_base . '/%#%/' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Unpretty permalinks</span></span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $base = add_query_arg( 'paged', '%#%' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Figure out total pages</span>&nbsp;</div></li><li><div>      if ( true === $r['hierarchical'] ) {&nbsp;</div></li><li><div>          $walker = new BBP_Walker_Reply;&nbsp;</div></li><li><div>          $total_pages = ceil( (int) $walker-&gt;get_number_of_root_elements( $bbp-&gt;reply_query-&gt;posts ) / (int) $replies_per_page );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $total_pages = ceil( (int) $bbp-&gt;reply_query-&gt;found_posts / (int) $replies_per_page );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Add pagination to query object</span>&nbsp;</div></li><li><div>          $bbp-&gt;reply_query-&gt;pagination_links = paginate_links( apply_filters( 'bbp_replies_pagination', array(&nbsp;</div></li><li><div>              'base' =&gt; $base, &nbsp;</div></li><li><div>              'format' =&gt; '', &nbsp;</div></li><li><div>              'total' =&gt; $total_pages, &nbsp;</div></li><li><div>              'current' =&gt; (int) $bbp-&gt;reply_query-&gt;paged, &nbsp;</div></li><li><div>              'prev_text' =&gt; is_rtl() ? '&rarr;' : '&larr;', &nbsp;</div></li><li><div>              'next_text' =&gt; is_rtl() ? '&larr;' : '&rarr;', &nbsp;</div></li><li><div>              'mid_size' =&gt; 1, &nbsp;</div></li><li><div>              'add_args' =&gt; ( bbp_get_view_all() ) ? array( 'view' =&gt; 'all' ) : false&nbsp;</div></li><li><div> ) ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Remove first page from pagination</span>&nbsp;</div></li><li><div>          if ( $wp_rewrite-&gt;using_permalinks() ) {&nbsp;</div></li><li><div>              $bbp-&gt;reply_query-&gt;pagination_links = str_replace( $wp_rewrite-&gt;pagination_base . '/1/', '', $bbp-&gt;reply_query-&gt;pagination_links );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $bbp-&gt;reply_query-&gt;pagination_links = str_replace( '&#038;paged=1', '', $bbp-&gt;reply_query-&gt;pagination_links );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Return object</span>&nbsp;</div></li><li><div>  return apply_filters( 'bbp_has_replies', $bbp-&gt;reply_query-&gt;have_posts(), $bbp-&gt;reply_query );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Whether there are more replies available in the loop</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2553)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Query bbPress::reply_query::have_posts() To check if there are more</span>&nbsp;</div></li><li><div><span class="comment"> *                                                    replies available</span>&nbsp;</div></li><li><div><span class="comment"> * @return object Replies information</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_replies() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Put into variable to check against next</span>&nbsp;</div></li><li><div>  $have_posts = bbpress()-&gt;reply_query-&gt;have_posts();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Reset the post data when finished</span>&nbsp;</div></li><li><div>  if ( empty( $have_posts ) )&nbsp;</div></li><li><div>      wp_reset_postdata();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $have_posts;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Loads up the current reply in the loop</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2553)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses WP_Query bbPress::reply_query::the_post() To get the current reply</span>&nbsp;</div></li><li><div><span class="comment"> * @return object Reply information</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_the_reply() {&nbsp;</div></li><li><div>  return bbpress()-&gt;reply_query-&gt;the_post();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output reply id</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2553)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param $reply_id Optional. Used to check emptiness</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_id( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the id of the reply in a replies loop</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2553)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param $reply_id Optional. Used to check emptiness</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbPress::reply_query::post::ID To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_reply() To check if the search result is a reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_single_reply() To check if it's a reply page</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_reply_edit() To check if it's a reply edit page</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_field() To get the post's post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses WP_Query::post::ID To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_id' with the reply id and</span>&nbsp;</div></li><li><div><span class="comment">   *                        supplied reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return int The reply id</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_id( $reply_id = 0 ) {&nbsp;</div></li><li><div>      global $wp_query;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $bbp = bbpress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Easy empty checking</span>&nbsp;</div></li><li><div>      if ( !empty( $reply_id ) && is_numeric( $reply_id ) ) {&nbsp;</div></li><li><div>          $bbp_reply_id = $reply_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Currently inside a replies loop</span>&nbsp;</div></li><li><div>      } elseif ( !empty( $bbp-&gt;reply_query-&gt;in_the_loop ) && isset( $bbp-&gt;reply_query-&gt;post-&gt;ID ) ) {&nbsp;</div></li><li><div>          $bbp_reply_id = $bbp-&gt;reply_query-&gt;post-&gt;ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Currently inside a search loop</span>&nbsp;</div></li><li><div>      } elseif ( !empty( $bbp-&gt;search_query-&gt;in_the_loop ) && isset( $bbp-&gt;search_query-&gt;post-&gt;ID ) && bbp_is_reply( $bbp-&gt;search_query-&gt;post-&gt;ID ) ) {&nbsp;</div></li><li><div>          $bbp_reply_id = $bbp-&gt;search_query-&gt;post-&gt;ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Currently viewing a forum</span>&nbsp;</div></li><li><div>      } elseif ( ( bbp_is_single_reply() || bbp_is_reply_edit() ) && !empty( $bbp-&gt;current_reply_id ) ) {&nbsp;</div></li><li><div>          $bbp_reply_id = $bbp-&gt;current_reply_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Currently viewing a reply</span>&nbsp;</div></li><li><div>      } elseif ( ( bbp_is_single_reply() || bbp_is_reply_edit() ) && isset( $wp_query-&gt;post-&gt;ID ) ) {&nbsp;</div></li><li><div>          $bbp_reply_id = $wp_query-&gt;post-&gt;ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Fallback</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $bbp_reply_id = 0;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return (int) apply_filters( 'bbp_get_reply_id', $bbp_reply_id, $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Gets a reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2787)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int|object $reply reply id or reply object</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $output Optional. OBJECT, ARRAY_A, or ARRAY_N. Default = OBJECT</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $filter Optional Sanitation filter. See {@link sanitize_post()}</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_post() To get the reply</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters() Calls 'bbp_get_reply' with the reply, output type and</span>&nbsp;</div></li><li><div><span class="comment"> *                        sanitation filter</span>&nbsp;</div></li><li><div><span class="comment"> * @return mixed Null if error or reply (in specified form) if success</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_get_reply( $reply, $output = OBJECT, $filter = 'raw' ) {&nbsp;</div></li><li><div>  if ( empty( $reply ) || is_numeric( $reply ) )&nbsp;</div></li><li><div>      $reply = bbp_get_reply_id( $reply );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $reply = get_post( $reply, OBJECT, $filter );&nbsp;</div></li><li><div>  if ( empty( $reply ) )&nbsp;</div></li><li><div>      return $reply;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $reply-&gt;post_type !== bbp_get_reply_post_type() )&nbsp;</div></li><li><div>      return null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $output === OBJECT ) {&nbsp;</div></li><li><div>      return $reply;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( $output === ARRAY_A ) {&nbsp;</div></li><li><div>      $_reply = get_object_vars( $reply );&nbsp;</div></li><li><div>      return $_reply;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } elseif ( $output === ARRAY_N ) {&nbsp;</div></li><li><div>      $_reply = array_values( get_object_vars( $reply ) );&nbsp;</div></li><li><div>      return $_reply;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return apply_filters( 'bbp_get_reply', $reply, $output, $filter );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the link to the reply in the reply loop</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2553)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_permalink() To get the reply permalink</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_permalink( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo esc_url( bbp_get_reply_permalink( $reply_id ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the link to the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2553)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_permalink() To get the permalink of the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_permalink' with the link</span>&nbsp;</div></li><li><div><span class="comment">   *                        and reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Permanent link to reply</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_permalink( $reply_id = 0 ) {&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_permalink', get_permalink( $reply_id ), $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the paginated url to the reply in the reply loop</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2679)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_url() To get the reply url</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_url( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo esc_url( bbp_get_reply_url( $reply_id ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the paginated url to the reply in the reply loop</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2679)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $redirect_to Optional. Pass a redirect value for use with</span>&nbsp;</div></li><li><div><span class="comment">   *                              shortcodes and other fun things.</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_topic_id() To get the reply topic id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_permalink() To get the topic permalink</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_position() To get the reply position</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_option() To get the replies per page option</span>&nbsp;</div></li><li><div><span class="comment">   * @uses WP_Rewrite::using_permalinks() To check if the blog uses</span>&nbsp;</div></li><li><div><span class="comment">   *                                       permalinks</span>&nbsp;</div></li><li><div><span class="comment">   * @uses add_query_arg() To add custom args to the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_url' with the reply url, </span>&nbsp;</div></li><li><div><span class="comment">   *                        reply id and bool count hidden</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Link to reply relative to paginated topic</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_url( $reply_id = 0, $redirect_to = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set needed variables</span>&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id      ( $reply_id );&nbsp;</div></li><li><div>      $topic_id = bbp_get_reply_topic_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Hierarchical reply page</span>&nbsp;</div></li><li><div>      if ( bbp_thread_replies() ) {&nbsp;</div></li><li><div>          $reply_page = 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Standard reply page</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $reply_page = ceil( (int) bbp_get_reply_position( $reply_id, $topic_id ) / (int) bbp_get_replies_per_page() );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $reply_hash = '#post-' . $reply_id;&nbsp;</div></li><li><div>      $topic_link = bbp_get_topic_permalink( $topic_id, $redirect_to );&nbsp;</div></li><li><div>      $topic_url = remove_query_arg( 'view', $topic_link );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Don't include pagination if on first page</span>&nbsp;</div></li><li><div>      if ( 1 &gt;= $reply_page ) {&nbsp;</div></li><li><div>          $url = trailingslashit( $topic_url ) . $reply_hash;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Include pagination</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          global $wp_rewrite;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment"><span class="comment">// Pretty permalinks</span></span>&nbsp;</div></li><li><div>          if ( $wp_rewrite-&gt;using_permalinks() ) {&nbsp;</div></li><li><div>              $url = trailingslashit( $topic_url ) . trailingslashit( $wp_rewrite-&gt;pagination_base ) . trailingslashit( $reply_page ) . $reply_hash;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Yucky links</span>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $url = add_query_arg( 'paged', $reply_page, $topic_url ) . $reply_hash;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add topic view query arg back to end if it is set</span>&nbsp;</div></li><li><div>      if ( bbp_get_view_all() )&nbsp;</div></li><li><div>          $url = bbp_add_view_all( $url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_url', $url, $reply_id, $redirect_to );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the title of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2553)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_title() To get the reply title</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_title( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_title( $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the title of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2553)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_the_title() To get the reply title</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_title' with the title and</span>&nbsp;</div></li><li><div><span class="comment">   *                        reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Title of reply</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_title( $reply_id = 0 ) {&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_title', get_the_title( $reply_id ), $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get empty reply title fallback.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r5177)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $reply_title Required. Reply Title</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Required. Reply ID</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_topic_title() To get the reply topic title</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_title_fallback' with the title and reply ID</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Title of reply</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_title_fallback( $post_title = '', $post_id = 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Bail if title not empty, or post is not a reply</span>&nbsp;</div></li><li><div>      if ( ! empty( $post_title ) || ! bbp_is_reply( $post_id ) ) {&nbsp;</div></li><li><div>          return $post_title;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get reply topic title.</span>&nbsp;</div></li><li><div>      $topic_title = bbp_get_reply_topic_title( $post_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get empty reply title fallback.</span>&nbsp;</div></li><li><div>      $reply_title = sprintf( __( 'Reply To: %s', 'bbpress' ), $topic_title );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_title_fallback', $reply_title, $post_id, $topic_title );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the content of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2553)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_content() To get the reply content</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_content( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_content( $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the content of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2780)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses post_password_required() To check if the reply requires pass</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_the_password_form() To get the password form</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_field() To get the content post field</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_content' with the content</span>&nbsp;</div></li><li><div><span class="comment">   *                        and reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Content of the reply</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_content( $reply_id = 0 ) {&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Check if password is required</span>&nbsp;</div></li><li><div>      if ( post_password_required( $reply_id ) )&nbsp;</div></li><li><div>          return get_the_password_form();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $content = get_post_field( 'post_content', $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_content', $content, $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the excerpt of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2751)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $length Optional. Length of the excerpt. Defaults to 100 letters</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_excerpt() To get the reply excerpt</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_excerpt( $reply_id = 0, $length = 100 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_excerpt( $reply_id, $length );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the excerpt of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2751)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $length Optional. Length of the excerpt. Defaults to 100</span>&nbsp;</div></li><li><div><span class="comment">   *                     letters</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_field() To get the excerpt</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_content() To get the reply content</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_excerpt' with the excerpt, </span>&nbsp;</div></li><li><div><span class="comment">   *                        reply id and length</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Reply Excerpt</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_excerpt( $reply_id = 0, $length = 100 ) {&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>      $length = (int) $length;&nbsp;</div></li><li><div>      $excerpt = get_post_field( 'post_excerpt', $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $excerpt ) ) {&nbsp;</div></li><li><div>          $excerpt = bbp_get_reply_content( $reply_id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $excerpt = trim ( strip_tags( $excerpt ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Multibyte support</span>&nbsp;</div></li><li><div>      if ( function_exists( 'mb_strlen' ) ) {&nbsp;</div></li><li><div>          $excerpt_length = mb_strlen( $excerpt );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $excerpt_length = strlen( $excerpt );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !empty( $length ) && ( $excerpt_length &gt; $length ) ) {&nbsp;</div></li><li><div>          $excerpt = substr( $excerpt, 0, $length - 1 );&nbsp;</div></li><li><div>          $excerpt .= '&hellip;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_excerpt', $excerpt, $reply_id, $length );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the post date and time of a reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4155)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id.</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $humanize Optional. Humanize output using time_since</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $gmt Optional. Use GMT</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_post_date() to get the output</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_post_date( $reply_id = 0, $humanize = false, $gmt = false ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_post_date( $reply_id, $humanize, $gmt );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the post date and time of a reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r4155)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id.</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $humanize Optional. Humanize output using time_since</span>&nbsp;</div></li><li><div><span class="comment">   * @param bool $gmt Optional. Use GMT</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_time() to get the reply post time</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_time_since() to maybe humanize the reply post time</span>&nbsp;</div></li><li><div><span class="comment">   * @return string</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_post_date( $reply_id = 0, $humanize = false, $gmt = false ) {&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// 4 days, 4 hours ago</span>&nbsp;</div></li><li><div>      if ( !empty( $humanize ) ) {&nbsp;</div></li><li><div>          $gmt_s = !empty( $gmt ) ? 'G' : 'U';&nbsp;</div></li><li><div>          $date = get_post_time( $gmt_s, $gmt, $reply_id );&nbsp;</div></li><li><div>          $time = false; <span class="comment">// For filter below</span>&nbsp;</div></li><li><div>          $result = bbp_get_time_since( $date );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// August 4, 2012 at 2:37 pm</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $date = get_post_time( get_option( 'date_format' ), $gmt, $reply_id, true );&nbsp;</div></li><li><div>          $time = get_post_time( get_option( 'time_format' ), $gmt, $reply_id, true );&nbsp;</div></li><li><div>          $result = sprintf( _x( '%1$s at %2$s', 'date at time', 'bbpress' ), $date, $time );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_post_date', $result, $reply_id, $humanize, $gmt, $date, $time );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Append revisions to the reply content</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2782)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $content Optional. Content to which we need to append the revisions to</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_revision_log() To get the reply revision log</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters() Calls 'bbp_reply_append_revisions' with the processed</span>&nbsp;</div></li><li><div><span class="comment"> *                        content, original content and reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @return string Content with the revisions appended</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_content_append_revisions( $content = '', $reply_id = 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Bail if in admin or feed</span>&nbsp;</div></li><li><div>  if ( is_admin() || is_feed() )&nbsp;</div></li><li><div>      return $content;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Validate the ID</span>&nbsp;</div></li><li><div>  $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return apply_filters( 'bbp_reply_append_revisions', $content . bbp_get_reply_revision_log( $reply_id ), $content, $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the revision log of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2782)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_revision_log() To get the reply revision log</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_revision_log( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_revision_log( $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the formatted revision log of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2782)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_revisions() To get the reply revisions</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_raw_revision_log() To get the raw revision log</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_author_display_name() To get the reply author</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_author_link() To get the reply author link</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_convert_date() To convert the date</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_time_since() To get the time in since format</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_revision_log' with the</span>&nbsp;</div></li><li><div><span class="comment">   *                        log and reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Revision log of the reply</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_revision_log( $reply_id = 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Create necessary variables</span>&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Show the topic reply log if this is a topic in a reply loop</span>&nbsp;</div></li><li><div>      if ( bbp_is_topic( $reply_id ) ) {&nbsp;</div></li><li><div>          return bbp_get_topic_revision_log( $reply_id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get the reply revision log (out of post meta</span>&nbsp;</div></li><li><div>      $revision_log = bbp_get_reply_raw_revision_log( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Check reply and revision log exist</span>&nbsp;</div></li><li><div>      if ( empty( $reply_id ) || empty( $revision_log ) || !is_array( $revision_log ) )&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get the actual revisions</span>&nbsp;</div></li><li><div>      $revisions = bbp_get_reply_revisions( $reply_id );&nbsp;</div></li><li><div>      if ( empty( $revisions ) )&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r = &quot;\n\n&quot; . '&lt;ul id=&quot;bbp-reply-revision-log-' . esc_attr( $reply_id ) . '&quot; class=&quot;bbp-reply-revision-log&quot;&gt;' . &quot;\n\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Loop through revisions</span>&nbsp;</div></li><li><div>      foreach ( (array) $revisions as $revision ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if ( empty( $revision_log[$revision-&gt;ID] ) ) {&nbsp;</div></li><li><div>              $author_id = $revision-&gt;post_author;&nbsp;</div></li><li><div>              $reason = '';&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $author_id = $revision_log[$revision-&gt;ID]['author'];&nbsp;</div></li><li><div>              $reason = $revision_log[$revision-&gt;ID]['reason'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $author = bbp_get_author_link( array( 'size' =&gt; 14, 'link_text' =&gt; bbp_get_reply_author_display_name( $revision-&gt;ID ), 'post_id' =&gt; $revision-&gt;ID ) );&nbsp;</div></li><li><div>          $since = bbp_get_time_since( bbp_convert_date( $revision-&gt;post_modified ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $r .= &quot;\t&quot; . '&lt;li id=&quot;bbp-reply-revision-log-' . esc_attr( $reply_id ) . '-item-' . esc_attr( $revision-&gt;ID ) . '&quot; class=&quot;bbp-reply-revision-log-item&quot;&gt;' . &quot;\n&quot;;&nbsp;</div></li><li><div>          if ( !empty( $reason ) ) {&nbsp;</div></li><li><div>              $r .= &quot;\t\t&quot; . sprintf( esc_html__( 'This reply was modified %1$s by %2$s. Reason: %3$s', 'bbpress' ), esc_html( $since ), $author, esc_html( $reason ) ) . &quot;\n&quot;;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $r .= &quot;\t\t&quot; . sprintf( esc_html__( 'This reply was modified %1$s by %2$s.', 'bbpress' ), esc_html( $since ), $author ) . &quot;\n&quot;;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $r .= &quot;\t&quot; . '&lt;/li&gt;' . &quot;\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r .= &quot;\n&quot; . '&lt;/ul&gt;' . &quot;\n\n&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_revision_log', $r, $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>      <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">       * Return the raw revision log of the reply</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @since bbPress (r2782)</span>&nbsp;</div></li><li><div><span class="comment">       *</span>&nbsp;</div></li><li><div><span class="comment">       * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">       * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">       * @uses get_post_meta() To get the revision log meta</span>&nbsp;</div></li><li><div><span class="comment">       * @uses apply_filters() Calls 'bbp_get_reply_raw_revision_log'</span>&nbsp;</div></li><li><div><span class="comment">       *                        with the log and reply id</span>&nbsp;</div></li><li><div><span class="comment">       * @return string Raw revision log of the reply</span>&nbsp;</div></li><li><div><span class="comment">       */</span>&nbsp;</div></li><li><div>      function bbp_get_reply_raw_revision_log( $reply_id = 0 ) {&nbsp;</div></li><li><div>          $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>          $revision_log = get_post_meta( $reply_id, '_bbp_revision_log', true );&nbsp;</div></li><li><div>          $revision_log = empty( $revision_log ) ? array() : $revision_log;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          return apply_filters( 'bbp_get_reply_raw_revision_log', $revision_log, $reply_id );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return the revisions of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2782)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses wp_get_post_revisions() To get the reply revisions</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters() Calls 'bbp_get_reply_revisions'</span>&nbsp;</div></li><li><div><span class="comment"> *                        with the revisions and reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @return string reply revisions</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_get_reply_revisions( $reply_id = 0 ) {&nbsp;</div></li><li><div>  $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>  $revisions = wp_get_post_revisions( $reply_id, array( 'order' =&gt; 'ASC' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return apply_filters( 'bbp_get_reply_revisions', $revisions, $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return the revision count of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2782)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @param boolean $integer Optional. Whether or not to format the result</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_revisions() To get the reply revisions</span>&nbsp;</div></li><li><div><span class="comment"> * @uses apply_filters() Calls 'bbp_get_reply_revision_count'</span>&nbsp;</div></li><li><div><span class="comment"> *                        with the revision count and reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @return string reply revision count</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_get_reply_revision_count( $reply_id = 0, $integer = false ) {&nbsp;</div></li><li><div>  $count = (int) count( bbp_get_reply_revisions( $reply_id ) );&nbsp;</div></li><li><div>  $filter = ( true === $integer ) ? 'bbp_get_reply_revision_count_int' : 'bbp_get_reply_revision_count';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return apply_filters( $filter, $count, $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the status of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2667)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_status() To get the reply status</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_status( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_status( $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the status of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2667)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_status() To get the reply status</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_status' with the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Status of reply</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_status( $reply_id = 0 ) {&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_status', get_post_status( $reply_id ), $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Is the reply not spam or deleted?</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3496)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Topic id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_status() To get the reply status</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if published, false if not.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_reply_published( $reply_id = 0 ) {&nbsp;</div></li><li><div>  $reply_status = bbp_get_reply_status( bbp_get_reply_id( $reply_id ) ) === bbp_get_public_status_id();&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_reply_published', (bool) $reply_status, $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Is the reply marked as spam?</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2740)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_status() To get the reply status</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if spam, false if not.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_reply_spam( $reply_id = 0 ) {&nbsp;</div></li><li><div>  $reply_status = bbp_get_reply_status( bbp_get_reply_id( $reply_id ) ) === bbp_get_spam_status_id();&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_reply_spam', (bool) $reply_status, $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Is the reply trashed?</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2884)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Topic id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_status() To get the reply status</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if spam, false if not.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_reply_trash( $reply_id = 0 ) {&nbsp;</div></li><li><div>  $reply_status = bbp_get_reply_status( bbp_get_reply_id( $reply_id ) ) === bbp_get_trash_status_id();&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_reply_trash', (bool) $reply_status, $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Is the reply by an anonymous user?</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2753)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_author_id() To get the reply author id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses get_post_meta() To get the anonymous name and email metas</span>&nbsp;</div></li><li><div><span class="comment"> * @return bool True if the post is by an anonymous user, false if not.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_is_reply_anonymous( $reply_id = 0 ) {&nbsp;</div></li><li><div>  $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>  $retval = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !bbp_get_reply_author_id( $reply_id ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  elseif ( get_post_meta( $reply_id, '_bbp_anonymous_name', true ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  elseif ( get_post_meta( $reply_id, '_bbp_anonymous_email', true ) )&nbsp;</div></li><li><div>      $retval = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return (bool) apply_filters( 'bbp_is_reply_anonymous', $retval, $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Deprecated. Use bbp_reply_author_display_name() instead.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Output the author of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2667)</span>&nbsp;</div></li><li><div><span class="comment"> * @deprecated bbPress (r5119)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_author() To get the reply author</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_author( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_author( $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Deprecated. Use bbp_get_reply_author_display_name() instead.</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Return the author of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2667)</span>&nbsp;</div></li><li><div><span class="comment">   * @deprecated bbPress (r5119)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_reply_anonymous() To check if the reply is by an</span>&nbsp;</div></li><li><div><span class="comment">   *                                 anonymous user</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_the_author_meta() To get the reply author display name</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_meta() To get the anonymous poster name</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_author' with the reply</span>&nbsp;</div></li><li><div><span class="comment">   *                        author and reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Author of reply</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_author( $reply_id = 0 ) {&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !bbp_is_reply_anonymous( $reply_id ) ) {&nbsp;</div></li><li><div>          $author = get_the_author_meta( 'display_name', bbp_get_reply_author_id( $reply_id ) );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $author = get_post_meta( $reply_id, '_bbp_anonymous_name', true );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_author', $author, $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the author ID of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2667)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_author_id() To get the reply author id</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_author_id( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_author_id( $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the author ID of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2667)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_field() To get the reply author id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_author_id' with the author</span>&nbsp;</div></li><li><div><span class="comment">   *                        id and reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Author id of reply</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_author_id( $reply_id = 0 ) {&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>      $author_id = get_post_field( 'post_author', $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return (int) apply_filters( 'bbp_get_reply_author_id', $author_id, $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the author display_name of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2667)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_author_display_name()</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_author_display_name( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_author_display_name( $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the author display_name of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2667)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_reply_anonymous() To check if the reply is by an</span>&nbsp;</div></li><li><div><span class="comment">   *                                 anonymous user</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_author_id() To get the reply author id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_the_author_meta() To get the reply author's display name</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_meta() To get the anonymous poster's name</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_author_display_name' with</span>&nbsp;</div></li><li><div><span class="comment">   *                        the author display name and reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Reply's author's display name</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_author_display_name( $reply_id = 0 ) {&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// User is not a guest</span>&nbsp;</div></li><li><div>      if ( !bbp_is_reply_anonymous( $reply_id ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Get the author ID</span>&nbsp;</div></li><li><div>          $author_id = bbp_get_reply_author_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Try to get a display name</span>&nbsp;</div></li><li><div>          $author_name = get_the_author_meta( 'display_name', $author_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Fall back to user login</span>&nbsp;</div></li><li><div>          if ( empty( $author_name ) ) {&nbsp;</div></li><li><div>              $author_name = get_the_author_meta( 'user_login', $author_id );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// User does not have an account</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $author_name = get_post_meta( $reply_id, '_bbp_anonymous_name', true );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If nothing could be found anywhere, use Anonymous</span>&nbsp;</div></li><li><div>      if ( empty( $author_name ) )&nbsp;</div></li><li><div>          $author_name = __( 'Anonymous', 'bbpress' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Encode possible UTF8 display names</span>&nbsp;</div></li><li><div>      if ( seems_utf8( $author_name ) === false )&nbsp;</div></li><li><div>          $author_name = utf8_encode( $author_name );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_author_display_name', $author_name, $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the author avatar of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2667)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $size Optional. Size of the avatar. Defaults to 40</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_author_avatar() To get the reply author id</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_author_avatar( $reply_id = 0, $size = 40 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_author_avatar( $reply_id, $size );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the author avatar of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2667)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $size Optional. Size of the avatar. Defaults to 40</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_reply_anonymous() To check if the reply is by an</span>&nbsp;</div></li><li><div><span class="comment">   *                                 anonymous user</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_author_id() To get the reply author id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_meta() To get the anonymous poster's email id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_avatar() To get the avatar</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_author_avatar' with the</span>&nbsp;</div></li><li><div><span class="comment">   *                        author avatar, reply id and size</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Avatar of author of the reply</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_author_avatar( $reply_id = 0, $size = 40 ) {&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>      if ( !empty( $reply_id ) ) {&nbsp;</div></li><li><div>          <span class="comment">// Check for anonymous user</span>&nbsp;</div></li><li><div>          if ( !bbp_is_reply_anonymous( $reply_id ) ) {&nbsp;</div></li><li><div>              $author_avatar = get_avatar( bbp_get_reply_author_id( $reply_id ), $size );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $author_avatar = get_avatar( get_post_meta( $reply_id, '_bbp_anonymous_email', true ), $size );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $author_avatar = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_author_avatar', $author_avatar, $reply_id, $size );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the author link of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2717)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $args Optional. If it is an integer, it is used as reply id.</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_author_link() To get the reply author link</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_author_link( $args = '' ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_author_link( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the author link of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2717)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param mixed $args Optional. If an integer, it is used as reply id.</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_reply_anonymous() To check if the reply is by an</span>&nbsp;</div></li><li><div><span class="comment">   *                                 anonymous user</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_author_url() To get the reply author url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_author_avatar() To get the reply author avatar</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_author_display_name() To get the reply author display</span>&nbsp;</div></li><li><div><span class="comment">   *                                      name</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_user_display_role() To get the reply author display role</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_author_id() To get the reply author id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_author_link' with the</span>&nbsp;</div></li><li><div><span class="comment">   *                        author link and args</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Author link of reply</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_author_link( $args = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Parse arguments against default values</span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $r = bbp_parse_args( $args, array(&nbsp;</div></li><li><div>          'post_id' =&gt; 0, &nbsp;</div></li><li><div>          'link_title' =&gt; '', &nbsp;</div></li><li><div>          'type' =&gt; 'both', &nbsp;</div></li><li><div>          'size' =&gt; 80, &nbsp;</div></li><li><div>          'sep' =&gt; '&nbsp;', &nbsp;</div></li><li><div>          'show_role' =&gt; false&nbsp;</div></li><li><div> ), 'get_reply_author_link' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Used as reply_id</span>&nbsp;</div></li><li><div>      if ( is_numeric( $args ) ) {&nbsp;</div></li><li><div>          $reply_id = bbp_get_reply_id( $args );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $reply_id = bbp_get_reply_id( $r['post_id'] );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Reply ID is good</span>&nbsp;</div></li><li><div>      if ( !empty( $reply_id ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Get some useful reply information</span>&nbsp;</div></li><li><div>          $author_url = bbp_get_reply_author_url( $reply_id );&nbsp;</div></li><li><div>          $anonymous = bbp_is_reply_anonymous( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Tweak link title if empty</span>&nbsp;</div></li><li><div>          if ( empty( $r['link_title'] ) ) {&nbsp;</div></li><li><div>              $link_title = sprintf( empty( $anonymous ) ? __( 'View %s\'s profile', 'bbpress' ) : __( 'Visit %s\'s website', 'bbpress' ), bbp_get_reply_author_display_name( $reply_id ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Use what was passed if not</span>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $link_title = $r['link_title'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Setup title and author_links array</span>&nbsp;</div></li><li><div>          $link_title = !empty( $link_title ) ? ' title=&quot;' . esc_attr( $link_title ) . '&quot;' : '';&nbsp;</div></li><li><div>          $author_links = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Get avatar</span>&nbsp;</div></li><li><div>          if ( 'avatar' === $r['type'] || 'both' === $r['type'] ) {&nbsp;</div></li><li><div>              $author_links['avatar'] = bbp_get_reply_author_avatar( $reply_id, $r['size'] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Get display name</span>&nbsp;</div></li><li><div>          if ( 'name' === $r['type']   || 'both' === $r['type'] ) {&nbsp;</div></li><li><div>              $author_links['name'] = bbp_get_reply_author_display_name( $reply_id );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Link class</span>&nbsp;</div></li><li><div>          $link_class = ' class=&quot;bbp-author-' . esc_attr( $r['type'] ) . '&quot;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Add links if not anonymous and existing user</span>&nbsp;</div></li><li><div>          if ( empty( $anonymous ) && bbp_user_has_profile( bbp_get_reply_author_id( $reply_id ) ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Assemble the links</span>&nbsp;</div></li><li><div>              foreach ( $author_links as $link =&gt; $link_text ) {&nbsp;</div></li><li><div>                  $link_class = ' class=&quot;bbp-author-' . $link . '&quot;';&nbsp;</div></li><li><div>                  $author_link[] = sprintf( '&lt;a href=&quot;%1$s&quot;%2$s%3$s&gt;%4$s&lt;/a&gt;', esc_url( $author_url ), $link_title, $link_class, $link_text );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if ( true === $r['show_role'] ) {&nbsp;</div></li><li><div>                  $author_link[] = bbp_get_reply_author_role( array( 'reply_id' =&gt; $reply_id ) );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $author_link = implode( $r['sep'], $author_link );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// No links if anonymous</span>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $author_link = implode( $r['sep'], $author_links );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// No replies so link is empty</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $author_link = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_author_link', $author_link, $r );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the author url of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2667)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_author_url() To get the reply author url</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_author_url( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo esc_url( bbp_get_reply_author_url( $reply_id ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the author url of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2667)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_reply_anonymous() To check if the reply is by an anonymous</span>&nbsp;</div></li><li><div><span class="comment">   *                                 user</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_user_has_profile() To check if the user has a profile</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_author_id() To get the reply author id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_user_profile_url() To get the user profile url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_meta() To get the anonymous poster's website url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls bbp_get_reply_author_url with the author</span>&nbsp;</div></li><li><div><span class="comment">   *                        url & reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Author URL of the reply</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_author_url( $reply_id = 0 ) {&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Check for anonymous user</span> or non-existant user&nbsp;</div></li><li><div>      if ( !bbp_is_reply_anonymous( $reply_id ) && bbp_user_has_profile( bbp_get_reply_author_id( $reply_id ) ) ) {&nbsp;</div></li><li><div>          $author_url = bbp_get_user_profile_url( bbp_get_reply_author_id( $reply_id ) );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $author_url = get_post_meta( $reply_id, '_bbp_anonymous_website', true );&nbsp;</div></li><li><div>          if ( empty( $author_url ) ) {&nbsp;</div></li><li><div>              $author_url = '';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_author_url', $author_url, $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the reply author email address</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3445)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_author_email() To get the reply author email</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_author_email( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_author_email( $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the reply author email address</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r3445)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_reply_anonymous() To check if the reply is by an anonymous</span>&nbsp;</div></li><li><div><span class="comment">   *                                 user</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_author_id() To get the reply author id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_userdata() To get the user data</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_meta() To get the anonymous poster's website email</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls bbp_get_reply_author_email with the author</span>&nbsp;</div></li><li><div><span class="comment">   *                        email & reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Reply author email address</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_author_email( $reply_id = 0 ) {&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Not anonymous</span>&nbsp;</div></li><li><div>      if ( !bbp_is_reply_anonymous( $reply_id ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Use reply author email address</span>&nbsp;</div></li><li><div>          $user_id = bbp_get_reply_author_id( $reply_id );&nbsp;</div></li><li><div>          $user = get_userdata( $user_id );&nbsp;</div></li><li><div>          $author_email = !empty( $user-&gt;user_email ) ? $user-&gt;user_email : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Anonymous</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Get email from post meta</span>&nbsp;</div></li><li><div>          $author_email = get_post_meta( $reply_id, '_bbp_anonymous_email', true );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Sanity check for missing email address</span>&nbsp;</div></li><li><div>          if ( empty( $author_email ) ) {&nbsp;</div></li><li><div>              $author_email = '';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_author_email', $author_email, $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the reply author role</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r3860)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Optional.</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_author_role() To get the reply author role</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_author_role( $args = array() ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_author_role( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the reply author role</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r3860)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Optional.</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_user_display_role() To get the user display role</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_author_id() To get the reply author id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls bbp_get_reply_author_role with the author</span>&nbsp;</div></li><li><div><span class="comment">   *                        role & args</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Reply author role</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_author_role( $args = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Parse arguments against default values</span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $r = bbp_parse_args( $args, array(&nbsp;</div></li><li><div>          'reply_id' =&gt; 0, &nbsp;</div></li><li><div>          'class' =&gt; 'bbp-author-role', &nbsp;</div></li><li><div>          'before' =&gt; '', &nbsp;</div></li><li><div>          'after' =&gt; ''&nbsp;</div></li><li><div> ), 'get_reply_author_role' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $r['reply_id'] );&nbsp;</div></li><li><div>      $role = bbp_get_user_display_role( bbp_get_reply_author_id( $reply_id ) );&nbsp;</div></li><li><div>      $author_role = sprintf( '%1$s&lt;div class=&quot;%2$s&quot;&gt;%3$s&lt;/div&gt;%4$s', $r['before'], esc_attr( $r['class'] ), esc_html( $role ), $r['after'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_author_role', $author_role, $r );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the topic title a reply belongs to</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2553)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_topic_title() To get the reply topic title</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_topic_title( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_topic_title( $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the topic title a reply belongs to</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2553)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_topic_id() To get the reply topic id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_title() To get the reply topic title</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_topic_title' with the</span>&nbsp;</div></li><li><div><span class="comment">   *                        topic title and reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Reply's topic's title</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_topic_title( $reply_id = 0 ) {&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>      $topic_id = bbp_get_reply_topic_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_topic_title', bbp_get_topic_title( $topic_id ), $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the topic id a reply belongs to</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2553)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_topic_id() To get the reply topic id</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_topic_id( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_topic_id( $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the topic id a reply belongs to</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2553)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_meta() To get the reply topic id from meta</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_id() To get the topic id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_topic_id' with the topic</span>&nbsp;</div></li><li><div><span class="comment">   *                        id and reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return int Reply's topic id</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_topic_id( $reply_id = 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Assume there is no topic id</span>&nbsp;</div></li><li><div>      $topic_id = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// Check that reply_id is valid</span></span></span>&nbsp;</div></li><li><div>      if ( $reply_id = bbp_get_reply_id( $reply_id ) )&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Get topic_id from reply</span>&nbsp;</div></li><li><div>          if ( $topic_id = get_post_meta( $reply_id, '_bbp_topic_id', true ) )&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Validate the topic_id</span>&nbsp;</div></li><li><div>              $topic_id = bbp_get_topic_id( $topic_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return (int) apply_filters( 'bbp_get_reply_topic_id', $topic_id, $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the forum id a reply belongs to</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2679)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_forum_id() To get the reply forum id</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_forum_id( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_forum_id( $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the forum id a reply belongs to</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2679)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_meta() To get the reply forum id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_forum_id' with the forum</span>&nbsp;</div></li><li><div><span class="comment">   *                        id and reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return int Reply's forum id</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_forum_id( $reply_id = 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Assume there is no forum</span>&nbsp;</div></li><li><div>      $forum_id = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// Check that reply_id is valid</span></span></span>&nbsp;</div></li><li><div>      if ( $reply_id = bbp_get_reply_id( $reply_id ) )&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Get forum_id from reply</span>&nbsp;</div></li><li><div>          if ( $forum_id = get_post_meta( $reply_id, '_bbp_forum_id', true ) )&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Validate the forum_id</span>&nbsp;</div></li><li><div>              $forum_id = bbp_get_forum_id( $forum_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return (int) apply_filters( 'bbp_get_reply_forum_id', $forum_id, $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the reply's ancestor reply id</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4944)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_ancestor_id() To get the reply's ancestor id</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_ancestor_id( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_ancestor_id( $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the reply's ancestor reply id</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r4944)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param in $reply_id Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_ancestor_id( $reply_id = 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Validation</span>&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>      if ( empty( $reply_id ) )&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Find highest reply ancestor</span>&nbsp;</div></li><li><div>      $ancestor_id = $reply_id;&nbsp;</div></li><li><div>      while ( $parent_id = bbp_get_reply_to( $ancestor_id ) ) {&nbsp;</div></li><li><div>          if ( empty( $parent_id ) || ( $parent_id === $ancestor_id ) || ( bbp_get_reply_topic_id( $reply_id ) === $parent_id ) || ( $parent_id === $reply_id ) ) {&nbsp;</div></li><li><div>              break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>          $ancestor_id = $parent_id;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return (int) $ancestor_id;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the reply to id of a reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4944)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_to() To get the reply to id</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_to( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_to( $reply_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the reply to id of a reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">    * @since bbPress (r4944)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_meta() To get the reply to id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_to' with the reply to id and</span>&nbsp;</div></li><li><div><span class="comment">   *                        reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return int Reply's reply to id</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_to( $reply_id = 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Assume there is no reply_to set</span>&nbsp;</div></li><li><div>      $reply_to = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// Check that reply_id is valid</span></span></span>&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get reply_to value</span>&nbsp;</div></li><li><div>      if ( !empty( $reply_id ) ) {&nbsp;</div></li><li><div>          $reply_to = (int) get_post_meta( $reply_id, '_bbp_reply_to', true );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return (int) apply_filters( 'bbp_get_reply_to', $reply_to, $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the link for the reply to</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4944)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_to_link() To get the reply to link</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_to_link( $args = array() ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_to_link( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the link for a reply to a reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r4944)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args Arguments</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_current_user_can_access_create_reply_form() To check permissions</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To validate the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply() To get the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_to_link' with the formatted link, </span>&nbsp;</div></li><li><div><span class="comment">   *                        the arguments array, and the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Link for a reply to a reply</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_to_link( $args = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Parse arguments against default values</span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $r = bbp_parse_args( $args, array(&nbsp;</div></li><li><div>          'id' =&gt; 0, &nbsp;</div></li><li><div>          'link_before' =&gt; '', &nbsp;</div></li><li><div>          'link_after' =&gt; '', &nbsp;</div></li><li><div>          'reply_text' =&gt; __( 'Reply', 'bbpress' ), &nbsp;</div></li><li><div>          'depth' =&gt; 0, &nbsp;</div></li><li><div>          'add_below' =&gt; 'post', &nbsp;</div></li><li><div>          'respond_id' =&gt; 'new-reply-' . bbp_get_topic_id(), &nbsp;</div></li><li><div> ), 'get_reply_to_link' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get the reply to use it's ID and post_parent</span>&nbsp;</div></li><li><div>      $reply = bbp_get_reply( bbp_get_reply_id( (int) $r['id'] ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Bail if no reply or user cannot reply</span>&nbsp;</div></li><li><div>      if ( empty( $reply ) || ! bbp_current_user_can_access_create_reply_form() )&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Build the URI and return value</span>&nbsp;</div></li><li><div>      $uri = remove_query_arg( array( 'bbp_reply_to' ) );&nbsp;</div></li><li><div>      $uri = add_query_arg( array( 'bbp_reply_to' =&gt; $reply-&gt;ID ) );&nbsp;</div></li><li><div>      $uri = wp_nonce_url( $uri, 'respond_id_' . $reply-&gt;ID );&nbsp;</div></li><li><div>      $uri = $uri . '#new-post';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Only add onclick if replies are threaded</span>&nbsp;</div></li><li><div>      if ( bbp_thread_replies() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Array of classes to pass to moveForm</span>&nbsp;</div></li><li><div>          $move_form = array(&nbsp;</div></li><li><div>              $r['add_below'] . '-' . $reply-&gt;ID, &nbsp;</div></li><li><div>              $reply-&gt;ID, &nbsp;</div></li><li><div>              $r['respond_id'], &nbsp;</div></li><li><div>              $reply-&gt;post_parent&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Build the onclick</span>&nbsp;</div></li><li><div>          $onclick = ' onclick=&quot;return addReply.moveForm(\'' . implode( &quot;', '&quot;, $move_form ) . '\');&quot;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// No onclick if replies are not threaded</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $onclick = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Add $uri to the array, to be passed through the filter</span>&nbsp;</div></li><li><div>      $r['uri'] = $uri;&nbsp;</div></li><li><div>      $retval = $r['link_before'] . '&lt;a href=&quot;' . esc_url( $r['uri'] ) . '&quot; class=&quot;bbp-reply-to-link&quot;' . $onclick . '&gt;' . esc_html( $r['reply_text'] ) . '&lt;/a&gt;' . $r['link_after'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_to_link', $retval, $r, $args );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the reply to a reply cancellation link</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4944)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_cancel_reply_to_link() To get the reply cancellation link</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_cancel_reply_to_link( $text = '' ) {&nbsp;</div></li><li><div>  echo bbp_get_cancel_reply_to_link( $text );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the cancellation link for a reply to a reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r4944)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param string $text The cancel text</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_cancel_reply_to_link' with the cancellation</span>&nbsp;</div></li><li><div><span class="comment">   *                        link and the cancel text</span>&nbsp;</div></li><li><div><span class="comment">   * @return string The cancellation link</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_cancel_reply_to_link( $text = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Bail if not hierarchical or editing a reply</span>&nbsp;</div></li><li><div>      if ( ! bbp_thread_replies() || bbp_is_reply_edit() ) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set default text</span>&nbsp;</div></li><li><div>      if ( empty( $text ) ) {&nbsp;</div></li><li><div>          $text = __( 'Cancel', 'bbpress' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $reply_to = isset( $_GET['bbp_reply_to'] ) ? (int) $_GET['bbp_reply_to'] : 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set visibility</span>&nbsp;</div></li><li><div>      $style = !empty( $reply_to ) ? '' : ' style=&quot;display:none;&quot;';&nbsp;</div></li><li><div>      $link = remove_query_arg( array( 'bbp_reply_to', '_wpnonce' ) ) . '#post-' . $reply_to;&nbsp;</div></li><li><div>      $retval = '&lt;a rel=&quot;nofollow&quot; id=&quot;bbp-cancel-reply-to-link&quot; href=&quot;' . esc_url( $link ) . '&quot;' . $style . '&gt;' . esc_html( $text ) . '&lt;/a&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_cancel_reply_to_link', $retval, $link, $text );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the numeric position of a reply within a topic</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2984)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $topic_id Optional. Topic id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_position() To get the reply position</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_position( $reply_id = 0, $topic_id = 0 ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_position( $reply_id, $topic_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the numeric position of a reply within a topic</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2984)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $topic_id Optional. Topic id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_topic_id() Get the topic id of the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_reply_count() To get the topic reply count</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_position_raw() To get calculate the reply position</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_update_reply_position() To update the reply position</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_show_lead_topic() Bump the count if lead topic is included</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_position' with the reply</span>&nbsp;</div></li><li><div><span class="comment">   *                        position, reply id and topic id</span>&nbsp;</div></li><li><div><span class="comment">   * @return int Reply position</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_position( $reply_id = 0, $topic_id = 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get required data</span>&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>      $reply_position = get_post_field( 'menu_order', $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Reply doesn't have a position so get the raw value</span>&nbsp;</div></li><li><div>      if ( empty( $reply_position ) ) {&nbsp;</div></li><li><div>          $topic_id = !empty( $topic_id ) ? bbp_get_topic_id( $topic_id ) : bbp_get_reply_topic_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Post is not the topic</span>&nbsp;</div></li><li><div>          if ( $reply_id !== $topic_id ) {&nbsp;</div></li><li><div>              $reply_position = bbp_get_reply_position_raw( $reply_id, $topic_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              <span class="comment">// Update the reply position in the posts table so we'll never have</span>&nbsp;</div></li><li><div>              <span class="comment">// to hit the DB again.</span>&nbsp;</div></li><li><div>              if ( !empty( $reply_position ) ) {&nbsp;</div></li><li><div>                  bbp_update_reply_position( $reply_id, $reply_position );&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Topic's position is always 0</span>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $reply_position = 0;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Bump the position by one if the lead topic is in the replies loop</span>&nbsp;</div></li><li><div>      if ( ! bbp_show_lead_topic() )&nbsp;</div></li><li><div>          $reply_position++;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return (int) apply_filters( 'bbp_get_reply_position', $reply_position, $reply_id, $topic_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Reply Admin Links *********************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output admin links for reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2667)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args See {@link bbp_get_reply_admin_links()}</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_admin_links() To get the reply admin links</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_admin_links( $args = array() ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_admin_links( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return admin links for reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2667)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param array $args This function supports these arguments:</span>&nbsp;</div></li><li><div><span class="comment">   *  - id: Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   *  - before: HTML before the links. Defaults to</span>&nbsp;</div></li><li><div><span class="comment">   *             '&lt;span class=&quot;bbp-admin-links&quot;&gt;'</span>&nbsp;</div></li><li><div><span class="comment">   *  - after: HTML after the links. Defaults to '&lt;/span&gt;'</span>&nbsp;</div></li><li><div><span class="comment">   *  - sep: Separator. Defaults to ' | '</span>&nbsp;</div></li><li><div><span class="comment">   *  - links: Array of the links to display. By default, edit, trash, </span>&nbsp;</div></li><li><div><span class="comment">   *            spam, reply move, and topic split links are displayed</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_topic() To check if it's the topic page</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_reply() To check if it's the reply page</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_edit_link() To get the reply edit link</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_trash_link() To get the reply trash link</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_spam_link() To get the reply spam link</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_move_link() To get the reply move link</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_split_link() To get the topic split link</span>&nbsp;</div></li><li><div><span class="comment">   * @uses current_user_can() To check if the current user can edit or</span>&nbsp;</div></li><li><div><span class="comment">   *                           delete the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_admin_links' with the</span>&nbsp;</div></li><li><div><span class="comment">   *                        reply admin links and args</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Reply admin links</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_admin_links( $args = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Parse arguments against default values</span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $r = bbp_parse_args( $args, array(&nbsp;</div></li><li><div>          'id' =&gt; 0, &nbsp;</div></li><li><div>          'before' =&gt; '&lt;span class=&quot;bbp-admin-links&quot;&gt;', &nbsp;</div></li><li><div>          'after' =&gt; '&lt;/span&gt;', &nbsp;</div></li><li><div>          'sep' =&gt; ' | ', &nbsp;</div></li><li><div>          'links' =&gt; array()&nbsp;</div></li><li><div> ), 'get_reply_admin_links' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $r['id'] = bbp_get_reply_id( (int) $r['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If post is a topic, return the topic admin links instead</span>&nbsp;</div></li><li><div>      if ( bbp_is_topic( $r['id'] ) ) {&nbsp;</div></li><li><div>          return bbp_get_topic_admin_links( $args );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If post is not a reply, return</span>&nbsp;</div></li><li><div>      if ( !bbp_is_reply( $r['id'] ) ) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If topic is trashed, do not show admin links</span>&nbsp;</div></li><li><div>      if ( bbp_is_topic_trash( bbp_get_reply_topic_id( $r['id'] ) ) ) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If no links were passed, default to the standard</span>&nbsp;</div></li><li><div>      if ( empty( $r['links'] ) ) {&nbsp;</div></li><li><div>          $r['links'] = apply_filters( 'bbp_reply_admin_links', array(&nbsp;</div></li><li><div>              'edit' =&gt; bbp_get_reply_edit_link ( $r ), &nbsp;</div></li><li><div>              'move' =&gt; bbp_get_reply_move_link ( $r ), &nbsp;</div></li><li><div>              'split' =&gt; bbp_get_topic_split_link( $r ), &nbsp;</div></li><li><div>              'trash' =&gt; bbp_get_reply_trash_link( $r ), &nbsp;</div></li><li><div>              'spam' =&gt; bbp_get_reply_spam_link ( $r ), &nbsp;</div></li><li><div>              'reply' =&gt; bbp_get_reply_to_link   ( $r )&nbsp;</div></li><li><div> ), $r['id'] );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// See if links need to be unset</span>&nbsp;</div></li><li><div>      $reply_status = bbp_get_reply_status( $r['id'] );&nbsp;</div></li><li><div>      if ( in_array( $reply_status, array( bbp_get_spam_status_id(), bbp_get_trash_status_id() ) ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Spam link shouldn't be visible on trashed topics</span>&nbsp;</div></li><li><div>          if ( bbp_get_trash_status_id() === $reply_status ) {&nbsp;</div></li><li><div>              unset( $r['links']['spam'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Trash link shouldn't be visible on spam topics</span>&nbsp;</div></li><li><div>          } elseif ( bbp_get_spam_status_id() === $reply_status ) {&nbsp;</div></li><li><div>              unset( $r['links']['trash'] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Process the admin links</span></span>&nbsp;</div></li><li><div>      $links = implode( $r['sep'], array_filter( $r['links'] ) );&nbsp;</div></li><li><div>      $retval = $r['before'] . $links . $r['after'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_admin_links', $retval, $r, $args );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the edit link of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2740)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $args See {@link bbp_get_reply_edit_link()}</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_edit_link() To get the reply edit link</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_edit_link( $args = '' ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_edit_link( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the edit link of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2740)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param mixed $args This function supports these arguments:</span>&nbsp;</div></li><li><div><span class="comment">   *  - id: Reply id</span>&nbsp;</div></li><li><div><span class="comment">   *  - link_before: HTML before the link</span>&nbsp;</div></li><li><div><span class="comment">   *  - link_after: HTML after the link</span>&nbsp;</div></li><li><div><span class="comment">   *  - edit_text: Edit text. Defaults to 'Edit'</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply() To get the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses current_user_can() To check if the current user can edit the</span>&nbsp;</div></li><li><div><span class="comment">   *                           reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_edit_url() To get the reply edit url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_edit_link' with the reply</span>&nbsp;</div></li><li><div><span class="comment">   *                        edit link and args</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Reply edit link</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_edit_link( $args = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Parse arguments against default values</span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $r = bbp_parse_args( $args, array(&nbsp;</div></li><li><div>          'id' =&gt; 0, &nbsp;</div></li><li><div>          'link_before' =&gt; '', &nbsp;</div></li><li><div>          'link_after' =&gt; '', &nbsp;</div></li><li><div>          'edit_text' =&gt; esc_html__( 'Edit', 'bbpress' )&nbsp;</div></li><li><div> ), 'get_reply_edit_link' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $reply = bbp_get_reply( bbp_get_reply_id( (int) $r['id'] ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Bypass check if user has caps</span>&nbsp;</div></li><li><div>      if ( !current_user_can( 'edit_others_replies' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// User cannot edit or it is past the lock time</span>&nbsp;</div></li><li><div>          if ( empty( $reply ) || !current_user_can( 'edit_reply', $reply-&gt;ID ) || bbp_past_edit_lock( $reply-&gt;post_date_gmt ) ) {&nbsp;</div></li><li><div>              return;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get uri</span>&nbsp;</div></li><li><div>      $uri = bbp_get_reply_edit_url( $r['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Bail if no uri</span>&nbsp;</div></li><li><div>      if ( empty( $uri ) )&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $retval = $r['link_before'] . '&lt;a href=&quot;' . esc_url( $uri ) . '&quot; class=&quot;bbp-reply-edit-link&quot;&gt;' . $r['edit_text'] . '&lt;/a&gt;' . $r['link_after'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_edit_link', $retval, $r );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output URL to the reply edit page</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2753)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_edit_url() To get the reply edit url</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_edit_url( $reply_id = 0 ) {&nbsp;</div></li><li><div>  echo esc_url( bbp_get_reply_edit_url( $reply_id ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return URL to the reply edit page</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2753)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply() To get the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_post_type() To get the reply post type</span>&nbsp;</div></li><li><div><span class="comment">   * @uses add_query_arg() To add custom args to the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_edit_url' with the edit</span>&nbsp;</div></li><li><div><span class="comment">   *                        url and reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Reply edit url</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_edit_url( $reply_id = 0 ) {&nbsp;</div></li><li><div>      global $wp_rewrite;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $bbp = bbpress();&nbsp;</div></li><li><div>      $reply = bbp_get_reply( bbp_get_reply_id( $reply_id ) );&nbsp;</div></li><li><div>      if ( empty( $reply ) )&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $reply_link = bbp_remove_view_all( bbp_get_reply_permalink( $reply_id ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Pretty permalinks</span></span>&nbsp;</div></li><li><div>      if ( $wp_rewrite-&gt;using_permalinks() ) {&nbsp;</div></li><li><div>          $url = trailingslashit( $reply_link ) . $bbp-&gt;edit_id;&nbsp;</div></li><li><div>          $url = trailingslashit( $url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Unpretty permalinks</span></span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $url = add_query_arg( array( bbp_get_reply_post_type() =&gt; $reply-&gt;post_name, $bbp-&gt;edit_id =&gt; '1' ), $reply_link );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Maybe add view all</span>&nbsp;</div></li><li><div>      $url = bbp_add_view_all( $url );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_edit_url', $url, $reply_id );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the trash link of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2740)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $args See {@link bbp_get_reply_trash_link()}</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_trash_link() To get the reply trash link</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_trash_link( $args = '' ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_trash_link( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the trash link of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2740)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param mixed $args This function supports these arguments:</span>&nbsp;</div></li><li><div><span class="comment">   *  - id: Reply id</span>&nbsp;</div></li><li><div><span class="comment">   *  - link_before: HTML before the link</span>&nbsp;</div></li><li><div><span class="comment">   *  - link_after: HTML after the link</span>&nbsp;</div></li><li><div><span class="comment">   *  - sep: Separator</span>&nbsp;</div></li><li><div><span class="comment">   *  - trash_text: Trash text</span>&nbsp;</div></li><li><div><span class="comment">   *  - restore_text: Restore text</span>&nbsp;</div></li><li><div><span class="comment">   *  - delete_text: Delete text</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply() To get the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses current_user_can() To check if the current user can delete the</span>&nbsp;</div></li><li><div><span class="comment">   *                           reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_reply_trash() To check if the reply is trashed</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_status() To get the reply status</span>&nbsp;</div></li><li><div><span class="comment">   * @uses add_query_arg() To add custom args to the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses wp_nonce_url() To nonce the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses esc_url() To escape the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_edit_url() To get the reply edit url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_trash_link' with the reply</span>&nbsp;</div></li><li><div><span class="comment">   *                        trash link and args</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Reply trash link</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_trash_link( $args = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Parse arguments against default values</span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $r = bbp_parse_args( $args, array(&nbsp;</div></li><li><div>          'id' =&gt; 0, &nbsp;</div></li><li><div>          'link_before' =&gt; '', &nbsp;</div></li><li><div>          'link_after' =&gt; '', &nbsp;</div></li><li><div>          'sep' =&gt; ' | ', &nbsp;</div></li><li><div>          'trash_text' =&gt; esc_html__( 'Trash', 'bbpress' ), &nbsp;</div></li><li><div>          'restore_text' =&gt; esc_html__( 'Restore', 'bbpress' ), &nbsp;</div></li><li><div>          'delete_text' =&gt; esc_html__( 'Delete', 'bbpress' )&nbsp;</div></li><li><div> ), 'get_reply_trash_link' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $actions = array();&nbsp;</div></li><li><div>      $reply = bbp_get_reply( bbp_get_reply_id( (int) $r['id'] ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $reply ) || !current_user_can( 'delete_reply', $reply-&gt;ID ) ) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( bbp_is_reply_trash( $reply-&gt;ID ) ) {&nbsp;</div></li><li><div>          $actions['untrash'] = '&lt;a title=&quot;' . esc_attr__( 'Restore this item from the Trash', 'bbpress' ) . '&quot; href=&quot;' . esc_url( wp_nonce_url( add_query_arg( array( 'action' =&gt; 'bbp_toggle_reply_trash', 'sub_action' =&gt; 'untrash', 'reply_id' =&gt; $reply-&gt;ID ) ), 'untrash-' . $reply-&gt;post_type . '_' . $reply-&gt;ID ) ) . '&quot; class=&quot;bbp-reply-restore-link&quot;&gt;' . $r['restore_text'] . '&lt;/a&gt;';&nbsp;</div></li><li><div>      } elseif ( EMPTY_TRASH_DAYS ) {&nbsp;</div></li><li><div>          $actions['trash'] = '&lt;a title=&quot;' . esc_attr__( 'Move this item to the Trash', 'bbpress' ) . '&quot; href=&quot;' . esc_url( wp_nonce_url( add_query_arg( array( 'action' =&gt; 'bbp_toggle_reply_trash', 'sub_action' =&gt; 'trash', 'reply_id' =&gt; $reply-&gt;ID ) ), 'trash-'   . $reply-&gt;post_type . '_' . $reply-&gt;ID ) ) . '&quot; class=&quot;bbp-reply-trash-link&quot;&gt;'   . $r['trash_text']   . '&lt;/a&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( bbp_is_reply_trash( $reply-&gt;ID ) || !EMPTY_TRASH_DAYS ) {&nbsp;</div></li><li><div>          $actions['delete'] = '&lt;a title=&quot;' . esc_attr__( 'Delete this item permanently', 'bbpress' ) . '&quot; href=&quot;' . esc_url( wp_nonce_url( add_query_arg( array( 'action' =&gt; 'bbp_toggle_reply_trash', 'sub_action' =&gt; 'delete', 'reply_id' =&gt; $reply-&gt;ID ) ), 'delete-'  . $reply-&gt;post_type . '_' . $reply-&gt;ID ) ) . '&quot; onclick=&quot;return confirm(\'' . esc_js( __( 'Are you sure you want to delete that permanently?', 'bbpress' ) ) . '\' );&quot; class=&quot;bbp-reply-delete-link&quot;&gt;' . $r['delete_text'] . '&lt;/a&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment">// Process the admin links</span></span>&nbsp;</div></li><li><div>      $retval = $r['link_before'] . implode( $r['sep'], $actions ) . $r['link_after'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_trash_link', $retval, $r );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the spam link of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2740)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $args See {@link bbp_get_reply_spam_link()}</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_spam_link() To get the reply spam link</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_spam_link( $args = '' ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_spam_link( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the spam link of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2740)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param mixed $args This function supports these arguments:</span>&nbsp;</div></li><li><div><span class="comment">   *  - id: Reply id</span>&nbsp;</div></li><li><div><span class="comment">   *  - link_before: HTML before the link</span>&nbsp;</div></li><li><div><span class="comment">   *  - link_after: HTML after the link</span>&nbsp;</div></li><li><div><span class="comment">   *  - spam_text: Spam text</span>&nbsp;</div></li><li><div><span class="comment">   *  - unspam_text: Unspam text</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply() To get the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses current_user_can() To check if the current user can edit the</span>&nbsp;</div></li><li><div><span class="comment">   *                           reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_reply_spam() To check if the reply is marked as spam</span>&nbsp;</div></li><li><div><span class="comment">   * @uses add_query_arg() To add custom args to the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses wp_nonce_url() To nonce the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses esc_url() To escape the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_edit_url() To get the reply edit url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_spam_link' with the reply</span>&nbsp;</div></li><li><div><span class="comment">   *                        spam link and args</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Reply spam link</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_spam_link( $args = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Parse arguments against default values</span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $r = bbp_parse_args( $args, array(&nbsp;</div></li><li><div>          'id' =&gt; 0, &nbsp;</div></li><li><div>          'link_before' =&gt; '', &nbsp;</div></li><li><div>          'link_after' =&gt; '', &nbsp;</div></li><li><div>          'spam_text' =&gt; esc_html__( 'Spam', 'bbpress' ), &nbsp;</div></li><li><div>          'unspam_text' =&gt; esc_html__( 'Unspam', 'bbpress' )&nbsp;</div></li><li><div> ), 'get_reply_spam_link' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $reply = bbp_get_reply( bbp_get_reply_id( (int) $r['id'] ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $reply ) || !current_user_can( 'moderate', $reply-&gt;ID ) )&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $display = bbp_is_reply_spam( $reply-&gt;ID ) ? $r['unspam_text'] : $r['spam_text'];&nbsp;</div></li><li><div>      $uri = add_query_arg( array( 'action' =&gt; 'bbp_toggle_reply_spam', 'reply_id' =&gt; $reply-&gt;ID ) );&nbsp;</div></li><li><div>      $uri = wp_nonce_url( $uri, 'spam-reply_' . $reply-&gt;ID );&nbsp;</div></li><li><div>      $retval = $r['link_before'] . '&lt;a href=&quot;' . esc_url( $uri ) . '&quot; class=&quot;bbp-reply-spam-link&quot;&gt;' . $display . '&lt;/a&gt;' . $r['link_after'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_spam_link', $retval, $r );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Move reply link</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Output the move link of the reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4521)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $args See {@link bbp_get_reply_move_link()}</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_move_link() To get the reply move link</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_move_link( $args = '' ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_move_link( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get move reply link</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Return the move link of the reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r4521)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param mixed $args This function supports these arguments:</span>&nbsp;</div></li><li><div><span class="comment">   *  - id: Reply id</span>&nbsp;</div></li><li><div><span class="comment">   *  - link_before: HTML before the link</span>&nbsp;</div></li><li><div><span class="comment">   *  - link_after: HTML after the link</span>&nbsp;</div></li><li><div><span class="comment">   *  - move_text: Move text</span>&nbsp;</div></li><li><div><span class="comment">   *  - move_title: Move title attribute</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply() To get the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses current_user_can() To check if the current user can edit the</span>&nbsp;</div></li><li><div><span class="comment">   *                           topic</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_topic_id() To get the reply topic id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_edit_url() To get the reply edit url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses add_query_arg() To add custom args to the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses wp_nonce_url() To nonce the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses esc_url() To escape the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_move_link' with the reply</span>&nbsp;</div></li><li><div><span class="comment">   *                        move link and args</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Reply move link</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_move_link( $args = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Parse arguments against default values</span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $r = bbp_parse_args( $args, array(&nbsp;</div></li><li><div>          'id' =&gt; 0, &nbsp;</div></li><li><div>          'link_before' =&gt; '', &nbsp;</div></li><li><div>          'link_after' =&gt; '', &nbsp;</div></li><li><div>          'split_text' =&gt; esc_html__( 'Move', 'bbpress' ), &nbsp;</div></li><li><div>          'split_title' =&gt; esc_attr__( 'Move this reply', 'bbpress' )&nbsp;</div></li><li><div> ), 'get_reply_move_link' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $r['id'] );&nbsp;</div></li><li><div>      $topic_id = bbp_get_reply_topic_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $reply_id ) || !current_user_can( 'moderate', $topic_id ) )&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $uri = add_query_arg( array(&nbsp;</div></li><li><div>          'action' =&gt; 'move', &nbsp;</div></li><li><div>          'reply_id' =&gt; $reply_id&nbsp;</div></li><li><div> ), bbp_get_reply_edit_url( $reply_id ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $retval = $r['link_before'] . '&lt;a href=&quot;' . esc_url( $uri ) . '&quot; title=&quot;' . $r['split_title'] . '&quot; class=&quot;bbp-reply-move-link&quot;&gt;' . $r['split_text'] . '&lt;/a&gt;' . $r['link_after'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_reply_move_link', $retval, $r );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Split topic link</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Output the split link of the topic (but is bundled with each reply)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2756)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param mixed $args See {@link bbp_get_topic_split_link()}</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_topic_split_link() To get the topic split link</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_topic_split_link( $args = '' ) {&nbsp;</div></li><li><div>  echo bbp_get_topic_split_link( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Get split topic link</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * Return the split link of the topic (but is bundled with each reply)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2756)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param mixed $args This function supports these arguments:</span>&nbsp;</div></li><li><div><span class="comment">   *  - id: Reply id</span>&nbsp;</div></li><li><div><span class="comment">   *  - link_before: HTML before the link</span>&nbsp;</div></li><li><div><span class="comment">   *  - link_after: HTML after the link</span>&nbsp;</div></li><li><div><span class="comment">   *  - split_text: Split text</span>&nbsp;</div></li><li><div><span class="comment">   *  - split_title: Split title attribute</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To get the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply() To get the reply</span>&nbsp;</div></li><li><div><span class="comment">   * @uses current_user_can() To check if the current user can edit the</span>&nbsp;</div></li><li><div><span class="comment">   *                           topic</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_topic_id() To get the reply topic id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_topic_edit_url() To get the topic edit url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses add_query_arg() To add custom args to the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses wp_nonce_url() To nonce the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses esc_url() To escape the url</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_topic_split_link' with the topic</span>&nbsp;</div></li><li><div><span class="comment">   *                        split link and args</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Topic split link</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_topic_split_link( $args = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment"><span class="comment">// Parse arguments against default values</span></span></span></span></span></span></span></span></span></span>&nbsp;</div></li><li><div>      $r = bbp_parse_args( $args, array(&nbsp;</div></li><li><div>          'id' =&gt; 0, &nbsp;</div></li><li><div>          'link_before' =&gt; '', &nbsp;</div></li><li><div>          'link_after' =&gt; '', &nbsp;</div></li><li><div>          'split_text' =&gt; esc_html__( 'Split', 'bbpress' ), &nbsp;</div></li><li><div>          'split_title' =&gt; esc_attr__( 'Split the topic from this reply', 'bbpress' )&nbsp;</div></li><li><div> ), 'get_topic_split_link' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $r['id'] );&nbsp;</div></li><li><div>      $topic_id = bbp_get_reply_topic_id( $reply_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $reply_id ) || !current_user_can( 'moderate', $topic_id ) )&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $uri =  add_query_arg( array(&nbsp;</div></li><li><div>          'action' =&gt; 'split', &nbsp;</div></li><li><div>          'reply_id' =&gt; $reply_id&nbsp;</div></li><li><div> ), bbp_get_topic_edit_url( $topic_id ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $retval = $r['link_before'] . '&lt;a href=&quot;' . esc_url( $uri ) . '&quot; title=&quot;' . $r['split_title'] . '&quot; class=&quot;bbp-topic-split-link&quot;&gt;' . $r['split_text'] . '&lt;/a&gt;' . $r['link_after'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_topic_split_link', $retval, $r );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the row class of a reply</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2678)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $reply_id Optional. Reply ID</span>&nbsp;</div></li><li><div><span class="comment"> * @param array Extra classes you can pass when calling this function</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_reply_class() To get the reply class</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_reply_class( $reply_id = 0, $classes = array() ) {&nbsp;</div></li><li><div>  echo bbp_get_reply_class( $reply_id, $classes );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the row class of a reply</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2678)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @param int $reply_id Optional. Reply ID</span>&nbsp;</div></li><li><div><span class="comment">   * @param array Extra classes you can pass when calling this function</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To validate the reply id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_forum_id() To get the reply's forum id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_topic_id() To get the reply's topic id</span>&nbsp;</div></li><li><div><span class="comment">   * @uses get_post_class() To get all the classes including ours</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_reply_class' with the classes</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Row class of the reply</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_reply_class( $reply_id = 0, $classes = array() ) {&nbsp;</div></li><li><div>      $bbp = bbpress();&nbsp;</div></li><li><div>      $reply_id = bbp_get_reply_id( $reply_id );&nbsp;</div></li><li><div>      $count = isset( $bbp-&gt;reply_query-&gt;current_post ) ? $bbp-&gt;reply_query-&gt;current_post : 1;&nbsp;</div></li><li><div>      $classes = (array) $classes;&nbsp;</div></li><li><div>      $classes[] = ( (int) $count % 2 ) ? 'even' : 'odd';&nbsp;</div></li><li><div>      $classes[] = 'bbp-parent-forum-'   . bbp_get_reply_forum_id( $reply_id );&nbsp;</div></li><li><div>      $classes[] = 'bbp-parent-topic-'   . bbp_get_reply_topic_id( $reply_id );&nbsp;</div></li><li><div>      $classes[] = 'bbp-reply-position-' . bbp_get_reply_position( $reply_id );&nbsp;</div></li><li><div>      $classes[] = 'user-id-' . bbp_get_reply_author_id( $reply_id );&nbsp;</div></li><li><div>      $classes[] = ( bbp_get_reply_author_id( $reply_id ) === bbp_get_topic_author_id( bbp_get_reply_topic_id( $reply_id ) ) ? 'topic-author' : '' );&nbsp;</div></li><li><div>      $classes = array_filter( $classes );&nbsp;</div></li><li><div>      $classes = get_post_class( $classes, $reply_id );&nbsp;</div></li><li><div>      $classes = apply_filters( 'bbp_get_reply_class', $classes, $reply_id );&nbsp;</div></li><li><div>      $retval = 'class=&quot;' . implode( ' ', $classes ) . '&quot;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $retval;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the topic pagination count</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2519)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_topic_pagination_count() To get the topic pagination count</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_topic_pagination_count() {&nbsp;</div></li><li><div>  echo bbp_get_topic_pagination_count();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the topic pagination count</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2519)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_number_format() To format the number value</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_show_lead_topic() Are we showing the topic as a lead?</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_topic_pagination_count' with the</span>&nbsp;</div></li><li><div><span class="comment">   *                        pagination count</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Topic pagination count</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_topic_pagination_count() {&nbsp;</div></li><li><div>      $bbp = bbpress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Define local variable(s)</span>&nbsp;</div></li><li><div>      $retstr = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set pagination values</span>&nbsp;</div></li><li><div>      $start_num = intval( ( $bbp-&gt;reply_query-&gt;paged - 1 ) * $bbp-&gt;reply_query-&gt;posts_per_page ) + 1;&nbsp;</div></li><li><div>      $from_num = bbp_number_format( $start_num );&nbsp;</div></li><li><div>      $to_num = bbp_number_format( ( $start_num + ( $bbp-&gt;reply_query-&gt;posts_per_page - 1 ) &gt; $bbp-&gt;reply_query-&gt;found_posts ) ? $bbp-&gt;reply_query-&gt;found_posts : $start_num + ( $bbp-&gt;reply_query-&gt;posts_per_page - 1 ) );&nbsp;</div></li><li><div>      $total_int = (int) $bbp-&gt;reply_query-&gt;found_posts;&nbsp;</div></li><li><div>      $total = bbp_number_format( $total_int );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// We are threading replies</span>&nbsp;</div></li><li><div>      if ( bbp_thread_replies() && bbp_is_single_topic() ) {&nbsp;</div></li><li><div>          return;&nbsp;</div></li><li><div>          $walker = new BBP_Walker_Reply;&nbsp;</div></li><li><div>          $threads = (int) $walker-&gt;get_number_of_root_elements( $bbp-&gt;reply_query-&gt;posts );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Adjust for topic</span>&nbsp;</div></li><li><div>          $threads--;&nbsp;</div></li><li><div>          $retstr = sprintf( _n( 'Viewing %1$s reply thread', 'Viewing %1$s reply threads', $threads, 'bbbpress' ), bbp_number_format( $threads ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// We are not including the lead topic</span>&nbsp;</div></li><li><div>      } elseif ( bbp_show_lead_topic() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Several replies in a topic with a single page</span>&nbsp;</div></li><li><div>          if ( empty( $to_num ) ) {&nbsp;</div></li><li><div>              $retstr = sprintf( _n( 'Viewing %1$s reply', 'Viewing %1$s replies', $total_int, 'bbpress' ), $total );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Several replies in a topic with several pages</span>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $retstr = sprintf( _n( 'Viewing %2$s replies (of %4$s total)', 'Viewing %1$s replies - %2$s through %3$s (of %4$s total)', $bbp-&gt;reply_query-&gt;post_count, 'bbpress' ), $bbp-&gt;reply_query-&gt;post_count, $from_num, $to_num, $total );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// We are including the lead topic</span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Several posts in a topic with a single page</span>&nbsp;</div></li><li><div>          if ( empty( $to_num ) ) {&nbsp;</div></li><li><div>              $retstr = sprintf( _n( 'Viewing %1$s post', 'Viewing %1$s posts', $total_int, 'bbpress' ), $total );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Several posts in a topic with several pages</span>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $retstr = sprintf( _n( 'Viewing %2$s post (of %4$s total)', 'Viewing %1$s posts - %2$s through %3$s (of %4$s total)', $bbp-&gt;reply_query-&gt;post_count, 'bbpress' ), $bbp-&gt;reply_query-&gt;post_count, $from_num, $to_num, $total );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Filter and return</span>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_topic_pagination_count', esc_html( $retstr ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output topic pagination links</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r2519)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_topic_pagination_links() To get the topic pagination links</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_topic_pagination_links() {&nbsp;</div></li><li><div>  echo bbp_get_topic_pagination_links();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return topic pagination links</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r2519)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_topic_pagination_links' with the</span>&nbsp;</div></li><li><div><span class="comment">   *                        pagination links</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Topic pagination links</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_topic_pagination_links() {&nbsp;</div></li><li><div>      $bbp = bbpress();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( !isset( $bbp-&gt;reply_query-&gt;pagination_links ) || empty( $bbp-&gt;reply_query-&gt;pagination_links ) )&nbsp;</div></li><li><div>          return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_topic_pagination_links', $bbp-&gt;reply_query-&gt;pagination_links );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** Forms *********************************************************************/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the value of reply content field</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r31301)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_form_reply_content() To get value of reply content field</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_form_reply_content() {&nbsp;</div></li><li><div>  echo bbp_get_form_reply_content();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the value of reply content field</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r31301)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_is_reply_edit() To check if it's the reply edit page</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_form_reply_content' with the content</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Value of reply content field</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_form_reply_content() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// Get _POST data</span></span></span>&nbsp;</div></li><li><div>      if ( bbp_is_post_request() && isset( $_POST['bbp_reply_content'] ) ) {&nbsp;</div></li><li><div>          $reply_content = stripslashes( $_POST['bbp_reply_content'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get edit data</span>&nbsp;</div></li><li><div>      } elseif ( bbp_is_reply_edit() ) {&nbsp;</div></li><li><div>          $reply_content = bbp_get_global_post_field( 'post_content', 'raw' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// No data</span></span></span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $reply_content = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_form_reply_content', $reply_content );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the value of the reply to field</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r4944)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_form_reply_to() To get value of the reply to field</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_form_reply_to() {&nbsp;</div></li><li><div>  echo bbp_get_form_reply_to();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the value of reply to field</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r4944)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses bbp_get_reply_id() To validate the reply to</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_form_reply_to' with the reply to</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Value of reply to field</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_form_reply_to() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Set initial value</span>&nbsp;</div></li><li><div>      $reply_to = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Get $_REQUEST data</span>&nbsp;</div></li><li><div>      if ( isset( $_REQUEST['bbp_reply_to'] ) ) {&nbsp;</div></li><li><div>          $reply_to = bbp_validate_reply_to( $_REQUEST['bbp_reply_to'] );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// If empty, get from meta</span>&nbsp;</div></li><li><div>      if ( empty( $reply_to ) ) {&nbsp;</div></li><li><div>          $reply_to = bbp_get_reply_to();&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return (int) apply_filters( 'bbp_get_form_reply_to', $reply_to );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output checked value of reply log edit field</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r31301)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_form_reply_log_edit() To get the reply log edit value</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_form_reply_log_edit() {&nbsp;</div></li><li><div>  echo bbp_get_form_reply_log_edit();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return checked value of reply log edit field</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r31301)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_form_reply_log_edit' with the</span>&nbsp;</div></li><li><div><span class="comment">   *                        log edit value</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Reply log edit checked value</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_form_reply_log_edit() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// Get _POST data</span></span></span>&nbsp;</div></li><li><div>      if ( bbp_is_post_request() && isset( $_POST['bbp_log_reply_edit'] ) ) {&nbsp;</div></li><li><div>          $reply_revision = $_POST['bbp_log_reply_edit'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// No data</span></span></span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $reply_revision = 1;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_form_reply_log_edit', checked( $reply_revision, true, false ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Output the value of the reply edit reason</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since bbPress (r31301)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @uses bbp_get_form_reply_edit_reason() To get the reply edit reason value</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function bbp_form_reply_edit_reason() {&nbsp;</div></li><li><div>  echo bbp_get_form_reply_edit_reason();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * Return the value of the reply edit reason</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @since bbPress (r31301)</span>&nbsp;</div></li><li><div><span class="comment">   *</span>&nbsp;</div></li><li><div><span class="comment">   * @uses apply_filters() Calls 'bbp_get_form_reply_edit_reason' with the</span>&nbsp;</div></li><li><div><span class="comment">   *                        reply edit reason value</span>&nbsp;</div></li><li><div><span class="comment">   * @return string Reply edit reason value</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  function bbp_get_form_reply_edit_reason() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// Get _POST data</span></span></span>&nbsp;</div></li><li><div>      if ( bbp_is_post_request() && isset( $_POST['bbp_reply_edit_reason'] ) ) {&nbsp;</div></li><li><div>          $reply_edit_reason = $_POST['bbp_reply_edit_reason'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment"><span class="comment"><span class="comment">// No data</span></span></span>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $reply_edit_reason = '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return apply_filters( 'bbp_get_form_reply_edit_reason', esc_attr( $reply_edit_reason ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>bbPress</li><li><span></span>2.5.9</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2019 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>