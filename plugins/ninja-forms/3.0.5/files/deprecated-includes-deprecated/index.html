<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="3.0.5" data-slug="ninja-forms" data-type="file" data-id="38078"><head xmlns="http://www.w3.org/1999/xhtml"><title> deprecated-includes-deprecated | file | Ninja Forms | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, ninja-forms, 3.0.5" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=6e3584c203ea58d11f9cdbb4cc34e2cb' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/deprecated-includes-deprecated/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fdeprecated-includes-deprecated%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fdeprecated-includes-deprecated%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-ninja-forms-3.0.5-file-deprecated-includes-deprecated","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="deprecated-includes-deprecated" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to ninja-forms." href="http://hookr.io/plugins/ninja-forms/" class="plugin"><span property="name">ninja-forms</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 3.0.5." href="http://hookr.io/plugins/ninja-forms/3.0.5/" class="H_VERSION"><span property="name">3.0.5</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/ninja-forms/3.0.5/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">deprecated-includes-deprecated</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="1262"><a href="http://hookr.io/plugins/ninja-forms/3.0.5/all/" title="All">All <span class="count badge">1262</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/ninja-forms/3.0.5/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="528"><a href="http://hookr.io/plugins/ninja-forms/3.0.5/hooks/" title="Hooks">Hooks <span class="count badge">528</span></a></li><li class="" data-id="action" data-count="120"><a href="http://hookr.io/plugins/ninja-forms/3.0.5/actions/" title="Actions">Actions <span class="count badge">120</span></a></li><li class="" data-id="filter" data-count="408"><a href="http://hookr.io/plugins/ninja-forms/3.0.5/filters/" title="Filters">Filters <span class="count badge">408</span></a></li><li class="" data-id="class" data-count="178"><a href="http://hookr.io/plugins/ninja-forms/3.0.5/classes/" title="Classes">Classes <span class="count badge">178</span></a></li><li class="" data-id="constant" data-count="31"><a href="http://hookr.io/plugins/ninja-forms/3.0.5/constants/" title="Constants">Constants <span class="count badge">31</span></a></li><li class="" data-id="function" data-count="511"><a href="http://hookr.io/plugins/ninja-forms/3.0.5/functions/" title="Functions">Functions <span class="count badge">511</span></a></li><li class="" data-id="shortcode" data-count="14"><a href="http://hookr.io/plugins/ninja-forms/3.0.5/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">14</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/deprecated/includes/deprecated.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php if ( ! defined( 'ABSPATH' ) ) exit;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Deprecated as of version 2.7.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Hook into our new save sub filter to add any deprecated filters</span>&nbsp;</div></li><li><div>function nf_old_save_sub_filter( $user_value, $field_id ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_save_sub', $user_value, $field_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_save_sub_user_value', 'nf_old_save_sub_filter', 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Hook into our new nf_save_sub action and add any actions hooked into our old action hooks.</span>&nbsp;</div></li><li><div>function nf_old_save_sub_action( $sub_id ) {&nbsp;</div></li><li><div>  do_action( 'ninja_forms_insert_sub', $sub_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action( 'nf_save_sub', 'nf_old_save_sub_action' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Hook into our new submissions CSV filename filter.</span>&nbsp;</div></li><li><div>function nf_old_subs_csv_filename( $filename ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_export_subs_csv_file_name', $filename );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_subs_csv_filename', 'nf_old_subs_csv_filename' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Hook into our new submissions CSV label filter.</span>&nbsp;</div></li><li><div>function nf_old_subs_csv_label( $label, $field_id ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_export_sub_label', $label, $field_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_subs_csv_field_label', 'nf_old_subs_csv_label', 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Hook into our new submissions CSV label array filter.</span>&nbsp;</div></li><li><div>function nf_old_subs_csv_label_array( $label_array, $sub_ids ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_export_subs_label_array', $label_array, $sub_ids );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_subs_csv_label_array', 'nf_old_subs_csv_label_array', 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Hook into our new submissions CSV pre_value filter.</span>&nbsp;</div></li><li><div>function nf_old_subs_csv_pre_value( $user_value, $field_id ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_export_sub_pre_value', $user_value, $field_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_subs_export_pre_value', 'nf_old_subs_csv_pre_value', 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Hook into our new submissions CSV value filter.</span>&nbsp;</div></li><li><div>function nf_old_subs_csv_value( $user_value, $field_id ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_export_sub_value', $user_value, $field_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_subs_csv_field_value', 'nf_old_subs_csv_value', 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Hook into our new submissions CSV value array filter.</span>&nbsp;</div></li><li><div>function nf_old_subs_csv_value_array( $values_array, $sub_ids ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_export_subs_value_array', $values_array, $sub_ids );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_subs_csv_value_array', 'nf_old_subs_csv_value_array', 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Hook into our new CSV BOM filter</span>&nbsp;</div></li><li><div>function nf_old_subs_csv_bom( $bom ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_csv_bom', $bom );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_sub_csv_bom', 'nf_old_subs_csv_bom' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Hook into our new CSV delimiter filter</span>&nbsp;</div></li><li><div>function nf_old_subs_csv_delimiter( $delimiter ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_csv_delimiter', $delimiter );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_sub_csv_delimiter', 'nf_old_subs_csv_delimiter' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Hook into our new CSV enclosure filter</span>&nbsp;</div></li><li><div>function nf_old_subs_csv_enclosure( $enclosure ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_csv_enclosure', $enclosure );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_sub_csv_enclosure', 'nf_old_subs_csv_enclosure' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Hook into our new CSV terminator filter</span>&nbsp;</div></li><li><div>function nf_old_subs_csv_terminator( $terminator ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_csv_terminator', $terminator );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_sub_csv_terminator', 'nf_old_subs_csv_terminator' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Hook into our new Submissions table row-actions filter</span>&nbsp;</div></li><li><div>function nf_old_subs_table_row_actions_filter( $actions, $sub_id, $form_id ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_sub_table_row_actions', array(), false, $sub_id, $form_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_sub_table_row_actions', 'nf_old_subs_table_row_actions_filter', 10, 3 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * ninja_forms_get_subs() has been deprecated in favour of Ninja_Forms()-&gt;subs()-&gt;get( $args ) or Ninja_Forms()-&gt;form( 23 )-&gt;get_subs( $args )</span>&nbsp;</div></li><li><div><span class="comment"> * You can also use WordPress queries , since this is a custom post type.</span>&nbsp;</div></li><li><div><span class="comment"> * </span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function ninja_forms_get_subs( $args = array() ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $plugin_settings = nf_get_settings();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset ( $plugin_settings['date_format'] ) ) {&nbsp;</div></li><li><div>      $date_format = $plugin_settings['date_format'];&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $date_format = 'm/d/Y';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( is_array( $args ) AND ! empty( $args ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $subs_results = array();&nbsp;</div></li><li><div>      $meta_query = array();&nbsp;</div></li><li><div>      $date_query = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if( isset( $args['form_id'] ) ) {&nbsp;</div></li><li><div>          $meta_query[] = array(&nbsp;</div></li><li><div>              'key' =&gt; '_form_id', &nbsp;</div></li><li><div>              'value' =&gt; $args['form_id'], &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if( isset( $args['action'])) {&nbsp;</div></li><li><div>          $meta_query[] = array(&nbsp;</div></li><li><div>              'key' =&gt; '_action', &nbsp;</div></li><li><div>              'value' =&gt; $args['action'], &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      $query_args = array(&nbsp;</div></li><li><div>          'post_type' =&gt; 'nf_sub', &nbsp;</div></li><li><div>          'date_query' =&gt; $date_query, &nbsp;</div></li><li><div>          'meta_query' =&gt; $meta_query, &nbsp;</div></li><li><div>          'posts_per_page' =&gt; -1, &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if( isset( $args['user_id'] ) ) {&nbsp;</div></li><li><div>          $query_args['author'] = $args['user_id'];&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if( isset( $args['begin_date'] ) AND $args['begin_date'] != '') {&nbsp;</div></li><li><div>          $query_args['date_query']['after'] = nf_get_begin_date( $args['begin_date'] )-&gt;format(&quot;Y-m-d G:i:s&quot;);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if( isset( $args['end_date'] ) AND $args['end_date'] != '' ) {&nbsp;</div></li><li><div>          $query_args['date_query']['before'] = nf_get_end_date( $args['end_date'] )-&gt;format(&quot;Y-m-d G:i:s&quot;);&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $subs = get_posts( $query_args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_array( $subs ) && ! empty( $subs ) ) {&nbsp;</div></li><li><div>          $x = 0;&nbsp;</div></li><li><div>          foreach ( $subs as $sub ) {&nbsp;</div></li><li><div>              $data = array();&nbsp;</div></li><li><div>              $subs_results[$x]['id'] = $sub-&gt;ID;&nbsp;</div></li><li><div>              $subs_results[$x]['user_id'] = $sub-&gt;post_author;&nbsp;</div></li><li><div>              $subs_results[$x]['form_id'] = get_post_meta( $sub-&gt;ID, '_form_id' );&nbsp;</div></li><li><div>              $subs_results[$x]['action'] = get_post_meta( $sub-&gt;ID, '_action' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $meta = get_post_custom( $sub-&gt;ID );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              foreach ( $meta as $key =&gt; $array ) {&nbsp;</div></li><li><div>                  if ( strpos( $key, '_field_' ) !== false ) {&nbsp;</div></li><li><div>                      $field_id = str_replace( '_field_', '', $key );&nbsp;</div></li><li><div>                      $user_value = $array[0];&nbsp;</div></li><li><div>                      $data[] = array( 'field_id' =&gt; $field_id, 'user_value' =&gt; $user_value );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $subs_results[$x]['data'] = $data;&nbsp;</div></li><li><div>              $subs_results[$x]['date_updated'] = $sub-&gt;post_modified;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $x++;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $subs_results;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * ninja_forms_get_sub_count() has been deprecated in favour of Ninja_Forms()-&gt;form( 23 )-&gt;sub_count or nf_get_sub_count()</span>&nbsp;</div></li><li><div><span class="comment"> * Function that returns a count of the number of submissions.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function ninja_forms_get_sub_count( $args = array() ) {&nbsp;</div></li><li><div>  return count( ninja_forms_get_subs( $args ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * ninja_forms_get_sub_by_id( $sub_id ) has been deprecated in favour of Ninja_Forms()-&gt;sub( 23 );</span>&nbsp;</div></li><li><div><span class="comment"> * </span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function ninja_forms_get_sub_by_id( $sub_id ) {&nbsp;</div></li><li><div>  $sub = Ninja_Forms()-&gt;sub( $sub_id );&nbsp;</div></li><li><div>  if ( $sub ) {&nbsp;</div></li><li><div>      $sub_row = array();&nbsp;</div></li><li><div>      $data = array();&nbsp;</div></li><li><div>      $sub_row['id'] = $sub_id;&nbsp;</div></li><li><div>      $sub_row['user_id'] = $sub-&gt;user_id;&nbsp;</div></li><li><div>      $sub_row['form_id'] = $sub-&gt;form_id;&nbsp;</div></li><li><div>      $sub_row['action'] = $sub-&gt;action;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $sub-&gt;action == 'submit' ) {&nbsp;</div></li><li><div>          $sub_row['status'] = 1;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $sub_row['status'] = 0;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $meta = get_post_custom( $sub_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $meta as $key =&gt; $array ) {&nbsp;</div></li><li><div>          if ( strpos( $key, '_field_' ) !== false ) {&nbsp;</div></li><li><div>              $field_id = str_replace( '_field_', '', $key );&nbsp;</div></li><li><div>              $user_value = is_serialized( $array[0] ) ? unserialize( $array[0] ) : $array[0];&nbsp;</div></li><li><div>              $data[] = array( 'field_id' =&gt; $field_id, 'user_value' =&gt; $user_value );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $sub_row['data'] = $data;&nbsp;</div></li><li><div>      $sub_row['date_updated'] = $sub-&gt;date_submitted;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      return $sub_row;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * ninja_forms_get_all_subs() has been deprecated in favour of Ninja_Forms()-&gt;subs()-&gt;get();</span>&nbsp;</div></li><li><div><span class="comment"> * </span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div> function ninja_forms_get_all_subs( $form_id = '' ) {&nbsp;</div></li><li><div>  if ( $form_id == '' )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $args = array( 'form_id' =&gt; $form_id );&nbsp;</div></li><li><div>  return ninja_forms_get_subs( $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * ninja_forms_insert_sub() has been deprecated in favour of Ninja_Forms()-&gt;subs()-&gt;create( $form_id );</span>&nbsp;</div></li><li><div><span class="comment"> * Because submissions are now a CPT, this function will only return false. </span>&nbsp;</div></li><li><div><span class="comment"> * Please replace any instances of this function with the replacement.</span>&nbsp;</div></li><li><div><span class="comment"> * </span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function ninja_forms_insert_sub( $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! isset ( $args['form_id'] ) )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $form_id = $args['form_id'];&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  $sub_id = Ninja_Forms()-&gt;subs()-&gt;create( $form_id );&nbsp;</div></li><li><div>  $args['sub_id'] = $sub_id;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  ninja_forms_update_sub( $args );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $sub_id;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * ninja_forms_update_sub() has been deprecated in favour of Ninja_Forms()-&gt;sub( 23 )-&gt;update_field( id, value );</span>&nbsp;</div></li><li><div><span class="comment"> * Because submissions are now a CPT, this function will only return false. </span>&nbsp;</div></li><li><div><span class="comment"> * Please replace any instances of this function with the replacement.</span>&nbsp;</div></li><li><div><span class="comment"> * </span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function ninja_forms_update_sub( $args ) {&nbsp;</div></li><li><div>  if ( ! isset ( $args['sub_id'] ) )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $sub_id = $args['sub_id'];&nbsp;</div></li><li><div>  $sub = Ninja_Forms()-&gt;sub( $sub_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset ( $args['data'] ) ) {&nbsp;</div></li><li><div>      $data = $args['data'];&nbsp;</div></li><li><div>      unset ( $args['data'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( is_serialized( $data ) ) {&nbsp;</div></li><li><div>          $data = unserialize( $data );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $data as $d ) {&nbsp;</div></li><li><div>              $field_id = $d['field_id'];&nbsp;</div></li><li><div>              $user_value = $d['user_value'];&nbsp;</div></li><li><div>              $sub-&gt;add_field( $field_id, $user_value );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }        &nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( $args as $key =&gt; $value ) {&nbsp;</div></li><li><div>      $sub-&gt;update_meta( '_' . $key, $value );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * ninja_forms_export_subs_to_csv() has been deprecated in favour of Ninja_Forms()-&gt;subs()-&gt;export( sub_ids, return );</span>&nbsp;</div></li><li><div><span class="comment"> * or Ninja_Forms()-&gt;sub( 23 )-&gt;export( return );</span>&nbsp;</div></li><li><div><span class="comment"> * Please replace any instances of this function with the replacement.</span>&nbsp;</div></li><li><div><span class="comment"> * </span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function ninja_forms_export_subs_to_csv( $sub_ids = '', $return = false ) {&nbsp;</div></li><li><div>  Ninja_Forms()-&gt;subs()-&gt;export( $sub_ids, $return );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function ninja_forms_implode_r($glue, $pieces) {&nbsp;</div></li><li><div>  $out = '';&nbsp;</div></li><li><div>  foreach ( $pieces as $piece ) {&nbsp;</div></li><li><div>      if ( is_array ( $piece ) ) {&nbsp;</div></li><li><div>          if ( $out == '' ) {&nbsp;</div></li><li><div>              $out = ninja_forms_implode_r($glue, $piece);&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $out .= ninja_forms_implode_r($glue, $piece); <span class="comment">// recurse</span>&nbsp;</div></li><li><div>          }            &nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          if ( $out == '' ) {&nbsp;</div></li><li><div>              $out .= $piece;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $out .= $glue.$piece;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return $out;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Get the csv delimiter</span>&nbsp;</div></li><li><div><span class="comment"> * </span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function ninja_forms_get_csv_delimiter() {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_csv_delimiter', ', ' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Get the csv enclosure</span>&nbsp;</div></li><li><div><span class="comment"> * </span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function ninja_forms_get_csv_enclosure() {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_csv_enclosure', '&quot;' );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Get the csv delimiter</span>&nbsp;</div></li><li><div><span class="comment"> * </span>&nbsp;</div></li><li><div><span class="comment"> * @return string</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function ninja_forms_get_csv_terminator() {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_csv_terminator', &quot;\n&quot; );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Wrapper for nf_save_sub()</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function ninja_forms_save_sub() {&nbsp;</div></li><li><div>  nf_save_sub();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nf_change_all_forms_filter( $cap ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_admin_menu_capabilities', $cap );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'ninja_forms_admin_all_forms_capabilities', 'nf_change_all_forms_filter' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nf_change_admin_menu_filter( $cap ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_admin_menu_capabilities', $cap );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'ninja_forms_admin_parent_menu_capabilities', 'nf_change_admin_menu_filter' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** </span>&nbsp;</div></li><li><div><span class="comment"> * Deprecated as of version 2.8 </span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// The admin_mailto setting has been deprecated. Because users may have used this setting to modify who receives the admin email, </span>&nbsp;</div></li><li><div><span class="comment">// we need to make sure that it is backwards compatible.</span>&nbsp;</div></li><li><div>function nf_clear_admin_mailto() {&nbsp;</div></li><li><div>  global $ninja_forms_processing;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $ninja_forms_processing-&gt;update_form_setting( 'admin_mailto', array() );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action( 'ninja_forms_before_pre_process', 'nf_clear_admin_mailto' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nf_modify_admin_mailto( $setting, $setting_name, $id ) {&nbsp;</div></li><li><div>  global $ninja_forms_processing;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Bail if this isn't our admin notification</span>&nbsp;</div></li><li><div>  if ( ! nf_get_object_meta_value( $id, 'admin_email' ) )&nbsp;</div></li><li><div>      return $setting;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Bail if this isn't the &quot;to&quot; setting.</span>&nbsp;</div></li><li><div>  if ( $setting_name != 'to' )&nbsp;</div></li><li><div>      return $setting;&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  $admin_mailto = $ninja_forms_processing-&gt;get_form_setting( 'admin_mailto' );&nbsp;</div></li><li><div>  $ninja_forms_processing-&gt;update_form_setting( 'admin_mailto', '' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_array( $admin_mailto ) && ! empty ( $admin_mailto ) ) {&nbsp;</div></li><li><div>      $setting = array_merge( $setting, $admin_mailto );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $setting;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_email_notification_process_setting', 'nf_modify_admin_mailto', 10, 3 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action('init', 'ninja_forms_register_filter_email_add_fields', 15 );&nbsp;</div></li><li><div>function ninja_forms_register_filter_email_add_fields() {&nbsp;</div></li><li><div>  global $ninja_forms_processing;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( is_object( $ninja_forms_processing ) ) {&nbsp;</div></li><li><div>      if( $ninja_forms_processing-&gt;get_form_setting( 'user_email_fields' ) == 1 ) {&nbsp;</div></li><li><div>          add_filter( 'ninja_forms_user_email', 'ninja_forms_filter_email_add_fields' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( is_object( $ninja_forms_processing ) ) {&nbsp;</div></li><li><div>      if( $ninja_forms_processing-&gt;get_form_setting( 'admin_email_fields' ) == 1 ) {&nbsp;</div></li><li><div>          add_filter( 'ninja_forms_admin_email', 'ninja_forms_filter_email_add_fields' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function ninja_forms_filter_email_add_fields( $message ) {&nbsp;</div></li><li><div>  global $ninja_forms_processing, $ninja_forms_fields;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $form_id = $ninja_forms_processing-&gt;get_form_ID();&nbsp;</div></li><li><div>  $all_fields = ninja_forms_get_fields_by_form_id( $form_id );&nbsp;</div></li><li><div>  <span class="comment">//$all_fields = $ninja_forms_processing-&gt;get_all_fields();</span>&nbsp;</div></li><li><div>  $tmp_array = array();&nbsp;</div></li><li><div>  if( is_array( $all_fields ) ) {&nbsp;</div></li><li><div>      foreach( $all_fields as $field ) {&nbsp;</div></li><li><div>          if( $ninja_forms_processing-&gt;get_field_value( $field['id'] ) ) {&nbsp;</div></li><li><div>              $tmp_array[$field['id']] = $ninja_forms_processing-&gt;get_field_value( $field['id'] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  $all_fields = apply_filters( 'ninja_forms_email_all_fields_array', $tmp_array, $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $email_type = $ninja_forms_processing-&gt;get_form_setting( 'email_type' );&nbsp;</div></li><li><div>  if(is_array($all_fields) AND !empty($all_fields)) {&nbsp;</div></li><li><div>      if($email_type == 'html') {&nbsp;</div></li><li><div>          $message .= &quot;&lt;br&gt;&lt;br&gt;&quot;;&nbsp;</div></li><li><div>          $message .= apply_filters( 'nf_email_user_values_title', __( 'User Submitted Values:', 'ninja-forms' ) );&nbsp;</div></li><li><div>          $message .= &quot;&lt;table&gt;&quot;;&nbsp;</div></li><li><div>      }else{&nbsp;</div></li><li><div>          $message = str_replace(&quot;&lt;p&gt;&quot;, &quot;\r\n&quot;, $message);&nbsp;</div></li><li><div>          $message = str_replace(&quot;&lt;/p&gt;&quot;, &quot;&quot;, $message);&nbsp;</div></li><li><div>          $message = str_replace(&quot;&lt;br&gt;&quot;, &quot;\r\n&quot;, $message);&nbsp;</div></li><li><div>          $message = str_replace(&quot;&lt;br /&gt;&quot;, &quot;\r\n&quot;, $message);&nbsp;</div></li><li><div>          $message = strip_tags($message);&nbsp;</div></li><li><div>          $message .= &quot;\r\n \r\n&quot;;&nbsp;</div></li><li><div>          $message .= apply_filters( 'nf_email_user_values_title', __( 'User Submitted Values:', 'ninja-forms' ) );&nbsp;</div></li><li><div>          $message .= &quot;\r\n&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      foreach( $all_fields as $field_id =&gt; $user_value ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $field_row = $ninja_forms_processing-&gt;get_field_settings( $field_id );&nbsp;</div></li><li><div>          $field_label = $field_row['data']['label'];&nbsp;</div></li><li><div>          $field_label = apply_filters( 'ninja_forms_email_field_label', $field_label, $field_id );&nbsp;</div></li><li><div>          $user_value = apply_filters( 'ninja_forms_email_user_value', $user_value, $field_id );&nbsp;</div></li><li><div>          $field_type = $field_row['type'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if( $ninja_forms_fields[$field_type]['process_field'] ) {&nbsp;</div></li><li><div>              if( is_array( $user_value ) AND !empty( $user_value ) ) {&nbsp;</div></li><li><div>                  $x = 0;&nbsp;</div></li><li><div>                  foreach($user_value as $val) {&nbsp;</div></li><li><div>                      if(!is_array($val)) {&nbsp;</div></li><li><div>                          if($x &gt; 0) {&nbsp;</div></li><li><div>                              $field_label = '----';&nbsp;</div></li><li><div>                              $field_label = apply_filters( 'ninja_forms_email_field_label', $field_label, $field_id );&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                          if($email_type == 'html') {&nbsp;</div></li><li><div>                              $message .= &quot;&lt;tr&gt;&lt;td width='50%'&gt;&quot;.$field_label.&quot;:&lt;/td&gt;&lt;td width='50%'&gt;&quot;.$val.&quot;&lt;/td&gt;&lt;/tr&gt;&quot;;&nbsp;</div></li><li><div>                          }else{&nbsp;</div></li><li><div>                              $message .= $field_label.&quot; - &quot;.$val.&quot;\r\n&quot;;&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }else{&nbsp;</div></li><li><div>                          foreach($val as $v) {&nbsp;</div></li><li><div>                              if(!is_array($v)) {&nbsp;</div></li><li><div>                                  if($x &gt; 0) {&nbsp;</div></li><li><div>                                      $field_label = '----';&nbsp;</div></li><li><div>                                      $field_label = apply_filters( 'ninja_forms_email_field_label', $field_label, $field_id );&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                                  if($email_type == 'html') {&nbsp;</div></li><li><div>                                      $message .= &quot;&lt;tr&gt;&lt;td width='50%'&gt;&quot;.$field_label.&quot;:&lt;/td&gt;&lt;td width='50%'&gt;&quot;.$v.&quot;&lt;/td&gt;&lt;/tr&gt;&quot;;&nbsp;</div></li><li><div>                                  }else{&nbsp;</div></li><li><div>                                      $message .= $field_label.&quot; - &quot;.$v.&quot;\r\n&quot;;&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }else{&nbsp;</div></li><li><div>                                  foreach($v as $a) {&nbsp;</div></li><li><div>                                      if($x &gt; 0) {&nbsp;</div></li><li><div>                                          $field_label = '----';&nbsp;</div></li><li><div>                                          $field_label = apply_filters( 'ninja_forms_email_field_label', $field_label, $field_id );&nbsp;</div></li><li><div>                                      }&nbsp;</div></li><li><div>                                      if($email_type == 'html') {&nbsp;</div></li><li><div>                                          $message .= &quot;&lt;tr&gt;&lt;td width='50%'&gt;&quot;.$field_label.&quot;:&lt;/td&gt;&lt;td width='50%'&gt;&quot;.$a.&quot;&lt;/td&gt;&lt;/tr&gt;&quot;;&nbsp;</div></li><li><div>                                      }else{&nbsp;</div></li><li><div>                                          $message .= $field_label.&quot; - &quot;.$a.&quot;\r\n&quot;;&nbsp;</div></li><li><div>                                      }&nbsp;</div></li><li><div>                                  }&nbsp;</div></li><li><div>                              }&nbsp;</div></li><li><div>                          }&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>                      $x++;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }else{&nbsp;</div></li><li><div>                  if($email_type == 'html') {&nbsp;</div></li><li><div>                      $message .= &quot;&lt;tr&gt;&lt;td width='50%'&gt;&quot;.$field_label.&quot;:&lt;/td&gt;&lt;td width='50%'&gt;&quot;.$user_value.&quot;&lt;/td&gt;&lt;/tr&gt;&quot;;&nbsp;</div></li><li><div>                  }else{&nbsp;</div></li><li><div>                      $message .= $field_label.&quot; - &quot;.$user_value.&quot;\r\n&quot;;&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      if($email_type == 'html') {&nbsp;</div></li><li><div>          $message .= &quot;&lt;/table&gt;&quot;;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  $message = apply_filters( 'ninja_forms_email_field_list', $message, $form_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $message;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action( 'init', 'ninja_forms_register_email_admin' );&nbsp;</div></li><li><div>function ninja_forms_register_email_admin() {&nbsp;</div></li><li><div>  add_action( 'ninja_forms_post_process', 'ninja_forms_email_admin', 1000 );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function ninja_forms_email_admin() {&nbsp;</div></li><li><div>  global $ninja_forms_processing;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  do_action( 'ninja_forms_email_admin' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $form_ID = $ninja_forms_processing-&gt;get_form_ID();&nbsp;</div></li><li><div>  $form_title = $ninja_forms_processing-&gt;get_form_setting( 'form_title' );&nbsp;</div></li><li><div>  $admin_mailto = $ninja_forms_processing-&gt;get_form_setting( 'admin_mailto' );&nbsp;</div></li><li><div>  $email_from_name = $ninja_forms_processing-&gt;get_form_setting( 'email_from_name' );&nbsp;</div></li><li><div>  $email_from = $ninja_forms_processing-&gt;get_form_setting( 'email_from' );&nbsp;</div></li><li><div>  $email_type = $ninja_forms_processing-&gt;get_form_setting( 'email_type' );&nbsp;</div></li><li><div>  $subject = $ninja_forms_processing-&gt;get_form_setting( 'admin_subject' );&nbsp;</div></li><li><div>  $message = $ninja_forms_processing-&gt;get_form_setting( 'admin_email_msg' );&nbsp;</div></li><li><div>  $email_reply = $ninja_forms_processing-&gt;get_form_setting( 'admin_email_replyto' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $ninja_forms_processing-&gt;get_form_setting( 'admin_email_name' ) ) {&nbsp;</div></li><li><div>      $email_from_name = $ninja_forms_processing-&gt;get_form_setting( 'admin_email_name' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $email_from_name AND $email_reply ) {&nbsp;</div></li><li><div>      $email_reply = $email_from_name . ' &lt;' . $email_reply . '&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( !$subject ) {&nbsp;</div></li><li><div>      $subject = $form_title;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( !$message ) {&nbsp;</div></li><li><div>      $message = '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if ( !$email_type ) {&nbsp;</div></li><li><div>      $email_type = '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $email_type !== 'plain' ) {&nbsp;</div></li><li><div>      $message = apply_filters( 'ninja_forms_admin_email_message_wpautop', wpautop( $message ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $email_from = $email_from_name.' &lt;'.$email_from.'&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $email_from = apply_filters( 'ninja_forms_admin_email_from', $email_from, $email_reply, $form_ID );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $headers = array();&nbsp;</div></li><li><div>  $headers[] = 'From: ' . $email_from;&nbsp;</div></li><li><div>  if( $email_reply ) {&nbsp;</div></li><li><div>      $headers[] = 'Reply-To: ' . $email_reply;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  $headers[] = 'Content-Type: text/' . $email_type;&nbsp;</div></li><li><div>  $headers[] = 'charset=utf-8';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $attachments = false;&nbsp;</div></li><li><div>  if ($ninja_forms_processing-&gt;get_form_setting( 'admin_attachments' ) ) {&nbsp;</div></li><li><div>      $attachments = $ninja_forms_processing-&gt;get_form_setting( 'admin_attachments' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_array( $admin_mailto ) AND !empty( $admin_mailto ) ) {&nbsp;</div></li><li><div>      foreach( $admin_mailto as $to ) {&nbsp;</div></li><li><div>          if ( $attachments ) {&nbsp;</div></li><li><div>              wp_mail( $to, $subject, $message, $headers, $attachments );&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              wp_mail( $to, $subject, $message, $headers );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Delete our admin CSV if one is present.</span>&nbsp;</div></li><li><div>  if ( file_exists( $ninja_forms_processing-&gt;get_extra_value( '_attachment_csv_path' ) ) ) {&nbsp;</div></li><li><div>      unlink ( $ninja_forms_processing-&gt;get_extra_value( '_attachment_csv_path' ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action('init', 'ninja_forms_register_email_user');&nbsp;</div></li><li><div>function ninja_forms_register_email_user() {&nbsp;</div></li><li><div>  add_action( 'ninja_forms_post_process', 'ninja_forms_email_user', 1000 );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function ninja_forms_email_user() {&nbsp;</div></li><li><div>  global $ninja_forms_processing;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  do_action( 'ninja_forms_email_user' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $form_ID = $ninja_forms_processing-&gt;get_form_ID();&nbsp;</div></li><li><div>  $form_title = $ninja_forms_processing-&gt;get_form_setting('form_title');&nbsp;</div></li><li><div>  $user_mailto = array();&nbsp;</div></li><li><div>  $all_fields = $ninja_forms_processing-&gt;get_all_fields();&nbsp;</div></li><li><div>  if(is_array($all_fields) AND !empty($all_fields)) {&nbsp;</div></li><li><div>      foreach($all_fields as $field_id =&gt; $user_value) {&nbsp;</div></li><li><div>          $field_row = $ninja_forms_processing-&gt;get_field_settings( $field_id );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if(isset($field_row['data']['send_email'])) {&nbsp;</div></li><li><div>              $send_email = $field_row['data']['send_email'];&nbsp;</div></li><li><div>          }else{&nbsp;</div></li><li><div>              $send_email = 0;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if($send_email) {&nbsp;</div></li><li><div>              array_push($user_mailto, $user_value);&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $email_from = $ninja_forms_processing-&gt;get_form_setting('email_from');&nbsp;</div></li><li><div>  $email_from_name = $ninja_forms_processing-&gt;get_form_setting( 'email_from_name' );&nbsp;</div></li><li><div>  $email_type = $ninja_forms_processing-&gt;get_form_setting('email_type');&nbsp;</div></li><li><div>  $subject = $ninja_forms_processing-&gt;get_form_setting('user_subject');&nbsp;</div></li><li><div>  $message = $ninja_forms_processing-&gt;get_form_setting('user_email_msg');&nbsp;</div></li><li><div>  $default_email = get_option( 'admin_email' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if(!$subject) {&nbsp;</div></li><li><div>      $subject = $form_title;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if(!$message) {&nbsp;</div></li><li><div>      $message = __('Thank you for filling out this form.', 'ninja-forms');&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if(!$email_from) {&nbsp;</div></li><li><div>      $email_from = $default_email;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if(!$email_type) {&nbsp;</div></li><li><div>      $email_type = '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( $email_type !== 'plain' ) {&nbsp;</div></li><li><div>      $message = apply_filters( 'ninja_forms_user_email_message_wpautop', wpautop( $message ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $email_from = $email_from_name.' &lt;'.$email_from.'&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $email_from = htmlspecialchars_decode($email_from);&nbsp;</div></li><li><div>  $email_from = htmlspecialchars_decode($email_from);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $headers = array();&nbsp;</div></li><li><div>  $headers[] = 'From: '.$email_from;&nbsp;</div></li><li><div>  $headers[] = 'Content-Type: text/'.$email_type;&nbsp;</div></li><li><div>  $headers[] = 'charset=utf-8';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $attachments = false;&nbsp;</div></li><li><div>  if ( $ninja_forms_processing-&gt;get_form_setting( 'user_attachments' ) ) {&nbsp;</div></li><li><div>      $attachments = $ninja_forms_processing-&gt;get_form_setting('user_attachments');&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_array( $user_mailto ) AND ! empty( $user_mailto ) ) {&nbsp;</div></li><li><div>      <span class="comment">// check to make sure there's an attachment before attaching one</span>&nbsp;</div></li><li><div>      if ( $attachments ) {&nbsp;</div></li><li><div>          wp_mail( $user_mailto, $subject, $message, $headers, $attachments );&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          wp_mail( $user_mailto, $subject, $message, $headers );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action( 'nf_save_sub', 'nf_csv_attachment' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nf_csv_attachment( $sub_id ) {&nbsp;</div></li><li><div>  global $ninja_forms_processing;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// make sure this form is supposed to attach a CSV</span>&nbsp;</div></li><li><div>  if( 1 == $ninja_forms_processing-&gt;get_form_setting( 'admin_attach_csv' ) AND 'submit' == $ninja_forms_processing-&gt;get_action() ) {&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">// create CSV content</span>&nbsp;</div></li><li><div>      $csv_content = Ninja_Forms()-&gt;sub( $sub_id )-&gt;export( true );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      $upload_dir = wp_upload_dir();&nbsp;</div></li><li><div>      $path = trailingslashit( $upload_dir['path'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// create temporary file</span>&nbsp;</div></li><li><div>      $path = tempnam( $path, 'Sub' );&nbsp;</div></li><li><div>      $temp_file = fopen( $path, 'r+' );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">// write to temp file</span>&nbsp;</div></li><li><div>      fwrite( $temp_file, $csv_content );&nbsp;</div></li><li><div>      fclose( $temp_file );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">// find the directory we will be using for the final file</span>&nbsp;</div></li><li><div>      $path = pathinfo( $path );&nbsp;</div></li><li><div>      $dir = $path['dirname'];&nbsp;</div></li><li><div>      $basename = $path['basename'];&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">// create name for file</span>&nbsp;</div></li><li><div>      $new_name = apply_filters( 'ninja_forms_submission_csv_name', 'ninja-forms-submission' );&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">// remove a file if it already exists</span>&nbsp;</div></li><li><div>      if( file_exists( $dir.'/'.$new_name.'.csv' ) ) {&nbsp;</div></li><li><div>          unlink( $dir.'/'.$new_name.'.csv' );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">// move file</span>&nbsp;</div></li><li><div>      rename( $dir.'/'.$basename, $dir.'/'.$new_name.'.csv' );&nbsp;</div></li><li><div>      $file1 = $dir.'/'.$new_name.'.csv';&nbsp;</div></li><li><div>      &nbsp;</div></li><li><div>      <span class="comment">// add new file to array of existing files</span>&nbsp;</div></li><li><div>      $files = $ninja_forms_processing-&gt;get_form_setting( 'admin_attachments' );&nbsp;</div></li><li><div>      array_push( $files, $file1 );&nbsp;</div></li><li><div>      $ninja_forms_processing-&gt;update_form_setting( 'admin_attachments', $files );&nbsp;</div></li><li><div>      $ninja_forms_processing-&gt;update_extra_value( '_attachment_csv_path', $file1 );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Move any attachments that exist for our &quot;admin&quot; and &quot;user&quot; emails.</span>&nbsp;</div></li><li><div>function nf_modify_attachments( $files, $n_id ) {&nbsp;</div></li><li><div>  global $ninja_forms_processing;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( Ninja_Forms()-&gt;notification( $n_id )-&gt;get_setting( 'admin_email' ) ) {&nbsp;</div></li><li><div>      if ( is_array( $ninja_forms_processing-&gt;get_form_setting( 'admin_attachments' ) ) ) {&nbsp;</div></li><li><div>          $files = array_merge( $files, $ninja_forms_processing-&gt;get_form_setting( 'admin_attachments' ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  } else if ( Ninja_Forms()-&gt;notification( $n_id )-&gt;get_setting( 'user_email' ) ) {&nbsp;</div></li><li><div>      if ( is_array( $ninja_forms_processing-&gt;get_form_setting( 'user_attachments' ) ) ) {&nbsp;</div></li><li><div>          $files = array_merge( $files, $ninja_forms_processing-&gt;get_form_setting( 'user_attachments' ) );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $ninja_forms_processing-&gt;update_form_setting( 'admin_attachments', '' );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  return $files;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_email_notification_attachments', 'nf_modify_attachments', 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Deprecate old &quot;add all fields&quot; filters</span>&nbsp;</div></li><li><div>function nf_deprecate_all_fields_email_field_label( $value, $field_id ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_email_field_label', $value, $field_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_all_fields_field_label', 'nf_deprecate_all_fields_email_field_label', 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nf_deprecate_all_fields_email_field_value( $value, $field_id ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_email_user_value', $value, $field_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_all_fields_field_value', 'nf_deprecate_all_fields_email_field_value', 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nf_deprecate_all_fields_email_table( $value, $form_id ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_email_field_list', $value, $form_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_all_fields_table', 'nf_deprecate_all_fields_email_table', 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Deprecate our old success message filter</span>&nbsp;</div></li><li><div>function nf_deprecate_success_message_filter( $message, $n_id ) {&nbsp;</div></li><li><div>  return apply_filters( 'ninja_forms_success_msg', $message );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_success_msg', 'nf_deprecate_success_message_filter', 10, 2 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Remove any references to &quot;admin email&quot; from our imported forms.</span>&nbsp;</div></li><li><div>function nf_deprecate_form_import( $form ) {&nbsp;</div></li><li><div>  if ( isset ( $form['data']['admin_mailto'] ) )&nbsp;</div></li><li><div>      unset( $form['data']['admin_mailto'] );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ( isset ( $form['data']['admin_email'] ) )&nbsp;</div></li><li><div>      unset( $form['data']['admin_email'] );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ( isset ( $form['data']['admin_subject'] ) )&nbsp;</div></li><li><div>      unset( $form['data']['admin_subject'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset ( $form['data']['user_mailto'] ) )&nbsp;</div></li><li><div>      unset( $form['data']['user_mailto'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset ( $form['data']['user_email'] ) )&nbsp;</div></li><li><div>      unset( $form['data']['user_email'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset ( $form['data']['user_subject'] ) )&nbsp;</div></li><li><div>      unset ( $form['data']['user_subject'] );&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>  if ( isset ( $form['data']['landing_page'] ) )&nbsp;</div></li><li><div>      unset ( $form['data']['landing_page'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $form;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'ninja_forms_before_import_form', 'nf_deprecate_form_import' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Remove any references to &quot;user email&quot; from our imported forms.</span>&nbsp;</div></li><li><div>function nf_deprecate_field_import( $data ) {&nbsp;</div></li><li><div>  if ( isset ( $data['send_email'] ) )&nbsp;</div></li><li><div>      unset ( $data['send_email'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset ( $data['from_email'] ) )&nbsp;</div></li><li><div>      unset ( $data['from_email'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset ( $data['replyto_email'] ) )&nbsp;</div></li><li><div>      unset ( $data['replyto_email'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $data;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_filter( 'nf_before_import_field', 'nf_deprecate_field_import' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/** </span>&nbsp;</div></li><li><div><span class="comment"> * Deprecated as of version 2.9</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Get an array of form settings by form ID</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $form_id</span>&nbsp;</div></li><li><div><span class="comment"> * @return array $form['data']</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function nf_get_form_settings( $form_id ) {&nbsp;</div></li><li><div>  return nf_get_object_meta( $form_id );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return form data</span>&nbsp;</div></li><li><div><span class="comment"> * </span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $form_id</span>&nbsp;</div></li><li><div><span class="comment"> * @return array $form</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function ninja_forms_get_form_by_id( $form_id ) {&nbsp;</div></li><li><div>  $settings = Ninja_Forms()-&gt;form( $form_id )-&gt;get_all_settings();&nbsp;</div></li><li><div>  $date_updated = Ninja_Forms()-&gt;form( $form_id )-&gt;get_setting( 'date_updated' );&nbsp;</div></li><li><div>  return array( 'id' =&gt; $form_id, 'data' =&gt; $settings, 'date_updated' =&gt; $date_updated );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Get a form by field id</span>&nbsp;</div></li><li><div><span class="comment"> * </span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @param int $field_id</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $form</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function ninja_forms_get_form_by_field_id( $field_id ) {&nbsp;</div></li><li><div>  global $wpdb;&nbsp;</div></li><li><div>  $form_id = $wpdb-&gt;get_row($wpdb-&gt;prepare(&quot;SELECT form_id FROM &quot;.NINJA_FORMS_FIELDS_TABLE_NAME.&quot; WHERE id = %d&quot;, $field_id), ARRAY_A);&nbsp;</div></li><li><div>  $form_id = $form_id['form_id'];&nbsp;</div></li><li><div>  $form = ninja_forms_get_form_by_id( $form_id );&nbsp;</div></li><li><div>  return $form;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Delete a form</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function ninja_forms_delete_form( $form_id = '' ) {&nbsp;</div></li><li><div>  global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Bail if we aren't in the admin</span>&nbsp;</div></li><li><div>  if ( ! is_admin() )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Bail if we don't have proper permissions</span>&nbsp;</div></li><li><div>  if ( ! current_user_can( apply_filters( 'nf_delete_form_capabilities', 'manage_options' ) ) )&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( $form_id == '' ) {&nbsp;</div></li><li><div>      $ajax = true;&nbsp;</div></li><li><div>      $form_id = absint( $_REQUEST['form_id'] );&nbsp;</div></li><li><div>      check_ajax_referer( 'nf_ajax', 'nf_ajax_nonce' );&nbsp;</div></li><li><div>  }else{&nbsp;</div></li><li><div>      $ajax = false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  Ninja_Forms()-&gt;form( $form_id )-&gt;delete();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( $ajax ) {&nbsp;</div></li><li><div>      die();&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>add_action('wp_ajax_ninja_forms_delete_form', 'ninja_forms_delete_form');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function ninja_forms_get_all_forms( $debug = false ) {&nbsp;</div></li><li><div>  $forms = Ninja_Forms()-&gt;forms()-&gt;get_all();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $tmp_array = array();&nbsp;</div></li><li><div>  $x = 0;&nbsp;</div></li><li><div>  foreach ( $forms as $form_id ) {&nbsp;</div></li><li><div>      $tmp_array[ $x ]['id'] = $form_id;&nbsp;</div></li><li><div>      $tmp_array[ $x ]['data'] = Ninja_Forms()-&gt;form( $form_id )-&gt;get_all_settings();&nbsp;</div></li><li><div>      $tmp_array[ $x ]['name'] = Ninja_Forms()-&gt;form( $form_id )-&gt;get_setting( 'form_title' );&nbsp;</div></li><li><div>      $x++;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $tmp_array;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Return our form count</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.8</span>&nbsp;</div></li><li><div><span class="comment"> * @return int $count</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function nf_get_form_count() {&nbsp;</div></li><li><div>  global $wpdb;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $forms = Ninja_Forms()-&gt;forms()-&gt;get_all();&nbsp;</div></li><li><div>  return count( $forms );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Old update form function.</span>&nbsp;</div></li><li><div><span class="comment"> * </span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function ninja_forms_update_form( $args ) {&nbsp;</div></li><li><div>  <span class="comment">// Get our form id</span>&nbsp;</div></li><li><div>  $form_id = $args['where']['id'];&nbsp;</div></li><li><div>  $update_array = $args['update_array'];&nbsp;</div></li><li><div>  if ( isset ( $update_array['data'] ) ) {&nbsp;</div></li><li><div>      $data = maybe_unserialize( $update_array['data'] );&nbsp;</div></li><li><div>      if ( is_array( $data ) ) {&nbsp;</div></li><li><div>          foreach ( $data as $key =&gt; $val ) {&nbsp;</div></li><li><div>              Ninja_Forms()-&gt;form( $form_id )-&gt;update_setting( $key, $val );&nbsp;</div></li><li><div>          }    &nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      unset( $update_array['data'] );    &nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( $update_array as $key =&gt; $val ) {&nbsp;</div></li><li><div>      Ninja_Forms()-&gt;form( $form_id )-&gt;update_setting( $key, $val );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  Ninja_Forms()-&gt;form( $form_id )-&gt;dump_cache();&nbsp;</div></li><li><div>  &nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Add our old form fields</span>&nbsp;</div></li><li><div>require_once( NINJA_FORMS_DIR . &quot;/includes/fields/honeypot.php&quot; );&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>Ninja Forms</li><li><span></span>3.1.1</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>