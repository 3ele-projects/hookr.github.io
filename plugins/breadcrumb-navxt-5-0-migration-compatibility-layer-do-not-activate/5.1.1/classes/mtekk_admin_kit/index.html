<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="5.1.1" data-slug="breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate" data-type="class" data-id="10309"><head xmlns="http://www.w3.org/1999/xhtml"><title> mtekk_adminkit | class | Breadcrumb Navxt 5 0 Migration Compatibility Layer Do Not Activate | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="mtekk_adminKit, class, plugin, breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate, 5.1.1" /><meta name="description" content="The Breadcrumb NavXT 5.0 Migration Compatibility Layer DO NOT ACTIVATE mtekk adminKit class." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.10"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=493737bc69ba6111e17bfb98d7ecc75e' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.10' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/mtekk_admin_kit/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fmtekk_admin_kit%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fmtekk_admin_kit%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate-5.1.1-class-mtekk_admin_kit","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="mtekk_admin_kit" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to breadcrumb-navxt-5-0-migratio&hellip;." href="http://hookr.io/plugins/breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate/" class="plugin"><span property="name">breadcrumb-navxt-5-0-migratio&hellip;</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><span property="name">5.1.1</span><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate/5.1.1/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">mtekk_admin_kit</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="68"><a href="http://hookr.io/plugins/breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate/5.1.1/all/" title="All">All <span class="count badge">68</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate/5.1.1/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="46"><a href="http://hookr.io/plugins/breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate/5.1.1/hooks/" title="Hooks">Hooks <span class="count badge">46</span></a></li><li class="" data-id="action" data-count="22"><a href="http://hookr.io/plugins/breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate/5.1.1/actions/" title="Actions">Actions <span class="count badge">22</span></a></li><li class="" data-id="filter" data-count="24"><a href="http://hookr.io/plugins/breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate/5.1.1/filters/" title="Filters">Filters <span class="count badge">24</span></a></li><li class="active" data-id="class" data-count="9"><a href="http://hookr.io/plugins/breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate/5.1.1/classes/" title="Classes">Classes <span class="count badge">9</span></a></li><li class="" data-id="constant" data-count="1"><a href="http://hookr.io/plugins/breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate/5.1.1/constants/" title="Constants">Constants <span class="count badge">1</span></a></li><li class="" data-id="function" data-count="12"><a href="http://hookr.io/plugins/breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate/5.1.1/functions/" title="Functions">Functions <span class="count badge">12</span></a></li><li class="" data-id="shortcode" data-count="0"><a href="http://hookr.io/plugins/breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate/5.1.1/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">0</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>mtekk_adminKit</strong></h1><p>The Breadcrumb NavXT 5.0 Migration Compatibility Layer DO NOT ACTIVATE <strong>mtekk adminKit</strong> class.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate/5.1.1/files/includes-class-mtekk-adminkit/" class="file">/includes/class.mtekk_adminkit.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="20" class="block" start="20"><li><div>abstract class mtekk_adminKit&nbsp;</div></li><li><div>{&nbsp;</div></li><li><div>    const __version = '1.2';&nbsp;</div></li><li><div>    protected $version;&nbsp;</div></li><li><div>    protected $full_name;&nbsp;</div></li><li><div>    protected $short_name;&nbsp;</div></li><li><div>    protected $plugin_basename;&nbsp;</div></li><li><div>    protected $access_level = 'manage_options';&nbsp;</div></li><li><div>    protected $identifier;&nbsp;</div></li><li><div>    protected $unique_prefix;&nbsp;</div></li><li><div>    protected $opt = array();&nbsp;</div></li><li><div>    protected $message;&nbsp;</div></li><li><div>    protected $support_url;&nbsp;</div></li><li><div>    protected $allowed_html;&nbsp;</div></li><li><div>    function __construct()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Admin Init Hook&nbsp;</div></li><li><div>        add_action('admin_init', array($this, 'init'));&nbsp;</div></li><li><div>        //WordPress Admin interface hook&nbsp;</div></li><li><div>        add_action('admin_menu', array($this, 'add_page'));&nbsp;</div></li><li><div>        //Installation Script hook&nbsp;</div></li><li><div>        //register_activation_hook($this-&gt;plugin_basename, array($this, 'install'));&nbsp;</div></li><li><div>        add_action('activate_' . $this-&gt;plugin_basename, array($this, 'install'));&nbsp;</div></li><li><div>        //Initilizes l10n domain&nbsp;</div></li><li><div>        $this-&gt;local();&nbsp;</div></li><li><div>        add_action('wp_loaded', array($this, 'wp_loaded'));&nbsp;</div></li><li><div>        //Register Help Output&nbsp;</div></li><li><div>        //add_action('add_screen_help_and_options', array($this, 'help'));&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    function wp_loaded()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Filter our allowed html tags&nbsp;</div></li><li><div>        $this-&gt;allowed_html = apply_filters($this-&gt;unique_prefix . '_allowed_html', wp_kses_allowed_html('post'));&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Returns the internal mtekk_admin_class version&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_admin_class_version()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return self::__version;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Return the URL of the settings page for the plugin&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function admin_url()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return admin_url('options-general.php?page=' . $this-&gt;identifier);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * A wrapper for nonced_anchor returns a nonced anchor for admin pages&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $mode The nonce &quot;mode&quot;, a unique string at the end of the standardized nonce identifier&nbsp;</div></li><li><div>     * @param string $title (optional) The text to use in the title portion of the anchor&nbsp;</div></li><li><div>     * @param string $text (optional) The text that will be surrounded by the anchor tags&nbsp;</div></li><li><div>     * @return string the assembled anchor&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function admin_anchor($mode, $title = '', $text = '')&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return $this-&gt;nonced_anchor($this-&gt;admin_url(), 'admin_' . $mode, 'true', $title, $text);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Returns a properly formed nonced anchor to the specified URI&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $uri The URI that the anchor should be for&nbsp;</div></li><li><div>     * @param string $mode The nonce &quot;mode&quot;, a unique string at the end of the standardized nonce identifier&nbsp;</div></li><li><div>     * @param mixed $value (optional) The value to place in the query string &nbsp;</div></li><li><div>     * @param string $title (optional) The text to use in the title portion of the anchor&nbsp;</div></li><li><div>     * @param string $text (optional) The text that will be surrounded by the anchor tags&nbsp;</div></li><li><div>     * @param string $extras (optional) This text is placed within the opening anchor tag, good for adding id, classe, rel field&nbsp;</div></li><li><div>     * @return string the assembled anchor&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function nonced_anchor($uri, $mode, $value = 'true', $title = '', $text = '', $extras = '')&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Assemble our url, nonce and all&nbsp;</div></li><li><div>        $url = wp_nonce_url($uri . '&' . $this-&gt;unique_prefix . '_' . $mode . '=' . $value, $this-&gt;unique_prefix . '_' . $mode);&nbsp;</div></li><li><div>        //Return a valid anchor&nbsp;</div></li><li><div>        return ' &lt;a title=&quot;' . $title . '&quot; href=&quot;' . $url . '&quot; '. $extras . '&gt;' . $text . '&lt;/a&gt;';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Abstracts the check_admin_referer so that all the end user has to supply is the mode&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $mode The specific nonce &quot;mode&quot; (see nonced_anchor) that is being checked&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function check_nonce($mode)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        check_admin_referer($this-&gt;unique_prefix . '_' . $mode);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    function init()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Admin Options reset hook&nbsp;</div></li><li><div>        if(isset($_POST[$this-&gt;unique_prefix . '_admin_reset']))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Run the reset function on init if reset form has been submitted&nbsp;</div></li><li><div>            $this-&gt;opts_reset();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        //Admin Options export hook&nbsp;</div></li><li><div>        else if(isset($_POST[$this-&gt;unique_prefix . '_admin_export']))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Run the export function on init if export form has been submitted&nbsp;</div></li><li><div>            $this-&gt;opts_export();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        //Admin Options import hook&nbsp;</div></li><li><div>        else if(isset($_FILES[$this-&gt;unique_prefix . '_admin_import_file']) && !empty($_FILES[$this-&gt;unique_prefix . '_admin_import_file']['name']))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Run the import function on init if import form has been submitted&nbsp;</div></li><li><div>            $this-&gt;opts_import();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        //Admin Options rollback hook&nbsp;</div></li><li><div>        else if(isset($_GET[$this-&gt;unique_prefix . '_admin_undo']))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Run the rollback function on init if undo button has been pressed&nbsp;</div></li><li><div>            $this-&gt;opts_undo();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        //Admin Options upgrade hook&nbsp;</div></li><li><div>        else if(isset($_GET[$this-&gt;unique_prefix . '_admin_upgrade']))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Run the upgrade function on init if upgrade button has been pressed&nbsp;</div></li><li><div>            $this-&gt;opts_upgrade_wrapper();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        //Admin Options fix hook&nbsp;</div></li><li><div>        else if(isset($_GET[$this-&gt;unique_prefix . '_admin_fix']))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Run the options fix function on init if fix button has been pressed&nbsp;</div></li><li><div>            $this-&gt;opts_upgrade_wrapper();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        //Admin Options update hook&nbsp;</div></li><li><div>        else if(isset($_POST[$this-&gt;unique_prefix . '_admin_options']))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Temporarily add update function on init if form has been submitted&nbsp;</div></li><li><div>            $this-&gt;opts_update();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        //Add in the nice &quot;settings&quot; link to the plugins page&nbsp;</div></li><li><div>        add_filter('plugin_action_links', array($this, 'filter_plugin_actions'), 10, 2);&nbsp;</div></li><li><div>        //Register JS for tabs&nbsp;</div></li><li><div>        wp_register_script('mtekk_adminkit_tabs', plugins_url('/mtekk_adminkit_tabs.js', dirname(__FILE__) . '/mtekk_adminkit_tabs.js'), array('jquery-ui-tabs'));&nbsp;</div></li><li><div>        //Register CSS for tabs&nbsp;</div></li><li><div>        wp_register_style('mtekk_adminkit_tabs', plugins_url('/mtekk_adminkit_tabs.css', dirname(__FILE__) . '/mtekk_adminkit_tabs.css'));&nbsp;</div></li><li><div>        //Register options&nbsp;</div></li><li><div>        register_setting($this-&gt;unique_prefix . '_options', $this-&gt;unique_prefix . '_options', '');&nbsp;</div></li><li><div>        //Synchronize up our settings with the database as we're done modifying them now&nbsp;</div></li><li><div>        $this-&gt;opt = $this-&gt;parse_args($this-&gt;get_option($this-&gt;unique_prefix . '_options'), $this-&gt;opt);&nbsp;</div></li><li><div>        //Run the opts fix filter&nbsp;</div></li><li><div>        $this-&gt;opts_fix($this-&gt;opt);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Adds the adminpage the menu and the nice little settings link&nbsp;</div></li><li><div>     * TODO: make this more generic for easier extension&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function add_page()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Add the submenu page to &quot;settings&quot; menu&nbsp;</div></li><li><div>        $hookname = add_submenu_page('options-general.php', __($this-&gt;full_name, $this-&gt;identifier), $this-&gt;short_name, $this-&gt;access_level, $this-&gt;identifier, array($this, 'admin_page'));&nbsp;</div></li><li><div>        // check capability of user to manage options (access control)&nbsp;</div></li><li><div>        if(current_user_can($this-&gt;access_level))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Register admin_head-$hookname callback&nbsp;</div></li><li><div>            add_action('admin_head-' . $hookname, array($this, 'admin_head'));&nbsp;</div></li><li><div>            //Register admin_print_styles-$hookname callback&nbsp;</div></li><li><div>            add_action('admin_print_styles-' . $hookname, array($this, 'admin_styles'));&nbsp;</div></li><li><div>            //Register admin_print_scripts-$hookname callback&nbsp;</div></li><li><div>            add_action('admin_print_scripts-' . $hookname, array($this, 'admin_scripts'));&nbsp;</div></li><li><div>            //Register Help Output&nbsp;</div></li><li><div>            add_action('load-' . $hookname, array($this, 'help'));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Initilizes localization textdomain for translations (if applicable)&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * Will conditionally load the textdomain for translations. This is here for&nbsp;</div></li><li><div>     * plugins that span multiple files and have localization in more than one file&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @return void&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function local()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        global $l10n;&nbsp;</div></li><li><div>        // the global and the check might become obsolete in&nbsp;</div></li><li><div>        // further wordpress versions&nbsp;</div></li><li><div>        // @see https://core.trac.wordpress.org/ticket/10527        &nbsp;</div></li><li><div>        if(!isset($l10n[$this-&gt;identifier]))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            load_plugin_textdomain($this-&gt;identifier, false, $this-&gt;identifier . '/languages');&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Places in a link to the settings page in the plugins listing entry&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param  array  $links An array of links that are output in the listing&nbsp;</div></li><li><div>     * @param  string $file The file that is currently in processing&nbsp;</div></li><li><div>     * @return array  Array of links that are output in the listing.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function filter_plugin_actions($links, $file)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Make sure we are adding only for the current plugin&nbsp;</div></li><li><div>        if($file == $this-&gt;plugin_basename)&nbsp;</div></li><li><div>        { &nbsp;</div></li><li><div>            //Add our link to the end of the array to better integrate into the WP 2.8 plugins page&nbsp;</div></li><li><div>            $links[] = '&lt;a href=&quot;' . $this-&gt;admin_url() . '&quot;&gt;' . __('Settings') . '&lt;/a&gt;';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $links;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Checks to see if the plugin has been fully installed&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @return bool whether or not the plugin has been installed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function is_installed()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /** &nbsp;</div></li><li><div>     * This sets up and upgrades the database settings, runs on every activation&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function install()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Call our little security function&nbsp;</div></li><li><div>        $this-&gt;security();&nbsp;</div></li><li><div>        //Try retrieving the options from the database&nbsp;</div></li><li><div>        $opts = $this-&gt;get_option($this-&gt;unique_prefix . '_options');&nbsp;</div></li><li><div>        //If there are no settings, copy over the default settings&nbsp;</div></li><li><div>        if(!is_array($opts))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Grab defaults from the object&nbsp;</div></li><li><div>            $opts = $this-&gt;opt;&nbsp;</div></li><li><div>            //Add the options&nbsp;</div></li><li><div>            $this-&gt;add_option($this-&gt;unique_prefix . '_options', $opts);&nbsp;</div></li><li><div>            $this-&gt;add_option($this-&gt;unique_prefix . '_options_bk', $opts, '', 'no');&nbsp;</div></li><li><div>            //Add the version, no need to autoload the db version&nbsp;</div></li><li><div>            $this-&gt;add_option($this-&gt;unique_prefix . '_version', $this-&gt;version, '', 'no');&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Retrieve the database version&nbsp;</div></li><li><div>            $db_version = $this-&gt;get_option($this-&gt;unique_prefix . '_version');&nbsp;</div></li><li><div>            if($this-&gt;version !== $db_version)&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                //Run the settings update script&nbsp;</div></li><li><div>                $this-&gt;opts_upgrade($opts, $db_version);&nbsp;</div></li><li><div>                //Always have to update the version&nbsp;</div></li><li><div>                $this-&gt;update_option($this-&gt;unique_prefix . '_version', $this-&gt;version);&nbsp;</div></li><li><div>                //Store the options&nbsp;</div></li><li><div>                $this-&gt;update_option($this-&gt;unique_prefix . '_options', $this-&gt;opt);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * This removes database settings upon deletion of the plugin from WordPress&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function uninstall()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Remove the option array setting&nbsp;</div></li><li><div>        $this-&gt;delete_option($this-&gt;unique_prefix . '_options');&nbsp;</div></li><li><div>        //Remove the option backup array setting&nbsp;</div></li><li><div>        $this-&gt;delete_option($this-&gt;unique_prefix . '_options_bk');&nbsp;</div></li><li><div>        //Remove the version setting&nbsp;</div></li><li><div>        $this-&gt;delete_option($this-&gt;unique_prefix . '_version');&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Compares the supplided version with the internal version, places an upgrade warning if there is a missmatch&nbsp;</div></li><li><div>     * TODO: change this to being auto called in admin_init action&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function version_check($version)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Do a quick version check&nbsp;</div></li><li><div>        if(version_compare($version, $this-&gt;version, '&lt;') && is_array($this-&gt;opt))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Throw an error since the DB version is out of date&nbsp;</div></li><li><div>            $this-&gt;message['error'][] = __('Your settings are out of date.', $this-&gt;identifier) . $this-&gt;admin_anchor('upgrade', __('Migrate the settings now.', $this-&gt;identifier), __('Migrate now.', $this-&gt;identifier));&nbsp;</div></li><li><div>            //Output any messages that there may be&nbsp;</div></li><li><div>            $this-&gt;messages();&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        //Do a quick version check&nbsp;</div></li><li><div>        else if(version_compare($version, $this-&gt;version, '&gt;') && is_array($this-&gt;opt))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Throw an error since the DB version is out of date&nbsp;</div></li><li><div>            $this-&gt;message['error'][] = __('Your settings are for a newer version.', $this-&gt;identifier) . $this-&gt;admin_anchor('upgrade', __('Migrate the settings now.', $this-&gt;identifier), __('Migrate now.', $this-&gt;identifier));&nbsp;</div></li><li><div>            //Output any messages that there may be&nbsp;</div></li><li><div>            $this-&gt;messages();&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else if(!is_array($this-&gt;opt))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Throw an error since it appears the options were never registered&nbsp;</div></li><li><div>            $this-&gt;message['error'][] = __('Your plugin install is incomplete.', $this-&gt;identifier) . $this-&gt;admin_anchor('upgrade', __('Load default settings now.', $this-&gt;identifier), __('Complete now.', $this-&gt;identifier));&nbsp;</div></li><li><div>            //Output any messages that there may be&nbsp;</div></li><li><div>            $this-&gt;messages();&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else if(!$this-&gt;opts_validate($this-&gt;opt))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Throw an error since it appears the options contain invalid data&nbsp;</div></li><li><div>            $this-&gt;message['error'][] = __('Your plugin settings are invalid.', $this-&gt;identifier) . $this-&gt;admin_anchor('fix', __('Attempt to fix settings now.', $this-&gt;identifier), __('Fix now.', $this-&gt;identifier));&nbsp;</div></li><li><div>            //Output any messages that there may be&nbsp;</div></li><li><div>            $this-&gt;messages();&nbsp;</div></li><li><div>            return false;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return true;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * A prototype function. End user should override if they need this feature.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function opts_validate(&$opts)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return true;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * A prototype function. End user should override if they need this feature.&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param array $opts&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function opts_fix(&$opts)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Synchronizes the backup options entry with the current options entry&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function opts_backup()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Set the backup options in the DB to the current options&nbsp;</div></li><li><div>        $this-&gt;update_option($this-&gt;unique_prefix . '_options_bk', $this-&gt;get_option($this-&gt;unique_prefix . '_options'));&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Runs recursivly through the opts array, sanitizing and merging in updates from the $input array&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param array $opts good, clean array&nbsp;</div></li><li><div>     * @param array $input unsanitzed input array, not trusted at all&nbsp;</div></li><li><div>     * @todo This function should probably get a filter thrown within it to be more extensible&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function opts_update_loop(&$opts, $input)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Loop through all of the existing options (avoids random setting injection)&nbsp;</div></li><li><div>        foreach($opts as $option =&gt; $value)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //If we have an array, dive into another recursive loop&nbsp;</div></li><li><div>            if(isset($input[$option]) && is_array($value))&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                $this-&gt;opts_update_loop($opts[$option], $input[$option]);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            //We must check for unset settings, but booleans are ok to be unset&nbsp;</div></li><li><div>            else if(isset($input[$option]) || $option[0] == 'b')&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                switch($option[0])&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                    //Handle the boolean options&nbsp;</div></li><li><div>                    case 'b':&nbsp;</div></li><li><div>                        $opts[$option] = isset($input[$option]);&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    //Handle the integer options&nbsp;</div></li><li><div>                    case 'i':&nbsp;</div></li><li><div>                        $opts[$option] = (int) $input[$option];&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    //Handle the absolute integer options&nbsp;</div></li><li><div>                    case 'a':&nbsp;</div></li><li><div>                        $opts[$option] = absint($input[$option]);&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    //Handle the floating point options&nbsp;</div></li><li><div>                    case 'f':&nbsp;</div></li><li><div>                        $opts[$option] = (float) $input[$option];&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    //Handle the HTML options&nbsp;</div></li><li><div>                    case 'h':&nbsp;</div></li><li><div>                        //May be better to use wp_kses here&nbsp;</div></li><li><div>                        $opts[$option] = wp_kses(stripslashes($input[$option]), $this-&gt;allowed_html);&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    //Handle the HTML options that must not be null&nbsp;</div></li><li><div>                    case 'H':&nbsp;</div></li><li><div>                        if(isset($input[$option]))&nbsp;</div></li><li><div>                        {&nbsp;</div></li><li><div>                            $opts[$option] = wp_kses(stripslashes($input[$option]), $this-&gt;allowed_html);&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    //Handle the text options that must not be null&nbsp;</div></li><li><div>                    case 'S':&nbsp;</div></li><li><div>                        if(isset($input[$option]))&nbsp;</div></li><li><div>                        {&nbsp;</div></li><li><div>                            $opts[$option] = esc_html($input[$option]);&nbsp;</div></li><li><div>                        }&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    //Deal with strings that can be null&nbsp;</div></li><li><div>                    case 's':&nbsp;</div></li><li><div>                        $opts[$option] = esc_html($input[$option]);&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                    //By default we have nothing to do, allows for internal settings&nbsp;</div></li><li><div>                    default:&nbsp;</div></li><li><div>                        break;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * A better version of parse_args, will recrusivly follow arrays&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param mixed $args The arguments to be parsed&nbsp;</div></li><li><div>     * @param mixed $defaults (optional) The default values to validate against&nbsp;</div></li><li><div>     * @return mixed&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function parse_args($args, $defaults = '')&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if(is_object($args))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $r = get_object_vars($args);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else if(is_array($args))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $r =& $args;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            wp_parse_str($args, $r);    &nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if(is_array($defaults))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            return mtekk_adminKit::array_merge_recursive($defaults, $r);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $r;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * An alternate version of array_merge_recursive, less flexible&nbsp;</div></li><li><div>     * still recursive, ~2x faster than the more flexible version&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param array $arg1 first array&nbsp;</div></li><li><div>     * @param array $arg2 second array to merge into $arg1&nbsp;</div></li><li><div>     * @return array&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    static function array_merge_recursive($arg1, $arg2)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        foreach($arg2 as $key =&gt; $value)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            if(array_key_exists($key, $arg1) && is_array($value))&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                $arg1[$key] = mtekk_adminKit::array_merge_recursive($arg1[$key], $value);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                $arg1[$key] = $value;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $arg1;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * An action that fires just before the options backup, use to add in dynamically detected options&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param array $opts the options array, passed in by reference&nbsp;</div></li><li><div>     * @return null&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function opts_update_prebk(&$opts)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Just a prototype function&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Updates the database settings from the webform&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function opts_update()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Do some security related thigns as we are not using the normal WP settings API&nbsp;</div></li><li><div>        $this-&gt;security();&nbsp;</div></li><li><div>        //Do a nonce check, prevent malicious link/form problems&nbsp;</div></li><li><div>        check_admin_referer($this-&gt;unique_prefix . '_options-options');&nbsp;</div></li><li><div>        //Update local options from database&nbsp;</div></li><li><div>        $this-&gt;opt = $this-&gt;parse_args($this-&gt;get_option($this-&gt;unique_prefix . '_options'), $this-&gt;opt);&nbsp;</div></li><li><div>        $this-&gt;opts_update_prebk($this-&gt;opt);&nbsp;</div></li><li><div>        //Update our backup options&nbsp;</div></li><li><div>        $this-&gt;update_option($this-&gt;unique_prefix . '_options_bk', $this-&gt;opt);&nbsp;</div></li><li><div>        //Grab our incomming array (the data is dirty)&nbsp;</div></li><li><div>        $input = $_POST[$this-&gt;unique_prefix . '_options'];&nbsp;</div></li><li><div>        //Run the update loop&nbsp;</div></li><li><div>        $this-&gt;opts_update_loop($this-&gt;opt, $input);&nbsp;</div></li><li><div>        //Commit the option changes&nbsp;</div></li><li><div>        $this-&gt;update_option($this-&gt;unique_prefix . '_options', $this-&gt;opt);&nbsp;</div></li><li><div>        //Check if known settings match attempted save&nbsp;</div></li><li><div>        if(count(array_diff_key($input, $this-&gt;opt)) == 0)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Let the user know everything went ok&nbsp;</div></li><li><div>            $this-&gt;message['updated fade'][] = __('Settings successfully saved.', $this-&gt;identifier) . $this-&gt;admin_anchor('undo', __('Undo the options save.', $this-&gt;identifier), __('Undo', $this-&gt;identifier));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Let the user know the following were not saved&nbsp;</div></li><li><div>            $this-&gt;message['updated fade'][] = __('Some settings were not saved.', $this-&gt;identifier) . $this-&gt;admin_anchor('undo', __('Undo the options save.', $this-&gt;identifier), __('Undo', $this-&gt;identifier));&nbsp;</div></li><li><div>            $temp = __('The following settings were not saved:', $this-&gt;identifier);&nbsp;</div></li><li><div>            foreach(array_diff_key($input, $this-&gt;opt) as $setting =&gt; $value)&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                $temp .= '&lt;br /&gt;' . $setting;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $this-&gt;message['updated fade'][] = $temp . '&lt;br /&gt;' . sprintf(__('Please include this message in your %sbug report%s.', $this-&gt;identifier), '&lt;a title=&quot;' . sprintf(__('Go to the %s support post for your version.', $this-&gt;identifier), $this-&gt;short_name) . '&quot; href=&quot;' . $this-&gt;support_url . $this-&gt;version . '/#respond&quot;&gt;', '&lt;/a&gt;');&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        add_action('admin_notices', array($this, 'messages'));&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Exports a XML options document&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function opts_export()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Do a nonce check, prevent malicious link/form problems &nbsp;</div></li><li><div>        check_admin_referer($this-&gt;unique_prefix . '_admin_import_export');&nbsp;</div></li><li><div>        //Update our internal settings&nbsp;</div></li><li><div>        $this-&gt;opt = $this-&gt;get_option($this-&gt;unique_prefix . '_options');&nbsp;</div></li><li><div>        //Create a DOM document&nbsp;</div></li><li><div>        $dom = new DOMDocument('1.0', 'UTF-8');&nbsp;</div></li><li><div>        //Adds in newlines and tabs to the output&nbsp;</div></li><li><div>        $dom-&gt;formatOutput = true;&nbsp;</div></li><li><div>        //We're not using a DTD therefore we need to specify it as a standalone document&nbsp;</div></li><li><div>        $dom-&gt;xmlStandalone = true;&nbsp;</div></li><li><div>        //Add an element called options&nbsp;</div></li><li><div>        $node = $dom-&gt;createElement('options');&nbsp;</div></li><li><div>        $parnode = $dom-&gt;appendChild($node);&nbsp;</div></li><li><div>        //Add a child element named plugin&nbsp;</div></li><li><div>        $node = $dom-&gt;createElement('plugin');&nbsp;</div></li><li><div>        $plugnode = $parnode-&gt;appendChild($node);&nbsp;</div></li><li><div>        //Add some attributes that identify the plugin and version for the options export&nbsp;</div></li><li><div>        $plugnode-&gt;setAttribute('name', $this-&gt;short_name);&nbsp;</div></li><li><div>        $plugnode-&gt;setAttribute('version', $this-&gt;version);&nbsp;</div></li><li><div>        //Change our headder to text/xml for direct save&nbsp;</div></li><li><div>        header('Cache-Control: public');&nbsp;</div></li><li><div>        //The next two will cause good browsers to download instead of displaying the file&nbsp;</div></li><li><div>        header('Content-Description: File Transfer');&nbsp;</div></li><li><div>        header('Content-disposition: attachemnt; filename=' . $this-&gt;unique_prefix . '_settings.xml');&nbsp;</div></li><li><div>        header('Content-Type: text/xml');&nbsp;</div></li><li><div>        //Loop through the options array&nbsp;</div></li><li><div>        foreach($this-&gt;opt as $key=&gt;$option)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Add a option tag under the options tag, store the option value&nbsp;</div></li><li><div>            $node = $dom-&gt;createElement('option', htmlentities($option, ENT_COMPAT, 'UTF-8'));&nbsp;</div></li><li><div>            $newnode = $plugnode-&gt;appendChild($node);&nbsp;</div></li><li><div>            //Change the tag's name to that of the stored option&nbsp;</div></li><li><div>            $newnode-&gt;setAttribute('name', $key);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        //Prepair the XML for output&nbsp;</div></li><li><div>        $output = $dom-&gt;saveXML();&nbsp;</div></li><li><div>        //Let the browser know how long the file is&nbsp;</div></li><li><div>        header('Content-Length: ' . strlen($output)); // binary length&nbsp;</div></li><li><div>        //Output the file&nbsp;</div></li><li><div>        echo $output;&nbsp;</div></li><li><div>        //Prevent WordPress from continuing on&nbsp;</div></li><li><div>        die();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Imports a XML options document&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function opts_import()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Our quick and dirty error supressor&nbsp;</div></li><li><div>        function error($errno, $errstr, $eerfile, $errline)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        //Do a nonce check, prevent malicious link/form problems&nbsp;</div></li><li><div>        check_admin_referer($this-&gt;unique_prefix . '_admin_import_export');&nbsp;</div></li><li><div>        //Set the backup options in the DB to the current options&nbsp;</div></li><li><div>        $this-&gt;opts_backup();&nbsp;</div></li><li><div>        //Create a DOM document&nbsp;</div></li><li><div>        $dom = new DOMDocument('1.0', 'UTF-8');&nbsp;</div></li><li><div>        //We want to catch errors ourselves&nbsp;</div></li><li><div>        set_error_handler('error');&nbsp;</div></li><li><div>        //Load the user uploaded file, handle failure gracefully&nbsp;</div></li><li><div>        if($dom-&gt;load($_FILES[$this-&gt;unique_prefix . '_admin_import_file']['tmp_name']))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $opts_temp = array();&nbsp;</div></li><li><div>            $version = '';&nbsp;</div></li><li><div>            //Have to use an xpath query otherwise we run into problems&nbsp;</div></li><li><div>            $xpath = new DOMXPath($dom);  &nbsp;</div></li><li><div>            $option_sets = $xpath-&gt;query('plugin');&nbsp;</div></li><li><div>            //Loop through all of the xpath query results&nbsp;</div></li><li><div>            foreach($option_sets as $options)&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                //We only want to import options for only this plugin&nbsp;</div></li><li><div>                if($options-&gt;getAttribute('name') === $this-&gt;short_name)&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                    //Grab the file version&nbsp;</div></li><li><div>                    $version = $options-&gt;getAttribute('version');&nbsp;</div></li><li><div>                    //Loop around all of the options&nbsp;</div></li><li><div>                    foreach($options-&gt;getelementsByTagName('option') as $child)&nbsp;</div></li><li><div>                    {&nbsp;</div></li><li><div>                        //Place the option into the option array, DOMDocument decodes html entities for us&nbsp;</div></li><li><div>                        $opts_temp[$child-&gt;getAttribute('name')] = $child-&gt;nodeValue;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            //Make sure we safely import and upgrade settings if needed&nbsp;</div></li><li><div>            $this-&gt;opts_upgrade($opts_temp, $version);&nbsp;</div></li><li><div>            //Commit the loaded options to the database&nbsp;</div></li><li><div>            $this-&gt;update_option($this-&gt;unique_prefix . '_options', $this-&gt;opt);&nbsp;</div></li><li><div>            //Everything was successful, let the user know&nbsp;</div></li><li><div>            $this-&gt;message['updated fade'][] = __('Settings successfully imported from the uploaded file.', $this-&gt;identifier) . $this-&gt;admin_anchor('undo', __('Undo the options import.', $this-&gt;identifier), __('Undo', $this-&gt;identifier));&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Throw an error since we could not load the file for various reasons&nbsp;</div></li><li><div>            $this-&gt;message['error'][] = __('Importing settings from file failed.', $this-&gt;identifier);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        //Reset to the default error handler after we're done&nbsp;</div></li><li><div>        restore_error_handler();&nbsp;</div></li><li><div>        //Output any messages that there may be&nbsp;</div></li><li><div>        add_action('admin_notices', array($this, 'messages'));&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Resets the database settings array to the default set in opt&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function opts_reset()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Do a nonce check, prevent malicious link/form problems&nbsp;</div></li><li><div>        check_admin_referer($this-&gt;unique_prefix . '_admin_import_export');&nbsp;</div></li><li><div>        //Set the backup options in the DB to the current options&nbsp;</div></li><li><div>        $this-&gt;opts_backup();&nbsp;</div></li><li><div>        //Load in the hard coded default option values&nbsp;</div></li><li><div>        $this-&gt;update_option($this-&gt;unique_prefix . '_options', $this-&gt;opt);&nbsp;</div></li><li><div>        //Reset successful, let the user know&nbsp;</div></li><li><div>        $this-&gt;message['updated fade'][] = __('Settings successfully reset to the default values.', $this-&gt;identifier) . $this-&gt;admin_anchor('undo', __('Undo the options reset.', $this-&gt;identifier), __('Undo', $this-&gt;identifier));&nbsp;</div></li><li><div>        add_action('admin_notices', array($this, 'messages'));&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Undos the last settings save/reset/import&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function opts_undo()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Do a nonce check, prevent malicious link/form problems&nbsp;</div></li><li><div>        check_admin_referer($this-&gt;unique_prefix . '_admin_undo');&nbsp;</div></li><li><div>        //Set the options array to the current options&nbsp;</div></li><li><div>        $opt = $this-&gt;get_option($this-&gt;unique_prefix . '_options');&nbsp;</div></li><li><div>        //Set the options in the DB to the backup options&nbsp;</div></li><li><div>        $this-&gt;update_option($this-&gt;unique_prefix . '_options', $this-&gt;get_option($this-&gt;unique_prefix . '_options_bk'));&nbsp;</div></li><li><div>        //Set the backup options to the undone options&nbsp;</div></li><li><div>        $this-&gt;update_option($this-&gt;unique_prefix . '_options_bk', $opt);&nbsp;</div></li><li><div>        //Send the success/undo message&nbsp;</div></li><li><div>        $this-&gt;message['updated fade'][] = __('Settings successfully undid the last operation.', $this-&gt;identifier) . $this-&gt;admin_anchor('undo', __('Undo the last undo operation.', $this-&gt;identifier), __('Undo', $this-&gt;identifier));&nbsp;</div></li><li><div>        add_action('admin_notices', array($this, 'messages'));&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Upgrades input options array, sets to $this-&gt;opt, designed to be overwritten&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param array $opts&nbsp;</div></li><li><div>     * @param string $version the version of the passed in options&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function opts_upgrade($opts, $version)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //We don't support using newer versioned option files in older releases&nbsp;</div></li><li><div>        if(version_compare($this-&gt;version, $version, '&gt;='))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $this-&gt;opt = $opts;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Forces a database settings upgrade&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function opts_upgrade_wrapper()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //Do a nonce check, prevent malicious link/form problems&nbsp;</div></li><li><div>        check_admin_referer($this-&gt;unique_prefix . '_admin_upgrade');&nbsp;</div></li><li><div>        //Grab the database options&nbsp;</div></li><li><div>        $opts = $this-&gt;get_option($this-&gt;unique_prefix . '_options');&nbsp;</div></li><li><div>        if(is_array($opts))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Feed the just read options into the upgrade function&nbsp;</div></li><li><div>            $this-&gt;opts_upgrade($opts, $this-&gt;get_option($this-&gt;unique_prefix . '_version'));&nbsp;</div></li><li><div>            //Always have to update the version&nbsp;</div></li><li><div>            $this-&gt;update_option($this-&gt;unique_prefix . '_version', $this-&gt;version);&nbsp;</div></li><li><div>            //Store the options&nbsp;</div></li><li><div>            $this-&gt;update_option($this-&gt;unique_prefix . '_options', $this-&gt;opt);&nbsp;</div></li><li><div>            //Send the success message&nbsp;</div></li><li><div>            $this-&gt;message['updated fade'][] = __('Settings successfully migrated.', $this-&gt;identifier);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Run the install script&nbsp;</div></li><li><div>            $this-&gt;install();&nbsp;</div></li><li><div>            //Send the success message&nbsp;</div></li><li><div>            $this-&gt;message['updated fade'][] = __('Default settings successfully installed.', $this-&gt;identifier);&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        add_action('admin_notices', array($this, 'messages'));&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * help action hook function, meant to be overridden&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @return string&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function help()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $screen = get_current_screen();&nbsp;</div></li><li><div>        //Add contextual help on current screen&nbsp;</div></li><li><div>        if($screen-&gt;id == 'settings_page_' . $this-&gt;identifier)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Prints to screen all of the messages stored in the message member variable&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function messages()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if(count($this-&gt;message))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            //Loop through our message classes&nbsp;</div></li><li><div>            foreach($this-&gt;message as $key =&gt; $class)&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                //Loop through the messages in the current class&nbsp;</div></li><li><div>                foreach($class as $message)&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                    printf('&lt;div class=&quot;%s&quot;&gt;&lt;p&gt;%s&lt;/p&gt;&lt;/div&gt;', $key, $message);    &nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $this-&gt;message = array();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Function prototype to prevent errors&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function admin_styles()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Function prototype to prevent errors&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function admin_scripts()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Function prototype to prevent errors&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function admin_head()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Function prototype to prevent errors&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function admin_page()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Function prototype to prevent errors&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    protected function _get_help_text()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Returns a valid xHTML element ID&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param object $option&nbsp;</div></li><li><div>     * @return &nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_valid_id($option)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        if(is_numeric($option[0]))&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            return 'p' . $option;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            return $option;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    function import_form()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $form = '&lt;div id=&quot;mtekk_admin_import_export_relocate&quot;&gt;';&nbsp;</div></li><li><div>        $form .= sprintf('&lt;form action=&quot;options-general.php?page=%s&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; id=&quot;%s_admin_upload&quot;&gt;', $this-&gt;identifier, $this-&gt;unique_prefix);&nbsp;</div></li><li><div>        $form .= wp_nonce_field($this-&gt;unique_prefix . '_admin_import_export', '_wpnonce', true, false);&nbsp;</div></li><li><div>        $form .= sprintf('&lt;fieldset id=&quot;import_export&quot; class=&quot;%s_options&quot;&gt;', $this-&gt;unique_prefix);&nbsp;</div></li><li><div>        $form .= '&lt;p&gt;' . __('Import settings from a XML file, export the current settings to a XML file, or reset to the default settings.', $this-&gt;identifier) . '&lt;/p&gt;';&nbsp;</div></li><li><div>        $form .= '&lt;table class=&quot;form-table&quot;&gt;&lt;tr valign=&quot;top&quot;&gt;&lt;th scope=&quot;row&quot;&gt;';&nbsp;</div></li><li><div>        $form .= sprintf('&lt;label for=&quot;%s_admin_import_file&quot;&gt;', $this-&gt;unique_prefix);&nbsp;</div></li><li><div>        $form .= __('Settings File', $this-&gt;identifier);&nbsp;</div></li><li><div>        $form .= '&lt;/label&gt;&lt;/th&gt;&lt;td&gt;';&nbsp;</div></li><li><div>        $form .= sprintf('&lt;input type=&quot;file&quot; name=&quot;%s_admin_import_file&quot; id=&quot;%s_admin_import_file&quot; size=&quot;32&quot; /&gt;&lt;p class=&quot;description&quot;&gt;', $this-&gt;unique_prefix, $this-&gt;unique_prefix);&nbsp;</div></li><li><div>        $form .= __('Select a XML settings file to upload and import settings from.', 'breadcrumb_navxt');&nbsp;</div></li><li><div>        $form .= '&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p class=&quot;submit&quot;&gt;';&nbsp;</div></li><li><div>        $form .= sprintf('&lt;input type=&quot;submit&quot; class=&quot;button&quot; name=&quot;%s_admin_import&quot; value=&quot;' . __('Import', $this-&gt;identifier) . '&quot;/&gt;', $this-&gt;unique_prefix, $this-&gt;unique_prefix);&nbsp;</div></li><li><div>        $form .= sprintf('&lt;input type=&quot;submit&quot; class=&quot;button&quot; name=&quot;%s_admin_export&quot; value=&quot;' . __('Export', $this-&gt;identifier) . '&quot;/&gt;', $this-&gt;unique_prefix);&nbsp;</div></li><li><div>        $form .= sprintf('&lt;input type=&quot;submit&quot; class=&quot;button&quot; name=&quot;%s_admin_reset&quot; value=&quot;' . __('Reset', $this-&gt;identifier) . '&quot;/&gt;', $this-&gt;unique_prefix, $this-&gt;unique_prefix);&nbsp;</div></li><li><div>        $form .= '&lt;/p&gt;&lt;/fieldset&gt;&lt;/form&gt;&lt;/div&gt;';&nbsp;</div></li><li><div>        return $form;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * This will output a well formed hidden option&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $option&nbsp;</div></li><li><div>     * @return &nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function input_hidden($option)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $optid = $this-&gt;get_valid_id($option);?&gt;&nbsp;</div></li><li><div>        &lt;input type=&quot;hidden&quot; name=&quot;&lt;?php echo $this-&gt;unique_prefix . '_options[' . $option;?&gt;]&quot; id=&quot;&lt;?php echo $optid;?&gt;&quot; value=&quot;&lt;?php echo htmlentities($this-&gt;opt[$option], ENT_COMPAT, 'UTF-8');?&gt;&quot;/&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * This will output a well formed table row for a text input&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $label&nbsp;</div></li><li><div>     * @param string $option&nbsp;</div></li><li><div>     * @param string $class [optional]&nbsp;</div></li><li><div>     * @param bool $disable [optional]&nbsp;</div></li><li><div>     * @param string $description [optional]&nbsp;</div></li><li><div>     * @return &nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function input_text($label, $option, $class = 'regular-text', $disable = false, $description = '')&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $optid = $this-&gt;get_valid_id($option);&nbsp;</div></li><li><div>        if($disable)&nbsp;</div></li><li><div>        {?&gt;&nbsp;</div></li><li><div>            &lt;input type=&quot;hidden&quot; name=&quot;&lt;?php echo $this-&gt;unique_prefix . '_options[' . $option;?&gt;]&quot; value=&quot;&lt;?php echo htmlentities($this-&gt;opt[$option], ENT_COMPAT, 'UTF-8');?&gt;&quot; /&gt;&nbsp;</div></li><li><div>        &lt;?php } ?&gt;&nbsp;</div></li><li><div>        &lt;tr valign=&quot;top&quot;&gt;&nbsp;</div></li><li><div>            &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;&lt;?php echo $optid;?&gt;&quot;&gt;&lt;?php echo $label;?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;text&quot; name=&quot;&lt;?php echo $this-&gt;unique_prefix . '_options[' . $option;?&gt;]&quot; id=&quot;&lt;?php echo $optid;?&gt;&quot; &lt;?php if($disable) {echo 'disabled=&quot;disabled&quot;'; $class .= ' disabled';}?&gt; value=&quot;&lt;?php echo htmlentities($this-&gt;opt[$option], ENT_COMPAT, 'UTF-8');?&gt;&quot; class=&quot;&lt;?php echo $class;?&gt;&quot; /&gt;&lt;br /&gt;&nbsp;</div></li><li><div>                    &lt;?php if($description !== '') {?&gt;&lt;p class=&quot;description&quot;&gt;&lt;?php echo $description;?&gt;&lt;/p&gt;&lt;?php }?&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>        &lt;/tr&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * This will output a well formed table row for a HTML5 number input&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $label&nbsp;</div></li><li><div>     * @param string $option&nbsp;</div></li><li><div>     * @param string $class [optional]&nbsp;</div></li><li><div>     * @param bool $disable [optional]&nbsp;</div></li><li><div>     * @param string $description [optional]&nbsp;</div></li><li><div>     * @param int|string $min [optional] &nbsp;</div></li><li><div>     * @param int|string $max [optional]&nbsp;</div></li><li><div>     * @param int|string $step [optional]&nbsp;</div></li><li><div>     * @return &nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function input_number($label, $option, $class = 'small-text', $disable = false, $description = '', $min = '', $max = '', $step = '')&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $optid = $this-&gt;get_valid_id($option);&nbsp;</div></li><li><div>        $extras = '';&nbsp;</div></li><li><div>        if($min !== '')&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $extras .= 'min=&quot;' . $min . '&quot; ';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if($max !== '')&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $extras .= 'max=&quot;' . $max . '&quot; ';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if($step !== '')&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $extras .= 'step=&quot;' . $step . '&quot; ';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if($disable)&nbsp;</div></li><li><div>        {?&gt;&nbsp;</div></li><li><div>            &lt;input type=&quot;hidden&quot; name=&quot;&lt;?php echo $this-&gt;unique_prefix . '_options[' . $option;?&gt;]&quot; value=&quot;&lt;?php echo htmlentities($this-&gt;opt[$option], ENT_COMPAT, 'UTF-8');?&gt;&quot; /&gt;&nbsp;</div></li><li><div>        &lt;?php } ?&gt;&nbsp;</div></li><li><div>        &lt;tr valign=&quot;top&quot;&gt;&nbsp;</div></li><li><div>            &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;&lt;?php echo $optid;?&gt;&quot;&gt;&lt;?php echo $label;?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&nbsp;</div></li><li><div>                &lt;input type=&quot;number&quot; name=&quot;&lt;?php echo $this-&gt;unique_prefix . '_options[' . $option;?&gt;]&quot; id=&quot;&lt;?php echo $optid;?&gt;&quot; &lt;?php echo $extras;?&gt;&lt;?php if($disable) {echo 'disabled=&quot;disabled&quot;'; $class .= ' disabled';}?&gt; value=&quot;&lt;?php echo htmlentities($this-&gt;opt[$option], ENT_COMPAT, 'UTF-8');?&gt;&quot; class=&quot;&lt;?php echo $class;?&gt;&quot; /&gt;&lt;br /&gt;&nbsp;</div></li><li><div>                    &lt;?php if($description !== '') {?&gt;&lt;p class=&quot;description&quot;&gt;&lt;?php echo $description;?&gt;&lt;/p&gt;&lt;?php }?&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>        &lt;/tr&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * This will output a well formed textbox&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $label&nbsp;</div></li><li><div>     * @param string $option&nbsp;</div></li><li><div>     * @param string $rows [optional]&nbsp;</div></li><li><div>     * @param bool $disable [optional]&nbsp;</div></li><li><div>     * @param string $description [optional]&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function textbox($label, $option, $height = '3', $disable = false, $description = '')&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $optid = $this-&gt;get_valid_id($option);?&gt;&nbsp;</div></li><li><div>        &lt;p&gt;&nbsp;</div></li><li><div>            &lt;label for=&quot;&lt;?php echo $optid;?&gt;&quot;&gt;&lt;?php echo $label;?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>        &lt;/p&gt;&nbsp;</div></li><li><div>        &lt;textarea rows=&quot;&lt;?php echo $height;?&gt;&quot; &lt;?php if($disable) {echo 'disabled=&quot;disabled&quot; class=&quot;large-text code disabled&quot;';}else{echo 'class=&quot;large-text code&quot;';}?&gt; id=&quot;&lt;?php echo $optid;?&gt;&quot; name=&quot;&lt;?php echo $this-&gt;unique_prefix . '_options[' . $option;?&gt;]&quot;&gt;&lt;?php echo htmlentities($this-&gt;opt[$option], ENT_COMPAT, 'UTF-8');?&gt;&lt;/textarea&gt;&lt;br /&gt;&nbsp;</div></li><li><div>        &lt;?php if($description !== '') {?&gt;&lt;p class=&quot;description&quot;&gt;&lt;?php echo $description;?&gt;&lt;/p&gt;&lt;?php }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * This will output a well formed tiny mce ready textbox&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $label&nbsp;</div></li><li><div>     * @param string $option&nbsp;</div></li><li><div>     * @param string $rows [optional]&nbsp;</div></li><li><div>     * @param bool $disable [optional]&nbsp;</div></li><li><div>     * @param string $description [optional]&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function tinymce($label, $option, $height = '3', $disable = false, $description = '')&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $optid = $this-&gt;get_valid_id($option);&nbsp;</div></li><li><div>        if($disable)&nbsp;</div></li><li><div>        {?&gt;&nbsp;</div></li><li><div>            &lt;input type=&quot;hidden&quot; name=&quot;&lt;?php echo $this-&gt;unique_prefix . '_options[' . $option;?&gt;]&quot; value=&quot;&lt;?php echo htmlentities($this-&gt;opt[$option], ENT_COMPAT, 'UTF-8');?&gt;&quot; /&gt;&nbsp;</div></li><li><div>        &lt;?php } ?&gt;&nbsp;</div></li><li><div>        &lt;tr valign=&quot;top&quot;&gt;&nbsp;</div></li><li><div>            &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;&lt;?php echo $optid;?&gt;&quot;&gt;&lt;?php echo $label;?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&nbsp;</div></li><li><div>                &lt;textarea rows=&quot;&lt;?php echo $height;?&gt;&quot; &lt;?php if($disable) {echo 'disabled=&quot;disabled&quot; class=&quot;mtekk_mce disabled&quot;';}else{echo 'class=&quot;mtekk_mce&quot;';}?&gt; id=&quot;&lt;?php echo $optid;?&gt;&quot; name=&quot;&lt;?php echo $this-&gt;unique_prefix . '_options[' . $option;?&gt;]&quot;&gt;&lt;?php echo htmlentities($this-&gt;opt[$option], ENT_COMPAT, 'UTF-8');?&gt;&lt;/textarea&gt;&lt;br /&gt;&nbsp;</div></li><li><div>                &lt;?php if($description !== '') {?&gt;&lt;p class=&quot;description&quot;&gt;&lt;?php echo $description;?&gt;&lt;/p&gt;&lt;?php }?&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>        &lt;/tr&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * This will output a well formed table row for a checkbox input&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $label&nbsp;</div></li><li><div>     * @param string $option&nbsp;</div></li><li><div>     * @param string $instruction&nbsp;</div></li><li><div>     * @param bool $disable [optional]&nbsp;</div></li><li><div>     * @param string $description [optional]&nbsp;</div></li><li><div>     * @return &nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function input_check($label, $option, $instruction, $disable = false, $description = '')&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $optid = $this-&gt;get_valid_id($option);?&gt;&nbsp;</div></li><li><div>        &lt;tr valign=&quot;top&quot;&gt;&nbsp;</div></li><li><div>            &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;&lt;?php echo $optid;?&gt;&quot;&gt;&lt;?php echo $label;?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;    &nbsp;</div></li><li><div>                &lt;label&gt;&nbsp;</div></li><li><div>                    &lt;input type=&quot;checkbox&quot; name=&quot;&lt;?php echo $this-&gt;unique_prefix . '_options[' . $option;?&gt;]&quot; id=&quot;&lt;?php echo $optid;?&gt;&quot; &lt;?php if($disable) {echo 'disabled=&quot;disabled&quot; class=&quot;disabled&quot;';}?&gt; value=&quot;true&quot; &lt;?php checked(true, $this-&gt;opt[$option]);?&gt; /&gt;&nbsp;</div></li><li><div>                        &lt;?php echo $instruction; ?&gt;                &nbsp;</div></li><li><div>                &lt;/label&gt;&lt;br /&gt;&nbsp;</div></li><li><div>                &lt;?php if($description !== '') {?&gt;&lt;p class=&quot;description&quot;&gt;&lt;?php echo $description;?&gt;&lt;/p&gt;&lt;?php }?&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>        &lt;/tr&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * This will output a singular radio type form input field&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $option&nbsp;</div></li><li><div>     * @param string $value&nbsp;</div></li><li><div>     * @param string $instruction&nbsp;</div></li><li><div>     * @param object $disable [optional]&nbsp;</div></li><li><div>     * @return &nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function input_radio($option, $value, $instruction, $disable = false)&nbsp;</div></li><li><div>    {?&gt;&nbsp;</div></li><li><div>        &lt;label&gt;&nbsp;</div></li><li><div>            &lt;input name=&quot;&lt;?php echo $this-&gt;unique_prefix . '_options[' . $option;?&gt;]&quot; type=&quot;radio&quot; &lt;?php if($disable) {echo 'disabled=&quot;disabled&quot; class=&quot;disabled togx&quot;';}else{echo 'class=&quot;togx&quot;';}?&gt; value=&quot;&lt;?php echo $value;?&gt;&quot; &lt;?php checked($value, $this-&gt;opt[$option]);?&gt; /&gt;&nbsp;</div></li><li><div>            &lt;?php echo $instruction; ?&gt;&nbsp;</div></li><li><div>        &lt;/label&gt;&lt;br/&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * This will output a well formed table row for a select input&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $label&nbsp;</div></li><li><div>     * @param string $option&nbsp;</div></li><li><div>     * @param array $values&nbsp;</div></li><li><div>     * @param bool $disable [optional]&nbsp;</div></li><li><div>     * @param string $description [optional]&nbsp;</div></li><li><div>     * @return &nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function input_select($label, $option, $values, $disable = false, $description = '', $titles = false)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        //If we don't have titles passed in, we'll use option names as values&nbsp;</div></li><li><div>        if(!$titles)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            $titles = $values;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $optid = $this-&gt;get_valid_id($option);?&gt;&nbsp;</div></li><li><div>        &lt;tr valign=&quot;top&quot;&gt;&nbsp;</div></li><li><div>            &lt;th scope=&quot;row&quot;&gt;&nbsp;</div></li><li><div>                &lt;label for=&quot;&lt;?php echo $optid;?&gt;&quot;&gt;&lt;?php echo $label;?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>            &lt;/th&gt;&nbsp;</div></li><li><div>            &lt;td&gt;&nbsp;</div></li><li><div>                &lt;select name=&quot;&lt;?php echo $this-&gt;unique_prefix . '_options[' . $option;?&gt;]&quot; id=&quot;&lt;?php echo $optid;?&gt;&quot; &lt;?php if($disable) {echo 'disabled=&quot;disabled&quot; class=&quot;disabled&quot;';}?&gt;&gt;&nbsp;</div></li><li><div>                    &lt;?php $this-&gt;select_options($option, $titles, $values); ?&gt;&nbsp;</div></li><li><div>                &lt;/select&gt;&lt;br /&gt;&nbsp;</div></li><li><div>                &lt;?php if($description !== '') {?&gt;&lt;p class=&quot;description&quot;&gt;&lt;?php echo $description;?&gt;&lt;/p&gt;&lt;?php }?&gt;&nbsp;</div></li><li><div>            &lt;/td&gt;&nbsp;</div></li><li><div>        &lt;/tr&gt;&nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Displays wordpress options as &lt;seclect&gt;&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @param string $optionname name of wordpress options store&nbsp;</div></li><li><div>     * @param array $options array of names of options that can be selected&nbsp;</div></li><li><div>     * @param array $exclude[optional] array of names in $options array to be excluded&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function select_options($optionname, $options, $values, $exclude = array())&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $value = $this-&gt;opt[$optionname];&nbsp;</div></li><li><div>        //Now do the rest&nbsp;</div></li><li><div>        foreach($options as $key =&gt; $option)&nbsp;</div></li><li><div>        {&nbsp;</div></li><li><div>            if(!in_array($option, $exclude))&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                printf('&lt;option value=&quot;%s&quot; %s&gt;%s&lt;/option&gt;', $values[$key], selected(true, ($value == $values[$key]), false), $option);&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * A local pass through for get_option so that we can hook in and pick the correct method if needed&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $option The name of the option to retrieve&nbsp;</div></li><li><div>     * @return mixed The value of the option&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function get_option($option)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return get_option($option);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * A local pass through for update_option so that we can hook in and pick the correct method if needed&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $option The name of the option to update&nbsp;</div></li><li><div>     * @param mixed $newvalue The new value to set the option to&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function update_option($option, $newvalue)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return update_option($option, $newvalue);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * A local pass through for add_option so that we can hook in and pick the correct method if needed&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $option The name of the option to update&nbsp;</div></li><li><div>     * @param mixed $value The new value to set the option to&nbsp;</div></li><li><div>     * @param null $deprecated Deprecated parameter&nbsp;</div></li><li><div>     * @param string $autoload Whether or not to autoload the option, it's a string because WP is special&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function add_option($option, $value = '', $deprecated = '', $autoload = 'yes')&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return add_option($option, $value, null, $autoload);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * A local pass through for delete_option so that we can hook in and pick the correct method if needed&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @param string $option The name of the option to delete&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function delete_option($option)&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        return delete_option($option);&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd> <a href="http://hookr.io/plugins/breadcrumb-navxt-5-0-migration-compatibility-layer-do-not-activate/5.1.1/classes/mtekk_admin_kit/">5.1.1</a></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>mtekk_adminKit</li><li><span></span>Breadcrumb NavXT 5.0 Migration Compatibility Layer DO NOT ACTIVATE</li><li><span></span>5.1.1</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>