<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="2.2.3" data-slug="google-photos-picasa-viewer" data-type="class" data-id="39805"><head xmlns="http://www.w3.org/1999/xhtml"><title> cws_google_picasa_pro_admin | class | Google Photos Picasa Viewer | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="CWS_Google_Picasa_Pro_Admin, class, plugin, google-photos-picasa-viewer, 2.2.3" /><meta name="description" content="The admin-specific functionality of the plugin." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=6b5460d7487fb1b81fb16b926b7682f3' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/cws_google_picasa_pro_admin/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fcws_google_picasa_pro_admin%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Fcws_google_picasa_pro_admin%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-google-photos-picasa-viewer-2.2.3-class-cws_google_picasa_pro_admin","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="cws_google_picasa_pro_admin" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to google-photos-picasa-viewer." href="http://hookr.io/plugins/google-photos-picasa-viewer/" class="plugin"><span property="name">google-photos-picasa-viewer</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.2.3." href="http://hookr.io/plugins/google-photos-picasa-viewer/2.2.3/" class="H_VERSION"><span property="name">2.2.3</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/google-photos-picasa-viewer/2.2.3/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">cws_google_picasa_pro_admin</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="2810"><a href="http://hookr.io/plugins/google-photos-picasa-viewer/2.2.3/all/" title="All">All <span class="count badge">2810</span></a></li><li class="" data-id="new" data-count="0"><a href="http://hookr.io/plugins/google-photos-picasa-viewer/2.2.3/new/" title="New">New <span class="count badge">0</span></a></li><li class="" data-id="hooks" data-count="7"><a href="http://hookr.io/plugins/google-photos-picasa-viewer/2.2.3/hooks/" title="Hooks">Hooks <span class="count badge">7</span></a></li><li class="" data-id="action" data-count="0"><a href="http://hookr.io/plugins/google-photos-picasa-viewer/2.2.3/actions/" title="Actions">Actions <span class="count badge">0</span></a></li><li class="" data-id="filter" data-count="7"><a href="http://hookr.io/plugins/google-photos-picasa-viewer/2.2.3/filters/" title="Filters">Filters <span class="count badge">7</span></a></li><li class="active" data-id="class" data-count="2790"><a href="http://hookr.io/plugins/google-photos-picasa-viewer/2.2.3/classes/" title="Classes">Classes <span class="count badge">2790</span></a></li><li class="" data-id="constant" data-count="0"><a href="http://hookr.io/plugins/google-photos-picasa-viewer/2.2.3/constants/" title="Constants">Constants <span class="count badge">0</span></a></li><li class="" data-id="function" data-count="11"><a href="http://hookr.io/plugins/google-photos-picasa-viewer/2.2.3/functions/" title="Functions">Functions <span class="count badge">11</span></a></li><li class="" data-id="shortcode" data-count="2"><a href="http://hookr.io/plugins/google-photos-picasa-viewer/2.2.3/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">2</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>CWS_Google_Picasa_Pro_Admin</strong></h1><p>The admin-specific functionality of the plugin.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/google-photos-picasa-viewer/2.2.3/files/admin-class-cws-google-picasa-pro-admin/" class="file">/admin/class-cws-google-picasa-pro-admin.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="23" class="block" start="23"><li><div>class CWS_Google_Picasa_Pro_Admin {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    var $debug = false;&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * The ID of this plugin.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     * @access   private&nbsp;</div></li><li><div>     * @var      string    $plugin_name    The ID of this plugin.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private $plugin_name;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * The version of this plugin.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     * @access   private&nbsp;</div></li><li><div>     * @var      string    $version    The current version of this plugin.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    private $version;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * The is user authenticated with Google.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     * @access   private&nbsp;</div></li><li><div>     * @var      int    $authenticated    Check is user authenticated with Google.&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    private $authenticated = 0;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * The check is this a Pro version.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     * @access   private&nbsp;</div></li><li><div>     * @var      int    $isPro    Check is if this is pro version.&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    private $isPro ;  &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * User Id used to check ignore upgrade notice.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.1.1&nbsp;</div></li><li><div>     * @access   private&nbsp;</div></li><li><div>     * @var      int    $userId    User Id of loggedin user.&nbsp;</div></li><li><div>     */ &nbsp;</div></li><li><div>    private $userId;&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    var $client; // Used for Google Client&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Initialize the class and set its properties.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     * @param      string    $plugin_name       The name of this plugin.&nbsp;</div></li><li><div>     * @param      string    $version    The version of this plugin.&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function __construct( $plugin_name, $version, $isPro ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;plugin_name = $plugin_name;&nbsp;</div></li><li><div>        $this-&gt;version = $version;&nbsp;</div></li><li><div>        $this-&gt;isPro = $isPro;&nbsp;</div></li><li><div>        $this-&gt;client = new Google_Client();&nbsp;</div></li><li><div>        $this-&gt;client-&gt;setApplicationName(&quot;Client_Library_Examples&quot;);&nbsp;</div></li><li><div>        $this-&gt;client-&gt;setDeveloperKey(&quot;AIzaSyCP9XMYoQdxXfI-gK1bvZDW2RxyfvYENuM&quot;);  &nbsp;</div></li><li><div>        $this-&gt;client-&gt;setClientId('806353319710-g782kn9ed0gm77ucl0meen5ohs84qgqm.apps.googleusercontent.com');&nbsp;</div></li><li><div>        $this-&gt;client-&gt;setClientSecret('P6BMMEWLKUSoxB48X2Tzu8ds');&nbsp;</div></li><li><div>        $this-&gt;client-&gt;setRedirectUri('urn:ietf:wg:oauth:2.0:oob');&nbsp;</div></li><li><div>        $this-&gt;client-&gt;setScopes('https://picasaweb.google.com/data/');&nbsp;</div></li><li><div>        $this-&gt;client-&gt;setAccessType('offline');&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        // Include required files&nbsp;</div></li><li><div>        $this-&gt;includes();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;cws_gpp_admin_installed_notice();&nbsp;</div></li><li><div>        //$this-&gt;cws_gpp_admin_notices_styles();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Register the stylesheets for the admin area.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    1.0.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function includes() {&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>        if( $this-&gt;debug ) error_log( 'Inside: CWS_WPPicasaPro::includes()' );&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        if ( is_admin() ) $this-&gt;admin_includes();&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        include_once( dirname(__FILE__) . '/../cws-gpp-functions.php' );                // TODO: split file out in admin and non-admin functions&nbsp;</div></li><li><div>        include_once( dirname(__FILE__) . '/../shortcodes/shortcode-init.php' );        // Init the shortcodes&nbsp;</div></li><li><div>        include_once( dirname(__FILE__) . '/../widgets/widget-init.php' );                // Widget classes        &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function admin_includes() {&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>        if( $this-&gt;debug ) error_log( 'Inside: CWS_WPPicasaPro::admin_includes()' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        include_once( dirname(__FILE__) . '/../cws-gpp-functions.php' );                // TODO: split file out in admin and non-admin functions&nbsp;</div></li><li><div>    }    &nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Register the stylesheets for the admin area.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function enqueue_styles() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * This function is provided for demonstration purposes only.&nbsp;</div></li><li><div>         *&nbsp;</div></li><li><div>         * An instance of this class should be passed to the run() function&nbsp;</div></li><li><div>         * defined in Plugin_Name_Loader as all of the hooks are defined&nbsp;</div></li><li><div>         * in that particular class.&nbsp;</div></li><li><div>         *&nbsp;</div></li><li><div>         * The Plugin_Name_Loader will then create the relationship&nbsp;</div></li><li><div>         * between the defined hooks and the functions defined in this&nbsp;</div></li><li><div>         * class.&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        wp_enqueue_style( $this-&gt;plugin_name, plugin_dir_url( __FILE__ ) . 'css/cws-google-picasa-pro-admin.css', array(), $this-&gt;version, 'all' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Register the JavaScript for the admin area.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function enqueue_scripts() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /**&nbsp;</div></li><li><div>         * This function is provided for demonstration purposes only.&nbsp;</div></li><li><div>         *&nbsp;</div></li><li><div>         * An instance of this class should be passed to the run() function&nbsp;</div></li><li><div>         * defined in Plugin_Name_Loader as all of the hooks are defined&nbsp;</div></li><li><div>         * in that particular class.&nbsp;</div></li><li><div>         *&nbsp;</div></li><li><div>         * The Plugin_Name_Loader will then create the relationship&nbsp;</div></li><li><div>         * between the defined hooks and the functions defined in this&nbsp;</div></li><li><div>         * class.&nbsp;</div></li><li><div>         */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        wp_enqueue_script( $this-&gt;plugin_name, plugin_dir_url( __FILE__ ) . 'js/cws-google-picasa-pro-admin.js', array( 'jquery' ), $this-&gt;version, false );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Check if the plugin is a Pro version.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */  &nbsp;</div></li><li><div>    private function get_Pro( $isPro ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( $isPro == 1 ) {&nbsp;</div></li><li><div>            return &quot;Pro&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Register the Options for the admin area.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    public function add_options_page() {&nbsp;</div></li><li><div>       &nbsp;</div></li><li><div>        $strIsPro = $this-&gt;get_Pro( $this-&gt;isPro );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // add_options_page( $page_title, $menu_title, $capability, $menu_slug, $function);&nbsp;</div></li><li><div>        add_options_page( 'Google Picasa ' . $strIsPro, 'Google Picasa '. $strIsPro, 'manage_options', 'cws_gpp', array( $this, 'options_page') );  &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Draw the Options page for the admin area.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function options_page() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    if( $this-&gt;deauthorizeGoogleAccount() ) {&nbsp;</div></li><li><div>        // TODO: finsish this delete_option unset()&nbsp;</div></li><li><div>        delete_option( 'cws_gpp_reset' );&nbsp;</div></li><li><div>        delete_option( 'cws_gpp_token_expires' );&nbsp;</div></li><li><div>        delete_option( 'cws_gpp_code' );&nbsp;</div></li><li><div>        delete_option( 'cws_gpp_access_token' );&nbsp;</div></li><li><div>    } ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;div class=&quot;wrap&quot;&gt;&nbsp;</div></li><li><div>        &lt;?php screen_icon(); ?&gt;&nbsp;</div></li><li><div>            &lt;h2&gt;Google Picasa &lt;?php echo $this-&gt;get_Pro( $this-&gt;isPro );?&gt; Settings&lt;/h2&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;div class=&quot;widget-liquid-left&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;form action=&quot;options.php&quot; method=&quot;post&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;?php &nbsp;</div></li><li><div>                // Step 1:  The user has not authenticated we give them a link to login    &nbsp;</div></li><li><div>                if( $this-&gt;isAuthenticated() !== true ) {&nbsp;</div></li><li><div>                    // settings_fields( $option_group )&nbsp;</div></li><li><div>                    // Output nonce, action, and option_page fields for a settings page. Please note that this function must be called inside of the form tag for the options page.&nbsp;</div></li><li><div>                    // $option_group - A settings group name. This should match the group name used in register_setting(). &nbsp;</div></li><li><div>                    settings_fields( 'cws_gpp_code' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    // do_settings_sections( $page );&nbsp;</div></li><li><div>                    // Prints out all settings sections added to a particular settings page.&nbsp;</div></li><li><div>                    // The slug name of the page whose settings sections you want to output. This should match the page name used in add_settings_section().&nbsp;</div></li><li><div>                    do_settings_sections( 'cws_gpp' ); &nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                        &lt;input name=&quot;Submit&quot; type=&quot;submit&quot; value=&quot;Save Changes&quot; /&gt;  &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;/form&gt; &nbsp;</div></li><li><div>                    &lt;?php&nbsp;</div></li><li><div>                } &nbsp;</div></li><li><div>                else {&nbsp;</div></li><li><div>                    /**&nbsp;</div></li><li><div>                     * User is authenticated so display plugin config settings&nbsp;</div></li><li><div>                     * &nbsp;</div></li><li><div>                     */&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    // Get Access Token&nbsp;</div></li><li><div>                    $token = $this-&gt;getAccessToken();&nbsp;</div></li><li><div>                    &nbsp;</div></li><li><div>                    settings_fields( 'cws_gpp_options' );&nbsp;</div></li><li><div>                    do_settings_sections( 'cws_gpp_defaults' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    ?&gt;&nbsp;</div></li><li><div>                        &lt;input name=&quot;Submit&quot; type=&quot;submit&quot; value=&quot;Save Changes&quot; /&gt;  &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;/form&gt; &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                     &lt;form action=&quot;options.php&quot; method=&quot;post&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                        &lt;?php&nbsp;</div></li><li><div>                            settings_fields( 'cws_gpp_reset' );&nbsp;</div></li><li><div>                            do_settings_sections( 'cws_gpp_reset' );  &nbsp;</div></li><li><div>                        ?&gt;&nbsp;</div></li><li><div>                        &lt;input name=&quot;Submit&quot; type=&quot;submit&quot; value=&quot;Deauthorise&quot; /&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;/form&gt;                             &nbsp;</div></li><li><div>                    &lt;?php                      &nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            &lt;/div&gt;&lt;!-- / left --&gt;&nbsp;</div></li><li><div>                &lt;?php $this-&gt;cws_gpp_meta_box_feedback(); ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                if( !$this-&gt;isPro == 1 ) {&nbsp;</div></li><li><div>                    // Only call for the upgrade meta box if this is not a Pro install&nbsp;</div></li><li><div>                    $this-&gt;cws_gpp_meta_box_pro(); &nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;?php&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // Display a feedback links&nbsp;</div></li><li><div>    public function cws_gpp_meta_box_feedback() {&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        &lt;div class=&quot;widget-liquid-right&quot;&gt;&nbsp;</div></li><li><div>            &lt;div id=&quot;widgets-right&quot;&gt;    &nbsp;</div></li><li><div>                &lt;div style=&quot;width:20%;&quot; class=&quot;postbox-container side&quot;&gt;&nbsp;</div></li><li><div>                    &lt;div class=&quot;metabox-holder&quot;&gt;&nbsp;</div></li><li><div>                        &lt;div class=&quot;postbox&quot; id=&quot;feedback&quot;&gt;&nbsp;</div></li><li><div>                            &lt;h3&gt;&lt;span&gt;Please rate the plugin!&lt;/span&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                            &lt;div class=&quot;inside&quot;&gt;                            &nbsp;</div></li><li><div>                                &lt;p&gt;If you have found this useful please leave us a &lt;a href=&quot;http://wordpress.org/extend/plugins/google-picasa-albums-viewer/&quot;&gt;good rating&lt;/a&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                                &lt;p&gt;&raquo; Share it with your friends &lt;a href=&quot;&lt;?php echo &quot;http://twitter.com/share?url=http://bit.ly/q4nqNA&text=Check out this awesome WordPress Plugin I'm using - Google Picasa Viewer&quot; ?&gt;&quot;&gt;Tweet It&lt;/a&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                                &lt;p&gt;If you have found a bug please email me &lt;a href=&quot;mailto:info@cheshirewebsolutions.com?subject=Feedback%20Google%20Picasa%20Viewer&quot;&gt;info@cheshirewebsolutions.com&lt;/a&gt;&lt;/p&gt;                               &nbsp;</div></li><li><div>                        &lt;/div&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;  &nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>    &lt;/div&gt;  &nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // Display a Picasa Pro Promo Box&nbsp;</div></li><li><div>    function cws_gpp_meta_box_pro() {&nbsp;</div></li><li><div>    ?&gt;&nbsp;</div></li><li><div>    &lt;div class=&quot;widget-liquid-right&quot;&gt;&nbsp;</div></li><li><div>&lt;div id=&quot;widgets-right&quot;&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    &lt;div style=&quot;width:20%;&quot; class=&quot;postbox-container side&quot;&gt;&nbsp;</div></li><li><div>        &lt;div class=&quot;metabox-holder&quot;&gt;&nbsp;</div></li><li><div>            &lt;div class=&quot;postbox&quot; id=&quot;donate&quot;&gt;&nbsp;</div></li><li><div>                &lt;h3&gt;&lt;span&gt;Get Google Picasa Pro!&lt;/span&gt;&lt;/h3&gt;&nbsp;</div></li><li><div>                    &lt;div class=&quot;inside&quot;&gt;&nbsp;</div></li><li><div>                        &lt;p&gt;Grab yourself the &lt;a href=&quot;http://www.cheshirewebsolutions.com/?utm_source=cws_gpp_config&utm_medium=text-link&utm_content=meta_box_pro&utm_campaign=cws_gpp_plugin&quot;&gt;Pro&lt;/a&gt; version of the plugin.                        &lt;a href=&quot;http://www.cheshirewebsolutions.com/?utm_source=wp_gp_viewer&utm_medium=wp_plugin&utm_content=meta_box_download_it_here&utm_campaign=plugin_upgrade&quot;&gt;Download it here&lt;/a&gt;&lt;/p&gt;&nbsp;</div></li><li><div>                        &lt;p&gt;&nbsp;</div></li><li><div>                            Reasons to UPGRADE!&nbsp;</div></li><li><div>                        &lt;/p&gt;&nbsp;</div></li><li><div>                        &lt;ol&gt;&nbsp;</div></li><li><div>                            &lt;li&gt;Priority Support&lt;/li&gt;&nbsp;</div></li><li><div>                            &lt;li&gt;'Powerd By' link removed&lt;/li&gt;&nbsp;</div></li><li><div>                            &lt;li&gt;More shortcodes for advanced&nbsp;layouts&lt;/li&gt;&nbsp;</div></li><li><div>                            &lt;li&gt;More layouts coming soon&lt;/li&gt;&nbsp;</div></li><li><div>                        &lt;/ol&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>            &lt;/div&gt;&nbsp;</div></li><li><div>        &lt;/div&gt;&nbsp;</div></li><li><div>    &lt;/div&gt;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&lt;/div&gt;&nbsp;</div></li><li><div>&lt;/div&gt;&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    &lt;?php&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Register Settings, Settings Section and Settings Fileds.&nbsp;</div></li><li><div>     * &nbsp;</div></li><li><div>     * @link    https://codex.wordpress.org/Function_Reference/register_setting&nbsp;</div></li><li><div>     * @link    https://codex.wordpress.org/Function_Reference/add_settings_section&nbsp;</div></li><li><div>     * @link    https://codex.wordpress.org/Function_Reference/add_settings_field&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    public function register_plugin_settings() {&nbsp;</div></li><li><div>        // register_setting( $option_group, $option_name, $sanitize_callback ).&nbsp;</div></li><li><div>        // $option_group - A settings group name. Must exist prior to the register_setting call. This must match the group name in settings_fields().&nbsp;</div></li><li><div>        // $option_name - The name of an option to sanitize and save.&nbsp;</div></li><li><div>        // $sanitize_callback - A callback function that sanitizes the option's value.&nbsp;</div></li><li><div>        register_setting( 'cws_gpp_code', 'cws_gpp_code', array( $this, 'validate_options') );&nbsp;</div></li><li><div>        register_setting( 'cws_gpp_options', 'cws_gpp_options', array( $this, 'validate_main_options') );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        register_setting( 'cws_gpp_reset', 'cws_gpp_reset', array( $this, 'validate_reset_options') );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // add_settings_section( $id, $title, $callback, $page )&nbsp;</div></li><li><div>        // $id - String for use in the 'id' attribute of tags&nbsp;</div></li><li><div>        // $title - Title of the section&nbsp;</div></li><li><div>        // $callback - Function that fills the section with the desired content. The function should echo its output.&nbsp;</div></li><li><div>        // $page - The menu page on which to display this section. Should match $menu_slug in add_options_page();&nbsp;</div></li><li><div>        add_settings_section( 'cws_gpp_add_code', 'Authenticate with Google', array( $this, 'section_text'), 'cws_gpp' );&nbsp;</div></li><li><div>        add_settings_section( 'cws_gpp_add_options', 'Default Settings', array( $this, 'section_main_text'), 'cws_gpp_defaults' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_settings_section( 'cws_gpp_add_reset', 'Deauthorise Plugin from your Google Account', array( $this, 'section_reset_text'), 'cws_gpp_reset' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // add_settings_field( $id, $title, $callback, $page, $section, $args );&nbsp;</div></li><li><div>        // $id - String for use in the 'id' attribute of tags&nbsp;</div></li><li><div>        // $title - Title of the field&nbsp;</div></li><li><div>        // $callback - Function that fills the field with the desired inputs as part of the larger form. Passed a single argument, &nbsp;</div></li><li><div>        // the $args array. Name and id of the input should match the $id given to this function. The function should echo its output.&nbsp;</div></li><li><div>        // $page - The menu page on which to display this field. Should match $menu_slug in add_options_page();&nbsp;</div></li><li><div>        // $section - (optional) The section of the settings page in which to show the box. A section added with add_settings_section() [optional]&nbsp;</div></li><li><div>        // $args - (optional) Additional arguments that are passed to the $callback function&nbsp;</div></li><li><div>        add_settings_field( 'cws_myplugin_oauth2_code', 'Enter Google Access Code here', array( $this, 'setting_input'), 'cws_gpp', 'cws_gpp_add_code' );&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add default option field - Thumbnail Size &nbsp;</div></li><li><div>        add_settings_field( 'cws_gpp_thumbnail_size', 'Thumbnail Size (px)', array( $this, 'options_thumbnail_size'), 'cws_gpp_defaults', 'cws_gpp_add_options' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add default option field - Album Thumbnail Size &nbsp;</div></li><li><div>        add_settings_field( 'cws_gpp_album_thumbnail_size', 'Album Thumbnail Size (px)', array( $this, 'options_album_thumbnail_size'), 'cws_gpp_defaults', 'cws_gpp_add_options' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add default option field - Number of image results&nbsp;</div></li><li><div>        add_settings_field( 'cws_gpp_num_image_results', 'Number of images per page', array( $this, 'options_num_image_results'), 'cws_gpp_defaults', 'cws_gpp_add_options' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add default option field - Number of album results&nbsp;</div></li><li><div>        add_settings_field( 'cws_gpp_num_album_results', 'Number of albums per page', array( $this, 'options_num_album_results'), 'cws_gpp_defaults', 'cws_gpp_add_options' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add default option field - Lightbox image size&nbsp;</div></li><li><div>        // add_settings_field( 'cws_gpp_lightbox_image_size', 'Size of Lightbox', array( $this, 'options_lightbox_image_size'), 'cws_gpp_defaults', 'cws_gpp_add_options' );&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        // Add default option checkbox - Show private albums checkbox&nbsp;</div></li><li><div>        add_settings_field( 'cws_gpp_show_private_albums', 'Show which albums', array( $this, 'options_show_private_albums'), 'cws_gpp_defaults', 'cws_gpp_add_options' );        &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add default option checkbox - Show album title&nbsp;</div></li><li><div>        add_settings_field( 'cws_gpp_show_album_title', 'Show Album Title', array( $this, 'options_show_album_title'), 'cws_gpp_defaults', 'cws_gpp_add_options' );   &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add default option checkbox - Show image title&nbsp;</div></li><li><div>        add_settings_field( 'cws_gpp_show_image_title', 'Show Image Title', array( $this, 'options_show_image_title'), 'cws_gpp_defaults', 'cws_gpp_add_options' ); &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add default option checkbox - Show album details&nbsp;</div></li><li><div>        add_settings_field( 'cws_gpp_show_album_details', 'Show Album Details', array( $this, 'options_show_album_details'), 'cws_gpp_defaults', 'cws_gpp_add_options' );   &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add default option checkbox - Show image details&nbsp;</div></li><li><div>        add_settings_field( 'cws_gpp_show_image_details', 'Show Image Details', array( $this, 'options_show_image_details'), 'cws_gpp_defaults', 'cws_gpp_add_options' ); &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Add reset option&nbsp;</div></li><li><div>        add_settings_field( 'cws_gpp_reset', 'Click here to confirm you want to deauthorise plugin from your google account', array( $this, 'options_reset'), 'cws_gpp_reset', 'cws_gpp_add_reset' );   &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Draw the Section Header for the admin area.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    function section_text() {&nbsp;</div></li><li><div>        echo 'You need to click here to authorize access and paste the Access Code provided by Google in the field below.';&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        // get the google authorisation url&nbsp;</div></li><li><div>        $authUrl = $this-&gt;client-&gt;createAuthUrl();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // display the google authorisation url&nbsp;</div></li><li><div>        echo $this-&gt;createAuthLink( $authUrl );&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        $code = get_option( 'cws_gpp_code' );&nbsp;</div></li><li><div>        $oauth2_code = $code['oauth2_code'];&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        $token = get_option( 'cws_gpp_access_token' );&nbsp;</div></li><li><div>        $token = $token['access_token'];&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>        if ( isset( $code['oauth2_code'] ) ) {&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            $this-&gt;client-&gt;authenticate( $code['oauth2_code'] );  &nbsp;</div></li><li><div>            $AccessToken = $this-&gt;client-&gt;getAccessToken();&nbsp;</div></li><li><div>            $AccessToken = json_decode( $AccessToken, TRUE );&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            // delete code&nbsp;</div></li><li><div>               $code = get_option( 'cws_gpp_code' );&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            if ( $code ) {&nbsp;</div></li><li><div>                unset($code['oauth2_code']);&nbsp;</div></li><li><div>                update_option( 'cws_gpp_code', $code );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>                        &nbsp;</div></li><li><div>            // store access token&nbsp;</div></li><li><div>            if( update_option( 'cws_gpp_access_token', $AccessToken ) )&nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                if( $this-&gt;debug ) error_log( 'Update option: cws_gpp_access_token' );&nbsp;</div></li><li><div>               &nbsp;</div></li><li><div>                // store token expires&nbsp;</div></li><li><div>                $now = date(&quot;U&quot;);&nbsp;</div></li><li><div>                $token_expires = $now + $AccessToken['expires_in'];&nbsp;</div></li><li><div>                add_option( 'cws_gpp_token_expires', $token_expires );      &nbsp;</div></li><li><div>                &nbsp;</div></li><li><div>                $url = admin_url( &quot;options-general.php?page=&quot;.$_GET[&quot;page&quot;] );&nbsp;</div></li><li><div>                // error_log($url);&nbsp;</div></li><li><div>                &nbsp;</div></li><li><div>                wp_redirect( &quot;$url&quot; );&nbsp;</div></li><li><div>                exit;               &nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }        &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function section_main_text() {&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Get the Access Token stored in db.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    public function getAccessToken() {&nbsp;</div></li><li><div>        $token = get_option( 'cws_gpp_access_token' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $token;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Get the authourisation link.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */     &nbsp;</div></li><li><div>    public function createAuthLink( $authUrl ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( isset( $authUrl ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $output = &quot;&lt;br&gt;&lt;br&gt;&lt;a class='login' href='$authUrl' target='_blank'&gt;Connect My Google Account&lt;/a&gt;&quot;; &nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $output = &quot;There was a problem generating the Google Autherisation link&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $output;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    /** GOOD WORKFLOW OF STEPS https://www.domsammut.com/code/php-server-side-youtube-v3-oauth-api-video-upload-guide **/   &nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Get the Reset option stored in db.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */  &nbsp;</div></li><li><div>    public function deauthorizeGoogleAccount() {&nbsp;</div></li><li><div>        // get options from db&nbsp;</div></li><li><div>        if( get_option( 'cws_gpp_reset' ) ) {&nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    public function isAuthenticated() {&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        // get options from db&nbsp;</div></li><li><div>        $code = get_option( 'cws_gpp_code' );&nbsp;</div></li><li><div>        $token = get_option( 'cws_gpp_access_token' );&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        if ( !isset( $token['access_token'] ) ) {&nbsp;</div></li><li><div>            // get oauth2 code&nbsp;</div></li><li><div>            //$this-&gt;getOAuthToken();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        else{&nbsp;</div></li><li><div>            // check if it needs refreshing&nbsp;</div></li><li><div>            $now = date(&quot;U&quot;);&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            // get cws_gpp_token_expires&nbsp;</div></li><li><div>            $token_expires = get_option( 'cws_gpp_token_expires' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // check if $now is greater than cws_gpp_token_expires&nbsp;</div></li><li><div>            if ( $now &gt; $token_expires ) {&nbsp;</div></li><li><div>                $this-&gt;refreshToken(); &nbsp;</div></li><li><div>                return;&nbsp;</div></li><li><div>            }   &nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            return true;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    public function refreshToken() {&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        if($debug) { error_log('Inside refreshToken()'); }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // get access token and refresh it      &nbsp;</div></li><li><div>        $now = date( &quot;U&quot; );&nbsp;</div></li><li><div>        $clientId = '806353319710-g782kn9ed0gm77ucl0meen5ohs84qgqm.apps.googleusercontent.com';&nbsp;</div></li><li><div>        $clientSecret = 'P6BMMEWLKUSoxB48X2Tzu8ds';&nbsp;</div></li><li><div>        $token = get_option( 'cws_gpp_access_token' );&nbsp;</div></li><li><div>        $refreshToken = $token['refresh_token'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $postBody = 'client_id='.urlencode($clientId)&nbsp;</div></li><li><div>                  .'&client_secret='.urlencode($clientSecret)&nbsp;</div></li><li><div>                  .'&refresh_token='.urlencode($refreshToken)&nbsp;</div></li><li><div>                  .'&grant_type=refresh_token';&nbsp;</div></li><li><div>          &nbsp;</div></li><li><div>        $curl = curl_init();&nbsp;</div></li><li><div>        curl_setopt_array( $curl, &nbsp;</div></li><li><div>                         array( CURLOPT_CUSTOMREQUEST =&gt; 'POST'&nbsp;</div></li><li><div> , CURLOPT_URL =&gt; 'https://www.googleapis.com/oauth2/v3/token'&nbsp;</div></li><li><div> , CURLOPT_HTTPHEADER =&gt; array( 'Content-Type: application/x-www-form-urlencoded'&nbsp;</div></li><li><div> , 'Content-Length: '.strlen($postBody)&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> , CURLOPT_POSTFIELDS =&gt; $postBody                              &nbsp;</div></li><li><div> , CURLOPT_REFERER =&gt; $GOOGLE_OAUTH2_REFERER&nbsp;</div></li><li><div> , CURLOPT_RETURNTRANSFER =&gt; 1    // means output will be a return value from curl_exec() instead of simply echoed&nbsp;</div></li><li><div> , CURLOPT_TIMEOUT =&gt; 12          // max seconds to wait&nbsp;</div></li><li><div> , CURLOPT_FOLLOWLOCATION =&gt; 0    // don't follow any Location headers, use only the CURLOPT_URL, this is for security&nbsp;</div></li><li><div> , CURLOPT_FAILONERROR =&gt; 0       // do not fail verbosely fi the http_code is an error, this is for security&nbsp;</div></li><li><div> , CURLOPT_SSL_VERIFYPEER =&gt; 0    // do verify the SSL of CURLOPT_URL, this is for security&nbsp;</div></li><li><div> , CURLOPT_VERBOSE =&gt; 0           // don't output verbosely to stderr, this is for security&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $orig_response = curl_exec( $curl );&nbsp;</div></li><li><div>        $response = json_decode( $orig_response, true );        // convert returned objects into associative arrays&nbsp;</div></li><li><div>        $token_expires = $now + $response['expires_in'];&nbsp;</div></li><li><div>        $http_code = curl_getinfo( $curl, CURLINFO_HTTP_CODE );&nbsp;</div></li><li><div>        curl_close( $curl );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $response['access_token'] ) {&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            // get options update access token part&nbsp;</div></li><li><div>            $token = get_option( 'cws_gpp_access_token' );&nbsp;</div></li><li><div>            $token['access_token'] = $response['access_token'];&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            update_option(&quot;cws_gpp_access_token&quot;, $token);                            # save the access token&nbsp;</div></li><li><div>            update_option(&quot;cws_gpp_token_expires&quot;, $token_expires);                   # save the epoch when the token expires&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            $url = admin_url( &quot;options-general.php?page=&quot;.$_GET[&quot;page&quot;] );&nbsp;</div></li><li><div>            error_log($url);&nbsp;</div></li><li><div>            error_log(&quot;********************&quot;);&nbsp;</div></li><li><div>               //wp_redirect( admin_url( &quot;options-general.php?page=&quot;.$_GET[&quot;page&quot;] ) );exit;&nbsp;</div></li><li><div>            wp_redirect( &quot;$url&quot; );&nbsp;</div></li><li><div>            exit;        &nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            echo &quot;refreshOAuth2Token got the following response:&lt;br /&gt;&quot;;&nbsp;</div></li><li><div>            echo $orig_response;&nbsp;</div></li><li><div>            echo &quot;using refreshToken $refreshToken&quot;;&nbsp;</div></li><li><div>        }  &nbsp;</div></li><li><div>        // TODO: Improve error handling here for various curl error codes etc      &nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Get list of Albums for authenticated user.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */     &nbsp;</div></li><li><div>    public function getAlbumList( $AccessToken, $album_thumb_size, $show_album_ttl, $cws_page, $num_image_results, $visibility) {&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        if($debug) { error_log( 'Inside getAlbumList()' ); }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Work out pagination variables&nbsp;</div></li><li><div>        if ( !( isset( $cws_page ) ) ) {&nbsp;</div></li><li><div>            $cws_page = 1;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $cws_page &gt; 1 ) {&nbsp;</div></li><li><div>            $start_index = ( ( $cws_page - 1 ) * $num_image_results ) + 1;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $start_index = 1;&nbsp;</div></li><li><div>        }            &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $visibility = strtolower( $visibility );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // https://developers.google.com/accounts/docs/OAuth2WebServer#callinganapi&nbsp;</div></li><li><div>        $curl = curl_init();&nbsp;</div></li><li><div>        // https://developers.google.com/picasa-web/docs/2.0/reference#Visibility&nbsp;</div></li><li><div>        // http://picasaweb.google.com/data/feed/api/user/userID?kind=photo&q=penguin&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // limit results or not&nbsp;</div></li><li><div>        if( $num_image_results &gt; 0 ) {&nbsp;</div></li><li><div>            $url = &quot;https://picasaweb.google.com/data/feed/api/user/default?kind=album&thumbsize=&quot; . $album_thumb_size . &quot;c&max-results=&quot; . $num_image_results . &quot;&start-index=&quot; . $start_index . &quot;&access=&quot; . $visibility;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $url = &quot;https://picasaweb.google.com/data/feed/api/user/default?kind=album&thumbsize=&quot; . $album_thumb_size . &quot;c&access=&quot; . $visibility;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // TODO: create a helper function&nbsp;</div></li><li><div>        $cws_debug = get_query_var('cws_debug');&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( $cws_debug == &quot;1&quot; ) { &nbsp;</div></li><li><div>            echo &quot;url = $url&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        curl_setopt_array( $curl, &nbsp;</div></li><li><div>                         array( CURLOPT_CUSTOMREQUEST =&gt; 'GET'&nbsp;</div></li><li><div> , CURLOPT_URL =&gt; $url&nbsp;</div></li><li><div> , CURLOPT_HTTPHEADER =&gt; array( 'GData-Version: 2'&nbsp;</div></li><li><div> , 'Authorization: Bearer '.$AccessToken['access_token'] )&nbsp;</div></li><li><div> , CURLOPT_REFERER =&gt; 'http://wp-picasa-pro.wordpress.dev/wp-admin/options-general.php?page=cws_gpp'&nbsp;</div></li><li><div> , CURLOPT_RETURNTRANSFER =&gt; 1 // means output will be a return value from curl_exec() instead of simply echoed&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>        $response = curl_exec($curl);&nbsp;</div></li><li><div>        $http_code = curl_getinfo($curl, CURLINFO_HTTP_CODE);&nbsp;</div></li><li><div>        curl_close($curl);&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        // Return $response to shortcode if http_code is 200&nbsp;</div></li><li><div>        if( $http_code == 200 ) {&nbsp;</div></li><li><div>            return $response;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // TODO: Add in some error handling better reporting of http code&nbsp;</div></li><li><div>        return false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Get list of Images in a specific Album for authenticated user.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */&nbsp;</div></li><li><div>    public function getAlbumImages( $AccessToken, $album_thumb_size, $show_album_ttl, $cws_page, $num_image_results, $cws_album ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if($debug) { error_log('Inside getAlbumImages()'); }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Work out pagination variables&nbsp;</div></li><li><div>        if ( !( isset( $cws_page ) ) ) {&nbsp;</div></li><li><div>            $cws_page = 1;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $cws_page &gt; 1 ) {&nbsp;</div></li><li><div>            $start_index = ( ( $cws_page - 1 ) * $num_image_results ) + 1;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $start_index = 1;&nbsp;</div></li><li><div>        }   &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $curl = curl_init();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( $num_image_results &gt; 0 ) {&nbsp;</div></li><li><div>            $url = &quot;https://picasaweb.google.com/data/feed/api/user/default/albumid/&quot; . $cws_album . &quot;?thumbsize=&quot; . $album_thumb_size . &quot;c&max-results=&quot; . $num_image_results . &quot;&start-index=&quot; . $start_index;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $url = &quot;https://picasaweb.google.com/data/feed/api/user/default/albumid/&quot; . $cws_album . &quot;?thumbsize=&quot; . $album_thumb_size . &quot;c&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        // TODO: create a helper function&nbsp;</div></li><li><div>        $cws_debug = get_query_var('cws_debug');&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        curl_setopt_array( $curl, &nbsp;</div></li><li><div>                         array( CURLOPT_CUSTOMREQUEST =&gt; 'GET'&nbsp;</div></li><li><div> , CURLOPT_URL =&gt; $url&nbsp;</div></li><li><div> , CURLOPT_HTTPHEADER =&gt; array( 'GData-Version: 2'&nbsp;</div></li><li><div> , 'Authorization: Bearer '.$AccessToken['access_token'] )&nbsp;</div></li><li><div> , CURLOPT_REFERER =&gt; 'http://wp-picasa-pro.wordpress.dev/wp-admin/options-general.php?page=cws_gpp'&nbsp;</div></li><li><div> , CURLOPT_RETURNTRANSFER =&gt; 1 // means output will be a return value from curl_exec() instead of simply echoed&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>        $response = curl_exec($curl);&nbsp;</div></li><li><div>        $http_code = curl_getinfo($curl, CURLINFO_HTTP_CODE);&nbsp;</div></li><li><div>        curl_close($curl);&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if($cws_debug == &quot;1&quot;) { &nbsp;</div></li><li><div>            echo &quot;url = $url&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            echo &quot;http code: $http_code&lt;br&gt;&quot;;&nbsp;</div></li><li><div>            echo '&lt;pre&gt;';&nbsp;</div></li><li><div>            print_r($response);&nbsp;</div></li><li><div>            echo '&lt;/pre&gt;'; &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Return $response to shortcode if http_code is 200&nbsp;</div></li><li><div>        if( $http_code == 200 ) {&nbsp;</div></li><li><div>            return $response;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Pagination Helper&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * $num_pages, int&nbsp;</div></li><li><div>     * $current_page, int&nbsp;</div></li><li><div>     * $album_id&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * return string&nbsp;</div></li><li><div>     */     &nbsp;</div></li><li><div>    public function get_pagination( $total_num_albums, $num_image_results, $cws_page, $album_id ) {&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>        if( $this-&gt;debug ) error_log( 'Inside: CWS_Google_Picasa_Pro_Admin::get_pagination()' ); &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Calcualte how many pages we need, total number of albums / number of images to display per page as set in settings of shortcode&nbsp;</div></li><li><div>        $num_pages = ceil( $total_num_albums / $num_image_results );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // If ony need one page then do not display pagination&nbsp;</div></li><li><div>        if ( $num_pages &lt;= 1) {&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if( ! isset( $cws_page ) || $cws_page &lt; 1 ) { $cws_page = 1; } // TODO: Do we need this check?&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        // Create page links&nbsp;</div></li><li><div>        $html[] = &quot;&lt;div class=\&quot;pagination\&quot;&gt;&lt;ul class=\&quot;page-nav\&quot;&gt;\n&quot;;&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        $previous = $cws_page - 1;&nbsp;</div></li><li><div>        $next = $cws_page + 1;&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        // Previous link&nbsp;</div></li><li><div>        if( $previous &gt; 0 ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // if have album id, i.e. display this on the results page&nbsp;</div></li><li><div>            if( $album_id ) {&nbsp;</div></li><li><div>                $html[] = &quot;&lt;li&gt;&lt;a href=\&quot;?cws_page=$previous&cws_album=$album_id\&quot; id='prev_page'&gt;Previous&lt;/a&gt;&lt;/li&gt;&quot;;&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $html[] = &quot;&lt;li&gt;&lt;a href=\&quot;?cws_page=$previous\&quot; id='prev_page'&gt;Previous&lt;/a&gt;&lt;/li&gt;&quot;;                &nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        for( $i=1 ; $i &lt;= $num_pages ; $i++ ) {&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>            $class = &quot;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Add class to current page&nbsp;</div></li><li><div>            if( $i == $cws_page) {&nbsp;</div></li><li><div>                $class = &quot; class='selected'&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            $html[] = &quot;&lt;li&quot;.$class.&quot;&gt;&quot;;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            if( $album_id ) {&nbsp;</div></li><li><div>                $html[] = &quot;&lt;a href=\&quot;?cws_page=$i&cws_album=$album_id\&quot; id='page_&quot;.$i.&quot;'&gt;&quot;.$i.&quot;&lt;/a&gt;&lt;/li&gt;\n&quot;;&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $html[] = &quot;&lt;a href=\&quot;?cws_page=$i\&quot; id='page_&quot;.$i.&quot;'&gt;&quot;.$i.&quot;&lt;/a&gt;&lt;/li&gt;\n&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        // Next link&nbsp;</div></li><li><div>        if( $next &lt;= $num_pages ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // if have album id&nbsp;</div></li><li><div>            if( $album_id ) {&nbsp;</div></li><li><div>                $html[] = &quot;&lt;li&gt;&lt;a href=\&quot;?cws_page=$next&cws_album=$album_id\&quot; id='next_page'&gt;Next&lt;/a&gt;&lt;/li&gt;&quot;;&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $html[] = &quot;&lt;li&gt;&lt;a href=\&quot;?cws_page=$next\&quot; id='next_page'&gt;Next&lt;/a&gt;&lt;/li&gt;&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        if( !$this-&gt;isPro == 1 ) {&nbsp;</div></li><li><div>            $html[] = &quot;&lt;/ul&gt;&lt;span&gt;Powered by: &lt;a href=\&quot;http://www.cheshirewebsolutions.com/\&quot;&gt;Cheshire Web Solutions&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;\n&quot;;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $html[] = &quot;&lt;/ul&gt;&lt;/div&gt;\n&quot;;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        return implode( &quot;\n&quot;, $html );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display and fill the form field.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    function setting_input() {&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        // get option 'oauth2_code' value from the database&nbsp;</div></li><li><div>        $code = get_option( 'cws_gpp_code' );&nbsp;</div></li><li><div>        $oauth2_code = $code['oauth2_code'];&nbsp;</div></li><li><div>        // echo the field&nbsp;</div></li><li><div>        echo &quot;&lt;input id='oauth2_code' name='cws_gpp_code[oauth2_code]' type='text' value='$oauth2_code' &gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display and fill the form fields for storing defaults.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Thumbnail Size in pixels&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    function options_thumbnail_size() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // get option 'thumb_size' value from the database&nbsp;</div></li><li><div>        $options = get_option( 'cws_gpp_options' );&nbsp;</div></li><li><div>        $thumb_size = $options['thumb_size'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo &quot;&lt;input id='thumb_size' name='cws_gpp_options[thumb_size]' type='text' value='$thumb_size' &gt;&quot;;&nbsp;</div></li><li><div>    }    &nbsp;</div></li><li><div>    &nbsp;</div></li><li><div> &nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display and fill the form fields for storing defaults.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Album Thumbnail Size in pixels&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    function options_album_thumbnail_size() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // get option 'album_thumb_size' value from the database&nbsp;</div></li><li><div>        $options = get_option( 'cws_gpp_options' );&nbsp;</div></li><li><div>        $album_thumb_size = $options['album_thumb_size'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo &quot;&lt;input id='album_thumb_size' name='cws_gpp_options[album_thumb_size]' type='text' value='$album_thumb_size' &gt;&quot;;&nbsp;</div></li><li><div>    }  &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display and fill the form fields for storing defaults.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Number of images results to display per page&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    function options_num_image_results() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // get option 'num_image_results' value from the database&nbsp;</div></li><li><div>        $options = get_option( 'cws_gpp_options' );&nbsp;</div></li><li><div>        $num_image_results = $options['num_image_results'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo &quot;&lt;input id='num_image_results' name='cws_gpp_options[num_image_results]' type='text' value='$num_image_results' &gt;&quot;;&nbsp;</div></li><li><div>    }       &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display and fill the form fields for storing defaults.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Number of albums results to display per page&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    function options_num_album_results() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // get option 'num_album_results' value from the database&nbsp;</div></li><li><div>        $options = get_option( 'cws_gpp_options' );&nbsp;</div></li><li><div>        $num_album_results = $options['num_album_results'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo &quot;&lt;input id='num_album_results' name='cws_gpp_options[num_album_results]' type='text' value='$num_album_results' &gt;&quot;;&nbsp;</div></li><li><div>    } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display and fill the form fields for storing defaults.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Lightbox image size&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    function options_lightbox_image_size() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // get option 'lightbox_image_size' value from the database&nbsp;</div></li><li><div>        $options = get_option( 'cws_gpp_options' );&nbsp;</div></li><li><div>        $lightbox_image_size = $options['lightbox_image_size'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        echo &quot;&lt;input id='lightbox_image_size' name='cws_gpp_options[lightbox_image_size]' type='text' value='$lightbox_image_size' &gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display and fill the form fields for storing defaults.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Show Private Albums&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */     &nbsp;</div></li><li><div>    function options_show_private_albums() {&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>        // DROP-DOWN-BOX - Name: plugin_options[dropdown1]&nbsp;</div></li><li><div>            $options = get_option('cws_gpp_options');&nbsp;</div></li><li><div>            $items = array(&quot;All&quot;, &quot;Private&quot;, &quot;Public&quot;);&nbsp;</div></li><li><div>            echo &quot;&lt;select id='cws_gpp_show_private_albums' name='cws_gpp_options[private_albums]'&gt;&quot;;&nbsp;</div></li><li><div>            foreach($items as $item) {&nbsp;</div></li><li><div>                $selected = ($options['private_albums']==$item) ? 'selected=&quot;selected&quot;' : '';&nbsp;</div></li><li><div>                echo &quot;&lt;option value='$item' $selected&gt;$item&lt;/option&gt;&quot;;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            echo &quot;&lt;/select&gt;&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display and fill the form fields for storing defaults.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Show Album Title&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    function options_show_album_title() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // get option 'show_album_title' value from the database&nbsp;</div></li><li><div>        $options = get_option( 'cws_gpp_options' );&nbsp;</div></li><li><div>        $show_album_title = $options['show_album_title'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if($options['show_album_title']) { $checked = ' checked=&quot;checked&quot; '; }&nbsp;</div></li><li><div>        echo &quot;&lt;input &quot;.$checked.&quot; id='show_album_title' name='cws_gpp_options[show_album_title]' type='checkbox' /&gt;&quot;;&nbsp;</div></li><li><div>    }  &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display and fill the form fields for storing defaults.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Show Image Title&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    function options_show_image_title() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // get option 'show_image_title' value from the database&nbsp;</div></li><li><div>        $options = get_option( 'cws_gpp_options' );&nbsp;</div></li><li><div>        $show_album_title = $options['show_image_title'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if($options['show_image_title']) { $checked = ' checked=&quot;checked&quot; '; }&nbsp;</div></li><li><div>        echo &quot;&lt;input &quot;.$checked.&quot; id='show_image_title' name='cws_gpp_options[show_image_title]' type='checkbox' /&gt;&quot;;&nbsp;</div></li><li><div>    } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display and fill the form fields for storing defaults.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Show Album Details&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    function options_show_album_details() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // get option 'show_album_details' value from the database&nbsp;</div></li><li><div>        $options = get_option( 'cws_gpp_options' );&nbsp;</div></li><li><div>        $show_album_details = $options['show_album_details'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if($options['show_album_details']) { $checked = ' checked=&quot;checked&quot; '; }&nbsp;</div></li><li><div>        echo &quot;&lt;input &quot;.$checked.&quot; id='show_album_details' name='cws_gpp_options[show_album_details]' type='checkbox' /&gt;&quot;;&nbsp;</div></li><li><div>    } &nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display and fill the form fields for storing defaults.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Show Image Details&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    function options_show_image_details() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // get option 'show_album_details' value from the database&nbsp;</div></li><li><div>        $options = get_option( 'cws_gpp_options' );&nbsp;</div></li><li><div>        $show_image_details = $options['show_image_details'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if($options['show_image_details']) { $checked = ' checked=&quot;checked&quot; '; }&nbsp;</div></li><li><div>        echo &quot;&lt;input &quot;.$checked.&quot; id='show_image_details' name='cws_gpp_options[show_image_details]' type='checkbox' /&gt;&quot;;&nbsp;</div></li><li><div>    } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Display and fill the form fields for storing defaults.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * Show Album Details&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */    &nbsp;</div></li><li><div>    function options_reset() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // get option 'show_album_details' value from the database&nbsp;</div></li><li><div>        // $options = get_option( 'cws_gpp_options' );&nbsp;</div></li><li><div>        //$show_album_details = $options['show_album_details'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if($options['cws_gpp_reset']) { $checked = ' checked=&quot;checked&quot; '; }&nbsp;</div></li><li><div>        echo &quot;&lt;input &quot;.$checked.&quot; id='cws_gpp_reset' name='cws_gpp_reset[reset]' type='checkbox' required /&gt;&quot;;&nbsp;</div></li><li><div>    } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Validate user input (we want text only).&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */        &nbsp;</div></li><li><div>    function validate_options( $input ) {&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>        $valid['oauth2_code'] = esc_attr ( $input['oauth2_code'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $valid;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Validate user input.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */         &nbsp;</div></li><li><div>    function validate_main_options( $input ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $valid['thumb_size'] = esc_attr( $input['thumb_size'] );&nbsp;</div></li><li><div>        $valid['album_thumb_size'] = esc_attr( $input['album_thumb_size'] );&nbsp;</div></li><li><div>        $valid['num_image_results'] = esc_attr( $input['num_image_results'] );&nbsp;</div></li><li><div>        $valid['num_album_results'] = esc_attr( $input['num_album_results'] );&nbsp;</div></li><li><div>        $valid['lightbox_image_size'] = esc_attr( $input['lightbox_image_size'] );&nbsp;</div></li><li><div>        $valid['private_albums'] = esc_attr( $input['private_albums'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Correct validation of checkboxes&nbsp;</div></li><li><div>        $valid[show_album_title] = ( isset( $input[show_album_title] ) && true == $input[show_album_title] ? true : false );&nbsp;</div></li><li><div>        $valid[show_album_details] = ( isset( $input[show_album_details] ) && true == $input[show_album_details] ? true : false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $valid[show_image_title] = ( isset( $input[show_image_title] ) && true == $input[show_image_title] ? true : false );&nbsp;</div></li><li><div>        // $valid[show_image_details] = ( isset( $input[show_image_details] ) && true == $input[show_image_details] ? true : false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $valid;&nbsp;</div></li><li><div>    } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    /**&nbsp;</div></li><li><div>     * Validate user input.&nbsp;</div></li><li><div>     *&nbsp;</div></li><li><div>     * @since    2.0.0&nbsp;</div></li><li><div>     */         &nbsp;</div></li><li><div>    function validate_reset_options( $input ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // Correct validation of checkboxes&nbsp;</div></li><li><div>        $valid[reset] = ( isset( $input[reset] ) && true == $input[reset] ? true : false );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        return $valid;&nbsp;</div></li><li><div>    } &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    // Dispay upgrade notice&nbsp;</div></li><li><div>    function cws_gpp_admin_installed_notice() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        // http://wordpress.stackexchange.com/questions/134826/trying-to-get-logged-in-user-data-inside-php-class&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        add_action( 'wp_loaded', function() {&nbsp;</div></li><li><div>          $current_user = getCurrentUser();&nbsp;</div></li><li><div>          if ( $current_user instanceof WP_PM_User ) {&nbsp;</div></li><li><div>            //echo 'Current user ID: ' . $current_user-&gt;getID() . '(class)';&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            // check if already Pro&nbsp;</div></li><li><div>if(!$this-&gt;isPro) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>//var_dump($this-&gt;isPro);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Check if user has dismissed notice previously&nbsp;</div></li><li><div>            if ( ! get_user_meta( $current_user-&gt;getID(), 'cws_gpp_ignore_upgrade' ) ) &nbsp;</div></li><li><div>            {&nbsp;</div></li><li><div>                global $pagenow;&nbsp;</div></li><li><div>                // Only show upgrade notice if on this page&nbsp;</div></li><li><div>                //if ( $pagenow == 'plugins.php' ) &nbsp;</div></li><li><div>                if ( $pagenow == 'options-general.php' )&nbsp;</div></li><li><div>                {&nbsp;</div></li><li><div>                ?&gt;&nbsp;</div></li><li><div>                &lt;div id=&quot;message&quot; class=&quot;updated cws-gpp-message&quot;&gt;&nbsp;</div></li><li><div>                    &lt;div class=&quot;squeezer&quot;&gt;&nbsp;</div></li><li><div>                        &lt;h4&gt;&lt;?php _e( '&lt;strong&gt;Google Photos / Picasa Viewer has been installed &#8211; Get the Pro version&lt;/strong&gt;', 'woocommerce' ); ?&gt;&lt;/h4&gt;&nbsp;</div></li><li><div>                        &lt;p class=&quot;submit&quot;&gt;&nbsp;</div></li><li><div>                            &lt;a href=&quot;http://www.cheshirewebsolutions.com/?utm_source=cws_gpp_config&utm_medium=button&utm_content=upgrade_notice_message&utm_campaign=cws_gpp_plugin&quot; class=&quot;button-primary&quot;&gt;&lt;?php _e( 'Visit Site', 'cws_gpp_' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                            &lt;a href=&quot;&lt;?php echo admin_url('admin.php?page=cws_gpp'); ?&gt;&quot; class=&quot;button-primary&quot;&gt;&lt;?php _e( 'Settings', 'woocommerce' ); ?&gt;&lt;/a&gt;&nbsp;</div></li><li><div>                            &lt;a href=&quot;?cws_gpp_ignore_upgrade=0&quot; class=&quot;secondary-button&quot;&gt;Hide Notice&lt;/a&gt;&nbsp;</div></li><li><div>                        &lt;/p&gt;&nbsp;</div></li><li><div>                    &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;/div&gt;&nbsp;</div></li><li><div>                &lt;?php&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            &nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            // Set installed option&nbsp;</div></li><li><div>            update_option('cws_gpp_installed', 0);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>            //&nbsp;</div></li><li><div>&nbsp;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>            //echo 'No one logged in (class)';&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        }, 30 );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>    // If installed display upgrade notice&nbsp;</div></li><li><div>    function cws_gpp_admin_notices_styles() {&nbsp;</div></li><li><div>    &nbsp;</div></li><li><div>        // // Installed notices&nbsp;</div></li><li><div>        if ( get_option( 'cws_gpp_installed' ) == 1 ) {&nbsp;</div></li><li><div>            add_action( 'admin_notices', 'cws_gpp_admin_installed_notice' );     &nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>        &nbsp;</div></li><li><div>    // Allow user to dismiss upgrade notice :)&nbsp;</div></li><li><div>    // moved line below to define_admin_hooks();&nbsp;</div></li><li><div>    //add_action( 'admin_init', 'cws_gpp_ignore_upgrade' );    &nbsp;</div></li><li><div>    function cws_gpp_ignore_upgrade() {      &nbsp;</div></li><li><div>        $user_id = $current_user-&gt;ID;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        /** If user clicks to ignore the notice, add that to their user meta */&nbsp;</div></li><li><div>        if ( isset( $_GET['cws_gpp_ignore_upgrade'] ) && '0' == $_GET['cws_gpp_ignore_upgrade'] ) {&nbsp;</div></li><li><div>             add_user_meta($this-&gt;userId, 'cws_gpp_ignore_upgrade', 'true', true);&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>             // can I redirect user to plugin settings page ?&nbsp;</div></li><li><div>             wp_redirect( admin_url('options-general.php?page=cws_gpp', 'http') );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }   &nbsp;</div></li><li><div>&nbsp;</div></li><li><div>//&nbsp;</div></li><li><div>&nbsp;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 2.2.3</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/google-photos-picasa-viewer/3.0.8/classes/cws_google_picasa_pro_admin/" class="">3.0.8</a></li><li><a href="http://hookr.io/plugins/google-photos-picasa-viewer/3.0.5/classes/cws_google_picasa_pro_admin/" class="">3.0.5</a></li><li><a href="http://hookr.io/plugins/google-photos-picasa-viewer/3.0.4/classes/cws_google_picasa_pro_admin/" class="">3.0.4</a></li><li><a href="http://hookr.io/plugins/google-photos-picasa-viewer/3.0.12/classes/cws_google_picasa_pro_admin/" class="">3.0.12</a></li><li><a href="http://hookr.io/plugins/google-photos-picasa-viewer/2.2.3/classes/cws_google_picasa_pro_admin/" class="active">2.2.3</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>CWS_Google_Picasa_Pro_Admin</li><li><span></span>Google Photos &amp; Picasa Viewer</li><li><span></span>3.0.8</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>