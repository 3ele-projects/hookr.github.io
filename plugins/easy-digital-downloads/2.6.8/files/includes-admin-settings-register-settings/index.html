<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr file lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr file lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr file lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr file ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr file gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr file" data-site="plugin" data-version="2.7.8" data-slug="easy-digital-downloads" data-type="file" data-id="9616"><head xmlns="http://www.w3.org/1999/xhtml"><title> includes-admin-settings-register-settings | file | Easy Digital Downloads | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="file, plugin, easy-digital-downloads, 2.7.8" /><meta name="description" content="The WordPress Hook/API Index" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.10"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=73892bf1da6d30cc5cf32dd635f48015' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.10' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/files/includes-admin-settings-register-settings/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fincludes-admin-settings-register-settings%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Ffiles%2Fincludes-admin-settings-register-settings%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-easy-digital-downloads-2.7.8-file-includes-admin-settings-register-settings","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="includes-admin-settings-register-settings" class="single single-file"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to easy-digital-downloads." href="http://hookr.io/plugins/easy-digital-downloads/" class="plugin"><span property="name">easy-digital-downloads</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.7.8." href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/" class="H_VERSION"><span property="name">2.7.8</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to files." href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/files/" class=""><span property="name">files</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">includes-admin-settings-regis&hellip;</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="file"><ul role="navigation"><li class="" data-id="all" data-count="2274"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/all/" title="All">All <span class="count badge">2274</span></a></li><li class="" data-id="new" data-count="5"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/new/" title="New">New <span class="count badge">5</span></a></li><li class="" data-id="hooks" data-count="1195"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/hooks/" title="Hooks">Hooks <span class="count badge">1195</span></a></li><li class="" data-id="action" data-count="469"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/actions/" title="Actions">Actions <span class="count badge">469</span></a></li><li class="" data-id="filter" data-count="726"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/filters/" title="Filters">Filters <span class="count badge">726</span></a></li><li class="" data-id="class" data-count="99"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/classes/" title="Classes">Classes <span class="count badge">99</span></a></li><li class="" data-id="constant" data-count="11"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/constants/" title="Constants">Constants <span class="count badge">11</span></a></li><li class="" data-id="function" data-count="955"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/functions/" title="Functions">Functions <span class="count badge">955</span></a></li><li class="" data-id="shortcode" data-count="14"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">14</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article> <section><h1>/includes/admin/settings/register-settings.php</h1><p><pre><ol  class="block" start="1"><li><div>&lt;?php&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Register Settings</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @package     EDD</span>&nbsp;</div></li><li><div><span class="comment"> * @subpackage  Admin/Settings</span>&nbsp;</div></li><li><div><span class="comment"> * @copyright   Copyright (c) 2015, Pippin Williamson</span>&nbsp;</div></li><li><div><span class="comment"> * @license     http://opensource.org/licenses/gpl-2.0.php GNU Public License</span>&nbsp;</div></li><li><div><span class="comment"> * @since       1.0</span>&nbsp;</div></li><li><div><span class="comment">*/</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">// Exit if accessed directly</span>&nbsp;</div></li><li><div>if ( !defined( 'ABSPATH' ) ) exit;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Get an option</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Looks to see if the specified setting exists, returns default if not</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.8.4</span>&nbsp;</div></li><li><div><span class="comment"> * @global $edd_options Array of all the EDD Options</span>&nbsp;</div></li><li><div><span class="comment"> * @return mixed</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_get_option( $key = '', $default = false ) {&nbsp;</div></li><li><div>  global $edd_options;&nbsp;</div></li><li><div>  $value = ! empty( $edd_options[ $key ] ) ? $edd_options[ $key ] : $default;&nbsp;</div></li><li><div>  $value = apply_filters( 'edd_get_option', $value, $key, $default );&nbsp;</div></li><li><div>  return apply_filters( 'edd_get_option_' . $key, $value, $key, $default );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Update an option</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Updates an edd setting value in both the db and the global variable.</span>&nbsp;</div></li><li><div><span class="comment"> * Warning: Passing in an empty, false or null string value will remove</span>&nbsp;</div></li><li><div><span class="comment"> *          the key from the edd_options array.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.3</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $key The Key to update</span>&nbsp;</div></li><li><div><span class="comment"> * @param string|bool|int $value The value to set the key to</span>&nbsp;</div></li><li><div><span class="comment"> * @global $edd_options Array of all the EDD Options</span>&nbsp;</div></li><li><div><span class="comment"> * @return boolean True if updated, false if not.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_update_option( $key = '', $value = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// If no key, exit</span></span>&nbsp;</div></li><li><div>  if ( empty( $key ) ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $value ) ) {&nbsp;</div></li><li><div>      $remove_option = edd_delete_option( $key );&nbsp;</div></li><li><div>      return $remove_option;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// First let's grab the current settings</span></span>&nbsp;</div></li><li><div>  $options = get_option( 'edd_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Let's let devs alter that value coming in</span>&nbsp;</div></li><li><div>  $value = apply_filters( 'edd_update_option', $value, $key );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Next let's try to update the value</span></span>&nbsp;</div></li><li><div>  $options[ $key ] = $value;&nbsp;</div></li><li><div>  $did_update = update_option( 'edd_settings', $options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// If it updated, let's update the global variable</span></span>&nbsp;</div></li><li><div>  if ( $did_update ) {&nbsp;</div></li><li><div>      global $edd_options;&nbsp;</div></li><li><div>      $edd_options[ $key ] = $value;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $did_update;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Remove an option</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Removes an edd setting value in both the db and the global variable.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.3</span>&nbsp;</div></li><li><div><span class="comment"> * @param string $key The Key to delete</span>&nbsp;</div></li><li><div><span class="comment"> * @global $edd_options Array of all the EDD Options</span>&nbsp;</div></li><li><div><span class="comment"> * @return boolean True if removed, false if not.</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_delete_option( $key = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// If no key, exit</span></span>&nbsp;</div></li><li><div>  if ( empty( $key ) ) {&nbsp;</div></li><li><div>      return false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// First let's grab the current settings</span></span>&nbsp;</div></li><li><div>  $options = get_option( 'edd_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// Next let's try to update the value</span></span>&nbsp;</div></li><li><div>  if( isset( $options[ $key ] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      unset( $options[ $key ] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $did_update = update_option( 'edd_settings', $options );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment"><span class="comment">// If it updated, let's update the global variable</span></span>&nbsp;</div></li><li><div>  if ( $did_update ) {&nbsp;</div></li><li><div>      global $edd_options;&nbsp;</div></li><li><div>      $edd_options = $options;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $did_update;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Get Settings</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieves all plugin settings</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @return array EDD settings</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_get_settings() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $settings = get_option( 'edd_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( empty( $settings ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Update old settings with new single option</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $general_settings = is_array( get_option( 'edd_settings_general' ) )    ? get_option( 'edd_settings_general' )    : array();&nbsp;</div></li><li><div>      $gateway_settings = is_array( get_option( 'edd_settings_gateways' ) )   ? get_option( 'edd_settings_gateways' )   : array();&nbsp;</div></li><li><div>      $email_settings = is_array( get_option( 'edd_settings_emails' ) )     ? get_option( 'edd_settings_emails' )     : array();&nbsp;</div></li><li><div>      $style_settings = is_array( get_option( 'edd_settings_styles' ) )     ? get_option( 'edd_settings_styles' )     : array();&nbsp;</div></li><li><div>      $tax_settings = is_array( get_option( 'edd_settings_taxes' ) )      ? get_option( 'edd_settings_taxes' )      : array();&nbsp;</div></li><li><div>      $ext_settings = is_array( get_option( 'edd_settings_extensions' ) ) ? get_option( 'edd_settings_extensions' ) : array();&nbsp;</div></li><li><div>      $license_settings = is_array( get_option( 'edd_settings_licenses' ) )   ? get_option( 'edd_settings_licenses' )   : array();&nbsp;</div></li><li><div>      $misc_settings = is_array( get_option( 'edd_settings_misc' ) )       ? get_option( 'edd_settings_misc' )       : array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $settings = array_merge( $general_settings, $gateway_settings, $email_settings, $style_settings, $tax_settings, $ext_settings, $license_settings, $misc_settings );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      update_option( 'edd_settings', $settings );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  return apply_filters( 'edd_get_settings', $settings );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Add all settings sections and fields</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment">*/</span>&nbsp;</div></li><li><div>function edd_register_settings() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( false == get_option( 'edd_settings' ) ) {&nbsp;</div></li><li><div>      add_option( 'edd_settings' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( edd_get_registered_settings() as $tab =&gt; $sections ) {&nbsp;</div></li><li><div>      foreach ( $sections as $section =&gt; $settings) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// Check for backwards compatibility</span>&nbsp;</div></li><li><div>          $section_tabs = edd_get_settings_tab_sections( $tab );&nbsp;</div></li><li><div>          if ( ! is_array( $section_tabs ) || ! array_key_exists( $section, $section_tabs ) ) {&nbsp;</div></li><li><div>              $section = 'main';&nbsp;</div></li><li><div>              $settings = $sections;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          add_settings_section(&nbsp;</div></li><li><div>              'edd_settings_' . $tab . '_' . $section, &nbsp;</div></li><li><div>              __return_null(), &nbsp;</div></li><li><div>              '__return_false', &nbsp;</div></li><li><div>              'edd_settings_' . $tab . '_' . $section&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $settings as $option ) {&nbsp;</div></li><li><div>              <span class="comment">// For backwards compatibility</span>&nbsp;</div></li><li><div>              if ( empty( $option['id'] ) ) {&nbsp;</div></li><li><div>                  continue;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $args = wp_parse_args( $option, array(&nbsp;</div></li><li><div>                  'section' =&gt; $section, &nbsp;</div></li><li><div>                  'id' =&gt; null, &nbsp;</div></li><li><div>                  'desc' =&gt; '', &nbsp;</div></li><li><div>                  'name' =&gt; '', &nbsp;</div></li><li><div>                  'size' =&gt; null, &nbsp;</div></li><li><div>                  'options' =&gt; '', &nbsp;</div></li><li><div>                  'std' =&gt; '', &nbsp;</div></li><li><div>                  'min' =&gt; null, &nbsp;</div></li><li><div>                  'max' =&gt; null, &nbsp;</div></li><li><div>                  'step' =&gt; null, &nbsp;</div></li><li><div>                  'chosen' =&gt; null, &nbsp;</div></li><li><div>                  'placeholder' =&gt; null, &nbsp;</div></li><li><div>                  'allow_blank' =&gt; true, &nbsp;</div></li><li><div>                  'readonly' =&gt; false, &nbsp;</div></li><li><div>                  'faux' =&gt; false, &nbsp;</div></li><li><div>                  'tooltip_title' =&gt; false, &nbsp;</div></li><li><div>                  'tooltip_desc' =&gt; false, &nbsp;</div></li><li><div>                  'field_class' =&gt; '', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              add_settings_field(&nbsp;</div></li><li><div>                  'edd_settings[' . $args['id'] . ']', &nbsp;</div></li><li><div>                  $args['name'], &nbsp;</div></li><li><div>                  function_exists( 'edd_' . $args['type'] . '_callback' ) ? 'edd_' . $args['type'] . '_callback' : 'edd_missing_callback', &nbsp;</div></li><li><div>                  'edd_settings_' . $tab . '_' . $section, &nbsp;</div></li><li><div>                  'edd_settings_' . $tab . '_' . $section, &nbsp;</div></li><li><div>                  $args&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Creates our settings in the options table</span>&nbsp;</div></li><li><div>  register_setting( 'edd_settings', 'edd_settings', 'edd_settings_sanitize' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_action( 'admin_init', 'edd_register_settings' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieve the array of plugin settings</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.8</span>&nbsp;</div></li><li><div><span class="comment"> * @return array</span>&nbsp;</div></li><li><div><span class="comment">*/</span>&nbsp;</div></li><li><div>function edd_get_registered_settings() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment">   * 'Whitelisted' EDD settings, filters are provided for each settings</span>&nbsp;</div></li><li><div><span class="comment">   * section to allow extensions and other plugins to add their own settings</span>&nbsp;</div></li><li><div><span class="comment">   */</span>&nbsp;</div></li><li><div>  $edd_settings = array(&nbsp;</div></li><li><div>      <span class="comment">/** General Settings */</span>&nbsp;</div></li><li><div>      'general' =&gt; apply_filters( 'edd_settings_general', &nbsp;</div></li><li><div>          array(&nbsp;</div></li><li><div>              'main' =&gt; array(&nbsp;</div></li><li><div>                  'page_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'page_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Page Settings', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'desc' =&gt; '', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div>                      'tooltip_title' =&gt; __( 'Page Settings', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_desc' =&gt; __( 'Easy Digital Downloads uses the pages below for handling the display of checkout, purchase confirmation, purchase history, and purchase failures. If pages are deleted or removed in some way, they can be recreated manually from the Pages menu. When re-creating the pages, enter the shortcode shown in the page content area.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'purchase_page' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'purchase_page', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Checkout Page', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'This is the checkout page where buyers will complete their purchases. The [download_checkout] shortcode must be on this page.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'select', &nbsp;</div></li><li><div>                      'options' =&gt; edd_get_pages(), &nbsp;</div></li><li><div>                      'chosen' =&gt; true, &nbsp;</div></li><li><div>                      'placeholder' =&gt; __( 'Select a page', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'success_page' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'success_page', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Success Page', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'This is the page buyers are sent to after completing their purchases. The [edd_receipt] shortcode should be on this page.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'select', &nbsp;</div></li><li><div>                      'options' =&gt; edd_get_pages(), &nbsp;</div></li><li><div>                      'chosen' =&gt; true, &nbsp;</div></li><li><div>                      'placeholder' =&gt; __( 'Select a page', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'failure_page' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'failure_page', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Failed Transaction Page', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'This is the page buyers are sent to if their transaction is cancelled or fails.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'select', &nbsp;</div></li><li><div>                      'options' =&gt; edd_get_pages(), &nbsp;</div></li><li><div>                      'chosen' =&gt; true, &nbsp;</div></li><li><div>                      'placeholder' =&gt; __( 'Select a page', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'purchase_history_page' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'purchase_history_page', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Purchase History Page', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'This page shows a complete purchase history for the current user, including download links. The [purchase_history] shortcode should be on this page.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'select', &nbsp;</div></li><li><div>                      'options' =&gt; edd_get_pages(), &nbsp;</div></li><li><div>                      'chosen' =&gt; true, &nbsp;</div></li><li><div>                      'placeholder' =&gt; __( 'Select a page', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'login_redirect_page' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'login_redirect_page', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Login Redirect Page', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; sprintf(&nbsp;</div></li><li><div>                              __( 'This is the page where buyers will be redirected by default once they log in. The [edd_login redirect=&quot;%s&quot;] shortcode with the redirect attribute can override this setting.', 'easy-digital-downloads' ), trailingslashit( home_url() )&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                      'type' =&gt; 'select', &nbsp;</div></li><li><div>                      'options' =&gt; edd_get_pages(), &nbsp;</div></li><li><div>                      'chosen' =&gt; true, &nbsp;</div></li><li><div>                      'placeholder' =&gt; __( 'Select a page', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'locale_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'locale_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Store Location', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'desc' =&gt; '', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div>                      'tooltip_title' =&gt; __( 'Store Location Settings', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_desc' =&gt; __( 'Easy Digital Downloads will use the following Country and State to pre-fill fields at checkout. This will also pre-calculate any taxes defined if the location below has taxes enabled.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'base_country' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'base_country', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Base Country', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Where does your store operate from?', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'select', &nbsp;</div></li><li><div>                      'options' =&gt; edd_get_country_list(), &nbsp;</div></li><li><div>                      'chosen' =&gt; true, &nbsp;</div></li><li><div>                      'placeholder' =&gt; __( 'Select a country', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'base_state' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'base_state', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Base State / Province', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'What state / province does your store operate from?', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'shop_states', &nbsp;</div></li><li><div>                      'chosen' =&gt; true, &nbsp;</div></li><li><div>                      'placeholder' =&gt; __( 'Select a state', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'tracking_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'tracking_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Tracking Settings', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'desc' =&gt; '', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'allow_tracking' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'allow_tracking', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Allow Usage Tracking?', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; sprintf(&nbsp;</div></li><li><div>                          __( 'Allow Easy Digital Downloads to anonymously track how this plugin is used and help us make the plugin better. Opt-in to tracking and our newsletter and immediately be emailed a 20&#37; discount to the EDD shop, valid towards the &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;purchase of extensions&lt;/a&gt;. No sensitive data is tracked.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                          'https:<span class="comment">//easydigitaldownloads.com/downloads/?utm_source=' . substr( md5( get_bloginfo( 'name' ) ), 0, 10 ) . '&utm_medium=admin&utm_term=settings&utm_campaign=EDDUsageTracking'</span>&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>              'currency' =&gt; array(&nbsp;</div></li><li><div>                  'currency_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'currency_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Currency Settings', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'desc' =&gt; '', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'currency' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'currency', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Currency', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Choose your currency. Note that some payment gateways have currency restrictions.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'select', &nbsp;</div></li><li><div>                      'options' =&gt; edd_get_currencies(), &nbsp;</div></li><li><div>                      'chosen' =&gt; true, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'currency_position' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'currency_position', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Currency Position', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Choose the location of the currency sign.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'select', &nbsp;</div></li><li><div>                      'options' =&gt; array(&nbsp;</div></li><li><div>                          'before' =&gt; __( 'Before - $10', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                          'after' =&gt; __( 'After - 10$', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'thousands_separator' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'thousands_separator', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Thousands Separator', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'The symbol (usually , or .) to separate thousands', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div>                      'size' =&gt; 'small', &nbsp;</div></li><li><div>                      'std' =&gt; ', ', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'decimal_separator' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'decimal_separator', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Decimal Separator', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'The symbol (usually , or .) to separate decimal points', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div>                      'size' =&gt; 'small', &nbsp;</div></li><li><div>                      'std' =&gt; '.', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>              'api' =&gt; array(&nbsp;</div></li><li><div>                  'api_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'api_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'API Settings', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'desc' =&gt; '', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div>                      'tooltip_title' =&gt; __( 'API Settings', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_desc' =&gt; __( 'The Easy Digital Downloads REST API provides access to store data through our API endpoints. Enable this setting if you would like all user accounts to be able to generate their own API keys.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'api_allow_user_keys' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'api_allow_user_keys', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Allow User Keys', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Check this box to allow all users to generate API keys. Users with the \'manage_shop_settings\' capability are always allowed to generate keys.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'api_help' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'api_help', &nbsp;</div></li><li><div>                      'desc' =&gt; sprintf( __( 'Visit the &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;REST API documentation&lt;/a&gt; for further information.', 'easy-digital-downloads' ), 'http:<span class="comment">//docs.easydigitaldownloads.com/article/1131-edd-rest-api-introduction' ), </span>&nbsp;</div></li><li><div>                      'type' =&gt; 'descriptive_text', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      <span class="comment">/** Payment Gateways Settings */</span>&nbsp;</div></li><li><div>      'gateways' =&gt; apply_filters('edd_settings_gateways', &nbsp;</div></li><li><div>          array(&nbsp;</div></li><li><div>              'main' =&gt; array(&nbsp;</div></li><li><div>                  'gateway_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'api_header', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Gateway Settings', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'desc' =&gt; '', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'test_mode' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'test_mode', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Test Mode', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'While in test mode no live transactions are processed. To fully use test mode, you must have a sandbox (test) account for the payment gateway you are testing.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'gateways' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'gateways', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Payment Gateways', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Choose the payment gateways you want to enable.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'gateways', &nbsp;</div></li><li><div>                      'options' =&gt; edd_get_payment_gateways(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'default_gateway' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'default_gateway', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Default Gateway', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'This gateway will be loaded automatically with the checkout page.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'gateway_select', &nbsp;</div></li><li><div>                      'options' =&gt; edd_get_payment_gateways(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'accepted_cards' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'accepted_cards', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Accepted Payment Method Icons', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Display icons for the selected payment methods', 'easy-digital-downloads' ) . '&lt;br/&gt;' . __( 'You will also need to configure your gateway settings if you are accepting credit cards', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'payment_icons', &nbsp;</div></li><li><div>                      'options' =&gt; apply_filters('edd_accepted_payment_icons', array(&nbsp;</div></li><li><div>                              'mastercard' =&gt; 'Mastercard', &nbsp;</div></li><li><div>                              'visa' =&gt; 'Visa', &nbsp;</div></li><li><div>                              'americanexpress' =&gt; 'American Express', &nbsp;</div></li><li><div>                              'discover' =&gt; 'Discover', &nbsp;</div></li><li><div>                              'paypal' =&gt; 'PayPal', &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      <span class="comment">/** Emails Settings */</span>&nbsp;</div></li><li><div>      'emails' =&gt; apply_filters('edd_settings_emails', &nbsp;</div></li><li><div>          array(&nbsp;</div></li><li><div>              'main' =&gt; array(&nbsp;</div></li><li><div>                  'email_settings_header' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'email_settings_header', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Email Settings', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'email_template' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'email_template', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Email Template', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Choose a template. Click &quot;Save Changes&quot; then &quot;Preview Purchase Receipt&quot; to see the new template.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'select', &nbsp;</div></li><li><div>                      'options' =&gt; edd_get_email_templates(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'email_logo' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'email_logo', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Logo', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Upload or choose a logo to be displayed at the top of the purchase receipt emails. Displayed on HTML emails only.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'upload', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'email_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'email_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '', &nbsp;</div></li><li><div>                      'desc' =&gt; '', &nbsp;</div></li><li><div>                      'type' =&gt; 'hook', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>              'purchase_receipts' =&gt; array(&nbsp;</div></li><li><div>                  'purchase_receipt_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'purchase_receipt_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Purchase Receipts', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'from_name' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'from_name', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'From Name', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'The name purchase receipts are said to come from. This should probably be your site or shop name.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div>                      'std' =&gt; get_bloginfo( 'name' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'from_email' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'from_email', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'From Email', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Email to send purchase receipts from. This will act as the &quot;from&quot; and &quot;reply-to&quot; address.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div>                      'std' =&gt; get_bloginfo( 'admin_email' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'purchase_subject' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'purchase_subject', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Purchase Email Subject', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Enter the subject line for the purchase receipt email', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div>                      'std' =&gt; __( 'Purchase Receipt', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'purchase_heading' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'purchase_heading', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Purchase Email Heading', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Enter the heading for the purchase receipt email', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div>                      'std' =&gt; __( 'Purchase Receipt', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'purchase_receipt' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'purchase_receipt', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Purchase Receipt', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __('Enter the text that is sent as purchase receipt email to users after completion of a successful purchase. HTML is accepted. Available template tags:', 'easy-digital-downloads' ) . '&lt;br/&gt;' . edd_get_emails_tags_list(), &nbsp;</div></li><li><div>                      'type' =&gt; 'rich_editor', &nbsp;</div></li><li><div>                      'std' =&gt; __( &quot;Dear&quot;, &quot;easy-digital-downloads&quot; ) . &quot; {name}, \n\n&quot; . __( &quot;Thank you for your purchase. Please click on the link(s) below to download your files.&quot;, &quot;easy-digital-downloads&quot; ) . &quot;\n\n{download_list}\n\n{sitename}&quot;, &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>              'sale_notifications' =&gt; array(&nbsp;</div></li><li><div>                  'sale_notification_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'sale_notification_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Sale Notifications', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'sale_notification_subject' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'sale_notification_subject', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Sale Notification Subject', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Enter the subject line for the sale notification email', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div>                      'std' =&gt; 'New download purchase - Order #{payment_id}', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'sale_notification' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'sale_notification', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Sale Notification', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Enter the text that is sent as sale notification email after completion of a purchase. HTML is accepted. Available template tags:', 'easy-digital-downloads' ) . '&lt;br/&gt;' . edd_get_emails_tags_list(), &nbsp;</div></li><li><div>                      'type' =&gt; 'rich_editor', &nbsp;</div></li><li><div>                      'std' =&gt; edd_get_default_sale_notification_email(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'admin_notice_emails' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'admin_notice_emails', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Sale Notification Emails', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Enter the email address(es) that should receive a notification anytime a sale is made, one per line', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'textarea', &nbsp;</div></li><li><div>                      'std' =&gt; get_bloginfo( 'admin_email' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'disable_admin_notices' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'disable_admin_notices', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Disable Admin Notifications', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Check this box if you do not want to receive sales notification emails.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      <span class="comment">/** Styles Settings */</span>&nbsp;</div></li><li><div>      'styles' =&gt; apply_filters('edd_settings_styles', &nbsp;</div></li><li><div>          array(&nbsp;</div></li><li><div>              'main' =&gt; array(&nbsp;</div></li><li><div>                  'style_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'style_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Style Settings', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'disable_styles' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'disable_styles', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Disable Styles', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Check this to disable all included styling of buttons, checkout fields, and all other elements.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                      'tooltip_title' =&gt; __( 'Disabling Styles', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_desc' =&gt; __( 'If your theme has a complete custom CSS file for Easy Digital Downloads, you may wish to disable our default styles. This is not recommended unless your sure your theme has a complete custom CSS.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'button_header' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'button_header', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;strong&gt;' . __( 'Buttons', 'easy-digital-downloads' ) . '&lt;/strong&gt;', &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Options for add to cart and purchase buttons', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'button_style' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'button_style', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Default Button Style', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Choose the style you want to use for the buttons.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'select', &nbsp;</div></li><li><div>                      'options' =&gt; edd_get_button_styles(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'checkout_color' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'checkout_color', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Default Button Color', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Choose the color you want to use for the buttons.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'color_select', &nbsp;</div></li><li><div>                      'options' =&gt; edd_get_button_colors(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      <span class="comment">/** Taxes Settings */</span>&nbsp;</div></li><li><div>      'taxes' =&gt; apply_filters('edd_settings_taxes', &nbsp;</div></li><li><div>          array(&nbsp;</div></li><li><div>              'main' =&gt; array(&nbsp;</div></li><li><div>                  'tax_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'tax_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Tax Settings', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'tax_help' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'tax_help', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Need help?', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; sprintf( __( 'Visit the &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;Tax setup documentation&lt;/a&gt; for further information. If you need VAT support, there are options listed on the documentation page.', 'easy-digital-downloads' ), 'http:<span class="comment">//docs.easydigitaldownloads.com/article/238-tax-settings' ), </span>&nbsp;</div></li><li><div>                      'type' =&gt; 'descriptive_text', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'enable_taxes' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'enable_taxes', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Enable Taxes', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Check this to enable taxes on purchases.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                      'tooltip_title' =&gt; __( 'Enabling Taxes', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_desc' =&gt; __( 'With taxes enabled, Easy Digital Downloads will use the rules below to charge tax to customers. With taxes enabled, customers are required to input their address on checkout so that taxes can be properly calculated.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'tax_rates' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'tax_rates', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;strong&gt;' . __( 'Tax Rates', 'easy-digital-downloads' ) . '&lt;/strong&gt;', &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Add tax rates for specific regions. Enter a percentage, such as 6.5 for 6.5%.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'tax_rates', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'tax_rate' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'tax_rate', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Fallback Tax Rate', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Customers not in a specific rate will be charged this tax rate. Enter a percentage, such as 6.5 for 6.5%. ', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div>                      'size' =&gt; 'small', &nbsp;</div></li><li><div>                      'tooltip_title' =&gt; __( 'Fallback Tax Rate', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_desc' =&gt; __( 'If the customer\'s address fails to meet the above tax rules, you can define a `default` tax rate to be applied to all other customers. Enter a percentage, such as 6.5 for 6.5%.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'prices_include_tax' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'prices_include_tax', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Prices entered with tax', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'This option affects how you enter prices.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'radio', &nbsp;</div></li><li><div>                      'std' =&gt; 'no', &nbsp;</div></li><li><div>                      'options' =&gt; array(&nbsp;</div></li><li><div>                          'yes' =&gt; __( 'Yes, I will enter prices inclusive of tax', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                          'no' =&gt; __( 'No, I will enter prices exclusive of tax', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                      'tooltip_title' =&gt; __( 'Prices Inclusive of Tax', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_desc' =&gt; __( 'When using prices inclusive of tax, you will be entering your prices as the total amount you want a customer to pay for the download, including tax. Easy Digital Downloads will calculate the proper amount to tax the customer for the defined total price.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'display_tax_rate' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'display_tax_rate', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Display Tax Rate on Prices', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Some countries require a notice when product prices include tax.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'checkout_include_tax' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'checkout_include_tax', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Display during checkout', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Should prices on the checkout page be shown with or without tax?', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'select', &nbsp;</div></li><li><div>                      'std' =&gt; 'no', &nbsp;</div></li><li><div>                      'options' =&gt; array(&nbsp;</div></li><li><div>                          'yes' =&gt; __( 'Including tax', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                          'no' =&gt; __( 'Excluding tax', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                      'tooltip_title' =&gt; __( 'Taxes Displayed for Products on Checkout', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_desc' =&gt; __( 'This option will determine whether the product price displays with or without tax on checkout.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      <span class="comment">/** Extension Settings */</span>&nbsp;</div></li><li><div>      'extensions' =&gt; apply_filters('edd_settings_extensions', &nbsp;</div></li><li><div>          array()&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'licenses' =&gt; apply_filters('edd_settings_licenses', &nbsp;</div></li><li><div>          array()&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      <span class="comment">/** Misc Settings */</span>&nbsp;</div></li><li><div>      'misc' =&gt; apply_filters('edd_settings_misc', &nbsp;</div></li><li><div>          array(&nbsp;</div></li><li><div>              'main' =&gt; array(&nbsp;</div></li><li><div>                  'misc_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'misc_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Misc Settings', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'redirect_on_add' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'redirect_on_add', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Redirect to Checkout', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Immediately redirect to checkout after adding an item to the cart?', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                      'tooltip_title' =&gt; __( 'Redirect to Checkout', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_desc' =&gt; __( 'When enabled, once an item has been added to the cart, the customer will be redirected directly to your checkout page. This is useful for stores that sell single items.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'item_quantities' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'item_quantities', &nbsp;</div></li><li><div>                      'name' =&gt; __('Item Quantities', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __('Allow item quantities to be changed.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'uninstall_on_delete' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'uninstall_on_delete', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Remove Data on Uninstall?', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Check this box if you would like EDD to completely remove all of its data when the plugin is deleted.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>              'checkout' =&gt; array(&nbsp;</div></li><li><div>                  'checkout_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'checkout_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Checkout Settings', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'enforce_ssl' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'enforce_ssl', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Enforce SSL on Checkout', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Check this to force users to be redirected to the secure checkout page. You must have an SSL certificate installed to use this option.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'logged_in_only' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'logged_in_only', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Require Login', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Require that users be logged-in to purchase files.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                      'tooltip_title' =&gt; __( 'Require Login', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_desc' =&gt; __( 'You can require that customers create and login to user accounts prior to purchasing from your store by enabling this option. When unchecked, users can purchase without being logged in by using their name and email address.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'show_register_form' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'show_register_form', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Show Register / Login Form?', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Display the registration and login forms on the checkout page for non-logged-in users.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'select', &nbsp;</div></li><li><div>                      'std' =&gt; 'none', &nbsp;</div></li><li><div>                      'options' =&gt; array(&nbsp;</div></li><li><div>                          'both' =&gt; __( 'Registration and Login Forms', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                          'registration' =&gt; __( 'Registration Form Only', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                          'login' =&gt; __( 'Login Form Only', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                          'none' =&gt; __( 'None', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'allow_multiple_discounts' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'allow_multiple_discounts', &nbsp;</div></li><li><div>                      'name' =&gt; __('Multiple Discounts', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __('Allow customers to use multiple discounts on the same purchase?', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'enable_cart_saving' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'enable_cart_saving', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Enable Cart Saving', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Check this to enable cart saving on the checkout.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div>                      'tooltip_title' =&gt; __( 'Cart Saving', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_desc' =&gt; __( 'Cart saving allows shoppers to create a temporary link to their current shopping cart so they can come back to it later, or share it with someone.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>              'button_text' =&gt; array(&nbsp;</div></li><li><div>                  'button_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'button_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Button Text', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'checkout_label' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'checkout_label', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Complete Purchase Text', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'The button label for completing a purchase.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div>                      'std' =&gt; __( 'Purchase', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'add_to_cart_text' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'add_to_cart_text', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Add to Cart Text', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Text shown on the Add to Cart Buttons.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div>                      'std' =&gt; __( 'Add to Cart', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'buy_now_text' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'buy_now_text', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Buy Now Text', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Text shown on the Buy Now Buttons.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div>                      'std' =&gt; __( 'Buy Now', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>              'file_downloads' =&gt; array(&nbsp;</div></li><li><div>                  'file_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'file_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'File Download Settings', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'download_method' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'download_method', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Download Method', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; sprintf( __( 'Select the file download method. Note, not all methods work on all servers.', 'easy-digital-downloads' ), edd_get_label_singular() ), &nbsp;</div></li><li><div>                      'type' =&gt; 'select', &nbsp;</div></li><li><div>                      'tooltip_title' =&gt; __( 'Download Method', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_desc' =&gt; __( 'Due to its consistency in multiple platforms and better file protection, \'forced\' is the default method. Because Easy Digital Downloads uses PHP to process the file with the \'forced\' method, larger files can cause problems with delivery, resulting in hitting the \'max execution time\' of the server. If users are getting 404 or 403 errors when trying to access their purchased files when using the \'forced\' method, changing to the \'redirect\' method can help resolve this.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'options' =&gt; array(&nbsp;</div></li><li><div>                          'direct' =&gt; __( 'Forced', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                          'redirect' =&gt; __( 'Redirect', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'symlink_file_downloads' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'symlink_file_downloads', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Symlink File Downloads?', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Check this if you are delivering really large files or having problems with file downloads completing.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'file_download_limit' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'file_download_limit', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'File Download Limit', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; sprintf( __( 'The maximum number of times files can be downloaded for purchases. Can be overwritten for each %s.', 'easy-digital-downloads' ), edd_get_label_singular() ), &nbsp;</div></li><li><div>                      'type' =&gt; 'number', &nbsp;</div></li><li><div>                      'size' =&gt; 'small', &nbsp;</div></li><li><div>                      'tooltip_title' =&gt; __( 'File Download Limits', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_desc' =&gt; sprintf( __( 'Set the global default for the number of times a customer can download items they purchase. Using a value of 0 is unlimited. This can be defined on a %s-specific level as well. Download limits can also be reset for an individual purchase.', 'easy-digital-downloads' ), edd_get_label_singular( true ) ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'download_link_expiration' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'download_link_expiration', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Download Link Expiration', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'How long should download links be valid for? Default is 24 hours from the time they are generated. Enter a time in hours.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_title' =&gt; __( 'Download Link Expiration', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'tooltip_desc' =&gt; __( 'When a customer receives a link to their downloads via email, in their receipt, or in their purchase history, the link will only be valid for the timeframe (in hours) defined in this setting. Sending a new purchase receipt or visiting the account page will re-generate a valid link for the customer.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'number', &nbsp;</div></li><li><div>                      'size' =&gt; 'small', &nbsp;</div></li><li><div>                      'std' =&gt; '24', &nbsp;</div></li><li><div>                      'min' =&gt; '0', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'disable_redownload' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'disable_redownload', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Disable Redownload?', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Check this if you do not want to allow users to redownload items from their purchase history.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>              'accounting' =&gt; array(&nbsp;</div></li><li><div>                  'accounting_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'accounting_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Accounting Settings', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'enable_skus' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'enable_skus', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Enable SKU Entry', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Check this box to allow entry of product SKUs. SKUs will be shown on purchase receipt and exported purchase histories.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'enable_sequential' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'enable_sequential', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Sequential Order Numbers', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Check this box to enable sequential order numbers.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'sequential_start' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'sequential_start', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Sequential Starting Number', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'The number at which the sequence should begin.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'number', &nbsp;</div></li><li><div>                      'size' =&gt; 'small', &nbsp;</div></li><li><div>                      'std' =&gt; '1', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'sequential_prefix' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'sequential_prefix', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Sequential Number Prefix', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'A prefix to prepend to all sequential order numbers.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'sequential_postfix' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'sequential_postfix', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Sequential Number Postfix', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'A postfix to append to all sequential order numbers.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>              'site_terms' =&gt; array(&nbsp;</div></li><li><div>                  'terms_settings' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'terms_settings', &nbsp;</div></li><li><div>                      'name' =&gt; '&lt;h3&gt;' . __( 'Agreement Settings', 'easy-digital-downloads' ) . '&lt;/h3&gt;', &nbsp;</div></li><li><div>                      'type' =&gt; 'header', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'show_agree_to_terms' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'show_agree_to_terms', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Agree to Terms', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Check this to show an agree to terms on the checkout that users must agree to before purchasing.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'checkbox', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'agree_label' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'agree_label', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Agree to Terms Label', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'Label shown next to the agree to terms check box.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'text', &nbsp;</div></li><li><div>                      'size' =&gt; 'regular', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>                  'agree_text' =&gt; array(&nbsp;</div></li><li><div>                      'id' =&gt; 'agree_text', &nbsp;</div></li><li><div>                      'name' =&gt; __( 'Agreement Text', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'desc' =&gt; __( 'If Agree to Terms is checked, enter the agreement terms here.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                      'type' =&gt; 'rich_editor', &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! edd_shop_supports_buy_now() ) {&nbsp;</div></li><li><div>      $edd_settings['misc']['button_text']['buy_now_text']['disabled'] = true;&nbsp;</div></li><li><div>      $edd_settings['misc']['button_text']['buy_now_text']['tooltip_title'] = __( 'Buy Now Disabled', 'easy-digital-downloads' );&nbsp;</div></li><li><div>      $edd_settings['misc']['button_text']['buy_now_text']['tooltip_desc'] = __( 'Buy Now buttons are only available for stores that have a single supported gateway active and that do not use taxes.', 'easy-digital-downloads' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return apply_filters( 'edd_registered_settings', $edd_settings );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Settings Sanitization</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Adds a settings error (for the updated message)</span>&nbsp;</div></li><li><div><span class="comment"> * At some point this will validate input</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.8.2</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $input The value inputted in the field</span>&nbsp;</div></li><li><div><span class="comment"> * @global $edd_options Array of all the EDD Options</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return string $input Sanitizied value</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_settings_sanitize( $input = array() ) {&nbsp;</div></li><li><div>  global $edd_options;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $doing_section = false;&nbsp;</div></li><li><div>  if ( ! empty( $_POST['_wp_http_referer'] ) ) {&nbsp;</div></li><li><div>      $doing_section = true;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $setting_types = edd_get_registered_settings_types();&nbsp;</div></li><li><div>  $input = $input ? $input : array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $doing_section ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      parse_str( $_POST['_wp_http_referer'], $referrer ); <span class="comment">// Pull out the tab and section</span>&nbsp;</div></li><li><div>      $tab = isset( $referrer['tab'] ) ? $referrer['tab'] : 'general';&nbsp;</div></li><li><div>      $section = isset( $referrer['section'] ) ? $referrer['section'] : 'main';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Run a general sanitization for the tab for special fields (like taxes)</span>&nbsp;</div></li><li><div>      $input = apply_filters( 'edd_settings_' . $tab . '_sanitize', $input );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Run a general sanitization for the section so custom tabs with sub-sections can save special data</span>&nbsp;</div></li><li><div>      $input = apply_filters( 'edd_settings_' . $tab . '-' . $section . '_sanitize', $input );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  <span class="comment">// Merge our new settings with the existing</span>&nbsp;</div></li><li><div>  $output = array_merge( $edd_options, $input );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( $setting_types as $key =&gt; $type ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( empty( $type ) ) {&nbsp;</div></li><li><div>          continue;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Some setting types are not actually settings, just keep moving along here</span>&nbsp;</div></li><li><div>      $non_setting_types = apply_filters( 'edd_non_setting_types', array(&nbsp;</div></li><li><div>          'header', 'descriptive_text', 'hook', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( in_array( $type, $non_setting_types ) ) {&nbsp;</div></li><li><div>          continue;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( array_key_exists( $key, $output ) ) {&nbsp;</div></li><li><div>          $output[ $key ] = apply_filters( 'edd_settings_sanitize_' . $type, $output[ $key ], $key );&nbsp;</div></li><li><div>          $output[ $key ] = apply_filters( 'edd_settings_sanitize', $output[ $key ], $key );&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $doing_section ) {&nbsp;</div></li><li><div>          switch( $type ) {&nbsp;</div></li><li><div>              case 'checkbox':&nbsp;</div></li><li><div>              case 'gateways':&nbsp;</div></li><li><div>              case 'multicheck':&nbsp;</div></li><li><div>              case 'payment_icons':&nbsp;</div></li><li><div>                  if ( array_key_exists( $key, $input ) && $output[ $key ] === '-1' ) {&nbsp;</div></li><li><div>                      unset( $output[ $key ] );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>              default:&nbsp;</div></li><li><div>                  if ( array_key_exists( $key, $input ) && empty( $input[ $key ] ) ) {&nbsp;</div></li><li><div>                      unset( $output[ $key ] );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  break;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          if ( empty( $input[ $key ] ) ) {&nbsp;</div></li><li><div>              unset( $output[ $key ] );&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $doing_section ) {&nbsp;</div></li><li><div>      add_settings_error( 'edd-notices', '', __( 'Settings updated.', 'easy-digital-downloads' ), 'updated' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $output;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Flattens the set of registered settings and their type so we can easily sanitize all the settings</span>&nbsp;</div></li><li><div><span class="comment"> * in a much cleaner set of logic in edd_settings_sanitize</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since  2.6.5</span>&nbsp;</div></li><li><div><span class="comment"> * @return array Key is the setting ID, value is the type of setting it is registered as</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_get_registered_settings_types() {&nbsp;</div></li><li><div>  $settings = edd_get_registered_settings();&nbsp;</div></li><li><div>  $setting_types = array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( $settings as $tab ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      foreach ( $tab as $section_or_setting ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// See if we have a setting registered at the tab level for backwards compatibility</span>&nbsp;</div></li><li><div>          if ( is_array( $section_or_setting ) && array_key_exists( 'type', $section_or_setting ) ) {&nbsp;</div></li><li><div>              $setting_types[ $section_or_setting['id'] ] = $section_or_setting['type'];&nbsp;</div></li><li><div>              continue;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          foreach ( $section_or_setting as $section =&gt; $section_settings ) {&nbsp;</div></li><li><div>              $setting_types[ $section_settings['id'] ] = $section_settings['type'];&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $setting_types;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Misc File Download Settings Sanitization</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.5</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $input The value inputted in the field</span>&nbsp;</div></li><li><div><span class="comment"> * @return string $input Sanitizied value</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_settings_sanitize_misc_file_downloads( $input ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( ! current_user_can( 'manage_shop_settings' ) ) {&nbsp;</div></li><li><div>      return $input;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( edd_get_file_download_method() != $input['download_method'] || ! edd_htaccess_exists() ) {&nbsp;</div></li><li><div>      <span class="comment">// Force the .htaccess files to be updated if the Download method was changed.</span>&nbsp;</div></li><li><div>      edd_create_protection_files( true, $input['download_method'] );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $input;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_filter( 'edd_settings_misc-file_downloads_sanitize', 'edd_settings_sanitize_misc_file_downloads' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Misc Accounting Settings Sanitization</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.5</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $input The value inputted in the field</span>&nbsp;</div></li><li><div><span class="comment"> * @return string $input Sanitizied value</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_settings_sanitize_misc_accounting( $input ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( ! current_user_can( 'manage_shop_settings' ) ) {&nbsp;</div></li><li><div>      return $input;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( ! empty( $input['enable_sequential'] ) && ! edd_get_option( 'enable_sequential' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      <span class="comment">// Shows an admin notice about upgrading previous order numbers</span>&nbsp;</div></li><li><div>      EDD()-&gt;session-&gt;set( 'upgrade_sequential', '1' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $input;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_filter( 'edd_settings_misc-accounting_sanitize', 'edd_settings_sanitize_misc_accounting' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Taxes Settings Sanitization</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Adds a settings error (for the updated message)</span>&nbsp;</div></li><li><div><span class="comment"> * This also saves the tax rates table</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.6</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $input The value inputted in the field</span>&nbsp;</div></li><li><div><span class="comment"> * @return string $input Sanitizied value</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_settings_sanitize_taxes( $input ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( ! current_user_can( 'manage_shop_settings' ) ) {&nbsp;</div></li><li><div>      return $input;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( ! isset( $_POST['tax_rates'] ) ) {&nbsp;</div></li><li><div>      return $input;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $new_rates = ! empty( $_POST['tax_rates'] ) ? array_values( $_POST['tax_rates'] ) : array();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  update_option( 'edd_tax_rates', $new_rates );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $input;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_filter( 'edd_settings_taxes_sanitize', 'edd_settings_sanitize_taxes' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Payment Gateways Settings Sanitization</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Adds a settings error (for the updated message)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.7</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $input The value inputted in the field</span>&nbsp;</div></li><li><div><span class="comment"> * @return string $input Sanitizied value</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_settings_sanitize_gateways( $input ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! current_user_can( 'manage_shop_settings' ) || empty( $input['default_gateway'] ) ) {&nbsp;</div></li><li><div>      return $input;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $input['gateways'] ) || '-1' == $input['gateways'] )  {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      add_settings_error( 'edd-notices', '', __( 'Error setting default gateway. No gateways are enabled.', 'easy-digital-downloads' ) );&nbsp;</div></li><li><div>      unset( $input['default_gateway'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  } else if ( ! array_key_exists( $input['default_gateway'], $input['gateways'] ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $enabled_gateways = $input['gateways'];&nbsp;</div></li><li><div>      $all_gateways = edd_get_payment_gateways();&nbsp;</div></li><li><div>      $selected_default = $all_gateways[ $input['default_gateway'] ];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      reset( $enabled_gateways );&nbsp;</div></li><li><div>      $first_gateway = key( $enabled_gateways );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $first_gateway ) {&nbsp;</div></li><li><div>          add_settings_error( 'edd-notices', '', sprintf( __( '%s could not be set as the default gateway. It must first be enabled.', 'easy-digital-downloads' ), $selected_default['admin_label'] ), 'error' );&nbsp;</div></li><li><div>          $input['default_gateway'] = $first_gateway;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $input;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_filter( 'edd_settings_gateways_sanitize', 'edd_settings_sanitize_gateways' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Sanitize text fields</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.8</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $input The field value</span>&nbsp;</div></li><li><div><span class="comment"> * @return string $input Sanitizied value</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_sanitize_text_field( $input ) {&nbsp;</div></li><li><div>  $tags = array(&nbsp;</div></li><li><div>      'p' =&gt; array(&nbsp;</div></li><li><div>          'class' =&gt; array(), &nbsp;</div></li><li><div>          'id' =&gt; array(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'span' =&gt; array(&nbsp;</div></li><li><div>          'class' =&gt; array(), &nbsp;</div></li><li><div>          'id' =&gt; array(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'a' =&gt; array(&nbsp;</div></li><li><div>          'href' =&gt; array(), &nbsp;</div></li><li><div>          'title' =&gt; array(), &nbsp;</div></li><li><div>          'class' =&gt; array(), &nbsp;</div></li><li><div>          'title' =&gt; array(), &nbsp;</div></li><li><div>          'id' =&gt; array(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'strong' =&gt; array(), &nbsp;</div></li><li><div>      'em' =&gt; array(), &nbsp;</div></li><li><div>      'br' =&gt; array(), &nbsp;</div></li><li><div>      'img' =&gt; array(&nbsp;</div></li><li><div>          'src' =&gt; array(), &nbsp;</div></li><li><div>          'title' =&gt; array(), &nbsp;</div></li><li><div>          'alt' =&gt; array(), &nbsp;</div></li><li><div>          'id' =&gt; array(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'div' =&gt; array(&nbsp;</div></li><li><div>          'class' =&gt; array(), &nbsp;</div></li><li><div>          'id' =&gt; array(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'ul' =&gt; array(&nbsp;</div></li><li><div>          'class' =&gt; array(), &nbsp;</div></li><li><div>          'id' =&gt; array(), &nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>      'li' =&gt; array(&nbsp;</div></li><li><div>          'class' =&gt; array(), &nbsp;</div></li><li><div>          'id' =&gt; array(), &nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $allowed_tags = apply_filters( 'edd_allowed_html_tags', $tags );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return trim( wp_kses( $input, $allowed_tags ) );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_filter( 'edd_settings_sanitize_text', 'edd_sanitize_text_field' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Sanitize HTML Class Names</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.6.11</span>&nbsp;</div></li><li><div><span class="comment"> * @param  string|array $class HTML Class Name(s)</span>&nbsp;</div></li><li><div><span class="comment"> * @return string $class</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_sanitize_html_class( $class = '' ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( is_string( $class ) ) {&nbsp;</div></li><li><div>      $class = sanitize_html_class( $class );&nbsp;</div></li><li><div>  } else if ( is_array( $class ) ) {&nbsp;</div></li><li><div>      $class = array_values( array_map( 'sanitize_html_class', $class ) );&nbsp;</div></li><li><div>      $class = implode( ' ', array_unique( $class ) );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $class;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieve settings tabs</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.8</span>&nbsp;</div></li><li><div><span class="comment"> * @return array $tabs</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_get_settings_tabs() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $settings = edd_get_registered_settings();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $tabs = array();&nbsp;</div></li><li><div>  $tabs['general'] = __( 'General', 'easy-digital-downloads' );&nbsp;</div></li><li><div>  $tabs['gateways'] = __( 'Payment Gateways', 'easy-digital-downloads' );&nbsp;</div></li><li><div>  $tabs['emails'] = __( 'Emails', 'easy-digital-downloads' );&nbsp;</div></li><li><div>  $tabs['styles'] = __( 'Styles', 'easy-digital-downloads' );&nbsp;</div></li><li><div>  $tabs['taxes'] = __( 'Taxes', 'easy-digital-downloads' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( ! empty( $settings['extensions'] ) ) {&nbsp;</div></li><li><div>      $tabs['extensions'] = __( 'Extensions', 'easy-digital-downloads' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>  if( ! empty( $settings['licenses'] ) ) {&nbsp;</div></li><li><div>      $tabs['licenses'] = __( 'Licenses', 'easy-digital-downloads' );&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $tabs['misc'] = __( 'Misc', 'easy-digital-downloads' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return apply_filters( 'edd_settings_tabs', $tabs );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieve settings tabs</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.5</span>&nbsp;</div></li><li><div><span class="comment"> * @return array $section</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_get_settings_tab_sections( $tab = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $tabs = false;&nbsp;</div></li><li><div>  $sections = edd_get_registered_settings_sections();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( $tab && ! empty( $sections[ $tab ] ) ) {&nbsp;</div></li><li><div>      $tabs = $sections[ $tab ];&nbsp;</div></li><li><div>  } else if ( $tab ) {&nbsp;</div></li><li><div>      $tabs = false;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $tabs;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Get the settings sections for each tab</span>&nbsp;</div></li><li><div><span class="comment"> * Uses a static to avoid running the filters on every request to this function</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since  2.5</span>&nbsp;</div></li><li><div><span class="comment"> * @return array Array of tabs and sections</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_get_registered_settings_sections() {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  static $sections = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( false !== $sections ) {&nbsp;</div></li><li><div>      return $sections;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $sections = array(&nbsp;</div></li><li><div>      'general' =&gt; apply_filters( 'edd_settings_sections_general', array(&nbsp;</div></li><li><div>          'main' =&gt; __( 'General Settings', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>          'currency' =&gt; __( 'Currency Settings', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>          'api' =&gt; __( 'API Settings', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ) ), &nbsp;</div></li><li><div>      'gateways' =&gt; apply_filters( 'edd_settings_sections_gateways', array(&nbsp;</div></li><li><div>          'main' =&gt; __( 'Gateway Settings', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>          'paypal' =&gt; __( 'PayPal Standard', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ) ), &nbsp;</div></li><li><div>      'emails' =&gt; apply_filters( 'edd_settings_sections_emails', array(&nbsp;</div></li><li><div>          'main' =&gt; __( 'Email Settings', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>          'purchase_receipts' =&gt; __( 'Purchase Receipts', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>          'sale_notifications' =&gt; __( 'New Sale Notifications', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ) ), &nbsp;</div></li><li><div>      'styles' =&gt; apply_filters( 'edd_settings_sections_styles', array(&nbsp;</div></li><li><div>          'main' =&gt; __( 'Style Settings', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ) ), &nbsp;</div></li><li><div>      'taxes' =&gt; apply_filters( 'edd_settings_sections_taxes', array(&nbsp;</div></li><li><div>          'main' =&gt; __( 'Tax Settings', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ) ), &nbsp;</div></li><li><div>      'extensions' =&gt; apply_filters( 'edd_settings_sections_extensions', array(&nbsp;</div></li><li><div>          'main' =&gt; __( 'Main', 'easy-digital-downloads' )&nbsp;</div></li><li><div> ) ), &nbsp;</div></li><li><div>      'licenses' =&gt; apply_filters( 'edd_settings_sections_licenses', array() ), &nbsp;</div></li><li><div>      'misc' =&gt; apply_filters( 'edd_settings_sections_misc', array(&nbsp;</div></li><li><div>          'main' =&gt; __( 'Misc Settings', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>          'checkout' =&gt; __( 'Checkout Settings', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>          'button_text' =&gt; __( 'Button Text', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>          'file_downloads' =&gt; __( 'File Downloads', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>          'accounting' =&gt; __( 'Accounting Settings', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>          'site_terms' =&gt; __( 'Terms of Agreement', 'easy-digital-downloads' ), &nbsp;</div></li><li><div> ) ), &nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $sections = apply_filters( 'edd_settings_sections', $sections );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $sections;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Retrieve a list of all published pages</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * On large sites this can be expensive, so only load if on the settings page or $force is set to true</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.9.5</span>&nbsp;</div></li><li><div><span class="comment"> * @param bool $force Force the pages to be loaded even if not on settings</span>&nbsp;</div></li><li><div><span class="comment"> * @return array $pages_options An array of the pages</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_get_pages( $force = false ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $pages_options = array( '' =&gt; '' ); <span class="comment">// Blank option</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if( ( ! isset( $_GET['page'] ) || 'edd-settings' != $_GET['page'] ) && ! $force ) {&nbsp;</div></li><li><div>      return $pages_options;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $pages = get_pages();&nbsp;</div></li><li><div>  if ( $pages ) {&nbsp;</div></li><li><div>      foreach ( $pages as $page ) {&nbsp;</div></li><li><div>          $pages_options[ $page-&gt;ID ] = $page-&gt;post_title;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $pages_options;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Header Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders the header.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_header_callback( $args ) {&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', '', $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Checkbox Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders checkboxes.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_checkbox_callback( $args ) {&nbsp;</div></li><li><div>  $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $args['faux'] ) && true === $args['faux'] ) {&nbsp;</div></li><li><div>      $name = '';&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $name = 'name=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $checked = ! empty( $edd_option ) ? checked( 1, $edd_option, false ) : '';&nbsp;</div></li><li><div>  $html = '&lt;input type=&quot;hidden&quot;' . $name . ' value=&quot;-1&quot; /&gt;';&nbsp;</div></li><li><div>  $html    .= '&lt;input type=&quot;checkbox&quot; id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;' . $name . ' value=&quot;1&quot; ' . $checked . ' class=&quot;' . $class . '&quot;/&gt;';&nbsp;</div></li><li><div>  $html    .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;&gt; '  . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Multicheck Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders multiple checkboxes.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_multicheck_callback( $args ) {&nbsp;</div></li><li><div>  $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html = '';&nbsp;</div></li><li><div>  if ( ! empty( $args['options'] ) ) {&nbsp;</div></li><li><div>      $html .= '&lt;input type=&quot;hidden&quot; name=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; value=&quot;-1&quot; /&gt;';&nbsp;</div></li><li><div>      foreach( $args['options'] as $key =&gt; $option ):&nbsp;</div></li><li><div>          if( isset( $edd_option[ $key ] ) ) { $enabled = $option; } else { $enabled = NULL; }&nbsp;</div></li><li><div>          $html .= '&lt;input name=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . '][' . edd_sanitize_key( $key ) . ']&quot; id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . '][' . edd_sanitize_key( $key ) . ']&quot; class=&quot;' . $class . '&quot; type=&quot;checkbox&quot; value=&quot;' . esc_attr( $option ) . '&quot; ' . checked($option, $enabled, false) . '/&gt;&nbsp;';&nbsp;</div></li><li><div>          $html .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . '][' . edd_sanitize_key( $key ) . ']&quot;&gt;' . wp_kses_post( $option ) . '&lt;/label&gt;&lt;br/&gt;';&nbsp;</div></li><li><div>      endforeach;&nbsp;</div></li><li><div>      $html .= '&lt;p class=&quot;description&quot;&gt;' . $args['desc'] . '&lt;/p&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Payment method icons callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.1</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_payment_icons_callback( $args ) {&nbsp;</div></li><li><div>  $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html = '&lt;input type=&quot;hidden&quot; name=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; value=&quot;-1&quot; /&gt;';&nbsp;</div></li><li><div>  if ( ! empty( $args['options'] ) ) {&nbsp;</div></li><li><div>      foreach( $args['options'] as $key =&gt; $option ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          if( isset( $edd_option[ $key ] ) ) {&nbsp;</div></li><li><div>              $enabled = $option;&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>              $enabled = NULL;&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $html .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . '][' . edd_sanitize_key( $key ) . ']&quot; style=&quot;margin-right:10px;line-height:16px;height:16px;display:inline-block;&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $html .= '&lt;input name=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . '][' . edd_sanitize_key( $key ) . ']&quot; id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . '][' . edd_sanitize_key( $key ) . ']&quot; class=&quot;' . $class . '&quot; type=&quot;checkbox&quot; value=&quot;' . esc_attr( $option ) . '&quot; ' . checked( $option, $enabled, false ) . '/&gt;&nbsp;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              if( edd_string_is_image_url( $key ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $html .= '&lt;img class=&quot;payment-icon&quot; src=&quot;' . esc_url( $key ) . '&quot; style=&quot;width:32px;height:24px;position:relative;top:6px;margin-right:5px;&quot;/&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $card = strtolower( str_replace( ' ', '', $option ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  if( has_filter( 'edd_accepted_payment_' . $card . '_image' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $image = apply_filters( 'edd_accepted_payment_' . $card . '_image', '' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $image = edd_locate_template( 'images' . DIRECTORY_SEPARATOR . 'icons' . DIRECTORY_SEPARATOR . $card . '.png', false );&nbsp;</div></li><li><div>                      $content_dir = WP_CONTENT_DIR;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if( function_exists( 'wp_normalize_path' ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          <span class="comment">// Replaces backslashes with forward slashes for Windows systems</span>&nbsp;</div></li><li><div>                          $image = wp_normalize_path( $image );&nbsp;</div></li><li><div>                          $content_dir = wp_normalize_path( $content_dir );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $image = str_replace( $content_dir, content_url(), $image );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  $html .= '&lt;img class=&quot;payment-icon&quot; src=&quot;' . esc_url( $image ) . '&quot; style=&quot;width:32px;height:24px;position:relative;top:6px;margin-right:5px;&quot;/&gt;';&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $html .= $option . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>      $html .= '&lt;p class=&quot;description&quot; style=&quot;margin-top:16px;&quot;&gt;' . wp_kses_post( $args['desc'] ) . '&lt;/p&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Radio Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders radio boxes.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.3.3</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_radio_callback( $args ) {&nbsp;</div></li><li><div>  $edd_options = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( $args['options'] as $key =&gt; $option ) :&nbsp;</div></li><li><div>      $checked = false;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $edd_options && $edd_options == $key )&nbsp;</div></li><li><div>          $checked = true;&nbsp;</div></li><li><div>      elseif( isset( $args['std'] ) && $args['std'] == $key && ! $edd_options )&nbsp;</div></li><li><div>          $checked = true;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html .= '&lt;input name=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . '][' . edd_sanitize_key( $key ) . ']&quot; class=&quot;' . $class . '&quot; type=&quot;radio&quot; value=&quot;' . edd_sanitize_key( $key ) . '&quot; ' . checked(true, $checked, false) . '/&gt;&nbsp;';&nbsp;</div></li><li><div>      $html .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . '][' . edd_sanitize_key( $key ) . ']&quot;&gt;' . esc_html( $option ) . '&lt;/label&gt;&lt;br/&gt;';&nbsp;</div></li><li><div>  endforeach;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html .= '&lt;p class=&quot;description&quot;&gt;' . apply_filters( 'edd_after_setting_output', wp_kses_post( $args['desc'] ), $args ) . '&lt;/p&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo $html;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Gateways Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders gateways fields.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_gateways_callback( $args ) {&nbsp;</div></li><li><div>  $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html = '&lt;input type=&quot;hidden&quot; name=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; value=&quot;-1&quot; /&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( $args['options'] as $key =&gt; $option ) :&nbsp;</div></li><li><div>      if ( isset( $edd_option[ $key ] ) )&nbsp;</div></li><li><div>          $enabled = '1';&nbsp;</div></li><li><div>      else&nbsp;</div></li><li><div>          $enabled = null;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html .= '&lt;input name=&quot;edd_settings[' . esc_attr( $args['id'] ) . '][' . edd_sanitize_key( $key ) . ']&quot; id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . '][' . edd_sanitize_key( $key ) . ']&quot; class=&quot;' . $class . '&quot; type=&quot;checkbox&quot; value=&quot;1&quot; ' . checked('1', $enabled, false) . '/&gt;&nbsp;';&nbsp;</div></li><li><div>      $html .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . '][' . edd_sanitize_key( $key ) . ']&quot;&gt;' . esc_html( $option['admin_label'] ) . '&lt;/label&gt;&lt;br/&gt;';&nbsp;</div></li><li><div>  endforeach;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Gateways Callback (drop down)</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders gateways select menu</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_gateway_select_callback( $args ) {&nbsp;</div></li><li><div>  $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html = '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html .= '&lt;select name=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;&quot; id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; class=&quot;' . $class . '&quot;&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( $args['options'] as $key =&gt; $option ) :&nbsp;</div></li><li><div>      $selected = isset( $edd_option ) ? selected( $key, $edd_option, false ) : '';&nbsp;</div></li><li><div>      $html .= '&lt;option value=&quot;' . edd_sanitize_key( $key ) . '&quot;' . $selected . '&gt;' . esc_html( $option['admin_label'] ) . '&lt;/option&gt;';&nbsp;</div></li><li><div>  endforeach;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html .= '&lt;/select&gt;';&nbsp;</div></li><li><div>  $html .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;&gt; '  . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Text Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders text fields.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_text_callback( $args ) {&nbsp;</div></li><li><div>  $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $edd_option ) {&nbsp;</div></li><li><div>      $value = $edd_option;&nbsp;</div></li><li><div>  } elseif( ! empty( $args['allow_blank'] ) && empty( $edd_option ) ) {&nbsp;</div></li><li><div>      $value = '';&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $value = isset( $args['std'] ) ? $args['std'] : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $args['faux'] ) && true === $args['faux'] ) {&nbsp;</div></li><li><div>      $args['readonly'] = true;&nbsp;</div></li><li><div>      $value = isset( $args['std'] ) ? $args['std'] : '';&nbsp;</div></li><li><div>      $name = '';&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $name = 'name=&quot;edd_settings[' . esc_attr( $args['id'] ) . ']&quot;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $disabled = ! empty( $args['disabled'] ) ? ' disabled=&quot;disabled&quot;' : '';&nbsp;</div></li><li><div>  $readonly = $args['readonly'] === true ? ' readonly=&quot;readonly&quot;' : '';&nbsp;</div></li><li><div>  $size = ( isset( $args['size'] ) && ! is_null( $args['size'] ) ) ? $args['size'] : 'regular';&nbsp;</div></li><li><div>  $html = '&lt;input type=&quot;text&quot; class=&quot;' . $class . ' ' . sanitize_html_class( $size ) . '-text&quot; id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; ' . $name . ' value=&quot;' . esc_attr( stripslashes( $value ) ) . '&quot;' . $readonly . $disabled . ' placeholder=&quot;' . esc_attr( $args['placeholder'] ) . '&quot;/&gt;';&nbsp;</div></li><li><div>  $html    .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;&gt; '  . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Number Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders number fields.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.9</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_number_callback( $args ) {&nbsp;</div></li><li><div>  $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $edd_option ) {&nbsp;</div></li><li><div>      $value = $edd_option;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $value = isset( $args['std'] ) ? $args['std'] : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $args['faux'] ) && true === $args['faux'] ) {&nbsp;</div></li><li><div>      $args['readonly'] = true;&nbsp;</div></li><li><div>      $value = isset( $args['std'] ) ? $args['std'] : '';&nbsp;</div></li><li><div>      $name = '';&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $name = 'name=&quot;edd_settings[' . esc_attr( $args['id'] ) . ']&quot;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $max = isset( $args['max'] ) ? $args['max'] : 999999;&nbsp;</div></li><li><div>  $min = isset( $args['min'] ) ? $args['min'] : 0;&nbsp;</div></li><li><div>  $step = isset( $args['step'] ) ? $args['step'] : 1;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $size = ( isset( $args['size'] ) && ! is_null( $args['size'] ) ) ? $args['size'] : 'regular';&nbsp;</div></li><li><div>  $html = '&lt;input type=&quot;number&quot; step=&quot;' . esc_attr( $step ) . '&quot; max=&quot;' . esc_attr( $max ) . '&quot; min=&quot;' . esc_attr( $min ) . '&quot; class=&quot;' . $class . ' ' . sanitize_html_class( $size ) . '-text&quot; id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; ' . $name . ' value=&quot;' . esc_attr( stripslashes( $value ) ) . '&quot;/&gt;';&nbsp;</div></li><li><div>  $html .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;&gt; '  . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Textarea Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders textarea fields.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_textarea_callback( $args ) {&nbsp;</div></li><li><div>  $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $edd_option ) {&nbsp;</div></li><li><div>      $value = $edd_option;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $value = isset( $args['std'] ) ? $args['std'] : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html = '&lt;textarea class=&quot;' . $class . ' large-text&quot; cols=&quot;50&quot; rows=&quot;5&quot; id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; name=&quot;edd_settings[' . esc_attr( $args['id'] ) . ']&quot;&gt;' . esc_textarea( stripslashes( $value ) ) . '&lt;/textarea&gt;';&nbsp;</div></li><li><div>  $html .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;&gt; '  . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Password Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders password fields.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.3</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_password_callback( $args ) {&nbsp;</div></li><li><div>  $edd_options = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $edd_options ) {&nbsp;</div></li><li><div>      $value = $edd_options;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $value = isset( $args['std'] ) ? $args['std'] : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $size = ( isset( $args['size'] ) && ! is_null( $args['size'] ) ) ? $args['size'] : 'regular';&nbsp;</div></li><li><div>  $html = '&lt;input type=&quot;password&quot; class=&quot;' . $class . ' ' . sanitize_html_class( $size ) . '-text&quot; id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; name=&quot;edd_settings[' . esc_attr( $args['id'] ) . ']&quot; value=&quot;' . esc_attr( $value ) . '&quot;/&gt;';&nbsp;</div></li><li><div>  $html .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Missing Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * If a function is missing for settings callbacks alert the user.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.3.1</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_missing_callback($args) {&nbsp;</div></li><li><div>  printf(&nbsp;</div></li><li><div>      __( 'The callback function used for the %s setting is missing.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>      '&lt;strong&gt;' . $args['id'] . '&lt;/strong&gt;'&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Select Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders select fields.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_select_callback($args) {&nbsp;</div></li><li><div>  $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $edd_option ) {&nbsp;</div></li><li><div>      $value = $edd_option;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $value = isset( $args['std'] ) ? $args['std'] : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $args['placeholder'] ) ) {&nbsp;</div></li><li><div>      $placeholder = $args['placeholder'];&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $placeholder = '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $args['chosen'] ) ) {&nbsp;</div></li><li><div>      $class .= ' edd-chosen';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html = '&lt;select id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; name=&quot;edd_settings[' . esc_attr( $args['id'] ) . ']&quot; class=&quot;' . $class . '&quot; data-placeholder=&quot;' . esc_html( $placeholder ) . '&quot; /&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( $args['options'] as $option =&gt; $name ) {&nbsp;</div></li><li><div>      $selected = selected( $option, $value, false );&nbsp;</div></li><li><div>      $html .= '&lt;option value=&quot;' . esc_attr( $option ) . '&quot; ' . $selected . '&gt;' . esc_html( $name ) . '&lt;/option&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html .= '&lt;/select&gt;';&nbsp;</div></li><li><div>  $html .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Color select Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders color select fields.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.8</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_color_select_callback( $args ) {&nbsp;</div></li><li><div>  $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $edd_option ) {&nbsp;</div></li><li><div>      $value = $edd_option;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $value = isset( $args['std'] ) ? $args['std'] : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html = '&lt;select id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; class=&quot;' . $class . '&quot; name=&quot;edd_settings[' . esc_attr( $args['id'] ) . ']&quot;/&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( $args['options'] as $option =&gt; $color ) {&nbsp;</div></li><li><div>      $selected = selected( $option, $value, false );&nbsp;</div></li><li><div>      $html .= '&lt;option value=&quot;' . esc_attr( $option ) . '&quot; ' . $selected . '&gt;' . esc_html( $color['label'] ) . '&lt;/option&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html .= '&lt;/select&gt;';&nbsp;</div></li><li><div>  $html .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;&gt; '  . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Rich Editor Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders rich editor fields.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_rich_editor_callback( $args ) {&nbsp;</div></li><li><div>  $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $edd_option ) {&nbsp;</div></li><li><div>      $value = $edd_option;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      if( ! empty( $args['allow_blank'] ) && empty( $edd_option ) ) {&nbsp;</div></li><li><div>          $value = '';&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $value = isset( $args['std'] ) ? $args['std'] : '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $rows = isset( $args['size'] ) ? $args['size'] : 20;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  ob_start();&nbsp;</div></li><li><div>  wp_editor( stripslashes( $value ), 'edd_settings_' . esc_attr( $args['id'] ), array( 'textarea_name' =&gt; 'edd_settings[' . esc_attr( $args['id'] ) . ']', 'textarea_rows' =&gt; absint( $rows ), 'editor_class' =&gt; $class ) );&nbsp;</div></li><li><div>  $html = ob_get_clean();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html .= '&lt;br/&gt;&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Upload Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders upload fields.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_upload_callback( $args ) {&nbsp;</div></li><li><div>  $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $edd_option ) {&nbsp;</div></li><li><div>      $value = $edd_option;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $value = isset($args['std']) ? $args['std'] : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $size = ( isset( $args['size'] ) && ! is_null( $args['size'] ) ) ? $args['size'] : 'regular';&nbsp;</div></li><li><div>  $html = '&lt;input type=&quot;text&quot; class=&quot;' . sanitize_html_class( $size ) . '-text&quot; id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; clas=&quot;' . $class . '&quot; name=&quot;edd_settings[' . esc_attr( $args['id'] ) . ']&quot; value=&quot;' . esc_attr( stripslashes( $value ) ) . '&quot;/&gt;';&nbsp;</div></li><li><div>  $html .= '&lt;span&gt;&nbsp;&lt;input type=&quot;button&quot; class=&quot;edd_settings_upload_button button-secondary&quot; value=&quot;' . __( 'Upload File', 'easy-digital-downloads' ) . '&quot;/&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>  $html .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;&gt; ' . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Color picker Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders color picker fields.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.6</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_color_callback( $args ) {&nbsp;</div></li><li><div>  $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $edd_option ) {&nbsp;</div></li><li><div>      $value = $edd_option;&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $value = isset( $args['std'] ) ? $args['std'] : '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $default = isset( $args['std'] ) ? $args['std'] : '';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html = '&lt;input type=&quot;text&quot; class=&quot;' . $class . ' edd-color-picker&quot; id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; name=&quot;edd_settings[' . esc_attr( $args['id'] ) . ']&quot; value=&quot;' . esc_attr( $value ) . '&quot; data-default-color=&quot;' . esc_attr( $default ) . '&quot; /&gt;';&nbsp;</div></li><li><div>  $html .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;&gt; '  . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Shop States Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders states drop down based on the currently selected country</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.6</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_shop_states_callback($args) {&nbsp;</div></li><li><div>  $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( isset( $args['placeholder'] ) ) {&nbsp;</div></li><li><div>      $placeholder = $args['placeholder'];&nbsp;</div></li><li><div>  } else {&nbsp;</div></li><li><div>      $placeholder = '';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $states = edd_get_shop_states();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( $args['chosen'] ) {&nbsp;</div></li><li><div>      $class .= ' edd-chosen';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( empty( $states ) ) {&nbsp;</div></li><li><div>      $class .= ' edd-no-states';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html = '&lt;select id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; name=&quot;edd_settings[' . esc_attr( $args['id'] ) . ']&quot;' . $class . 'data-placeholder=&quot;' . esc_html( $placeholder ) . '&quot;/&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  foreach ( $states as $option =&gt; $name ) {&nbsp;</div></li><li><div>      $selected = isset( $edd_option ) ? selected( $option, $edd_option, false ) : '';&nbsp;</div></li><li><div>      $html .= '&lt;option value=&quot;' . esc_attr( $option ) . '&quot; ' . $selected . '&gt;' . esc_html( $name ) . '&lt;/option&gt;';&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $html .= '&lt;/select&gt;';&nbsp;</div></li><li><div>  $html .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;&gt; '  . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Tax Rates Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders tax rates table</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.6</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_tax_rates_callback($args) {&nbsp;</div></li><li><div>  $rates = edd_get_tax_rates();&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  $class = edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  ob_start(); ?&gt;&nbsp;</div></li><li><div>  &lt;p&gt;&lt;?php echo $args['desc']; ?&gt;&lt;/p&gt;&nbsp;</div></li><li><div>  &lt;table id=&quot;edd_tax_rates&quot; class=&quot;wp-list-table widefat fixed posts &lt;?php echo $class; ?&gt;&quot;&gt;&nbsp;</div></li><li><div>      &lt;thead&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;col&quot; class=&quot;edd_tax_country&quot;&gt;&lt;?php _e( 'Country', 'easy-digital-downloads' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;col&quot; class=&quot;edd_tax_state&quot;&gt;&lt;?php _e( 'State / Province', 'easy-digital-downloads' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;col&quot; class=&quot;edd_tax_global&quot;&gt;&lt;?php _e( 'Country Wide', 'easy-digital-downloads' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;col&quot; class=&quot;edd_tax_rate&quot;&gt;&lt;?php _e( 'Rate', 'easy-digital-downloads' ); ?&gt;&lt;span alt=&quot;f223&quot; class=&quot;edd-help-tip dashicons dashicons-editor-help&quot; title=&quot;&lt;?php _e( '&lt;strong&gt;Regional tax rates: &lt;/strong&gt;When a customer enters an address on checkout that matches the specified region for this tax rate, the cart tax will adjust automatically. Enter a percentage, such as 6.5 for 6.5%.' ); ?&gt;&quot;&gt;&lt;/span&gt;&lt;/th&gt;&nbsp;</div></li><li><div>              &lt;th scope=&quot;col&quot;&gt;&lt;?php _e( 'Remove', 'easy-digital-downloads' ); ?&gt;&lt;/th&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>      &lt;/thead&gt;&nbsp;</div></li><li><div>      &lt;?php if( ! empty( $rates ) ) : ?&gt;&nbsp;</div></li><li><div>          &lt;?php foreach( $rates as $key =&gt; $rate ) : ?&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;edd_tax_country&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php&nbsp;</div></li><li><div>                  echo EDD()-&gt;html-&gt;select( array(&nbsp;</div></li><li><div>                      'options' =&gt; edd_get_country_list(), &nbsp;</div></li><li><div>                      'name' =&gt; 'tax_rates[' . edd_sanitize_key( $key ) . '][country]', &nbsp;</div></li><li><div>                      'selected' =&gt; $rate['country'], &nbsp;</div></li><li><div>                      'show_option_all' =&gt; false, &nbsp;</div></li><li><div>                      'show_option_none' =&gt; false, &nbsp;</div></li><li><div>                      'class' =&gt; 'edd-tax-country', &nbsp;</div></li><li><div>                      'chosen' =&gt; false, &nbsp;</div></li><li><div>                      'placeholder' =&gt; __( 'Choose a country', 'easy-digital-downloads' )&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;edd_tax_state&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php&nbsp;</div></li><li><div>                  $states = edd_get_shop_states( $rate['country'] );&nbsp;</div></li><li><div>                  if( ! empty( $states ) ) {&nbsp;</div></li><li><div>                      echo EDD()-&gt;html-&gt;select( array(&nbsp;</div></li><li><div>                          'options' =&gt; $states, &nbsp;</div></li><li><div>                          'name' =&gt; 'tax_rates[' . edd_sanitize_key( $key ) . '][state]', &nbsp;</div></li><li><div>                          'selected' =&gt; $rate['state'], &nbsp;</div></li><li><div>                          'show_option_all' =&gt; false, &nbsp;</div></li><li><div>                          'show_option_none' =&gt; false, &nbsp;</div></li><li><div>                          'chosen' =&gt; false, &nbsp;</div></li><li><div>                          'placeholder' =&gt; __( 'Choose a state', 'easy-digital-downloads' )&nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>                  } else {&nbsp;</div></li><li><div>                      echo EDD()-&gt;html-&gt;text( array(&nbsp;</div></li><li><div>                          'name' =&gt; 'tax_rates[' . edd_sanitize_key( $key ) . '][state]', $rate['state'], &nbsp;</div></li><li><div>                          'value' =&gt; ! empty( $rate['state'] ) ? $rate['state'] : '', &nbsp;</div></li><li><div> ) );&nbsp;</div></li><li><div>                  }&nbsp;</div></li><li><div>                  ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;edd_tax_global&quot;&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;checkbox&quot; name=&quot;tax_rates[&lt;?php echo edd_sanitize_key( $key ); ?&gt;][global]&quot; id=&quot;tax_rates[&lt;?php echo edd_sanitize_key( $key ); ?&gt;][global]&quot; value=&quot;1&quot;&lt;?php checked( true, ! empty( $rate['global'] ) ); ?&gt;/&gt;&nbsp;</div></li><li><div>                  &lt;label for=&quot;tax_rates[&lt;?php echo edd_sanitize_key( $key ); ?&gt;][global]&quot;&gt;&lt;?php _e( 'Apply to whole country', 'easy-digital-downloads' ); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;edd_tax_rate&quot;&gt;&lt;input type=&quot;number&quot; class=&quot;small-text&quot; step=&quot;0.0001&quot; min=&quot;0.0&quot; max=&quot;99&quot; name=&quot;tax_rates[&lt;?php echo edd_sanitize_key( $key ); ?&gt;][rate]&quot; value=&quot;&lt;?php echo esc_html( $rate['rate'] ); ?&gt;&quot;/&gt;&lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&lt;span class=&quot;edd_remove_tax_rate button-secondary&quot;&gt;&lt;?php _e( 'Remove Rate', 'easy-digital-downloads' ); ?&gt;&lt;/span&gt;&lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>          &lt;?php endforeach; ?&gt;&nbsp;</div></li><li><div>      &lt;?php else : ?&gt;&nbsp;</div></li><li><div>          &lt;tr&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;edd_tax_country&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php&nbsp;</div></li><li><div>                  echo EDD()-&gt;html-&gt;select( array(&nbsp;</div></li><li><div>                      'options' =&gt; edd_get_country_list(), &nbsp;</div></li><li><div>                      'name' =&gt; 'tax_rates[0][country]', &nbsp;</div></li><li><div>                      'selected' =&gt; '', &nbsp;</div></li><li><div>                      'show_option_all' =&gt; false, &nbsp;</div></li><li><div>                      'show_option_none' =&gt; false, &nbsp;</div></li><li><div>                      'class' =&gt; 'edd-tax-country', &nbsp;</div></li><li><div>                      'chosen' =&gt; false, &nbsp;</div></li><li><div>                      'placeholder' =&gt; __( 'Choose a country', 'easy-digital-downloads' )&nbsp;</div></li><li><div> ) ); ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;edd_tax_state&quot;&gt;&nbsp;</div></li><li><div>                  &lt;?php echo EDD()-&gt;html-&gt;text( array(&nbsp;</div></li><li><div>                      'name' =&gt; 'tax_rates[0][state]'&nbsp;</div></li><li><div> ) ); ?&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;edd_tax_global&quot;&gt;&nbsp;</div></li><li><div>                  &lt;input type=&quot;checkbox&quot; name=&quot;tax_rates[0][global]&quot; value=&quot;1&quot;/&gt;&nbsp;</div></li><li><div>                  &lt;label for=&quot;tax_rates[0][global]&quot;&gt;&lt;?php _e( 'Apply to whole country', 'easy-digital-downloads' ); ?&gt;&lt;/label&gt;&nbsp;</div></li><li><div>              &lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td class=&quot;edd_tax_rate&quot;&gt;&lt;input type=&quot;number&quot; class=&quot;small-text&quot; step=&quot;0.0001&quot; min=&quot;0.0&quot; name=&quot;tax_rates[0][rate]&quot; value=&quot;&quot;/&gt;&lt;/td&gt;&nbsp;</div></li><li><div>              &lt;td&gt;&lt;span class=&quot;edd_remove_tax_rate button-secondary&quot;&gt;&lt;?php _e( 'Remove Rate', 'easy-digital-downloads' ); ?&gt;&lt;/span&gt;&lt;/td&gt;&nbsp;</div></li><li><div>          &lt;/tr&gt;&nbsp;</div></li><li><div>      &lt;?php endif; ?&gt;&nbsp;</div></li><li><div>  &lt;/table&gt;&nbsp;</div></li><li><div>  &lt;p&gt;&nbsp;</div></li><li><div>      &lt;span class=&quot;button-secondary&quot; id=&quot;edd_add_tax_rate&quot;&gt;&lt;?php _e( 'Add Tax Rate', 'easy-digital-downloads' ); ?&gt;&lt;/span&gt;&nbsp;</div></li><li><div>  &lt;/p&gt;&nbsp;</div></li><li><div>  &lt;?php&nbsp;</div></li><li><div>  echo ob_get_clean();&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Descriptive text callback.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Renders descriptive text onto the settings field.</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 2.1.3</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_descriptive_text_callback( $args ) {&nbsp;</div></li><li><div>  $html = wp_kses_post( $args['desc'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  echo apply_filters( 'edd_after_setting_output', $html, $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Registers the license field callback for Software Licensing</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.5</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>if ( ! function_exists( 'edd_license_key_callback' ) ) {&nbsp;</div></li><li><div>  function edd_license_key_callback( $args ) {&nbsp;</div></li><li><div>      $edd_option = edd_get_option( $args['id'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $messages = array();&nbsp;</div></li><li><div>      $license = get_option( $args['options']['is_valid_license_option'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( $edd_option ) {&nbsp;</div></li><li><div>          $value = $edd_option;&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $value = isset( $args['std'] ) ? $args['std'] : '';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if( ! empty( $license ) && is_object( $license ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          <span class="comment">// activate_license 'invalid' on anything other than valid, so if there was an error capture it</span>&nbsp;</div></li><li><div>          if ( false === $license-&gt;success ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              switch( $license-&gt;error ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  case 'expired' :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $class = 'expired';&nbsp;</div></li><li><div>                      $messages[] = sprintf(&nbsp;</div></li><li><div>                          __( 'Your license key expired on %s. Please &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;renew your license key&lt;/a&gt;.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                          date_i18n( get_option( 'date_format' ), strtotime( $license-&gt;expires, current_time( 'timestamp' ) ) ), &nbsp;</div></li><li><div>                          'https:<span class="comment">//easydigitaldownloads.com/checkout/?edd_license_key=' . $value . '&utm_campaign=admin&utm_source=licenses&utm_medium=expired'</span>&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $license_status = 'license-' . $class . '-notice';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  case 'revoked' :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $class = 'error';&nbsp;</div></li><li><div>                      $messages[] = sprintf(&nbsp;</div></li><li><div>                          __( 'Your license key has been disabled. Please &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;contact support&lt;/a&gt; for more information.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                          'https:<span class="comment">//easydigitaldownloads.com/support?utm_campaign=admin&utm_source=licenses&utm_medium=revoked'</span>&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $license_status = 'license-' . $class . '-notice';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  case 'missing' :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $class = 'error';&nbsp;</div></li><li><div>                      $messages[] = sprintf(&nbsp;</div></li><li><div>                          __( 'Invalid license. Please &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;visit your account page&lt;/a&gt; and verify it.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                          'https:<span class="comment">//easydigitaldownloads.com/your-account?utm_campaign=admin&utm_source=licenses&utm_medium=missing'</span>&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $license_status = 'license-' . $class . '-notice';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  case 'invalid' :&nbsp;</div></li><li><div>                  case 'site_inactive' :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $class = 'error';&nbsp;</div></li><li><div>                      $messages[] = sprintf(&nbsp;</div></li><li><div>                          __( 'Your %s is not active for this URL. Please &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;visit your account page&lt;/a&gt; to manage your license key URLs.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                          $args['name'], &nbsp;</div></li><li><div>                          'https:<span class="comment">//easydigitaldownloads.com/your-account?utm_campaign=admin&utm_source=licenses&utm_medium=invalid'</span>&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $license_status = 'license-' . $class . '-notice';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  case 'item_name_mismatch' :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $class = 'error';&nbsp;</div></li><li><div>                      $messages[] = sprintf( __( 'This appears to be an invalid license key for %s.', 'easy-digital-downloads' ), $args['name'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $license_status = 'license-' . $class . '-notice';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  case 'no_activations_left':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $class = 'error';&nbsp;</div></li><li><div>                      $messages[] = sprintf( __( 'Your license key has reached its activation limit. &lt;a href=&quot;%s&quot;&gt;View possible upgrades&lt;/a&gt; now.', 'easy-digital-downloads' ), 'https:<span class="comment">//easydigitaldownloads.com/your-account/' );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $license_status = 'license-' . $class . '-notice';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  case 'license_not_activable':&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $class = 'error';&nbsp;</div></li><li><div>                      $messages[] = __( 'The key you entered belongs to a bundle, please use the product specific license key.', 'easy-digital-downloads' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $license_status = 'license-' . $class . '-notice';&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  default :&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $class = 'error';&nbsp;</div></li><li><div>                      $error = ! empty(  $license-&gt;error ) ?  $license-&gt;error : __( 'unknown_error', 'easy-digital-downloads' );&nbsp;</div></li><li><div>                      $messages[] = sprintf( __( 'There was an error with this license key: %s. Please &lt;a href=&quot;%s&quot;&gt;contact our support team&lt;/a&gt;.', 'easy-digital-downloads' ), $error, 'https:<span class="comment">//easydigitaldownloads.com/support' );</span>&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $license_status = 'license-' . $class . '-notice';&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              switch( $license-&gt;license ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                  case 'valid' :&nbsp;</div></li><li><div>                  default:&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $class = 'valid';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      $now = current_time( 'timestamp' );&nbsp;</div></li><li><div>                      $expiration = strtotime( $license-&gt;expires, current_time( 'timestamp' ) );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      if( 'lifetime' === $license-&gt;expires ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $messages[] = __( 'License key never expires.', 'easy-digital-downloads' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $license_status = 'license-lifetime-notice';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      } elseif( $expiration &gt; $now && $expiration - $now &lt; ( DAY_IN_SECONDS * 30 ) ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $messages[] = sprintf(&nbsp;</div></li><li><div>                              __( 'Your license key expires soon! It expires on %s. &lt;a href=&quot;%s&quot; target=&quot;_blank&quot;&gt;Renew your license key&lt;/a&gt;.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                              date_i18n( get_option( 'date_format' ), strtotime( $license-&gt;expires, current_time( 'timestamp' ) ) ), &nbsp;</div></li><li><div>                              'https:<span class="comment">//easydigitaldownloads.com/checkout/?edd_license_key=' . $value . '&utm_campaign=admin&utm_source=licenses&utm_medium=renew'</span>&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $license_status = 'license-expires-soon-notice';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      } else {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $messages[] = sprintf(&nbsp;</div></li><li><div>                              __( 'Your license key expires on %s.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>                              date_i18n( get_option( 'date_format' ), strtotime( $license-&gt;expires, current_time( 'timestamp' ) ) )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                          $license_status = 'license-expiration-date-notice';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>                      break;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      } else {&nbsp;</div></li><li><div>          $class = 'empty';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $messages[] = sprintf(&nbsp;</div></li><li><div>              __( 'To receive updates, please enter your valid %s license key.', 'easy-digital-downloads' ), &nbsp;</div></li><li><div>              $args['name']&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          $license_status = null;&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $class .= ' ' . edd_sanitize_html_class( $args['field_class'] );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $size = ( isset( $args['size'] ) && ! is_null( $args['size'] ) ) ? $args['size'] : 'regular';&nbsp;</div></li><li><div>      $html = '&lt;input type=&quot;text&quot; class=&quot;' . sanitize_html_class( $size ) . '-text&quot; id=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; name=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot; value=&quot;' . esc_attr( $value ) . '&quot;/&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ( is_object( $license ) && 'valid' == $license-&gt;license ) || 'valid' == $license ) {&nbsp;</div></li><li><div>          $html .= '&lt;input type=&quot;submit&quot; class=&quot;button-secondary&quot; name=&quot;' . $args['id'] . '_deactivate&quot; value=&quot;' . __( 'Deactivate License', 'easy-digital-downloads' ) . '&quot;/&gt;';&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      $html .= '&lt;label for=&quot;edd_settings[' . edd_sanitize_key( $args['id'] ) . ']&quot;&gt; '  . wp_kses_post( $args['desc'] ) . '&lt;/label&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      if ( ! empty( $messages ) ) {&nbsp;</div></li><li><div>          foreach( $messages as $message ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>              $html .= '&lt;div class=&quot;edd-license-data edd-license-' . $class . ' ' . $license_status . '&quot;&gt;';&nbsp;</div></li><li><div>                  $html .= '&lt;p&gt;' . $message . '&lt;/p&gt;';&nbsp;</div></li><li><div>              $html .= '&lt;/div&gt;';&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>          }&nbsp;</div></li><li><div>      }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      wp_nonce_field( edd_sanitize_key( $args['id'] ) . '-nonce', edd_sanitize_key( $args['id'] ) . '-nonce' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>      echo $html;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Hook Callback</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * Adds a do_action() hook in place of the field</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.0.8.2</span>&nbsp;</div></li><li><div><span class="comment"> * @param array $args Arguments passed by the setting</span>&nbsp;</div></li><li><div><span class="comment"> * @return void</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_hook_callback( $args ) {&nbsp;</div></li><li><div>  do_action( 'edd_' . $args['id'], $args );&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>&nbsp;</div></li><li><div><span class="comment">/**</span>&nbsp;</div></li><li><div><span class="comment"> * Set manage_shop_settings as the cap required to save EDD settings pages</span>&nbsp;</div></li><li><div><span class="comment"> *</span>&nbsp;</div></li><li><div><span class="comment"> * @since 1.9</span>&nbsp;</div></li><li><div><span class="comment"> * @return string capability required</span>&nbsp;</div></li><li><div><span class="comment"> */</span>&nbsp;</div></li><li><div>function edd_set_settings_cap() {&nbsp;</div></li><li><div>  return 'manage_shop_settings';&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_filter( 'option_page_capability_edd_settings', 'edd_set_settings_cap' );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>function edd_add_setting_tooltip( $html, $args ) {&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  if ( ! empty( $args['tooltip_title'] ) && ! empty( $args['tooltip_desc'] ) ) {&nbsp;</div></li><li><div>      $tooltip = '&lt;span alt=&quot;f223&quot; class=&quot;edd-help-tip dashicons dashicons-editor-help&quot; title=&quot;&lt;strong&gt;' . $args['tooltip_title'] . '&lt;/strong&gt;: ' . $args['tooltip_desc'] . '&quot;&gt;&lt;/span&gt;';&nbsp;</div></li><li><div>      $html .= $tooltip;&nbsp;</div></li><li><div>  }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>  return $html;&nbsp;</div></li><li><div>}&nbsp;</div></li><li><div>add_filter( 'edd_after_setting_output', 'edd_add_setting_tooltip', 10, 2 );&nbsp;</div></li></ol></pre>.</p> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>file</li><li><span></span></li><li><span></span>Easy Digital Downloads</li><li><span></span>2.7.8</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2017 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer> <script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>