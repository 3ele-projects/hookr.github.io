<!DOCTYPE html> <!--[if lt IE 7]><html class="hookr class lt-ie9 lt-ie8 lt-ie7 ie"><![endif]--> <!--[if IE 7]><html class="hookr class lt-ie9 lt-ie8 ie7 ie"><![endif]--> <!--[if IE 8]><html class="hookr class lt-ie9 ie8 ie"><![endif]--> <!--[if IE 9]><html class="hookr class ie9 ie"><![endif]--> <!--[if gt IE 9]><html class="hookr class gt-ie9 ie"><![endif]--><html lang="en-US" id="single" class="hookr class" data-site="plugin" data-version="2.7.8" data-slug="easy-digital-downloads" data-type="class" data-id="58028"><head xmlns="http://www.w3.org/1999/xhtml"><title> fpdf | class | Easy Digital Downloads | hookr.io</title><meta charset="UTF-8"><meta name="author" content="thepassionofthechris \m/," /><meta name="keywords" content="FPDF, class, plugin, easy-digital-downloads, 2.7.8" /><meta name="description" content="The Easy Digital Downloads FPDF class." /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><link rel="shortcut icon" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.ico" /><link rel="icon" type="image/png" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.png"><link rel="icon" type="image/gif" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.gif"><link rel="icon" type="image/jpeg" href="http://hookr.io/wp-content/themes/hookr/assets/images/favicon.jpg"><meta name="google-site-verification" content="Q5dnl0YziNqRLCBxFtc2Rd8vUuueYAt6VIUYZItvEL4" /><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/hookr.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.16"}};!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel='stylesheet' id='screen-css'  href='http://hookr.io/wp-content/themes/hookr/assets/css/hookr.css?ver=d81c418bf1e0c4f60d73c419110e46c1' type='text/css' media='screen' /><link rel='stylesheet' id='qtip-css'  href='http://hookr.io/wp-content/themes/hookr/assets/vendor/jquery.qtip.custom/jquery.qtip.min.css?ver=4.4.16' type='text/css' media='screen' /><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fU9dGoIwDLsQW_XbHbyAXmCMAsNBsS2otxcYvqFP_UmaJg66x4T8LtzemD427BVtH4fiBC3RncGLoAp0AqWYRDS2lA4ZMw4VMZREKsp-NM46e14PlShpHJc_UwSsawz6R6CbURX38oNzDUwp3egSX1iZ3osif0PIhinVK3YQI9NsWNYRs6dAnCNt0zNWDW4OPw.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdTPzS8tTtXLzcwDAA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/fZBBDsIwDAQ_RG1Kn8AvuKWJUQ1JHBIXVF5PKOoFKZV8Gc_KK3nAmVHNWCBwPAxfKp4d5ZWPOIncM5pSSAve6jxmygskbyxN4mvwP_Sk6KRSSJ6vS9dDD6eNGkdXbu3hV9nUs7JvSpNqrzXK0uwFKyFJpKg7V3jPwZPp1XjDm7JYz2kUk10XTFHK6LgoXqo5b-YD.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9DPyM_PLtJPLC5OLSnWL0vNS8kv0s8qLE0tqtQrLMks0EsuLS7Jz0URys3MAwA.js"></script><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9YvzdRPTUtLTS7RzchMz8gB4hK93Mw8HQP9jPz87CL9xOLi1JJi_axiCF8vsSBTrzgzLz0nFQA.js"></script><link rel='https://api.w.org/' href='http://hookr.io/wp-json/' /><link rel="canonical" href="http://hookr.io/classes/fpdf/" /><link rel="alternate" type="application/json+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Ffpdf%2F" /><link rel="alternate" type="text/xml+oembed" href="http://hookr.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhookr.io%2Fclasses%2Ffpdf%2F&#038;format=xml" /><script>/*<![CDATA[*/if('undefined'===typeof Hookr)
var Hookr={};if('undefined'===typeof Hookr.Util)
Hookr.Util={};Hookr.Util=jQuery&&jQuery.extend(Hookr.Util,{"adminAjax":"http:\/\/hookr.io\/wp-admin\/admin-ajax.php","themeUrl":"http:\/\/hookr.io\/wp-content\/themes\/hookr\/","apiKey":"plugin-easy-digital-downloads-2.7.8-class-fpdf","actions":{"popover":0,"range":1,"search":2,"stat":3}});/*]]>*/</script><!--[if lt IE 9]><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv.js"></script><script src="http://hookr.io/wp-content/themes/hookr/assets/js/html5shiv-printshiv.js"></script><![endif]--></head><body id="fpdf" class="single single-class single-format-standard"><div id="gutter"><div><ul id="nav-breadcrumb" role="navigation" class="pivot clear fix"><li class="home"><a title="Go to hookr.io." href="http://hookr.io" class="home">hookr.io</a></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to plugins." href="http://hookr.io/plugins/" class=""><span property="name">plugins</span></a><meta property="position" content="2"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to easy-digital-downloads." href="http://hookr.io/plugins/easy-digital-downloads/" class="plugin"><span property="name">easy-digital-downloads</span></a><meta property="position" content="3"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to 2.7.8." href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/" class="H_VERSION"><span property="name">2.7.8</span></a><meta property="position" content="4"></span></li><li>/</li><li><span property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" title="Go to classes." href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/classes/" class=""><span property="name">classes</span></a><meta property="position" content="5"></span></li><li>/</li><li class="current_item"><span property="itemListElement" typeof="ListItem"><span property="name">fpdf</span><meta property="position" content="6"></span></li></ul></div></div><header class="jv-fixed"><div> <button class="btn" data-jv-trigger="left"><span></span></button><h1 title="hookr.io"><a href="http://hookr.io" title="hookr.io"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/hookr.svg" title="The WordPress Hook/API Index" alt="The WordPress Hook/API Index"/></a></h1> <nav id="nav-api-types" class="pivot clearfix" data-jv-order="0" data-jv-content="left" data-active="class"><ul role="navigation"><li class="" data-id="all" data-count="2274"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/all/" title="All">All <span class="count badge">2274</span></a></li><li class="" data-id="new" data-count="5"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/new/" title="New">New <span class="count badge">5</span></a></li><li class="" data-id="hooks" data-count="1195"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/hooks/" title="Hooks">Hooks <span class="count badge">1195</span></a></li><li class="" data-id="action" data-count="469"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/actions/" title="Actions">Actions <span class="count badge">469</span></a></li><li class="" data-id="filter" data-count="726"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/filters/" title="Filters">Filters <span class="count badge">726</span></a></li><li class="active" data-id="class" data-count="99"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/classes/" title="Classes">Classes <span class="count badge">99</span></a></li><li class="" data-id="constant" data-count="11"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/constants/" title="Constants">Constants <span class="count badge">11</span></a></li><li class="" data-id="function" data-count="955"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/functions/" title="Functions">Functions <span class="count badge">955</span></a></li><li class="" data-id="shortcode" data-count="14"><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/shortcodes/" title="Shortcodes">Shortcodes <span class="count badge">14</span></a></li></ul> </nav> <nav id="nav-main" class="pivot" data-jv-order="1" data-jv-content="left"><ul role="navigation"><li class=""><a href="http://hookr.io/all/" title="Core">Core</a></li><li class="active"><a href="http://hookr.io/plugins/" title="Plugins">Plugins</a></li><li class=""><a href="http://hookr.io/themes/" title="Themes">Themes</a></li><li class=""><a href="http://hookr.io/features/" title="Features">Features</a></li><li class=""><a href="http://hookr.io/plugin/" title="Plugin">Plugin</a></li><li class=""><a href="http://hookr.io/about/" title="About">About</a></li><li class=""><a href="http://hookr.io/contact/" title="Contact">Contact</a></li></ul> </nav></div> </header><div role="main" id="middle"><div><div id="mainbar"> <article><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=hookrio" id="_carbonads_js"></script><noscript>derpy.</noscript> <section><h1><strong>FPDF</strong></h1><p>The Easy Digital Downloads <strong>FPDF</strong> class.</p> </section> <section id="defined" class="source"><h2>Defined <span class="count">(1)</span></h2><p>The class is defined in the following location(s).</p><dl><dt><strong><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/files/includes-libraries-fpdf-fpdf/" class="file">/includes/libraries/fpdf/fpdf.php <span>&nbsp;</span></a></strong></dt><dd><pre><ol data-line="15" class="block" start="15"><li><div>class FPDF {&nbsp;</div></li><li><div>    var $page;&nbsp;</div></li><li><div>    var $n;&nbsp;</div></li><li><div>    var $offsets;&nbsp;</div></li><li><div>    var $buffer;&nbsp;</div></li><li><div>    var $pages;&nbsp;</div></li><li><div>    var $state;&nbsp;</div></li><li><div>    var $compress;&nbsp;</div></li><li><div>    var $k;&nbsp;</div></li><li><div>    var $DefOrientation;&nbsp;</div></li><li><div>    var $CurOrientation;&nbsp;</div></li><li><div>    var $StdPageSizes;&nbsp;</div></li><li><div>    var $DefPageSize;&nbsp;</div></li><li><div>    var $CurPageSize;&nbsp;</div></li><li><div>    var $PageSizes;&nbsp;</div></li><li><div>    var $wPt, $hPt;&nbsp;</div></li><li><div>    var $w, $h;&nbsp;</div></li><li><div>    var $lMargin;&nbsp;</div></li><li><div>    var $tMargin;&nbsp;</div></li><li><div>    var $rMargin;&nbsp;</div></li><li><div>    var $bMargin;&nbsp;</div></li><li><div>    var $cMargin;&nbsp;</div></li><li><div>    var $x, $y;&nbsp;</div></li><li><div>    var $lasth;&nbsp;</div></li><li><div>    var $LineWidth;&nbsp;</div></li><li><div>    var $fontpath;&nbsp;</div></li><li><div>    var $CoreFonts;&nbsp;</div></li><li><div>    var $fonts;&nbsp;</div></li><li><div>    var $FontFiles;&nbsp;</div></li><li><div>    var $diffs;&nbsp;</div></li><li><div>    var $FontFamily;&nbsp;</div></li><li><div>    var $FontStyle;&nbsp;</div></li><li><div>    var $underline;&nbsp;</div></li><li><div>    var $CurrentFont;&nbsp;</div></li><li><div>    var $FontSizePt;&nbsp;</div></li><li><div>    var $FontSize;&nbsp;</div></li><li><div>    var $DrawColor;&nbsp;</div></li><li><div>    var $FillColor;&nbsp;</div></li><li><div>    var $TextColor;&nbsp;</div></li><li><div>    var $ColorFlag;&nbsp;</div></li><li><div>    var $ws;&nbsp;</div></li><li><div>    var $images;&nbsp;</div></li><li><div>    var $PageLinks;&nbsp;</div></li><li><div>    var $links;&nbsp;</div></li><li><div>    var $AutoPageBreak;&nbsp;</div></li><li><div>    var $PageBreakTrigger;&nbsp;</div></li><li><div>    var $InHeader;&nbsp;</div></li><li><div>    var $InFooter;&nbsp;</div></li><li><div>    var $ZoomMode;&nbsp;</div></li><li><div>    var $LayoutMode;&nbsp;</div></li><li><div>    var $title;&nbsp;</div></li><li><div>    var $subject;&nbsp;</div></li><li><div>    var $author;&nbsp;</div></li><li><div>    var $keywords;&nbsp;</div></li><li><div>    var $creator;&nbsp;</div></li><li><div>    var $AliasNbPages;&nbsp;</div></li><li><div>    var $PDFVersion;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function FPDF( $orientation = 'P', $unit = 'mm', $size = 'A4' ) {&nbsp;</div></li><li><div>        $this-&gt;_dochecks();&nbsp;</div></li><li><div>        $this-&gt;page = 0;&nbsp;</div></li><li><div>        $this-&gt;n = 2;&nbsp;</div></li><li><div>        $this-&gt;buffer = '';&nbsp;</div></li><li><div>        $this-&gt;pages = array();&nbsp;</div></li><li><div>        $this-&gt;PageSizes = array();&nbsp;</div></li><li><div>        $this-&gt;state = 0;&nbsp;</div></li><li><div>        $this-&gt;fonts = array();&nbsp;</div></li><li><div>        $this-&gt;FontFiles = array();&nbsp;</div></li><li><div>        $this-&gt;diffs = array();&nbsp;</div></li><li><div>        $this-&gt;images = array();&nbsp;</div></li><li><div>        $this-&gt;links = array();&nbsp;</div></li><li><div>        $this-&gt;InHeader = false;&nbsp;</div></li><li><div>        $this-&gt;InFooter = false;&nbsp;</div></li><li><div>        $this-&gt;lasth = 0;&nbsp;</div></li><li><div>        $this-&gt;FontFamily = '';&nbsp;</div></li><li><div>        $this-&gt;FontStyle = '';&nbsp;</div></li><li><div>        $this-&gt;FontSizePt = 12;&nbsp;</div></li><li><div>        $this-&gt;underline = false;&nbsp;</div></li><li><div>        $this-&gt;DrawColor = '0 G';&nbsp;</div></li><li><div>        $this-&gt;FillColor = '0 g';&nbsp;</div></li><li><div>        $this-&gt;TextColor = '0 g';&nbsp;</div></li><li><div>        $this-&gt;ColorFlag = false;&nbsp;</div></li><li><div>        $this-&gt;ws = 0;&nbsp;</div></li><li><div>        if ( defined( 'FPDF_FONTPATH' ) ) {&nbsp;</div></li><li><div>            $this-&gt;fontpath = FPDF_FONTPATH;&nbsp;</div></li><li><div>            if ( substr( $this-&gt;fontpath, -1 ) != '/' && substr( $this-&gt;fontpath, -1 ) != '\\' )&nbsp;</div></li><li><div>                $this-&gt;fontpath .= '/';&nbsp;</div></li><li><div>        } elseif ( is_dir( dirname( __FILE__ ) . '/font' ) )&nbsp;</div></li><li><div>            $this-&gt;fontpath = dirname( __FILE__ ) . '/font/';&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $this-&gt;fontpath = '';&nbsp;</div></li><li><div>        $this-&gt;CoreFonts = array( 'helvetica' );&nbsp;</div></li><li><div>        if ( $unit == 'pt' )&nbsp;</div></li><li><div>            $this-&gt;k = 1;&nbsp;</div></li><li><div>        elseif ( $unit == 'mm' )&nbsp;</div></li><li><div>            $this-&gt;k = 72 / 25.4;&nbsp;</div></li><li><div>        elseif ( $unit == 'cm' )&nbsp;</div></li><li><div>            $this-&gt;k = 72 / 2.54;&nbsp;</div></li><li><div>        elseif ( $unit == 'in' )&nbsp;</div></li><li><div>            $this-&gt;k = 72;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $this-&gt;Error( 'Incorrect unit: ' . $unit );&nbsp;</div></li><li><div>        $this-&gt;StdPageSizes = array(&nbsp;</div></li><li><div>            'a3' =&gt; array(&nbsp;</div></li><li><div>                841.89, &nbsp;</div></li><li><div>                1190.55&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'a4' =&gt; array(&nbsp;</div></li><li><div>                595.28, &nbsp;</div></li><li><div>                841.89&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'a5' =&gt; array(&nbsp;</div></li><li><div>                420.94, &nbsp;</div></li><li><div>                595.28&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'letter' =&gt; array(&nbsp;</div></li><li><div>                612, &nbsp;</div></li><li><div>                792&nbsp;</div></li><li><div> ), &nbsp;</div></li><li><div>            'legal' =&gt; array(&nbsp;</div></li><li><div>                612, &nbsp;</div></li><li><div>                1008&nbsp;</div></li><li><div> )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        $size = $this-&gt;_getpagesize( $size );&nbsp;</div></li><li><div>        $this-&gt;DefPageSize = $size;&nbsp;</div></li><li><div>        $this-&gt;CurPageSize = $size;&nbsp;</div></li><li><div>        $orientation = strtolower( $orientation );&nbsp;</div></li><li><div>        if ( $orientation == 'p' || $orientation == 'portrait' ) {&nbsp;</div></li><li><div>            $this-&gt;DefOrientation = 'P';&nbsp;</div></li><li><div>            $this-&gt;w = $size[0];&nbsp;</div></li><li><div>            $this-&gt;h = $size[1];&nbsp;</div></li><li><div>        } elseif ( $orientation == 'l' || $orientation == 'landscape' ) {&nbsp;</div></li><li><div>            $this-&gt;DefOrientation = 'L';&nbsp;</div></li><li><div>            $this-&gt;w = $size[1];&nbsp;</div></li><li><div>            $this-&gt;h = $size[0];&nbsp;</div></li><li><div>        } else&nbsp;</div></li><li><div>            $this-&gt;Error( 'Incorrect orientation: ' . $orientation );&nbsp;</div></li><li><div>        $this-&gt;CurOrientation = $this-&gt;DefOrientation;&nbsp;</div></li><li><div>        $this-&gt;wPt = $this-&gt;w * $this-&gt;k;&nbsp;</div></li><li><div>        $this-&gt;hPt = $this-&gt;h * $this-&gt;k;&nbsp;</div></li><li><div>        $margin = 28.35 / $this-&gt;k;&nbsp;</div></li><li><div>        $this-&gt;SetMargins( $margin, $margin );&nbsp;</div></li><li><div>        $this-&gt;cMargin = $margin / 10;&nbsp;</div></li><li><div>        $this-&gt;LineWidth = .567 / $this-&gt;k;&nbsp;</div></li><li><div>        $this-&gt;SetAutoPageBreak( true, 2 * $margin );&nbsp;</div></li><li><div>        $this-&gt;SetDisplayMode( 'default' );&nbsp;</div></li><li><div>        $this-&gt;SetCompression( true );&nbsp;</div></li><li><div>        $this-&gt;PDFVersion = '1.3';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetMargins( $left, $top, $right = null ) {&nbsp;</div></li><li><div>        $this-&gt;lMargin = $left;&nbsp;</div></li><li><div>        $this-&gt;tMargin = $top;&nbsp;</div></li><li><div>        if ( $right === null )&nbsp;</div></li><li><div>            $right = $left;&nbsp;</div></li><li><div>        $this-&gt;rMargin = $right;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetLeftMargin( $margin ) {&nbsp;</div></li><li><div>        $this-&gt;lMargin = $margin;&nbsp;</div></li><li><div>        if ( $this-&gt;page &gt; 0 && $this-&gt;x &lt; $margin )&nbsp;</div></li><li><div>            $this-&gt;x = $margin;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetTopMargin( $margin ) {&nbsp;</div></li><li><div>        $this-&gt;tMargin = $margin;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetRightMargin( $margin ) {&nbsp;</div></li><li><div>        $this-&gt;rMargin = $margin;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetAutoPageBreak( $auto, $margin = 0 ) {&nbsp;</div></li><li><div>        $this-&gt;AutoPageBreak = $auto;&nbsp;</div></li><li><div>        $this-&gt;bMargin = $margin;&nbsp;</div></li><li><div>        $this-&gt;PageBreakTrigger = $this-&gt;h - $margin;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetDisplayMode( $zoom, $layout = 'default' ) {&nbsp;</div></li><li><div>        if ( $zoom == 'fullpage' || $zoom == 'fullwidth' || $zoom == 'real' || $zoom == 'default' || !is_string( $zoom ) )&nbsp;</div></li><li><div>            $this-&gt;ZoomMode = $zoom;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $this-&gt;Error( 'Incorrect zoom display mode: ' . $zoom );&nbsp;</div></li><li><div>        if ( $layout == 'single' || $layout == 'continuous' || $layout == 'two' || $layout == 'default' )&nbsp;</div></li><li><div>            $this-&gt;LayoutMode = $layout;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $this-&gt;Error( 'Incorrect layout display mode: ' . $layout );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetCompression( $compress ) {&nbsp;</div></li><li><div>        if ( function_exists( 'gzcompress' ) )&nbsp;</div></li><li><div>            $this-&gt;compress = $compress;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $this-&gt;compress = false;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetTitle( $title, $isUTF8 = false ) {&nbsp;</div></li><li><div>        if ( $isUTF8 )&nbsp;</div></li><li><div>            $title = $this-&gt;_UTF8toUTF16( $title );&nbsp;</div></li><li><div>        $this-&gt;title = $title;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetSubject( $subject, $isUTF8 = false ) {&nbsp;</div></li><li><div>        if ( $isUTF8 )&nbsp;</div></li><li><div>            $subject = $this-&gt;_UTF8toUTF16( $subject );&nbsp;</div></li><li><div>        $this-&gt;subject = $subject;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetAuthor( $author, $isUTF8 = false ) {&nbsp;</div></li><li><div>        if ( $isUTF8 )&nbsp;</div></li><li><div>            $author = $this-&gt;_UTF8toUTF16( $author );&nbsp;</div></li><li><div>        $this-&gt;author = $author;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetKeywords( $keywords, $isUTF8 = false ) {&nbsp;</div></li><li><div>        if ( $isUTF8 )&nbsp;</div></li><li><div>            $keywords = $this-&gt;_UTF8toUTF16( $keywords );&nbsp;</div></li><li><div>        $this-&gt;keywords = $keywords;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetCreator( $creator, $isUTF8 = false ) {&nbsp;</div></li><li><div>        if ( $isUTF8 )&nbsp;</div></li><li><div>            $creator = $this-&gt;_UTF8toUTF16( $creator );&nbsp;</div></li><li><div>        $this-&gt;creator = $creator;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function AliasNbPages( $alias = '{nb}' ) {&nbsp;</div></li><li><div>        $this-&gt;AliasNbPages = $alias;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function Error( $msg ) {&nbsp;</div></li><li><div>        die( '&lt;b&gt;FPDF error:&lt;/b&gt; ' . $msg );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function Open() {&nbsp;</div></li><li><div>        $this-&gt;state = 1;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function Close() {&nbsp;</div></li><li><div>        if ( $this-&gt;state == 3 )&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        if ( $this-&gt;page == 0 )&nbsp;</div></li><li><div>            $this-&gt;AddPage();&nbsp;</div></li><li><div>        $this-&gt;InFooter = true;&nbsp;</div></li><li><div>        $this-&gt;Footer();&nbsp;</div></li><li><div>        $this-&gt;InFooter = false;&nbsp;</div></li><li><div>        $this-&gt;_endpage();&nbsp;</div></li><li><div>        $this-&gt;_enddoc();&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function AddPage( $orientation = '', $size = '' ) {&nbsp;</div></li><li><div>        if ( $this-&gt;state == 0 )&nbsp;</div></li><li><div>            $this-&gt;Open();&nbsp;</div></li><li><div>        $family = $this-&gt;FontFamily;&nbsp;</div></li><li><div>        $style = $this-&gt;FontStyle . ( $this-&gt;underline ? 'U' : '' );&nbsp;</div></li><li><div>        $fontsize = $this-&gt;FontSizePt;&nbsp;</div></li><li><div>        $lw = $this-&gt;LineWidth;&nbsp;</div></li><li><div>        $dc = $this-&gt;DrawColor;&nbsp;</div></li><li><div>        $fc = $this-&gt;FillColor;&nbsp;</div></li><li><div>        $tc = $this-&gt;TextColor;&nbsp;</div></li><li><div>        $cf = $this-&gt;ColorFlag;&nbsp;</div></li><li><div>        if ( $this-&gt;page &gt; 0 ) {&nbsp;</div></li><li><div>            $this-&gt;InFooter = true;&nbsp;</div></li><li><div>            $this-&gt;Footer();&nbsp;</div></li><li><div>            $this-&gt;InFooter = false;&nbsp;</div></li><li><div>            $this-&gt;_endpage();&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $this-&gt;_beginpage( $orientation, $size );&nbsp;</div></li><li><div>        $this-&gt;_out( '2 J' );&nbsp;</div></li><li><div>        $this-&gt;LineWidth = $lw;&nbsp;</div></li><li><div>        $this-&gt;_out( sprintf( '%.2F w', $lw * $this-&gt;k ) );&nbsp;</div></li><li><div>        if ( $family )&nbsp;</div></li><li><div>            $this-&gt;SetFont( $family, $style, $fontsize );&nbsp;</div></li><li><div>        $this-&gt;DrawColor = $dc;&nbsp;</div></li><li><div>        if ( $dc != '0 G' )&nbsp;</div></li><li><div>            $this-&gt;_out( $dc );&nbsp;</div></li><li><div>        $this-&gt;FillColor = $fc;&nbsp;</div></li><li><div>        if ( $fc != '0 g' )&nbsp;</div></li><li><div>            $this-&gt;_out( $fc );&nbsp;</div></li><li><div>        $this-&gt;TextColor = $tc;&nbsp;</div></li><li><div>        $this-&gt;ColorFlag = $cf;&nbsp;</div></li><li><div>        $this-&gt;InHeader = true;&nbsp;</div></li><li><div>        $this-&gt;Header();&nbsp;</div></li><li><div>        $this-&gt;InHeader = false;&nbsp;</div></li><li><div>        if ( $this-&gt;LineWidth != $lw ) {&nbsp;</div></li><li><div>            $this-&gt;LineWidth = $lw;&nbsp;</div></li><li><div>            $this-&gt;_out( sprintf( '%.2F w', $lw * $this-&gt;k ) );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $family )&nbsp;</div></li><li><div>            $this-&gt;SetFont( $family, $style, $fontsize );&nbsp;</div></li><li><div>        if ( $this-&gt;DrawColor != $dc ) {&nbsp;</div></li><li><div>            $this-&gt;DrawColor = $dc;&nbsp;</div></li><li><div>            $this-&gt;_out( $dc );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $this-&gt;FillColor != $fc ) {&nbsp;</div></li><li><div>            $this-&gt;FillColor = $fc;&nbsp;</div></li><li><div>            $this-&gt;_out( $fc );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $this-&gt;TextColor = $tc;&nbsp;</div></li><li><div>        $this-&gt;ColorFlag = $cf;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function Header() { }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function Footer() { }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function PageNo() {&nbsp;</div></li><li><div>        return $this-&gt;page;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetDrawColor( $r, $g = null, $b = null ) {&nbsp;</div></li><li><div>        if ( ( $r == 0 && $g == 0 && $b == 0 ) || $g === null )&nbsp;</div></li><li><div>            $this-&gt;DrawColor = sprintf( '%.3F G', $r / 255 );&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $this-&gt;DrawColor = sprintf( '%.3F %.3F %.3F RG', $r / 255, $g / 255, $b / 255 );&nbsp;</div></li><li><div>        if ( $this-&gt;page &gt; 0 )&nbsp;</div></li><li><div>            $this-&gt;_out( $this-&gt;DrawColor );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetFillColor( $r, $g = null, $b = null ) {&nbsp;</div></li><li><div>        if ( ( $r == 0 && $g == 0 && $b == 0 ) || $g === null )&nbsp;</div></li><li><div>            $this-&gt;FillColor = sprintf( '%.3F g', $r / 255 );&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $this-&gt;FillColor = sprintf( '%.3F %.3F %.3F rg', $r / 255, $g / 255, $b / 255 );&nbsp;</div></li><li><div>        $this-&gt;ColorFlag = ( $this-&gt;FillColor != $this-&gt;TextColor );&nbsp;</div></li><li><div>        if ( $this-&gt;page &gt; 0 )&nbsp;</div></li><li><div>            $this-&gt;_out( $this-&gt;FillColor );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetTextColor( $r, $g = null, $b = null ) {&nbsp;</div></li><li><div>        if ( ( $r == 0 && $g == 0 && $b == 0 ) || $g === null )&nbsp;</div></li><li><div>            $this-&gt;TextColor = sprintf( '%.3F g', $r / 255 );&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $this-&gt;TextColor = sprintf( '%.3F %.3F %.3F rg', $r / 255, $g / 255, $b / 255 );&nbsp;</div></li><li><div>        $this-&gt;ColorFlag = ( $this-&gt;FillColor != $this-&gt;TextColor );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function GetStringWidth( $s ) {&nbsp;</div></li><li><div>        $s = (string) $s;&nbsp;</div></li><li><div>        $cw =& $this-&gt;CurrentFont['cw'];&nbsp;</div></li><li><div>        $w = 0;&nbsp;</div></li><li><div>        $l = strlen( $s );&nbsp;</div></li><li><div>        for ( $i = 0; $i &lt; $l; $i++ )&nbsp;</div></li><li><div>            $w += $cw[$s[$i]];&nbsp;</div></li><li><div>        return $w * $this-&gt;FontSize / 1000;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetLineWidth( $width ) {&nbsp;</div></li><li><div>        $this-&gt;LineWidth = $width;&nbsp;</div></li><li><div>        if ( $this-&gt;page &gt; 0 )&nbsp;</div></li><li><div>            $this-&gt;_out( sprintf( '%.2F w', $width * $this-&gt;k ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function Line( $x1, $y1, $x2, $y2 ) {&nbsp;</div></li><li><div>        $this-&gt;_out( sprintf( '%.2F %.2F m %.2F %.2F l S', $x1 * $this-&gt;k, ( $this-&gt;h - $y1 ) * $this-&gt;k, $x2 * $this-&gt;k, ( $this-&gt;h - $y2 ) * $this-&gt;k ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function Rect( $x, $y, $w, $h, $style = '' ) {&nbsp;</div></li><li><div>        if ( $style == 'F' )&nbsp;</div></li><li><div>            $op = 'f';&nbsp;</div></li><li><div>        elseif ( $style == 'FD' || $style == 'DF' )&nbsp;</div></li><li><div>            $op = 'B';&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $op = 'S';&nbsp;</div></li><li><div>        $this-&gt;_out( sprintf( '%.2F %.2F %.2F %.2F re %s', $x * $this-&gt;k, ( $this-&gt;h - $y ) * $this-&gt;k, $w * $this-&gt;k, -$h * $this-&gt;k, $op ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function AddFont( $family, $style = '', $file = '' ) {&nbsp;</div></li><li><div>        $family = strtolower( $family );&nbsp;</div></li><li><div>        if ( $file == '' )&nbsp;</div></li><li><div>            $file = str_replace( ' ', '', $family ) . strtolower( $style ) . '.php';&nbsp;</div></li><li><div>        $style = strtoupper( $style );&nbsp;</div></li><li><div>        if ( $style == 'IB' )&nbsp;</div></li><li><div>            $style = 'BI';&nbsp;</div></li><li><div>        $fontkey = $family . $style;&nbsp;</div></li><li><div>        if ( isset( $this-&gt;fonts[$fontkey] ) )&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        $info = $this-&gt;_loadfont( $file );&nbsp;</div></li><li><div>        $info['i'] = count( $this-&gt;fonts ) + 1;&nbsp;</div></li><li><div>        if ( !empty( $info['diff'] ) ) {&nbsp;</div></li><li><div>            $n = array_search( $info['diff'], $this-&gt;diffs );&nbsp;</div></li><li><div>            if ( !$n ) {&nbsp;</div></li><li><div>                $n = count( $this-&gt;diffs ) + 1;&nbsp;</div></li><li><div>                $this-&gt;diffs[$n] = $info['diff'];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $info['diffn'] = $n;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( !empty( $info['file'] ) ) {&nbsp;</div></li><li><div>            if ( $info['type'] == 'TrueType' )&nbsp;</div></li><li><div>                $this-&gt;FontFiles[$info['file']] = array(&nbsp;</div></li><li><div>                     'length1' =&gt; $info['originalsize']&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                $this-&gt;FontFiles[$info['file']] = array(&nbsp;</div></li><li><div>                     'length1' =&gt; $info['size1'], &nbsp;</div></li><li><div>                    'length2' =&gt; $info['size2']&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $this-&gt;fonts[$fontkey] = $info;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetFont( $family, $style = '', $size = 0 ) {&nbsp;</div></li><li><div>        if ( $family == '' )&nbsp;</div></li><li><div>            $family = $this-&gt;FontFamily;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $family = strtolower( $family );&nbsp;</div></li><li><div>        $style = strtoupper( $style );&nbsp;</div></li><li><div>        if ( strpos( $style, 'U' ) !== false ) {&nbsp;</div></li><li><div>            $this-&gt;underline = true;&nbsp;</div></li><li><div>            $style = str_replace( 'U', '', $style );&nbsp;</div></li><li><div>        } else&nbsp;</div></li><li><div>            $this-&gt;underline = false;&nbsp;</div></li><li><div>        if ( $style == 'IB' )&nbsp;</div></li><li><div>            $style = 'BI';&nbsp;</div></li><li><div>        if ( $size == 0 )&nbsp;</div></li><li><div>            $size = $this-&gt;FontSizePt;&nbsp;</div></li><li><div>        if ( $this-&gt;FontFamily == $family && $this-&gt;FontStyle == $style && $this-&gt;FontSizePt == $size )&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        $fontkey = $family . $style;&nbsp;</div></li><li><div>        if ( !isset( $this-&gt;fonts[$fontkey] ) ) {&nbsp;</div></li><li><div>            if ( $family == 'arial' )&nbsp;</div></li><li><div>                $family = 'helvetica';&nbsp;</div></li><li><div>            if ( in_array( $family, $this-&gt;CoreFonts ) ) {&nbsp;</div></li><li><div>                if ( $family == 'symbol' || $family == 'zapfdingbats' )&nbsp;</div></li><li><div>                    $style = '';&nbsp;</div></li><li><div>                $fontkey = $family . $style;&nbsp;</div></li><li><div>                if ( !isset( $this-&gt;fonts[$fontkey] ) )&nbsp;</div></li><li><div>                    $this-&gt;AddFont( $family, $style );&nbsp;</div></li><li><div>            } else&nbsp;</div></li><li><div>                $this-&gt;Error( 'Undefined font: ' . $family . ' ' . $style );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $this-&gt;FontFamily = $family;&nbsp;</div></li><li><div>        $this-&gt;FontStyle = $style;&nbsp;</div></li><li><div>        $this-&gt;FontSizePt = $size;&nbsp;</div></li><li><div>        $this-&gt;FontSize = $size / $this-&gt;k;&nbsp;</div></li><li><div>        $this-&gt;CurrentFont =& $this-&gt;fonts[$fontkey];&nbsp;</div></li><li><div>        if ( $this-&gt;page &gt; 0 )&nbsp;</div></li><li><div>            $this-&gt;_out( sprintf( 'BT /F%d %.2F Tf ET', $this-&gt;CurrentFont['i'], $this-&gt;FontSizePt ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetFontSize( $size ) {&nbsp;</div></li><li><div>        if ( $this-&gt;FontSizePt == $size )&nbsp;</div></li><li><div>            return;&nbsp;</div></li><li><div>        $this-&gt;FontSizePt = $size;&nbsp;</div></li><li><div>        $this-&gt;FontSize = $size / $this-&gt;k;&nbsp;</div></li><li><div>        if ( $this-&gt;page &gt; 0 )&nbsp;</div></li><li><div>            $this-&gt;_out( sprintf( 'BT /F%d %.2F Tf ET', $this-&gt;CurrentFont['i'], $this-&gt;FontSizePt ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function AddLink() {&nbsp;</div></li><li><div>        $n = count( $this-&gt;links ) + 1;&nbsp;</div></li><li><div>        $this-&gt;links[$n] = array(&nbsp;</div></li><li><div>             0, &nbsp;</div></li><li><div>            0&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        return $n;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetLink( $link, $y = 0, $page = -1 ) {&nbsp;</div></li><li><div>        if ( $y == -1 )&nbsp;</div></li><li><div>            $y = $this-&gt;y;&nbsp;</div></li><li><div>        if ( $page == -1 )&nbsp;</div></li><li><div>            $page = $this-&gt;page;&nbsp;</div></li><li><div>        $this-&gt;links[$link] = array(&nbsp;</div></li><li><div>             $page, &nbsp;</div></li><li><div>            $y&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function Link( $x, $y, $w, $h, $link ) {&nbsp;</div></li><li><div>        $this-&gt;PageLinks[$this-&gt;page][] = array(&nbsp;</div></li><li><div>             $x * $this-&gt;k, &nbsp;</div></li><li><div>            $this-&gt;hPt - $y * $this-&gt;k, &nbsp;</div></li><li><div>            $w * $this-&gt;k, &nbsp;</div></li><li><div>            $h * $this-&gt;k, &nbsp;</div></li><li><div>            $link&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function Text( $x, $y, $txt ) {&nbsp;</div></li><li><div>        $s = sprintf( 'BT %.2F %.2F Td (%s) Tj ET', $x * $this-&gt;k, ( $this-&gt;h - $y ) * $this-&gt;k, $this-&gt;_escape( $txt ) );&nbsp;</div></li><li><div>        if ( $this-&gt;underline && $txt != '' )&nbsp;</div></li><li><div>            $s .= ' ' . $this-&gt;_dounderline( $x, $y, $txt );&nbsp;</div></li><li><div>        if ( $this-&gt;ColorFlag )&nbsp;</div></li><li><div>            $s = 'q ' . $this-&gt;TextColor . ' ' . $s . ' Q';&nbsp;</div></li><li><div>        $this-&gt;_out( $s );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function AcceptPageBreak() {&nbsp;</div></li><li><div>        return $this-&gt;AutoPageBreak;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function Cell( $w, $h = 0, $txt = '', $border = 0, $ln = 0, $align = '', $fill = false, $link = '' ) {&nbsp;</div></li><li><div>        $k = $this-&gt;k;&nbsp;</div></li><li><div>        if ( $this-&gt;y + $h &gt; $this-&gt;PageBreakTrigger && !$this-&gt;InHeader && !$this-&gt;InFooter && $this-&gt;AcceptPageBreak() ) {&nbsp;</div></li><li><div>            $x = $this-&gt;x;&nbsp;</div></li><li><div>            $ws = $this-&gt;ws;&nbsp;</div></li><li><div>            if ( $ws &gt; 0 ) {&nbsp;</div></li><li><div>                $this-&gt;ws = 0;&nbsp;</div></li><li><div>                $this-&gt;_out( '0 Tw' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $this-&gt;AddPage( $this-&gt;CurOrientation, $this-&gt;CurPageSize );&nbsp;</div></li><li><div>            $this-&gt;x = $x;&nbsp;</div></li><li><div>            if ( $ws &gt; 0 ) {&nbsp;</div></li><li><div>                $this-&gt;ws = $ws;&nbsp;</div></li><li><div>                $this-&gt;_out( sprintf( '%.3F Tw', $ws * $k ) );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $w == 0 )&nbsp;</div></li><li><div>            $w = $this-&gt;w - $this-&gt;rMargin - $this-&gt;x;&nbsp;</div></li><li><div>        $s = '';&nbsp;</div></li><li><div>        if ( $fill || $border == 1 ) {&nbsp;</div></li><li><div>            if ( $fill )&nbsp;</div></li><li><div>                $op = ( $border == 1 ) ? 'B' : 'f';&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                $op = 'S';&nbsp;</div></li><li><div>            $s = sprintf( '%.2F %.2F %.2F %.2F re %s ', $this-&gt;x * $k, ( $this-&gt;h - $this-&gt;y ) * $k, $w * $k, -$h * $k, $op );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( is_string( $border ) ) {&nbsp;</div></li><li><div>            $x = $this-&gt;x;&nbsp;</div></li><li><div>            $y = $this-&gt;y;&nbsp;</div></li><li><div>            if ( strpos( $border, 'L' ) !== false )&nbsp;</div></li><li><div>                $s .= sprintf( '%.2F %.2F m %.2F %.2F l S ', $x * $k, ( $this-&gt;h - $y ) * $k, $x * $k, ( $this-&gt;h - ( $y + $h ) ) * $k );&nbsp;</div></li><li><div>            if ( strpos( $border, 'T' ) !== false )&nbsp;</div></li><li><div>                $s .= sprintf( '%.2F %.2F m %.2F %.2F l S ', $x * $k, ( $this-&gt;h - $y ) * $k, ( $x + $w ) * $k, ( $this-&gt;h - $y ) * $k );&nbsp;</div></li><li><div>            if ( strpos( $border, 'R' ) !== false )&nbsp;</div></li><li><div>                $s .= sprintf( '%.2F %.2F m %.2F %.2F l S ', ( $x + $w ) * $k, ( $this-&gt;h - $y ) * $k, ( $x + $w ) * $k, ( $this-&gt;h - ( $y + $h ) ) * $k );&nbsp;</div></li><li><div>            if ( strpos( $border, 'B' ) !== false )&nbsp;</div></li><li><div>                $s .= sprintf( '%.2F %.2F m %.2F %.2F l S ', $x * $k, ( $this-&gt;h - ( $y + $h ) ) * $k, ( $x + $w ) * $k, ( $this-&gt;h - ( $y + $h ) ) * $k );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $txt !== '' ) {&nbsp;</div></li><li><div>            if ( $align == 'R' )&nbsp;</div></li><li><div>                $dx = $w - $this-&gt;cMargin - $this-&gt;GetStringWidth( $txt );&nbsp;</div></li><li><div>            elseif ( $align == 'C' )&nbsp;</div></li><li><div>                $dx = ( $w - $this-&gt;GetStringWidth( $txt ) ) / 2;&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                $dx = $this-&gt;cMargin;&nbsp;</div></li><li><div>            if ( $this-&gt;ColorFlag )&nbsp;</div></li><li><div>                $s .= 'q ' . $this-&gt;TextColor . ' ';&nbsp;</div></li><li><div>            $txt2 = str_replace( ')', '\\)', str_replace( '(', '\\(', str_replace( '\\', '\\\\', $txt ) ) );&nbsp;</div></li><li><div>            $s .= sprintf( 'BT %.2F %.2F Td (%s) Tj ET', ( $this-&gt;x + $dx ) * $k, ( $this-&gt;h - ( $this-&gt;y + .5 * $h + .3 * $this-&gt;FontSize ) ) * $k, $txt2 );&nbsp;</div></li><li><div>            if ( $this-&gt;underline )&nbsp;</div></li><li><div>                $s .= ' ' . $this-&gt;_dounderline( $this-&gt;x + $dx, $this-&gt;y + .5 * $h + .3 * $this-&gt;FontSize, $txt );&nbsp;</div></li><li><div>            if ( $this-&gt;ColorFlag )&nbsp;</div></li><li><div>                $s .= ' Q';&nbsp;</div></li><li><div>            if ( $link )&nbsp;</div></li><li><div>                $this-&gt;Link( $this-&gt;x + $dx, $this-&gt;y + .5 * $h - .5 * $this-&gt;FontSize, $this-&gt;GetStringWidth( $txt ), $this-&gt;FontSize, $link );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $s )&nbsp;</div></li><li><div>            $this-&gt;_out( $s );&nbsp;</div></li><li><div>        $this-&gt;lasth = $h;&nbsp;</div></li><li><div>        if ( $ln &gt; 0 ) {&nbsp;</div></li><li><div>            $this-&gt;y += $h;&nbsp;</div></li><li><div>            if ( $ln == 1 )&nbsp;</div></li><li><div>                $this-&gt;x = $this-&gt;lMargin;&nbsp;</div></li><li><div>        } else&nbsp;</div></li><li><div>            $this-&gt;x += $w;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function MultiCell( $w, $h, $txt, $border = 0, $align = 'J', $fill = false ) {&nbsp;</div></li><li><div>        $cw =& $this-&gt;CurrentFont['cw'];&nbsp;</div></li><li><div>        if ( $w == 0 )&nbsp;</div></li><li><div>            $w = $this-&gt;w - $this-&gt;rMargin - $this-&gt;x;&nbsp;</div></li><li><div>        $wmax = ( $w - 2 * $this-&gt;cMargin ) * 1000 / $this-&gt;FontSize;&nbsp;</div></li><li><div>        $s = str_replace( &quot;\r&quot;, '', $txt );&nbsp;</div></li><li><div>        $nb = strlen( $s );&nbsp;</div></li><li><div>        if ( $nb &gt; 0 && $s[$nb - 1] == &quot;\n&quot; )&nbsp;</div></li><li><div>            $nb--;&nbsp;</div></li><li><div>        $b = 0;&nbsp;</div></li><li><div>        if ( $border ) {&nbsp;</div></li><li><div>            if ( $border == 1 ) {&nbsp;</div></li><li><div>                $border = 'LTRB';&nbsp;</div></li><li><div>                $b = 'LRT';&nbsp;</div></li><li><div>                $b2 = 'LR';&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $b2 = '';&nbsp;</div></li><li><div>                if ( strpos( $border, 'L' ) !== false )&nbsp;</div></li><li><div>                    $b2 .= 'L';&nbsp;</div></li><li><div>                if ( strpos( $border, 'R' ) !== false )&nbsp;</div></li><li><div>                    $b2 .= 'R';&nbsp;</div></li><li><div>                $b = ( strpos( $border, 'T' ) !== false ) ? $b2 . 'T' : $b2;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $sep = -1;&nbsp;</div></li><li><div>        $i = 0;&nbsp;</div></li><li><div>        $j = 0;&nbsp;</div></li><li><div>        $l = 0;&nbsp;</div></li><li><div>        $ns = 0;&nbsp;</div></li><li><div>        $nl = 1;&nbsp;</div></li><li><div>        while ( $i &lt; $nb ) {&nbsp;</div></li><li><div>            $c = $s[$i];&nbsp;</div></li><li><div>            if ( $c == &quot;\n&quot; ) {&nbsp;</div></li><li><div>                if ( $this-&gt;ws &gt; 0 ) {&nbsp;</div></li><li><div>                    $this-&gt;ws = 0;&nbsp;</div></li><li><div>                    $this-&gt;_out( '0 Tw' );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $this-&gt;Cell( $w, $h, substr( $s, $j, $i - $j ), $b, 2, $align, $fill );&nbsp;</div></li><li><div>                $i++;&nbsp;</div></li><li><div>                $sep = -1;&nbsp;</div></li><li><div>                $j = $i;&nbsp;</div></li><li><div>                $l = 0;&nbsp;</div></li><li><div>                $ns = 0;&nbsp;</div></li><li><div>                $nl++;&nbsp;</div></li><li><div>                if ( $border && $nl == 2 )&nbsp;</div></li><li><div>                    $b = $b2;&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( $c == ' ' ) {&nbsp;</div></li><li><div>                $sep = $i;&nbsp;</div></li><li><div>                $ls = $l;&nbsp;</div></li><li><div>                $ns++;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $l += $cw[$c];&nbsp;</div></li><li><div>            if ( $l &gt; $wmax ) {&nbsp;</div></li><li><div>                if ( $sep == -1 ) {&nbsp;</div></li><li><div>                    if ( $i == $j )&nbsp;</div></li><li><div>                        $i++;&nbsp;</div></li><li><div>                    if ( $this-&gt;ws &gt; 0 ) {&nbsp;</div></li><li><div>                        $this-&gt;ws = 0;&nbsp;</div></li><li><div>                        $this-&gt;_out( '0 Tw' );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $this-&gt;Cell( $w, $h, substr( $s, $j, $i - $j ), $b, 2, $align, $fill );&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    if ( $align == 'J' ) {&nbsp;</div></li><li><div>                        $this-&gt;ws = ( $ns &gt; 1 ) ? ( $wmax - $ls ) / 1000 * $this-&gt;FontSize / ( $ns - 1 ) : 0;&nbsp;</div></li><li><div>                        $this-&gt;_out( sprintf( '%.3F Tw', $this-&gt;ws * $this-&gt;k ) );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    $this-&gt;Cell( $w, $h, substr( $s, $j, $sep - $j ), $b, 2, $align, $fill );&nbsp;</div></li><li><div>                    $i = $sep + 1;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $sep = -1;&nbsp;</div></li><li><div>                $j = $i;&nbsp;</div></li><li><div>                $l = 0;&nbsp;</div></li><li><div>                $ns = 0;&nbsp;</div></li><li><div>                $nl++;&nbsp;</div></li><li><div>                if ( $border && $nl == 2 )&nbsp;</div></li><li><div>                    $b = $b2;&nbsp;</div></li><li><div>            } else&nbsp;</div></li><li><div>                $i++;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $this-&gt;ws &gt; 0 ) {&nbsp;</div></li><li><div>            $this-&gt;ws = 0;&nbsp;</div></li><li><div>            $this-&gt;_out( '0 Tw' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $border && strpos( $border, 'B' ) !== false )&nbsp;</div></li><li><div>            $b .= 'B';&nbsp;</div></li><li><div>        $this-&gt;Cell( $w, $h, substr( $s, $j, $i - $j ), $b, 2, $align, $fill );&nbsp;</div></li><li><div>        $this-&gt;x = $this-&gt;lMargin;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function Write( $h, $txt, $link = '' ) {&nbsp;</div></li><li><div>        $cw =& $this-&gt;CurrentFont['cw'];&nbsp;</div></li><li><div>        $w = $this-&gt;w - $this-&gt;rMargin - $this-&gt;x;&nbsp;</div></li><li><div>        $wmax = ( $w - 2 * $this-&gt;cMargin ) * 1000 / $this-&gt;FontSize;&nbsp;</div></li><li><div>        $s = str_replace( &quot;\r&quot;, '', $txt );&nbsp;</div></li><li><div>        $nb = strlen( $s );&nbsp;</div></li><li><div>        $sep = -1;&nbsp;</div></li><li><div>        $i = 0;&nbsp;</div></li><li><div>        $j = 0;&nbsp;</div></li><li><div>        $l = 0;&nbsp;</div></li><li><div>        $nl = 1;&nbsp;</div></li><li><div>        while ( $i &lt; $nb ) {&nbsp;</div></li><li><div>            $c = $s[$i];&nbsp;</div></li><li><div>            if ( $c == &quot;\n&quot; ) {&nbsp;</div></li><li><div>                $this-&gt;Cell( $w, $h, substr( $s, $j, $i - $j ), 0, 2, '', 0, $link );&nbsp;</div></li><li><div>                $i++;&nbsp;</div></li><li><div>                $sep = -1;&nbsp;</div></li><li><div>                $j = $i;&nbsp;</div></li><li><div>                $l = 0;&nbsp;</div></li><li><div>                if ( $nl == 1 ) {&nbsp;</div></li><li><div>                    $this-&gt;x = $this-&gt;lMargin;&nbsp;</div></li><li><div>                    $w = $this-&gt;w - $this-&gt;rMargin - $this-&gt;x;&nbsp;</div></li><li><div>                    $wmax = ( $w - 2 * $this-&gt;cMargin ) * 1000 / $this-&gt;FontSize;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $nl++;&nbsp;</div></li><li><div>                continue;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( $c == ' ' )&nbsp;</div></li><li><div>                $sep = $i;&nbsp;</div></li><li><div>            $l += $cw[$c];&nbsp;</div></li><li><div>            if ( $l &gt; $wmax ) {&nbsp;</div></li><li><div>                if ( $sep == -1 ) {&nbsp;</div></li><li><div>                    if ( $this-&gt;x &gt; $this-&gt;lMargin ) {&nbsp;</div></li><li><div>                        $this-&gt;x = $this-&gt;lMargin;&nbsp;</div></li><li><div>                        $this-&gt;y += $h;&nbsp;</div></li><li><div>                        $w = $this-&gt;w - $this-&gt;rMargin - $this-&gt;x;&nbsp;</div></li><li><div>                        $wmax = ( $w - 2 * $this-&gt;cMargin ) * 1000 / $this-&gt;FontSize;&nbsp;</div></li><li><div>                        $i++;&nbsp;</div></li><li><div>                        $nl++;&nbsp;</div></li><li><div>                        continue;&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                    if ( $i == $j )&nbsp;</div></li><li><div>                        $i++;&nbsp;</div></li><li><div>                    $this-&gt;Cell( $w, $h, substr( $s, $j, $i - $j ), 0, 2, '', 0, $link );&nbsp;</div></li><li><div>                } else {&nbsp;</div></li><li><div>                    $this-&gt;Cell( $w, $h, substr( $s, $j, $sep - $j ), 0, 2, '', 0, $link );&nbsp;</div></li><li><div>                    $i = $sep + 1;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $sep = -1;&nbsp;</div></li><li><div>                $j = $i;&nbsp;</div></li><li><div>                $l = 0;&nbsp;</div></li><li><div>                if ( $nl == 1 ) {&nbsp;</div></li><li><div>                    $this-&gt;x = $this-&gt;lMargin;&nbsp;</div></li><li><div>                    $w = $this-&gt;w - $this-&gt;rMargin - $this-&gt;x;&nbsp;</div></li><li><div>                    $wmax = ( $w - 2 * $this-&gt;cMargin ) * 1000 / $this-&gt;FontSize;&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $nl++;&nbsp;</div></li><li><div>            } else&nbsp;</div></li><li><div>                $i++;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $i != $j )&nbsp;</div></li><li><div>            $this-&gt;Cell( $l / 1000 * $this-&gt;FontSize, $h, substr( $s, $j ), 0, 0, '', 0, $link );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function Ln( $h = null ) {&nbsp;</div></li><li><div>        $this-&gt;x = $this-&gt;lMargin;&nbsp;</div></li><li><div>        if ( $h === null )&nbsp;</div></li><li><div>            $this-&gt;y += $this-&gt;lasth;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $this-&gt;y += $h;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function Image( $file, $x = null, $y = null, $w = 0, $h = 0, $type = '', $link = '' ) {&nbsp;</div></li><li><div>        if ( !isset( $this-&gt;images[$file] ) ) {&nbsp;</div></li><li><div>            if ( $type == '' ) {&nbsp;</div></li><li><div>                $pos = strrpos( $file, '.' );&nbsp;</div></li><li><div>                if ( !$pos )&nbsp;</div></li><li><div>                    $this-&gt;Error( 'Image file has no extension and no type was specified: ' . $file );&nbsp;</div></li><li><div>                $type = substr( $file, $pos + 1 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $type = strtolower( $type );&nbsp;</div></li><li><div>            if ( $type == 'jpeg' )&nbsp;</div></li><li><div>                $type = 'jpg';&nbsp;</div></li><li><div>            $mtd = '_parse' . $type;&nbsp;</div></li><li><div>            if ( !method_exists( $this, $mtd ) )&nbsp;</div></li><li><div>                $this-&gt;Error( 'Unsupported image type: ' . $type );&nbsp;</div></li><li><div>            $info = $this-&gt;$mtd( $file );&nbsp;</div></li><li><div>            $info['i'] = count( $this-&gt;images ) + 1;&nbsp;</div></li><li><div>            $this-&gt;images[$file] = $info;&nbsp;</div></li><li><div>        } else&nbsp;</div></li><li><div>            $info = $this-&gt;images[$file];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $w == 0 && $h == 0 ) {&nbsp;</div></li><li><div>            $w = -96;&nbsp;</div></li><li><div>            $h = -96;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $w &lt; 0 )&nbsp;</div></li><li><div>            $w = -$info['w'] * 72 / $w / $this-&gt;k;&nbsp;</div></li><li><div>        if ( $h &lt; 0 )&nbsp;</div></li><li><div>            $h = -$info['h'] * 72 / $h / $this-&gt;k;&nbsp;</div></li><li><div>        if ( $w == 0 )&nbsp;</div></li><li><div>            $w = $h * $info['w'] / $info['h'];&nbsp;</div></li><li><div>        if ( $h == 0 )&nbsp;</div></li><li><div>            $h = $w * $info['h'] / $info['w'];&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $y === null ) {&nbsp;</div></li><li><div>            if ( $this-&gt;y + $h &gt; $this-&gt;PageBreakTrigger && !$this-&gt;InHeader && !$this-&gt;InFooter && $this-&gt;AcceptPageBreak() ) {&nbsp;</div></li><li><div>                $x2 = $this-&gt;x;&nbsp;</div></li><li><div>                $this-&gt;AddPage( $this-&gt;CurOrientation, $this-&gt;CurPageSize );&nbsp;</div></li><li><div>                $this-&gt;x = $x2;&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $y = $this-&gt;y;&nbsp;</div></li><li><div>            $this-&gt;y += $h;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $x === null )&nbsp;</div></li><li><div>            $x = $this-&gt;x;&nbsp;</div></li><li><div>        $this-&gt;_out( sprintf( 'q %.2F 0 0 %.2F %.2F %.2F cm /I%d Do Q', $w * $this-&gt;k, $h * $this-&gt;k, $x * $this-&gt;k, ( $this-&gt;h - ( $y + $h ) ) * $this-&gt;k, $info['i'] ) );&nbsp;</div></li><li><div>        if ( $link )&nbsp;</div></li><li><div>            $this-&gt;Link( $x, $y, $w, $h, $link );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function GetX() {&nbsp;</div></li><li><div>        return $this-&gt;x;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetX( $x ) {&nbsp;</div></li><li><div>        if ( $x &gt;= 0 )&nbsp;</div></li><li><div>            $this-&gt;x = $x;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $this-&gt;x = $this-&gt;w + $x;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function GetY() {&nbsp;</div></li><li><div>        return $this-&gt;y;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetY( $y ) {&nbsp;</div></li><li><div>        $this-&gt;x = $this-&gt;lMargin;&nbsp;</div></li><li><div>        if ( $y &gt;= 0 )&nbsp;</div></li><li><div>            $this-&gt;y = $y;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $this-&gt;y = $this-&gt;h + $y;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function SetXY( $x, $y ) {&nbsp;</div></li><li><div>        $this-&gt;SetY( $y );&nbsp;</div></li><li><div>        $this-&gt;SetX( $x );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function Output( $name = '', $dest = '' ) {&nbsp;</div></li><li><div>        if ( $this-&gt;state &lt; 3 )&nbsp;</div></li><li><div>            $this-&gt;Close();&nbsp;</div></li><li><div>        $dest = strtoupper( $dest );&nbsp;</div></li><li><div>        if ( $dest == '' ) {&nbsp;</div></li><li><div>            if ( $name == '' ) {&nbsp;</div></li><li><div>                $name = 'doc.pdf';&nbsp;</div></li><li><div>                $dest = 'I';&nbsp;</div></li><li><div>            } else&nbsp;</div></li><li><div>                $dest = 'F';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        switch ( $dest ) {&nbsp;</div></li><li><div>            case 'I':&nbsp;</div></li><li><div>                $this-&gt;_checkoutput();&nbsp;</div></li><li><div>                if ( PHP_SAPI != 'cli' ) {&nbsp;</div></li><li><div>                    header( 'Content-Type: application/pdf' );&nbsp;</div></li><li><div>                    header( 'Content-Disposition: inline; filename=&quot;' . $name . '&quot;' );&nbsp;</div></li><li><div>                    header( 'Cache-Control: private, max-age=0, must-revalidate' );&nbsp;</div></li><li><div>                    header( 'Pragma: public' );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                echo $this-&gt;buffer;&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'D':&nbsp;</div></li><li><div>                $this-&gt;_checkoutput();&nbsp;</div></li><li><div>                header( 'Content-Type: application/x-download' );&nbsp;</div></li><li><div>                header( 'Content-Disposition: attachment; filename=&quot;' . $name . '&quot;' );&nbsp;</div></li><li><div>                header( 'Cache-Control: private, max-age=0, must-revalidate' );&nbsp;</div></li><li><div>                header( 'Pragma: public' );&nbsp;</div></li><li><div>                echo $this-&gt;buffer;&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'F':&nbsp;</div></li><li><div>                $f = fopen( $name, 'wb' );&nbsp;</div></li><li><div>                if ( !$f )&nbsp;</div></li><li><div>                    $this-&gt;Error( 'Unable to create output file: ' . $name );&nbsp;</div></li><li><div>                fwrite( $f, $this-&gt;buffer, strlen( $this-&gt;buffer ) );&nbsp;</div></li><li><div>                fclose( $f );&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            case 'S':&nbsp;</div></li><li><div>                return $this-&gt;buffer;&nbsp;</div></li><li><div>            default:&nbsp;</div></li><li><div>                $this-&gt;Error( 'Incorrect output destination: ' . $dest );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return '';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _dochecks() {&nbsp;</div></li><li><div>        if ( sprintf( '%.1F', 1.0 ) != '1.0' )&nbsp;</div></li><li><div>            $this-&gt;Error( 'This version of PHP is not supported' );&nbsp;</div></li><li><div>        if ( ini_get( 'mbstring.func_overload' ) & 2 )&nbsp;</div></li><li><div>            $this-&gt;Error( 'mbstring overloading must be disabled' );&nbsp;</div></li><li><div>        if ( get_magic_quotes_runtime() && version_compare( phpversion(), '5.4', '&lt;' ) )&nbsp;</div></li><li><div>            @set_magic_quotes_runtime( 0 );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _checkoutput() {&nbsp;</div></li><li><div>        if ( PHP_SAPI != 'cli' ) {&nbsp;</div></li><li><div>            if ( headers_sent( $file, $line ) )&nbsp;</div></li><li><div>                $this-&gt;Error( &quot;Some data has already been output, can't send PDF file (output started at $file:$line)&quot; );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( ob_get_length() ) {&nbsp;</div></li><li><div>            if ( preg_match( '/^(\xEF\xBB\xBF)?\s*$/', ob_get_contents() ) ) {&nbsp;</div></li><li><div>                ob_clean();&nbsp;</div></li><li><div>            } else&nbsp;</div></li><li><div>                $this-&gt;Error( &quot;Some data has already been output, can't send PDF file&quot; );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _getpagesize( $size ) {&nbsp;</div></li><li><div>        if ( is_string( $size ) ) {&nbsp;</div></li><li><div>            $size = strtolower( $size );&nbsp;</div></li><li><div>            if ( !isset( $this-&gt;StdPageSizes[$size] ) )&nbsp;</div></li><li><div>                $this-&gt;Error( 'Unknown page size: ' . $size );&nbsp;</div></li><li><div>            $a = $this-&gt;StdPageSizes[$size];&nbsp;</div></li><li><div>            return array(&nbsp;</div></li><li><div>                 $a[0] / $this-&gt;k, &nbsp;</div></li><li><div>                $a[1] / $this-&gt;k&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            if ( $size[0] &gt; $size[1] )&nbsp;</div></li><li><div>                return array(&nbsp;</div></li><li><div>                     $size[1], &nbsp;</div></li><li><div>                    $size[0]&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                return $size;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _beginpage( $orientation, $size ) {&nbsp;</div></li><li><div>        $this-&gt;page++;&nbsp;</div></li><li><div>        $this-&gt;pages[$this-&gt;page] = '';&nbsp;</div></li><li><div>        $this-&gt;state = 2;&nbsp;</div></li><li><div>        $this-&gt;x = $this-&gt;lMargin;&nbsp;</div></li><li><div>        $this-&gt;y = $this-&gt;tMargin;&nbsp;</div></li><li><div>        $this-&gt;FontFamily = '';&nbsp;</div></li><li><div>        if ( $orientation == '' )&nbsp;</div></li><li><div>            $orientation = $this-&gt;DefOrientation;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $orientation = strtoupper( $orientation[0] );&nbsp;</div></li><li><div>        if ( $size == '' )&nbsp;</div></li><li><div>            $size = $this-&gt;DefPageSize;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $size = $this-&gt;_getpagesize( $size );&nbsp;</div></li><li><div>        if ( $orientation != $this-&gt;CurOrientation || $size[0] != $this-&gt;CurPageSize[0] || $size[1] != $this-&gt;CurPageSize[1] ) {&nbsp;</div></li><li><div>            if ( $orientation == 'P' ) {&nbsp;</div></li><li><div>                $this-&gt;w = $size[0];&nbsp;</div></li><li><div>                $this-&gt;h = $size[1];&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $this-&gt;w = $size[1];&nbsp;</div></li><li><div>                $this-&gt;h = $size[0];&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            $this-&gt;wPt = $this-&gt;w * $this-&gt;k;&nbsp;</div></li><li><div>            $this-&gt;hPt = $this-&gt;h * $this-&gt;k;&nbsp;</div></li><li><div>            $this-&gt;PageBreakTrigger = $this-&gt;h - $this-&gt;bMargin;&nbsp;</div></li><li><div>            $this-&gt;CurOrientation = $orientation;&nbsp;</div></li><li><div>            $this-&gt;CurPageSize = $size;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $orientation != $this-&gt;DefOrientation || $size[0] != $this-&gt;DefPageSize[0] || $size[1] != $this-&gt;DefPageSize[1] )&nbsp;</div></li><li><div>            $this-&gt;PageSizes[$this-&gt;page] = array(&nbsp;</div></li><li><div>                 $this-&gt;wPt, &nbsp;</div></li><li><div>                $this-&gt;hPt&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _endpage() {&nbsp;</div></li><li><div>        $this-&gt;state = 1;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _loadfont( $font ) {&nbsp;</div></li><li><div>        include( $this-&gt;fontpath . $font );&nbsp;</div></li><li><div>        $a = get_defined_vars();&nbsp;</div></li><li><div>        if ( !isset( $a['name'] ) )&nbsp;</div></li><li><div>            $this-&gt;Error( 'Could not include font definition file' );&nbsp;</div></li><li><div>        return $a;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _escape( $s ) {&nbsp;</div></li><li><div>        $s = str_replace( '\\', '\\\\', $s );&nbsp;</div></li><li><div>        $s = str_replace( '(', '\\(', $s );&nbsp;</div></li><li><div>        $s = str_replace( ')', '\\)', $s );&nbsp;</div></li><li><div>        $s = str_replace( &quot;\r&quot;, '\\r', $s );&nbsp;</div></li><li><div>        return $s;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _textstring( $s ) {&nbsp;</div></li><li><div>        return '(' . $this-&gt;_escape( $s ) . ')';&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _UTF8toUTF16( $s ) {&nbsp;</div></li><li><div>        $res = &quot;\xFE\xFF&quot;;&nbsp;</div></li><li><div>        $nb = strlen( $s );&nbsp;</div></li><li><div>        $i = 0;&nbsp;</div></li><li><div>        while ( $i &lt; $nb ) {&nbsp;</div></li><li><div>            $c1 = ord( $s[$i++] );&nbsp;</div></li><li><div>            if ( $c1 &gt;= 224 ) {&nbsp;</div></li><li><div>                $c2 = ord( $s[$i++] );&nbsp;</div></li><li><div>                $c3 = ord( $s[$i++] );&nbsp;</div></li><li><div>                $res .= chr( ( ( $c1 & 0x0F ) &lt;&lt; 4 ) + ( ( $c2 & 0x3C ) &gt;&gt; 2 ) );&nbsp;</div></li><li><div>                $res .= chr( ( ( $c2 & 0x03 ) &lt;&lt; 6 ) + ( $c3 & 0x3F ) );&nbsp;</div></li><li><div>            } elseif ( $c1 &gt;= 192 ) {&nbsp;</div></li><li><div>                $c2 = ord( $s[$i++] );&nbsp;</div></li><li><div>                $res .= chr( ( $c1 & 0x1C ) &gt;&gt; 2 );&nbsp;</div></li><li><div>                $res .= chr( ( ( $c1 & 0x03 ) &lt;&lt; 6 ) + ( $c2 & 0x3F ) );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $res .= &quot;\0&quot; . chr( $c1 );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $res;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _dounderline( $x, $y, $txt ) {&nbsp;</div></li><li><div>        $up = $this-&gt;CurrentFont['up'];&nbsp;</div></li><li><div>        $ut = $this-&gt;CurrentFont['ut'];&nbsp;</div></li><li><div>        $w = $this-&gt;GetStringWidth( $txt ) + $this-&gt;ws * substr_count( $txt, ' ' );&nbsp;</div></li><li><div>        return sprintf( '%.2F %.2F %.2F %.2F re f', $x * $this-&gt;k, ( $this-&gt;h - ( $y - $up / 1000 * $this-&gt;FontSize ) ) * $this-&gt;k, $w * $this-&gt;k, -$ut / 1000 * $this-&gt;FontSizePt );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _parsejpg( $file ) {&nbsp;</div></li><li><div>        $a = getimagesize( $file );&nbsp;</div></li><li><div>        if ( !$a )&nbsp;</div></li><li><div>            $this-&gt;Error( 'Missing or incorrect image file: ' . $file );&nbsp;</div></li><li><div>        if ( $a[2] != 2 )&nbsp;</div></li><li><div>            $this-&gt;Error( 'Not a JPEG file: ' . $file );&nbsp;</div></li><li><div>        if ( !isset( $a['channels'] ) || $a['channels'] == 3 )&nbsp;</div></li><li><div>            $colspace = 'DeviceRGB';&nbsp;</div></li><li><div>        elseif ( $a['channels'] == 4 )&nbsp;</div></li><li><div>            $colspace = 'DeviceCMYK';&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $colspace = 'DeviceGray';&nbsp;</div></li><li><div>        $bpc = isset( $a['bits'] ) ? $a['bits'] : 8;&nbsp;</div></li><li><div>        $data = file_get_contents( $file );&nbsp;</div></li><li><div>        return array(&nbsp;</div></li><li><div>             'w' =&gt; $a[0], &nbsp;</div></li><li><div>            'h' =&gt; $a[1], &nbsp;</div></li><li><div>            'cs' =&gt; $colspace, &nbsp;</div></li><li><div>            'bpc' =&gt; $bpc, &nbsp;</div></li><li><div>            'f' =&gt; 'DCTDecode', &nbsp;</div></li><li><div>            'data' =&gt; $data&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _parsepng( $file ) {&nbsp;</div></li><li><div>        $f = fopen( $file, 'rb' );&nbsp;</div></li><li><div>        if ( !$f )&nbsp;</div></li><li><div>            $this-&gt;Error( 'Can\'t open image file: ' . $file );&nbsp;</div></li><li><div>        $info = $this-&gt;_parsepngstream( $f, $file );&nbsp;</div></li><li><div>        fclose( $f );&nbsp;</div></li><li><div>        return $info;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _parsepngstream( $f, $file ) {&nbsp;</div></li><li><div>        if ( $this-&gt;_readstream( $f, 8 ) != chr( 137 ) . 'PNG' . chr( 13 ) . chr( 10 ) . chr( 26 ) . chr( 10 ) )&nbsp;</div></li><li><div>            $this-&gt;Error( 'Not a PNG file: ' . $file );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $this-&gt;_readstream( $f, 4 );&nbsp;</div></li><li><div>        if ( $this-&gt;_readstream( $f, 4 ) != 'IHDR' )&nbsp;</div></li><li><div>            $this-&gt;Error( 'Incorrect PNG file: ' . $file );&nbsp;</div></li><li><div>        $w = $this-&gt;_readint( $f );&nbsp;</div></li><li><div>        $h = $this-&gt;_readint( $f );&nbsp;</div></li><li><div>        $bpc = ord( $this-&gt;_readstream( $f, 1 ) );&nbsp;</div></li><li><div>        if ( $bpc &gt; 8 )&nbsp;</div></li><li><div>            $this-&gt;Error( '16-bit depth not supported: ' . $file );&nbsp;</div></li><li><div>        $ct = ord( $this-&gt;_readstream( $f, 1 ) );&nbsp;</div></li><li><div>        if ( $ct == 0 || $ct == 4 )&nbsp;</div></li><li><div>            $colspace = 'DeviceGray';&nbsp;</div></li><li><div>        elseif ( $ct == 2 || $ct == 6 )&nbsp;</div></li><li><div>            $colspace = 'DeviceRGB';&nbsp;</div></li><li><div>        elseif ( $ct == 3 )&nbsp;</div></li><li><div>            $colspace = 'Indexed';&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $this-&gt;Error( 'Unknown color type: ' . $file );&nbsp;</div></li><li><div>        if ( ord( $this-&gt;_readstream( $f, 1 ) ) != 0 )&nbsp;</div></li><li><div>            $this-&gt;Error( 'Unknown compression method: ' . $file );&nbsp;</div></li><li><div>        if ( ord( $this-&gt;_readstream( $f, 1 ) ) != 0 )&nbsp;</div></li><li><div>            $this-&gt;Error( 'Unknown filter method: ' . $file );&nbsp;</div></li><li><div>        if ( ord( $this-&gt;_readstream( $f, 1 ) ) != 0 )&nbsp;</div></li><li><div>            $this-&gt;Error( 'Interlacing not supported: ' . $file );&nbsp;</div></li><li><div>        $this-&gt;_readstream( $f, 4 );&nbsp;</div></li><li><div>        $dp = '/Predictor 15 /Colors ' . ( $colspace == 'DeviceRGB' ? 3 : 1 ) . ' /BitsPerComponent ' . $bpc . ' /Columns ' . $w;&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        $pal = '';&nbsp;</div></li><li><div>        $trns = '';&nbsp;</div></li><li><div>        $data = '';&nbsp;</div></li><li><div>        do {&nbsp;</div></li><li><div>            $n = $this-&gt;_readint( $f );&nbsp;</div></li><li><div>            $type = $this-&gt;_readstream( $f, 4 );&nbsp;</div></li><li><div>            if ( $type == 'PLTE' ) {&nbsp;</div></li><li><div>                $pal = $this-&gt;_readstream( $f, $n );&nbsp;</div></li><li><div>                $this-&gt;_readstream( $f, 4 );&nbsp;</div></li><li><div>            } elseif ( $type == 'tRNS' ) {&nbsp;</div></li><li><div>                $t = $this-&gt;_readstream( $f, $n );&nbsp;</div></li><li><div>                if ( $ct == 0 )&nbsp;</div></li><li><div>                    $trns = array(&nbsp;</div></li><li><div>                         ord( substr( $t, 1, 1 ) )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                elseif ( $ct == 2 )&nbsp;</div></li><li><div>                    $trns = array(&nbsp;</div></li><li><div>                         ord( substr( $t, 1, 1 ) ), &nbsp;</div></li><li><div>                        ord( substr( $t, 3, 1 ) ), &nbsp;</div></li><li><div>                        ord( substr( $t, 5, 1 ) )&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                else {&nbsp;</div></li><li><div>                    $pos = strpos( $t, chr( 0 ) );&nbsp;</div></li><li><div>                    if ( $pos !== false )&nbsp;</div></li><li><div>                        $trns = array(&nbsp;</div></li><li><div>                             $pos&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $this-&gt;_readstream( $f, 4 );&nbsp;</div></li><li><div>            } elseif ( $type == 'IDAT' ) {&nbsp;</div></li><li><div>                $data .= $this-&gt;_readstream( $f, $n );&nbsp;</div></li><li><div>                $this-&gt;_readstream( $f, 4 );&nbsp;</div></li><li><div>            } elseif ( $type == 'IEND' )&nbsp;</div></li><li><div>                break;&nbsp;</div></li><li><div>            else&nbsp;</div></li><li><div>                $this-&gt;_readstream( $f, $n + 4 );&nbsp;</div></li><li><div>        } while ( $n );&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>        if ( $colspace == 'Indexed' && empty( $pal ) )&nbsp;</div></li><li><div>            $this-&gt;Error( 'Missing palette in ' . $file );&nbsp;</div></li><li><div>        $info = array(&nbsp;</div></li><li><div>             'w' =&gt; $w, &nbsp;</div></li><li><div>            'h' =&gt; $h, &nbsp;</div></li><li><div>            'cs' =&gt; $colspace, &nbsp;</div></li><li><div>            'bpc' =&gt; $bpc, &nbsp;</div></li><li><div>            'f' =&gt; 'FlateDecode', &nbsp;</div></li><li><div>            'dp' =&gt; $dp, &nbsp;</div></li><li><div>            'pal' =&gt; $pal, &nbsp;</div></li><li><div>            'trns' =&gt; $trns&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>        if ( $ct &gt;= 4 ) {&nbsp;</div></li><li><div>            if ( !function_exists( 'gzuncompress' ) )&nbsp;</div></li><li><div>                $this-&gt;Error( 'Zlib not available, can\'t handle alpha channel: ' . $file );&nbsp;</div></li><li><div>            $data = gzuncompress( $data );&nbsp;</div></li><li><div>            $color = '';&nbsp;</div></li><li><div>            $alpha = '';&nbsp;</div></li><li><div>            if ( $ct == 4 ) {&nbsp;</div></li><li><div>                $len = 2 * $w;&nbsp;</div></li><li><div>                for ( $i = 0; $i &lt; $h; $i++ ) {&nbsp;</div></li><li><div>                    $pos = ( 1 + $len ) * $i;&nbsp;</div></li><li><div>                    $color .= $data[$pos];&nbsp;</div></li><li><div>                    $alpha .= $data[$pos];&nbsp;</div></li><li><div>                    $line = substr( $data, $pos + 1, $len );&nbsp;</div></li><li><div>                    $color .= preg_replace( '/(.)./s', '$1', $line );&nbsp;</div></li><li><div>                    $alpha .= preg_replace( '/.(.)/s', '$1', $line );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $len = 4 * $w;&nbsp;</div></li><li><div>                for ( $i = 0; $i &lt; $h; $i++ ) {&nbsp;</div></li><li><div>                    $pos = ( 1 + $len ) * $i;&nbsp;</div></li><li><div>                    $color .= $data[$pos];&nbsp;</div></li><li><div>                    $alpha .= $data[$pos];&nbsp;</div></li><li><div>                    $line = substr( $data, $pos + 1, $len );&nbsp;</div></li><li><div>                    $color .= preg_replace( '/(.{3})./s', '$1', $line );&nbsp;</div></li><li><div>                    $alpha .= preg_replace( '/.{3}(.)/s', '$1', $line );&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            unset( $data );&nbsp;</div></li><li><div>            $data = gzcompress( $color );&nbsp;</div></li><li><div>            $info['smask'] = gzcompress( $alpha );&nbsp;</div></li><li><div>            if ( $this-&gt;PDFVersion &lt; '1.4' )&nbsp;</div></li><li><div>                $this-&gt;PDFVersion = '1.4';&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $info['data'] = $data;&nbsp;</div></li><li><div>        return $info;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _readstream( $f, $n ) {&nbsp;</div></li><li><div>        $res = '';&nbsp;</div></li><li><div>        while ( $n &gt; 0 && !feof( $f ) ) {&nbsp;</div></li><li><div>            $s = fread( $f, $n );&nbsp;</div></li><li><div>            if ( $s === false )&nbsp;</div></li><li><div>                $this-&gt;Error( 'Error while reading stream' );&nbsp;</div></li><li><div>            $n -= strlen( $s );&nbsp;</div></li><li><div>            $res .= $s;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $n &gt; 0 )&nbsp;</div></li><li><div>            $this-&gt;Error( 'Unexpected end of stream' );&nbsp;</div></li><li><div>        return $res;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _readint( $f ) {&nbsp;</div></li><li><div>        $a = unpack( 'Ni', $this-&gt;_readstream( $f, 4 ) );&nbsp;</div></li><li><div>        return $a['i'];&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _parsegif( $file ) {&nbsp;</div></li><li><div>        if ( !function_exists( 'imagepng' ) )&nbsp;</div></li><li><div>            $this-&gt;Error( 'GD extension is required for GIF support' );&nbsp;</div></li><li><div>        if ( !function_exists( 'imagecreatefromgif' ) )&nbsp;</div></li><li><div>            $this-&gt;Error( 'GD has no GIF read support' );&nbsp;</div></li><li><div>        $im = imagecreatefromgif( $file );&nbsp;</div></li><li><div>        if ( !$im )&nbsp;</div></li><li><div>            $this-&gt;Error( 'Missing or incorrect image file: ' . $file );&nbsp;</div></li><li><div>        imageinterlace( $im, 0 );&nbsp;</div></li><li><div>        $f = @fopen( 'php://temp', 'rb+' );&nbsp;</div></li><li><div>        if ( $f ) {&nbsp;</div></li><li><div>            ob_start();&nbsp;</div></li><li><div>            imagepng( $im );&nbsp;</div></li><li><div>            $data = ob_get_clean();&nbsp;</div></li><li><div>            imagedestroy( $im );&nbsp;</div></li><li><div>            fwrite( $f, $data );&nbsp;</div></li><li><div>            rewind( $f );&nbsp;</div></li><li><div>            $info = $this-&gt;_parsepngstream( $f, $file );&nbsp;</div></li><li><div>            fclose( $f );&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $tmp = tempnam( '.', 'gif' );&nbsp;</div></li><li><div>            if ( !$tmp )&nbsp;</div></li><li><div>                $this-&gt;Error( 'Unable to create a temporary file' );&nbsp;</div></li><li><div>            if ( !imagepng( $im, $tmp ) )&nbsp;</div></li><li><div>                $this-&gt;Error( 'Error while saving to temporary file' );&nbsp;</div></li><li><div>            imagedestroy( $im );&nbsp;</div></li><li><div>            $info = $this-&gt;_parsepng( $tmp );&nbsp;</div></li><li><div>            unlink( $tmp );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        return $info;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _newobj() {&nbsp;</div></li><li><div>        $this-&gt;n++;&nbsp;</div></li><li><div>        $this-&gt;offsets[$this-&gt;n] = strlen( $this-&gt;buffer );&nbsp;</div></li><li><div>        $this-&gt;_out( $this-&gt;n . ' 0 obj' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _putstream( $s ) {&nbsp;</div></li><li><div>        $this-&gt;_out( 'stream' );&nbsp;</div></li><li><div>        $this-&gt;_out( $s );&nbsp;</div></li><li><div>        $this-&gt;_out( 'endstream' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _out( $s ) {&nbsp;</div></li><li><div>        if ( $this-&gt;state == 2 )&nbsp;</div></li><li><div>            $this-&gt;pages[$this-&gt;page] .= $s . &quot;\n&quot;;&nbsp;</div></li><li><div>        else&nbsp;</div></li><li><div>            $this-&gt;buffer .= $s . &quot;\n&quot;;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _putpages()&nbsp;</div></li><li><div>    {&nbsp;</div></li><li><div>        $nb = $this-&gt;page;&nbsp;</div></li><li><div>        if ( !empty( $this-&gt;AliasNbPages ) ) {&nbsp;</div></li><li><div>            for ( $n = 1; $n &lt;= $nb; $n++ )&nbsp;</div></li><li><div>                $this-&gt;pages[$n] = str_replace( $this-&gt;AliasNbPages, $nb, $this-&gt;pages[$n] );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $this-&gt;DefOrientation == 'P' ) {&nbsp;</div></li><li><div>            $wPt = $this-&gt;DefPageSize[0] * $this-&gt;k;&nbsp;</div></li><li><div>            $hPt = $this-&gt;DefPageSize[1] * $this-&gt;k;&nbsp;</div></li><li><div>        } else {&nbsp;</div></li><li><div>            $wPt = $this-&gt;DefPageSize[1] * $this-&gt;k;&nbsp;</div></li><li><div>            $hPt = $this-&gt;DefPageSize[0] * $this-&gt;k;&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $filter = ( $this-&gt;compress ) ? '/Filter /FlateDecode ' : '';&nbsp;</div></li><li><div>        for ( $n = 1; $n &lt;= $nb; $n++ ) {&nbsp;</div></li><li><div>            $this-&gt;_newobj();&nbsp;</div></li><li><div>            $this-&gt;_out( '&lt;&lt;/Type /Page' );&nbsp;</div></li><li><div>            $this-&gt;_out( '/Parent 1 0 R' );&nbsp;</div></li><li><div>            if ( isset( $this-&gt;PageSizes[$n] ) )&nbsp;</div></li><li><div>                $this-&gt;_out( sprintf( '/MediaBox [0 0 %.2F %.2F]', $this-&gt;PageSizes[$n][0], $this-&gt;PageSizes[$n][1] ) );&nbsp;</div></li><li><div>            $this-&gt;_out( '/Resources 2 0 R' );&nbsp;</div></li><li><div>            if ( isset( $this-&gt;PageLinks[$n] ) ) {&nbsp;</div></li><li><div>                $annots = '/Annots [';&nbsp;</div></li><li><div>                foreach ( $this-&gt;PageLinks[$n] as $pl ) {&nbsp;</div></li><li><div>                    $rect = sprintf( '%.2F %.2F %.2F %.2F', $pl[0], $pl[1], $pl[0] + $pl[2], $pl[1] - $pl[3] );&nbsp;</div></li><li><div>                    $annots .= '&lt;&lt;/Type /Annot /Subtype /Link /Rect [' . $rect . '] /Border [0 0 0] ';&nbsp;</div></li><li><div>                    if ( is_string( $pl[4] ) )&nbsp;</div></li><li><div>                        $annots .= '/A &lt;&lt;/S /URI /URI ' . $this-&gt;_textstring( $pl[4] ) . '&gt;&gt;&gt;&gt;';&nbsp;</div></li><li><div>                    else {&nbsp;</div></li><li><div>                        $l = $this-&gt;links[$pl[4]];&nbsp;</div></li><li><div>                        $h = isset( $this-&gt;PageSizes[$l[0]] ) ? $this-&gt;PageSizes[$l[0]][1] : $hPt;&nbsp;</div></li><li><div>                        $annots .= sprintf( '/Dest [%d 0 R /XYZ 0 %.2F null]&gt;&gt;', 1 + 2 * $l[0], $h - $l[1] * $this-&gt;k );&nbsp;</div></li><li><div>                    }&nbsp;</div></li><li><div>                }&nbsp;</div></li><li><div>                $this-&gt;_out( $annots . ']' );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>            if ( $this-&gt;PDFVersion &gt; '1.3' )&nbsp;</div></li><li><div>                $this-&gt;_out( '/Group &lt;&lt;/Type /Group /S /Transparency /CS /DeviceRGB&gt;&gt;' );&nbsp;</div></li><li><div>            $this-&gt;_out( '/Contents ' . ( $this-&gt;n + 1 ) . ' 0 R&gt;&gt;' );&nbsp;</div></li><li><div>            $this-&gt;_out( 'endobj' );&nbsp;</div></li><li><div>            $p = ( $this-&gt;compress ) ? gzcompress( $this-&gt;pages[$n] ) : $this-&gt;pages[$n];&nbsp;</div></li><li><div>            $this-&gt;_newobj();&nbsp;</div></li><li><div>            $this-&gt;_out( '&lt;&lt;' . $filter . '/Length ' . strlen( $p ) . '&gt;&gt;' );&nbsp;</div></li><li><div>            $this-&gt;_putstream( $p );&nbsp;</div></li><li><div>            $this-&gt;_out( 'endobj' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $this-&gt;offsets[1] = strlen( $this-&gt;buffer );&nbsp;</div></li><li><div>        $this-&gt;_out( '1 0 obj' );&nbsp;</div></li><li><div>        $this-&gt;_out( '&lt;&lt;/Type /Pages' );&nbsp;</div></li><li><div>        $kids = '/Kids [';&nbsp;</div></li><li><div>        for ( $i = 0; $i &lt; $nb; $i++ )&nbsp;</div></li><li><div>            $kids .= ( 3 + 2 * $i ) . ' 0 R ';&nbsp;</div></li><li><div>        $this-&gt;_out( $kids . ']' );&nbsp;</div></li><li><div>        $this-&gt;_out( '/Count ' . $nb );&nbsp;</div></li><li><div>        $this-&gt;_out( sprintf( '/MediaBox [0 0 %.2F %.2F]', $wPt, $hPt ) );&nbsp;</div></li><li><div>        $this-&gt;_out( '&gt;&gt;' );&nbsp;</div></li><li><div>        $this-&gt;_out( 'endobj' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _putfonts() {&nbsp;</div></li><li><div>        $nf = $this-&gt;n;&nbsp;</div></li><li><div>        foreach ( $this-&gt;diffs as $diff ) {&nbsp;</div></li><li><div>            $this-&gt;_newobj();&nbsp;</div></li><li><div>            $this-&gt;_out( '&lt;&lt;/Type /Encoding /BaseEncoding /WinAnsiEncoding /Differences [' . $diff . ']&gt;&gt;' );&nbsp;</div></li><li><div>            $this-&gt;_out( 'endobj' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        foreach ( $this-&gt;FontFiles as $file =&gt; $info ) {&nbsp;</div></li><li><div>            $this-&gt;_newobj();&nbsp;</div></li><li><div>            $this-&gt;FontFiles[$file]['n'] = $this-&gt;n;&nbsp;</div></li><li><div>            $font = file_get_contents( $this-&gt;fontpath . $file, true );&nbsp;</div></li><li><div>            if ( !$font )&nbsp;</div></li><li><div>                $this-&gt;Error( 'Font file not found: ' . $file );&nbsp;</div></li><li><div>            $compressed = ( substr( $file, -2 ) == '.z' );&nbsp;</div></li><li><div>            if ( !$compressed && isset( $info['length2'] ) )&nbsp;</div></li><li><div>                $font = substr( $font, 6, $info['length1'] ) . substr( $font, 6 + $info['length1'] + 6, $info['length2'] );&nbsp;</div></li><li><div>            $this-&gt;_out( '&lt;&lt;/Length ' . strlen( $font ) );&nbsp;</div></li><li><div>            if ( $compressed )&nbsp;</div></li><li><div>                $this-&gt;_out( '/Filter /FlateDecode' );&nbsp;</div></li><li><div>            $this-&gt;_out( '/Length1 ' . $info['length1'] );&nbsp;</div></li><li><div>            if ( isset( $info['length2'] ) )&nbsp;</div></li><li><div>                $this-&gt;_out( '/Length2 ' . $info['length2'] . ' /Length3 0' );&nbsp;</div></li><li><div>            $this-&gt;_out( '&gt;&gt;' );&nbsp;</div></li><li><div>            $this-&gt;_putstream( $font );&nbsp;</div></li><li><div>            $this-&gt;_out( 'endobj' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        foreach ( $this-&gt;fonts as $k =&gt; $font ) {&nbsp;</div></li><li><div>            $this-&gt;fonts[$k]['n'] = $this-&gt;n + 1;&nbsp;</div></li><li><div>            $type = $font['type'];&nbsp;</div></li><li><div>            $name = $font['name'];&nbsp;</div></li><li><div>            if ( $type == 'Core' ) {&nbsp;</div></li><li><div>                $this-&gt;_newobj();&nbsp;</div></li><li><div>                $this-&gt;_out( '&lt;&lt;/Type /Font' );&nbsp;</div></li><li><div>                $this-&gt;_out( '/BaseFont /' . $name );&nbsp;</div></li><li><div>                $this-&gt;_out( '/Subtype /Type1' );&nbsp;</div></li><li><div>                if ( $name != 'Symbol' && $name != 'ZapfDingbats' )&nbsp;</div></li><li><div>                    $this-&gt;_out( '/Encoding /WinAnsiEncoding' );&nbsp;</div></li><li><div>                $this-&gt;_out( '&gt;&gt;' );&nbsp;</div></li><li><div>                $this-&gt;_out( 'endobj' );&nbsp;</div></li><li><div>            } elseif ( $type == 'Type1' || $type == 'TrueType' ) {&nbsp;</div></li><li><div>                $this-&gt;_newobj();&nbsp;</div></li><li><div>                $this-&gt;_out( '&lt;&lt;/Type /Font' );&nbsp;</div></li><li><div>                $this-&gt;_out( '/BaseFont /' . $name );&nbsp;</div></li><li><div>                $this-&gt;_out( '/Subtype /' . $type );&nbsp;</div></li><li><div>                $this-&gt;_out( '/FirstChar 32 /LastChar 255' );&nbsp;</div></li><li><div>                $this-&gt;_out( '/Widths ' . ( $this-&gt;n + 1 ) . ' 0 R' );&nbsp;</div></li><li><div>                $this-&gt;_out( '/FontDescriptor ' . ( $this-&gt;n + 2 ) . ' 0 R' );&nbsp;</div></li><li><div>                if ( isset( $font['diffn'] ) )&nbsp;</div></li><li><div>                    $this-&gt;_out( '/Encoding ' . ( $nf + $font['diffn'] ) . ' 0 R' );&nbsp;</div></li><li><div>                else&nbsp;</div></li><li><div>                    $this-&gt;_out( '/Encoding /WinAnsiEncoding' );&nbsp;</div></li><li><div>                $this-&gt;_out( '&gt;&gt;' );&nbsp;</div></li><li><div>                $this-&gt;_out( 'endobj' );&nbsp;</div></li><li><div>                $this-&gt;_newobj();&nbsp;</div></li><li><div>                $cw =& $font['cw'];&nbsp;</div></li><li><div>                $s = '[';&nbsp;</div></li><li><div>                for ( $i = 32; $i &lt;= 255; $i++ )&nbsp;</div></li><li><div>                    $s .= $cw[chr( $i )] . ' ';&nbsp;</div></li><li><div>                $this-&gt;_out( $s . ']' );&nbsp;</div></li><li><div>                $this-&gt;_out( 'endobj' );&nbsp;</div></li><li><div>                $this-&gt;_newobj();&nbsp;</div></li><li><div>                $s = '&lt;&lt;/Type /FontDescriptor /FontName /' . $name;&nbsp;</div></li><li><div>                foreach ( $font['desc'] as $k =&gt; $v )&nbsp;</div></li><li><div>                    $s .= ' /' . $k . ' ' . $v;&nbsp;</div></li><li><div>                if ( !empty( $font['file'] ) )&nbsp;</div></li><li><div>                    $s .= ' /FontFile' . ( $type == 'Type1' ? '' : '2' ) . ' ' . $this-&gt;FontFiles[$font['file']]['n'] . ' 0 R';&nbsp;</div></li><li><div>                $this-&gt;_out( $s . '&gt;&gt;' );&nbsp;</div></li><li><div>                $this-&gt;_out( 'endobj' );&nbsp;</div></li><li><div>            } else {&nbsp;</div></li><li><div>                $mtd = '_put' . strtolower( $type );&nbsp;</div></li><li><div>                if ( !method_exists( $this, $mtd ) )&nbsp;</div></li><li><div>                    $this-&gt;Error( 'Unsupported font type: ' . $type );&nbsp;</div></li><li><div>                $this-&gt;$mtd( $font );&nbsp;</div></li><li><div>            }&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _putimages() {&nbsp;</div></li><li><div>        foreach ( array_keys( $this-&gt;images ) as $file ) {&nbsp;</div></li><li><div>            $this-&gt;_putimage( $this-&gt;images[$file] );&nbsp;</div></li><li><div>            unset( $this-&gt;images[$file]['data'] );&nbsp;</div></li><li><div>            unset( $this-&gt;images[$file]['smask'] );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _putimage( &$info ) {&nbsp;</div></li><li><div>        $this-&gt;_newobj();&nbsp;</div></li><li><div>        $info['n'] = $this-&gt;n;&nbsp;</div></li><li><div>        $this-&gt;_out( '&lt;&lt;/Type /XObject' );&nbsp;</div></li><li><div>        $this-&gt;_out( '/Subtype /Image' );&nbsp;</div></li><li><div>        $this-&gt;_out( '/Width ' . $info['w'] );&nbsp;</div></li><li><div>        $this-&gt;_out( '/Height ' . $info['h'] );&nbsp;</div></li><li><div>        if ( $info['cs'] == 'Indexed' )&nbsp;</div></li><li><div>            $this-&gt;_out( '/ColorSpace [/Indexed /DeviceRGB ' . ( strlen( $info['pal'] ) / 3 - 1 ) . ' ' . ( $this-&gt;n + 1 ) . ' 0 R]' );&nbsp;</div></li><li><div>        else {&nbsp;</div></li><li><div>            $this-&gt;_out( '/ColorSpace /' . $info['cs'] );&nbsp;</div></li><li><div>            if ( $info['cs'] == 'DeviceCMYK' )&nbsp;</div></li><li><div>                $this-&gt;_out( '/Decode [1 0 1 0 1 0 1 0]' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        $this-&gt;_out( '/BitsPerComponent ' . $info['bpc'] );&nbsp;</div></li><li><div>        if ( isset( $info['f'] ) )&nbsp;</div></li><li><div>            $this-&gt;_out( '/Filter /' . $info['f'] );&nbsp;</div></li><li><div>        if ( isset( $info['dp'] ) )&nbsp;</div></li><li><div>            $this-&gt;_out( '/DecodeParms &lt;&lt;' . $info['dp'] . '&gt;&gt;' );&nbsp;</div></li><li><div>        if ( isset( $info['trns'] ) && is_array( $info['trns'] ) ) {&nbsp;</div></li><li><div>            $trns = '';&nbsp;</div></li><li><div>            for ( $i = 0; $i &lt; count( $info['trns'] ); $i++ )&nbsp;</div></li><li><div>                $trns .= $info['trns'][$i] . ' ' . $info['trns'][$i] . ' ';&nbsp;</div></li><li><div>            $this-&gt;_out( '/Mask [' . $trns . ']' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( isset( $info['smask'] ) )&nbsp;</div></li><li><div>            $this-&gt;_out( '/SMask ' . ( $this-&gt;n + 1 ) . ' 0 R' );&nbsp;</div></li><li><div>        $this-&gt;_out( '/Length ' . strlen( $info['data'] ) . '&gt;&gt;' );&nbsp;</div></li><li><div>        $this-&gt;_putstream( $info['data'] );&nbsp;</div></li><li><div>        $this-&gt;_out( 'endobj' );&nbsp;</div></li><li><div>        if ( isset( $info['smask'] ) ) {&nbsp;</div></li><li><div>            $dp = '/Predictor 15 /Colors 1 /BitsPerComponent 8 /Columns ' . $info['w'];&nbsp;</div></li><li><div>            $smask = array(&nbsp;</div></li><li><div>                 'w' =&gt; $info['w'], &nbsp;</div></li><li><div>                'h' =&gt; $info['h'], &nbsp;</div></li><li><div>                'cs' =&gt; 'DeviceGray', &nbsp;</div></li><li><div>                'bpc' =&gt; 8, &nbsp;</div></li><li><div>                'f' =&gt; $info['f'], &nbsp;</div></li><li><div>                'dp' =&gt; $dp, &nbsp;</div></li><li><div>                'data' =&gt; $info['smask']&nbsp;</div></li><li><div> );&nbsp;</div></li><li><div>            $this-&gt;_putimage( $smask );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>        if ( $info['cs'] == 'Indexed' ) {&nbsp;</div></li><li><div>            $filter = ( $this-&gt;compress ) ? '/Filter /FlateDecode ' : '';&nbsp;</div></li><li><div>            $pal = ( $this-&gt;compress ) ? gzcompress( $info['pal'] ) : $info['pal'];&nbsp;</div></li><li><div>            $this-&gt;_newobj();&nbsp;</div></li><li><div>            $this-&gt;_out( '&lt;&lt;' . $filter . '/Length ' . strlen( $pal ) . '&gt;&gt;' );&nbsp;</div></li><li><div>            $this-&gt;_putstream( $pal );&nbsp;</div></li><li><div>            $this-&gt;_out( 'endobj' );&nbsp;</div></li><li><div>        }&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _putxobjectdict() {&nbsp;</div></li><li><div>        foreach ( $this-&gt;images as $image )&nbsp;</div></li><li><div>            $this-&gt;_out( '/I' . $image['i'] . ' ' . $image['n'] . ' 0 R' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _putresourcedict() {&nbsp;</div></li><li><div>        $this-&gt;_out( '/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]' );&nbsp;</div></li><li><div>        $this-&gt;_out( '/Font &lt;&lt;' );&nbsp;</div></li><li><div>        foreach ( $this-&gt;fonts as $font )&nbsp;</div></li><li><div>            $this-&gt;_out( '/F' . $font['i'] . ' ' . $font['n'] . ' 0 R' );&nbsp;</div></li><li><div>        $this-&gt;_out( '&gt;&gt;' );&nbsp;</div></li><li><div>        $this-&gt;_out( '/XObject &lt;&lt;' );&nbsp;</div></li><li><div>        $this-&gt;_putxobjectdict();&nbsp;</div></li><li><div>        $this-&gt;_out( '&gt;&gt;' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _putresources() {&nbsp;</div></li><li><div>        $this-&gt;_putfonts();&nbsp;</div></li><li><div>        $this-&gt;_putimages();&nbsp;</div></li><li><div>        $this-&gt;offsets[2] = strlen( $this-&gt;buffer );&nbsp;</div></li><li><div>        $this-&gt;_out( '2 0 obj' );&nbsp;</div></li><li><div>        $this-&gt;_out( '&lt;&lt;' );&nbsp;</div></li><li><div>        $this-&gt;_putresourcedict();&nbsp;</div></li><li><div>        $this-&gt;_out( '&gt;&gt;' );&nbsp;</div></li><li><div>        $this-&gt;_out( 'endobj' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _putinfo() {&nbsp;</div></li><li><div>        $this-&gt;_out( '/Producer ' . $this-&gt;_textstring( 'Easy Digital Downloads' ) );&nbsp;</div></li><li><div>        if ( !empty( $this-&gt;title ) )&nbsp;</div></li><li><div>            $this-&gt;_out( '/Title ' . $this-&gt;_textstring( $this-&gt;title ) );&nbsp;</div></li><li><div>        if ( !empty( $this-&gt;subject ) )&nbsp;</div></li><li><div>            $this-&gt;_out( '/Subject ' . $this-&gt;_textstring( $this-&gt;subject ) );&nbsp;</div></li><li><div>        if ( !empty( $this-&gt;author ) )&nbsp;</div></li><li><div>            $this-&gt;_out( '/Author ' . $this-&gt;_textstring( $this-&gt;author ) );&nbsp;</div></li><li><div>        if ( !empty( $this-&gt;keywords ) )&nbsp;</div></li><li><div>            $this-&gt;_out( '/Keywords ' . $this-&gt;_textstring( $this-&gt;keywords ) );&nbsp;</div></li><li><div>        if ( !empty( $this-&gt;creator ) )&nbsp;</div></li><li><div>            $this-&gt;_out( '/Creator ' . $this-&gt;_textstring( $this-&gt;creator ) );&nbsp;</div></li><li><div>        $this-&gt;_out( '/CreationDate ' . $this-&gt;_textstring( 'D:' . @date( 'YmdHis' ) ) );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _putcatalog() {&nbsp;</div></li><li><div>        $this-&gt;_out( '/Type /Catalog' );&nbsp;</div></li><li><div>        $this-&gt;_out( '/Pages 1 0 R' );&nbsp;</div></li><li><div>        if ( $this-&gt;ZoomMode == 'fullpage' )&nbsp;</div></li><li><div>            $this-&gt;_out( '/OpenAction [3 0 R /Fit]' );&nbsp;</div></li><li><div>        elseif ( $this-&gt;ZoomMode == 'fullwidth' )&nbsp;</div></li><li><div>            $this-&gt;_out( '/OpenAction [3 0 R /FitH null]' );&nbsp;</div></li><li><div>        elseif ( $this-&gt;ZoomMode == 'real' )&nbsp;</div></li><li><div>            $this-&gt;_out( '/OpenAction [3 0 R /XYZ null null 1]' );&nbsp;</div></li><li><div>        elseif ( !is_string( $this-&gt;ZoomMode ) )&nbsp;</div></li><li><div>            $this-&gt;_out( '/OpenAction [3 0 R /XYZ null null ' . sprintf( '%.2F', $this-&gt;ZoomMode / 100 ) . ']' );&nbsp;</div></li><li><div>        if ( $this-&gt;LayoutMode == 'single' )&nbsp;</div></li><li><div>            $this-&gt;_out( '/PageLayout /SinglePage' );&nbsp;</div></li><li><div>        elseif ( $this-&gt;LayoutMode == 'continuous' )&nbsp;</div></li><li><div>            $this-&gt;_out( '/PageLayout /OneColumn' );&nbsp;</div></li><li><div>        elseif ( $this-&gt;LayoutMode == 'two' )&nbsp;</div></li><li><div>            $this-&gt;_out( '/PageLayout /TwoColumnLeft' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _putheader() {&nbsp;</div></li><li><div>        $this-&gt;_out( '%PDF-' . $this-&gt;PDFVersion );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _puttrailer() {&nbsp;</div></li><li><div>        $this-&gt;_out( '/Size ' . ( $this-&gt;n + 1 ) );&nbsp;</div></li><li><div>        $this-&gt;_out( '/Root ' . $this-&gt;n . ' 0 R' );&nbsp;</div></li><li><div>        $this-&gt;_out( '/Info ' . ( $this-&gt;n - 1 ) . ' 0 R' );&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>&nbsp;</div></li><li><div>    function _enddoc() {&nbsp;</div></li><li><div>        $this-&gt;_putheader();&nbsp;</div></li><li><div>        $this-&gt;_putpages();&nbsp;</div></li><li><div>        $this-&gt;_putresources();&nbsp;</div></li><li><div>        $this-&gt;_newobj();&nbsp;</div></li><li><div>        $this-&gt;_out( '&lt;&lt;' );&nbsp;</div></li><li><div>        $this-&gt;_putinfo();&nbsp;</div></li><li><div>        $this-&gt;_out( '&gt;&gt;' );&nbsp;</div></li><li><div>        $this-&gt;_out( 'endobj' );&nbsp;</div></li><li><div>        $this-&gt;_newobj();&nbsp;</div></li><li><div>        $this-&gt;_out( '&lt;&lt;' );&nbsp;</div></li><li><div>        $this-&gt;_putcatalog();&nbsp;</div></li><li><div>        $this-&gt;_out( '&gt;&gt;' );&nbsp;</div></li><li><div>        $this-&gt;_out( 'endobj' );&nbsp;</div></li><li><div>        $o = strlen( $this-&gt;buffer );&nbsp;</div></li><li><div>        $this-&gt;_out( 'xref' );&nbsp;</div></li><li><div>        $this-&gt;_out( '0 ' . ( $this-&gt;n + 1 ) );&nbsp;</div></li><li><div>        $this-&gt;_out( '0000000000 65535 f ' );&nbsp;</div></li><li><div>        for ( $i = 1; $i &lt;= $this-&gt;n; $i++ )&nbsp;</div></li><li><div>            $this-&gt;_out( sprintf( '%010d 00000 n ', $this-&gt;offsets[$i] ) );&nbsp;</div></li><li><div>        $this-&gt;_out( 'trailer' );&nbsp;</div></li><li><div>        $this-&gt;_out( '&lt;&lt;' );&nbsp;</div></li><li><div>        $this-&gt;_puttrailer();&nbsp;</div></li><li><div>        $this-&gt;_out( '&gt;&gt;' );&nbsp;</div></li><li><div>        $this-&gt;_out( 'startxref' );&nbsp;</div></li><li><div>        $this-&gt;_out( $o );&nbsp;</div></li><li><div>        $this-&gt;_out( '%%EOF' );&nbsp;</div></li><li><div>        $this-&gt;state = 3;&nbsp;</div></li><li><div>    }&nbsp;</div></li><li><div>}&nbsp;</div></li></ol></pre></dd></dl> </section> </article></div><div id="sidebar"><ul class="widgets"><li> <a href="http://hookr.io/plugin/"><img src="http://hookr.io/wp-content/themes/hookr/assets/images/plugin-download.jpg" /></a></li><li id="versions"><dl><dt>Version(s)</dt><dd><dl><dt>Since</dt><dd> 2.7.4</dd><dt>Others</dt><dd><ul><li><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.8/classes/fpdf/" class="active">2.7.8</a></li><li><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.7/classes/fpdf/" class="">2.7.7</a></li><li><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.6/classes/fpdf/" class="">2.7.6</a></li><li><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.5/classes/fpdf/" class="">2.7.5</a></li><li><a href="http://hookr.io/plugins/easy-digital-downloads/2.7.4/classes/fpdf/" class="">2.7.4</a></li></ul></dd></dl></dd></dl></li><li id="tags"><dl><dt>Tags</dt><dd><ul><li><span></span>plugin</li><li><span></span>class</li><li><span></span>FPDF</li><li><span></span>Easy Digital Downloads</li><li><span></span>2.7.8</li></ul></dd></dl></li></ul></div></div></div><script>Hookr.View.init();Hookr.Single.init();</script><footer><div><ul id="nav-social" class="pivot" role="navigation"><li id="twitter"><a href="http://twitter.com/hookr_io" title="Follow me!"></a></li></ul><div> &copy; 2018 hookr.io <strong>(beta)</strong> | <a href="http://hookr.io/privacy/" title="Privacy">Privacy</a> | Proudly Powered by WordPress</div></div> </footer><script type="text/javascript" src="http://hookr.io/wp-content/cache/minify/000000/M9EvL9BNzU1KTdHLzcwDAA.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-49583310-1','hookr.io');ga('send','pageview');</script></body></html>